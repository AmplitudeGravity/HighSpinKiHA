(* Content-type: application/vnd.wolfram.mathematica *)

(*** Wolfram Notebook File ***)
(* http://www.wolfram.com/nb *)

(* CreatedBy='Mathematica 10.0' *)

(*CacheID: 234*)
(* Internal cache information:
NotebookFileLineBreakTest
NotebookFileLineBreakTest
NotebookDataPosition[       158,          7]
NotebookDataLength[    259361,       6955]
NotebookOptionsPosition[    246183,       6751]
NotebookOutlinePosition[    246807,       6771]
CellTagsIndexPosition[    246764,       6768]
WindowFrame->Normal*)

(* Beginning of Notebook Content *)
Notebook[{

Cell[CellGroupData[{
Cell["Loading Packages", "Section",
 CellChangeTimes->{{3.851831445638886*^9, 
  3.851831451080901*^9}},ExpressionUUID->"0441e687-3271-491a-8955-\
dd8d0f7cb479"],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"SetDirectory", "[", 
  "\"\</Users/gangchen/Documents/GitHub/kinematicHopfAlgebra\>\"", 
  "]"}]], "Input",
 CellLabel->
  "In[201]:=",ExpressionUUID->"e15a1c17-2cfb-46a2-8aa9-607b0a62e713"],

Cell[BoxData["\<\"/Users/gangchen/Documents/GitHub/kinematicHopfAlgebra\"\>"],\
 "Output",
 CellChangeTimes->{{3.876903361280591*^9, 3.87690337645822*^9}, 
   3.876976886374969*^9, 3.8769769654479218`*^9, 3.8770661363411407`*^9},
 CellLabel->
  "Out[201]=",ExpressionUUID->"cf1f6499-4222-45af-9908-6016b51414f4"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"Get", "[", "\"\<KiHA.wl\>\"", "]"}]], "Input",
 CellChangeTimes->{
  3.857017232176591*^9, {3.871280778936686*^9, 3.8712807820748453`*^9}, {
   3.871880936625079*^9, 3.871881000526787*^9}, {3.876804060646309*^9, 
   3.876804061338099*^9}},
 CellLabel->
  "In[202]:=",ExpressionUUID->"9e588303-12c7-48e0-b8a5-8c3c446f4c9f"],

Cell["\<\
 KiHA(v1.3),Copyright 2022,author Gang Chen. It is licensed under the GNU \
General Public License v3.0.
 KiHA is based on the work of Kinematic Hopf Algebra in CTP of Queen Mary \
University of London.
 It generates the duality all-n numerator for colour-kinematic duality and \
double copy in heavy mass effective 
 theory(HEFT), Yang-Mills/Gravity theory and Yang-Mills-Scalar/Gravity-Scalar. 
 KiHA is built on some basic functions written by Gustav Mogull and Gregor \
Kaelin.
 use ?KiHA`* for help and a series of papers (2111.15649, 2208.05519, \
2208.05886) for more reference.\
\>", "Print",
 CellFrame->0.5,
 CellChangeTimes->{3.8770661364054213`*^9},
 FontColor->RGBColor[
  0, 0, 1],ExpressionUUID->"2d895c43-8c55-4131-9505-e1893a620d89"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{
  RowBox[{"Unprotect", "[", 
   RowBox[{"p", ",", "F", ",", "\[Epsilon]", ",", "as"}], "]"}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{"declareVectorHead", "[", 
  RowBox[{"{", 
   RowBox[{
   "p", ",", "q", ",", "l", ",", "\[Epsilon]", ",", "v", ",", "w", ",", 
    "link", ",", "as"}], "}"}], "]"}], "\[IndentingNewLine]", 
 RowBox[{"declareTensorHead", "[", 
  RowBox[{
   RowBox[{"{", 
    RowBox[{"F", ",", "H", ",", "W", ",", "V", ",", "S"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"\"\<rank\>\"", "\[Rule]", " ", "2"}], "}"}]}], 
  "]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"Protect", "[", 
   RowBox[{"p", ",", "F", ",", "\[Epsilon]"}], "]"}], ";"}]}], "Input",
 CellChangeTimes->{{3.84986941234763*^9, 3.849869419397002*^9}, {
  3.849870567849285*^9, 3.849870590592388*^9}, {3.849873920169284*^9, 
  3.849873921735065*^9}, {3.849935554482378*^9, 3.849935554779604*^9}, {
  3.8514913447670803`*^9, 3.851491346495552*^9}, {3.8519987975360727`*^9, 
  3.851998798237175*^9}, {3.852265992561047*^9, 3.852265998572448*^9}, {
  3.8526875159826403`*^9, 3.8526875171320972`*^9}, {3.8532319636690273`*^9, 
  3.8532319646047087`*^9}, {3.870066689192214*^9, 3.8700666894678*^9}, {
  3.870152340790832*^9, 3.87015234170282*^9}, {3.87015341690272*^9, 
  3.870153417632471*^9}, {3.870402011241747*^9, 3.8704020116642103`*^9}, {
  3.8712972317560253`*^9, 3.871297266371752*^9}, {3.871304046044794*^9, 
  3.8713040615950947`*^9}, {3.8768049123652563`*^9, 3.87680491291441*^9}, {
  3.876885071480888*^9, 3.8768850722133226`*^9}, {3.8768864180580564`*^9, 
  3.87688643185896*^9}},
 CellLabel->
  "In[203]:=",ExpressionUUID->"6e78fb49-dd55-4145-92f6-d81f0c875850"],

Cell[CellGroupData[{

Cell[BoxData["\<\"p declared as a 4-dimensional vector header.\"\>"], "Print",
 CellChangeTimes->{3.876903376747521*^9, 3.876976978476327*^9, 
  3.877066136447813*^9},
 CellLabel->
  "During evaluation of \
In[203]:=",ExpressionUUID->"77c0d194-be3f-447c-b313-b74af744322a"],

Cell[BoxData["\<\"q declared as a 4-dimensional vector header.\"\>"], "Print",
 CellChangeTimes->{3.876903376747521*^9, 3.876976978476327*^9, 
  3.877066136448687*^9},
 CellLabel->
  "During evaluation of \
In[203]:=",ExpressionUUID->"5d750e54-5717-404e-addb-1e8a678270ba"],

Cell[BoxData["\<\"l declared as a 4-dimensional vector header.\"\>"], "Print",
 CellChangeTimes->{3.876903376747521*^9, 3.876976978476327*^9, 
  3.8770661364509172`*^9},
 CellLabel->
  "During evaluation of \
In[203]:=",ExpressionUUID->"43c1d0ec-e63e-4937-a4ae-937cbccf2d32"],

Cell[BoxData["\<\"\[Epsilon] declared as a 4-dimensional vector \
header.\"\>"], "Print",
 CellChangeTimes->{3.876903376747521*^9, 3.876976978476327*^9, 
  3.877066136452066*^9},
 CellLabel->
  "During evaluation of \
In[203]:=",ExpressionUUID->"e9f7ea1a-49b8-4ecf-97fe-86e9d4494dcd"],

Cell[BoxData["\<\"v declared as a 4-dimensional vector header.\"\>"], "Print",
 CellChangeTimes->{3.876903376747521*^9, 3.876976978476327*^9, 
  3.87706613645322*^9},
 CellLabel->
  "During evaluation of \
In[203]:=",ExpressionUUID->"44f47853-2ddb-44e5-979c-041c30377738"],

Cell[BoxData["\<\"w declared as a 4-dimensional vector header.\"\>"], "Print",
 CellChangeTimes->{3.876903376747521*^9, 3.876976978476327*^9, 
  3.877066136454414*^9},
 CellLabel->
  "During evaluation of \
In[203]:=",ExpressionUUID->"01008387-4f5d-46ec-8ded-e41f913556e5"],

Cell[BoxData["\<\"link declared as a 4-dimensional vector header.\"\>"], \
"Print",
 CellChangeTimes->{3.876903376747521*^9, 3.876976978476327*^9, 
  3.877066136455637*^9},
 CellLabel->
  "During evaluation of \
In[203]:=",ExpressionUUID->"29d81112-9c58-4467-bc3a-6622836e630a"],

Cell[BoxData["\<\"as declared as a 4-dimensional vector header.\"\>"], "Print",
 CellChangeTimes->{3.876903376747521*^9, 3.876976978476327*^9, 
  3.877066136456963*^9},
 CellLabel->
  "During evaluation of \
In[203]:=",ExpressionUUID->"43606068-d00d-4e7c-b0d8-6ae3639eb6ac"],

Cell[BoxData["\<\"F declared as a 4-dimensional rank-2 tensor header.\"\>"], \
"Print",
 CellChangeTimes->{3.876903376747521*^9, 3.876976978476327*^9, 
  3.8770661364582777`*^9},
 CellLabel->
  "During evaluation of \
In[203]:=",ExpressionUUID->"2817b770-4a46-42a1-b02d-a2ec8f88687b"],

Cell[BoxData["\<\"H declared as a 4-dimensional rank-2 tensor header.\"\>"], \
"Print",
 CellChangeTimes->{3.876903376747521*^9, 3.876976978476327*^9, 
  3.877066136459415*^9},
 CellLabel->
  "During evaluation of \
In[203]:=",ExpressionUUID->"19fd4d0b-b401-49e8-b859-fc3709b00e46"],

Cell[BoxData["\<\"W declared as a 4-dimensional rank-2 tensor header.\"\>"], \
"Print",
 CellChangeTimes->{3.876903376747521*^9, 3.876976978476327*^9, 
  3.877066136460627*^9},
 CellLabel->
  "During evaluation of \
In[203]:=",ExpressionUUID->"45ecf272-b47b-4aba-a4d4-329118d9a62c"],

Cell[BoxData["\<\"V declared as a 4-dimensional rank-2 tensor header.\"\>"], \
"Print",
 CellChangeTimes->{3.876903376747521*^9, 3.876976978476327*^9, 
  3.877066136461842*^9},
 CellLabel->
  "During evaluation of \
In[203]:=",ExpressionUUID->"b9e1d34d-49f5-46d0-8025-a1b03521f574"],

Cell[BoxData["\<\"S declared as a 4-dimensional rank-2 tensor header.\"\>"], \
"Print",
 CellChangeTimes->{3.876903376747521*^9, 3.876976978476327*^9, 
  3.8770661364631157`*^9},
 CellLabel->
  "During evaluation of \
In[203]:=",ExpressionUUID->"8e65c99b-09a4-4ce0-bdec-50013074b3fb"]
}, Open  ]]
}, Open  ]]
}, Closed]],

Cell[CellGroupData[{

Cell["SubFunctions", "Section",
 CellChangeTimes->{{3.810011820953319*^9, 
  3.810011824102497*^9}},ExpressionUUID->"b2a7b427-35e1-4c90-a40a-\
a7c43f50ca5a"],

Cell[CellGroupData[{

Cell["general functions", "Subsection",
 CellChangeTimes->{{3.8717162484953003`*^9, 
  3.8717162609396152`*^9}},ExpressionUUID->"b7909353-edfe-4489-b115-\
b6a172af6d7d"],

Cell[BoxData[{
 RowBox[{"ClearAll", "[", 
  RowBox[{"SimplifyMono", ",", "SimplifyMonof"}], 
  "]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"SimplifyMono", "[", "f_", "]"}], ":=", 
  RowBox[{"Module", "[", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{"res", "=", 
      RowBox[{"f", "//", "Expand"}]}], "}"}], ",", 
    RowBox[{
     RowBox[{"If", "[", 
      RowBox[{
       RowBox[{
        RowBox[{"Head", "[", "res", "]"}], "===", "Plus"}], ",", 
       RowBox[{"res", "=", 
        RowBox[{
         RowBox[{
          RowBox[{"(", 
           RowBox[{"List", "@@", "res"}], ")"}], "//", "Simplify"}], "//", 
         "Total"}]}], ",", 
       RowBox[{"res", "=", 
        RowBox[{"Simplify", "[", "res", "]"}]}]}], "]"}], ";", "res"}]}], 
   "]"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"SimplifyMonof", "[", "f_", "]"}], ":=", 
  RowBox[{"Module", "[", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{"res", "=", 
      RowBox[{"f", "//", "Expand"}]}], "}"}], ",", 
    RowBox[{
     RowBox[{"If", "[", 
      RowBox[{
       RowBox[{
        RowBox[{"Head", "[", "res", "]"}], "===", "Plus"}], ",", 
       RowBox[{"res", "=", 
        RowBox[{
         RowBox[{
          RowBox[{"(", 
           RowBox[{"List", "@@", "res"}], ")"}], "//", "Simplify"}], "//", 
         "Total"}]}], ",", 
       RowBox[{"res", "=", 
        RowBox[{"FullSimplify", "[", "res", "]"}]}]}], "]"}], ";", "res"}]}], 
   "]"}]}]}], "Input",
 CellChangeTimes->{{3.871038879132368*^9, 3.871038905309572*^9}},
 CellLabel->
  "In[207]:=",ExpressionUUID->"b0fdc6fd-2a5b-4d84-97a3-03bddc4e6893"],

Cell[BoxData[{
 RowBox[{"ClearAll", "[", 
  RowBox[{"Collectj", ",", "Collectjf"}], "]"}], "\[IndentingNewLine]", 
 RowBox[{"Collectj", ":=", 
  RowBox[{
   RowBox[{"Collect", "[", 
    RowBox[{"#", ",", 
     RowBox[{"j", "[", "__", "]"}], ",", "Simplify"}], "]"}], 
   "&"}]}], "\[IndentingNewLine]", 
 RowBox[{"Collectjf", ":=", 
  RowBox[{
   RowBox[{"Collect", "[", 
    RowBox[{"#", ",", 
     RowBox[{"j", "[", "__", "]"}], ",", "FullSimplify"}], "]"}], 
   "&"}]}]}], "Input",
 CellChangeTimes->{{3.870563255866166*^9, 3.870563259484146*^9}, {
   3.870655391967127*^9, 3.87065539655599*^9}, 3.870655469270833*^9},
 CellLabel->
  "In[210]:=",ExpressionUUID->"277d5114-6840-4b27-9460-eac0f86cbc2c"],

Cell[BoxData[{
 RowBox[{"ClearAll", "[", 
  RowBox[{"Collectb", ",", "Collectbf"}], "]"}], "\[IndentingNewLine]", 
 RowBox[{"Collectb", ":=", 
  RowBox[{
   RowBox[{"Collect", "[", 
    RowBox[{"#", ",", 
     RowBox[{"B", "[", "__", "]"}]}], "]"}], "&"}]}], "\[IndentingNewLine]", 
 RowBox[{"Collectbf", ":=", 
  RowBox[{
   RowBox[{"Collect", "[", 
    RowBox[{"#", ",", 
     RowBox[{"B", "[", "__", "]"}], ",", 
     RowBox[{
      RowBox[{"(", 
       RowBox[{
        RowBox[{"Factor", "[", "#1", "]"}], "//", "FullSimplify"}], ")"}], 
      "&"}]}], "]"}], "&"}]}]}], "Input",
 CellChangeTimes->{{3.8705913651404657`*^9, 3.870591383682583*^9}, 
   3.870655472075412*^9, {3.870655517557816*^9, 3.870655550957642*^9}, {
   3.876611424237235*^9, 3.876611424429071*^9}},
 CellLabel->
  "In[213]:=",ExpressionUUID->"ff95a306-8b51-46ee-8bc6-3e57f67ea494"],

Cell[BoxData[{
 RowBox[{"ClearAll", "[", "Casesdot", "]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"Casesdot", "[", "f_", "]"}], ":=", 
  RowBox[{
   RowBox[{"Cases", "[", 
    RowBox[{"f", ",", 
     RowBox[{"dot", "[", "__", "]"}], ",", 
     RowBox[{"{", 
      RowBox[{"0", ",", "\[Infinity]"}], "}"}]}], "]"}], "//", 
   "Union"}]}]}], "Input",
 CellChangeTimes->{{3.871860800284142*^9, 3.871860849326124*^9}, {
   3.871860880863056*^9, 3.8718609082263327`*^9}, 3.872119829251048*^9},
 CellLabel->
  "In[216]:=",ExpressionUUID->"a76cbf43-accd-494d-bf74-aaf9211a3950"],

Cell[BoxData[
 RowBox[{"(*", 
  RowBox[{
   RowBox[{"rmzero", "=", 
    RowBox[{"{", 
     RowBox[{
      RowBox[{
       RowBox[{"dot", "[", 
        RowBox[{"v", ",", 
         RowBox[{"F", "[", "i_", "]"}], ",", "v"}], "]"}], ":>", " ", "0"}], 
      ",", 
      RowBox[{
       RowBox[{"dot", "[", 
        RowBox[{
         RowBox[{"p", "[", "]"}], ",", "f__", ",", "v"}], "]"}], ":>", " ", 
       "0"}]}], "}"}]}], ";"}], "*)"}]], "Input",
 CellChangeTimes->{3.871297375601942*^9},
 CellLabel->
  "In[218]:=",ExpressionUUID->"2787e42e-631b-4f49-a71c-b7b0e075493a"],

Cell[BoxData[{
 RowBox[{
  RowBox[{"ClearAll", "[", 
   RowBox[{"replace", ",", "repg"}], "]"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"replace", "[", 
    RowBox[{"otherDDMOrder_", ",", "n_"}], "]"}], ":=", 
   RowBox[{"Table", "[", 
    RowBox[{
     RowBox[{
      RowBox[{
       RowBox[{"(", 
        RowBox[{"p", "/@", 
         RowBox[{"Range", "[", 
          RowBox[{"n", "-", "1"}], "]"}]}], ")"}], "[", 
       RowBox[{"[", "i", "]"}], "]"}], "\[Rule]", " ", 
      RowBox[{"otherDDMOrder", "[", 
       RowBox[{"[", "i", "]"}], "]"}]}], ",", 
     RowBox[{"{", 
      RowBox[{"i", ",", 
       RowBox[{"n", "-", "1"}]}], "}"}]}], "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"repg", "[", 
   RowBox[{"a_", ",", "otherDDMOrder__"}], "]"}], ":=", 
  RowBox[{"Module", "[", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{"gg", ",", "ggod"}], "}"}], ",", 
    RowBox[{
     RowBox[{"gg", "=", 
      RowBox[{"a", "/@", 
       RowBox[{"{", "otherDDMOrder", "}"}]}]}], ";", 
     RowBox[{"ggod", "=", 
      RowBox[{"Sort", "[", "gg", "]"}]}], ";", 
     RowBox[{"Table", "[", 
      RowBox[{
       RowBox[{
        RowBox[{
         RowBox[{"(", "ggod", ")"}], "[", 
         RowBox[{"[", "i", "]"}], "]"}], "\[Rule]", " ", 
        RowBox[{
         RowBox[{"(", "gg", ")"}], "[", 
         RowBox[{"[", "i", "]"}], "]"}]}], ",", 
       RowBox[{"{", 
        RowBox[{"i", ",", 
         RowBox[{"Length", "@", "gg"}]}], "}"}]}], "]"}]}]}], 
   "]"}]}]}], "Input",
 CellChangeTimes->{{3.853809980519072*^9, 3.8538099861376333`*^9}},
 CellLabel->
  "In[219]:=",ExpressionUUID->"b4037ea5-93ff-4f7e-a16c-2ab7e7c858e0"],

Cell[BoxData[{
 RowBox[{"ClearAll", "[", 
  RowBox[{"dotOnshell", ",", "vonshell"}], "]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"dotOnshell", "[", "n_", "]"}], ":=", 
  RowBox[{"{", 
   RowBox[{
    RowBox[{
     RowBox[{"dot", "[", 
      RowBox[{
       RowBox[{"p", "[", "n", "]"}], ",", "f_"}], "]"}], "\[RuleDelayed]", 
     " ", 
     RowBox[{"-", 
      RowBox[{"Sum", "[", 
       RowBox[{
        RowBox[{"dot", "[", 
         RowBox[{
          RowBox[{"p", "[", "i", "]"}], ",", "f"}], "]"}], ",", 
        RowBox[{"{", 
         RowBox[{"i", ",", 
          RowBox[{"n", "-", "1"}]}], "}"}]}], "]"}]}]}], ",", 
    RowBox[{
     RowBox[{"dot", "[", 
      RowBox[{"f_", ",", 
       RowBox[{"p", "[", "n", "]"}]}], "]"}], "\[RuleDelayed]", " ", 
     RowBox[{"-", 
      RowBox[{"Sum", "[", 
       RowBox[{
        RowBox[{"dot", "[", 
         RowBox[{
          RowBox[{"p", "[", "i", "]"}], ",", "f"}], "]"}], ",", 
        RowBox[{"{", 
         RowBox[{"i", ",", 
          RowBox[{"n", "-", "1"}]}], "}"}]}], "]"}]}]}], ",", 
    RowBox[{
     RowBox[{"dot", "[", 
      RowBox[{
       RowBox[{"p", "[", "0", "]"}], ",", 
       RowBox[{"\[Epsilon]", "[", 
        RowBox[{"p", "[", "n", "]"}], "]"}]}], "]"}], "\[RuleDelayed]", " ", 
     RowBox[{"-", 
      RowBox[{"Sum", "[", 
       RowBox[{
        RowBox[{"dot", "[", 
         RowBox[{
          RowBox[{"p", "[", "i", "]"}], ",", 
          RowBox[{"\[Epsilon]", "[", 
           RowBox[{"p", "[", "n", "]"}], "]"}]}], "]"}], ",", 
        RowBox[{"{", 
         RowBox[{"i", ",", "1", ",", 
          RowBox[{"n", "-", "1"}]}], "}"}]}], "]"}]}]}], ",", 
    RowBox[{
     RowBox[{"dot", "[", 
      RowBox[{
       RowBox[{"\[Epsilon]", "[", 
        RowBox[{"p", "[", "n", "]"}], "]"}], ",", 
       RowBox[{"p", "[", "0", "]"}]}], "]"}], "\[RuleDelayed]", " ", 
     RowBox[{"-", 
      RowBox[{"Sum", "[", 
       RowBox[{
        RowBox[{"dot", "[", 
         RowBox[{
          RowBox[{"p", "[", "i", "]"}], ",", 
          RowBox[{"\[Epsilon]", "[", 
           RowBox[{"p", "[", "n", "]"}], "]"}]}], "]"}], ",", 
        RowBox[{"{", 
         RowBox[{"i", ",", "1", ",", 
          RowBox[{"n", "-", "1"}]}], "}"}]}], "]"}]}]}]}], 
   "}"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"vonshell", "[", 
   RowBox[{"n_", ",", "i_"}], "]"}], ":=", 
  RowBox[{"{", 
   RowBox[{
    RowBox[{"dot", "[", 
     RowBox[{"v", ",", 
      RowBox[{"p", "[", "i", "]"}]}], "]"}], "\[RuleDelayed]", " ", 
    RowBox[{"(", 
     RowBox[{
      RowBox[{"dot", "[", 
       RowBox[{"v", ",", 
        RowBox[{"p", "[", "i", "]"}]}], "]"}], "-", 
      RowBox[{"Sum", "[", 
       RowBox[{
        RowBox[{"dot", "[", 
         RowBox[{"v", ",", 
          RowBox[{"p", "[", "j", "]"}]}], "]"}], ",", 
        RowBox[{"{", 
         RowBox[{"j", ",", "1", ",", 
          RowBox[{"n", "-", "1"}]}], "}"}]}], "]"}]}], ")"}]}], 
   "}"}]}]}], "Input",
 CellChangeTimes->{{3.727163684521564*^9, 3.727163712580194*^9}, 
   3.728198771127473*^9, {3.7282976424483356`*^9, 3.728297678974709*^9}, {
   3.728297723296649*^9, 3.72829773196879*^9}, {3.7492963246076107`*^9, 
   3.749296346599493*^9}, {3.7492969402526007`*^9, 3.749296945367785*^9}, {
   3.756962173926325*^9, 3.756962173952697*^9}, {3.756962214008494*^9, 
   3.756962214036718*^9}, {3.756962285466909*^9, 3.7569622869241734`*^9}, {
   3.756970904201673*^9, 3.7569709322363663`*^9}, {3.759113304523664*^9, 
   3.759113331527665*^9}, {3.759113382631379*^9, 3.759113498024493*^9}, {
   3.759592650632361*^9, 3.759592657996381*^9}, {3.810004273599478*^9, 
   3.8100042908157053`*^9}, {3.813368130768548*^9, 3.813368161218802*^9}, {
   3.8133682014741793`*^9, 3.813368212397605*^9}, {3.813542982230701*^9, 
   3.813543013179331*^9}, {3.813546153285891*^9, 3.813546158120234*^9}, {
   3.813546308456645*^9, 3.8135463101535473`*^9}, {3.8135464926562147`*^9, 
   3.813546546885747*^9}, 3.813546667616501*^9, {3.813547074493762*^9, 
   3.8135470808592043`*^9}, {3.813547399867567*^9, 3.813547441608583*^9}, {
   3.813559656501801*^9, 3.813559667068569*^9}, {3.8135597068041677`*^9, 
   3.813559710282649*^9}, {3.813559768037219*^9, 3.813559779622561*^9}, {
   3.813560124477251*^9, 3.813560131135003*^9}, {3.813560238138142*^9, 
   3.813560266973859*^9}, {3.813560313088909*^9, 3.81356032625429*^9}, {
   3.8135603625794773`*^9, 3.813560379883116*^9}, {3.813562756751007*^9, 
   3.8135627570797586`*^9}, 3.813587217305232*^9, {3.813631538481387*^9, 
   3.813631541035822*^9}, {3.8136340222518473`*^9, 3.813634050518487*^9}, {
   3.843431280830508*^9, 3.843431302343697*^9}, {3.843553240936262*^9, 
   3.8435532494635687`*^9}, {3.843553679143483*^9, 3.843553679792428*^9}, {
   3.843553831340781*^9, 3.843553834894973*^9}},
 CellLabel->
  "In[222]:=",ExpressionUUID->"6d280527-7a65-48d0-a19d-73ee85d09955"],

Cell[BoxData[{
 RowBox[{"ClearAll", "[", 
  RowBox[{
  "sortS", ",", "zeroMomentum", ",", "onshell", ",", "onshellQCD", ",", 
   "massless"}], "]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"sortS", "=", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"s", "[", 
      RowBox[{"i_", ",", "j_"}], "]"}], "\[RuleDelayed]", 
     RowBox[{"Sort", "[", 
      RowBox[{"s", "[", 
       RowBox[{"i", ",", "j"}], "]"}], "]"}]}], "}"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"zeroMomentum", "[", "n_", "]"}], ":=", 
  RowBox[{
   RowBox[{"s", "[", 
    RowBox[{"i_", ",", "n"}], "]"}], "\[RuleDelayed]", 
   RowBox[{"-", 
    RowBox[{"Sum", "[", 
     RowBox[{
      RowBox[{"s", "[", 
       RowBox[{"i", ",", "j"}], "]"}], ",", 
      RowBox[{"{", 
       RowBox[{"j", ",", 
        RowBox[{"n", "-", "1"}]}], "}"}]}], 
     "]"}]}]}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"onshell", "[", "n_", "]"}], ":=", 
  RowBox[{
   RowBox[{"s", "[", 
    RowBox[{
     RowBox[{"n", "-", "2"}], ",", 
     RowBox[{"n", "-", "1"}]}], "]"}], "\[Rule]", "  ", 
   RowBox[{
    RowBox[{"-", 
     RowBox[{"Total", "[", 
      RowBox[{
       RowBox[{"Table", "[", 
        RowBox[{
         RowBox[{"Table", "[", 
          RowBox[{
           RowBox[{"s", "[", 
            RowBox[{"i", ",", "j"}], "]"}], ",", 
           RowBox[{"{", 
            RowBox[{"i", ",", 
             RowBox[{"j", "-", "1"}]}], "}"}]}], "]"}], ",", 
         RowBox[{"{", 
          RowBox[{"j", ",", 
           RowBox[{"n", "-", "1"}]}], "}"}]}], "]"}], "//", "Flatten"}], 
      "]"}]}], "+", 
    RowBox[{"s", "[", 
     RowBox[{
      RowBox[{"n", "-", "2"}], ",", 
      RowBox[{"n", "-", "1"}]}], "]"}]}]}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"onshellQCD", "[", "n_", "]"}], ":=", 
  RowBox[{
   RowBox[{"s", "[", 
    RowBox[{
     RowBox[{"n", "-", "2"}], ",", 
     RowBox[{"n", "-", "1"}]}], "]"}], "\[Rule]", "  ", 
   RowBox[{
    RowBox[{"-", 
     RowBox[{"Total", "[", 
      RowBox[{
       RowBox[{"Table", "[", 
        RowBox[{
         RowBox[{"Table", "[", 
          RowBox[{
           RowBox[{"s", "[", 
            RowBox[{"i", ",", "j"}], "]"}], ",", 
           RowBox[{"{", 
            RowBox[{"i", ",", "0", ",", 
             RowBox[{"j", "-", "1"}]}], "}"}]}], "]"}], ",", 
         RowBox[{"{", 
          RowBox[{"j", ",", 
           RowBox[{"n", "-", "1"}]}], "}"}]}], "]"}], "//", "Flatten"}], 
      "]"}]}], "+", 
    RowBox[{"s", "[", 
     RowBox[{
      RowBox[{"n", "-", "2"}], ",", 
      RowBox[{"n", "-", "1"}]}], "]"}]}]}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"massless", "=", 
   RowBox[{
    RowBox[{"s", "[", 
     RowBox[{"i_", ",", "i_"}], "]"}], "\[RuleDelayed]", "0"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{"ClearAll", "[", 
  RowBox[{"sortP", ",", "sortE"}], "]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"sortP", "[", 
   RowBox[{"li_", ",", "lr_"}], "]"}], ":=", 
  RowBox[{"SortBy", "[", 
   RowBox[{"li", ",", " ", 
    RowBox[{
     RowBox[{"Position", "[", 
      RowBox[{"lr", ",", 
       RowBox[{"(", 
        RowBox[{"First", "@", "#"}], ")"}]}], "]"}], "&"}]}], 
   "]"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"sortE", "[", 
   RowBox[{"li_", ",", "lr_"}], "]"}], ":=", 
  RowBox[{"SortBy", "[", 
   RowBox[{"li", ",", " ", 
    RowBox[{
     RowBox[{"Position", "[", 
      RowBox[{"lr", ",", 
       RowBox[{"(", 
        RowBox[{"First", "@@", "#"}], ")"}]}], "]"}], "&"}]}], 
   "]"}]}], "\[IndentingNewLine]", 
 RowBox[{"ClearAll", "[", "repBack", "]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"repBack", "=", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{
      RowBox[{"Subscript", "[", 
       RowBox[{"a_", ",", "i_"}], "]"}], ":>", " ", 
      RowBox[{"a", "[", "i", "]"}]}], ",", 
     RowBox[{"CenterDot", "->", " ", "dot"}]}], "}"}]}], 
  ";"}], "\[IndentingNewLine]"}], "Input",
 CellChangeTimes->{
  3.727163681618944*^9, {3.749179480748872*^9, 3.749179491659102*^9}, {
   3.749296395909049*^9, 3.7492964230074463`*^9}, {3.74929688390792*^9, 
   3.74929689475134*^9}, 3.756962173957769*^9, 3.7569622140447397`*^9, {
   3.756962309850726*^9, 3.7569623219178553`*^9}, {3.75697119019627*^9, 
   3.756971194962592*^9}, {3.810006123538918*^9, 3.810006130187482*^9}, {
   3.813643784231852*^9, 3.813643813331348*^9}, 3.841472859500243*^9, {
   3.851849638478299*^9, 3.851849659664133*^9}, {3.854063182750596*^9, 
   3.854063189346609*^9}},
 CellLabel->
  "In[225]:=",ExpressionUUID->"0e2780f7-f3c5-41e4-a82a-2661c1254c1e"],

Cell[BoxData[{
 RowBox[{"ClearAll", "[", "V2spBracket", "]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"V2spBracket", "=", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{
      RowBox[{"J", "[", 
       RowBox[{"_", ",", "f_", ",", "m_"}], "]"}], "\[RuleDelayed]", " ", 
      RowBox[{"spBracket", "[", 
       RowBox[{
        RowBox[{"spB", "[", "\[Beta]", "]"}], ",", 
        RowBox[{"f", "/.", 
         RowBox[{
          RowBox[{"CircleTimes", "[", "g___", "]"}], "\[RuleDelayed]", " ", 
          "g"}]}], ",", 
        RowBox[{"spA", "[", "\[Alpha]", "]"}]}], "]"}]}], ",", 
     RowBox[{
      RowBox[{"J", "[", 
       RowBox[{"_", ",", "f_"}], "]"}], "\[RuleDelayed]", " ", 
      RowBox[{"spBracket", "[", 
       RowBox[{
        RowBox[{"spB", "[", "\[Beta]", "]"}], ",", 
        RowBox[{"f", "/.", 
         RowBox[{
          RowBox[{"CircleTimes", "[", "g___", "]"}], "\[RuleDelayed]", " ", 
          "g"}]}], ",", 
        RowBox[{"spA", "[", "\[Alpha]", "]"}]}], "]"}]}]}], "}"}]}], 
  ";"}]}], "Input",
 CellChangeTimes->{{3.849943435749509*^9, 3.8499434443014603`*^9}},
 CellLabel->
  "In[236]:=",ExpressionUUID->"c9dd0306-42c7-4192-b891-8337c9f7440c"],

Cell[BoxData[{
 RowBox[{"ClearAll", "[", 
  RowBox[{"cyclePermute", ",", "cyclePermuteSum"}], 
  "]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"cyclePermute", "[", "n_", "]"}], ":=", 
  RowBox[{"Module", "[", 
   RowBox[{
    RowBox[{"{", "list", "}"}], ",", 
    RowBox[{
     RowBox[{"list", "=", 
      RowBox[{"Permute", "[", " ", 
       RowBox[{
        RowBox[{"Table", "[", 
         RowBox[{
          RowBox[{"p", "[", "i", "]"}], ",", 
          RowBox[{"{", 
           RowBox[{"i", ",", "n"}], "}"}]}], "]"}], ",", " ", 
        RowBox[{"Cycles", "[", 
         RowBox[{"{", 
          RowBox[{"Table", "[", 
           RowBox[{"i", ",", 
            RowBox[{"{", 
             RowBox[{"i", ",", "n"}], "}"}]}], "]"}], "}"}], "]"}]}], "]"}]}],
      ";", 
     RowBox[{"Table", "[", 
      RowBox[{
       RowBox[{"Rule", "[", 
        RowBox[{
         RowBox[{"p", "[", "i", "]"}], ",", 
         RowBox[{"list", "[", 
          RowBox[{"[", "i", "]"}], "]"}]}], "]"}], ",", 
       RowBox[{"{", 
        RowBox[{"i", ",", "n"}], "}"}]}], "]"}]}]}], 
   "]"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"cyclePermuteSum", "[", 
   RowBox[{"f_", ",", "n_"}], "]"}], ":=", 
  RowBox[{"Module", "[", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{"fsum", ",", 
      RowBox[{"g", "=", 
       RowBox[{"Table", "[", 
        RowBox[{"0", ",", 
         RowBox[{"{", 
          RowBox[{"i", ",", "n"}], "}"}]}], "]"}]}]}], "}"}], ",", 
    RowBox[{
     RowBox[{
      RowBox[{"g", "[", 
       RowBox[{"[", "1", "]"}], "]"}], "=", "f"}], ";", 
     RowBox[{"Do", "[", 
      RowBox[{
       RowBox[{
        RowBox[{"g", "[", 
         RowBox[{"[", 
          RowBox[{"i", "+", "1"}], "]"}], "]"}], "=", 
        RowBox[{
         RowBox[{"g", "[", 
          RowBox[{"[", "i", "]"}], "]"}], "/.", 
         RowBox[{"cyclePermute", "[", "n", "]"}]}]}], ",", 
       RowBox[{"{", 
        RowBox[{"i", ",", 
         RowBox[{"n", "-", "1"}]}], "}"}]}], "]"}], ";", " ", 
     RowBox[{"fsum", "=", 
      RowBox[{"Sum", "[", 
       RowBox[{
        RowBox[{"g", "[", 
         RowBox[{"[", "i", "]"}], "]"}], ",", 
        RowBox[{"{", 
         RowBox[{"i", ",", "n"}], "}"}]}], "]"}]}]}]}], "]"}]}]}], "Input",
 CellChangeTimes->{3.7595925973087378`*^9},
 CellLabel->
  "In[238]:=",ExpressionUUID->"766abd2e-1994-4be7-9ee6-2a6d0f82c59e"],

Cell[BoxData[{
 RowBox[{"ClearAll", "[", 
  RowBox[{"leadingSeries", ",", "LdTerm"}], "]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"leadingSeries", "[", 
   RowBox[{"expr_", ",", 
    RowBox[{"{", 
     RowBox[{"x_", ",", "x0_"}], "}"}]}], "]"}], ":=", 
  RowBox[{"Normal", "[", 
   RowBox[{
    RowBox[{"expr", "/.", 
     RowBox[{"x", "\[Rule]", 
      RowBox[{"Series", "[", 
       RowBox[{"x", ",", 
        RowBox[{"{", 
         RowBox[{"x", ",", "x0", ",", "1"}], "}"}]}], "]"}]}]}], "/.", 
    RowBox[{
     RowBox[{
      RowBox[{"Verbatim", "[", "SeriesData", "]"}], "[", 
      RowBox[{"a__", ",", 
       RowBox[{"{", 
        RowBox[{"b_", ",", "___"}], "}"}], ",", "c__"}], "]"}], 
     "\[RuleDelayed]", 
     RowBox[{"SeriesData", "[", 
      RowBox[{"a", ",", 
       RowBox[{"{", "b", "}"}], ",", "c"}], "]"}]}]}], "]"}]}], "\n", 
 RowBox[{
  RowBox[{"LdTerm", "[", 
   RowBox[{"f_", ",", "var_"}], "]"}], ":=", 
  RowBox[{
   RowBox[{"leadingSeries", "[", 
    RowBox[{"f", ",", 
     RowBox[{"{", 
      RowBox[{"var", ",", "\[Infinity]"}], "}"}]}], "]"}], "//", 
   "Normal"}]}]}], "Input",
 CellLabel->
  "In[241]:=",ExpressionUUID->"f32e72bc-d9f0-4994-aff5-11032f993f2a"]
}, Closed]],

Cell[CellGroupData[{

Cell["Expand Tensors", "Subsection",
 CellChangeTimes->{{3.871715923985506*^9, 
  3.8717159306720257`*^9}},ExpressionUUID->"addba1f0-8dba-4a70-a842-\
39e531ea60a6"],

Cell[BoxData[{
 RowBox[{"ClearAll", "[", 
  RowBox[{"expandTdot", ",", "expandT"}], "]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"expandTdot", "[", "f_", "]"}], ":=", 
  RowBox[{
   RowBox[{"(", 
    RowBox[{
     RowBox[{
      RowBox[{
       RowBox[{"f", "/.", 
        RowBox[{
         RowBox[{"dot", "[", "g___", "]"}], "\[RuleDelayed]", " ", 
         RowBox[{"expandTensor", "[", 
          RowBox[{"dot", "[", "g", "]"}], "]"}]}]}], "/.", 
       RowBox[{
        RowBox[{
         RowBox[{"F", "[", "i_", "]"}], "[", 
         RowBox[{"a_", ",", "b_"}], "]"}], "\[RuleDelayed]", " ", 
        RowBox[{
         RowBox[{
          RowBox[{
           RowBox[{"p", "[", "i", "]"}], "[", "a", "]"}], 
          RowBox[{
           RowBox[{"\[Epsilon]", "[", "i", "]"}], "[", "b", "]"}]}], "-", 
         RowBox[{
          RowBox[{
           RowBox[{"\[Epsilon]", "[", "i", "]"}], "[", "a", "]"}], 
          RowBox[{
           RowBox[{"p", "[", "i", "]"}], "[", "b", "]"}]}]}]}]}], "/.", 
      RowBox[{
       RowBox[{
        RowBox[{"W", "[", "i_", "]"}], "[", 
        RowBox[{"a_", ",", "b_"}], "]"}], "\[RuleDelayed]", " ", 
       RowBox[{
        RowBox[{
         RowBox[{
          RowBox[{"p", "[", "i", "]"}], "[", "a", "]"}], 
         RowBox[{
          RowBox[{"v", "[", "i", "]"}], "[", "b", "]"}]}], "-", 
        RowBox[{
         RowBox[{
          RowBox[{"v", "[", "i", "]"}], "[", "a", "]"}], 
         RowBox[{
          RowBox[{"p", "[", "i", "]"}], "[", "b", "]"}]}]}]}]}], "/.", 
     RowBox[{
      RowBox[{
       RowBox[{"V", "[", "i___", "]"}], "[", 
       RowBox[{"a_", ",", "b_"}], "]"}], "\[RuleDelayed]", " ", 
      RowBox[{
       RowBox[{
        RowBox[{"v", "[", "0", "]"}], "[", "a", "]"}], 
       RowBox[{
        RowBox[{"p", "[", "i", "]"}], "[", "b", "]"}]}]}]}], ")"}], "//", 
   "contract"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"expandT", "[", "f_", "]"}], ":=", " ", 
  RowBox[{"f", "/.", 
   RowBox[{
    RowBox[{"dot", "[", "g___", "]"}], "\[RuleDelayed]", " ", 
    RowBox[{"expandTdot", "[", 
     RowBox[{"dot", "[", "g", "]"}], "]"}]}]}]}], "\[IndentingNewLine]", 
 RowBox[{"ClearAll", "[", 
  RowBox[{"expandTensorGen", ",", "expandF"}], "]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"expandTensorGen", "[", "f_", "]"}], ":=", 
  RowBox[{"Module", "[", 
   RowBox[{
    RowBox[{"{", "res", "}"}], ",", 
    RowBox[{
     RowBox[{"res", "=", 
      RowBox[{"f", "//.", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{
          RowBox[{"Power", "[", 
           RowBox[{
            RowBox[{"dot", "[", "g__", "]"}], ",", "nn_"}], "]"}], ":>", 
          RowBox[{
           RowBox[{"DC", "@@", 
            RowBox[{"Table", "[", 
             RowBox[{
              RowBox[{"dot", "[", "g", "]"}], ",", 
              RowBox[{"{", 
               RowBox[{"ii", ",", "nn"}], "}"}]}], "]"}]}], "/;", 
           RowBox[{"nn", ">", "0"}]}]}], ",", 
         RowBox[{
          RowBox[{"Times", "[", 
           RowBox[{
            RowBox[{"dot", "[", "g__", "]"}], ",", 
            RowBox[{"dot", "[", "h__", "]"}]}], "]"}], ":>", 
          RowBox[{"DC", "[", 
           RowBox[{
            RowBox[{"dot", "[", "g", "]"}], ",", 
            RowBox[{"dot", "[", "h", "]"}]}], "]"}]}], ",", 
         RowBox[{
          RowBox[{"Times", "[", 
           RowBox[{
            RowBox[{"DC", "[", "g__", "]"}], ",", 
            RowBox[{"dot", "[", "h__", "]"}]}], "]"}], ":>", 
          RowBox[{"DC", "[", 
           RowBox[{"g", ",", 
            RowBox[{"dot", "[", "h", "]"}]}], "]"}]}], ",", 
         RowBox[{
          RowBox[{"Times", "[", 
           RowBox[{
            RowBox[{"dot", "[", "h__", "]"}], ",", 
            RowBox[{"DC", "[", "g__", "]"}]}], "]"}], ":>", 
          RowBox[{"DC", "[", 
           RowBox[{
            RowBox[{"dot", "[", "h", "]"}], ",", "g"}], "]"}]}], ",", 
         RowBox[{
          RowBox[{"Times", "[", 
           RowBox[{
            RowBox[{"DC", "[", "h__", "]"}], ",", 
            RowBox[{"DC", "[", "g__", "]"}]}], "]"}], ":>", 
          RowBox[{"DC", "[", 
           RowBox[{"h", ",", "g"}], "]"}]}]}], "}"}]}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"(*", 
      RowBox[{
       RowBox[{"Print", "[", "res", "]"}], ";"}], "*)"}], 
     "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{
       RowBox[{"res", "/.", 
        RowBox[{
         RowBox[{"dot", "[", "g__", "]"}], ":>", 
         RowBox[{"expandTensor", "[", 
          RowBox[{"dot", "[", "g", "]"}], "]"}]}]}], "/.", 
       RowBox[{
        RowBox[{"DC", "[", "g__", "]"}], ":>", 
        RowBox[{"DC", "@@", 
         RowBox[{"Table", "[", 
          RowBox[{
           RowBox[{
            RowBox[{
             RowBox[{"{", "g", "}"}], "[", 
             RowBox[{"[", "ii", "]"}], "]"}], "/.", 
            RowBox[{
             RowBox[{"lI", "[", "ids__", "]"}], ":>", 
             RowBox[{"lI", "[", 
              RowBox[{"ii", ",", "ids"}], "]"}]}]}], ",", 
           RowBox[{"{", 
            RowBox[{"ii", ",", 
             RowBox[{"Length", "@", 
              RowBox[{"{", "g", "}"}]}]}], "}"}]}], "]"}]}]}]}], "/.", 
      RowBox[{"DC", "->", "Times"}]}]}]}], "\[IndentingNewLine]", 
   "]"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"expandF", "[", 
   RowBox[{"f_", ",", "id_"}], "]"}], ":=", 
  RowBox[{"f", "/.", 
   RowBox[{
    RowBox[{
     RowBox[{"F", "[", "id", "]"}], "[", 
     RowBox[{"a_", ",", "b_"}], "]"}], "\[RuleDelayed]", " ", 
    RowBox[{
     RowBox[{
      RowBox[{
       RowBox[{"p", "[", "id", "]"}], "[", "a", "]"}], 
      RowBox[{
       RowBox[{"\[Epsilon]", "[", "id", "]"}], "[", "b", "]"}]}], "-", 
     RowBox[{
      RowBox[{
       RowBox[{"\[Epsilon]", "[", "id", "]"}], "[", "a", "]"}], 
      RowBox[{
       RowBox[{"p", "[", "id", "]"}], "[", "b", 
       "]"}]}]}]}]}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"expandF", "[", "f_", "]"}], ":=", 
  RowBox[{"f", "/.", 
   RowBox[{
    RowBox[{
     RowBox[{"F", "[", "id_", "]"}], "[", 
     RowBox[{"a_", ",", "b_"}], "]"}], "\[RuleDelayed]", " ", 
    RowBox[{
     RowBox[{
      RowBox[{
       RowBox[{"p", "[", "id", "]"}], "[", "a", "]"}], 
      RowBox[{
       RowBox[{"\[Epsilon]", "[", "id", "]"}], "[", "b", "]"}]}], "-", 
     RowBox[{
      RowBox[{
       RowBox[{"\[Epsilon]", "[", "id", "]"}], "[", "a", "]"}], 
      RowBox[{
       RowBox[{"p", "[", "id", "]"}], "[", "b", "]"}]}]}]}]}]}]}], "Input",
 CellChangeTimes->{{3.8519988490005493`*^9, 3.8519988586312313`*^9}, {
  3.852266080976235*^9, 3.852266083544794*^9}, {3.8522661271732883`*^9, 
  3.8522661315239162`*^9}, {3.8522662312904997`*^9, 3.8522662509717417`*^9}, {
  3.852342321299981*^9, 3.852342321961708*^9}, {3.852342379535592*^9, 
  3.852342380584991*^9}, {3.871691418979636*^9, 3.871691419907322*^9}, {
  3.87169145976577*^9, 3.871691475455221*^9}, {3.871691506816244*^9, 
  3.8716916564787827`*^9}, {3.871691706084654*^9, 3.871691733103662*^9}, {
  3.8717067770260687`*^9, 3.871706787951022*^9}, {3.871706897332698*^9, 
  3.871706919266697*^9}},
 CellLabel->
  "In[244]:=",ExpressionUUID->"25d854a1-74df-4623-95a9-569a4bdc49f1"],

Cell[BoxData[{
 RowBox[{"ClearAll", "[", "dressdot", "]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"dressdot", "[", "f_", "]"}], ":=", 
  RowBox[{"Module", "[", 
   RowBox[{
    RowBox[{"{", "res", "}"}], ",", 
    RowBox[{"res", "=", 
     RowBox[{
      RowBox[{"f", "/.", 
       RowBox[{
        RowBox[{"dot", "[", 
         RowBox[{"g_", ",", 
          RowBox[{"\[Epsilon]", "[", "id_", "]"}]}], "]"}], ":>", 
        RowBox[{
         RowBox[{"g", "[", 
          RowBox[{"lI", "[", 
           RowBox[{"0", ",", "id"}], "]"}], "]"}], 
         RowBox[{
          RowBox[{"\[Epsilon]", "[", "id", "]"}], "[", 
          RowBox[{"lI", "[", 
           RowBox[{"0", ",", "id"}], "]"}], "]"}]}]}]}], "/.", 
      RowBox[{
       RowBox[{"dot", "[", 
        RowBox[{
         RowBox[{"\[Epsilon]", "[", "id_", "]"}], ",", "g_"}], "]"}], ":>", 
       RowBox[{
        RowBox[{"g", "[", 
         RowBox[{"lI", "[", 
          RowBox[{"0", ",", "id"}], "]"}], "]"}], 
        RowBox[{
         RowBox[{"\[Epsilon]", "[", "id", "]"}], "[", 
         RowBox[{"lI", "[", 
          RowBox[{"0", ",", "id"}], "]"}], "]"}]}]}]}]}]}], 
   "\[IndentingNewLine]", "]"}]}], "\[IndentingNewLine]", 
 RowBox[{"ClearAll", "[", "dressdotGen", "]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"dressdotGen", "[", "f_", "]"}], ":=", 
  RowBox[{"Module", "[", 
   RowBox[{
    RowBox[{"{", "res", "}"}], ",", 
    RowBox[{
     RowBox[{"res", "=", 
      RowBox[{"f", "//", "Expand"}]}], ";", 
     RowBox[{"res", "=", 
      RowBox[{"res", "//.", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{
          RowBox[{"Power", "[", 
           RowBox[{
            RowBox[{"dot", "[", "g__", "]"}], ",", "nn_"}], "]"}], ":>", 
          RowBox[{
           RowBox[{"DC", "@@", 
            RowBox[{"Table", "[", 
             RowBox[{
              RowBox[{"dot", "[", "g", "]"}], ",", 
              RowBox[{"{", 
               RowBox[{"ii", ",", "nn"}], "}"}]}], "]"}]}], "/;", 
           RowBox[{"nn", ">", "0"}]}]}], ",", 
         RowBox[{
          RowBox[{"Times", "[", 
           RowBox[{
            RowBox[{"dot", "[", "g__", "]"}], ",", 
            RowBox[{"dot", "[", "h__", "]"}]}], "]"}], ":>", 
          RowBox[{"DC", "[", 
           RowBox[{
            RowBox[{"dot", "[", "g", "]"}], ",", 
            RowBox[{"dot", "[", "h", "]"}]}], "]"}]}], ",", 
         RowBox[{
          RowBox[{"Times", "[", 
           RowBox[{
            RowBox[{"DC", "[", "g__", "]"}], ",", 
            RowBox[{"dot", "[", "h__", "]"}]}], "]"}], ":>", 
          RowBox[{"DC", "[", 
           RowBox[{"g", ",", 
            RowBox[{"dot", "[", "h", "]"}]}], "]"}]}], ",", 
         RowBox[{
          RowBox[{"Times", "[", 
           RowBox[{
            RowBox[{"dot", "[", "h__", "]"}], ",", 
            RowBox[{"DC", "[", "g__", "]"}]}], "]"}], ":>", 
          RowBox[{"DC", "[", 
           RowBox[{
            RowBox[{"dot", "[", "h", "]"}], ",", "g"}], "]"}]}], ",", 
         RowBox[{
          RowBox[{"Times", "[", 
           RowBox[{
            RowBox[{"DC", "[", "h__", "]"}], ",", 
            RowBox[{"DC", "[", "g__", "]"}]}], "]"}], ":>", 
          RowBox[{"DC", "[", 
           RowBox[{"h", ",", "g"}], "]"}]}]}], "}"}]}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"(*", 
      RowBox[{
       RowBox[{"Print", "[", "res", "]"}], ";"}], "*)"}], 
     "\[IndentingNewLine]", 
     RowBox[{"res", "=", 
      RowBox[{"res", "//", "dressdot"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"res", "/.", 
       RowBox[{
        RowBox[{"DC", "[", "g__", "]"}], ":>", 
        RowBox[{"DC", "@@", 
         RowBox[{"Table", "[", 
          RowBox[{
           RowBox[{
            RowBox[{
             RowBox[{"{", "g", "}"}], "[", 
             RowBox[{"[", "ii", "]"}], "]"}], "/.", 
            RowBox[{
             RowBox[{"lI", "[", "ids__", "]"}], ":>", 
             RowBox[{"lI", "[", 
              RowBox[{"ii", ",", "ids"}], "]"}]}]}], ",", 
           RowBox[{"{", 
            RowBox[{"ii", ",", 
             RowBox[{"Length", "@", 
              RowBox[{"{", "g", "}"}]}]}], "}"}]}], "]"}]}]}]}], "/.", 
      RowBox[{"DC", "->", "Times"}]}]}]}], "\[IndentingNewLine]", 
   "]"}]}]}], "Input",
 CellChangeTimes->{
  3.872034945418346*^9, {3.8720349907917633`*^9, 3.872034993209223*^9}, {
   3.872036261541153*^9, 3.872036291395546*^9}, {3.872036858716271*^9, 
   3.872036870110409*^9}},
 CellLabel->
  "In[251]:=",ExpressionUUID->"2af12f84-7c89-4e30-937a-85d000898838"],

Cell[BoxData[{
 RowBox[{"ClearAll", "[", "expandGen", "]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"expandGen", "[", "f_", "]"}], ":=", 
  RowBox[{"Module", "[", 
   RowBox[{
    RowBox[{"{", "res", "}"}], ",", 
    RowBox[{
     RowBox[{"res", "=", 
      RowBox[{"f", "//.", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{
          RowBox[{"Power", "[", 
           RowBox[{
            RowBox[{"dot", "[", "g__", "]"}], ",", "nn_"}], "]"}], ":>", 
          RowBox[{
           RowBox[{"DC", "@@", 
            RowBox[{"Table", "[", 
             RowBox[{
              RowBox[{"dot", "[", "g", "]"}], ",", 
              RowBox[{"{", 
               RowBox[{"ii", ",", "nn"}], "}"}]}], "]"}]}], "/;", 
           RowBox[{"nn", ">", "0"}]}]}], ",", 
         RowBox[{
          RowBox[{"Times", "[", 
           RowBox[{
            RowBox[{"dot", "[", "g__", "]"}], ",", 
            RowBox[{"dot", "[", "h__", "]"}]}], "]"}], ":>", 
          RowBox[{"DC", "[", 
           RowBox[{
            RowBox[{"dot", "[", "g", "]"}], ",", 
            RowBox[{"dot", "[", "h", "]"}]}], "]"}]}], ",", 
         RowBox[{
          RowBox[{"Times", "[", 
           RowBox[{
            RowBox[{"DC", "[", "g__", "]"}], ",", 
            RowBox[{"dot", "[", "h__", "]"}]}], "]"}], ":>", 
          RowBox[{"DC", "[", 
           RowBox[{"g", ",", 
            RowBox[{"dot", "[", "h", "]"}]}], "]"}]}], ",", 
         RowBox[{
          RowBox[{"Times", "[", 
           RowBox[{
            RowBox[{"dot", "[", "h__", "]"}], ",", 
            RowBox[{"DC", "[", "g__", "]"}]}], "]"}], ":>", 
          RowBox[{"DC", "[", 
           RowBox[{
            RowBox[{"dot", "[", "h", "]"}], ",", "g"}], "]"}]}], ",", 
         RowBox[{
          RowBox[{"Times", "[", 
           RowBox[{
            RowBox[{"DC", "[", "h__", "]"}], ",", 
            RowBox[{"DC", "[", "g__", "]"}]}], "]"}], ":>", 
          RowBox[{"DC", "[", 
           RowBox[{"h", ",", "g"}], "]"}]}]}], "}"}]}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"(*", 
      RowBox[{
       RowBox[{"Print", "[", "res", "]"}], ";"}], "*)"}], 
     "\[IndentingNewLine]", 
     RowBox[{"res", "=", 
      RowBox[{"res", "//", "dressdot"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{
       RowBox[{"res", "/.", 
        RowBox[{
         RowBox[{"dot", "[", "g__", "]"}], ":>", 
         RowBox[{"expandTensor", "[", 
          RowBox[{"dot", "[", "g", "]"}], "]"}]}]}], "/.", 
       RowBox[{
        RowBox[{"DC", "[", "g__", "]"}], ":>", 
        RowBox[{"DC", "@@", 
         RowBox[{"Table", "[", 
          RowBox[{
           RowBox[{
            RowBox[{
             RowBox[{"{", "g", "}"}], "[", 
             RowBox[{"[", "ii", "]"}], "]"}], "/.", 
            RowBox[{
             RowBox[{"lI", "[", "ids__", "]"}], ":>", 
             RowBox[{"lI", "[", 
              RowBox[{"ii", ",", "ids"}], "]"}]}]}], ",", 
           RowBox[{"{", 
            RowBox[{"ii", ",", 
             RowBox[{"Length", "@", 
              RowBox[{"{", "g", "}"}]}]}], "}"}]}], "]"}]}]}]}], "/.", 
      RowBox[{"DC", "->", "Times"}]}]}]}], "\[IndentingNewLine]", 
   "]"}]}]}], "Input",
 CellChangeTimes->{{3.872034492365653*^9, 3.872034567286909*^9}, {
  3.8720347035629787`*^9, 3.872034758097516*^9}, {3.8720350050883617`*^9, 
  3.87203501817365*^9}},
 CellLabel->
  "In[255]:=",ExpressionUUID->"15142c20-db64-48bf-b52c-91556a986f38"],

Cell[BoxData[{
 RowBox[{"ClearAll", "[", "FTensorReduce", "]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"FTensorReduce", "[", "f_", "]"}], ":=", 
  RowBox[{"f", "/.", 
   RowBox[{
    RowBox[{"dot", "[", 
     RowBox[{"a__", ",", 
      RowBox[{"F", "[", "i_", "]"}], ",", "b__"}], "]"}], ":>", " ", 
    RowBox[{
     RowBox[{
      FractionBox["1", 
       RowBox[{"dot", "[", 
        RowBox[{
         RowBox[{"v", "[", "2", "]"}], ",", 
         RowBox[{"p", "[", "i", "]"}]}], "]"}]], 
      RowBox[{"(", 
       RowBox[{
        RowBox[{
         RowBox[{"dot", "[", 
          RowBox[{"a", ",", 
           RowBox[{"F", "[", "i", "]"}], ",", 
           RowBox[{"v", "[", "2", "]"}]}], "]"}], 
         RowBox[{"dot", "[", 
          RowBox[{
           RowBox[{"p", "[", "i", "]"}], ",", "b"}], "]"}]}], "+", 
        RowBox[{
         RowBox[{"dot", "[", 
          RowBox[{
           RowBox[{"v", "[", "2", "]"}], ",", 
           RowBox[{"F", "[", "i", "]"}], ",", "b"}], "]"}], 
         RowBox[{"dot", "[", 
          RowBox[{"a", ",", 
           RowBox[{"p", "[", "i", "]"}]}], "]"}]}]}], ")"}]}], "/;", 
     RowBox[{"b", "=!=", 
      RowBox[{"v", "[", "2", "]"}]}]}]}]}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"FTensorReduce", "[", 
   RowBox[{"f_", ",", "v2_"}], "]"}], ":=", 
  RowBox[{"f", "/.", 
   RowBox[{
    RowBox[{"dot", "[", 
     RowBox[{"a__", ",", 
      RowBox[{"F", "[", "i_", "]"}], ",", "b__"}], "]"}], ":>", " ", 
    RowBox[{
     RowBox[{
      FractionBox["1", 
       RowBox[{"dot", "[", 
        RowBox[{"v2", ",", 
         RowBox[{"p", "[", "i", "]"}]}], "]"}]], 
      RowBox[{"(", 
       RowBox[{
        RowBox[{
         RowBox[{"dot", "[", 
          RowBox[{"a", ",", 
           RowBox[{"F", "[", "i", "]"}], ",", "v2"}], "]"}], 
         RowBox[{"dot", "[", 
          RowBox[{
           RowBox[{"p", "[", "i", "]"}], ",", "b"}], "]"}]}], "+", 
        RowBox[{
         RowBox[{"dot", "[", 
          RowBox[{"v2", ",", 
           RowBox[{"F", "[", "i", "]"}], ",", "b"}], "]"}], 
         RowBox[{"dot", "[", 
          RowBox[{"a", ",", 
           RowBox[{"p", "[", "i", "]"}]}], "]"}]}]}], ")"}]}], "/;", 
     RowBox[{"(", 
      RowBox[{
       RowBox[{"b", "=!=", "v2"}], "&&", 
       RowBox[{"a", "=!=", "v2"}]}], ")"}]}]}]}]}]}], "Input",
 CellChangeTimes->{{3.8710113197696133`*^9, 3.8710113205510817`*^9}},
 CellLabel->
  "In[257]:=",ExpressionUUID->"ba6607b4-f910-41b9-a34a-add7b7d902e7"],

Cell[BoxData[{
 RowBox[{"ClearAll", "[", "FTensorReduceG", "]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"FTensorReduceG", "[", 
   RowBox[{"f_", ",", "i_"}], "]"}], ":=", 
  RowBox[{"f", "/.", 
   RowBox[{
    RowBox[{"dot", "[", 
     RowBox[{"a__", ",", 
      RowBox[{"F", "[", "i", "]"}], ",", "b__"}], "]"}], ":>", " ", 
    RowBox[{
     RowBox[{
      FractionBox["1", 
       RowBox[{"dot", "[", 
        RowBox[{
         RowBox[{"v", "[", "2", "]"}], ",", 
         RowBox[{"p", "[", "i", "]"}]}], "]"}]], 
      RowBox[{"(", 
       RowBox[{
        RowBox[{
         RowBox[{"dot", "[", 
          RowBox[{"a", ",", 
           RowBox[{"F", "[", "i", "]"}], ",", 
           RowBox[{"v", "[", "2", "]"}]}], "]"}], 
         RowBox[{"dot", "[", 
          RowBox[{
           RowBox[{"p", "[", "i", "]"}], ",", "b"}], "]"}]}], "+", 
        RowBox[{
         RowBox[{"dot", "[", 
          RowBox[{
           RowBox[{"v", "[", "2", "]"}], ",", 
           RowBox[{"F", "[", "i", "]"}], ",", "b"}], "]"}], 
         RowBox[{"dot", "[", 
          RowBox[{"a", ",", 
           RowBox[{"p", "[", "i", "]"}]}], "]"}]}]}], ")"}]}], "/;", 
     RowBox[{
      RowBox[{
       RowBox[{"Length", "[", 
        RowBox[{"{", "a", "}"}], "]"}], ">=", "2"}], "&&", 
      RowBox[{
       RowBox[{"Length", "[", 
        RowBox[{"{", "b", "}"}], "]"}], ">=", "2"}]}]}]}]}]}]}], "Input",
 CellChangeTimes->{{3.8766049144819403`*^9, 3.8766049514374*^9}},
 CellLabel->
  "In[260]:=",ExpressionUUID->"870e16af-175f-49a6-8e68-b0b4c35c2c5a"],

Cell[BoxData[{
 RowBox[{"ClearAll", "[", "expandTr", "]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"expandTr", "[", "f_", "]"}], ":=", 
  RowBox[{
   RowBox[{
    RowBox[{"Module", "[", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{
        RowBox[{"lt", "=", 
         RowBox[{"Length", "[", "f", "]"}]}], ",", "ts"}], "}"}], ",", 
      RowBox[{"ts", "=", 
       RowBox[{"f", "/.", 
        RowBox[{
         RowBox[{"tr", "[", "g___", "]"}], ":>", " ", 
         RowBox[{"dot", "[", 
          RowBox[{
           RowBox[{"lI", "[", 
            RowBox[{"0", ",", "1"}], "]"}], ",", "g", ",", 
           RowBox[{"lI", "[", 
            RowBox[{"0", ",", "1"}], "]"}]}], "]"}]}]}]}]}], "]"}], "//", 
    "expandGen"}], "//", "expandF"}]}]}], "Input",
 CellChangeTimes->{{3.854191039354165*^9, 3.854191039594904*^9}, {
  3.854191096585668*^9, 3.8541911346819267`*^9}, {3.854191258960875*^9, 
  3.8541912891639442`*^9}, {3.854191345530801*^9, 3.8541913487274323`*^9}, {
  3.8541914272027063`*^9, 3.854191501571187*^9}, {3.854191759253392*^9, 
  3.8541917851217737`*^9}, {3.8541918354435787`*^9, 3.854191903651122*^9}, {
  3.8541921068331747`*^9, 3.854192117283308*^9}, {3.8765378395707912`*^9, 
  3.876537841794339*^9}},
 CellLabel->
  "In[262]:=",ExpressionUUID->"4ff24489-5806-4293-9306-aaa2b66eea5d"],

Cell[BoxData[{
 RowBox[{"ClearAll", "[", "tr2dot", "]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"tr2dot", "[", "f_tr", "]"}], ":=", 
  RowBox[{"Module", "[", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{"last", ",", "vlist", ",", "plast", ",", "v1", ",", "v2"}], 
     "}"}], ",", 
    RowBox[{
     RowBox[{"last", "=", 
      RowBox[{"f", "[", 
       RowBox[{"[", 
        RowBox[{"-", "1"}], "]"}], "]"}]}], ";", 
     RowBox[{"plast", "=", 
      RowBox[{"p", "@@", "last"}]}], ";", 
     RowBox[{"vlist", "=", 
      RowBox[{
       RowBox[{"(", 
        RowBox[{"List", "@@", "f"}], ")"}], "[", 
       RowBox[{"[", 
        RowBox[{"1", ";;", 
         RowBox[{"-", "2"}]}], "]"}], "]"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"v1", "=", 
      RowBox[{"Join", "[", 
       RowBox[{
        RowBox[{"{", "plast", "}"}], ",", "vlist", ",", 
        RowBox[{"{", "last", "}"}], ",", 
        RowBox[{"{", "v", "}"}]}], "]"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"v2", "=", 
      RowBox[{"Join", "[", 
       RowBox[{
        RowBox[{"{", "v", "}"}], ",", 
        RowBox[{"{", "last", "}"}], ",", "vlist", ",", 
        RowBox[{"{", "plast", "}"}]}], "]"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{
      FractionBox[
       RowBox[{"dot", "@@", "v1"}], 
       RowBox[{"dot", "[", 
        RowBox[{"v", ",", "plast"}], "]"}]], "+", 
      FractionBox[
       RowBox[{"dot", "@@", "v2"}], 
       RowBox[{"dot", "[", 
        RowBox[{"v", ",", "plast"}], "]"}]]}]}]}], 
   "]"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"tr2dot", "[", 
   RowBox[{"f_tr", ",", "a_"}], "]"}], ":=", 
  RowBox[{"Module", "[", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{"last", ",", "vlist", ",", "plast", ",", "v1", ",", "v2"}], 
     "}"}], ",", 
    RowBox[{
     RowBox[{"last", "=", 
      RowBox[{"f", "[", 
       RowBox[{"[", 
        RowBox[{"-", "1"}], "]"}], "]"}]}], ";", 
     RowBox[{"plast", "=", 
      RowBox[{"p", "@@", "last"}]}], ";", 
     RowBox[{"vlist", "=", 
      RowBox[{
       RowBox[{"(", 
        RowBox[{"List", "@@", "f"}], ")"}], "[", 
       RowBox[{"[", 
        RowBox[{"1", ";;", 
         RowBox[{"-", "2"}]}], "]"}], "]"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"v1", "=", 
      RowBox[{"Join", "[", 
       RowBox[{
        RowBox[{"{", "plast", "}"}], ",", "vlist", ",", 
        RowBox[{"{", "last", "}"}], ",", 
        RowBox[{"{", "a", "}"}]}], "]"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"v2", "=", 
      RowBox[{"Join", "[", 
       RowBox[{
        RowBox[{"{", "a", "}"}], ",", 
        RowBox[{"{", "last", "}"}], ",", "vlist", ",", 
        RowBox[{"{", "plast", "}"}]}], "]"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{
      FractionBox[
       RowBox[{"dot", "@@", "v1"}], 
       RowBox[{"dot", "[", 
        RowBox[{"a", ",", "plast"}], "]"}]], "+", 
      FractionBox[
       RowBox[{"dot", "@@", "v2"}], 
       RowBox[{"dot", "[", 
        RowBox[{"a", ",", "plast"}], "]"}]]}]}]}], "]"}]}]}], "Input",
 CellLabel->
  "In[264]:=",ExpressionUUID->"81a5efa0-ef04-45ff-9f3b-5e98ec90a869"],

Cell[BoxData[{
 RowBox[{"ClearAll", "[", "antiSymrep", "]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"antiSymrep", "=", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{
      RowBox[{"dot", "[", 
       RowBox[{"a_", ",", 
        RowBox[{"F", "[", "i_", "]"}], ",", "b_"}], "]"}], ":>", " ", 
      RowBox[{
       RowBox[{"-", 
        RowBox[{"dot", "[", 
         RowBox[{"b", ",", 
          RowBox[{"F", "[", "i", "]"}], ",", "a"}], "]"}]}], "/;", 
       RowBox[{
        RowBox[{"Signature", "[", 
         RowBox[{"{", 
          RowBox[{"a", ",", "b"}], "}"}], "]"}], "<", "0"}]}]}], ",", 
     RowBox[{
      RowBox[{"dot", "[", 
       RowBox[{"a_", ",", 
        RowBox[{"F", "[", "i_", "]"}], ",", 
        RowBox[{"F", "[", "j_", "]"}], ",", "b_"}], "]"}], ":>", " ", 
      RowBox[{
       RowBox[{"dot", "[", 
        RowBox[{"b", ",", 
         RowBox[{"F", "[", "j", "]"}], ",", 
         RowBox[{"F", "[", "i", "]"}], ",", "a"}], "]"}], "/;", 
       RowBox[{"i", ">", "j"}]}]}]}], "}"}]}], ";"}]}], "Input",
 CellChangeTimes->{{3.853462108697447*^9, 3.853462142837044*^9}, {
  3.8534646323189697`*^9, 3.8534646409716263`*^9}},
 CellLabel->
  "In[267]:=",ExpressionUUID->"33a60730-6445-4f31-9cf2-45d57b2b686f"],

Cell[BoxData[{
 RowBox[{"ClearAll", "[", "CombWithRep", "]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"CombWithRep", "[", 
   RowBox[{"ls_", ",", "n_"}], "]"}], ":=", 
  RowBox[{
   RowBox[{"(", 
    RowBox[{"List", "@@", 
     RowBox[{"(", 
      RowBox[{"Diamond", "@@", 
       RowBox[{"Table", "[", 
        RowBox[{
         RowBox[{"Total", "[", "ls", "]"}], ",", 
         RowBox[{"{", 
          RowBox[{"i", ",", "n"}], "}"}]}], "]"}]}], ")"}]}], ")"}], "/.", 
   RowBox[{"Diamond", "->", " ", "List"}]}]}]}], "Input",
 CellLabel->
  "In[269]:=",ExpressionUUID->"a1b1b191-c013-4f68-83ee-98caf8c64ddd"],

Cell[BoxData[{
 RowBox[{"ClearAll", "[", "minSets", "]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"minSets", "[", "list_List", "]"}], ":=", 
  RowBox[{"Block", "[", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{
      RowBox[{"u", "=", 
       RowBox[{"Union", "@", "list"}]}], ",", "r"}], "}"}], ",", 
    RowBox[{"Pick", "[", 
     RowBox[{"u", ",", 
      RowBox[{"Subtract", "[", 
       RowBox[{
        RowBox[{"BitAnd", "@@@", 
         RowBox[{"Replace", "[", 
          RowBox[{"u", ",", 
           RowBox[{"With", "[", 
            RowBox[{
             RowBox[{"{", 
              RowBox[{"g", "=", 
               RowBox[{"GatherBy", "[", 
                RowBox[{
                 RowBox[{"Transpose", "[", 
                  RowBox[{"{", 
                   RowBox[{
                    RowBox[{"Join", "@@", "u"}], ",", 
                    RowBox[{"Join", "@@", 
                    RowBox[{"MapThread", "[", 
                    RowBox[{"ConstantArray", ",", 
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{"r", "=", 
                    RowBox[{"2", "^", 
                    RowBox[{"Range", "[", 
                    RowBox[{"0", ",", 
                    RowBox[{
                    RowBox[{"Length", "@", "u"}], "-", "1"}]}], "]"}]}]}], 
                    ",", 
                    RowBox[{"Length", "/@", "u"}]}], "}"}]}], "]"}]}]}], 
                   "}"}], "]"}], ",", "First"}], "]"}]}], "}"}], ",", 
             RowBox[{"Dispatch", "@", 
              RowBox[{"Thread", "[", 
               RowBox[{
                RowBox[{"g", "[", 
                 RowBox[{"[", 
                  RowBox[{"All", ",", "1", ",", "1"}], "]"}], "]"}], "->", 
                RowBox[{"Total", "[", 
                 RowBox[{
                  RowBox[{"g", "[", 
                   RowBox[{"[", 
                    RowBox[{"All", ",", "All", ",", "2"}], "]"}], "]"}], ",", 
                  
                  RowBox[{"{", "2", "}"}]}], "]"}]}], "]"}]}]}], "]"}], ",", 
           RowBox[{"{", "2", "}"}]}], "]"}]}], ",", "r"}], "]"}], ",", "0"}], 
     "]"}]}], "]"}]}]}], "Input",
 CellLabel->
  "In[271]:=",ExpressionUUID->"f282480a-e650-4eb4-9038-e3f85b2fe1b8"],

Cell[BoxData[{
 RowBox[{"ClearAll", "[", "expandTensorFi", "]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"expandTensorFi", "[", 
   RowBox[{"f_dot", ",", "id_"}], "]"}], ":=", 
  RowBox[{
   RowBox[{"f", "/.", 
    RowBox[{
     RowBox[{"dot", "[", 
      RowBox[{"a__", ",", 
       RowBox[{"F", "[", "id", "]"}], ",", "g___", ",", 
       RowBox[{"F", "[", "id", "]"}], ",", "b__"}], "]"}], ":>", 
     RowBox[{
      RowBox[{"dot", "[", 
       RowBox[{"a", ",", 
        RowBox[{"lI", "[", 
         RowBox[{"id", ",", "1", ",", "1"}], "]"}]}], "]"}], 
      RowBox[{"dot", "[", 
       RowBox[{
        RowBox[{"lI", "[", 
         RowBox[{"id", ",", "1", ",", "2"}], "]"}], ",", "g", ",", 
        RowBox[{"lI", "[", 
         RowBox[{"id", ",", "2", ",", "1"}], "]"}]}], "]"}], 
      RowBox[{"dot", "[", 
       RowBox[{
        RowBox[{"lI", "[", 
         RowBox[{"id", ",", "2", ",", "2"}], "]"}], ",", "b"}], "]"}], 
      RowBox[{"(", 
       RowBox[{
        RowBox[{
         RowBox[{
          RowBox[{"p", "[", "id", "]"}], "[", 
          RowBox[{"lI", "[", 
           RowBox[{"id", ",", "1", ",", "1"}], "]"}], "]"}], 
         RowBox[{
          RowBox[{"\[Epsilon]", "[", "id", "]"}], "[", 
          RowBox[{"lI", "[", 
           RowBox[{"id", ",", "1", ",", "2"}], "]"}], "]"}]}], "-", 
        RowBox[{
         RowBox[{
          RowBox[{"\[Epsilon]", "[", "id", "]"}], "[", 
          RowBox[{"lI", "[", 
           RowBox[{"id", ",", "1", ",", "1"}], "]"}], "]"}], 
         RowBox[{
          RowBox[{"p", "[", "id", "]"}], "[", 
          RowBox[{"lI", "[", 
           RowBox[{"id", ",", "1", ",", "2"}], "]"}], "]"}]}]}], ")"}], 
      RowBox[{"(", 
       RowBox[{
        RowBox[{
         RowBox[{
          RowBox[{"p", "[", "id", "]"}], "[", 
          RowBox[{"lI", "[", 
           RowBox[{"id", ",", "2", ",", "1"}], "]"}], "]"}], 
         RowBox[{
          RowBox[{"\[Epsilon]", "[", "id", "]"}], "[", 
          RowBox[{"lI", "[", 
           RowBox[{"id", ",", "2", ",", "2"}], "]"}], "]"}]}], "-", 
        RowBox[{
         RowBox[{
          RowBox[{"\[Epsilon]", "[", "id", "]"}], "[", 
          RowBox[{"lI", "[", 
           RowBox[{"id", ",", "2", ",", "1"}], "]"}], "]"}], 
         RowBox[{
          RowBox[{"p", "[", "id", "]"}], "[", 
          RowBox[{"lI", "[", 
           RowBox[{"id", ",", "2", ",", "2"}], "]"}], "]"}]}]}], ")"}]}]}]}], 
   "/.", 
   RowBox[{
    RowBox[{"dot", "[", 
     RowBox[{"a__", ",", 
      RowBox[{"F", "[", "id", "]"}], ",", "b__"}], "]"}], ":>", 
    RowBox[{
     RowBox[{"dot", "[", 
      RowBox[{"a", ",", 
       RowBox[{"lI", "[", 
        RowBox[{"id", ",", "1"}], "]"}]}], "]"}], 
     RowBox[{"dot", "[", 
      RowBox[{
       RowBox[{"lI", "[", 
        RowBox[{"id", ",", "2"}], "]"}], ",", "b"}], "]"}], 
     RowBox[{"(", 
      RowBox[{
       RowBox[{
        RowBox[{
         RowBox[{"p", "[", "id", "]"}], "[", 
         RowBox[{"lI", "[", 
          RowBox[{"id", ",", "1"}], "]"}], "]"}], 
        RowBox[{
         RowBox[{"\[Epsilon]", "[", "id", "]"}], "[", 
         RowBox[{"lI", "[", 
          RowBox[{"id", ",", "2"}], "]"}], "]"}]}], "-", 
       RowBox[{
        RowBox[{
         RowBox[{"\[Epsilon]", "[", "id", "]"}], "[", 
         RowBox[{"lI", "[", 
          RowBox[{"id", ",", "1"}], "]"}], "]"}], 
        RowBox[{
         RowBox[{"p", "[", "id", "]"}], "[", 
         RowBox[{"lI", "[", 
          RowBox[{"id", ",", "2"}], "]"}], "]"}]}]}], 
      ")"}]}]}]}]}], "\[IndentingNewLine]", 
 RowBox[{"ClearAll", "[", "expandTensorFiGen", "]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"expandTensorFiGen", "[", 
   RowBox[{"f_", ",", "id_"}], "]"}], ":=", 
  RowBox[{"Module", "[", 
   RowBox[{
    RowBox[{"{", "res", "}"}], ",", 
    RowBox[{
     RowBox[{"res", "=", 
      RowBox[{"f", "//.", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{
          RowBox[{"Power", "[", 
           RowBox[{
            RowBox[{"dot", "[", 
             RowBox[{"g__", ",", 
              RowBox[{"F", "[", "id", "]"}], ",", "h__"}], "]"}], ",", "2"}], 
           "]"}], ":>", 
          RowBox[{"DC", "@@", 
           RowBox[{"Table", "[", 
            RowBox[{
             RowBox[{"dot", "[", 
              RowBox[{"g", ",", 
               RowBox[{"F", "[", "id", "]"}], ",", "h"}], "]"}], ",", 
             RowBox[{"{", 
              RowBox[{"ii", ",", "2"}], "}"}]}], "]"}]}]}], ",", 
         RowBox[{
          RowBox[{"Times", "[", 
           RowBox[{
            RowBox[{"dot", "[", 
             RowBox[{"g__", ",", 
              RowBox[{"F", "[", "id", "]"}], ",", "h__"}], "]"}], ",", 
            RowBox[{"dot", "[", 
             RowBox[{"g1__", ",", 
              RowBox[{"F", "[", "id", "]"}], ",", "h1__"}], "]"}]}], "]"}], ":>", 
          RowBox[{"DC", "[", 
           RowBox[{
            RowBox[{"dot", "[", 
             RowBox[{"g", ",", 
              RowBox[{"F", "[", "id", "]"}], ",", "h"}], "]"}], ",", 
            RowBox[{"dot", "[", 
             RowBox[{"g1", ",", 
              RowBox[{"F", "[", "id", "]"}], ",", "h1"}], "]"}]}], "]"}]}]}], 
        "}"}]}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"(*", 
      RowBox[{
       RowBox[{"Print", "[", "res", "]"}], ";"}], "*)"}], 
     "\[IndentingNewLine]", 
     RowBox[{"res", "=", 
      RowBox[{"res", "//.", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{
          RowBox[{"Power", "[", 
           RowBox[{
            RowBox[{"dot", "[", 
             RowBox[{"g_", ",", 
              RowBox[{"\[Epsilon]", "[", "id", "]"}]}], "]"}], ",", "2"}], 
           "]"}], ":>", 
          RowBox[{"DC", "@@", 
           RowBox[{"Table", "[", 
            RowBox[{
             RowBox[{"dot", "[", 
              RowBox[{"g", ",", 
               RowBox[{"\[Epsilon]", "[", "id", "]"}]}], "]"}], ",", 
             RowBox[{"{", 
              RowBox[{"ii", ",", "2"}], "}"}]}], "]"}]}]}], ",", 
         RowBox[{
          RowBox[{"Power", "[", 
           RowBox[{
            RowBox[{"dot", "[", 
             RowBox[{
              RowBox[{"\[Epsilon]", "[", "id", "]"}], ",", "g_"}], "]"}], ",",
             "2"}], "]"}], ":>", 
          RowBox[{"DC", "@@", 
           RowBox[{"Table", "[", 
            RowBox[{
             RowBox[{"dot", "[", 
              RowBox[{
               RowBox[{"\[Epsilon]", "[", "id", "]"}], ",", "g"}], "]"}], ",", 
             RowBox[{"{", 
              RowBox[{"ii", ",", "2"}], "}"}]}], "]"}]}]}], ",", 
         RowBox[{
          RowBox[{"Times", "[", 
           RowBox[{
            RowBox[{"dot", "[", 
             RowBox[{"g_", ",", 
              RowBox[{"\[Epsilon]", "[", "id", "]"}]}], "]"}], ",", 
            RowBox[{"dot", "[", 
             RowBox[{"g1_", ",", 
              RowBox[{"\[Epsilon]", "[", "id", "]"}]}], "]"}]}], "]"}], ":>", 
          
          RowBox[{"DC", "[", 
           RowBox[{
            RowBox[{"dot", "[", 
             RowBox[{"g", ",", 
              RowBox[{"\[Epsilon]", "[", "id", "]"}]}], "]"}], ",", 
            RowBox[{"dot", "[", 
             RowBox[{"g1", ",", 
              RowBox[{"\[Epsilon]", "[", "id", "]"}]}], "]"}]}], "]"}]}], ",", 
         RowBox[{
          RowBox[{"Times", "[", 
           RowBox[{
            RowBox[{"dot", "[", 
             RowBox[{
              RowBox[{"\[Epsilon]", "[", "id", "]"}], ",", "g_"}], "]"}], ",", 
            RowBox[{"dot", "[", 
             RowBox[{"g1_", ",", 
              RowBox[{"\[Epsilon]", "[", "id", "]"}]}], "]"}]}], "]"}], ":>", 
          
          RowBox[{"DC", "[", 
           RowBox[{
            RowBox[{"dot", "[", 
             RowBox[{
              RowBox[{"\[Epsilon]", "[", "id", "]"}], ",", "g"}], "]"}], ",", 
            
            RowBox[{"dot", "[", 
             RowBox[{"g1", ",", 
              RowBox[{"\[Epsilon]", "[", "id", "]"}]}], "]"}]}], "]"}]}], ",", 
         RowBox[{
          RowBox[{"Times", "[", 
           RowBox[{
            RowBox[{"dot", "[", 
             RowBox[{"g_", ",", 
              RowBox[{"\[Epsilon]", "[", "id", "]"}]}], "]"}], ",", 
            RowBox[{"dot", "[", 
             RowBox[{
              RowBox[{"\[Epsilon]", "[", "id", "]"}], ",", "g1_"}], "]"}]}], 
           "]"}], ":>", 
          RowBox[{"DC", "[", 
           RowBox[{
            RowBox[{"dot", "[", 
             RowBox[{"g", ",", 
              RowBox[{"\[Epsilon]", "[", "id", "]"}]}], "]"}], ",", 
            RowBox[{"dot", "[", 
             RowBox[{
              RowBox[{"\[Epsilon]", "[", "id", "]"}], ",", "g1"}], "]"}]}], 
           "]"}]}], ",", 
         RowBox[{
          RowBox[{"Times", "[", 
           RowBox[{
            RowBox[{"dot", "[", 
             RowBox[{
              RowBox[{"\[Epsilon]", "[", "id", "]"}], ",", "g_"}], "]"}], ",", 
            RowBox[{"dot", "[", 
             RowBox[{
              RowBox[{"\[Epsilon]", "[", "id", "]"}], ",", "g1_"}], "]"}]}], 
           "]"}], ":>", 
          RowBox[{"DC", "[", 
           RowBox[{
            RowBox[{"dot", "[", 
             RowBox[{
              RowBox[{"\[Epsilon]", "[", "id", "]"}], ",", "g"}], "]"}], ",", 
            
            RowBox[{"dot", "[", 
             RowBox[{
              RowBox[{"\[Epsilon]", "[", "id", "]"}], ",", "g1"}], "]"}]}], 
           "]"}]}]}], "}"}]}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"(*", 
      RowBox[{
       RowBox[{"Print", "[", "res", "]"}], ";"}], "*)"}], 
     "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{
       RowBox[{
        RowBox[{
         RowBox[{"res", "/.", 
          RowBox[{
           RowBox[{"dot", "[", "g__", "]"}], ":>", 
           RowBox[{"expandTensorFi", "[", 
            RowBox[{
             RowBox[{"dot", "[", "g", "]"}], ",", "id"}], "]"}]}]}], "/.", 
         RowBox[{
          RowBox[{"dot", "[", 
           RowBox[{"g_", ",", 
            RowBox[{"\[Epsilon]", "[", "id", "]"}]}], "]"}], ":>", 
          RowBox[{
           RowBox[{"g", "[", 
            RowBox[{"lI", "[", 
             RowBox[{"0", ",", "id"}], "]"}], "]"}], 
           RowBox[{
            RowBox[{"\[Epsilon]", "[", "id", "]"}], "[", 
            RowBox[{"lI", "[", 
             RowBox[{"0", ",", "id"}], "]"}], "]"}]}]}]}], "/.", 
        RowBox[{
         RowBox[{"dot", "[", 
          RowBox[{
           RowBox[{"\[Epsilon]", "[", "id", "]"}], ",", "g_"}], "]"}], ":>", 
         RowBox[{
          RowBox[{"g", "[", 
           RowBox[{"lI", "[", 
            RowBox[{"0", ",", "id"}], "]"}], "]"}], 
          RowBox[{
           RowBox[{"\[Epsilon]", "[", "id", "]"}], "[", 
           RowBox[{"lI", "[", 
            RowBox[{"0", ",", "id"}], "]"}], "]"}]}]}]}], "/.", 
       RowBox[{
        RowBox[{"DC", "[", "g__", "]"}], ":>", 
        RowBox[{"DC", "@@", 
         RowBox[{"Table", "[", 
          RowBox[{
           RowBox[{
            RowBox[{
             RowBox[{"{", "g", "}"}], "[", 
             RowBox[{"[", "ii", "]"}], "]"}], "/.", 
            RowBox[{
             RowBox[{"lI", "[", "ids__", "]"}], ":>", 
             RowBox[{"lI", "[", 
              RowBox[{"ii", ",", "ids"}], "]"}]}]}], ",", 
           RowBox[{"{", 
            RowBox[{"ii", ",", 
             RowBox[{"Length", "@", 
              RowBox[{"{", "g", "}"}]}]}], "}"}]}], "]"}]}]}]}], "/.", 
      RowBox[{"DC", "->", "Times"}]}]}]}], "\[IndentingNewLine]", 
   "]"}]}]}], "Input",
 CellChangeTimes->{{3.8717101857556257`*^9, 3.871710247171233*^9}, {
   3.871710344490424*^9, 3.871710464250885*^9}, {3.871710514216856*^9, 
   3.871710535067227*^9}, {3.871710577772479*^9, 3.871710619653611*^9}, {
   3.87171070099017*^9, 3.871710793817266*^9}, {3.8717110547727757`*^9, 
   3.871711098694851*^9}, {3.871711566802866*^9, 3.8717116001589727`*^9}, {
   3.8717925794231157`*^9, 3.8717926279638968`*^9}, {3.871792658993463*^9, 
   3.871792659631276*^9}, 3.871792836017084*^9, {3.871792881937099*^9, 
   3.871792936440737*^9}, {3.871793027757831*^9, 3.871793027984799*^9}, {
   3.8717930770034943`*^9, 3.8717931563424873`*^9}, {3.871793189683238*^9, 
   3.871793219777211*^9}, {3.871794218005933*^9, 3.8717942969355288`*^9}, {
   3.871794593480941*^9, 3.871794608503077*^9}, {3.871794745604311*^9, 
   3.87179476760977*^9}, {3.871794877507155*^9, 3.871794880713606*^9}, {
   3.871794991131771*^9, 3.87179509392428*^9}, {3.8717951470684958`*^9, 
   3.871795182954617*^9}, {3.8718603028865423`*^9, 3.871860327016007*^9}, {
   3.871860459558563*^9, 3.871860475007077*^9}, {3.871878859716531*^9, 
   3.871878883200115*^9}, {3.871878943674459*^9, 3.8718789878517*^9}, {
   3.871879040687913*^9, 3.871879042718019*^9}, {3.8718797681531343`*^9, 
   3.871879772859611*^9}, {3.8718798541089087`*^9, 3.871880037163097*^9}, {
   3.8765284853468723`*^9, 3.8765285056137733`*^9}, {3.876528614447425*^9, 
   3.8765286203250027`*^9}, {3.876529061202283*^9, 3.876529118675256*^9}, {
   3.876535688731642*^9, 3.876535689308138*^9}},
 CellLabel->
  "In[273]:=",ExpressionUUID->"ab70ed01-43b7-4b5f-98d1-c719b4ff3087"],

Cell[BoxData[{
 RowBox[{
  RowBox[{"ClearAll", "[", "GlueAmp2", "]"}], " ", 
  RowBox[{"(*", 
   RowBox[{"Slow", " ", "function", " ", "for", " ", "testing"}], 
   "*)"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"GlueAmp2", "[", 
   RowBox[{"f__", ",", "pi_"}], "]"}], ":=", 
  RowBox[{"Module", "[", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{"res", ",", 
      RowBox[{"los", "=", 
       RowBox[{"lo", "@@", "pi"}]}], ",", 
      RowBox[{"lis", "=", "pi"}]}], "}"}], ",", 
    RowBox[{
     RowBox[{"res", "=", 
      RowBox[{
       RowBox[{"Times", "[", "f", "]"}], "/.", 
       RowBox[{
        RowBox[{"A", "[", 
         RowBox[{"g_", ",", "vv_", ",", "ps_"}], "]"}], ":>", 
        RowBox[{"(", 
         RowBox[{
          RowBox[{"g", "/.", 
           RowBox[{"v", "->", "vv"}]}], "/.", 
          RowBox[{"MapThread", "[", 
           RowBox[{"Rule", ",", 
            RowBox[{"{", 
             RowBox[{
              RowBox[{"p", "/@", 
               RowBox[{"Range", "[", 
                RowBox[{"Length", "@", "ps"}], "]"}]}], ",", "ps"}], "}"}]}], 
           "]"}]}], ")"}]}]}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"res", "=", 
      RowBox[{
       RowBox[{
        RowBox[{
         RowBox[{"res", "//", "expandGen"}], "//", 
         RowBox[{
          RowBox[{"expandF", "[", 
           RowBox[{"#", ",", "lis"}], "]"}], "&"}]}], "//", 
        RowBox[{
         RowBox[{"expandF", "[", 
          RowBox[{"#", ",", "los"}], "]"}], "&"}]}], "//", "Expand"}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"res", "=", 
      RowBox[{
       RowBox[{"res", "/.", 
        RowBox[{
         RowBox[{
          RowBox[{
           RowBox[{"\[Epsilon]", "[", "lis", "]"}], "[", "a1_", "]"}], 
          RowBox[{
           RowBox[{"\[Epsilon]", "[", "lis", "]"}], "[", "a2_", "]"}], 
          RowBox[{
           RowBox[{"\[Epsilon]", "[", "los", "]"}], "[", "b1_", "]"}], 
          RowBox[{
           RowBox[{"\[Epsilon]", "[", "los", "]"}], "[", "b2_", "]"}]}], ":>", 
         RowBox[{
          FractionBox["1", "2"], 
          RowBox[{"(", 
           RowBox[{
            RowBox[{
             RowBox[{"eta", "[", 
              RowBox[{"a1", ",", "b1"}], "]"}], 
             RowBox[{"eta", "[", 
              RowBox[{"a2", ",", "b2"}], "]"}]}], "+", 
            RowBox[{
             RowBox[{"eta", "[", 
              RowBox[{"a1", ",", "b2"}], "]"}], 
             RowBox[{"eta", "[", 
              RowBox[{"a2", ",", "b1"}], "]"}]}], "-", 
            RowBox[{
             FractionBox["2", 
              RowBox[{"DD", "-", "2"}]], 
             RowBox[{"eta", "[", 
              RowBox[{"a1", ",", "a2"}], "]"}], 
             RowBox[{"eta", "[", 
              RowBox[{"b1", ",", "b2"}], "]"}]}]}], ")"}]}]}]}], "//", 
       "contractAnti"}]}]}]}], "\[IndentingNewLine]", "]"}]}]}], "Input",
 CellChangeTimes->{{3.871712600587709*^9, 3.871712670352553*^9}, {
  3.871712848705008*^9, 3.8717128512044077`*^9}, {3.8717156142755423`*^9, 
  3.871715631992737*^9}, {3.871945244409588*^9, 3.871945272183694*^9}, {
  3.872034874753574*^9, 3.872034875714731*^9}},
 CellLabel->
  "In[277]:=",ExpressionUUID->"53ad6521-8a3d-4870-b358-c6375ff69baf"],

Cell[BoxData[{
 RowBox[{"ClearAll", "[", "GlueAmp3", "]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"GlueAmp3", "[", 
   RowBox[{"f__", ",", "pi_"}], "]"}], ":=", 
  RowBox[{"Module", "[", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{"res", ",", 
      RowBox[{"los", "=", 
       RowBox[{"lo", "@@", "pi"}]}], ",", 
      RowBox[{"lis", "=", "pi"}]}], "}"}], ",", 
    RowBox[{
     RowBox[{"res", "=", 
      RowBox[{
       RowBox[{"Times", "[", "f", "]"}], "/.", 
       RowBox[{
        RowBox[{"A", "[", 
         RowBox[{"g_", ",", "vv_", ",", "ps_"}], "]"}], ":>", 
        RowBox[{"(", 
         RowBox[{
          RowBox[{"g", "/.", 
           RowBox[{"v", "->", "vv"}]}], "/.", 
          RowBox[{"MapThread", "[", 
           RowBox[{"Rule", ",", 
            RowBox[{"{", 
             RowBox[{
              RowBox[{"p", "/@", 
               RowBox[{"Range", "[", 
                RowBox[{"Length", "@", "ps"}], "]"}]}], ",", "ps"}], "}"}]}], 
           "]"}]}], ")"}]}]}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"res", "=", 
      RowBox[{
       RowBox[{"res", "//", 
        RowBox[{
         RowBox[{"expandTensorFiGen", "[", 
          RowBox[{"#", ",", "lis"}], "]"}], "&"}]}], "//", "Expand"}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"res", "=", 
      RowBox[{
       RowBox[{"res", "//", 
        RowBox[{
         RowBox[{"expandTensorFiGen", "[", 
          RowBox[{"#", ",", "los"}], "]"}], "&"}]}], "//", "Expand"}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"res", "=", 
      RowBox[{"res", "/.", 
       RowBox[{
        RowBox[{
         RowBox[{
          RowBox[{"\[Epsilon]", "[", "lis", "]"}], "[", "a1_", "]"}], 
         RowBox[{
          RowBox[{"\[Epsilon]", "[", "lis", "]"}], "[", "a2_", "]"}], 
         RowBox[{
          RowBox[{"\[Epsilon]", "[", "los", "]"}], "[", "b1_", "]"}], 
         RowBox[{
          RowBox[{"\[Epsilon]", "[", "los", "]"}], "[", "b2_", "]"}]}], ":>", 
        
        RowBox[{
         FractionBox["1", "2"], 
         RowBox[{"(", 
          RowBox[{
           RowBox[{
            RowBox[{"eta", "[", 
             RowBox[{"a1", ",", "b1"}], "]"}], 
            RowBox[{"eta", "[", 
             RowBox[{"a2", ",", "b2"}], "]"}]}], "+", 
           RowBox[{
            RowBox[{"eta", "[", 
             RowBox[{"a1", ",", "b2"}], "]"}], 
            RowBox[{"eta", "[", 
             RowBox[{"a2", ",", "b1"}], "]"}]}], "-", 
           RowBox[{
            FractionBox["2", 
             RowBox[{"DD", "-", "2"}]], 
            RowBox[{"eta", "[", 
             RowBox[{"a1", ",", "a2"}], "]"}], 
            RowBox[{"eta", "[", 
             RowBox[{"b1", ",", "b2"}], "]"}]}]}], ")"}]}]}]}]}]}]}], 
   "\[IndentingNewLine]", "]"}]}]}], "Input",
 CellChangeTimes->{{3.87194534060808*^9, 3.871945346058714*^9}},
 CellLabel->
  "In[279]:=",ExpressionUUID->"b2556c4a-ab65-4d73-834f-4614b803390f"],

Cell[BoxData[{
 RowBox[{"ClearAll", "[", "GlueAmp", "]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"GlueAmp", "[", 
   RowBox[{"f__", ",", "pi_li"}], "]"}], ":=", 
  RowBox[{"Module", "[", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{"res", ",", 
      RowBox[{"los", "=", 
       RowBox[{"lo", "@@", "pi"}]}], ",", 
      RowBox[{"lis", "=", "pi"}]}], "}"}], ",", 
    RowBox[{
     RowBox[{"res", "=", 
      RowBox[{
       RowBox[{
        RowBox[{"Times", "[", "f", "]"}], "/.", 
        RowBox[{
         RowBox[{"A", "[", 
          RowBox[{"g_", ",", "vv_", ",", "ps_"}], "]"}], ":>", 
         RowBox[{"(", 
          RowBox[{
           RowBox[{"g", "/.", 
            RowBox[{"v", "->", "vv"}]}], "/.", 
           RowBox[{"MapThread", "[", 
            RowBox[{"Rule", ",", 
             RowBox[{"{", 
              RowBox[{
               RowBox[{"p", "/@", 
                RowBox[{"Range", "[", 
                 RowBox[{"Length", "@", "ps"}], "]"}]}], ",", "ps"}], "}"}]}],
             "]"}]}], ")"}]}]}], "//", "Expand"}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"res", "=", 
      RowBox[{
       RowBox[{"res", "//", 
        RowBox[{
         RowBox[{"expandTensorFiGen", "[", 
          RowBox[{"#", ",", "lis"}], "]"}], "&"}]}], "//", "Expand"}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"res", "=", 
      RowBox[{
       RowBox[{"res", "//", 
        RowBox[{
         RowBox[{"expandTensorFiGen", "[", 
          RowBox[{"#", ",", "los"}], "]"}], "&"}]}], "//", "Expand"}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"res", "=", 
      RowBox[{
       RowBox[{"res", "/.", 
        RowBox[{
         RowBox[{
          RowBox[{
           RowBox[{"\[Epsilon]", "[", "lis", "]"}], "[", "a1_", "]"}], 
          RowBox[{
           RowBox[{"\[Epsilon]", "[", "lis", "]"}], "[", "a2_", "]"}], 
          RowBox[{
           RowBox[{"\[Epsilon]", "[", "los", "]"}], "[", "b1_", "]"}], 
          RowBox[{
           RowBox[{"\[Epsilon]", "[", "los", "]"}], "[", "b2_", "]"}]}], ":>", 
         RowBox[{
          FractionBox["1", "2"], 
          RowBox[{"(", 
           RowBox[{
            RowBox[{
             RowBox[{"eta", "[", 
              RowBox[{"a1", ",", "b1"}], "]"}], 
             RowBox[{"eta", "[", 
              RowBox[{"a2", ",", "b2"}], "]"}]}], "+", 
            RowBox[{
             RowBox[{"eta", "[", 
              RowBox[{"a1", ",", "b2"}], "]"}], 
             RowBox[{"eta", "[", 
              RowBox[{"a2", ",", "b1"}], "]"}]}], "-", 
            RowBox[{
             FractionBox["2", 
              RowBox[{"DD", "-", "2"}]], 
             RowBox[{"eta", "[", 
              RowBox[{"a1", ",", "a2"}], "]"}], 
             RowBox[{"eta", "[", 
              RowBox[{"b1", ",", "b2"}], "]"}]}]}], ")"}]}]}]}], "//", 
       "contractAnti"}]}]}]}], "\[IndentingNewLine]", "]"}]}]}], "Input",
 CellChangeTimes->{{3.717672845976037*^9, 3.717672889169771*^9}, {
   3.717674925531893*^9, 3.71767495835476*^9}, {3.717675063695549*^9, 
   3.717675066478118*^9}, {3.717675300930599*^9, 3.7176753267138968`*^9}, {
   3.7176753870934343`*^9, 3.717675403057289*^9}, {3.7176754381874647`*^9, 
   3.71767547431498*^9}, 3.717675660783152*^9, {3.717736602639456*^9, 
   3.7177366242846107`*^9}, {3.717737468069676*^9, 3.717737480653091*^9}, {
   3.717750828787468*^9, 3.717750872340436*^9}, {3.718860636025526*^9, 
   3.718860640412352*^9}, {3.7188607903613377`*^9, 3.718860795560849*^9}, 
   3.71886086446344*^9, {3.718860948446919*^9, 3.718860951595491*^9}, 
   3.718860984899868*^9, {3.721238842235695*^9, 3.721238843744174*^9}, {
   3.721410336076936*^9, 3.7214103369702473`*^9}, {3.721412975267428*^9, 
   3.721412988890263*^9}, {3.72141323618769*^9, 3.7214132364838457`*^9}, 
   3.7214147264125347`*^9, {3.722247891811057*^9, 3.722247901391345*^9}, {
   3.727163630705885*^9, 3.727163679035369*^9}, {3.7271813171878366`*^9, 
   3.727181351523305*^9}, {3.727181477010126*^9, 3.727181501954378*^9}, {
   3.7569617666765738`*^9, 3.756961766784175*^9}, {3.756961870648288*^9, 
   3.756961949579342*^9}, {3.756962094598337*^9, 3.7569621098574553`*^9}, {
   3.756962167672611*^9, 3.7569621739207697`*^9}, {3.7569622139938307`*^9, 
   3.7569622426119537`*^9}, 3.756962373458827*^9, {3.809660362743723*^9, 
   3.809660418070587*^9}, {3.8096614085618067`*^9, 3.809661412551626*^9}, {
   3.809662049147789*^9, 3.809662101747892*^9}, {3.8096621462298317`*^9, 
   3.809662152164967*^9}, {3.809695613944919*^9, 3.809695685233942*^9}, 
   3.809695754647512*^9, {3.809695795605771*^9, 3.809695832316655*^9}, {
   3.809695960033867*^9, 3.809696106429303*^9}, {3.809696168645002*^9, 
   3.8096962031609497`*^9}, {3.80969630311021*^9, 3.809696333870982*^9}, {
   3.809696500996005*^9, 3.809696552942379*^9}, {3.8096965843172007`*^9, 
   3.809696642216886*^9}, {3.80969668037805*^9, 3.809696725452177*^9}, {
   3.8096968004483547`*^9, 3.809696937098598*^9}, {3.8096969918981867`*^9, 
   3.8096970974956913`*^9}, {3.809697150172176*^9, 3.809697151784438*^9}, {
   3.809851404069126*^9, 3.8098514312721767`*^9}, {3.8098515608428*^9, 
   3.8098515619391623`*^9}, {3.81000416196408*^9, 3.81000419966461*^9}, {
   3.810004329672138*^9, 3.810004330140016*^9}, {3.810012567227653*^9, 
   3.8100125857543917`*^9}, {3.849077219402678*^9, 3.8490772205862703`*^9}, {
   3.849077274201914*^9, 3.849077275031169*^9}, {3.8499313915236273`*^9, 
   3.84993139457652*^9}, {3.849936499751693*^9, 3.849936522953876*^9}, {
   3.8500933864282*^9, 3.850093395755972*^9}, {3.8500936471419897`*^9, 
   3.85009368571201*^9}, 3.8518569570609493`*^9, 3.853202602524168*^9, 
   3.853215130512108*^9, 3.857451044110569*^9, 3.871297285245735*^9, {
   3.871619444103547*^9, 3.871619451260944*^9}, {3.871619490117971*^9, 
   3.871619521315403*^9}, {3.871619619378182*^9, 3.87161962417244*^9}, {
   3.8716196556270733`*^9, 3.871619681596793*^9}, {3.871619831706586*^9, 
   3.871619864427882*^9}, {3.8716213205601892`*^9, 3.871621333226293*^9}, {
   3.871625017999157*^9, 3.871625241366728*^9}, {3.871625291216332*^9, 
   3.871625359241075*^9}, {3.871625493107828*^9, 3.8716254955113497`*^9}, {
   3.8716255615364437`*^9, 3.871625564022999*^9}, 3.871625841369969*^9, {
   3.87162607082874*^9, 3.871626075743566*^9}, {3.8716899594033813`*^9, 
   3.8716899600539207`*^9}, {3.8716900784125357`*^9, 
   3.8716900789351377`*^9}, {3.871705590182193*^9, 3.871705593089178*^9}, {
   3.871705721469871*^9, 3.871705813886736*^9}, {3.871705853265871*^9, 
   3.8717058662856207`*^9}, {3.8717059035408707`*^9, 3.871706011684908*^9}, 
   3.871706045343543*^9, {3.871706484816691*^9, 3.87170652555105*^9}, 
   3.8717069814938707`*^9, {3.871707150080432*^9, 3.871707168903172*^9}, {
   3.871707495653973*^9, 3.871707602306806*^9}, {3.8717076664684687`*^9, 
   3.871707692027851*^9}, {3.87170782927689*^9, 3.871707831107004*^9}, {
   3.8717078660880747`*^9, 3.871707868174891*^9}, 3.8717079100251617`*^9, 
   3.871708016362279*^9, 3.871708514321631*^9, {3.871709414281816*^9, 
   3.8717094266664257`*^9}, {3.8717108986134253`*^9, 3.871710934064623*^9}, 
   3.871711118911961*^9, 3.8717113235660048`*^9, 3.871711699746305*^9, {
   3.871711841537026*^9, 3.871711852394979*^9}, {3.871711988334196*^9, 
   3.871712020526985*^9}, {3.871715537622472*^9, 3.871715540368991*^9}, {
   3.872118897251507*^9, 3.872118897481187*^9}, {3.876454167099728*^9, 
   3.876454170049754*^9}},
 CellLabel->
  "In[281]:=",ExpressionUUID->"4500efcc-1d7c-4b91-892c-209688f51f02"]
}, Closed]],

Cell[CellGroupData[{

Cell["MonomialTransformation", "Subsection",
 CellChangeTimes->{{3.871716025388597*^9, 
  3.871716031302944*^9}},ExpressionUUID->"ca53f43b-0c6f-4f8f-9ad8-\
87cfea3279c2"],

Cell[BoxData[{
 RowBox[{"ClearAll", "[", 
  RowBox[{"Mono2List", ",", "deg", ",", "degDotp"}], 
  "]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"deg", "[", 
   RowBox[{"f_", ",", "var_List"}], "]"}], ":=", 
  RowBox[{"Module", "[", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{
      RowBox[{"num", "=", 
       RowBox[{"Numerator", "[", "f", "]"}]}], ",", 
      RowBox[{"den", "=", 
       RowBox[{"Denominator", "[", "f", "]"}]}]}], "}"}], ",", 
    RowBox[{
     RowBox[{"(", 
      RowBox[{
       RowBox[{
        RowBox[{"Max", "[", 
         RowBox[{"Plus", "@@@", 
          RowBox[{
           RowBox[{"CoefficientRules", "[", 
            RowBox[{"#", ",", "var"}], "]"}], "[", 
           RowBox[{"[", 
            RowBox[{"All", ",", "1"}], "]"}], "]"}]}], "]"}], "&"}], "@", 
       RowBox[{"(", "num", ")"}]}], ")"}], "-", 
     RowBox[{"(", 
      RowBox[{
       RowBox[{
        RowBox[{"Max", "[", 
         RowBox[{"Plus", "@@@", 
          RowBox[{
           RowBox[{"CoefficientRules", "[", 
            RowBox[{"#", ",", "var"}], "]"}], "[", 
           RowBox[{"[", 
            RowBox[{"All", ",", "1"}], "]"}], "]"}]}], "]"}], "&"}], "@", 
       RowBox[{"(", "den", ")"}]}], ")"}]}]}], "]"}]}], "\n", 
 RowBox[{
  RowBox[{"degDotp", "[", "f_", "]"}], ":=", 
  RowBox[{"Module", "[", 
   RowBox[{
    RowBox[{"{", "x", "}"}], ",", 
    RowBox[{"deg", "[", 
     RowBox[{
      RowBox[{
       RowBox[{"f", "/.", 
        RowBox[{
         RowBox[{"dot", "[", 
          RowBox[{"a_p", ",", "b_p"}], "]"}], ":>", "x"}]}], "/.", 
       RowBox[{
        RowBox[{"dot", "[", "g__", "]"}], ":>", " ", "1"}]}], " ", ",", 
      RowBox[{"{", "x", "}"}]}], "]"}]}], "]"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"Mono2List", "[", 
   RowBox[{"f_", ",", "dimDen_"}], "]"}], ":=", 
  RowBox[{"FF", "[", 
   RowBox[{"1", ",", 
    RowBox[{"-", 
     RowBox[{"Table", "[", 
      RowBox[{
       RowBox[{"deg", "[", 
        RowBox[{"f", ",", 
         RowBox[{"{", 
          RowBox[{"\[ScriptCapitalD]", "[", "ii", "]"}], "}"}]}], "]"}], ",", 
       
       RowBox[{"{", 
        RowBox[{"ii", ",", "dimDen"}], "}"}]}], "]"}]}]}], "]"}]}], "\n", 
 RowBox[{
  RowBox[{"Mono2List", "[", 
   RowBox[{"f_", ",", "dimDen_List"}], "]"}], ":=", 
  RowBox[{"FF", "[", 
   RowBox[{"1", ",", 
    RowBox[{"-", 
     RowBox[{"Table", "[", 
      RowBox[{
       RowBox[{"deg", "[", 
        RowBox[{"f", ",", 
         RowBox[{"{", 
          RowBox[{"dimDen", "[", 
           RowBox[{"[", "ii", "]"}], "]"}], "}"}]}], "]"}], ",", 
       RowBox[{"{", 
        RowBox[{"ii", ",", 
         RowBox[{"Length", "@", "dimDen"}]}], "}"}]}], "]"}]}]}], 
   "]"}]}]}], "Input",
 CellChangeTimes->{{3.871716074820694*^9, 3.8717160840867434`*^9}},
 CellLabel->
  "In[283]:=",ExpressionUUID->"f8177a59-b548-4f5d-a062-3e46a97c4ed8"],

Cell[BoxData[{
 RowBox[{"ClearAll", "[", "GetDenominatorFun", "]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"GetDenominatorFun", "[", 
   RowBox[{"h_", ",", "vars_"}], "]"}], ":=", 
  RowBox[{"Module", "[", 
   RowBox[{
    RowBox[{"{", "alldeno", "}"}], ",", 
    RowBox[{
     RowBox[{"alldeno", "=", 
      RowBox[{"(", 
       RowBox[{"List", "@@", 
        RowBox[{"(", 
         RowBox[{
          RowBox[{"auxilaryVariables", "*", 
           RowBox[{"Denominator", "[", "h", "]"}]}], "/.", 
          RowBox[{
           RowBox[{"Power", "[", 
            RowBox[{"f_", ",", "n_"}], "]"}], ":>", " ", "f"}]}], ")"}]}], 
       ")"}]}], ";", 
     RowBox[{"Table", "[", 
      RowBox[{
       RowBox[{"If", "[", 
        RowBox[{
         RowBox[{
          RowBox[{"Intersection", "[", 
           RowBox[{
            RowBox[{
             RowBox[{"alldeno", "[", 
              RowBox[{"[", "i", "]"}], "]"}], "//", 
             RowBox[{
              RowBox[{"Cases", "[", 
               RowBox[{"#", ",", 
                RowBox[{"dot", "[", "__", "]"}], ",", 
                RowBox[{"{", 
                 RowBox[{"0", ",", "\[Infinity]"}], "}"}]}], "]"}], "&"}]}], 
            ",", "vars"}], "]"}], "==", 
          RowBox[{"{", "}"}]}], ",", "Nothing", ",", 
         RowBox[{"alldeno", "[", 
          RowBox[{"[", "i", "]"}], "]"}]}], "]"}], ",", 
       RowBox[{"{", 
        RowBox[{"i", ",", 
         RowBox[{"Length", "@", "alldeno"}]}], "}"}]}], "]"}]}]}], 
   "\[IndentingNewLine]", "]"}]}], "\[IndentingNewLine]", 
 RowBox[{"ClearAll", "[", "GenIBPdotList", "]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"GenIBPdotList", "[", 
   RowBox[{"h_", ",", "vars_List", ",", "numeratordots_List"}], "]"}], ":=", 
  RowBox[{"Module", "[", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{"pplist", ",", "he"}], "}"}], ",", 
    RowBox[{
     RowBox[{"he", "=", 
      RowBox[{"h", "//", "Expand"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"pplist", "=", 
      RowBox[{
       RowBox[{
        RowBox[{
         RowBox[{"GetDenominatorFun", "[", 
          RowBox[{"#", ",", "vars"}], "]"}], "&"}], "/@", 
        RowBox[{"(", 
         RowBox[{"List", "@@", "he"}], ")"}]}], "//", "Union"}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"pplist", "=", 
      RowBox[{"minSets", "[", "pplist", "]"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"(*", 
      RowBox[{
       RowBox[{"pplist", "=", 
        RowBox[{
         RowBox[{
          RowBox[{"Intersection", "[", 
           RowBox[{"#", ",", "vars"}], "]"}], "&"}], "/@", "pplist"}]}], 
       ";"}], "*)"}], "\[IndentingNewLine]", 
     RowBox[{"Table", "[", 
      RowBox[{
       RowBox[{
        RowBox[{
         RowBox[{"Join", "[", 
          RowBox[{
           RowBox[{"pplist", "[", 
            RowBox[{"[", "ii", "]"}], "]"}], ",", "numeratordots"}], "]"}], "//",
          "DeleteDuplicates"}], "//", "Union"}], ",", 
       RowBox[{"{", 
        RowBox[{"ii", ",", 
         RowBox[{"Length", "@", "pplist"}]}], "}"}]}], "]"}]}]}], 
   "\[IndentingNewLine]", "]"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"GenIBPdotList", "[", 
   RowBox[{"h_", ",", "vars_List"}], "]"}], ":=", 
  RowBox[{"Module", "[", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{"pplist", ",", "he"}], "}"}], ",", 
    RowBox[{
     RowBox[{"he", "=", 
      RowBox[{"h", "//", "Expand"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"pplist", "=", 
      RowBox[{
       RowBox[{
        RowBox[{
         RowBox[{"GetDenominatorFun", "[", 
          RowBox[{"#", ",", "vars"}], "]"}], "&"}], "/@", 
        RowBox[{"(", 
         RowBox[{"List", "@@", "he"}], ")"}]}], "//", "Union"}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"pplist", "=", 
      RowBox[{"minSets", "[", "pplist", "]"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"Table", "[", 
      RowBox[{
       RowBox[{"Join", "[", 
        RowBox[{
         RowBox[{"pplist", "[", 
          RowBox[{"[", "ii", "]"}], "]"}], ",", 
         RowBox[{"Complement", "[", 
          RowBox[{"vars", ",", 
           RowBox[{
            RowBox[{"pplist", "[", 
             RowBox[{"[", "ii", "]"}], "]"}], "//", 
            RowBox[{
             RowBox[{"Cases", "[", 
              RowBox[{"#", ",", 
               RowBox[{"dot", "[", "__", "]"}], ",", 
               RowBox[{"{", 
                RowBox[{"0", ",", "\[Infinity]"}], "}"}]}], "]"}], "&"}]}]}], 
          "]"}]}], "]"}], ",", 
       RowBox[{"{", 
        RowBox[{"ii", ",", 
         RowBox[{"Length", "@", "pplist"}]}], "}"}]}], "]"}]}]}], 
   "\[IndentingNewLine]", "]"}]}], "\[IndentingNewLine]", 
 RowBox[{"ClearAll", "[", 
  RowBox[{"mono2j", ",", "mono2B"}], "]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"mono2j", "[", 
   RowBox[{"g_", ",", "pplist_", ",", "vars_"}], "]"}], ":=", 
  RowBox[{"Module", "[", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{
     "numt", ",", "pid", ",", "dds", ",", "dot2D", ",", "propgatorlist"}], 
     "}"}], ",", 
    RowBox[{
     RowBox[{"numt", "=", "g"}], ";", "\[IndentingNewLine]", 
     RowBox[{"propgatorlist", "=", 
      RowBox[{"GetDenominatorFun", "[", 
       RowBox[{"numt", ",", "vars"}], "]"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"pid", "=", 
      RowBox[{
       RowBox[{
        RowBox[{"Position", "[", 
         RowBox[{
          RowBox[{
           RowBox[{
            RowBox[{"SubsetQ", "[", 
             RowBox[{"#", ",", "propgatorlist"}], "]"}], "&"}], "/@", 
           "pplist"}], ",", "True"}], "]"}], "//", "Flatten"}], "//", 
       "First"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"dds", "=", 
      RowBox[{"Table", "[", 
       RowBox[{
        RowBox[{"\[ScriptCapitalD]", "[", "ii", "]"}], ",", 
        RowBox[{"{", 
         RowBox[{"ii", ",", 
          RowBox[{"Length", "@", 
           RowBox[{"pplist", "[", 
            RowBox[{"[", "pid", "]"}], "]"}]}]}], "}"}]}], "]"}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"dot2D", "=", 
      RowBox[{
       RowBox[{"Solve", "[", 
        RowBox[{
         RowBox[{
          RowBox[{"pplist", "[", 
           RowBox[{"[", "pid", "]"}], "]"}], "==", "dds"}], ",", "vars"}], 
        "]"}], "[", 
       RowBox[{"[", "1", "]"}], "]"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"numt", "=", 
      RowBox[{
       RowBox[{"numt", "/.", "dot2D"}], "//", "Expand"}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"numt", "=", 
      RowBox[{"If", "[", 
       RowBox[{
        RowBox[{
         RowBox[{"Head", "[", "numt", "]"}], "===", "Plus"}], ",", 
        RowBox[{"List", "@@", "numt"}], ",", 
        RowBox[{"{", "numt", "}"}]}], "]"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"(*", 
      RowBox[{
       RowBox[{"Print", "[", "numt", "]"}], ";"}], "*)"}], 
     "\[IndentingNewLine]", 
     RowBox[{"numt", "=", 
      RowBox[{"Sum", "[", 
       RowBox[{
        RowBox[{
         RowBox[{
          RowBox[{"(", 
           RowBox[{
            RowBox[{"numt", "[", 
             RowBox[{"[", "ii", "]"}], "]"}], "/.", 
            RowBox[{
             RowBox[{"\[ScriptCapitalD]", "[", "i_", "]"}], ":>", " ", 
             "1"}]}], ")"}], 
          RowBox[{"Mono2List", "[", 
           RowBox[{
            RowBox[{"numt", "[", 
             RowBox[{"[", "ii", "]"}], "]"}], ",", "dds"}], "]"}]}], "/.", 
         RowBox[{
          RowBox[{"FF", "[", 
           RowBox[{"1", ",", 
            RowBox[{"{", "f___", "}"}]}], "]"}], ":>", " ", 
          RowBox[{"j", "[", 
           RowBox[{
            RowBox[{"ToExpression", "[", 
             RowBox[{"\"\<gr\>\"", "<>", 
              RowBox[{"ToString", "[", "pid", "]"}]}], "]"}], ",", "f"}], 
           "]"}]}]}], ",", 
        RowBox[{"{", 
         RowBox[{"ii", ",", 
          RowBox[{"Length", "@", "numt"}]}], "}"}]}], "]"}]}]}]}], 
   "\[IndentingNewLine]", "]"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"mono2j", "[", 
   RowBox[{"g_", ",", "pplist_"}], "]"}], ":=", 
  RowBox[{"Module", "[", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{
     "numt", ",", "pid", ",", "dds", ",", "dot2D", ",", "propgatorlist"}], 
     "}"}], ",", 
    RowBox[{
     RowBox[{"numt", "=", "g"}], ";", "\[IndentingNewLine]", 
     RowBox[{"(*", 
      RowBox[{
       RowBox[{"propgatorlist", "=", 
        RowBox[{"GetDenominatorFun", "[", 
         RowBox[{"numt", ",", "vars"}], "]"}]}], ";", "\[IndentingNewLine]", 
       RowBox[{"pid", "=", 
        RowBox[{
         RowBox[{
          RowBox[{"Position", "[", 
           RowBox[{
            RowBox[{
             RowBox[{
              RowBox[{"SubsetQ", "[", 
               RowBox[{"#", ",", "propgatorlist"}], "]"}], "&"}], "/@", 
             "pplist"}], ",", "True"}], "]"}], "//", "Flatten"}], "//", 
         "First"}]}], ";"}], "*)"}], "\[IndentingNewLine]", 
     RowBox[{"dds", "=", 
      RowBox[{"Table", "[", 
       RowBox[{
        RowBox[{"\[ScriptCapitalD]", "[", "ii", "]"}], ",", 
        RowBox[{"{", 
         RowBox[{"ii", ",", 
          RowBox[{"Length", "@", "pplist"}]}], "}"}]}], "]"}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"dot2D", "=", 
      RowBox[{
       RowBox[{"Solve", "[", 
        RowBox[{
         RowBox[{"pplist", "==", "dds"}], ",", "pplist"}], "]"}], "[", 
       RowBox[{"[", "1", "]"}], "]"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"numt", "=", 
      RowBox[{
       RowBox[{"numt", "/.", "dot2D"}], "//", "Expand"}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"numt", "=", 
      RowBox[{"If", "[", 
       RowBox[{
        RowBox[{
         RowBox[{"Head", "[", "numt", "]"}], "===", "Plus"}], ",", 
        RowBox[{"List", "@@", "numt"}], ",", 
        RowBox[{"{", "numt", "}"}]}], "]"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"(*", 
      RowBox[{
       RowBox[{"Print", "[", "numt", "]"}], ";"}], "*)"}], 
     "\[IndentingNewLine]", 
     RowBox[{"numt", "=", 
      RowBox[{"Sum", "[", 
       RowBox[{
        RowBox[{
         RowBox[{
          RowBox[{"(", 
           RowBox[{
            RowBox[{"numt", "[", 
             RowBox[{"[", "ii", "]"}], "]"}], "/.", 
            RowBox[{
             RowBox[{"\[ScriptCapitalD]", "[", "i_", "]"}], ":>", " ", 
             "1"}]}], ")"}], 
          RowBox[{"Mono2List", "[", 
           RowBox[{
            RowBox[{"numt", "[", 
             RowBox[{"[", "ii", "]"}], "]"}], ",", "dds"}], "]"}]}], "/.", 
         RowBox[{
          RowBox[{"FF", "[", 
           RowBox[{"1", ",", 
            RowBox[{"{", "f___", "}"}]}], "]"}], ":>", " ", 
          RowBox[{"B", "@@", 
           RowBox[{"(", 
            RowBox[{"-", 
             RowBox[{"{", "f", "}"}]}], ")"}]}]}]}], ",", 
        RowBox[{"{", 
         RowBox[{"ii", ",", 
          RowBox[{"Length", "@", "numt"}]}], "}"}]}], "]"}]}]}]}], 
   "\[IndentingNewLine]", "]"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"mono2B", "[", 
   RowBox[{"g_", ",", "pplist_"}], "]"}], ":=", 
  RowBox[{"Module", "[", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{
     "numt", ",", "pid", ",", "dds", ",", "dot2D", ",", "propgatorlist"}], 
     "}"}], ",", 
    RowBox[{
     RowBox[{"numt", "=", "g"}], ";", "\[IndentingNewLine]", 
     RowBox[{"(*", 
      RowBox[{
       RowBox[{"propgatorlist", "=", 
        RowBox[{"GetDenominatorFun", "[", 
         RowBox[{"numt", ",", "vars"}], "]"}]}], ";", "\[IndentingNewLine]", 
       RowBox[{"pid", "=", 
        RowBox[{
         RowBox[{
          RowBox[{"Position", "[", 
           RowBox[{
            RowBox[{
             RowBox[{
              RowBox[{"SubsetQ", "[", 
               RowBox[{"#", ",", "propgatorlist"}], "]"}], "&"}], "/@", 
             "pplist"}], ",", "True"}], "]"}], "//", "Flatten"}], "//", 
         "First"}]}], ";"}], "*)"}], "\[IndentingNewLine]", 
     RowBox[{"dds", "=", 
      RowBox[{"Table", "[", 
       RowBox[{
        RowBox[{"\[ScriptCapitalD]", "[", "ii", "]"}], ",", 
        RowBox[{"{", 
         RowBox[{"ii", ",", 
          RowBox[{"Length", "@", "pplist"}]}], "}"}]}], "]"}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"dot2D", "=", 
      RowBox[{"MapThread", "[", 
       RowBox[{"Rule", ",", 
        RowBox[{"{", 
         RowBox[{"pplist", ",", "dds"}], "}"}]}], "]"}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"numt", "=", 
      RowBox[{
       RowBox[{"numt", "/.", "dot2D"}], "//", "Expand"}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"numt", "=", 
      RowBox[{"If", "[", 
       RowBox[{
        RowBox[{
         RowBox[{"Head", "[", "numt", "]"}], "===", "Plus"}], ",", 
        RowBox[{"List", "@@", "numt"}], ",", 
        RowBox[{"{", "numt", "}"}]}], "]"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"(*", 
      RowBox[{
       RowBox[{"Print", "[", "numt", "]"}], ";"}], "*)"}], 
     "\[IndentingNewLine]", 
     RowBox[{"numt", "=", 
      RowBox[{"Sum", "[", 
       RowBox[{
        RowBox[{
         RowBox[{
          RowBox[{"(", 
           RowBox[{
            RowBox[{"numt", "[", 
             RowBox[{"[", "ii", "]"}], "]"}], "/.", 
            RowBox[{
             RowBox[{"\[ScriptCapitalD]", "[", "i_", "]"}], ":>", " ", 
             "1"}]}], ")"}], 
          RowBox[{"Mono2List", "[", 
           RowBox[{
            RowBox[{"numt", "[", 
             RowBox[{"[", "ii", "]"}], "]"}], ",", "dds"}], "]"}]}], "/.", 
         RowBox[{
          RowBox[{"FF", "[", 
           RowBox[{"1", ",", 
            RowBox[{"{", "f___", "}"}]}], "]"}], ":>", " ", 
          RowBox[{"B", "@@", 
           RowBox[{"(", 
            RowBox[{"-", 
             RowBox[{"{", "f", "}"}]}], ")"}]}]}]}], ",", 
        RowBox[{"{", 
         RowBox[{"ii", ",", 
          RowBox[{"Length", "@", "numt"}]}], "}"}]}], "]"}]}]}]}], 
   "\[IndentingNewLine]", "]"}]}]}], "Input",
 CellChangeTimes->{{3.87013929658813*^9, 3.87013929709615*^9}, 
   3.87015456888785*^9, {3.870155204422731*^9, 3.870155217666298*^9}, {
   3.8701553410718737`*^9, 3.87015535134295*^9}, 3.870155401400276*^9, {
   3.8704311873876657`*^9, 3.870431268553248*^9}, {3.8705917169072323`*^9, 
   3.870591717418168*^9}, {3.876610362699594*^9, 3.8766104319483433`*^9}, {
   3.876610942764016*^9, 3.876610989180686*^9}},
 CellLabel->
  "In[288]:=",ExpressionUUID->"99fc1734-0a78-4f56-9085-9e1deef01c83"]
}, Closed]],

Cell[CellGroupData[{

Cell["Levi-Civita Expansion", "Subsection",
 CellChangeTimes->{{3.8768839877249594`*^9, 
  3.8768840068850174`*^9}},ExpressionUUID->"a0b21b7b-22d9-43b7-b714-\
f04ca4b20753"],

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{"etaMatrix", "[", 
    RowBox[{
    "x1_", ",", "x2_", ",", "x3_", ",", "x4_", ",", "x5_", ",", "x6_", ",", 
     "x7_", ",", "x8_"}], "]"}], ":=", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{
       RowBox[{"dot", "[", 
        RowBox[{"x1", ",", "x3"}], "]"}], ",", 
       RowBox[{"dot", "[", 
        RowBox[{"x1", ",", "x4"}], "]"}], ",", 
       RowBox[{"dot", "[", 
        RowBox[{"x1", ",", "x7"}], "]"}], ",", 
       RowBox[{"dot", "[", 
        RowBox[{"x1", ",", "x8"}], "]"}]}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"dot", "[", 
        RowBox[{"x2", ",", "x3"}], "]"}], ",", 
       RowBox[{"dot", "[", 
        RowBox[{"x2", ",", "x4"}], "]"}], ",", 
       RowBox[{"dot", "[", 
        RowBox[{"x2", ",", "x7"}], "]"}], ",", 
       RowBox[{"dot", "[", 
        RowBox[{"x2", ",", "x8"}], "]"}]}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"dot", "[", 
        RowBox[{"x5", ",", "x3"}], "]"}], ",", 
       RowBox[{"dot", "[", 
        RowBox[{"x5", ",", "x4"}], "]"}], ",", 
       RowBox[{"dot", "[", 
        RowBox[{"x5", ",", "x7"}], "]"}], ",", 
       RowBox[{"dot", "[", 
        RowBox[{"x5", ",", "x8"}], "]"}]}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"dot", "[", 
        RowBox[{"x6", ",", "x3"}], "]"}], ",", 
       RowBox[{"dot", "[", 
        RowBox[{"x6", ",", "x4"}], "]"}], ",", 
       RowBox[{"dot", "[", 
        RowBox[{"x6", ",", "x7"}], "]"}], ",", 
       RowBox[{"dot", "[", 
        RowBox[{"x6", ",", "x8"}], "]"}]}], "}"}]}], "}"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"LeviCivitaRules", "=", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{
      RowBox[{
       RowBox[{"dot", "[", 
        RowBox[{"x__", ",", 
         RowBox[{"S", "[", "0", "]"}], ",", "y__"}], "]"}], "*", 
       RowBox[{"dot", "[", 
        RowBox[{"z__", ",", 
         RowBox[{"S", "[", "0", "]"}], ",", "w__"}], "]"}]}], 
      "\[RuleDelayed]", " ", 
      RowBox[{"Det", "[", 
       RowBox[{"etaMatrix", "[", 
        RowBox[{"x", ",", "y", ",", "z", ",", "w", ",", 
         RowBox[{"v", "[", "1", "]"}], ",", 
         RowBox[{"as", "[", "1", "]"}], ",", 
         RowBox[{"v", "[", "1", "]"}], ",", 
         RowBox[{"as", "[", "1", "]"}]}], "]"}], "]"}]}], ",", 
     RowBox[{
      RowBox[{
       RowBox[{"dot", "[", 
        RowBox[{"x__", ",", 
         RowBox[{"S", "[", "0", "]"}], ",", "y__"}], "]"}], "^", "2"}], 
      "\[RuleDelayed]", " ", 
      RowBox[{"Det", "[", 
       RowBox[{"etaMatrix", "[", 
        RowBox[{"x", ",", "y", ",", "x", ",", "y", ",", 
         RowBox[{"v", "[", "1", "]"}], ",", 
         RowBox[{"as", "[", "1", "]"}], ",", 
         RowBox[{"v", "[", "1", "]"}], ",", 
         RowBox[{"as", "[", "1", "]"}]}], "]"}], "]"}]}], ",", 
     "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"dot", "[", 
       RowBox[{"x__", ",", 
        RowBox[{"S", "[", "0", "]"}], ",", 
        RowBox[{"S", "[", "0", "]"}], ",", "z__"}], "]"}], "\[RuleDelayed]", 
      RowBox[{"Det", "[", 
       RowBox[{"etaMatrix", "[", 
        RowBox[{"x", ",", 
         RowBox[{"link", "[", "1", "]"}], ",", 
         RowBox[{"link", "[", "2", "]"}], ",", "z", ",", 
         RowBox[{"v", "[", "1", "]"}], ",", 
         RowBox[{"as", "[", "1", "]"}], ",", 
         RowBox[{"v", "[", "1", "]"}], ",", 
         RowBox[{"as", "[", "1", "]"}]}], "]"}], "]"}]}], ",", 
     RowBox[{
      RowBox[{
       RowBox[{"dot", "[", 
        RowBox[{"OrderlessPatternSequence", "[", 
         RowBox[{"x__", ",", 
          RowBox[{"link", "[", "1", "]"}]}], "]"}], "]"}], "*", 
       RowBox[{"dot", "[", 
        RowBox[{"OrderlessPatternSequence", "[", 
         RowBox[{
          RowBox[{"link", "[", "2", "]"}], ",", "y__"}], "]"}], "]"}]}], 
      "\[RuleDelayed]", " ", 
      RowBox[{"dot", "[", 
       RowBox[{"x", ",", "y"}], "]"}]}], ",", 
     RowBox[{
      RowBox[{"dot", "[", 
       RowBox[{
        RowBox[{"link", "[", "1", "]"}], ",", 
        RowBox[{"link", "[", "2", "]"}]}], "]"}], "\[RuleDelayed]", " ", 
      "4"}]}], "}"}]}], ";"}]}], "Input",
 CellChangeTimes->{{3.8768840132355785`*^9, 3.8768842998443704`*^9}, 
   3.876884381286206*^9, 3.8768846313348503`*^9, {3.8768848235347595`*^9, 
   3.8768848250622816`*^9}, {3.876884994437706*^9, 3.876885012863758*^9}, {
   3.8768850844746947`*^9, 3.8768851091596127`*^9}, 3.8768851539944844`*^9, {
   3.87688521533451*^9, 3.8768852713981457`*^9}, {3.876885335175208*^9, 
   3.876885351492401*^9}, {3.8768854733517604`*^9, 3.876885505073959*^9}, {
   3.8768856338380685`*^9, 3.8768856480594964`*^9}, {3.87688571180394*^9, 
   3.876885723492938*^9}, {3.876886067811977*^9, 3.8768860706668143`*^9}, {
   3.876886191211523*^9, 3.876886194308797*^9}, {3.8768862498375735`*^9, 
   3.8768862723904047`*^9}, {3.8768864357186832`*^9, 
   3.8768864575147076`*^9}, {3.876886521705386*^9, 3.8768865250763845`*^9}, {
   3.8768911729365826`*^9, 3.8768911758873215`*^9}, {3.876891378499098*^9, 
   3.8768913829626727`*^9}, {3.8768917279229145`*^9, 
   3.8768918227287827`*^9}, {3.8768918567662687`*^9, 3.876891862084496*^9}, {
   3.876891995237666*^9, 3.8768920389845877`*^9}, {3.876892348252355*^9, 
   3.8768923487232003`*^9}, {3.876892431372145*^9, 3.8768924864557524`*^9}, {
   3.8768925321992645`*^9, 3.8768925842200327`*^9}, {3.8768926319404135`*^9, 
   3.876892709111734*^9}, {3.876893055725041*^9, 3.8768930933146024`*^9}, {
   3.876896757920308*^9, 3.8768967832936344`*^9}, {3.8768968404793005`*^9, 
   3.8768968767798157`*^9}, {3.876896943542839*^9, 3.8768969542321806`*^9}, {
   3.8769099072943935`*^9, 3.8769099215900235`*^9}, {3.8769104962912087`*^9, 
   3.8769104992934227`*^9}, {3.8769105855059166`*^9, 3.876910586620945*^9}, {
   3.8769107980020957`*^9, 3.8769108351739635`*^9}, 3.876910890905717*^9, {
   3.876911600661398*^9, 3.8769116164692364`*^9}, {3.876975729812666*^9, 
   3.876975742334115*^9}},
 CellLabel->
  "In[297]:=",ExpressionUUID->"006014a7-50c8-4960-957b-36085fac27a6"],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{
     RowBox[{"dot", "[", 
      RowBox[{
       RowBox[{"p", "[", "1", "]"}], ",", 
       RowBox[{"S", "[", "0", "]"}], ",", 
       RowBox[{"S", "[", "0", "]"}], ",", 
       RowBox[{"p", "[", "2", "]"}]}], "]"}], "//.", "LeviCivitaRules"}], "//.",
     "dotRules"}], "//.", 
   RowBox[{
    RowBox[{"dot", "[", 
     RowBox[{
      RowBox[{"p", "[", "1", "]"}], ",", 
      RowBox[{"v", "[", "1", "]"}]}], "]"}], "\[RuleDelayed]", "0"}]}], "//", 
  "MatrixForm"}]], "Input",
 CellChangeTimes->{{3.87690472225254*^9, 3.8769047374638715`*^9}, {
   3.876909950601557*^9, 3.8769100129899826`*^9}, {3.876910611184396*^9, 
   3.876910613078656*^9}, 3.8769109453578815`*^9},
 CellLabel->
  "In[299]:=",ExpressionUUID->"3ca232e2-f1dd-445d-93e3-49d2850803d9"],

Cell[BoxData[
 TagBox[
  RowBox[{
   RowBox[{
    RowBox[{"dot", "[", 
     RowBox[{
      RowBox[{"as", "[", "1", "]"}], ",", 
      RowBox[{"p", "[", "1", "]"}]}], "]"}], " ", 
    RowBox[{"dot", "[", 
     RowBox[{
      RowBox[{"as", "[", "1", "]"}], ",", 
      RowBox[{"p", "[", "2", "]"}]}], "]"}]}], "-", 
   RowBox[{
    RowBox[{"dot", "[", 
     RowBox[{
      RowBox[{"as", "[", "1", "]"}], ",", 
      RowBox[{"as", "[", "1", "]"}]}], "]"}], " ", 
    RowBox[{"dot", "[", 
     RowBox[{
      RowBox[{"p", "[", "1", "]"}], ",", 
      RowBox[{"p", "[", "2", "]"}]}], "]"}]}], "+", 
   RowBox[{
    SuperscriptBox[
     RowBox[{"dot", "[", 
      RowBox[{
       RowBox[{"as", "[", "1", "]"}], ",", 
       RowBox[{"v", "[", "1", "]"}]}], "]"}], "2"], " ", 
    RowBox[{"dot", "[", 
     RowBox[{
      RowBox[{"p", "[", "1", "]"}], ",", 
      RowBox[{"p", "[", "2", "]"}]}], "]"}]}], "-", 
   RowBox[{
    RowBox[{"dot", "[", 
     RowBox[{
      RowBox[{"as", "[", "1", "]"}], ",", 
      RowBox[{"p", "[", "1", "]"}]}], "]"}], " ", 
    RowBox[{"dot", "[", 
     RowBox[{
      RowBox[{"as", "[", "1", "]"}], ",", 
      RowBox[{"v", "[", "1", "]"}]}], "]"}], " ", 
    RowBox[{"dot", "[", 
     RowBox[{
      RowBox[{"p", "[", "2", "]"}], ",", 
      RowBox[{"v", "[", "1", "]"}]}], "]"}]}]}],
  Function[BoxForm`e$, 
   MatrixForm[BoxForm`e$]]]], "Output",
 CellChangeTimes->{
  3.876904738059334*^9, {3.876909911600319*^9, 3.876909955077817*^9}, {
   3.8769099962790804`*^9, 3.876910013748637*^9}, 3.876910504661888*^9, {
   3.876910592918396*^9, 3.876910613394039*^9}, 3.8769108024676075`*^9, 
   3.876910836873968*^9, 3.876910892579012*^9, 3.876910945636489*^9, 
   3.876974885755063*^9, 3.876976984366579*^9, 3.8770662000586348`*^9},
 CellLabel->
  "Out[299]//MatrixForm=",ExpressionUUID->"9a3272cb-df86-4212-b37c-\
7ae3cce05428"]
}, Open  ]]
}, Open  ]]
}, Closed]],

Cell[CellGroupData[{

Cell["SubFunctions Spin Ansatz", "Section",
 CellChangeTimes->{{3.8768042159264*^9, 3.876804221321859*^9}, {
  3.877066238287374*^9, 
  3.877066252520989*^9}},ExpressionUUID->"920e92b2-f483-4633-8572-\
95f7ad2029ee"],

Cell[BoxData[{
 RowBox[{"ClearAll", "[", 
  RowBox[{
  "KSetPartitions", ",", "SetPartitions", ",", "KSetPartitionsEmpty"}], 
  "]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"KSetPartitions", "[", 
   RowBox[{"0", ",", " ", "0"}], "]"}], " ", ":=", " ", 
  RowBox[{"{", 
   RowBox[{"{", "}"}], "}"}]}], "\n", 
 RowBox[{
  RowBox[{"KSetPartitions", "[", 
   RowBox[{
    RowBox[{"{", "}"}], ",", " ", "0"}], "]"}], " ", ":=", " ", 
  RowBox[{"{", 
   RowBox[{"{", "}"}], "}"}]}], "\n", 
 RowBox[{
  RowBox[{"KSetPartitions", "[", 
   RowBox[{"s_List", ",", " ", "0"}], "]"}], " ", ":=", " ", 
  RowBox[{"{", "}"}]}], "\n", 
 RowBox[{
  RowBox[{
   RowBox[{"KSetPartitions", "[", 
    RowBox[{"s_List", ",", " ", "k_Integer"}], "]"}], " ", ":=", " ", 
   RowBox[{
    RowBox[{"{", "}"}], " ", "/;", " ", 
    RowBox[{"k", " ", ">", " ", 
     RowBox[{"Length", "[", "s", "]"}]}]}]}], " "}], "\n", 
 RowBox[{
  RowBox[{"KSetPartitions", "[", 
   RowBox[{"s_List", ",", " ", "k_Integer"}], "]"}], " ", ":=", " ", 
  RowBox[{
   RowBox[{"{", 
    RowBox[{
     RowBox[{"(", 
      RowBox[{
       RowBox[{"{", "#1", "}"}], " ", "&"}], " ", ")"}], " ", "/@", " ", 
     "s"}], "}"}], " ", "/;", " ", 
   RowBox[{"k", " ", "===", " ", 
    RowBox[{"Length", "[", "s", "]"}]}]}]}], "\n", 
 RowBox[{
  RowBox[{"KSetPartitions", "[", 
   RowBox[{"s_List", ",", " ", "k_Integer"}], "]"}], " ", ":=", " ", 
  RowBox[{
   RowBox[{"Block", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{
       RowBox[{"$RecursionLimit", " ", "=", " ", "Infinity"}], ",", " ", 
       "j"}], "}"}], ",", " ", 
     RowBox[{"Join", "[", 
      RowBox[{
       RowBox[{
        RowBox[{"(", 
         RowBox[{
          RowBox[{"Prepend", "[", 
           RowBox[{"#1", ",", " ", 
            RowBox[{"{", 
             RowBox[{"First", "[", "s", "]"}], "}"}]}], "]"}], " ", "&"}], 
         " ", ")"}], " ", "/@", " ", 
        RowBox[{"KSetPartitions", "[", 
         RowBox[{
          RowBox[{"Rest", "[", "s", "]"}], ",", " ", 
          RowBox[{"k", " ", "-", " ", "1"}]}], "]"}]}], ",", " ", 
       RowBox[{"Flatten", "[", 
        RowBox[{
         RowBox[{
          RowBox[{"(", 
           RowBox[{
            RowBox[{"Table", "[", 
             RowBox[{
              RowBox[{"Prepend", "[", 
               RowBox[{
                RowBox[{"Delete", "[", 
                 RowBox[{"#1", ",", " ", "j"}], "]"}], ",", " ", 
                RowBox[{"Prepend", "[", 
                 RowBox[{
                  RowBox[{"#1", "[", 
                   RowBox[{"[", "j", "]"}], "]"}], ",", " ", 
                  RowBox[{"s", "[", 
                   RowBox[{"[", "1", "]"}], "]"}]}], "]"}]}], "]"}], ",", " ", 
              RowBox[{"{", 
               RowBox[{"j", ",", " ", 
                RowBox[{"Length", "[", "#1", "]"}]}], "}"}]}], "]"}], " ", 
            "&"}], " ", ")"}], " ", "/@", " ", 
          RowBox[{"KSetPartitions", "[", 
           RowBox[{
            RowBox[{"Rest", "[", "s", "]"}], ",", " ", "k"}], "]"}]}], ",", 
         " ", "1"}], "]"}]}], "]"}]}], "]"}], " ", "/;", " ", 
   RowBox[{
    RowBox[{"k", " ", ">", " ", "0"}], " ", "&&", " ", 
    RowBox[{"k", " ", "<", " ", 
     RowBox[{"Length", "[", "s", "]"}]}]}]}]}], "\n", 
 RowBox[{
  RowBox[{"KSetPartitions", "[", 
   RowBox[{"0", ",", " ", 
    RowBox[{
     RowBox[{"(", "k_Integer", ")"}], "?", "Positive"}]}], "]"}], " ", ":=", 
  " ", 
  RowBox[{"{", "}"}]}], "\n", 
 RowBox[{
  RowBox[{"KSetPartitions", "[", 
   RowBox[{
    RowBox[{
     RowBox[{"(", "n_Integer", ")"}], "?", "Positive"}], ",", " ", "0"}], 
   "]"}], " ", ":=", " ", 
  RowBox[{"{", "}"}]}], "\n", 
 RowBox[{
  RowBox[{"KSetPartitions", "[", 
   RowBox[{
    RowBox[{
     RowBox[{"(", "n_Integer", ")"}], "?", "Positive"}], ",", " ", 
    RowBox[{
     RowBox[{"(", "k_Integer", ")"}], "?", "Positive"}]}], "]"}], " ", ":=", 
  " ", 
  RowBox[{"KSetPartitions", "[", 
   RowBox[{
    RowBox[{"Range", "[", "n", "]"}], ",", " ", "k"}], 
   "]"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"SetPartitions", "[", "0", "]"}], " ", ":=", " ", 
  RowBox[{"{", 
   RowBox[{"{", "}"}], "}"}]}], "\n", 
 RowBox[{
  RowBox[{"SetPartitions", "[", 
   RowBox[{"{", "}"}], "]"}], " ", ":=", " ", 
  RowBox[{"{", 
   RowBox[{"{", "}"}], "}"}]}], "\n", 
 RowBox[{
  RowBox[{"SetPartitions", "[", "s_List", "]"}], " ", ":=", " ", 
  RowBox[{"Flatten", "[", 
   RowBox[{
    RowBox[{"Table", "[", 
     RowBox[{
      RowBox[{"KSetPartitions", "[", 
       RowBox[{"s", ",", " ", "i"}], "]"}], ",", " ", 
      RowBox[{"{", 
       RowBox[{"i", ",", " ", "2", ",", 
        RowBox[{
         RowBox[{"Length", "[", "s", "]"}], "-", "2"}]}], "}"}]}], "]"}], ",",
     " ", "1"}], "]"}]}], "\n", 
 RowBox[{
  RowBox[{"SetPartitions", "[", 
   RowBox[{
    RowBox[{"(", "n_Integer", ")"}], "?", "Positive"}], "]"}], " ", ":=", " ", 
  RowBox[{"SetPartitions", "[", 
   RowBox[{"Range", "[", "n", "]"}], "]"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"KSetPartitionsEmpty", "[", 
    RowBox[{"s_List", ",", "k_Integer"}], "]"}], ":=", 
   RowBox[{"Module", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"app", ",", "KMod"}], "}"}], ",", 
     RowBox[{
      RowBox[{"app", "=", 
       RowBox[{"KSetPartitions", "[", 
        RowBox[{"s", ",", "k"}], "]"}]}], ";", 
      RowBox[{"Do", "[", 
       RowBox[{
        RowBox[{
         RowBox[{"KMod", "=", 
          RowBox[{"KSetPartitions", "[", 
           RowBox[{"s", ",", "q"}], "]"}]}], ";", 
         RowBox[{"Do", "[", 
          RowBox[{
           RowBox[{
            RowBox[{"Do", "[", 
             RowBox[{
              RowBox[{"AppendTo", "[", 
               RowBox[{
                RowBox[{"KMod", "[", 
                 RowBox[{"[", "i", "]"}], "]"}], ",", 
                RowBox[{"{", "}"}]}], "]"}], ",", 
              RowBox[{"{", 
               RowBox[{"j", ",", "1", ",", 
                RowBox[{"k", "-", "q"}]}], "}"}]}], "]"}], ";", 
            RowBox[{"AppendTo", "[", 
             RowBox[{"app", ",", 
              RowBox[{"KMod", "[", 
               RowBox[{"[", "i", "]"}], "]"}]}], "]"}]}], ",", 
           RowBox[{"{", 
            RowBox[{"i", ",", 
             RowBox[{"Length", "[", 
              RowBox[{"KSetPartitions", "[", 
               RowBox[{"s", ",", "q"}], "]"}], "]"}]}], "}"}]}], "]"}]}], ",", 
        RowBox[{"{", 
         RowBox[{"q", ",", "1", ",", 
          RowBox[{"k", "-", "1"}]}], "}"}]}], "]"}], ";", 
      RowBox[{"Return", "[", "app", "]"}]}]}], "]"}]}], ";"}]}], "Input",
 CellChangeTimes->{{3.876811307266223*^9, 3.876811357406602*^9}, {
  3.876814773296413*^9, 3.876814814709012*^9}, {3.8768150847160673`*^9, 
  3.876815104266962*^9}},
 CellLabel->
  "In[327]:=",ExpressionUUID->"a59468cd-400d-4953-be9d-1224995358e2"],

Cell[BoxData[{
 RowBox[{"ClearAll", "[", "monomialsAnsSingle", 
  "]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"monomialsAnsSingle", "[", 
   RowBox[{"lv_", ",", "od_List", ",", "rv_"}], "]"}], ":=", 
  RowBox[{"Module", "[", 
   RowBox[{
    RowBox[{"{", "pt", "}"}], ",", 
    RowBox[{
     RowBox[{"pt", "=", 
      RowBox[{
       RowBox[{"Permutations", "[", "od", "]"}], "//", "DeleteDuplicates"}]}],
      ";", 
     RowBox[{"(", 
      RowBox[{
       RowBox[{
        RowBox[{"dot", "[", 
         RowBox[{"lv", ",", "##", ",", "rv"}], "]"}], "&"}], "@@@", "pt"}], 
      ")"}]}]}], "]"}]}]}], "Input",
 CellChangeTimes->{{3.876804285141453*^9, 3.876804311219627*^9}, {
   3.876804354297196*^9, 3.876804394553791*^9}, {3.876804547147678*^9, 
   3.876804564077526*^9}, 3.8768046310569696`*^9, {3.8768046788966293`*^9, 
   3.876804767317877*^9}, {3.876804900865148*^9, 3.87680509438022*^9}, {
   3.8768051395051527`*^9, 3.876805155807871*^9}, {3.876805253968152*^9, 
   3.876805264267679*^9}, {3.8768053169740458`*^9, 3.876805320484037*^9}, 
   3.876805351239914*^9, {3.8768054423488283`*^9, 3.8768054713281593`*^9}, {
   3.8768055021330214`*^9, 3.876805503038082*^9}, {3.87680557435063*^9, 
   3.8768056288868513`*^9}, {3.876806417065815*^9, 3.876806469431156*^9}, {
   3.876810617157659*^9, 3.876810647969964*^9}, 3.876810746169541*^9, 
   3.877066211011817*^9},
 CellLabel->
  "In[325]:=",ExpressionUUID->"b391ede9-be00-4b65-b0fd-aa1f912d39f2"],

Cell[BoxData[{
 RowBox[{"ClearAll", "[", "partitions", "]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"partitions", "[", 
   RowBox[{"list_", ",", "l_"}], "]"}], ":=", 
  RowBox[{"Join", "@@", 
   RowBox[{"Table", "[", 
    RowBox[{
     RowBox[{
      RowBox[{
       RowBox[{"{", 
        RowBox[{"x", ",", "##"}], "}"}], "&"}], "@@@", 
      RowBox[{"partitions", "[", 
       RowBox[{
        RowBox[{"list", "~", "Complement", "~", "x"}], ",", "l"}], "]"}]}], 
     ",", 
     RowBox[{"{", 
      RowBox[{"x", ",", 
       RowBox[{"Subsets", "[", 
        RowBox[{"list", ",", 
         RowBox[{"{", "l", "}"}], ",", 
         RowBox[{"Binomial", "[", 
          RowBox[{
           RowBox[{
            RowBox[{"Length", "[", "list", "]"}], "-", "1"}], ",", 
           RowBox[{"l", "-", "1"}]}], "]"}]}], "]"}]}], "}"}]}], 
    "]"}]}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"partitions", "[", 
    RowBox[{"list_", ",", "l_"}], "]"}], "/;", 
   RowBox[{
    RowBox[{"Length", "[", "list", "]"}], "===", "l"}]}], ":=", 
  RowBox[{"{", 
   RowBox[{"{", "list", "}"}], "}"}]}]}], "Input",
 CellChangeTimes->{{3.876813314352524*^9, 3.876813328750271*^9}},
 CellLabel->
  "In[342]:=",ExpressionUUID->"55f9f031-ef59-4843-b717-d41b3d5f725a"],

Cell[BoxData[{
 RowBox[{"ClearAll", "[", "monoAllF", "]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"monoAllF", "[", 
   RowBox[{"ptsets_", ",", "vs_"}], "]"}], ":=", 
  RowBox[{"Module", "[", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{"mono1", ",", "mono2", ",", "monoAll", ",", "a"}], "}"}], ",", 
    RowBox[{
     RowBox[{
      RowBox[{"Table", "[", 
       RowBox[{
        RowBox[{
         RowBox[{"mono1", "=", 
          RowBox[{"Table", "[", 
           RowBox[{
            RowBox[{
             RowBox[{"monomialsAnsSingle", "[", 
              RowBox[{
               RowBox[{"vs", "[", 
                RowBox[{"[", 
                 RowBox[{"jj", ",", "1"}], "]"}], "]"}], ",", 
               RowBox[{"ptsets", "[", 
                RowBox[{"[", 
                 RowBox[{"ii", ",", "jj"}], "]"}], "]"}], ",", 
               RowBox[{"vs", "[", 
                RowBox[{"[", 
                 RowBox[{"jj", ",", "2"}], "]"}], "]"}]}], "]"}], "//", 
             "Total"}], ",", 
            RowBox[{"{", 
             RowBox[{"jj", ",", 
              RowBox[{"Length", "@", 
               RowBox[{"ptsets", "[", 
                RowBox[{"[", "ii", "]"}], "]"}]}]}], "}"}]}], "]"}]}], ";", 
         "\[IndentingNewLine]", 
         RowBox[{"mono2", "=", 
          RowBox[{"(", 
           RowBox[{"Times", "@@", "mono1"}], ")"}]}], ";", 
         "\[IndentingNewLine]", 
         RowBox[{"monoAll", "=", 
          RowBox[{"DeleteCases", "[", 
           RowBox[{
            RowBox[{"List", "@@", 
             RowBox[{"(", 
              RowBox[{
               RowBox[{"a", "+", "mono2"}], "//", "Expand"}], ")"}]}], ",", 
            "a"}], "]"}]}]}], ",", 
        RowBox[{"{", 
         RowBox[{"ii", ",", 
          RowBox[{"Length", "@", "ptsets"}]}], "}"}]}], "]"}], "//", 
      "Flatten"}], "//", "DeleteDuplicates"}]}], "]"}]}]}], "Input",
 CellChangeTimes->{{3.876811369960775*^9, 3.8768113727341633`*^9}, {
   3.876811485009445*^9, 3.876811595092298*^9}, {3.876811639699731*^9, 
   3.876811640893647*^9}, 3.8768116783304043`*^9, {3.876811716061986*^9, 
   3.876811732470446*^9}, {3.876811790156522*^9, 3.876811796540135*^9}, {
   3.8768118801902447`*^9, 3.876811892921207*^9}, {3.876811927282494*^9, 
   3.876812045955064*^9}, {3.876812090166971*^9, 3.876812166246018*^9}, {
   3.876812217543675*^9, 3.8768122751008883`*^9}, {3.876812307151626*^9, 
   3.876812392859235*^9}, 3.876812451314582*^9, 3.8773367732900352`*^9, {
   3.877344524700871*^9, 3.877344554764751*^9}, {3.8773446377947187`*^9, 
   3.877344642934064*^9}, {3.877344709517954*^9, 3.8773447168750067`*^9}, {
   3.877344826511199*^9, 3.877344918321042*^9}, {3.877351477664247*^9, 
   3.8773514780370626`*^9}, {3.877351529018159*^9, 3.877351561254724*^9}, {
   3.877353282330694*^9, 3.877353342917494*^9}, {3.877353392697257*^9, 
   3.8773534009593678`*^9}},
 CellLabel->
  "In[721]:=",ExpressionUUID->"c5bb3695-411a-4d6d-9a74-02514b7878ff"],

Cell[BoxData[{
 RowBox[{"ClearAll", "[", "BoundaryPatitions", "]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"BoundaryPatitions", "[", "ls_List", "]"}], ":=", 
  RowBox[{"Module", "[", 
   RowBox[{
    RowBox[{"{", "L", "}"}], ",", 
    RowBox[{
     RowBox[{"(", 
      RowBox[{
       RowBox[{
        RowBox[{"L", "@@@", 
         RowBox[{"Permutations", "[", "ls", "]"}]}], "/.", 
        RowBox[{
         RowBox[{"L", "[", "f__", "]"}], ":>", 
         RowBox[{"L", "@@", 
          RowBox[{"Sort", "/@", 
           RowBox[{"ArrayReshape", "[", 
            RowBox[{
             RowBox[{"{", "f", "}"}], ",", 
             RowBox[{"{", 
              RowBox[{
               RowBox[{
                FractionBox["1", "2"], 
                RowBox[{"Length", "@", 
                 RowBox[{"{", "f", "}"}]}]}], ",", "2"}], "}"}]}], 
            "]"}]}]}]}]}], "//", "Union"}], ")"}], "/.", 
     RowBox[{
      RowBox[{"L", "[", "g__", "]"}], ":>", 
      RowBox[{"{", "g", "}"}]}]}]}], "]"}]}]}], "Input",
 CellChangeTimes->{{3.87733744584068*^9, 3.877337473186795*^9}},
 CellLabel->
  "In[626]:=",ExpressionUUID->"7e5a8741-43ac-4327-aa5f-6dbd2093223d"],

Cell[BoxData[{
 RowBox[{"ClearAll", "[", "BoundaryVectors", "]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"BoundaryVectors", "[", 
   RowBox[{"spinOrder_", ",", "head_"}], "]"}], ":=", 
  RowBox[{"Module", "[", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{"a", ",", "b", ",", "L", ",", "pv"}], "}"}], ",", 
    RowBox[{
     RowBox[{"If", "[", 
      RowBox[{
       RowBox[{"spinOrder", "==", "0"}], ",", 
       RowBox[{"pv", "=", 
        RowBox[{"{", 
         RowBox[{
          RowBox[{"v", "[", "1", "]"}], ",", 
          RowBox[{"v", "[", "1", "]"}]}], "}"}]}]}], "]"}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"If", "[", 
      RowBox[{
       RowBox[{"spinOrder", "==", "1"}], ",", 
       RowBox[{"pv", "=", 
        RowBox[{"{", 
         RowBox[{
          RowBox[{"{", 
           RowBox[{
            RowBox[{"v", "[", "1", "]"}], ",", 
            RowBox[{"p", "[", "1", "]"}]}], "}"}], ",", 
          RowBox[{"{", 
           RowBox[{
            RowBox[{"v", "[", "1", "]"}], ",", 
            RowBox[{"p", "[", "2", "]"}]}], "}"}]}], "}"}]}]}], "]"}], ";", 
     RowBox[{"If", "[", 
      RowBox[{
       RowBox[{
        RowBox[{"EvenQ", "[", "spinOrder", "]"}], "&&", " ", 
        RowBox[{"spinOrder", ">", "1"}]}], ",", 
       RowBox[{"pv", "=", 
        RowBox[{
         RowBox[{
          RowBox[{"Join", "[", 
           RowBox[{
            RowBox[{"{", 
             RowBox[{
              RowBox[{"v", "[", "1", "]"}], ",", 
              RowBox[{"v", "[", "1", "]"}]}], "}"}], ",", "#"}], "]"}], "&"}],
          "/@", 
         RowBox[{"(", 
          RowBox[{
           RowBox[{
            RowBox[{
             RowBox[{
              RowBox[{
               RowBox[{"List", "@@", 
                RowBox[{"(", 
                 RowBox[{
                  SuperscriptBox[
                   RowBox[{"(", 
                    RowBox[{"a", "+", "b"}], ")"}], "spinOrder"], "//", 
                  "Expand"}], ")"}]}], "/.", 
               RowBox[{
                RowBox[{
                 RowBox[{"a_", " ", "b_"}], "/;", 
                 RowBox[{"NumericQ", "[", "a", "]"}]}], ":>", "b"}]}], "/.", 
              RowBox[{"Times", "->", "L"}]}], "/.", 
             RowBox[{
              RowBox[{"Power", "[", 
               RowBox[{"x_", ",", "n_"}], "]"}], ":>", 
              RowBox[{"ConstantArray", "[", 
               RowBox[{"x", ",", "n"}], "]"}]}]}], "/.", 
            RowBox[{
             RowBox[{"L", "[", "f__", "]"}], ":>", 
             RowBox[{"Flatten", "[", 
              RowBox[{"{", "f", "}"}], "]"}]}]}], "/.", 
           RowBox[{"{", 
            RowBox[{
             RowBox[{"a", "->", 
              RowBox[{"head", "[", "1", "]"}]}], ",", 
             RowBox[{"b", "->", 
              RowBox[{"head", "[", "2", "]"}]}]}], "}"}]}], ")"}]}]}]}], 
      "]"}], ";", "\[IndentingNewLine]", 
     RowBox[{"If", "[", 
      RowBox[{
       RowBox[{
        RowBox[{"OddQ", "[", "spinOrder", "]"}], "&&", " ", 
        RowBox[{"spinOrder", ">", "1"}]}], ",", 
       RowBox[{"pv", "=", 
        RowBox[{
         RowBox[{
          RowBox[{"Join", "[", 
           RowBox[{
            RowBox[{"{", 
             RowBox[{"v", "[", "1", "]"}], "}"}], ",", "#"}], "]"}], "&"}], "/@", 
         RowBox[{"(", 
          RowBox[{
           RowBox[{
            RowBox[{
             RowBox[{
              RowBox[{
               RowBox[{"List", "@@", 
                RowBox[{"(", 
                 RowBox[{
                  SuperscriptBox[
                   RowBox[{"(", 
                    RowBox[{"a", "+", "b"}], ")"}], "spinOrder"], "//", 
                  "Expand"}], ")"}]}], "/.", 
               RowBox[{
                RowBox[{
                 RowBox[{"a_", " ", "b_"}], "/;", 
                 RowBox[{"NumericQ", "[", "a", "]"}]}], ":>", "b"}]}], "/.", 
              RowBox[{"Times", "->", "L"}]}], "/.", 
             RowBox[{
              RowBox[{"Power", "[", 
               RowBox[{"x_", ",", "n_"}], "]"}], ":>", 
              RowBox[{"ConstantArray", "[", 
               RowBox[{"x", ",", "n"}], "]"}]}]}], "/.", 
            RowBox[{
             RowBox[{"L", "[", "f__", "]"}], ":>", 
             RowBox[{"Flatten", "[", 
              RowBox[{"{", "f", "}"}], "]"}]}]}], "/.", 
           RowBox[{"{", 
            RowBox[{
             RowBox[{"a", "->", 
              RowBox[{"head", "[", "1", "]"}]}], ",", 
             RowBox[{"b", "->", 
              RowBox[{"head", "[", "2", "]"}]}]}], "}"}]}], ")"}]}]}]}], 
      "]"}], ";", "\[IndentingNewLine]", "pv"}]}], "]"}]}]}], "Input",
 CellChangeTimes->{{3.8773416566037617`*^9, 3.877341711224474*^9}, {
  3.877341776918145*^9, 3.8773419063009233`*^9}, {3.877341937520246*^9, 
  3.877341952447928*^9}, {3.877342001926*^9, 3.8773420048454742`*^9}},
 CellLabel->
  "In[628]:=",ExpressionUUID->"38b08510-db19-43f8-a58a-03d08123cfc5"],

Cell[BoxData[{
 RowBox[{"ClearAll", "[", "BoundaryPatitionsAll", 
  "]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"BoundaryPatitionsAll", "[", 
   RowBox[{"spinOrder_", ",", "head_"}], "]"}], ":=", 
  RowBox[{
   RowBox[{"Flatten", "[", 
    RowBox[{
     RowBox[{"BoundaryPatitions", "/@", 
      RowBox[{"BoundaryVectors", "[", 
       RowBox[{"spinOrder", ",", "head"}], "]"}]}], ",", "1"}], "]"}], "//", 
   "Union"}]}]}], "Input",
 CellChangeTimes->{{3.877338762411083*^9, 3.877338778408136*^9}, {
  3.877338822296833*^9, 3.8773389457743597`*^9}},
 CellLabel->
  "In[630]:=",ExpressionUUID->"44f39062-7878-4704-8ab1-b2a9233078bb"],

Cell[BoxData[
 RowBox[{
  RowBox[{"dotRules", "=", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{
      RowBox[{"dot", "[", 
       RowBox[{"a_", ",", 
        RowBox[{"S", "[", "i_", "]"}], ",", "a_"}], "]"}], "\[RuleDelayed]", 
      " ", "0"}], ",", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"dot", "[", 
       RowBox[{"a__", ",", 
        RowBox[{"S", "[", "i_", "]"}], ",", "b__"}], "]"}], "\[RuleDelayed]", 
      " ", 
      RowBox[{"0", "/;", 
       RowBox[{
        RowBox[{
         RowBox[{"{", 
          RowBox[{"a", ",", 
           RowBox[{"S", "[", "i", "]"}], ",", "b"}], "}"}], "==", 
         RowBox[{"Reverse", "[", 
          RowBox[{"{", 
           RowBox[{"a", ",", 
            RowBox[{"S", "[", "i", "]"}], ",", "b"}], "}"}], "]"}]}], "&&", 
        RowBox[{
         RowBox[{"Length", "[", 
          RowBox[{"{", "a", "}"}], "]"}], "\[Equal]", 
         RowBox[{"Length", "[", 
          RowBox[{"{", "b", "}"}], "]"}]}]}]}]}], ",", "\[IndentingNewLine]", 
     
     RowBox[{
      RowBox[{"dot", "[", 
       RowBox[{"a__", ",", 
        RowBox[{"F", "[", "i_", "]"}], ",", "b__"}], "]"}], "\[RuleDelayed]", 
      " ", 
      RowBox[{"0", "/;", 
       RowBox[{
        RowBox[{"{", 
         RowBox[{"a", ",", 
          RowBox[{"F", "[", "i", "]"}], ",", "b"}], "}"}], "==", 
        RowBox[{"Reverse", "[", 
         RowBox[{"{", 
          RowBox[{"a", ",", 
           RowBox[{"F", "[", "i", "]"}], ",", "b"}], "}"}], "]"}]}]}]}], ",", 
     "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"dot", "[", 
       RowBox[{"a_", ",", 
        RowBox[{"F", "[", "i_", "]"}], ",", "a_"}], "]"}], "\[RuleDelayed]", 
      " ", "0"}], ",", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"dot", "[", 
       RowBox[{"a_", ",", 
        RowBox[{"S", "[", "i_", "]"}], ",", "b_"}], "]"}], "\[RuleDelayed]", 
      " ", 
      RowBox[{
       RowBox[{"-", 
        RowBox[{"dot", "[", 
         RowBox[{"b", ",", 
          RowBox[{"S", "[", "i", "]"}], ",", "a"}], "]"}]}], "/;", 
       RowBox[{
        RowBox[{"Sort", "[", 
         RowBox[{"{", 
          RowBox[{"a", ",", "b"}], "}"}], "]"}], "\[NotEqual]", 
        RowBox[{"{", 
         RowBox[{"a", ",", "b"}], "}"}]}]}]}], ",", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"dot", "[", 
       RowBox[{"a_", ",", 
        RowBox[{"F", "[", "i_", "]"}], ",", "b_"}], "]"}], "\[RuleDelayed]", 
      " ", 
      RowBox[{
       RowBox[{"-", 
        RowBox[{"dot", "[", 
         RowBox[{"b", ",", 
          RowBox[{"F", "[", "i", "]"}], ",", "a"}], "]"}]}], "/;", 
       RowBox[{
        RowBox[{"Sort", "[", 
         RowBox[{"{", 
          RowBox[{"a", ",", "b"}], "}"}], "]"}], "\[NotEqual]", 
        RowBox[{"{", 
         RowBox[{"a", ",", "b"}], "}"}]}]}]}], ",", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"dot", "[", 
       RowBox[{
        RowBox[{"p", "[", "a_", "]"}], ",", 
        RowBox[{"F", "[", "a_", "]"}], ",", "b__"}], "]"}], "\[RuleDelayed]", 
      " ", "0"}], ",", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"dot", "[", 
       RowBox[{"b__", ",", 
        RowBox[{"F", "[", "a_", "]"}], ",", 
        RowBox[{"p", "[", "a_", "]"}]}], "]"}], "\[RuleDelayed]", " ", "0"}], 
     ",", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"dot", "[", 
       RowBox[{"a__", ",", 
        RowBox[{"S", "[", "i_", "]"}], ",", 
        RowBox[{"v", "[", "1", "]"}]}], "]"}], "\[RuleDelayed]", " ", "0"}], 
     ",", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"dot", "[", 
       RowBox[{
        RowBox[{"v", "[", "1", "]"}], ",", 
        RowBox[{"v", "[", "1", "]"}]}], "]"}], "\[RuleDelayed]", "1"}], ",", 
     RowBox[{
      RowBox[{"dot", "[", 
       RowBox[{
        RowBox[{"p", "[", "2", "]"}], ",", 
        RowBox[{"v", "[", "1", "]"}]}], "]"}], ":>", 
      RowBox[{"-", 
       RowBox[{"dot", "[", 
        RowBox[{
         RowBox[{"p", "[", "1", "]"}], ",", 
         RowBox[{"v", "[", "1", "]"}]}], "]"}]}]}], ",", 
     "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"dot", "[", 
       RowBox[{
        RowBox[{"v", "[", "1", "]"}], ",", 
        RowBox[{"S", "[", "i_", "]"}], ",", "a__"}], "]"}], "\[RuleDelayed]", 
      " ", "0"}], ",", 
     RowBox[{
      RowBox[{"dot", "[", 
       RowBox[{
        RowBox[{"p", "[", "i_", "]"}], ",", 
        RowBox[{"\[Epsilon]", "[", "i_", "]"}]}], "]"}], "\[RuleDelayed]", 
      "0"}], ",", 
     RowBox[{
      RowBox[{"dot", "[", 
       RowBox[{
        RowBox[{"p", "[", "i_", "]"}], ",", 
        RowBox[{"p", "[", "i_", "]"}]}], "]"}], "\[RuleDelayed]", " ", "0"}], 
     " ", ",", 
     RowBox[{
      RowBox[{"dot", "[", 
       RowBox[{
        RowBox[{"\[Epsilon]", "[", "i_", "]"}], ",", 
        RowBox[{"\[Epsilon]", "[", "i_", "]"}]}], "]"}], "\[RuleDelayed]", 
      " ", "0"}], ",", 
     RowBox[{
      RowBox[{"dot", "[", "a__", "]"}], "\[RuleDelayed]", 
      "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{
        RowBox[{
         RowBox[{"(", 
          RowBox[{"-", "1"}], ")"}], "^", 
         RowBox[{"Length", "[", 
          RowBox[{"{", "a", "}"}], "]"}]}], "*", 
        RowBox[{"dot", "@@", 
         RowBox[{"Reverse", "[", 
          RowBox[{"{", "a", "}"}], "]"}]}]}], "/;", 
       RowBox[{
        RowBox[{"OrderedQ", "[", 
         RowBox[{"{", 
          RowBox[{
           RowBox[{
            RowBox[{"{", "a", "}"}], "//", "Reverse"}], ",", 
           RowBox[{"{", "a", "}"}]}], "}"}], "]"}], "&&", 
        RowBox[{
         RowBox[{"{", "a", "}"}], "=!=", 
         RowBox[{"Reverse", "[", 
          RowBox[{"{", "a", "}"}], "]"}]}]}]}]}]}], "}"}]}], ";"}]], "Input",
 CellChangeTimes->{{3.87735352765903*^9, 3.877353575291686*^9}},
 CellLabel->
  "In[734]:=",ExpressionUUID->"26efa189-4ecc-4695-99da-a77c9b57d98f"],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"dot", "[", 
  RowBox[{
   RowBox[{"v", "[", "1", "]"}], ",", 
   RowBox[{"p", "[", "1", "]"}]}], "]"}]], "Input",
 CellChangeTimes->{{3.877353532272065*^9, 3.8773535456324997`*^9}},
 CellLabel->
  "In[732]:=",ExpressionUUID->"934c173a-881a-4ca9-a594-772bd9a53db2"],

Cell[BoxData[
 RowBox[{"dot", "[", 
  RowBox[{
   RowBox[{"p", "[", "1", "]"}], ",", 
   RowBox[{"v", "[", "1", "]"}]}], "]"}]], "Output",
 CellChangeTimes->{{3.877353537847221*^9, 3.8773535463460617`*^9}},
 CellLabel->
  "Out[732]=",ExpressionUUID->"62e23dab-ad2c-4ae7-9d63-9f08b967faf9"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{"spinOrder", "=", "6"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"factorNumber", "=", 
   RowBox[{"If", "[", 
    RowBox[{
     RowBox[{"EvenQ", "[", "spinOrder", "]"}], ",", 
     RowBox[{
      FractionBox["spinOrder", "2"], "+", "1"}], ",", 
     FractionBox[
      RowBox[{"spinOrder", "+", "1"}], "2"]}], "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"ptsets", "=", 
   RowBox[{"KSetPartitionsEmpty", "[", 
    RowBox[{
     RowBox[{"Join", "[", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{
         RowBox[{"F", "[", "1", "]"}], ",", 
         RowBox[{"F", "[", "2", "]"}]}], "}"}], ",", 
       RowBox[{"ConstantArray", "[", 
        RowBox[{
         RowBox[{"S", "[", "0", "]"}], ",", "spinOrder"}], "]"}]}], "]"}], 
     ",", "factorNumber"}], "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"allmonos", "=", 
   RowBox[{"DeleteCases", "[", 
    RowBox[{
     RowBox[{
      RowBox[{
       RowBox[{
        RowBox[{
         RowBox[{"(", 
          RowBox[{
           RowBox[{"(", 
            RowBox[{
             RowBox[{
              RowBox[{"monoAllF", "[", 
               RowBox[{"ptsets", ",", "#"}], "]"}], "&"}], "/@", 
             RowBox[{"BoundaryPatitionsAll", "[", 
              RowBox[{"spinOrder", ",", "p"}], "]"}]}], ")"}], "//", 
           "Flatten"}], ")"}], "//.", "dotRules"}], "/.", 
        RowBox[{
         RowBox[{"a_", " ", "b_"}], "\[RuleDelayed]", " ", 
         RowBox[{"b", "/;", 
          RowBox[{"NumericQ", "[", "a", "]"}]}]}]}], "//", "Flatten"}], "//", 
      "DeleteDuplicates"}], ",", "0"}], "]"}]}], ";"}]}], "Input",
 CellChangeTimes->{{3.876815015948833*^9, 3.8768150173932543`*^9}, 
   3.8768151168102303`*^9, {3.8768175708373127`*^9, 3.876817572179883*^9}, 
   3.877339177793495*^9, 3.877339811226066*^9, {3.87733995241728*^9, 
   3.877340019761073*^9}, {3.877342048060792*^9, 3.877342078079761*^9}, {
   3.877344943748859*^9, 3.877345012455653*^9}, {3.877350992255275*^9, 
   3.877351004682933*^9}, {3.877351107014407*^9, 3.877351107376464*^9}, {
   3.877351401782248*^9, 3.8773514073322077`*^9}, {3.877353618106813*^9, 
   3.877353618450787*^9}, {3.877353648789009*^9, 3.8773536494073*^9}},
 CellLabel->
  "In[745]:=",ExpressionUUID->"0c0afbee-c8a3-4d27-9003-78320cd4e1a9"],

Cell[BoxData["6"], "Output",
 CellChangeTimes->{
  3.877339811685151*^9, {3.8773399604902363`*^9, 3.8773400208568*^9}, {
   3.87734204850076*^9, 3.877342078441628*^9}, {3.87734493018111*^9, 
   3.877345012960857*^9}, {3.8773509934622498`*^9, 3.877351005077176*^9}, 
   3.877351107813017*^9, 3.8773534386294937`*^9, 3.877353579742831*^9, 
   3.877353618892025*^9, 3.877353649915333*^9},
 CellLabel->
  "Out[745]=",ExpressionUUID->"bdd5b96f-32f3-40c6-a79e-bd1cba03cdb1"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"allmonos", "//", "Length"}]], "Input",
 CellChangeTimes->{{3.877344951991025*^9, 3.877344953292449*^9}, {
  3.877350923559208*^9, 3.877350926183384*^9}, {3.877351007899534*^9, 
  3.877351022111714*^9}, {3.877351123571371*^9, 3.87735114641446*^9}, {
  3.877353481359683*^9, 3.877353482708317*^9}},
 CellLabel->
  "In[750]:=",ExpressionUUID->"17e02011-fbbf-4e66-acfa-aabc5f766a16"],

Cell[BoxData["2523"], "Output",
 CellChangeTimes->{{3.8773449361121187`*^9, 3.87734500976577*^9}, 
   3.877347808928945*^9, 3.8773509268634367`*^9, {3.877350996258048*^9, 
   3.87735102273267*^9}, {3.877351117780808*^9, 3.8773511471514893`*^9}, {
   3.877353454623451*^9, 3.877353483160887*^9}, 3.877353594050272*^9, 
   3.877353645598054*^9, 3.877355080929295*^9, 3.8773551781084547`*^9},
 CellLabel->
  "Out[750]=",ExpressionUUID->"8b9d67ff-893a-4b60-837f-41d634cd7138"]
}, Open  ]],

Cell[CellGroupData[{

Cell["Cut Conditions", "Subsection",
 CellChangeTimes->{{3.8769027423093023`*^9, 
  3.876902749470381*^9}},ExpressionUUID->"7653baa2-ef4d-42c2-af43-\
9880a084ec64"],

Cell[BoxData[{
 RowBox[{
  RowBox[{"CutP12S2", " ", "=", 
   RowBox[{
    RowBox[{
     RowBox[{"1", "/", "2"}], "*", 
     RowBox[{"dot", "[", 
      RowBox[{
       RowBox[{"\[Epsilon]", "[", "2", "]"}], ",", 
       RowBox[{"p", "[", "1", "]"}]}], "]"}], "*", 
     RowBox[{"dot", "[", 
      RowBox[{
       RowBox[{"v", "[", "1", "]"}], ",", 
       RowBox[{"\[Epsilon]", "[", "1", "]"}]}], "]"}], "*", 
     RowBox[{"dot", "[", 
      RowBox[{
       RowBox[{
        RowBox[{"p", "[", "1", "]"}], "+", 
        RowBox[{"p", "[", "2", "]"}]}], ",", 
       RowBox[{"S", "[", "0", "]"}], ",", 
       RowBox[{"S", "[", "0", "]"}], ",", 
       RowBox[{
        RowBox[{"p", "[", "1", "]"}], "+", 
        RowBox[{"p", "[", "2", "]"}]}]}], "]"}]}], "-", 
    RowBox[{
     RowBox[{"1", "/", "2"}], "*", 
     RowBox[{"dot", "[", 
      RowBox[{
       RowBox[{"\[Epsilon]", "[", "1", "]"}], ",", 
       RowBox[{"p", "[", "2", "]"}]}], "]"}], "*", 
     RowBox[{"dot", "[", 
      RowBox[{
       RowBox[{"v", "[", "1", "]"}], ",", 
       RowBox[{"\[Epsilon]", "[", "2", "]"}]}], "]"}], "*", 
     RowBox[{"dot", "[", 
      RowBox[{
       RowBox[{
        RowBox[{"p", "[", "1", "]"}], "+", 
        RowBox[{"p", "[", "2", "]"}]}], ",", 
       RowBox[{"S", "[", "0", "]"}], ",", 
       RowBox[{"S", "[", "0", "]"}], ",", 
       RowBox[{
        RowBox[{"p", "[", "1", "]"}], "+", 
        RowBox[{"p", "[", "2", "]"}]}]}], "]"}]}], "+", 
    RowBox[{
     RowBox[{"1", "/", "2"}], "*", 
     RowBox[{"dot", "[", 
      RowBox[{
       RowBox[{"\[Epsilon]", "[", "1", "]"}], ",", 
       RowBox[{"\[Epsilon]", "[", "2", "]"}]}], "]"}], "*", 
     RowBox[{"dot", "[", 
      RowBox[{
       RowBox[{"v", "[", "1", "]"}], ",", 
       RowBox[{"p", "[", "2", "]"}]}], "]"}], "*", 
     RowBox[{"dot", "[", 
      RowBox[{
       RowBox[{
        RowBox[{"p", "[", "1", "]"}], "+", 
        RowBox[{"p", "[", "2", "]"}]}], ",", 
       RowBox[{"S", "[", "0", "]"}], ",", 
       RowBox[{"S", "[", "0", "]"}], ",", 
       RowBox[{
        RowBox[{"p", "[", "1", "]"}], "+", 
        RowBox[{"p", "[", "2", "]"}]}]}], "]"}]}]}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"Cutv1S2", "=", 
   RowBox[{
    RowBox[{
     RowBox[{"1", "/", "2"}], "*", 
     RowBox[{"dot", "[", 
      RowBox[{
       RowBox[{"v", "[", "1", "]"}], ",", 
       RowBox[{"\[Epsilon]", "[", "1", "]"}]}], "]"}], "*", 
     RowBox[{"dot", " ", "[", 
      RowBox[{
       RowBox[{"v", "[", "1", "]"}], ",", 
       RowBox[{"\[Epsilon]", "[", "2", "]"}]}], "]"}], "*", 
     RowBox[{"dot", "[", 
      RowBox[{
       RowBox[{"p", "[", "1", "]"}], ",", 
       RowBox[{"S", "[", "0", "]"}], ",", 
       RowBox[{"S", "[", "0", "]"}], ",", 
       RowBox[{"p", "[", "1", "]"}]}], "]"}]}], "+", 
    RowBox[{
     RowBox[{"1", "/", "2"}], "*", 
     RowBox[{"dot", "[", 
      RowBox[{
       RowBox[{"v", "[", "1", "]"}], ",", 
       RowBox[{"\[Epsilon]", "[", "1", "]"}]}], "]"}], "*", 
     RowBox[{"dot", " ", "[", 
      RowBox[{
       RowBox[{"v", "[", "1", "]"}], ",", 
       RowBox[{"\[Epsilon]", "[", "2", "]"}]}], "]"}], "*", 
     RowBox[{"dot", "[", 
      RowBox[{
       RowBox[{"p", "[", "2", "]"}], ",", 
       RowBox[{"S", "[", "0", "]"}], ",", 
       RowBox[{"S", "[", "0", "]"}], ",", 
       RowBox[{"p", "[", "2", "]"}]}], "]"}]}], "+", 
    RowBox[{
     RowBox[{"dot", "[", 
      RowBox[{
       RowBox[{"p", "[", "1", "]"}], ",", 
       RowBox[{"S", "[", "0", "]"}], ",", 
       RowBox[{"\[Epsilon]", "[", "1", "]"}]}], "]"}], "*", 
     RowBox[{"dot", "[", 
      RowBox[{
       RowBox[{"p", "[", "2", "]"}], ",", 
       RowBox[{"S", "[", "0", "]"}], ",", 
       RowBox[{"\[Epsilon]", "[", "2", "]"}]}], "]"}]}]}]}], ";"}]}], "Input",\

 CellChangeTimes->{{3.8768040698450403`*^9, 3.8768040761221323`*^9}, {
   3.876804106269355*^9, 3.8768041140277667`*^9}, {3.876804163019229*^9, 
   3.876804168596278*^9}, {3.876804405765111*^9, 3.8768045759750576`*^9}, {
   3.876804637329895*^9, 3.876804681246437*^9}, {3.8768047125424643`*^9, 
   3.876804785880081*^9}, {3.8769109692131047`*^9, 3.8769109991028123`*^9}, {
   3.8769159358229876`*^9, 3.8769159537860312`*^9}, {3.876978027311041*^9, 
   3.8769780354316535`*^9}, 3.876978347983531*^9, {3.876978430484943*^9, 
   3.8769784328250437`*^9}, {3.876978608565335*^9, 3.876978625652506*^9}, {
   3.876983467945674*^9, 3.8769834822067485`*^9}, 3.8769840843834877`*^9, {
   3.876984682268609*^9, 3.8769846824581137`*^9}, 3.8770664453783617`*^9},
 CellLabel->
  "In[361]:=",ExpressionUUID->"7dd72b4c-0f96-4f4b-827f-86377f9880e9"],

Cell[BoxData[{
 RowBox[{
  RowBox[{"ConditionP12S2", "=", 
   RowBox[{
    RowBox[{
     RowBox[{
      RowBox[{"(", 
       RowBox[{
        RowBox[{"(", 
         RowBox[{
          RowBox[{"(", 
           RowBox[{"AnsatzS2", "\[Equal]", 
            RowBox[{"4", "*", 
             RowBox[{"dot", "[", 
              RowBox[{
               RowBox[{"v", "[", "1", "]"}], ",", 
               RowBox[{"p", "[", "1", "]"}]}], "]"}], "*", "CutP12S2"}]}], 
           ")"}], "//.", 
          RowBox[{"{", 
           RowBox[{
            RowBox[{"dot", "[", 
             RowBox[{"x__", ",", 
              RowBox[{"F", "[", "c_", "]"}], ",", "y__"}], "]"}], 
            "\[RuleDelayed]", 
            RowBox[{
             RowBox[{
              RowBox[{"dot", "[", 
               RowBox[{"x", ",", 
                RowBox[{"p", "[", "c", "]"}]}], "]"}], "*", 
              RowBox[{"dot", "[", 
               RowBox[{
                RowBox[{"\[Epsilon]", "[", "c", "]"}], ",", "y"}], "]"}]}], 
             "-", 
             RowBox[{
              RowBox[{"dot", "[", 
               RowBox[{"x", ",", 
                RowBox[{"\[Epsilon]", "[", "c", "]"}]}], "]"}], "*", 
              RowBox[{"dot", "[", 
               RowBox[{
                RowBox[{"p", "[", "c", "]"}], ",", "y"}], "]"}]}]}]}], 
           "}"}]}], ")"}], "//", "Expand"}], ")"}], "//.", 
      "LeviCivitaRules"}], "//.", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{
        RowBox[{"dot", "[", 
         RowBox[{
          RowBox[{"p", "[", "1", "]"}], ",", 
          RowBox[{"p", "[", "2", "]"}]}], "]"}], "\[RuleDelayed]", "0"}], ",", 
       RowBox[{
        RowBox[{"dot", "[", 
         RowBox[{
          RowBox[{"v", "[", "1", "]"}], ",", 
          RowBox[{"p", "[", "2", "]"}]}], "]"}], "\[RuleDelayed]", 
        RowBox[{"-", 
         RowBox[{"dot", "[", 
          RowBox[{
           RowBox[{"v", "[", "1", "]"}], ",", 
           RowBox[{"p", "[", "1", "]"}]}], "]"}]}]}]}], "}"}]}], "//.", 
    "dotRules"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"Conditionv1S2", "=", 
   RowBox[{
    RowBox[{
     RowBox[{
      RowBox[{"(", 
       RowBox[{
        RowBox[{"(", 
         RowBox[{
          RowBox[{"(", 
           RowBox[{"AnsatzS2", "\[Equal]", 
            RowBox[{"4", "*", 
             RowBox[{"dot", "[", 
              RowBox[{
               RowBox[{"p", "[", "1", "]"}], ",", 
               RowBox[{"p", "[", "2", "]"}]}], "]"}], "*", "Cutv1S2"}]}], 
           ")"}], "//.", 
          RowBox[{"{", 
           RowBox[{
            RowBox[{"dot", "[", 
             RowBox[{"x__", ",", 
              RowBox[{"F", "[", "c_", "]"}], ",", "y__"}], "]"}], 
            "\[RuleDelayed]", 
            RowBox[{
             RowBox[{
              RowBox[{"dot", "[", 
               RowBox[{"x", ",", 
                RowBox[{"p", "[", "c", "]"}]}], "]"}], "*", 
              RowBox[{"dot", "[", 
               RowBox[{
                RowBox[{"\[Epsilon]", "[", "c", "]"}], ",", "y"}], "]"}]}], 
             "-", 
             RowBox[{
              RowBox[{"dot", "[", 
               RowBox[{"x", ",", 
                RowBox[{"\[Epsilon]", "[", "c", "]"}]}], "]"}], "*", 
              RowBox[{"dot", "[", 
               RowBox[{
                RowBox[{"p", "[", "c", "]"}], ",", "y"}], "]"}]}]}]}], 
           "}"}]}], ")"}], "//", "Expand"}], ")"}], "//.", 
      "LeviCivitaRules"}], "//.", "dotRules"}], " ", "//.", 
    RowBox[{"{", 
     RowBox[{
      RowBox[{
       RowBox[{"dot", "[", 
        RowBox[{
         RowBox[{"v", "[", "1", "]"}], ",", 
         RowBox[{"p", "[", "1", "]"}]}], "]"}], "\[RuleDelayed]", "0"}], ",", 
      
      RowBox[{
       RowBox[{"dot", "[", 
        RowBox[{
         RowBox[{"v", "[", "1", "]"}], ",", 
         RowBox[{"p", "[", "2", "]"}]}], "]"}], "\[RuleDelayed]", "0"}]}], 
     "}"}]}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"SymmetryCond", "=", 
   RowBox[{"(", 
    RowBox[{
     RowBox[{
      RowBox[{
       RowBox[{"(", 
        RowBox[{
         RowBox[{"(", 
          RowBox[{
           RowBox[{"(", 
            RowBox[{"AnsatzS2", "\[Equal]", 
             RowBox[{"(", 
              RowBox[{"AnsatzS2", "/.", 
               RowBox[{"{", 
                RowBox[{
                 RowBox[{
                  RowBox[{"p", "[", "1", "]"}], "\[Rule]", 
                  RowBox[{"p", "[", "2", "]"}]}], ",", 
                 RowBox[{
                  RowBox[{"p", "[", "2", "]"}], "\[Rule]", 
                  RowBox[{"p", "[", "1", "]"}]}], ",", 
                 RowBox[{
                  RowBox[{"F", "[", "1", "]"}], "\[Rule]", 
                  RowBox[{"F", "[", "2", "]"}]}], ",", 
                 RowBox[{
                  RowBox[{"F", "[", "2", "]"}], "\[Rule]", 
                  RowBox[{"F", "[", "1", "]"}]}]}], "}"}]}], ")"}]}], ")"}], "//.", 
           RowBox[{
            RowBox[{"dot", "[", 
             RowBox[{"x__", ",", 
              RowBox[{"F", "[", "c_", "]"}], ",", "y__"}], "]"}], 
            "\[RuleDelayed]", 
            RowBox[{
             RowBox[{
              RowBox[{"dot", "[", 
               RowBox[{"x", ",", 
                RowBox[{"p", "[", "c", "]"}]}], "]"}], "*", 
              RowBox[{"dot", "[", 
               RowBox[{
                RowBox[{"\[Epsilon]", "[", "c", "]"}], ",", "y"}], "]"}]}], 
             "-", 
             RowBox[{
              RowBox[{"dot", "[", 
               RowBox[{"x", ",", 
                RowBox[{"\[Epsilon]", "[", "c", "]"}]}], "]"}], "*", 
              RowBox[{"dot", "[", 
               RowBox[{
                RowBox[{"p", "[", "c", "]"}], ",", "y"}], "]"}]}]}]}]}], 
          ")"}], "//", "Expand"}], ")"}], "//.", "LeviCivitaRules"}], "//.", 
      RowBox[{"{", 
       RowBox[{
        RowBox[{"dot", "[", 
         RowBox[{
          RowBox[{"v", "[", "1", "]"}], ",", 
          RowBox[{"p", "[", "2", "]"}]}], "]"}], "\[RuleDelayed]", " ", 
        RowBox[{"-", 
         RowBox[{"dot", "[", 
          RowBox[{
           RowBox[{"v", "[", "1", "]"}], ",", 
           RowBox[{"p", "[", "1", "]"}]}], "]"}]}]}], "}"}]}], "//.", 
     "dotRules"}], ")"}]}], ";"}]}], "Input",
 CellChangeTimes->{{3.876804807502169*^9, 3.876804854711794*^9}, {
   3.8768049043670673`*^9, 3.8768049914763055`*^9}, {3.8768050723352256`*^9, 
   3.876805098305267*^9}, {3.876809417474665*^9, 3.876809424566101*^9}, {
   3.876809477232671*^9, 3.876809487478401*^9}, 3.87690460783605*^9, {
   3.876904667620144*^9, 3.8769046984640236`*^9}, 3.8769048213347187`*^9, {
   3.87690540425039*^9, 3.8769054087673817`*^9}, {3.876905748635273*^9, 
   3.876905778926565*^9}, {3.8769062057271214`*^9, 3.8769062253885317`*^9}, {
   3.876906312926511*^9, 3.87690632122423*^9}, {3.8769064427458625`*^9, 
   3.876906452500059*^9}, {3.87690649157626*^9, 3.8769065441165667`*^9}, 
   3.8769110209126277`*^9, {3.8769159052194324`*^9, 3.8769159260071707`*^9}, 
   3.87691686167654*^9, 3.8769171800375423`*^9, 3.8769178149296103`*^9, 
   3.876918120148666*^9, {3.876978632516964*^9, 3.876978649714734*^9}, {
   3.876978725556406*^9, 3.8769787485920334`*^9}, {3.8769826331599717`*^9, 
   3.876982683661826*^9}, {3.8769827416454616`*^9, 3.876982763246413*^9}, 
   3.8769828086960497`*^9, {3.876982845868078*^9, 3.8769828679280877`*^9}, {
   3.876982909921335*^9, 3.87698296499682*^9}, {3.8769834411691666`*^9, 
   3.8769834488212414`*^9}, {3.8769835541576047`*^9, 
   3.8769835558188257`*^9}, {3.8769837815689597`*^9, 3.876983796368101*^9}, {
   3.8769838683170986`*^9, 3.8769839776576395`*^9}, 3.8769840478725276`*^9, {
   3.8769848338138123`*^9, 3.876984879790856*^9}, {3.8769857811727686`*^9, 
   3.8769858067764726`*^9}, {3.876985850439027*^9, 3.8769858532806244`*^9}, {
   3.876985922596111*^9, 3.8769859647826743`*^9}, {3.8769946277184453`*^9, 
   3.876994641008317*^9}, {3.876995103700568*^9, 3.8769951775286565`*^9}},
 CellLabel->
  "In[363]:=",ExpressionUUID->"6086c4e5-aa05-44e1-a7a4-74f80b955047"],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"vardot", "=", 
  RowBox[{
   RowBox[{"{", 
    RowBox[{"ConditionP12S2", ",", "Conditionv1S2", ",", "SymmetryCond"}], 
    "}"}], "//", "Casesdot"}]}]], "Input",
 CellChangeTimes->{{3.8769048304197536`*^9, 3.876904931089441*^9}, {
  3.876910909557077*^9, 3.876910924016588*^9}, {3.8769110340796533`*^9, 
  3.8769110387942677`*^9}, {3.876915766390431*^9, 3.87691588730823*^9}, {
  3.876917041384816*^9, 3.876917055358569*^9}, {3.876982519915988*^9, 
  3.876982521823923*^9}, {3.8769836921574264`*^9, 3.876983700726357*^9}, {
  3.8769840092838554`*^9, 3.8769840134518127`*^9}, {3.8769848950492716`*^9, 
  3.876984897020933*^9}, {3.876985956984082*^9, 3.876985960005811*^9}},
 CellLabel->
  "In[366]:=",ExpressionUUID->"7b79ccb2-8175-4ae7-a7a2-84049633a276"],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
   RowBox[{"dot", "[", 
    RowBox[{
     RowBox[{"as", "[", "1", "]"}], ",", 
     RowBox[{"as", "[", "1", "]"}]}], "]"}], ",", 
   RowBox[{"dot", "[", 
    RowBox[{
     RowBox[{"as", "[", "1", "]"}], ",", 
     RowBox[{"p", "[", "1", "]"}]}], "]"}], ",", 
   RowBox[{"dot", "[", 
    RowBox[{
     RowBox[{"as", "[", "1", "]"}], ",", 
     RowBox[{"p", "[", "2", "]"}]}], "]"}], ",", 
   RowBox[{"dot", "[", 
    RowBox[{
     RowBox[{"as", "[", "1", "]"}], ",", 
     RowBox[{"v", "[", "1", "]"}]}], "]"}], ",", 
   RowBox[{"dot", "[", 
    RowBox[{
     RowBox[{"as", "[", "1", "]"}], ",", 
     RowBox[{"\[Epsilon]", "[", "1", "]"}]}], "]"}], ",", 
   RowBox[{"dot", "[", 
    RowBox[{
     RowBox[{"as", "[", "1", "]"}], ",", 
     RowBox[{"\[Epsilon]", "[", "2", "]"}]}], "]"}], ",", 
   RowBox[{"dot", "[", 
    RowBox[{
     RowBox[{"p", "[", "1", "]"}], ",", 
     RowBox[{"p", "[", "2", "]"}]}], "]"}], ",", 
   RowBox[{"dot", "[", 
    RowBox[{
     RowBox[{"p", "[", "1", "]"}], ",", 
     RowBox[{"v", "[", "1", "]"}]}], "]"}], ",", 
   RowBox[{"dot", "[", 
    RowBox[{
     RowBox[{"p", "[", "1", "]"}], ",", 
     RowBox[{"\[Epsilon]", "[", "2", "]"}]}], "]"}], ",", 
   RowBox[{"dot", "[", 
    RowBox[{
     RowBox[{"p", "[", "2", "]"}], ",", 
     RowBox[{"\[Epsilon]", "[", "1", "]"}]}], "]"}], ",", 
   RowBox[{"dot", "[", 
    RowBox[{
     RowBox[{"v", "[", "1", "]"}], ",", 
     RowBox[{"\[Epsilon]", "[", "1", "]"}]}], "]"}], ",", 
   RowBox[{"dot", "[", 
    RowBox[{
     RowBox[{"v", "[", "1", "]"}], ",", 
     RowBox[{"\[Epsilon]", "[", "2", "]"}]}], "]"}], ",", 
   RowBox[{"dot", "[", 
    RowBox[{
     RowBox[{"\[Epsilon]", "[", "1", "]"}], ",", 
     RowBox[{"\[Epsilon]", "[", "2", "]"}]}], "]"}]}], "}"}]], "Output",
 CellChangeTimes->{
  3.8769048549945765`*^9, 3.876904897840748*^9, 3.876904935426617*^9, 
   3.8769054291540637`*^9, 3.876906339070698*^9, 3.876910925144638*^9, {
   3.876911025194374*^9, 3.8769110397897716`*^9}, 3.8769158516456833`*^9, 
   3.876915888702046*^9, 3.876915963346858*^9, 3.876917056515106*^9, 
   3.876917739671604*^9, 3.87697810326439*^9, 3.8769784390531425`*^9, 
   3.8769786558834705`*^9, 3.876982524155712*^9, {3.8769826658767214`*^9, 
   3.8769826908004503`*^9}, 3.876982771655628*^9, 3.876982873811972*^9, 
   3.8769829732028923`*^9, 3.8769835144932423`*^9, 3.876983653982383*^9, 
   3.876983701491048*^9, 3.8769838033534656`*^9, 3.8769840141648507`*^9, 
   3.8769840550792723`*^9, 3.8769846940732346`*^9, 3.8769848975439696`*^9, 
   3.876985628239991*^9, 3.8769857916923923`*^9, 3.876985856859297*^9, 
   3.8769859605731835`*^9, 3.8769939091783447`*^9, 3.876994646069225*^9, 
   3.876995181059688*^9, 3.8770077749684067`*^9, 3.877008042715305*^9, 
   3.877066542659774*^9},
 CellLabel->
  "Out[366]=",ExpressionUUID->"756c5133-59a0-4885-b1c0-0c85b3f9f863"]
}, Open  ]],

Cell[BoxData[
 RowBox[{"dot2num", ":=", 
  RowBox[{"Table", "[", 
   RowBox[{
    RowBox[{"Rule", "[", 
     RowBox[{
      RowBox[{"vardot", "[", 
       RowBox[{"[", "ii", "]"}], "]"}], ",", 
      RowBox[{"RandomInteger", "[", 
       RowBox[{"{", 
        RowBox[{"10", ",", "100"}], "}"}], "]"}]}], "]"}], ",", 
    RowBox[{"{", 
     RowBox[{"ii", ",", 
      RowBox[{"Length", "[", "vardot", "]"}]}], "}"}]}], "]"}]}]], "Input",
 CellChangeTimes->{{3.8769049503980417`*^9, 3.876904969008238*^9}, {
  3.8769050305446887`*^9, 3.87690508374227*^9}, {3.876905113814046*^9, 
  3.876905213992666*^9}},
 CellLabel->
  "In[367]:=",ExpressionUUID->"de57da47-77fb-4849-9458-e61712f47480"],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{
  RowBox[{"eq", "=", 
   RowBox[{"Flatten", "[", 
    RowBox[{"Table", "[", 
     RowBox[{
      RowBox[{
       RowBox[{"{", 
        RowBox[{"ConditionP12S2", ",", "Conditionv1S2", ",", "SymmetryCond"}],
         "}"}], "/.", "dot2num"}], ",", "100"}], "]"}], "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"finalSol", "=", 
   RowBox[{"Solve", "[", 
    RowBox[{"eq", ",", 
     RowBox[{"c", "/@", 
      RowBox[{"Range", "[", 
       RowBox[{"Length", "[", "monos", "]"}], "]"}]}]}], "]"}]}], 
  ";"}]}], "Input",
 CellChangeTimes->{{3.8769055068820367`*^9, 3.876905583185097*^9}, {
   3.876906396301323*^9, 3.8769064100444016`*^9}, {3.876911353345582*^9, 
   3.876911377768335*^9}, {3.876911416827297*^9, 3.8769114420941296`*^9}, {
   3.876911496711166*^9, 3.876911498942684*^9}, {3.8769159860434237`*^9, 
   3.8769159982850227`*^9}, {3.876917074032778*^9, 3.876917078747828*^9}, {
   3.876917835165763*^9, 3.876917836508628*^9}, {3.8769178893148384`*^9, 
   3.87691789538586*^9}, {3.8769179679615984`*^9, 3.8769179725550594`*^9}, {
   3.876918311991231*^9, 3.876918317019087*^9}, {3.87697818577396*^9, 
   3.8769782162071357`*^9}, {3.8769784471138887`*^9, 3.876978457901613*^9}, {
   3.8769787186870823`*^9, 3.876978719140839*^9}, {3.8769793903340096`*^9, 
   3.8769794007680445`*^9}, {3.876982104314427*^9, 3.87698212934171*^9}, {
   3.876982170856949*^9, 3.876982199966533*^9}, {3.8769823039135103`*^9, 
   3.87698230615662*^9}, {3.8769824247046385`*^9, 3.8769824277792864`*^9}, {
   3.876982793124356*^9, 3.8769827983296027`*^9}, {3.87698366299763*^9, 
   3.876983663424498*^9}, {3.8769847959404755`*^9, 3.8769848044024763`*^9}, 
   3.876985209881996*^9, {3.8769852426846485`*^9, 3.8769852490019865`*^9}, {
   3.8769854301693897`*^9, 3.8769854314214716`*^9}, {3.8769854724109297`*^9, 
   3.8769854885020056`*^9}, {3.8769856379317536`*^9, 3.876985644692341*^9}, {
   3.8769856838663783`*^9, 3.8769857033196225`*^9}, {3.876985880626607*^9, 
   3.876985919016066*^9}, {3.876985980340562*^9, 3.876985981403965*^9}, {
   3.8769860425644207`*^9, 3.8769860428726206`*^9}, {3.8770080648449564`*^9, 
   3.877008097014259*^9}},
 CellLabel->
  "In[368]:=",ExpressionUUID->"0c3df74f-542b-4666-91f6-0a140402b5a1"],

Cell[BoxData[
 TemplateBox[{
  "Solve", "svars", 
   "\"Equations may not give solutions for all \\\"solve\\\" variables.\"", 2,
    369, 11, 28403305668340845559, "Local"},
  "MessageTemplate"]], "Message", "MSG",
 CellChangeTimes->{3.8770665434135323`*^9},
 CellLabel->
  "During evaluation of \
In[368]:=",ExpressionUUID->"96716248-0655-40b1-9d45-93bd53e02b69"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"AnsatzS2", "/.", 
  RowBox[{"{", "finalSol", "}"}]}]], "Input",
 CellChangeTimes->{{3.8770081151079397`*^9, 3.877008122593895*^9}},
 CellLabel->
  "In[370]:=",ExpressionUUID->"4b09d98b-4a70-40aa-ace2-592a248afd2d"],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{"{", 
   RowBox[{
    RowBox[{
     RowBox[{"c", "[", "20", "]"}], " ", 
     RowBox[{"dot", "[", 
      RowBox[{
       RowBox[{"p", "[", "1", "]"}], ",", 
       RowBox[{"S", "[", "0", "]"}], ",", 
       RowBox[{"F", "[", "1", "]"}], ",", 
       RowBox[{"v", "[", "1", "]"}]}], "]"}], " ", 
     RowBox[{"dot", "[", 
      RowBox[{
       RowBox[{"p", "[", "1", "]"}], ",", 
       RowBox[{"S", "[", "0", "]"}], ",", 
       RowBox[{"F", "[", "2", "]"}], ",", 
       RowBox[{"v", "[", "1", "]"}]}], "]"}]}], "+", 
    RowBox[{
     RowBox[{"(", 
      RowBox[{
       RowBox[{"-", 
        RowBox[{"c", "[", "2", "]"}]}], "-", 
       RowBox[{"c", "[", "8", "]"}]}], ")"}], " ", 
     RowBox[{"dot", "[", 
      RowBox[{
       RowBox[{"p", "[", "1", "]"}], ",", 
       RowBox[{"S", "[", "0", "]"}], ",", 
       RowBox[{"F", "[", "2", "]"}], ",", 
       RowBox[{"v", "[", "1", "]"}]}], "]"}], " ", 
     RowBox[{"dot", "[", 
      RowBox[{
       RowBox[{"p", "[", "2", "]"}], ",", 
       RowBox[{"S", "[", "0", "]"}], ",", 
       RowBox[{"F", "[", "1", "]"}], ",", 
       RowBox[{"v", "[", "1", "]"}]}], "]"}]}], "+", 
    RowBox[{
     RowBox[{"c", "[", "26", "]"}], " ", 
     RowBox[{"dot", "[", 
      RowBox[{
       RowBox[{"p", "[", "1", "]"}], ",", 
       RowBox[{"S", "[", "0", "]"}], ",", 
       RowBox[{"F", "[", "1", "]"}], ",", 
       RowBox[{"v", "[", "1", "]"}]}], "]"}], " ", 
     RowBox[{"dot", "[", 
      RowBox[{
       RowBox[{"p", "[", "2", "]"}], ",", 
       RowBox[{"S", "[", "0", "]"}], ",", 
       RowBox[{"F", "[", "2", "]"}], ",", 
       RowBox[{"v", "[", "1", "]"}]}], "]"}]}], "+", 
    RowBox[{
     RowBox[{"c", "[", "33", "]"}], " ", 
     RowBox[{"dot", "[", 
      RowBox[{
       RowBox[{"p", "[", "2", "]"}], ",", 
       RowBox[{"S", "[", "0", "]"}], ",", 
       RowBox[{"F", "[", "1", "]"}], ",", 
       RowBox[{"v", "[", "1", "]"}]}], "]"}], " ", 
     RowBox[{"dot", "[", 
      RowBox[{
       RowBox[{"p", "[", "2", "]"}], ",", 
       RowBox[{"S", "[", "0", "]"}], ",", 
       RowBox[{"F", "[", "2", "]"}], ",", 
       RowBox[{"v", "[", "1", "]"}]}], "]"}]}], "+", 
    RowBox[{
     RowBox[{"c", "[", "4", "]"}], " ", 
     RowBox[{"dot", "[", 
      RowBox[{
       RowBox[{"p", "[", "1", "]"}], ",", 
       RowBox[{"S", "[", "0", "]"}], ",", 
       RowBox[{"S", "[", "0", "]"}], ",", 
       RowBox[{"p", "[", "1", "]"}]}], "]"}], " ", 
     RowBox[{"dot", "[", 
      RowBox[{
       RowBox[{"v", "[", "1", "]"}], ",", 
       RowBox[{"F", "[", "1", "]"}], ",", 
       RowBox[{"F", "[", "2", "]"}], ",", 
       RowBox[{"v", "[", "1", "]"}]}], "]"}]}], "+", 
    RowBox[{
     RowBox[{"c", "[", "1", "]"}], " ", 
     RowBox[{"dot", "[", 
      RowBox[{
       RowBox[{"p", "[", "1", "]"}], ",", 
       RowBox[{"S", "[", "0", "]"}], ",", 
       RowBox[{"S", "[", "0", "]"}], ",", 
       RowBox[{"p", "[", "2", "]"}]}], "]"}], " ", 
     RowBox[{"dot", "[", 
      RowBox[{
       RowBox[{"v", "[", "1", "]"}], ",", 
       RowBox[{"F", "[", "1", "]"}], ",", 
       RowBox[{"F", "[", "2", "]"}], ",", 
       RowBox[{"v", "[", "1", "]"}]}], "]"}]}], "+", 
    RowBox[{
     RowBox[{"c", "[", "5", "]"}], " ", 
     RowBox[{"dot", "[", 
      RowBox[{
       RowBox[{"p", "[", "2", "]"}], ",", 
       RowBox[{"S", "[", "0", "]"}], ",", 
       RowBox[{"S", "[", "0", "]"}], ",", 
       RowBox[{"p", "[", "2", "]"}]}], "]"}], " ", 
     RowBox[{"dot", "[", 
      RowBox[{
       RowBox[{"v", "[", "1", "]"}], ",", 
       RowBox[{"F", "[", "1", "]"}], ",", 
       RowBox[{"F", "[", "2", "]"}], ",", 
       RowBox[{"v", "[", "1", "]"}]}], "]"}]}], "+", 
    RowBox[{
     RowBox[{"(", 
      RowBox[{"2", "+", 
       RowBox[{"c", "[", "4", "]"}], "+", 
       RowBox[{"c", "[", "13", "]"}]}], ")"}], " ", 
     RowBox[{"dot", "[", 
      RowBox[{
       RowBox[{"p", "[", "1", "]"}], ",", 
       RowBox[{"F", "[", "2", "]"}], ",", 
       RowBox[{"v", "[", "1", "]"}]}], "]"}], " ", 
     RowBox[{"dot", "[", 
      RowBox[{
       RowBox[{"p", "[", "1", "]"}], ",", 
       RowBox[{"S", "[", "0", "]"}], ",", 
       RowBox[{"S", "[", "0", "]"}], ",", 
       RowBox[{"F", "[", "1", "]"}], ",", 
       RowBox[{"v", "[", "1", "]"}]}], "]"}]}], "+", 
    RowBox[{
     RowBox[{"(", 
      RowBox[{
       RowBox[{"-", "4"}], "+", 
       RowBox[{"c", "[", "3", "]"}], "+", 
       RowBox[{"c", "[", "8", "]"}], "-", 
       RowBox[{"c", "[", "13", "]"}], "+", 
       RowBox[{"c", "[", "21", "]"}], "-", 
       RowBox[{"c", "[", "23", "]"}], "-", 
       RowBox[{"c", "[", "27", "]"}], "+", 
       RowBox[{"c", "[", "29", "]"}]}], ")"}], " ", 
     RowBox[{"dot", "[", 
      RowBox[{
       RowBox[{"p", "[", "2", "]"}], ",", 
       RowBox[{"F", "[", "1", "]"}], ",", 
       RowBox[{"v", "[", "1", "]"}]}], "]"}], " ", 
     RowBox[{"dot", "[", 
      RowBox[{
       RowBox[{"p", "[", "1", "]"}], ",", 
       RowBox[{"S", "[", "0", "]"}], ",", 
       RowBox[{"S", "[", "0", "]"}], ",", 
       RowBox[{"F", "[", "2", "]"}], ",", 
       RowBox[{"v", "[", "1", "]"}]}], "]"}]}], "+", 
    RowBox[{
     RowBox[{"(", 
      RowBox[{"4", "+", 
       RowBox[{"c", "[", "1", "]"}], "-", 
       RowBox[{"2", " ", 
        RowBox[{"c", "[", "8", "]"}]}], "+", 
       RowBox[{"c", "[", "13", "]"}], "-", 
       RowBox[{"c", "[", "21", "]"}], "+", 
       RowBox[{"c", "[", "23", "]"}], "+", 
       RowBox[{"c", "[", "27", "]"}], "-", 
       RowBox[{"c", "[", "29", "]"}]}], ")"}], " ", 
     RowBox[{"dot", "[", 
      RowBox[{
       RowBox[{"p", "[", "1", "]"}], ",", 
       RowBox[{"F", "[", "2", "]"}], ",", 
       RowBox[{"v", "[", "1", "]"}]}], "]"}], " ", 
     RowBox[{"dot", "[", 
      RowBox[{
       RowBox[{"p", "[", "2", "]"}], ",", 
       RowBox[{"S", "[", "0", "]"}], ",", 
       RowBox[{"S", "[", "0", "]"}], ",", 
       RowBox[{"F", "[", "1", "]"}], ",", 
       RowBox[{"v", "[", "1", "]"}]}], "]"}]}], "+", 
    RowBox[{
     RowBox[{"(", 
      RowBox[{"2", "+", 
       RowBox[{"c", "[", "5", "]"}], "+", 
       RowBox[{"c", "[", "16", "]"}]}], ")"}], " ", 
     RowBox[{"dot", "[", 
      RowBox[{
       RowBox[{"p", "[", "2", "]"}], ",", 
       RowBox[{"F", "[", "1", "]"}], ",", 
       RowBox[{"v", "[", "1", "]"}]}], "]"}], " ", 
     RowBox[{"dot", "[", 
      RowBox[{
       RowBox[{"p", "[", "2", "]"}], ",", 
       RowBox[{"S", "[", "0", "]"}], ",", 
       RowBox[{"S", "[", "0", "]"}], ",", 
       RowBox[{"F", "[", "2", "]"}], ",", 
       RowBox[{"v", "[", "1", "]"}]}], "]"}]}], "+", 
    RowBox[{
     RowBox[{"c", "[", "2", "]"}], " ", 
     RowBox[{"dot", "[", 
      RowBox[{
       RowBox[{"p", "[", "1", "]"}], ",", 
       RowBox[{"S", "[", "0", "]"}], ",", 
       RowBox[{"p", "[", "2", "]"}]}], "]"}], " ", 
     RowBox[{"dot", "[", 
      RowBox[{
       RowBox[{"v", "[", "1", "]"}], ",", 
       RowBox[{"F", "[", "1", "]"}], ",", 
       RowBox[{"S", "[", "0", "]"}], ",", 
       RowBox[{"F", "[", "2", "]"}], ",", 
       RowBox[{"v", "[", "1", "]"}]}], "]"}]}], "+", 
    RowBox[{
     RowBox[{"c", "[", "13", "]"}], " ", 
     RowBox[{"dot", "[", 
      RowBox[{
       RowBox[{"p", "[", "1", "]"}], ",", 
       RowBox[{"F", "[", "2", "]"}], ",", 
       RowBox[{"F", "[", "1", "]"}], ",", 
       RowBox[{"S", "[", "0", "]"}], ",", 
       RowBox[{"S", "[", "0", "]"}], ",", 
       RowBox[{"p", "[", "1", "]"}]}], "]"}]}], "+", 
    RowBox[{
     RowBox[{"c", "[", "6", "]"}], " ", 
     RowBox[{"dot", "[", 
      RowBox[{
       RowBox[{"p", "[", "1", "]"}], ",", 
       RowBox[{"F", "[", "2", "]"}], ",", 
       RowBox[{"F", "[", "1", "]"}], ",", 
       RowBox[{"S", "[", "0", "]"}], ",", 
       RowBox[{"S", "[", "0", "]"}], ",", 
       RowBox[{"p", "[", "2", "]"}]}], "]"}]}], "+", 
    RowBox[{
     RowBox[{"c", "[", "14", "]"}], " ", 
     RowBox[{"dot", "[", 
      RowBox[{
       RowBox[{"p", "[", "1", "]"}], ",", 
       RowBox[{"F", "[", "2", "]"}], ",", 
       RowBox[{"S", "[", "0", "]"}], ",", 
       RowBox[{"F", "[", "1", "]"}], ",", 
       RowBox[{"S", "[", "0", "]"}], ",", 
       RowBox[{"p", "[", "1", "]"}]}], "]"}]}], "+", 
    RowBox[{
     RowBox[{"c", "[", "7", "]"}], " ", 
     RowBox[{"dot", "[", 
      RowBox[{
       RowBox[{"p", "[", "1", "]"}], ",", 
       RowBox[{"F", "[", "2", "]"}], ",", 
       RowBox[{"S", "[", "0", "]"}], ",", 
       RowBox[{"F", "[", "1", "]"}], ",", 
       RowBox[{"S", "[", "0", "]"}], ",", 
       RowBox[{"p", "[", "2", "]"}]}], "]"}]}], "+", 
    RowBox[{
     RowBox[{"c", "[", "8", "]"}], " ", 
     RowBox[{"dot", "[", 
      RowBox[{
       RowBox[{"p", "[", "1", "]"}], ",", 
       RowBox[{"F", "[", "2", "]"}], ",", 
       RowBox[{"S", "[", "0", "]"}], ",", 
       RowBox[{"S", "[", "0", "]"}], ",", 
       RowBox[{"F", "[", "1", "]"}], ",", 
       RowBox[{"p", "[", "2", "]"}]}], "]"}]}], "+", 
    RowBox[{
     RowBox[{"c", "[", "23", "]"}], " ", 
     RowBox[{"dot", "[", 
      RowBox[{
       RowBox[{"p", "[", "1", "]"}], ",", 
       RowBox[{"v", "[", "1", "]"}]}], "]"}], " ", 
     RowBox[{"dot", "[", 
      RowBox[{
       RowBox[{"p", "[", "1", "]"}], ",", 
       RowBox[{"F", "[", "2", "]"}], ",", 
       RowBox[{"S", "[", "0", "]"}], ",", 
       RowBox[{"S", "[", "0", "]"}], ",", 
       RowBox[{"F", "[", "1", "]"}], ",", 
       RowBox[{"v", "[", "1", "]"}]}], "]"}]}], "+", 
    RowBox[{
     RowBox[{"c", "[", "29", "]"}], " ", 
     RowBox[{"dot", "[", 
      RowBox[{
       RowBox[{"p", "[", "2", "]"}], ",", 
       RowBox[{"v", "[", "1", "]"}]}], "]"}], " ", 
     RowBox[{"dot", "[", 
      RowBox[{
       RowBox[{"p", "[", "1", "]"}], ",", 
       RowBox[{"F", "[", "2", "]"}], ",", 
       RowBox[{"S", "[", "0", "]"}], ",", 
       RowBox[{"S", "[", "0", "]"}], ",", 
       RowBox[{"F", "[", "1", "]"}], ",", 
       RowBox[{"v", "[", "1", "]"}]}], "]"}]}], "+", 
    RowBox[{
     RowBox[{"(", 
      RowBox[{
       RowBox[{"-", 
        RowBox[{"c", "[", "13", "]"}]}], "-", 
       RowBox[{"c", "[", "14", "]"}]}], ")"}], " ", 
     RowBox[{"dot", "[", 
      RowBox[{
       RowBox[{"p", "[", "1", "]"}], ",", 
       RowBox[{"S", "[", "0", "]"}], ",", 
       RowBox[{"F", "[", "1", "]"}], ",", 
       RowBox[{"F", "[", "2", "]"}], ",", 
       RowBox[{"S", "[", "0", "]"}], ",", 
       RowBox[{"p", "[", "1", "]"}]}], "]"}]}], "+", 
    RowBox[{
     RowBox[{"c", "[", "9", "]"}], " ", 
     RowBox[{"dot", "[", 
      RowBox[{
       RowBox[{"p", "[", "1", "]"}], ",", 
       RowBox[{"S", "[", "0", "]"}], ",", 
       RowBox[{"F", "[", "1", "]"}], ",", 
       RowBox[{"F", "[", "2", "]"}], ",", 
       RowBox[{"S", "[", "0", "]"}], ",", 
       RowBox[{"p", "[", "2", "]"}]}], "]"}]}], "+", 
    RowBox[{
     RowBox[{"c", "[", "25", "]"}], " ", 
     RowBox[{"dot", "[", 
      RowBox[{
       RowBox[{"p", "[", "1", "]"}], ",", 
       RowBox[{"v", "[", "1", "]"}]}], "]"}], " ", 
     RowBox[{"dot", "[", 
      RowBox[{
       RowBox[{"p", "[", "1", "]"}], ",", 
       RowBox[{"S", "[", "0", "]"}], ",", 
       RowBox[{"F", "[", "1", "]"}], ",", 
       RowBox[{"S", "[", "0", "]"}], ",", 
       RowBox[{"F", "[", "2", "]"}], ",", 
       RowBox[{"v", "[", "1", "]"}]}], "]"}]}], "+", 
    RowBox[{
     RowBox[{"(", 
      RowBox[{"2", "+", 
       RowBox[{"c", "[", "4", "]"}], "-", 
       RowBox[{"c", "[", "8", "]"}], "+", 
       RowBox[{"c", "[", "20", "]"}], "+", 
       RowBox[{"c", "[", "24", "]"}], "+", 
       RowBox[{"c", "[", "25", "]"}], "-", 
       RowBox[{"c", "[", "30", "]"}]}], ")"}], " ", 
     RowBox[{"dot", "[", 
      RowBox[{
       RowBox[{"p", "[", "2", "]"}], ",", 
       RowBox[{"v", "[", "1", "]"}]}], "]"}], " ", 
     RowBox[{"dot", "[", 
      RowBox[{
       RowBox[{"p", "[", "1", "]"}], ",", 
       RowBox[{"S", "[", "0", "]"}], ",", 
       RowBox[{"F", "[", "1", "]"}], ",", 
       RowBox[{"S", "[", "0", "]"}], ",", 
       RowBox[{"F", "[", "2", "]"}], ",", 
       RowBox[{"v", "[", "1", "]"}]}], "]"}]}], "+", 
    RowBox[{
     RowBox[{"c", "[", "8", "]"}], " ", 
     RowBox[{"dot", "[", 
      RowBox[{
       RowBox[{"p", "[", "1", "]"}], ",", 
       RowBox[{"S", "[", "0", "]"}], ",", 
       RowBox[{"F", "[", "2", "]"}], ",", 
       RowBox[{"F", "[", "1", "]"}], ",", 
       RowBox[{"S", "[", "0", "]"}], ",", 
       RowBox[{"p", "[", "2", "]"}]}], "]"}]}], "+", 
    RowBox[{
     RowBox[{"(", 
      RowBox[{"4", "-", 
       RowBox[{"c", "[", "7", "]"}], "-", 
       RowBox[{"2", " ", 
        RowBox[{"c", "[", "8", "]"}]}], "-", 
       RowBox[{"c", "[", "9", "]"}]}], ")"}], " ", 
     RowBox[{"dot", "[", 
      RowBox[{
       RowBox[{"p", "[", "1", "]"}], ",", 
       RowBox[{"S", "[", "0", "]"}], ",", 
       RowBox[{"F", "[", "2", "]"}], ",", 
       RowBox[{"S", "[", "0", "]"}], ",", 
       RowBox[{"F", "[", "1", "]"}], ",", 
       RowBox[{"p", "[", "2", "]"}]}], "]"}]}], "+", 
    RowBox[{
     RowBox[{"c", "[", "22", "]"}], " ", 
     RowBox[{"dot", "[", 
      RowBox[{
       RowBox[{"p", "[", "1", "]"}], ",", 
       RowBox[{"v", "[", "1", "]"}]}], "]"}], " ", 
     RowBox[{"dot", "[", 
      RowBox[{
       RowBox[{"p", "[", "1", "]"}], ",", 
       RowBox[{"S", "[", "0", "]"}], ",", 
       RowBox[{"F", "[", "2", "]"}], ",", 
       RowBox[{"S", "[", "0", "]"}], ",", 
       RowBox[{"F", "[", "1", "]"}], ",", 
       RowBox[{"v", "[", "1", "]"}]}], "]"}]}], "+", 
    RowBox[{
     RowBox[{"c", "[", "28", "]"}], " ", 
     RowBox[{"dot", "[", 
      RowBox[{
       RowBox[{"p", "[", "2", "]"}], ",", 
       RowBox[{"v", "[", "1", "]"}]}], "]"}], " ", 
     RowBox[{"dot", "[", 
      RowBox[{
       RowBox[{"p", "[", "1", "]"}], ",", 
       RowBox[{"S", "[", "0", "]"}], ",", 
       RowBox[{"F", "[", "2", "]"}], ",", 
       RowBox[{"S", "[", "0", "]"}], ",", 
       RowBox[{"F", "[", "1", "]"}], ",", 
       RowBox[{"v", "[", "1", "]"}]}], "]"}]}], "+", 
    RowBox[{
     RowBox[{"c", "[", "24", "]"}], " ", 
     RowBox[{"dot", "[", 
      RowBox[{
       RowBox[{"p", "[", "1", "]"}], ",", 
       RowBox[{"v", "[", "1", "]"}]}], "]"}], " ", 
     RowBox[{"dot", "[", 
      RowBox[{
       RowBox[{"p", "[", "1", "]"}], ",", 
       RowBox[{"S", "[", "0", "]"}], ",", 
       RowBox[{"S", "[", "0", "]"}], ",", 
       RowBox[{"F", "[", "1", "]"}], ",", 
       RowBox[{"F", "[", "2", "]"}], ",", 
       RowBox[{"v", "[", "1", "]"}]}], "]"}]}], "+", 
    RowBox[{
     RowBox[{"c", "[", "30", "]"}], " ", 
     RowBox[{"dot", "[", 
      RowBox[{
       RowBox[{"p", "[", "2", "]"}], ",", 
       RowBox[{"v", "[", "1", "]"}]}], "]"}], " ", 
     RowBox[{"dot", "[", 
      RowBox[{
       RowBox[{"p", "[", "1", "]"}], ",", 
       RowBox[{"S", "[", "0", "]"}], ",", 
       RowBox[{"S", "[", "0", "]"}], ",", 
       RowBox[{"F", "[", "1", "]"}], ",", 
       RowBox[{"F", "[", "2", "]"}], ",", 
       RowBox[{"v", "[", "1", "]"}]}], "]"}]}], "+", 
    RowBox[{
     RowBox[{"(", 
      RowBox[{
       RowBox[{"-", 
        RowBox[{"c", "[", "6", "]"}]}], "-", 
       RowBox[{"c", "[", "8", "]"}]}], ")"}], " ", 
     RowBox[{"dot", "[", 
      RowBox[{
       RowBox[{"p", "[", "1", "]"}], ",", 
       RowBox[{"S", "[", "0", "]"}], ",", 
       RowBox[{"S", "[", "0", "]"}], ",", 
       RowBox[{"F", "[", "2", "]"}], ",", 
       RowBox[{"F", "[", "1", "]"}], ",", 
       RowBox[{"p", "[", "2", "]"}]}], "]"}]}], "+", 
    RowBox[{
     RowBox[{"c", "[", "21", "]"}], " ", 
     RowBox[{"dot", "[", 
      RowBox[{
       RowBox[{"p", "[", "1", "]"}], ",", 
       RowBox[{"v", "[", "1", "]"}]}], "]"}], " ", 
     RowBox[{"dot", "[", 
      RowBox[{
       RowBox[{"p", "[", "1", "]"}], ",", 
       RowBox[{"S", "[", "0", "]"}], ",", 
       RowBox[{"S", "[", "0", "]"}], ",", 
       RowBox[{"F", "[", "2", "]"}], ",", 
       RowBox[{"F", "[", "1", "]"}], ",", 
       RowBox[{"v", "[", "1", "]"}]}], "]"}]}], "+", 
    RowBox[{
     RowBox[{"c", "[", "27", "]"}], " ", 
     RowBox[{"dot", "[", 
      RowBox[{
       RowBox[{"p", "[", "2", "]"}], ",", 
       RowBox[{"v", "[", "1", "]"}]}], "]"}], " ", 
     RowBox[{"dot", "[", 
      RowBox[{
       RowBox[{"p", "[", "1", "]"}], ",", 
       RowBox[{"S", "[", "0", "]"}], ",", 
       RowBox[{"S", "[", "0", "]"}], ",", 
       RowBox[{"F", "[", "2", "]"}], ",", 
       RowBox[{"F", "[", "1", "]"}], ",", 
       RowBox[{"v", "[", "1", "]"}]}], "]"}]}], "+", 
    RowBox[{
     RowBox[{"c", "[", "16", "]"}], " ", 
     RowBox[{"dot", "[", 
      RowBox[{
       RowBox[{"p", "[", "2", "]"}], ",", 
       RowBox[{"F", "[", "1", "]"}], ",", 
       RowBox[{"F", "[", "2", "]"}], ",", 
       RowBox[{"S", "[", "0", "]"}], ",", 
       RowBox[{"S", "[", "0", "]"}], ",", 
       RowBox[{"p", "[", "2", "]"}]}], "]"}]}], "+", 
    RowBox[{
     RowBox[{"c", "[", "17", "]"}], " ", 
     RowBox[{"dot", "[", 
      RowBox[{
       RowBox[{"p", "[", "2", "]"}], ",", 
       RowBox[{"F", "[", "1", "]"}], ",", 
       RowBox[{"S", "[", "0", "]"}], ",", 
       RowBox[{"F", "[", "2", "]"}], ",", 
       RowBox[{"S", "[", "0", "]"}], ",", 
       RowBox[{"p", "[", "2", "]"}]}], "]"}]}], "+", 
    RowBox[{
     RowBox[{"(", 
      RowBox[{"4", "-", 
       RowBox[{"c", "[", "3", "]"}], "-", 
       RowBox[{"2", " ", 
        RowBox[{"c", "[", "8", "]"}]}], "+", 
       RowBox[{"c", "[", "23", "]"}], "-", 
       RowBox[{"c", "[", "29", "]"}], "+", 
       RowBox[{"c", "[", "38", "]"}]}], ")"}], " ", 
     RowBox[{"dot", "[", 
      RowBox[{
       RowBox[{"p", "[", "1", "]"}], ",", 
       RowBox[{"v", "[", "1", "]"}]}], "]"}], " ", 
     RowBox[{"dot", "[", 
      RowBox[{
       RowBox[{"p", "[", "2", "]"}], ",", 
       RowBox[{"F", "[", "1", "]"}], ",", 
       RowBox[{"S", "[", "0", "]"}], ",", 
       RowBox[{"S", "[", "0", "]"}], ",", 
       RowBox[{"F", "[", "2", "]"}], ",", 
       RowBox[{"v", "[", "1", "]"}]}], "]"}]}], "+", 
    RowBox[{
     RowBox[{"c", "[", "38", "]"}], " ", 
     RowBox[{"dot", "[", 
      RowBox[{
       RowBox[{"p", "[", "2", "]"}], ",", 
       RowBox[{"v", "[", "1", "]"}]}], "]"}], " ", 
     RowBox[{"dot", "[", 
      RowBox[{
       RowBox[{"p", "[", "2", "]"}], ",", 
       RowBox[{"F", "[", "1", "]"}], ",", 
       RowBox[{"S", "[", "0", "]"}], ",", 
       RowBox[{"S", "[", "0", "]"}], ",", 
       RowBox[{"F", "[", "2", "]"}], ",", 
       RowBox[{"v", "[", "1", "]"}]}], "]"}]}], "+", 
    RowBox[{
     RowBox[{"(", 
      RowBox[{
       RowBox[{"-", 
        RowBox[{"c", "[", "16", "]"}]}], "-", 
       RowBox[{"c", "[", "17", "]"}]}], ")"}], " ", 
     RowBox[{"dot", "[", 
      RowBox[{
       RowBox[{"p", "[", "2", "]"}], ",", 
       RowBox[{"S", "[", "0", "]"}], ",", 
       RowBox[{"F", "[", "1", "]"}], ",", 
       RowBox[{"F", "[", "2", "]"}], ",", 
       RowBox[{"S", "[", "0", "]"}], ",", 
       RowBox[{"p", "[", "2", "]"}]}], "]"}]}], "+", 
    RowBox[{
     RowBox[{"(", 
      RowBox[{
       RowBox[{"c", "[", "2", "]"}], "+", 
       RowBox[{"2", " ", 
        RowBox[{"c", "[", "8", "]"}]}], "+", 
       RowBox[{"c", "[", "13", "]"}], "+", 
       RowBox[{"c", "[", "16", "]"}], "+", 
       RowBox[{"c", "[", "22", "]"}], "-", 
       RowBox[{"c", "[", "26", "]"}], "-", 
       RowBox[{"c", "[", "28", "]"}], "+", 
       RowBox[{"c", "[", "37", "]"}]}], ")"}], " ", 
     RowBox[{"dot", "[", 
      RowBox[{
       RowBox[{"p", "[", "1", "]"}], ",", 
       RowBox[{"v", "[", "1", "]"}]}], "]"}], " ", 
     RowBox[{"dot", "[", 
      RowBox[{
       RowBox[{"p", "[", "2", "]"}], ",", 
       RowBox[{"S", "[", "0", "]"}], ",", 
       RowBox[{"F", "[", "1", "]"}], ",", 
       RowBox[{"S", "[", "0", "]"}], ",", 
       RowBox[{"F", "[", "2", "]"}], ",", 
       RowBox[{"v", "[", "1", "]"}]}], "]"}]}], "+", 
    RowBox[{
     RowBox[{"c", "[", "37", "]"}], " ", 
     RowBox[{"dot", "[", 
      RowBox[{
       RowBox[{"p", "[", "2", "]"}], ",", 
       RowBox[{"v", "[", "1", "]"}]}], "]"}], " ", 
     RowBox[{"dot", "[", 
      RowBox[{
       RowBox[{"p", "[", "2", "]"}], ",", 
       RowBox[{"S", "[", "0", "]"}], ",", 
       RowBox[{"F", "[", "1", "]"}], ",", 
       RowBox[{"S", "[", "0", "]"}], ",", 
       RowBox[{"F", "[", "2", "]"}], ",", 
       RowBox[{"v", "[", "1", "]"}]}], "]"}]}], "+", 
    RowBox[{
     RowBox[{"(", 
      RowBox[{
       RowBox[{"-", "2"}], "-", 
       RowBox[{"c", "[", "4", "]"}], "-", 
       RowBox[{"c", "[", "13", "]"}], "-", 
       RowBox[{"c", "[", "16", "]"}], "-", 
       RowBox[{"c", "[", "24", "]"}], "+", 
       RowBox[{"c", "[", "30", "]"}], "+", 
       RowBox[{"c", "[", "33", "]"}], "+", 
       RowBox[{"c", "[", "35", "]"}]}], ")"}], " ", 
     RowBox[{"dot", "[", 
      RowBox[{
       RowBox[{"p", "[", "1", "]"}], ",", 
       RowBox[{"v", "[", "1", "]"}]}], "]"}], " ", 
     RowBox[{"dot", "[", 
      RowBox[{
       RowBox[{"p", "[", "2", "]"}], ",", 
       RowBox[{"S", "[", "0", "]"}], ",", 
       RowBox[{"F", "[", "2", "]"}], ",", 
       RowBox[{"S", "[", "0", "]"}], ",", 
       RowBox[{"F", "[", "1", "]"}], ",", 
       RowBox[{"v", "[", "1", "]"}]}], "]"}]}], "+", 
    RowBox[{
     RowBox[{"c", "[", "35", "]"}], " ", 
     RowBox[{"dot", "[", 
      RowBox[{
       RowBox[{"p", "[", "2", "]"}], ",", 
       RowBox[{"v", "[", "1", "]"}]}], "]"}], " ", 
     RowBox[{"dot", "[", 
      RowBox[{
       RowBox[{"p", "[", "2", "]"}], ",", 
       RowBox[{"S", "[", "0", "]"}], ",", 
       RowBox[{"F", "[", "2", "]"}], ",", 
       RowBox[{"S", "[", "0", "]"}], ",", 
       RowBox[{"F", "[", "1", "]"}], ",", 
       RowBox[{"v", "[", "1", "]"}]}], "]"}]}], "+", 
    RowBox[{
     RowBox[{"(", 
      RowBox[{
       RowBox[{"-", "4"}], "-", 
       RowBox[{"c", "[", "1", "]"}], "+", 
       RowBox[{"c", "[", "8", "]"}], "-", 
       RowBox[{"c", "[", "13", "]"}], "-", 
       RowBox[{"c", "[", "16", "]"}], "+", 
       RowBox[{"c", "[", "21", "]"}], "-", 
       RowBox[{"c", "[", "27", "]"}], "+", 
       RowBox[{"c", "[", "36", "]"}]}], ")"}], " ", 
     RowBox[{"dot", "[", 
      RowBox[{
       RowBox[{"p", "[", "1", "]"}], ",", 
       RowBox[{"v", "[", "1", "]"}]}], "]"}], " ", 
     RowBox[{"dot", "[", 
      RowBox[{
       RowBox[{"p", "[", "2", "]"}], ",", 
       RowBox[{"S", "[", "0", "]"}], ",", 
       RowBox[{"S", "[", "0", "]"}], ",", 
       RowBox[{"F", "[", "1", "]"}], ",", 
       RowBox[{"F", "[", "2", "]"}], ",", 
       RowBox[{"v", "[", "1", "]"}]}], "]"}]}], "+", 
    RowBox[{
     RowBox[{"c", "[", "36", "]"}], " ", 
     RowBox[{"dot", "[", 
      RowBox[{
       RowBox[{"p", "[", "2", "]"}], ",", 
       RowBox[{"v", "[", "1", "]"}]}], "]"}], " ", 
     RowBox[{"dot", "[", 
      RowBox[{
       RowBox[{"p", "[", "2", "]"}], ",", 
       RowBox[{"S", "[", "0", "]"}], ",", 
       RowBox[{"S", "[", "0", "]"}], ",", 
       RowBox[{"F", "[", "1", "]"}], ",", 
       RowBox[{"F", "[", "2", "]"}], ",", 
       RowBox[{"v", "[", "1", "]"}]}], "]"}]}], "+", 
    RowBox[{
     RowBox[{"(", 
      RowBox[{"4", "+", 
       RowBox[{"c", "[", "4", "]"}], "+", 
       RowBox[{"c", "[", "5", "]"}], "-", 
       RowBox[{"c", "[", "8", "]"}], "+", 
       RowBox[{"c", "[", "13", "]"}], "+", 
       RowBox[{"c", "[", "16", "]"}], "+", 
       RowBox[{"c", "[", "24", "]"}], "-", 
       RowBox[{"c", "[", "30", "]"}], "+", 
       RowBox[{"c", "[", "34", "]"}]}], ")"}], " ", 
     RowBox[{"dot", "[", 
      RowBox[{
       RowBox[{"p", "[", "1", "]"}], ",", 
       RowBox[{"v", "[", "1", "]"}]}], "]"}], " ", 
     RowBox[{"dot", "[", 
      RowBox[{
       RowBox[{"p", "[", "2", "]"}], ",", 
       RowBox[{"S", "[", "0", "]"}], ",", 
       RowBox[{"S", "[", "0", "]"}], ",", 
       RowBox[{"F", "[", "2", "]"}], ",", 
       RowBox[{"F", "[", "1", "]"}], ",", 
       RowBox[{"v", "[", "1", "]"}]}], "]"}]}], "+", 
    RowBox[{
     RowBox[{"c", "[", "34", "]"}], " ", 
     RowBox[{"dot", "[", 
      RowBox[{
       RowBox[{"p", "[", "2", "]"}], ",", 
       RowBox[{"v", "[", "1", "]"}]}], "]"}], " ", 
     RowBox[{"dot", "[", 
      RowBox[{
       RowBox[{"p", "[", "2", "]"}], ",", 
       RowBox[{"S", "[", "0", "]"}], ",", 
       RowBox[{"S", "[", "0", "]"}], ",", 
       RowBox[{"F", "[", "2", "]"}], ",", 
       RowBox[{"F", "[", "1", "]"}], ",", 
       RowBox[{"v", "[", "1", "]"}]}], "]"}]}], "+", 
    RowBox[{
     RowBox[{"c", "[", "3", "]"}], " ", 
     RowBox[{"dot", "[", 
      RowBox[{
       RowBox[{"p", "[", "1", "]"}], ",", 
       RowBox[{"p", "[", "2", "]"}]}], "]"}], " ", 
     RowBox[{"dot", "[", 
      RowBox[{
       RowBox[{"v", "[", "1", "]"}], ",", 
       RowBox[{"F", "[", "1", "]"}], ",", 
       RowBox[{"S", "[", "0", "]"}], ",", 
       RowBox[{"S", "[", "0", "]"}], ",", 
       RowBox[{"F", "[", "2", "]"}], ",", 
       RowBox[{"v", "[", "1", "]"}]}], "]"}]}]}], "}"}], "}"}]], "Output",
 CellChangeTimes->{3.8770081251479225`*^9, 3.877066543423312*^9},
 CellLabel->
  "Out[370]=",ExpressionUUID->"1821d9be-c9b7-49f7-b609-fafed1eeb36c"]
}, Open  ]]
}, Closed]]
}, Open  ]],

Cell[CellGroupData[{

Cell["Independent building blocks", "Section",
 CellChangeTimes->{{3.877008171032135*^9, 
  3.877008177039516*^9}},ExpressionUUID->"604156b9-0508-4c7d-9a7a-\
b99be3f8fadc"],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{
  RowBox[{"AnsatzS2Exp", "=", 
   RowBox[{"(", 
    RowBox[{
     RowBox[{
      RowBox[{
       RowBox[{"(", 
        RowBox[{
         RowBox[{"(", 
          RowBox[{
           RowBox[{"(", 
            RowBox[{"monos", ".", 
             RowBox[{"c", "/@", 
              RowBox[{"Range", "[", 
               RowBox[{"Length", "[", "monos", "]"}], "]"}]}]}], ")"}], "//.", 
           RowBox[{
            RowBox[{"dot", "[", 
             RowBox[{"x__", ",", 
              RowBox[{"F", "[", "c_", "]"}], ",", "y__"}], "]"}], 
            "\[RuleDelayed]", 
            RowBox[{
             RowBox[{
              RowBox[{"dot", "[", 
               RowBox[{"x", ",", 
                RowBox[{"p", "[", "c", "]"}]}], "]"}], "*", 
              RowBox[{"dot", "[", 
               RowBox[{
                RowBox[{"\[Epsilon]", "[", "c", "]"}], ",", "y"}], "]"}]}], 
             "-", 
             RowBox[{
              RowBox[{"dot", "[", 
               RowBox[{"x", ",", 
                RowBox[{"\[Epsilon]", "[", "c", "]"}]}], "]"}], "*", 
              RowBox[{"dot", "[", 
               RowBox[{
                RowBox[{"p", "[", "c", "]"}], ",", "y"}], "]"}]}]}]}]}], 
          ")"}], "//", "Expand"}], ")"}], "//.", "LeviCivitaRules"}], "//.", 
      RowBox[{
       RowBox[{"dot", "[", 
        RowBox[{
         RowBox[{"v", "[", "1", "]"}], ",", 
         RowBox[{"p", "[", "2", "]"}]}], "]"}], "\[RuleDelayed]", " ", 
       RowBox[{"-", 
        RowBox[{"dot", "[", 
         RowBox[{
          RowBox[{"v", "[", "1", "]"}], ",", 
          RowBox[{"p", "[", "1", "]"}]}], "]"}]}]}]}], "//.", 
     "\[IndentingNewLine]", "dotRules"}], ")"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"eqDep", "=", 
   RowBox[{"Table", "[", 
    RowBox[{
     RowBox[{
      RowBox[{"AnsatzS2Exp", "\[Equal]", "0"}], "/.", "dot2num"}], ",", 
     "100"}], "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"sols", "=", 
   RowBox[{
    RowBox[{"Solve", "[", 
     RowBox[{"eqDep", ",", 
      RowBox[{"c", "/@", 
       RowBox[{"Range", "[", 
        RowBox[{"Length", "[", "monos", "]"}], "]"}]}]}], "]"}], "[", 
    RowBox[{"[", "1", "]"}], "]"}]}], ";"}]}], "Input",
 CellChangeTimes->{{3.876986335035886*^9, 3.8769863437995872`*^9}, {
   3.876986374740819*^9, 3.8769864902010098`*^9}, {3.8769865226855855`*^9, 
   3.87698658867919*^9}, 3.8769867136750913`*^9, {3.876986765779317*^9, 
   3.8769867766075134`*^9}, 3.876986939745494*^9, {3.8769869731602592`*^9, 
   3.8769870568385925`*^9}, {3.8769871551716223`*^9, 
   3.8769871555307198`*^9}, {3.876989041215598*^9, 3.876989120086875*^9}, 
   3.876989151173992*^9, {3.8769899620362005`*^9, 3.87698996742194*^9}, {
   3.876990085135933*^9, 3.876990111954567*^9}, {3.8769902141779947`*^9, 
   3.8769902192407093`*^9}, {3.8769952721186666`*^9, 
   3.8769953101694455`*^9}, {3.8769953521055045`*^9, 3.876995359761309*^9}, {
   3.876996193171315*^9, 3.8769962185054893`*^9}, {3.8769962649855785`*^9, 
   3.8769962780577393`*^9}, {3.8769963145353127`*^9, 3.876996323268482*^9}, 
   3.8769966253606663`*^9, 3.876996988806126*^9, {3.876997249203294*^9, 
   3.876997254131243*^9}, {3.877007848954523*^9, 3.8770078557501144`*^9}, {
   3.8770078909726157`*^9, 3.877007894503232*^9}},
 CellLabel->
  "In[373]:=",ExpressionUUID->"832d4540-2bf7-4ffe-9b00-0f252f2a16a6"],

Cell[BoxData[
 TemplateBox[{
  "Solve", "svars", 
   "\"Equations may not give solutions for all \\\"solve\\\" variables.\"", 2,
    375, 12, 28403305668340845559, "Local"},
  "MessageTemplate"]], "Message", "MSG",
 CellChangeTimes->{3.877066600402795*^9},
 CellLabel->
  "During evaluation of \
In[373]:=",ExpressionUUID->"8309d1ea-5362-4789-8137-852f658b10f4"]
}, Open  ]],

Cell[BoxData[
 RowBox[{
  RowBox[{"Relations", "=", 
   RowBox[{"List", "@@@", 
    RowBox[{"(", 
     RowBox[{
      RowBox[{"List", "@@", 
       RowBox[{"(", 
        RowBox[{
         RowBox[{"AnsatzS2", "/.", "sols"}], "//", 
         RowBox[{
          RowBox[{"Collect", "[", 
           RowBox[{"#", ",", 
            RowBox[{"c", "[", "i_", "]"}]}], "]"}], "&"}]}], ")"}]}], "//.", 
      RowBox[{"{", 
       RowBox[{
        RowBox[{"c", "[", "i_", "]"}], "\[RuleDelayed]", " ", "1"}], "}"}]}], 
     ")"}]}]}], ";"}]], "Input",
 CellChangeTimes->{{3.876987388024374*^9, 3.8769874665609703`*^9}, {
   3.8769879834834557`*^9, 3.876988004149584*^9}, {3.876988504274715*^9, 
   3.87698885785979*^9}, {3.876988899182692*^9, 3.876988901079945*^9}, 
   3.8769901889889*^9, {3.876990498100026*^9, 3.8769905197879076`*^9}, {
   3.876990614044145*^9, 3.876990631534423*^9}, {3.876990732975582*^9, 
   3.87699081287601*^9}, {3.876990845178445*^9, 3.8769908501815414`*^9}, 
   3.8769908816256647`*^9, {3.8769909227276745`*^9, 3.876991083572791*^9}, {
   3.8769911914409895`*^9, 3.8769913976078086`*^9}, {3.8769914329727807`*^9, 
   3.8769914947428536`*^9}, {3.8769963987818527`*^9, 
   3.8769964413552127`*^9}, {3.877007902021318*^9, 3.8770079281606426`*^9}},
 CellLabel->
  "In[376]:=",ExpressionUUID->"52a4114b-dbc6-433a-bace-c5ab1c9760b1"],

Cell[BoxData[
 RowBox[{
  RowBox[{"monos2M", "=", 
   RowBox[{"MapThread", "[", 
    RowBox[{"Rule", ",", 
     RowBox[{"{", 
      RowBox[{"monos", ",", 
       RowBox[{"M", "/@", 
        RowBox[{"Range", "[", 
         RowBox[{"Length", "@", "monos"}], "]"}]}]}], "}"}]}], "]"}]}], 
  ";"}]], "Input",
 CellChangeTimes->{{3.876991730716123*^9, 3.8769917838029275`*^9}, {
   3.8769918183133807`*^9, 3.8769919069697475`*^9}, 3.876996427400666*^9, 
   3.876996620295514*^9, {3.876996707471257*^9, 3.876996710455186*^9}},
 CellLabel->
  "In[377]:=",ExpressionUUID->"f009266d-2a0c-4915-b6e4-8508640255d7"],

Cell[BoxData[{
 RowBox[{
  RowBox[{"solM", "=", 
   RowBox[{
    RowBox[{"Solve", "[", 
     RowBox[{
      RowBox[{"(", 
       RowBox[{
        RowBox[{"Total", "/@", "Relations"}], "/.", "monos2M"}], ")"}], 
      "\[Equal]", "0"}], "]"}], "[", 
    RowBox[{"[", "1", "]"}], "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"eliminate", ":=", 
   RowBox[{"Module", "[", 
    RowBox[{
     RowBox[{"{", "repeated", "}"}], ",", 
     RowBox[{
      RowBox[{"repeated", "=", 
       RowBox[{"{", "}"}]}], ";", 
      RowBox[{"Do", "[", 
       RowBox[{
        RowBox[{"AppendTo", "[", 
         RowBox[{"repeated", ",", 
          RowBox[{"solM", "[", 
           RowBox[{"[", 
            RowBox[{"i", ",", "1"}], "]"}], "]"}]}], "]"}], ",", 
        RowBox[{"{", 
         RowBox[{"i", ",", 
          RowBox[{"Length", "[", "solM", "]"}]}], "}"}]}], "]"}], ";", 
      RowBox[{"Return", "[", "repeated", "]"}]}]}], "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"takeOut", "=", 
   RowBox[{"eliminate", "/.", 
    RowBox[{"{", 
     RowBox[{
      RowBox[{"M", "[", "i_", "]"}], "\[RuleDelayed]", " ", 
      RowBox[{"{", "i", "}"}]}], "}"}]}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"monosIndep", "=", 
   RowBox[{"Delete", "[", 
    RowBox[{"monos", ",", "takeOut"}], "]"}]}], ";"}]}], "Input",
 CellChangeTimes->{{3.876991706835806*^9, 3.8769917181306014`*^9}, {
  3.8769919150423045`*^9, 3.876991923092308*^9}, {3.87699195403293*^9, 
  3.87699201784394*^9}, {3.8769920699478836`*^9, 3.8769921033522387`*^9}, {
  3.8769922186796403`*^9, 3.8769922296885176`*^9}, {3.876992365190892*^9, 
  3.8769924099989805`*^9}, {3.876992453231738*^9, 3.8769924580410194`*^9}, {
  3.876992492445366*^9, 3.87699277790691*^9}, {3.876992830925222*^9, 
  3.876992910543169*^9}, {3.876992943103403*^9, 3.8769929653094416`*^9}, {
  3.8769930073822327`*^9, 3.876993025830437*^9}, {3.8769967204126153`*^9, 
  3.876996725824335*^9}, {3.8769970148475647`*^9, 3.8769970164144025`*^9}, {
  3.877007968451816*^9, 3.8770079793579297`*^9}},
 CellLabel->
  "In[378]:=",ExpressionUUID->"6eb6e71b-b46e-4096-9291-716b55353d57"]
}, Open  ]],

Cell[CellGroupData[{

Cell["Examples", "Section",
 CellChangeTimes->{{3.8768042159264*^9, 
  3.876804221321859*^9}},ExpressionUUID->"919c4b49-f361-4762-8a29-\
65ab6d644e9f"],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"Series", "[", 
  RowBox[{
   RowBox[{"Cos", "[", "x", "]"}], ",", 
   RowBox[{"{", 
    RowBox[{"x", ",", "0", ",", "8"}], "}"}]}], "]"}]], "Input",
 CellChangeTimes->{3.8773093535456963`*^9, 3.877309383581464*^9},
 CellLabel->
  "In[435]:=",ExpressionUUID->"ed9ab052-8d0e-4de7-94d8-3b733fb035e6"],

Cell[BoxData[
 InterpretationBox[
  RowBox[{"1", "-", 
   FractionBox[
    SuperscriptBox["x", "2"], "2"], "+", 
   FractionBox[
    SuperscriptBox["x", "4"], "24"], "-", 
   FractionBox[
    SuperscriptBox["x", "6"], "720"], "+", 
   FractionBox[
    SuperscriptBox["x", "8"], "40320"], "+", 
   InterpretationBox[
    SuperscriptBox[
     RowBox[{"O", "[", "x", "]"}], "9"],
    SeriesData[$CellContext`x, 0, {}, 0, 9, 1],
    Editable->False]}],
  SeriesData[$CellContext`x, 0, {1, 0, 
    Rational[-1, 2], 0, 
    Rational[1, 24], 0, 
    Rational[-1, 720], 0, 
    Rational[1, 40320]}, 0, 9, 1],
  Editable->False]], "Output",
 CellChangeTimes->{3.877309354107369*^9, 3.8773093841899853`*^9},
 CellLabel->
  "Out[435]=",ExpressionUUID->"63936d9a-8499-4680-a66f-34d2a2db27d1"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"AnsatzS2", "=", 
  RowBox[{"monosIndep", ".", 
   RowBox[{"c", "/@", 
    RowBox[{"Range", "[", 
     RowBox[{"Length", "[", "monosIndep", "]"}], "]"}]}]}]}]], "Input",
 CellChangeTimes->{{3.8769045587726774`*^9, 3.876904577971773*^9}, 
   3.876974791125661*^9, 3.8769830243501415`*^9, {3.8769938210400147`*^9, 
   3.876993821898863*^9}, {3.876993881736343*^9, 3.8769938919049892`*^9}, {
   3.877007748999367*^9, 3.8770077513038855`*^9}, {3.8770080115724707`*^9, 
   3.877008015857771*^9}},
 CellLabel->
  "In[382]:=",ExpressionUUID->"68736b84-22e2-4a69-b663-130e9a97e8ff"],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"c", "[", "15", "]"}], " ", 
   RowBox[{"dot", "[", 
    RowBox[{
     RowBox[{"p", "[", "1", "]"}], ",", 
     RowBox[{"S", "[", "0", "]"}], ",", 
     RowBox[{"F", "[", "1", "]"}], ",", 
     RowBox[{"v", "[", "1", "]"}]}], "]"}], " ", 
   RowBox[{"dot", "[", 
    RowBox[{
     RowBox[{"p", "[", "1", "]"}], ",", 
     RowBox[{"S", "[", "0", "]"}], ",", 
     RowBox[{"F", "[", "2", "]"}], ",", 
     RowBox[{"v", "[", "1", "]"}]}], "]"}]}], "+", 
  RowBox[{
   RowBox[{"c", "[", "4", "]"}], " ", 
   RowBox[{"dot", "[", 
    RowBox[{
     RowBox[{"p", "[", "1", "]"}], ",", 
     RowBox[{"S", "[", "0", "]"}], ",", 
     RowBox[{"S", "[", "0", "]"}], ",", 
     RowBox[{"p", "[", "1", "]"}]}], "]"}], " ", 
   RowBox[{"dot", "[", 
    RowBox[{
     RowBox[{"v", "[", "1", "]"}], ",", 
     RowBox[{"F", "[", "1", "]"}], ",", 
     RowBox[{"F", "[", "2", "]"}], ",", 
     RowBox[{"v", "[", "1", "]"}]}], "]"}]}], "+", 
  RowBox[{
   RowBox[{"c", "[", "1", "]"}], " ", 
   RowBox[{"dot", "[", 
    RowBox[{
     RowBox[{"p", "[", "1", "]"}], ",", 
     RowBox[{"S", "[", "0", "]"}], ",", 
     RowBox[{"S", "[", "0", "]"}], ",", 
     RowBox[{"p", "[", "2", "]"}]}], "]"}], " ", 
   RowBox[{"dot", "[", 
    RowBox[{
     RowBox[{"v", "[", "1", "]"}], ",", 
     RowBox[{"F", "[", "1", "]"}], ",", 
     RowBox[{"F", "[", "2", "]"}], ",", 
     RowBox[{"v", "[", "1", "]"}]}], "]"}]}], "+", 
  RowBox[{
   RowBox[{"c", "[", "5", "]"}], " ", 
   RowBox[{"dot", "[", 
    RowBox[{
     RowBox[{"p", "[", "2", "]"}], ",", 
     RowBox[{"S", "[", "0", "]"}], ",", 
     RowBox[{"S", "[", "0", "]"}], ",", 
     RowBox[{"p", "[", "2", "]"}]}], "]"}], " ", 
   RowBox[{"dot", "[", 
    RowBox[{
     RowBox[{"v", "[", "1", "]"}], ",", 
     RowBox[{"F", "[", "1", "]"}], ",", 
     RowBox[{"F", "[", "2", "]"}], ",", 
     RowBox[{"v", "[", "1", "]"}]}], "]"}]}], "+", 
  RowBox[{
   RowBox[{"c", "[", "14", "]"}], " ", 
   RowBox[{"dot", "[", 
    RowBox[{
     RowBox[{"p", "[", "1", "]"}], ",", 
     RowBox[{"F", "[", "2", "]"}], ",", 
     RowBox[{"v", "[", "1", "]"}]}], "]"}], " ", 
   RowBox[{"dot", "[", 
    RowBox[{
     RowBox[{"p", "[", "1", "]"}], ",", 
     RowBox[{"S", "[", "0", "]"}], ",", 
     RowBox[{"S", "[", "0", "]"}], ",", 
     RowBox[{"F", "[", "1", "]"}], ",", 
     RowBox[{"v", "[", "1", "]"}]}], "]"}]}], "+", 
  RowBox[{
   RowBox[{"c", "[", "2", "]"}], " ", 
   RowBox[{"dot", "[", 
    RowBox[{
     RowBox[{"p", "[", "1", "]"}], ",", 
     RowBox[{"S", "[", "0", "]"}], ",", 
     RowBox[{"p", "[", "2", "]"}]}], "]"}], " ", 
   RowBox[{"dot", "[", 
    RowBox[{
     RowBox[{"v", "[", "1", "]"}], ",", 
     RowBox[{"F", "[", "1", "]"}], ",", 
     RowBox[{"S", "[", "0", "]"}], ",", 
     RowBox[{"F", "[", "2", "]"}], ",", 
     RowBox[{"v", "[", "1", "]"}]}], "]"}]}], "+", 
  RowBox[{
   RowBox[{"c", "[", "10", "]"}], " ", 
   RowBox[{"dot", "[", 
    RowBox[{
     RowBox[{"p", "[", "1", "]"}], ",", 
     RowBox[{"F", "[", "2", "]"}], ",", 
     RowBox[{"F", "[", "1", "]"}], ",", 
     RowBox[{"S", "[", "0", "]"}], ",", 
     RowBox[{"S", "[", "0", "]"}], ",", 
     RowBox[{"p", "[", "1", "]"}]}], "]"}]}], "+", 
  RowBox[{
   RowBox[{"c", "[", "6", "]"}], " ", 
   RowBox[{"dot", "[", 
    RowBox[{
     RowBox[{"p", "[", "1", "]"}], ",", 
     RowBox[{"F", "[", "2", "]"}], ",", 
     RowBox[{"F", "[", "1", "]"}], ",", 
     RowBox[{"S", "[", "0", "]"}], ",", 
     RowBox[{"S", "[", "0", "]"}], ",", 
     RowBox[{"p", "[", "2", "]"}]}], "]"}]}], "+", 
  RowBox[{
   RowBox[{"c", "[", "11", "]"}], " ", 
   RowBox[{"dot", "[", 
    RowBox[{
     RowBox[{"p", "[", "1", "]"}], ",", 
     RowBox[{"F", "[", "2", "]"}], ",", 
     RowBox[{"S", "[", "0", "]"}], ",", 
     RowBox[{"F", "[", "1", "]"}], ",", 
     RowBox[{"S", "[", "0", "]"}], ",", 
     RowBox[{"p", "[", "1", "]"}]}], "]"}]}], "+", 
  RowBox[{
   RowBox[{"c", "[", "7", "]"}], " ", 
   RowBox[{"dot", "[", 
    RowBox[{
     RowBox[{"p", "[", "1", "]"}], ",", 
     RowBox[{"F", "[", "2", "]"}], ",", 
     RowBox[{"S", "[", "0", "]"}], ",", 
     RowBox[{"F", "[", "1", "]"}], ",", 
     RowBox[{"S", "[", "0", "]"}], ",", 
     RowBox[{"p", "[", "2", "]"}]}], "]"}]}], "+", 
  RowBox[{
   RowBox[{"c", "[", "8", "]"}], " ", 
   RowBox[{"dot", "[", 
    RowBox[{
     RowBox[{"p", "[", "1", "]"}], ",", 
     RowBox[{"F", "[", "2", "]"}], ",", 
     RowBox[{"S", "[", "0", "]"}], ",", 
     RowBox[{"S", "[", "0", "]"}], ",", 
     RowBox[{"F", "[", "1", "]"}], ",", 
     RowBox[{"p", "[", "2", "]"}]}], "]"}]}], "+", 
  RowBox[{
   RowBox[{"c", "[", "16", "]"}], " ", 
   RowBox[{"dot", "[", 
    RowBox[{
     RowBox[{"p", "[", "1", "]"}], ",", 
     RowBox[{"v", "[", "1", "]"}]}], "]"}], " ", 
   RowBox[{"dot", "[", 
    RowBox[{
     RowBox[{"p", "[", "1", "]"}], ",", 
     RowBox[{"F", "[", "2", "]"}], ",", 
     RowBox[{"S", "[", "0", "]"}], ",", 
     RowBox[{"S", "[", "0", "]"}], ",", 
     RowBox[{"F", "[", "1", "]"}], ",", 
     RowBox[{"v", "[", "1", "]"}]}], "]"}]}], "+", 
  RowBox[{
   RowBox[{"c", "[", "9", "]"}], " ", 
   RowBox[{"dot", "[", 
    RowBox[{
     RowBox[{"p", "[", "1", "]"}], ",", 
     RowBox[{"S", "[", "0", "]"}], ",", 
     RowBox[{"F", "[", "2", "]"}], ",", 
     RowBox[{"F", "[", "1", "]"}], ",", 
     RowBox[{"S", "[", "0", "]"}], ",", 
     RowBox[{"p", "[", "2", "]"}]}], "]"}]}], "+", 
  RowBox[{
   RowBox[{"c", "[", "12", "]"}], " ", 
   RowBox[{"dot", "[", 
    RowBox[{
     RowBox[{"p", "[", "2", "]"}], ",", 
     RowBox[{"F", "[", "1", "]"}], ",", 
     RowBox[{"F", "[", "2", "]"}], ",", 
     RowBox[{"S", "[", "0", "]"}], ",", 
     RowBox[{"S", "[", "0", "]"}], ",", 
     RowBox[{"p", "[", "2", "]"}]}], "]"}]}], "+", 
  RowBox[{
   RowBox[{"c", "[", "13", "]"}], " ", 
   RowBox[{"dot", "[", 
    RowBox[{
     RowBox[{"p", "[", "2", "]"}], ",", 
     RowBox[{"F", "[", "1", "]"}], ",", 
     RowBox[{"S", "[", "0", "]"}], ",", 
     RowBox[{"F", "[", "2", "]"}], ",", 
     RowBox[{"S", "[", "0", "]"}], ",", 
     RowBox[{"p", "[", "2", "]"}]}], "]"}]}], "+", 
  RowBox[{
   RowBox[{"c", "[", "3", "]"}], " ", 
   RowBox[{"dot", "[", 
    RowBox[{
     RowBox[{"p", "[", "1", "]"}], ",", 
     RowBox[{"p", "[", "2", "]"}]}], "]"}], " ", 
   RowBox[{"dot", "[", 
    RowBox[{
     RowBox[{"v", "[", "1", "]"}], ",", 
     RowBox[{"F", "[", "1", "]"}], ",", 
     RowBox[{"S", "[", "0", "]"}], ",", 
     RowBox[{"S", "[", "0", "]"}], ",", 
     RowBox[{"F", "[", "2", "]"}], ",", 
     RowBox[{"v", "[", "1", "]"}]}], "]"}]}]}]], "Output",
 CellChangeTimes->{
  3.8769830247161636`*^9, 3.876990232774701*^9, {3.876993883566757*^9, 
   3.876993892277953*^9}, 3.8770077522210875`*^9, 3.8770080163800106`*^9, 
   3.877066611691904*^9},
 CellLabel->
  "Out[382]=",ExpressionUUID->"283c2ef4-b7f5-42d9-b224-9391276ec7f4"]
}, Open  ]],

Cell[BoxData[{
 RowBox[{
  RowBox[{"ConditionP12S2", "=", 
   RowBox[{
    RowBox[{
     RowBox[{
      RowBox[{"(", 
       RowBox[{
        RowBox[{"(", 
         RowBox[{
          RowBox[{"(", 
           RowBox[{"AnsatzS2", "\[Equal]", 
            RowBox[{"4", "*", 
             RowBox[{"dot", "[", 
              RowBox[{
               RowBox[{"v", "[", "1", "]"}], ",", 
               RowBox[{"p", "[", "1", "]"}]}], "]"}], "*", "CutP12S2"}]}], 
           ")"}], "//.", 
          RowBox[{"{", 
           RowBox[{
            RowBox[{"dot", "[", 
             RowBox[{"x__", ",", 
              RowBox[{"F", "[", "c_", "]"}], ",", "y__"}], "]"}], 
            "\[RuleDelayed]", 
            RowBox[{
             RowBox[{
              RowBox[{"dot", "[", 
               RowBox[{"x", ",", 
                RowBox[{"p", "[", "c", "]"}]}], "]"}], "*", 
              RowBox[{"dot", "[", 
               RowBox[{
                RowBox[{"\[Epsilon]", "[", "c", "]"}], ",", "y"}], "]"}]}], 
             "-", 
             RowBox[{
              RowBox[{"dot", "[", 
               RowBox[{"x", ",", 
                RowBox[{"\[Epsilon]", "[", "c", "]"}]}], "]"}], "*", 
              RowBox[{"dot", "[", 
               RowBox[{
                RowBox[{"p", "[", "c", "]"}], ",", "y"}], "]"}]}]}]}], 
           "}"}]}], ")"}], "//", "Expand"}], ")"}], "//.", 
      "LeviCivitaRules"}], "//.", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{
        RowBox[{"dot", "[", 
         RowBox[{
          RowBox[{"p", "[", "1", "]"}], ",", 
          RowBox[{"p", "[", "2", "]"}]}], "]"}], "\[RuleDelayed]", "0"}], ",", 
       RowBox[{
        RowBox[{"dot", "[", 
         RowBox[{
          RowBox[{"v", "[", "1", "]"}], ",", 
          RowBox[{"p", "[", "2", "]"}]}], "]"}], "\[RuleDelayed]", 
        RowBox[{"-", 
         RowBox[{"dot", "[", 
          RowBox[{
           RowBox[{"v", "[", "1", "]"}], ",", 
           RowBox[{"p", "[", "1", "]"}]}], "]"}]}]}]}], "}"}]}], "//.", 
    "dotRules"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"Conditionv1S2", "=", 
   RowBox[{
    RowBox[{
     RowBox[{
      RowBox[{"(", 
       RowBox[{
        RowBox[{"(", 
         RowBox[{
          RowBox[{"(", 
           RowBox[{"AnsatzS2", "\[Equal]", 
            RowBox[{"4", "*", 
             RowBox[{"dot", "[", 
              RowBox[{
               RowBox[{"p", "[", "1", "]"}], ",", 
               RowBox[{"p", "[", "2", "]"}]}], "]"}], "*", "Cutv1S2"}]}], 
           ")"}], "//.", 
          RowBox[{"{", 
           RowBox[{
            RowBox[{"dot", "[", 
             RowBox[{"x__", ",", 
              RowBox[{"F", "[", "c_", "]"}], ",", "y__"}], "]"}], 
            "\[RuleDelayed]", 
            RowBox[{
             RowBox[{
              RowBox[{"dot", "[", 
               RowBox[{"x", ",", 
                RowBox[{"p", "[", "c", "]"}]}], "]"}], "*", 
              RowBox[{"dot", "[", 
               RowBox[{
                RowBox[{"\[Epsilon]", "[", "c", "]"}], ",", "y"}], "]"}]}], 
             "-", 
             RowBox[{
              RowBox[{"dot", "[", 
               RowBox[{"x", ",", 
                RowBox[{"\[Epsilon]", "[", "c", "]"}]}], "]"}], "*", 
              RowBox[{"dot", "[", 
               RowBox[{
                RowBox[{"p", "[", "c", "]"}], ",", "y"}], "]"}]}]}]}], 
           "}"}]}], ")"}], "//", "Expand"}], ")"}], "//.", 
      "LeviCivitaRules"}], "//.", "dotRules"}], " ", "//.", 
    RowBox[{"{", 
     RowBox[{
      RowBox[{
       RowBox[{"dot", "[", 
        RowBox[{
         RowBox[{"v", "[", "1", "]"}], ",", 
         RowBox[{"p", "[", "1", "]"}]}], "]"}], "\[RuleDelayed]", "0"}], ",", 
      
      RowBox[{
       RowBox[{"dot", "[", 
        RowBox[{
         RowBox[{"v", "[", "1", "]"}], ",", 
         RowBox[{"p", "[", "2", "]"}]}], "]"}], "\[RuleDelayed]", "0"}]}], 
     "}"}]}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"SymmetryCond", "=", 
   RowBox[{"(", 
    RowBox[{
     RowBox[{
      RowBox[{
       RowBox[{"(", 
        RowBox[{
         RowBox[{"(", 
          RowBox[{
           RowBox[{"(", 
            RowBox[{"AnsatzS2", "\[Equal]", 
             RowBox[{"(", 
              RowBox[{"AnsatzS2", "/.", 
               RowBox[{"{", 
                RowBox[{
                 RowBox[{
                  RowBox[{"p", "[", "1", "]"}], "\[Rule]", 
                  RowBox[{"p", "[", "2", "]"}]}], ",", 
                 RowBox[{
                  RowBox[{"p", "[", "2", "]"}], "\[Rule]", 
                  RowBox[{"p", "[", "1", "]"}]}], ",", 
                 RowBox[{
                  RowBox[{"F", "[", "1", "]"}], "\[Rule]", 
                  RowBox[{"F", "[", "2", "]"}]}], ",", 
                 RowBox[{
                  RowBox[{"F", "[", "2", "]"}], "\[Rule]", 
                  RowBox[{"F", "[", "1", "]"}]}]}], "}"}]}], ")"}]}], ")"}], "//.", 
           RowBox[{
            RowBox[{"dot", "[", 
             RowBox[{"x__", ",", 
              RowBox[{"F", "[", "c_", "]"}], ",", "y__"}], "]"}], 
            "\[RuleDelayed]", 
            RowBox[{
             RowBox[{
              RowBox[{"dot", "[", 
               RowBox[{"x", ",", 
                RowBox[{"p", "[", "c", "]"}]}], "]"}], "*", 
              RowBox[{"dot", "[", 
               RowBox[{
                RowBox[{"\[Epsilon]", "[", "c", "]"}], ",", "y"}], "]"}]}], 
             "-", 
             RowBox[{
              RowBox[{"dot", "[", 
               RowBox[{"x", ",", 
                RowBox[{"\[Epsilon]", "[", "c", "]"}]}], "]"}], "*", 
              RowBox[{"dot", "[", 
               RowBox[{
                RowBox[{"p", "[", "c", "]"}], ",", "y"}], "]"}]}]}]}]}], 
          ")"}], "//", "Expand"}], ")"}], "//.", "LeviCivitaRules"}], "//.", 
      RowBox[{"{", 
       RowBox[{
        RowBox[{"dot", "[", 
         RowBox[{
          RowBox[{"v", "[", "1", "]"}], ",", 
          RowBox[{"p", "[", "2", "]"}]}], "]"}], "\[RuleDelayed]", " ", 
        RowBox[{"-", 
         RowBox[{"dot", "[", 
          RowBox[{
           RowBox[{"v", "[", "1", "]"}], ",", 
           RowBox[{"p", "[", "1", "]"}]}], "]"}]}]}], "}"}]}], "//.", 
     "dotRules"}], ")"}]}], ";"}]}], "Input",
 CellLabel->
  "In[383]:=",ExpressionUUID->"dbcba3a2-6089-4dae-98ff-ffb1ff1427d5"],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"vardot", "=", 
  RowBox[{
   RowBox[{"{", 
    RowBox[{"ConditionP12S2", ",", "Conditionv1S2", ",", "SymmetryCond"}], 
    "}"}], "//", "Casesdot"}]}]], "Input",
 CellLabel->
  "In[386]:=",ExpressionUUID->"57031058-2325-4520-94ef-c3cadeef8223"],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
   RowBox[{"dot", "[", 
    RowBox[{
     RowBox[{"as", "[", "1", "]"}], ",", 
     RowBox[{"as", "[", "1", "]"}]}], "]"}], ",", 
   RowBox[{"dot", "[", 
    RowBox[{
     RowBox[{"as", "[", "1", "]"}], ",", 
     RowBox[{"p", "[", "1", "]"}]}], "]"}], ",", 
   RowBox[{"dot", "[", 
    RowBox[{
     RowBox[{"as", "[", "1", "]"}], ",", 
     RowBox[{"p", "[", "2", "]"}]}], "]"}], ",", 
   RowBox[{"dot", "[", 
    RowBox[{
     RowBox[{"as", "[", "1", "]"}], ",", 
     RowBox[{"v", "[", "1", "]"}]}], "]"}], ",", 
   RowBox[{"dot", "[", 
    RowBox[{
     RowBox[{"as", "[", "1", "]"}], ",", 
     RowBox[{"\[Epsilon]", "[", "1", "]"}]}], "]"}], ",", 
   RowBox[{"dot", "[", 
    RowBox[{
     RowBox[{"as", "[", "1", "]"}], ",", 
     RowBox[{"\[Epsilon]", "[", "2", "]"}]}], "]"}], ",", 
   RowBox[{"dot", "[", 
    RowBox[{
     RowBox[{"p", "[", "1", "]"}], ",", 
     RowBox[{"p", "[", "2", "]"}]}], "]"}], ",", 
   RowBox[{"dot", "[", 
    RowBox[{
     RowBox[{"p", "[", "1", "]"}], ",", 
     RowBox[{"v", "[", "1", "]"}]}], "]"}], ",", 
   RowBox[{"dot", "[", 
    RowBox[{
     RowBox[{"p", "[", "1", "]"}], ",", 
     RowBox[{"\[Epsilon]", "[", "2", "]"}]}], "]"}], ",", 
   RowBox[{"dot", "[", 
    RowBox[{
     RowBox[{"p", "[", "2", "]"}], ",", 
     RowBox[{"\[Epsilon]", "[", "1", "]"}]}], "]"}], ",", 
   RowBox[{"dot", "[", 
    RowBox[{
     RowBox[{"v", "[", "1", "]"}], ",", 
     RowBox[{"\[Epsilon]", "[", "1", "]"}]}], "]"}], ",", 
   RowBox[{"dot", "[", 
    RowBox[{
     RowBox[{"v", "[", "1", "]"}], ",", 
     RowBox[{"\[Epsilon]", "[", "2", "]"}]}], "]"}], ",", 
   RowBox[{"dot", "[", 
    RowBox[{
     RowBox[{"\[Epsilon]", "[", "1", "]"}], ",", 
     RowBox[{"\[Epsilon]", "[", "2", "]"}]}], "]"}]}], "}"}]], "Output",
 CellChangeTimes->{3.87706691897931*^9},
 CellLabel->
  "Out[386]=",ExpressionUUID->"c56d4950-5bba-4728-9b97-b6186de6c67d"]
}, Open  ]],

Cell[BoxData[
 RowBox[{"dot2num", ":=", 
  RowBox[{"Table", "[", 
   RowBox[{
    RowBox[{"Rule", "[", 
     RowBox[{
      RowBox[{"vardot", "[", 
       RowBox[{"[", "ii", "]"}], "]"}], ",", 
      RowBox[{"RandomInteger", "[", 
       RowBox[{"{", 
        RowBox[{"10", ",", "100"}], "}"}], "]"}]}], "]"}], ",", 
    RowBox[{"{", 
     RowBox[{"ii", ",", 
      RowBox[{"Length", "[", "vardot", "]"}]}], "}"}]}], "]"}]}]], "Input",
 CellChangeTimes->{{3.8769049503980417`*^9, 3.876904969008238*^9}, {
  3.8769050305446887`*^9, 3.87690508374227*^9}, {3.876905113814046*^9, 
  3.876905213992666*^9}},
 CellLabel->
  "In[387]:=",ExpressionUUID->"225ad3c0-431a-4dac-81dd-cf0e40ca950d"],

Cell[BoxData[{
 RowBox[{
  RowBox[{"eq", "=", 
   RowBox[{"Flatten", "[", 
    RowBox[{"Table", "[", 
     RowBox[{
      RowBox[{
       RowBox[{"{", 
        RowBox[{"ConditionP12S2", ",", "Conditionv1S2", ",", "SymmetryCond"}],
         "}"}], "/.", "dot2num"}], ",", "100"}], "]"}], "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"finalSol", "=", 
   RowBox[{
    RowBox[{"Solve", "[", 
     RowBox[{"eq", ",", 
      RowBox[{"c", "/@", 
       RowBox[{"Range", "[", 
        RowBox[{"Length", "[", "monos", "]"}], "]"}]}]}], "]"}], "[", 
    RowBox[{"[", "1", "]"}], "]"}]}], ";"}]}], "Input",
 CellChangeTimes->{{3.8769055068820367`*^9, 3.876905583185097*^9}, {
   3.876906396301323*^9, 3.8769064100444016`*^9}, {3.876911353345582*^9, 
   3.876911377768335*^9}, {3.876911416827297*^9, 3.8769114420941296`*^9}, {
   3.876911496711166*^9, 3.876911498942684*^9}, {3.8769159860434237`*^9, 
   3.8769159982850227`*^9}, {3.876917074032778*^9, 3.876917078747828*^9}, {
   3.876917835165763*^9, 3.876917836508628*^9}, {3.8769178893148384`*^9, 
   3.87691789538586*^9}, {3.8769179679615984`*^9, 3.8769179725550594`*^9}, {
   3.876918311991231*^9, 3.876918317019087*^9}, {3.87697818577396*^9, 
   3.8769782162071357`*^9}, {3.8769784471138887`*^9, 3.876978457901613*^9}, {
   3.8769787186870823`*^9, 3.876978719140839*^9}, {3.8769793903340096`*^9, 
   3.8769794007680445`*^9}, {3.876982104314427*^9, 3.87698212934171*^9}, {
   3.876982170856949*^9, 3.876982199966533*^9}, {3.8769823039135103`*^9, 
   3.87698230615662*^9}, {3.8769824247046385`*^9, 3.8769824277792864`*^9}, {
   3.876982793124356*^9, 3.8769827983296027`*^9}, {3.87698366299763*^9, 
   3.876983663424498*^9}, {3.8769847959404755`*^9, 3.8769848044024763`*^9}, 
   3.876985209881996*^9, {3.8769852426846485`*^9, 3.8769852490019865`*^9}, {
   3.8769854301693897`*^9, 3.8769854314214716`*^9}, {3.8769854724109297`*^9, 
   3.8769854885020056`*^9}, {3.8769856379317536`*^9, 3.876985644692341*^9}, {
   3.8769856838663783`*^9, 3.8769857033196225`*^9}, {3.876985880626607*^9, 
   3.876985919016066*^9}, {3.876985980340562*^9, 3.876985981403965*^9}, {
   3.8769860425644207`*^9, 3.8769860428726206`*^9}, {3.8770080648449564`*^9, 
   3.877008097014259*^9}, {3.8770669404797773`*^9, 3.877066941133175*^9}},
 CellLabel->
  "In[392]:=",ExpressionUUID->"718c5ea3-2241-4807-bfe1-7f91077797d9"],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"AnsatzS2", "/.", "finalSol"}], "/.", 
    RowBox[{
     RowBox[{"S", "[", "_", "]"}], ":>", "S"}]}], "/.", 
   RowBox[{
    RowBox[{"v", "[", "i_", "]"}], ":>", "v"}]}], "//.", "nice"}]], "Input",
 CellChangeTimes->{{3.8770081151079397`*^9, 3.877008122593895*^9}, {
  3.8770669331913652`*^9, 3.877066968334456*^9}},
 CellLabel->
  "In[396]:=",ExpressionUUID->"ab7eccfb-44ab-46f0-b2c2-bdf03c1bc860"],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"-", "2"}], " ", 
   RowBox[{"v", "\[CenterDot]", 
    SubscriptBox["F", "1"], "\[CenterDot]", 
    SubscriptBox["F", "2"], "\[CenterDot]", "v"}], " ", 
   RowBox[{
    SubscriptBox["p", "1"], "\[CenterDot]", "S", "\[CenterDot]", "S", 
    "\[CenterDot]", 
    SubscriptBox["p", "1"]}]}], "-", 
  RowBox[{"4", " ", 
   RowBox[{"v", "\[CenterDot]", 
    SubscriptBox["F", "1"], "\[CenterDot]", 
    SubscriptBox["F", "2"], "\[CenterDot]", "v"}], " ", 
   RowBox[{
    SubscriptBox["p", "1"], "\[CenterDot]", "S", "\[CenterDot]", "S", 
    "\[CenterDot]", 
    SubscriptBox["p", "2"]}]}], "-", 
  RowBox[{"2", " ", 
   RowBox[{"v", "\[CenterDot]", 
    SubscriptBox["F", "1"], "\[CenterDot]", 
    SubscriptBox["F", "2"], "\[CenterDot]", "v"}], " ", 
   RowBox[{
    SubscriptBox["p", "2"], "\[CenterDot]", "S", "\[CenterDot]", "S", 
    "\[CenterDot]", 
    SubscriptBox["p", "2"]}]}], "+", 
  RowBox[{"4", " ", 
   RowBox[{
    SubscriptBox["p", "1"], "\[CenterDot]", 
    SubscriptBox["p", "2"]}], " ", 
   RowBox[{"v", "\[CenterDot]", 
    SubscriptBox["F", "1"], "\[CenterDot]", "S", "\[CenterDot]", "S", 
    "\[CenterDot]", 
    SubscriptBox["F", "2"], "\[CenterDot]", "v"}]}], "+", 
  RowBox[{"4", " ", 
   RowBox[{
    SubscriptBox["p", "1"], "\[CenterDot]", 
    SubscriptBox["F", "2"], "\[CenterDot]", "S", "\[CenterDot]", 
    SubscriptBox["F", "1"], "\[CenterDot]", "S", "\[CenterDot]", 
    SubscriptBox["p", "2"]}]}]}]], "Output",
 CellChangeTimes->{
  3.8770081251479225`*^9, {3.877066926959256*^9, 3.877066968724874*^9}},
 CellLabel->
  "Out[396]=",ExpressionUUID->"e686253b-d1ed-40db-8b41-b5f881260a4d"]
}, Open  ]]
}, Open  ]],

Cell[CellGroupData[{

Cell["Linear Order", "Section",
 CellChangeTimes->{{3.876974579714651*^9, 
  3.876974588660671*^9}},ExpressionUUID->"978ab20d-9b77-4241-a461-\
c2278a7b6197"],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{
  RowBox[{"listLin", "=", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"F", "[", "1", "]"}], ",", 
     RowBox[{"F", "[", "2", "]"}], ",", 
     RowBox[{"S", "[", "0", "]"}]}], "}"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{"ptsetsLin", "=", 
  RowBox[{"KSetPartitionsEmpty", "[", 
   RowBox[{"listLin", ",", "1"}], "]"}]}]}], "Input",
 CellChangeTimes->{{3.876815015948833*^9, 3.8768150173932543`*^9}, 
   3.8768151168102303`*^9, {3.8768175708373127`*^9, 3.876817572179883*^9}, {
   3.876974611220045*^9, 3.8769746355794277`*^9}, {3.8769747027289076`*^9, 
   3.8769747031848993`*^9}, {3.8769750131405087`*^9, 3.876975031968275*^9}},
 CellLabel->
  "In[397]:=",ExpressionUUID->"ea11cd8b-fdb5-4dbe-83f0-fd34adb4a468"],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{"{", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"F", "[", "1", "]"}], ",", 
     RowBox[{"F", "[", "2", "]"}], ",", 
     RowBox[{"S", "[", "0", "]"}]}], "}"}], "}"}], "}"}]], "Output",
 CellChangeTimes->{{3.876975013442684*^9, 3.876975032588195*^9}, 
   3.877148438911834*^9},
 CellLabel->
  "Out[398]=",ExpressionUUID->"672bfae1-5003-4236-85f4-704ced242f30"]
}, Open  ]],

Cell[BoxData[{
 RowBox[{"ClearAll", "[", "monoAllFLin", "]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"monoAllFLin", "[", 
   RowBox[{"ptsets_", ",", "vs_"}], "]"}], ":=", 
  RowBox[{"Module", "[", 
   RowBox[{
    RowBox[{"{", "mono", "}"}], ",", 
    RowBox[{
     RowBox[{
      RowBox[{"Table", "[", 
       RowBox[{
        RowBox[{"mono", "=", 
         RowBox[{
          RowBox[{
           RowBox[{"monomialsAnsSingle", "[", 
            RowBox[{
             RowBox[{"vs", "[", 
              RowBox[{"[", 
               RowBox[{"1", ",", "1"}], "]"}], "]"}], ",", 
             RowBox[{"ptsets", "[", 
              RowBox[{"[", 
               RowBox[{"ii", ",", "1"}], "]"}], "]"}], ",", 
             RowBox[{"vs", "[", 
              RowBox[{"[", 
               RowBox[{"1", ",", "2"}], "]"}], "]"}]}], "]"}], "//", 
           "Flatten"}], "//", "DeleteDuplicates"}]}], ",", 
        RowBox[{"{", 
         RowBox[{"ii", ",", 
          RowBox[{"Length", "@", "ptsets"}]}], "}"}]}], "]"}], "//", 
      "Flatten"}], "//", "DeleteDuplicates"}]}], 
   "]"}]}], "\[IndentingNewLine]"}], "Input",
 CellChangeTimes->{{3.876811369960775*^9, 3.8768113727341633`*^9}, {
   3.876811485009445*^9, 3.876811595092298*^9}, {3.876811639699731*^9, 
   3.876811640893647*^9}, 3.8768116783304043`*^9, {3.876811716061986*^9, 
   3.876811732470446*^9}, {3.876811790156522*^9, 3.876811796540135*^9}, {
   3.8768118801902447`*^9, 3.876811892921207*^9}, {3.876811927282494*^9, 
   3.876812045955064*^9}, {3.876812090166971*^9, 3.876812166246018*^9}, {
   3.876812217543675*^9, 3.8768122751008883`*^9}, {3.876812307151626*^9, 
   3.876812392859235*^9}, 3.876812451314582*^9, {3.8769750409370527`*^9, 
   3.8769751285922403`*^9}, 3.876975198543532*^9, 3.877148447277141*^9},
 CellLabel->
  "In[401]:=",ExpressionUUID->"bf72d32e-ccb2-4d95-92b4-a5ddafe2387c"],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{
  RowBox[{"lsLin", "[", "1", "]"}], "=", 
  RowBox[{"monoAllFLin", "[", 
   RowBox[{"ptsetsLin", ",", 
    RowBox[{"{", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"v", "[", "1", "]"}], ",", 
       RowBox[{"p", "[", "1", "]"}]}], "}"}], "}"}]}], 
   "]"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"lsLin", "[", "2", "]"}], "=", 
  RowBox[{"monoAllFLin", "[", 
   RowBox[{"ptsetsLin", ",", 
    RowBox[{"{", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"v", "[", "1", "]"}], ",", 
       RowBox[{"p", "[", "2", "]"}]}], "}"}], "}"}]}], "]"}]}]}], "Input",
 CellChangeTimes->{{3.876812413509255*^9, 3.876812446625444*^9}, {
   3.8768151780453176`*^9, 3.876815209826783*^9}, {3.876815248184267*^9, 
   3.876815459023869*^9}, {3.876903788012329*^9, 3.876903800010339*^9}, 
   3.876903833592887*^9, {3.8769747267733817`*^9, 3.8769747696600175`*^9}, {
   3.876974945230581*^9, 3.87697494797323*^9}, {3.876975152219054*^9, 
   3.8769751759939423`*^9}},
 CellLabel->
  "In[403]:=",ExpressionUUID->"5bf6d6f9-5e35-47a1-9d3f-07ba26e10740"],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
   RowBox[{"dot", "[", 
    RowBox[{
     RowBox[{"v", "[", "1", "]"}], ",", 
     RowBox[{"F", "[", "1", "]"}], ",", 
     RowBox[{"F", "[", "2", "]"}], ",", 
     RowBox[{"S", "[", "0", "]"}], ",", 
     RowBox[{"p", "[", "1", "]"}]}], "]"}], ",", 
   RowBox[{"dot", "[", 
    RowBox[{
     RowBox[{"v", "[", "1", "]"}], ",", 
     RowBox[{"F", "[", "1", "]"}], ",", 
     RowBox[{"S", "[", "0", "]"}], ",", 
     RowBox[{"F", "[", "2", "]"}], ",", 
     RowBox[{"p", "[", "1", "]"}]}], "]"}], ",", 
   RowBox[{"dot", "[", 
    RowBox[{
     RowBox[{"v", "[", "1", "]"}], ",", 
     RowBox[{"F", "[", "2", "]"}], ",", 
     RowBox[{"F", "[", "1", "]"}], ",", 
     RowBox[{"S", "[", "0", "]"}], ",", 
     RowBox[{"p", "[", "1", "]"}]}], "]"}], ",", 
   RowBox[{"dot", "[", 
    RowBox[{
     RowBox[{"v", "[", "1", "]"}], ",", 
     RowBox[{"F", "[", "2", "]"}], ",", 
     RowBox[{"S", "[", "0", "]"}], ",", 
     RowBox[{"F", "[", "1", "]"}], ",", 
     RowBox[{"p", "[", "1", "]"}]}], "]"}], ",", 
   RowBox[{"dot", "[", 
    RowBox[{
     RowBox[{"v", "[", "1", "]"}], ",", 
     RowBox[{"S", "[", "0", "]"}], ",", 
     RowBox[{"F", "[", "1", "]"}], ",", 
     RowBox[{"F", "[", "2", "]"}], ",", 
     RowBox[{"p", "[", "1", "]"}]}], "]"}], ",", 
   RowBox[{"dot", "[", 
    RowBox[{
     RowBox[{"v", "[", "1", "]"}], ",", 
     RowBox[{"S", "[", "0", "]"}], ",", 
     RowBox[{"F", "[", "2", "]"}], ",", 
     RowBox[{"F", "[", "1", "]"}], ",", 
     RowBox[{"p", "[", "1", "]"}]}], "]"}]}], "}"}]], "Output",
 CellChangeTimes->{{3.876975152736062*^9, 3.876975200630189*^9}, 
   3.877148450560214*^9},
 CellLabel->
  "Out[403]=",ExpressionUUID->"72864c36-b95a-486b-a9e6-e0fed04b78b2"],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
   RowBox[{"dot", "[", 
    RowBox[{
     RowBox[{"v", "[", "1", "]"}], ",", 
     RowBox[{"F", "[", "1", "]"}], ",", 
     RowBox[{"F", "[", "2", "]"}], ",", 
     RowBox[{"S", "[", "0", "]"}], ",", 
     RowBox[{"p", "[", "2", "]"}]}], "]"}], ",", 
   RowBox[{"dot", "[", 
    RowBox[{
     RowBox[{"v", "[", "1", "]"}], ",", 
     RowBox[{"F", "[", "1", "]"}], ",", 
     RowBox[{"S", "[", "0", "]"}], ",", 
     RowBox[{"F", "[", "2", "]"}], ",", 
     RowBox[{"p", "[", "2", "]"}]}], "]"}], ",", 
   RowBox[{"dot", "[", 
    RowBox[{
     RowBox[{"v", "[", "1", "]"}], ",", 
     RowBox[{"F", "[", "2", "]"}], ",", 
     RowBox[{"F", "[", "1", "]"}], ",", 
     RowBox[{"S", "[", "0", "]"}], ",", 
     RowBox[{"p", "[", "2", "]"}]}], "]"}], ",", 
   RowBox[{"dot", "[", 
    RowBox[{
     RowBox[{"v", "[", "1", "]"}], ",", 
     RowBox[{"F", "[", "2", "]"}], ",", 
     RowBox[{"S", "[", "0", "]"}], ",", 
     RowBox[{"F", "[", "1", "]"}], ",", 
     RowBox[{"p", "[", "2", "]"}]}], "]"}], ",", 
   RowBox[{"dot", "[", 
    RowBox[{
     RowBox[{"v", "[", "1", "]"}], ",", 
     RowBox[{"S", "[", "0", "]"}], ",", 
     RowBox[{"F", "[", "1", "]"}], ",", 
     RowBox[{"F", "[", "2", "]"}], ",", 
     RowBox[{"p", "[", "2", "]"}]}], "]"}], ",", 
   RowBox[{"dot", "[", 
    RowBox[{
     RowBox[{"v", "[", "1", "]"}], ",", 
     RowBox[{"S", "[", "0", "]"}], ",", 
     RowBox[{"F", "[", "2", "]"}], ",", 
     RowBox[{"F", "[", "1", "]"}], ",", 
     RowBox[{"p", "[", "2", "]"}]}], "]"}]}], "}"}]], "Output",
 CellChangeTimes->{{3.876975152736062*^9, 3.876975200630189*^9}, 
   3.8771484505634108`*^9},
 CellLabel->
  "Out[404]=",ExpressionUUID->"224c0302-ce2c-4512-abeb-899918e70c45"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{
  RowBox[{"monosLin", "=", 
   RowBox[{
    RowBox[{
     RowBox[{
      RowBox[{
       RowBox[{"Table", "[", 
        RowBox[{
         RowBox[{"lsLin", "[", "i", "]"}], ",", 
         RowBox[{"{", 
          RowBox[{"i", ",", "2"}], "}"}]}], "]"}], "//.", "dotRules"}], "/.", 
      
      RowBox[{
       RowBox[{"a_", " ", "b_"}], "\[RuleDelayed]", " ", 
       RowBox[{"b", "/;", 
        RowBox[{"NumericQ", "[", "a", "]"}]}]}]}], "//", "Flatten"}], "//", 
    "Union"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{"monosLin", "=", 
  RowBox[{"Drop", "[", 
   RowBox[{
    RowBox[{
     RowBox[{"monosLin", "//.", "dotRules"}], "//", "DeleteDuplicates"}], ",",
     "1"}], "]"}]}], "\[IndentingNewLine]", 
 RowBox[{"monosLin", "//", "Length"}]}], "Input",
 CellChangeTimes->{{3.876815464596685*^9, 3.87681553607375*^9}, {
   3.8769035691176505`*^9, 3.876903573038229*^9}, {3.876903613186469*^9, 
   3.8769036142339144`*^9}, {3.87690370426345*^9, 3.8769037061368523`*^9}, 
   3.8769060372666993`*^9, {3.8769060865193963`*^9, 3.8769061296745872`*^9}, 
   3.876974797403838*^9, {3.8769748341109653`*^9, 3.8769748471354456`*^9}, 
   3.876975181110139*^9, {3.876975325713999*^9, 3.876975341159255*^9}, {
   3.877148461914616*^9, 3.877148471509446*^9}, {3.877148504122744*^9, 
   3.877148511292746*^9}},
 CellLabel->
  "In[413]:=",ExpressionUUID->"dd7d8f36-e959-4cbf-bc55-befb87d2ac18"],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
   RowBox[{"dot", "[", 
    RowBox[{
     RowBox[{"p", "[", "1", "]"}], ",", 
     RowBox[{"F", "[", "2", "]"}], ",", 
     RowBox[{"S", "[", "0", "]"}], ",", 
     RowBox[{"F", "[", "1", "]"}], ",", 
     RowBox[{"v", "[", "1", "]"}]}], "]"}], ",", 
   RowBox[{"dot", "[", 
    RowBox[{
     RowBox[{"p", "[", "1", "]"}], ",", 
     RowBox[{"S", "[", "0", "]"}], ",", 
     RowBox[{"F", "[", "1", "]"}], ",", 
     RowBox[{"F", "[", "2", "]"}], ",", 
     RowBox[{"v", "[", "1", "]"}]}], "]"}], ",", 
   RowBox[{"dot", "[", 
    RowBox[{
     RowBox[{"p", "[", "1", "]"}], ",", 
     RowBox[{"S", "[", "0", "]"}], ",", 
     RowBox[{"F", "[", "2", "]"}], ",", 
     RowBox[{"F", "[", "1", "]"}], ",", 
     RowBox[{"v", "[", "1", "]"}]}], "]"}], ",", 
   RowBox[{"dot", "[", 
    RowBox[{
     RowBox[{"p", "[", "2", "]"}], ",", 
     RowBox[{"F", "[", "1", "]"}], ",", 
     RowBox[{"S", "[", "0", "]"}], ",", 
     RowBox[{"F", "[", "2", "]"}], ",", 
     RowBox[{"v", "[", "1", "]"}]}], "]"}], ",", 
   RowBox[{"dot", "[", 
    RowBox[{
     RowBox[{"p", "[", "2", "]"}], ",", 
     RowBox[{"S", "[", "0", "]"}], ",", 
     RowBox[{"F", "[", "1", "]"}], ",", 
     RowBox[{"F", "[", "2", "]"}], ",", 
     RowBox[{"v", "[", "1", "]"}]}], "]"}], ",", 
   RowBox[{"dot", "[", 
    RowBox[{
     RowBox[{"p", "[", "2", "]"}], ",", 
     RowBox[{"S", "[", "0", "]"}], ",", 
     RowBox[{"F", "[", "2", "]"}], ",", 
     RowBox[{"F", "[", "1", "]"}], ",", 
     RowBox[{"v", "[", "1", "]"}]}], "]"}]}], "}"}]], "Output",
 CellChangeTimes->{
  3.8769748479178033`*^9, 3.8769749362095423`*^9, 3.876975181482128*^9, 
   3.8769752161074576`*^9, 3.8769753432721415`*^9, 3.877148452990889*^9, {
   3.877148499065241*^9, 3.877148511741116*^9}},
 CellLabel->
  "Out[414]=",ExpressionUUID->"c8b9cd23-0c0b-4ecc-9d69-396e6e5698e8"],

Cell[BoxData["6"], "Output",
 CellChangeTimes->{
  3.8769748479178033`*^9, 3.8769749362095423`*^9, 3.876975181482128*^9, 
   3.8769752161074576`*^9, 3.8769753432721415`*^9, 3.877148452990889*^9, {
   3.877148499065241*^9, 3.877148511743754*^9}},
 CellLabel->
  "Out[415]=",ExpressionUUID->"ad73bc89-7162-4dc0-9b5d-2eb0b1d5255d"]
}, Open  ]],

Cell[BoxData[
 RowBox[{
  RowBox[{"AnsatzS1", "=", 
   RowBox[{"monosLin", ".", 
    RowBox[{"c", "/@", 
     RowBox[{"Range", "[", 
      RowBox[{"Length", "[", "monosLin", "]"}], "]"}]}]}]}], ";"}]], "Input",
 CellChangeTimes->{{3.8769749242466536`*^9, 3.8769749267804203`*^9}, {
   3.8769753632777014`*^9, 3.8769753676153727`*^9}, 3.876976731442774*^9, 
   3.8769768052951393`*^9},
 CellLabel->
  "In[416]:=",ExpressionUUID->"993026c1-1a39-4c23-8fdc-deb6cf675bfd"],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{"CutP12S1", "=", 
  RowBox[{
   RowBox[{
    RowBox[{"dot", "[", 
     RowBox[{
      RowBox[{"\[Epsilon]", "[", "2", "]"}], ",", 
      RowBox[{"p", "[", "1", "]"}]}], "]"}], "*", 
    RowBox[{"dot", "[", 
     RowBox[{
      RowBox[{
       RowBox[{"p", "[", "1", "]"}], "+", 
       RowBox[{"p", "[", "2", "]"}]}], ",", 
      RowBox[{"S", "[", "0", "]"}], ",", 
      RowBox[{"\[Epsilon]", "[", "1", "]"}]}], "]"}]}], "-", 
   RowBox[{
    RowBox[{"dot", "[", 
     RowBox[{
      RowBox[{"\[Epsilon]", "[", "1", "]"}], ",", 
      RowBox[{"p", "[", "2", "]"}]}], "]"}], "*", 
    RowBox[{"dot", "[", 
     RowBox[{
      RowBox[{
       RowBox[{"p", "[", "1", "]"}], "+", 
       RowBox[{"p", "[", "2", "]"}]}], ",", 
      RowBox[{"S", "[", "0", "]"}], ",", 
      RowBox[{"\[Epsilon]", "[", "2", "]"}]}], "]"}]}], "+", 
   RowBox[{
    RowBox[{"dot", "[", 
     RowBox[{
      RowBox[{"\[Epsilon]", "[", "1", "]"}], ",", 
      RowBox[{"\[Epsilon]", "[", "2", "]"}]}], "]"}], "*", 
    RowBox[{"dot", "[", 
     RowBox[{
      RowBox[{"p", "[", "1", "]"}], ",", 
      RowBox[{"S", "[", "0", "]"}], ",", 
      RowBox[{"p", "[", "2", "]"}]}], "]"}]}]}]}], "\[IndentingNewLine]", 
 RowBox[{"Cutv1S1", "=", 
  RowBox[{
   RowBox[{
    RowBox[{"dot", "[", 
     RowBox[{
      RowBox[{"p", "[", "1", "]"}], ",", 
      RowBox[{"S", "[", "0", "]"}], ",", 
      RowBox[{"\[Epsilon]", "[", "1", "]"}]}], "]"}], "*", 
    RowBox[{"dot", "[", 
     RowBox[{
      RowBox[{"v", "[", "1", "]"}], ",", 
      RowBox[{"\[Epsilon]", "[", "2", "]"}]}], "]"}]}], "+", 
   RowBox[{
    RowBox[{"dot", "[", 
     RowBox[{
      RowBox[{"p", "[", "2", "]"}], ",", 
      RowBox[{"S", "[", "0", "]"}], ",", 
      RowBox[{"\[Epsilon]", "[", "2", "]"}]}], "]"}], "*", 
    RowBox[{"dot", "[", 
     RowBox[{
      RowBox[{"v", "[", "1", "]"}], ",", 
      RowBox[{"\[Epsilon]", "[", "1", "]"}]}], "]"}]}]}]}]}], "Input",
 CellChangeTimes->{{3.876975414912524*^9, 3.876975459248967*^9}, {
   3.8769755613771677`*^9, 3.8769755886175785`*^9}, {3.876976085186249*^9, 
   3.876976107614584*^9}, 3.8769768085910482`*^9, {3.8769771725484114`*^9, 
   3.876977174209174*^9}, {3.876977243610744*^9, 3.876977249333793*^9}, {
   3.876977585835874*^9, 3.87697758918334*^9}},
 CellLabel->
  "In[417]:=",ExpressionUUID->"f9f88817-7e4b-4ea2-840f-92251afc60ae"],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"dot", "[", 
    RowBox[{
     RowBox[{"\[Epsilon]", "[", "1", "]"}], ",", 
     RowBox[{"\[Epsilon]", "[", "2", "]"}]}], "]"}], " ", 
   RowBox[{"dot", "[", 
    RowBox[{
     RowBox[{"p", "[", "1", "]"}], ",", 
     RowBox[{"S", "[", "0", "]"}], ",", 
     RowBox[{"p", "[", "2", "]"}]}], "]"}]}], "+", 
  RowBox[{
   RowBox[{"dot", "[", 
    RowBox[{
     RowBox[{"p", "[", "1", "]"}], ",", 
     RowBox[{"\[Epsilon]", "[", "2", "]"}]}], "]"}], " ", 
   RowBox[{"(", 
    RowBox[{
     RowBox[{"dot", "[", 
      RowBox[{
       RowBox[{"p", "[", "1", "]"}], ",", 
       RowBox[{"S", "[", "0", "]"}], ",", 
       RowBox[{"\[Epsilon]", "[", "1", "]"}]}], "]"}], "+", 
     RowBox[{"dot", "[", 
      RowBox[{
       RowBox[{"p", "[", "2", "]"}], ",", 
       RowBox[{"S", "[", "0", "]"}], ",", 
       RowBox[{"\[Epsilon]", "[", "1", "]"}]}], "]"}]}], ")"}]}], "-", 
  RowBox[{
   RowBox[{"dot", "[", 
    RowBox[{
     RowBox[{"p", "[", "2", "]"}], ",", 
     RowBox[{"\[Epsilon]", "[", "1", "]"}]}], "]"}], " ", 
   RowBox[{"(", 
    RowBox[{
     RowBox[{"dot", "[", 
      RowBox[{
       RowBox[{"p", "[", "1", "]"}], ",", 
       RowBox[{"S", "[", "0", "]"}], ",", 
       RowBox[{"\[Epsilon]", "[", "2", "]"}]}], "]"}], "+", 
     RowBox[{"dot", "[", 
      RowBox[{
       RowBox[{"p", "[", "2", "]"}], ",", 
       RowBox[{"S", "[", "0", "]"}], ",", 
       RowBox[{"\[Epsilon]", "[", "2", "]"}]}], "]"}]}], ")"}]}]}]], "Output",\

 CellChangeTimes->{3.8769768096232104`*^9, 3.876977174978958*^9, 
  3.8769772496599627`*^9, 3.876977589678454*^9, 3.8771485216535873`*^9},
 CellLabel->
  "Out[417]=",ExpressionUUID->"d6c764d0-5ff7-48fc-9af0-c479c09d87ed"],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"dot", "[", 
    RowBox[{
     RowBox[{"v", "[", "1", "]"}], ",", 
     RowBox[{"\[Epsilon]", "[", "2", "]"}]}], "]"}], " ", 
   RowBox[{"dot", "[", 
    RowBox[{
     RowBox[{"p", "[", "1", "]"}], ",", 
     RowBox[{"S", "[", "0", "]"}], ",", 
     RowBox[{"\[Epsilon]", "[", "1", "]"}]}], "]"}]}], "+", 
  RowBox[{
   RowBox[{"dot", "[", 
    RowBox[{
     RowBox[{"v", "[", "1", "]"}], ",", 
     RowBox[{"\[Epsilon]", "[", "1", "]"}]}], "]"}], " ", 
   RowBox[{"dot", "[", 
    RowBox[{
     RowBox[{"p", "[", "2", "]"}], ",", 
     RowBox[{"S", "[", "0", "]"}], ",", 
     RowBox[{"\[Epsilon]", "[", "2", "]"}]}], "]"}]}]}]], "Output",
 CellChangeTimes->{3.8769768096232104`*^9, 3.876977174978958*^9, 
  3.8769772496599627`*^9, 3.876977589678454*^9, 3.8771485216565723`*^9},
 CellLabel->
  "Out[418]=",ExpressionUUID->"550de858-c937-44ce-8840-04ce4593af65"]
}, Open  ]],

Cell[BoxData[{
 RowBox[{
  RowBox[{"ConditionP12S1", "=", 
   RowBox[{
    RowBox[{"(", 
     RowBox[{
      RowBox[{"(", 
       RowBox[{"AnsatzS1", "//.", 
        RowBox[{"{", 
         RowBox[{
          RowBox[{
           RowBox[{"dot", "[", 
            RowBox[{"x__", ",", 
             RowBox[{"F", "[", "c_", "]"}], ",", "y__"}], "]"}], 
           "\[RuleDelayed]", 
           RowBox[{
            RowBox[{
             RowBox[{"dot", "[", 
              RowBox[{"x", ",", 
               RowBox[{"p", "[", "c", "]"}]}], "]"}], "*", 
             RowBox[{"dot", "[", 
              RowBox[{
               RowBox[{"\[Epsilon]", "[", "c", "]"}], ",", "y"}], "]"}]}], 
            "-", 
            RowBox[{
             RowBox[{"dot", "[", 
              RowBox[{"x", ",", 
               RowBox[{"\[Epsilon]", "[", "c", "]"}]}], "]"}], "*", 
             RowBox[{"dot", "[", 
              RowBox[{
               RowBox[{"p", "[", "c", "]"}], ",", "y"}], "]"}]}]}]}], " ", 
          ",", 
          RowBox[{
           RowBox[{"dot", "[", 
            RowBox[{
             RowBox[{"p", "[", "1", "]"}], ",", 
             RowBox[{"p", "[", "2", "]"}]}], "]"}], "\[RuleDelayed]", "0"}], 
          ",", 
          RowBox[{
           RowBox[{"dot", "[", 
            RowBox[{
             RowBox[{"v", "[", "1", "]"}], ",", 
             RowBox[{"p", "[", "2", "]"}]}], "]"}], "\[RuleDelayed]", 
           RowBox[{"-", 
            RowBox[{"dot", "[", 
             RowBox[{
              RowBox[{"v", "[", "1", "]"}], ",", 
              RowBox[{"p", "[", "1", "]"}]}], "]"}]}]}]}], "}"}]}], ")"}], 
      "\[Equal]", 
      RowBox[{"4", "*", 
       RowBox[{"dot", "[", 
        RowBox[{
         RowBox[{"v", "[", "1", "]"}], ",", 
         RowBox[{"p", "[", "1", "]"}]}], "]"}], "*", "CutP12S1"}]}], ")"}], "//.",
     "dotRules"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"Conditionv1S1", "=", 
   RowBox[{
    RowBox[{"(", 
     RowBox[{
      RowBox[{"(", 
       RowBox[{"AnsatzS1", "//.", 
        RowBox[{"{", 
         RowBox[{
          RowBox[{
           RowBox[{"dot", "[", 
            RowBox[{"x__", ",", 
             RowBox[{"F", "[", "c_", "]"}], ",", "y__"}], "]"}], 
           "\[RuleDelayed]", 
           RowBox[{
            RowBox[{
             RowBox[{"dot", "[", 
              RowBox[{"x", ",", 
               RowBox[{"p", "[", "c", "]"}]}], "]"}], "*", 
             RowBox[{"dot", "[", 
              RowBox[{
               RowBox[{"\[Epsilon]", "[", "c", "]"}], ",", "y"}], "]"}]}], 
            "-", 
            RowBox[{
             RowBox[{"dot", "[", 
              RowBox[{"x", ",", 
               RowBox[{"\[Epsilon]", "[", "c", "]"}]}], "]"}], "*", 
             RowBox[{"dot", "[", 
              RowBox[{
               RowBox[{"p", "[", "c", "]"}], ",", "y"}], "]"}]}]}]}], " ", 
          ",", 
          RowBox[{
           RowBox[{"dot", "[", 
            RowBox[{
             RowBox[{"v", "[", "1", "]"}], ",", 
             RowBox[{"p", "[", "1", "]"}]}], "]"}], "\[RuleDelayed]", "0"}], 
          ",", 
          RowBox[{
           RowBox[{"dot", "[", 
            RowBox[{
             RowBox[{"v", "[", "1", "]"}], ",", 
             RowBox[{"p", "[", "2", "]"}]}], "]"}], "\[RuleDelayed]", "0"}]}],
          "}"}]}], ")"}], "\[Equal]", 
      RowBox[{"4", "*", 
       RowBox[{"dot", "[", 
        RowBox[{
         RowBox[{"p", "[", "1", "]"}], ",", 
         RowBox[{"p", "[", "2", "]"}]}], "]"}], "*", "Cutv1S1"}]}], ")"}], "//.",
     "dotRules"}]}], ";"}]}], "Input",
 CellChangeTimes->{{3.876804807502169*^9, 3.876804854711794*^9}, {
   3.8768049043670673`*^9, 3.8768049914763055`*^9}, {3.8768050723352256`*^9, 
   3.876805098305267*^9}, {3.876809417474665*^9, 3.876809424566101*^9}, {
   3.876809477232671*^9, 3.876809487478401*^9}, 3.87690460783605*^9, {
   3.876904667620144*^9, 3.8769046984640236`*^9}, 3.8769048213347187`*^9, {
   3.87690540425039*^9, 3.8769054087673817`*^9}, {3.876905748635273*^9, 
   3.876905778926565*^9}, {3.8769062057271214`*^9, 3.8769062253885317`*^9}, {
   3.876906312926511*^9, 3.87690632122423*^9}, {3.8769064427458625`*^9, 
   3.876906452500059*^9}, {3.87690649157626*^9, 3.8769065441165667`*^9}, 
   3.8769110209126277`*^9, {3.8769159052194324`*^9, 3.8769159260071707`*^9}, 
   3.87691686167654*^9, 3.8769171800375423`*^9, 3.8769178149296103`*^9, 
   3.876918120148666*^9, {3.876975645382007*^9, 3.8769756705031204`*^9}, {
   3.8769758698728957`*^9, 3.8769758898899956`*^9}, 3.876976023355688*^9, 
   3.876977120457833*^9, {3.877148528207342*^9, 3.877148532677885*^9}},
 CellLabel->
  "In[421]:=",ExpressionUUID->"cf6beb24-72ce-4227-b911-e4b4baf727a9"],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"vardotLin", "=", 
  RowBox[{
   RowBox[{"{", 
    RowBox[{"ConditionP12S1", ",", "Conditionv1S1"}], "}"}], "//", 
   "Casesdot"}]}]], "Input",
 CellChangeTimes->{{3.8769048304197536`*^9, 3.876904931089441*^9}, {
  3.876910909557077*^9, 3.876910924016588*^9}, {3.8769110340796533`*^9, 
  3.8769110387942677`*^9}, {3.876915766390431*^9, 3.87691588730823*^9}, {
  3.876917041384816*^9, 3.876917055358569*^9}, {3.8769757087923374`*^9, 
  3.876975712232633*^9}, {3.8769765146709023`*^9, 3.8769765164315205`*^9}, {
  3.876976888022575*^9, 3.876976895949725*^9}},
 CellLabel->
  "In[423]:=",ExpressionUUID->"48866608-5ae8-466b-8ec0-b2fd44176bf2"],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
   RowBox[{"dot", "[", 
    RowBox[{
     RowBox[{"p", "[", "1", "]"}], ",", 
     RowBox[{"p", "[", "2", "]"}]}], "]"}], ",", 
   RowBox[{"dot", "[", 
    RowBox[{
     RowBox[{"p", "[", "1", "]"}], ",", 
     RowBox[{"v", "[", "1", "]"}]}], "]"}], ",", 
   RowBox[{"dot", "[", 
    RowBox[{
     RowBox[{"p", "[", "1", "]"}], ",", 
     RowBox[{"\[Epsilon]", "[", "2", "]"}]}], "]"}], ",", 
   RowBox[{"dot", "[", 
    RowBox[{
     RowBox[{"p", "[", "2", "]"}], ",", 
     RowBox[{"\[Epsilon]", "[", "1", "]"}]}], "]"}], ",", 
   RowBox[{"dot", "[", 
    RowBox[{
     RowBox[{"v", "[", "1", "]"}], ",", 
     RowBox[{"\[Epsilon]", "[", "1", "]"}]}], "]"}], ",", 
   RowBox[{"dot", "[", 
    RowBox[{
     RowBox[{"v", "[", "1", "]"}], ",", 
     RowBox[{"\[Epsilon]", "[", "2", "]"}]}], "]"}], ",", 
   RowBox[{"dot", "[", 
    RowBox[{
     RowBox[{"\[Epsilon]", "[", "1", "]"}], ",", 
     RowBox[{"\[Epsilon]", "[", "2", "]"}]}], "]"}], ",", 
   RowBox[{"dot", "[", 
    RowBox[{
     RowBox[{"p", "[", "1", "]"}], ",", 
     RowBox[{"S", "[", "0", "]"}], ",", 
     RowBox[{"p", "[", "2", "]"}]}], "]"}], ",", 
   RowBox[{"dot", "[", 
    RowBox[{
     RowBox[{"p", "[", "1", "]"}], ",", 
     RowBox[{"S", "[", "0", "]"}], ",", 
     RowBox[{"\[Epsilon]", "[", "1", "]"}]}], "]"}], ",", 
   RowBox[{"dot", "[", 
    RowBox[{
     RowBox[{"p", "[", "1", "]"}], ",", 
     RowBox[{"S", "[", "0", "]"}], ",", 
     RowBox[{"\[Epsilon]", "[", "2", "]"}]}], "]"}], ",", 
   RowBox[{"dot", "[", 
    RowBox[{
     RowBox[{"p", "[", "2", "]"}], ",", 
     RowBox[{"S", "[", "0", "]"}], ",", 
     RowBox[{"\[Epsilon]", "[", "1", "]"}]}], "]"}], ",", 
   RowBox[{"dot", "[", 
    RowBox[{
     RowBox[{"p", "[", "2", "]"}], ",", 
     RowBox[{"S", "[", "0", "]"}], ",", 
     RowBox[{"\[Epsilon]", "[", "2", "]"}]}], "]"}]}], "}"}]], "Output",
 CellChangeTimes->{3.876975712953018*^9, 3.876975749614687*^9, 
  3.876976153324094*^9, 3.876976517312555*^9, 3.8769768973890395`*^9, 
  3.8769771809372606`*^9, 3.8769776054869337`*^9, 3.877148535938327*^9},
 CellLabel->
  "Out[423]=",ExpressionUUID->"da5958ee-cf51-4458-bc64-4fdf57c0ade7"]
}, Open  ]],

Cell[BoxData[
 RowBox[{"dot2numLin", ":=", 
  RowBox[{"Table", "[", 
   RowBox[{
    RowBox[{"Rule", "[", 
     RowBox[{
      RowBox[{"vardotLin", "[", 
       RowBox[{"[", "ii", "]"}], "]"}], ",", 
      RowBox[{"RandomInteger", "[", 
       RowBox[{"{", 
        RowBox[{"10", ",", "100"}], "}"}], "]"}]}], "]"}], ",", 
    RowBox[{"{", 
     RowBox[{"ii", ",", 
      RowBox[{"Length", "[", "vardotLin", "]"}]}], "}"}]}], "]"}]}]], "Input",\

 CellChangeTimes->{{3.8769049503980417`*^9, 3.876904969008238*^9}, {
  3.8769050305446887`*^9, 3.87690508374227*^9}, {3.876905113814046*^9, 
  3.876905213992666*^9}, {3.876975783539343*^9, 3.8769757914124174`*^9}},
 CellLabel->
  "In[424]:=",ExpressionUUID->"0eb9ac48-0f9d-4422-bf6a-6860246c6023"],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{
  RowBox[{"eqLin", "=", 
   RowBox[{"Flatten", "[", 
    RowBox[{"Table", "[", 
     RowBox[{
      RowBox[{
       RowBox[{"{", 
        RowBox[{"ConditionP12S1", ",", "Conditionv1S1", ",", 
         RowBox[{
          RowBox[{"(", 
           RowBox[{"AnsatzS1", "\[Equal]", 
            RowBox[{"(", 
             RowBox[{"AnsatzS1", "/.", 
              RowBox[{"{", 
               RowBox[{
                RowBox[{
                 RowBox[{"p", "[", "1", "]"}], "\[Rule]", 
                 RowBox[{"p", "[", "2", "]"}]}], ",", 
                RowBox[{
                 RowBox[{"p", "[", "2", "]"}], "\[Rule]", 
                 RowBox[{"p", "[", "1", "]"}]}], ",", 
                RowBox[{
                 RowBox[{"F", "[", "1", "]"}], "\[Rule]", 
                 RowBox[{"F", "[", "2", "]"}]}], ",", 
                RowBox[{
                 RowBox[{"F", "[", "2", "]"}], "\[Rule]", 
                 RowBox[{"F", "[", "1", "]"}]}]}], "}"}]}], ")"}]}], ")"}], "//.", 
          RowBox[{
           RowBox[{"dot", "[", 
            RowBox[{"x__", ",", 
             RowBox[{"F", "[", "c_", "]"}], ",", "y__"}], "]"}], 
           "\[RuleDelayed]", 
           RowBox[{
            RowBox[{
             RowBox[{"dot", "[", 
              RowBox[{"x", ",", 
               RowBox[{"p", "[", "c", "]"}]}], "]"}], "*", 
             RowBox[{"dot", "[", 
              RowBox[{
               RowBox[{"\[Epsilon]", "[", "c", "]"}], ",", "y"}], "]"}]}], 
            "-", 
            RowBox[{
             RowBox[{"dot", "[", 
              RowBox[{"x", ",", 
               RowBox[{"\[Epsilon]", "[", "c", "]"}]}], "]"}], "*", 
             RowBox[{"dot", "[", 
              RowBox[{
               RowBox[{"p", "[", "c", "]"}], ",", "y"}], "]"}]}]}]}]}]}], " ",
         "}"}], "/.", "dot2numLin"}], ",", "10"}], "]"}], "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{"sol", "=", 
  RowBox[{
   RowBox[{"Solve", "[", 
    RowBox[{"eqLin", ",", 
     RowBox[{"c", "/@", 
      RowBox[{"Range", "[", 
       RowBox[{"Length", "[", "monosLin", "]"}], "]"}]}]}], "]"}], "[", 
   RowBox[{"[", "1", "]"}], "]"}]}]}], "Input",
 CellChangeTimes->{{3.8769055068820367`*^9, 3.876905583185097*^9}, {
   3.876906396301323*^9, 3.8769064100444016`*^9}, {3.876911353345582*^9, 
   3.876911377768335*^9}, {3.876911416827297*^9, 3.8769114420941296`*^9}, {
   3.876911496711166*^9, 3.876911498942684*^9}, {3.8769159860434237`*^9, 
   3.8769159982850227`*^9}, {3.876917074032778*^9, 3.876917078747828*^9}, {
   3.876917835165763*^9, 3.876917836508628*^9}, {3.8769178893148384`*^9, 
   3.87691789538586*^9}, {3.8769179679615984`*^9, 3.8769179725550594`*^9}, {
   3.876918311991231*^9, 3.876918317019087*^9}, {3.8769758057083883`*^9, 
   3.876975854870823*^9}, {3.8769761744278817`*^9, 3.876976187673544*^9}, {
   3.876976394500575*^9, 3.876976417842675*^9}, {3.876976456110918*^9, 
   3.876976464837041*^9}, {3.876976616505371*^9, 3.876976623770048*^9}, {
   3.876976655642711*^9, 3.8769766954994483`*^9}, {3.876976906183344*^9, 
   3.8769769377416067`*^9}, 3.876976972904421*^9, {3.8769770137950554`*^9, 
   3.876977058511033*^9}, {3.876977193748454*^9, 3.876977203580162*^9}, 
   3.8769776108037977`*^9, {3.8769776442963037`*^9, 3.876977644433947*^9}, {
   3.876977820731237*^9, 3.8769779799442844`*^9}, {3.877148553283743*^9, 
   3.877148559966403*^9}},
 CellLabel->
  "In[429]:=",ExpressionUUID->"6c7e2e18-0cde-4e58-8435-505b5cd43295"],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
   RowBox[{
    RowBox[{"c", "[", "1", "]"}], "\[Rule]", "2"}], ",", 
   RowBox[{
    RowBox[{"c", "[", "2", "]"}], "\[Rule]", 
    RowBox[{"-", "4"}]}], ",", 
   RowBox[{
    RowBox[{"c", "[", "3", "]"}], "\[Rule]", 
    RowBox[{"-", "2"}]}], ",", 
   RowBox[{
    RowBox[{"c", "[", "4", "]"}], "\[Rule]", "2"}], ",", 
   RowBox[{
    RowBox[{"c", "[", "5", "]"}], "\[Rule]", 
    RowBox[{"-", "2"}]}], ",", 
   RowBox[{
    RowBox[{"c", "[", "6", "]"}], "\[Rule]", 
    RowBox[{"-", "4"}]}]}], "}"}]], "Output",
 CellChangeTimes->{{3.8769779159755945`*^9, 3.8769779245338326`*^9}, {
  3.876977975317402*^9, 3.8769779810017776`*^9}, {3.8771485467934*^9, 
  3.877148560677903*^9}},
 CellLabel->
  "Out[430]=",ExpressionUUID->"b45447b8-284c-4073-b653-415c7ef96235"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  RowBox[{"AnsatzS1", "/.", "sol"}], "//.", "nice"}]], "Input",
 CellChangeTimes->{{3.8769762851440015`*^9, 3.87697629748094*^9}, {
  3.876977664337679*^9, 3.876977727751904*^9}, {3.876977780424451*^9, 
  3.8769777828358507`*^9}, {3.8771485639803057`*^9, 3.8771485653724194`*^9}, {
  3.8771485988470182`*^9, 3.877148600412746*^9}},
 CellLabel->
  "In[432]:=",ExpressionUUID->"0c0db729-5a53-41e1-b692-9fc79ea58cd2"],

Cell[BoxData[
 RowBox[{
  RowBox[{"2", " ", 
   RowBox[{
    SubscriptBox["p", "1"], "\[CenterDot]", 
    SubscriptBox["F", "2"], "\[CenterDot]", 
    SubscriptBox["S", "0"], "\[CenterDot]", 
    SubscriptBox["F", "1"], "\[CenterDot]", 
    SubscriptBox["v", "1"]}]}], "-", 
  RowBox[{"4", " ", 
   RowBox[{
    SubscriptBox["p", "1"], "\[CenterDot]", 
    SubscriptBox["S", "0"], "\[CenterDot]", 
    SubscriptBox["F", "1"], "\[CenterDot]", 
    SubscriptBox["F", "2"], "\[CenterDot]", 
    SubscriptBox["v", "1"]}]}], "-", 
  RowBox[{"2", " ", 
   RowBox[{
    SubscriptBox["p", "1"], "\[CenterDot]", 
    SubscriptBox["S", "0"], "\[CenterDot]", 
    SubscriptBox["F", "2"], "\[CenterDot]", 
    SubscriptBox["F", "1"], "\[CenterDot]", 
    SubscriptBox["v", "1"]}]}], "+", 
  RowBox[{"2", " ", 
   RowBox[{
    SubscriptBox["p", "2"], "\[CenterDot]", 
    SubscriptBox["F", "1"], "\[CenterDot]", 
    SubscriptBox["S", "0"], "\[CenterDot]", 
    SubscriptBox["F", "2"], "\[CenterDot]", 
    SubscriptBox["v", "1"]}]}], "-", 
  RowBox[{"2", " ", 
   RowBox[{
    SubscriptBox["p", "2"], "\[CenterDot]", 
    SubscriptBox["S", "0"], "\[CenterDot]", 
    SubscriptBox["F", "1"], "\[CenterDot]", 
    SubscriptBox["F", "2"], "\[CenterDot]", 
    SubscriptBox["v", "1"]}]}], "-", 
  RowBox[{"4", " ", 
   RowBox[{
    SubscriptBox["p", "2"], "\[CenterDot]", 
    SubscriptBox["S", "0"], "\[CenterDot]", 
    SubscriptBox["F", "2"], "\[CenterDot]", 
    SubscriptBox["F", "1"], "\[CenterDot]", 
    SubscriptBox["v", "1"]}]}]}]], "Output",
 CellChangeTimes->{
  3.876976298156972*^9, {3.8769776722917037`*^9, 3.8769776973266134`*^9}, 
   3.8769777326475887`*^9, 3.8769777835117087`*^9, 3.877148566323194*^9, 
   3.877148600745364*^9},
 CellLabel->
  "Out[432]=",ExpressionUUID->"6c62b936-55ce-4eac-8887-dedea24f4b90"]
}, Open  ]]
}, Open  ]]
},
WindowSize->{1152, 586},
WindowMargins->{{34, Automatic}, {Automatic, 0}},
PrivateNotebookOptions->{"VersionedStylesheet"->{"Default.nb"[8.] -> False}},
TaggingRules->Association["TryRealOnly" -> False],
Magnification:>1.25 Inherited,
FrontEndVersion->"12.3 for Mac OS X x86 (64-bit) (June 19, 2021)",
StyleDefinitions->FrontEnd`FileName[{"Report"}, "StandardReport.nb", 
  CharacterEncoding -> "UTF-8"],
ExpressionUUID->"b8b22cab-2f3f-4c50-b7dc-f4a33feecd7e"
]
(* End of Notebook Content *)

(* Internal cache information *)
(*CellTagsOutline
CellTagsIndex->{}
*)
(*CellTagsIndex
CellTagsIndex->{}
*)
(*NotebookFileOutline
Notebook[{
Cell[CellGroupData[{
Cell[580, 22, 161, 3, 87, "Section",ExpressionUUID->"0441e687-3271-491a-8955-dd8d0f7cb479"],
Cell[CellGroupData[{
Cell[766, 29, 214, 5, 51, "Input",ExpressionUUID->"e15a1c17-2cfb-46a2-8aa9-607b0a62e713"],
Cell[983, 36, 312, 5, 51, "Output",ExpressionUUID->"cf1f6499-4222-45af-9908-6016b51414f4"]
}, Open  ]],
Cell[CellGroupData[{
Cell[1332, 46, 346, 7, 51, "Input",ExpressionUUID->"9e588303-12c7-48e0-b8a5-8c3c446f4c9f"],
Cell[1681, 55, 760, 16, 159, "Print",ExpressionUUID->"2d895c43-8c55-4131-9505-e1893a620d89"]
}, Open  ]],
Cell[CellGroupData[{
Cell[2478, 76, 1692, 34, 130, "Input",ExpressionUUID->"6e78fb49-dd55-4145-92f6-d81f0c875850"],
Cell[CellGroupData[{
Cell[4195, 114, 273, 5, 29, "Print",ExpressionUUID->"77c0d194-be3f-447c-b313-b74af744322a"],
Cell[4471, 121, 273, 5, 29, "Print",ExpressionUUID->"5d750e54-5717-404e-addb-1e8a678270ba"],
Cell[4747, 128, 275, 5, 29, "Print",ExpressionUUID->"43c1d0ec-e63e-4937-a4ae-937cbccf2d32"],
Cell[5025, 135, 284, 6, 29, "Print",ExpressionUUID->"e9f7ea1a-49b8-4ecf-97fe-86e9d4494dcd"],
Cell[5312, 143, 272, 5, 29, "Print",ExpressionUUID->"44f47853-2ddb-44e5-979c-041c30377738"],
Cell[5587, 150, 273, 5, 29, "Print",ExpressionUUID->"01008387-4f5d-46ec-8ded-e41f913556e5"],
Cell[5863, 157, 278, 6, 29, "Print",ExpressionUUID->"29d81112-9c58-4467-bc3a-6622836e630a"],
Cell[6144, 165, 274, 5, 29, "Print",ExpressionUUID->"43606068-d00d-4e7c-b0d8-6ae3639eb6ac"],
Cell[6421, 172, 284, 6, 29, "Print",ExpressionUUID->"2817b770-4a46-42a1-b02d-a2ec8f88687b"],
Cell[6708, 180, 282, 6, 29, "Print",ExpressionUUID->"19fd4d0b-b401-49e8-b859-fc3709b00e46"],
Cell[6993, 188, 282, 6, 29, "Print",ExpressionUUID->"45ecf272-b47b-4aba-a4d4-329118d9a62c"],
Cell[7278, 196, 282, 6, 29, "Print",ExpressionUUID->"b9e1d34d-49f5-46d0-8025-a1b03521f574"],
Cell[7563, 204, 284, 6, 29, "Print",ExpressionUUID->"8e65c99b-09a4-4ce0-bdec-50013074b3fb"]
}, Open  ]]
}, Open  ]]
}, Closed]],
Cell[CellGroupData[{
Cell[7908, 217, 157, 3, 68, "Section",ExpressionUUID->"b2a7b427-35e1-4c90-a40a-a7c43f50ca5a"],
Cell[CellGroupData[{
Cell[8090, 224, 169, 3, 42, "Subsection",ExpressionUUID->"b7909353-edfe-4489-b115-b6a172af6d7d"],
Cell[8262, 229, 1586, 48, 218, "Input",ExpressionUUID->"b0fdc6fd-2a5b-4d84-97a3-03bddc4e6893"],
Cell[9851, 279, 704, 18, 98, "Input",ExpressionUUID->"277d5114-6840-4b27-9460-eac0f86cbc2c"],
Cell[10558, 299, 856, 22, 98, "Input",ExpressionUUID->"ff95a306-8b51-46ee-8bc6-3e57f67ea494"],
Cell[11417, 323, 577, 14, 74, "Input",ExpressionUUID->"a76cbf43-accd-494d-bf74-aaf9211a3950"],
Cell[11997, 339, 571, 18, 49, "Input",ExpressionUUID->"2787e42e-631b-4f49-a71c-b7b0e075493a"],
Cell[12571, 359, 1665, 51, 146, "Input",ExpressionUUID->"b4037ea5-93ff-4f7e-a16c-2ab7e7c858e0"],
Cell[14239, 412, 4835, 117, 146, "Input",ExpressionUUID->"6d280527-7a65-48d0-a19d-73ee85d09955"],
Cell[19077, 531, 4532, 136, 314, "Input",ExpressionUUID->"0e2780f7-f3c5-41e4-a82a-2661c1254c1e"],
Cell[23612, 669, 1177, 31, 98, "Input",ExpressionUUID->"c9dd0306-42c7-4192-b891-8337c9f7440c"],
Cell[24792, 702, 2355, 73, 146, "Input",ExpressionUUID->"766abd2e-1994-4be7-9ee6-2a6d0f82c59e"],
Cell[27150, 777, 1201, 36, 122, "Input",ExpressionUUID->"f32e72bc-d9f0-4994-aff5-11032f993f2a"]
}, Closed]],
Cell[CellGroupData[{
Cell[28388, 818, 164, 3, 41, "Subsection",ExpressionUUID->"addba1f0-8dba-4a70-a842-39e531ea60a6"],
Cell[28555, 823, 7167, 197, 434, "Input",ExpressionUUID->"25d854a1-74df-4623-95a9-569a4bdc49f1"],
Cell[35725, 1022, 4535, 125, 386, "Input",ExpressionUUID->"2af12f84-7c89-4e30-937a-85d000898838"],
Cell[40263, 1149, 3431, 93, 290, "Input",ExpressionUUID->"15142c20-db64-48bf-b52c-91556a986f38"],
Cell[43697, 1244, 2472, 72, 242, "Input",ExpressionUUID->"ba6607b4-f910-41b9-a34a-add7b7d902e7"],
Cell[46172, 1318, 1541, 44, 170, "Input",ExpressionUUID->"870e16af-175f-49a6-8e68-b0b4c35c2c5a"],
Cell[47716, 1364, 1314, 31, 98, "Input",ExpressionUUID->"4ff24489-5806-4293-9306-aaa2b66eea5d"],
Cell[49033, 1397, 3080, 89, 405, "Input",ExpressionUUID->"81a5efa0-ef04-45ff-9f3b-5e98ec90a869"],
Cell[52116, 1488, 1231, 33, 98, "Input",ExpressionUUID->"33a60730-6445-4f31-9cf2-45d57b2b686f"],
Cell[53350, 1523, 615, 17, 74, "Input",ExpressionUUID->"a1b1b191-c013-4f68-83ee-98caf8c64ddd"],
Cell[53968, 1542, 2229, 57, 314, "Input",ExpressionUUID->"f282480a-e650-4eb4-9038-e3f85b2fe1b8"],
Cell[56200, 1601, 13009, 340, 602, "Input",ExpressionUUID->"ab70ed01-43b7-4b5f-98d1-c719b4ff3087"],
Cell[69212, 1943, 3201, 87, 259, "Input",ExpressionUUID->"53ad6521-8a3d-4870-b358-c6375ff69baf"],
Cell[72416, 2032, 2902, 82, 259, "Input",ExpressionUUID->"b2556c4a-ab65-4d73-834f-4614b803390f"],
Cell[75321, 2116, 7461, 145, 283, "Input",ExpressionUUID->"4500efcc-1d7c-4b91-892c-209688f51f02"]
}, Closed]],
Cell[CellGroupData[{
Cell[82819, 2266, 170, 3, 41, "Subsection",ExpressionUUID->"ca53f43b-0c6f-4f8f-9ad8-87cfea3279c2"],
Cell[82992, 2271, 2841, 87, 194, "Input",ExpressionUUID->"f8177a59-b548-4f5d-a062-3e46a97c4ed8"],
Cell[85836, 2360, 14241, 396, 1274, "Input",ExpressionUUID->"99fc1734-0a78-4f56-9085-9e1deef01c83"]
}, Closed]],
Cell[CellGroupData[{
Cell[100114, 2761, 173, 3, 41, "Subsection",ExpressionUUID->"a0b21b7b-22d9-43b7-b714-f04ca4b20753"],
Cell[100290, 2766, 6053, 143, 312, "Input",ExpressionUUID->"006014a7-50c8-4960-957b-36085fac27a6"],
Cell[CellGroupData[{
Cell[106368, 2913, 813, 22, 78, "Input",ExpressionUUID->"3ca232e2-f1dd-445d-93e3-49d2850803d9"],
Cell[107184, 2937, 1852, 54, 70, "Output",ExpressionUUID->"9a3272cb-df86-4212-b37c-7ae3cce05428"]
}, Open  ]]
}, Open  ]]
}, Closed]],
Cell[CellGroupData[{
Cell[109097, 2998, 216, 4, 68, "Section",ExpressionUUID->"920e92b2-f483-4633-8572-95f7ad2029ee"],
Cell[109316, 3004, 6808, 195, 624, "Input",ExpressionUUID->"a59468cd-400d-4953-be9d-1224995358e2"],
Cell[116127, 3201, 1460, 32, 104, "Input",ExpressionUUID->"b391ede9-be00-4b65-b0fd-aa1f912d39f2"],
Cell[117590, 3235, 1266, 37, 156, "Input",ExpressionUUID->"55f9f031-ef59-4843-b717-d41b3d5f725a"],
Cell[118859, 3274, 2943, 67, 234, "Input",ExpressionUUID->"c5bb3695-411a-4d6d-9a74-02514b7878ff"],
Cell[121805, 3343, 1165, 32, 194, "Input",ExpressionUUID->"7e5a8741-43ac-4327-aa5f-6dbd2093223d"],
Cell[122973, 3377, 4895, 132, 409, "Input",ExpressionUUID->"38b08510-db19-43f8-a58a-03d08123cfc5"],
Cell[127871, 3511, 640, 16, 104, "Input",ExpressionUUID->"44f39062-7878-4704-8ab1-b2a9233078bb"],
Cell[128514, 3529, 5796, 167, 364, "Input",ExpressionUUID->"26efa189-4ecc-4695-99da-a77c9b57d98f"],
Cell[CellGroupData[{
Cell[134335, 3700, 288, 7, 51, "Input",ExpressionUUID->"934c173a-881a-4ca9-a594-772bd9a53db2"],
Cell[134626, 3709, 289, 7, 51, "Output",ExpressionUUID->"62e23dab-ad2c-4ae7-9d63-9f08b967faf9"]
}, Open  ]],
Cell[CellGroupData[{
Cell[134952, 3721, 2302, 58, 231, "Input",ExpressionUUID->"0c0afbee-c8a3-4d27-9003-78320cd4e1a9"],
Cell[137257, 3781, 468, 8, 51, "Output",ExpressionUUID->"bdd5b96f-32f3-40c6-a79e-bd1cba03cdb1"]
}, Open  ]],
Cell[CellGroupData[{
Cell[137762, 3794, 403, 7, 51, "Input",ExpressionUUID->"17e02011-fbbf-4e66-acfa-aabc5f766a16"],
Cell[138168, 3803, 472, 7, 51, "Output",ExpressionUUID->"8b9d67ff-893a-4b60-837f-41d634cd7138"]
}, Open  ]],
Cell[CellGroupData[{
Cell[138677, 3815, 164, 3, 42, "Subsection",ExpressionUUID->"7653baa2-ef4d-42c2-af43-9880a084ec64"],
Cell[138844, 3820, 4595, 123, 182, "Input",ExpressionUUID->"7dd72b4c-0f96-4f4b-827f-86377f9880e9"],
Cell[143442, 3945, 7994, 201, 338, "Input",ExpressionUUID->"6086c4e5-aa05-44e1-a7a4-74f80b955047"],
Cell[CellGroupData[{
Cell[151461, 4150, 779, 14, 51, "Input",ExpressionUUID->"7b79ccb2-8175-4ae7-a7a2-84049633a276"],
Cell[152243, 4166, 2875, 71, 70, "Output",ExpressionUUID->"756c5133-59a0-4885-b1c0-0c85b3f9f863"]
}, Open  ]],
Cell[155133, 4240, 685, 18, 51, "Input",ExpressionUUID->"de57da47-77fb-4849-9458-e61712f47480"],
Cell[CellGroupData[{
Cell[155843, 4262, 2250, 42, 78, "Input",ExpressionUUID->"0c3df74f-542b-4666-91f6-0a140402b5a1"],
Cell[158096, 4306, 364, 9, 70, "Message",ExpressionUUID->"96716248-0655-40b1-9d45-93bd53e02b69"]
}, Open  ]],
Cell[CellGroupData[{
Cell[158497, 4320, 238, 5, 51, "Input",ExpressionUUID->"4b09d98b-4a70-40aa-ace2-592a248afd2d"],
Cell[158738, 4327, 24945, 694, 70, "Output",ExpressionUUID->"1821d9be-c9b7-49f7-b609-fafed1eeb36c"]
}, Open  ]]
}, Closed]]
}, Open  ]],
Cell[CellGroupData[{
Cell[183744, 5028, 172, 3, 87, "Section",ExpressionUUID->"604156b9-0508-4c7d-9a7a-b99be3f8fadc"],
Cell[CellGroupData[{
Cell[183941, 5035, 3366, 82, 208, "Input",ExpressionUUID->"832d4540-2bf7-4ffe-9b00-0f252f2a16a6"],
Cell[187310, 5119, 362, 9, 35, "Message",ExpressionUUID->"8309d1ea-5362-4789-8137-852f658b10f4"]
}, Open  ]],
Cell[187687, 5131, 1342, 29, 51, "Input",ExpressionUUID->"52a4114b-dbc6-433a-bace-c5ab1c9760b1"],
Cell[189032, 5162, 603, 15, 51, "Input",ExpressionUUID->"f009266d-2a0c-4915-b6e4-8508640255d7"],
Cell[189638, 5179, 2140, 53, 182, "Input",ExpressionUUID->"6eb6e71b-b46e-4096-9291-716b55353d57"]
}, Open  ]],
Cell[CellGroupData[{
Cell[191815, 5237, 151, 3, 87, "Section",ExpressionUUID->"919c4b49-f361-4762-8a29-65ab6d644e9f"],
Cell[CellGroupData[{
Cell[191991, 5244, 321, 8, 51, "Input",ExpressionUUID->"ed9ab052-8d0e-4de7-94d8-3b733fb035e6"],
Cell[192315, 5254, 780, 24, 73, "Output",ExpressionUUID->"63936d9a-8499-4680-a66f-34d2a2db27d1"]
}, Open  ]],
Cell[CellGroupData[{
Cell[193132, 5283, 597, 12, 51, "Input",ExpressionUUID->"68736b84-22e2-4a69-b663-130e9a97e8ff"],
Cell[193732, 5297, 6841, 199, 364, "Output",ExpressionUUID->"283c2ef4-b7f5-42d9-b224-9391276ec7f4"]
}, Open  ]],
Cell[200588, 5499, 6290, 178, 338, "Input",ExpressionUUID->"dbcba3a2-6089-4dae-98ff-ffb1ff1427d5"],
Cell[CellGroupData[{
Cell[206903, 5681, 268, 7, 51, "Input",ExpressionUUID->"57031058-2325-4520-94ef-c3cadeef8223"],
Cell[207174, 5690, 1920, 57, 104, "Output",ExpressionUUID->"c56d4950-5bba-4728-9b97-b6186de6c67d"]
}, Open  ]],
Cell[209109, 5750, 685, 18, 51, "Input",ExpressionUUID->"225ad3c0-431a-4dac-81dd-cf0e40ca950d"],
Cell[209797, 5770, 2354, 43, 78, "Input",ExpressionUUID->"718c5ea3-2241-4807-bfe1-7f91077797d9"],
Cell[CellGroupData[{
Cell[212176, 5817, 458, 12, 51, "Input",ExpressionUUID->"ab7eccfb-44ab-46f0-b2c2-bdf03c1bc860"],
Cell[212637, 5831, 1665, 44, 78, "Output",ExpressionUUID->"e686253b-d1ed-40db-8b41-b5f881260a4d"]
}, Open  ]]
}, Open  ]],
Cell[CellGroupData[{
Cell[214351, 5881, 157, 3, 87, "Section",ExpressionUUID->"978ab20d-9b77-4241-a461-c2278a7b6197"],
Cell[CellGroupData[{
Cell[214533, 5888, 742, 16, 78, "Input",ExpressionUUID->"ea11cd8b-fdb5-4dbe-83f0-fd34adb4a468"],
Cell[215278, 5906, 400, 11, 51, "Output",ExpressionUUID->"672bfae1-5003-4236-85f4-704ced242f30"]
}, Open  ]],
Cell[215693, 5920, 1856, 42, 182, "Input",ExpressionUUID->"bf72d32e-ccb2-4d95-92b4-a5ddafe2387c"],
Cell[CellGroupData[{
Cell[217574, 5966, 1071, 27, 78, "Input",ExpressionUUID->"5bf6d6f9-5e35-47a1-9d3f-07ba26e10740"],
Cell[218648, 5995, 1734, 48, 78, "Output",ExpressionUUID->"72864c36-b95a-486b-a9e6-e0fed04b78b2"],
Cell[220385, 6045, 1736, 48, 78, "Output",ExpressionUUID->"224c0302-ce2c-4512-abeb-899918e70c45"]
}, Open  ]],
Cell[CellGroupData[{
Cell[222158, 6098, 1411, 34, 104, "Input",ExpressionUUID->"dd7d8f36-e959-4cbf-bc55-befb87d2ac18"],
Cell[223572, 6134, 1859, 50, 78, "Output",ExpressionUUID->"c8b9cd23-0c0b-4ecc-9d69-396e6e5698e8"],
Cell[225434, 6186, 328, 6, 51, "Output",ExpressionUUID->"ad73bc89-7162-4dc0-9b5d-2eb0b1d5255d"]
}, Open  ]],
Cell[225777, 6195, 467, 11, 51, "Input",ExpressionUUID->"993026c1-1a39-4c23-8fdc-deb6cf675bfd"],
Cell[CellGroupData[{
Cell[226269, 6210, 2356, 65, 104, "Input",ExpressionUUID->"f9f88817-7e4b-4ea2-840f-92251afc60ae"],
Cell[228628, 6277, 1712, 50, 78, "Output",ExpressionUUID->"d6c764d0-5ff7-48fc-9af0-c479c09d87ed"],
Cell[230343, 6329, 908, 25, 51, "Output",ExpressionUUID->"550de858-c937-44ce-8840-04ce4593af65"]
}, Open  ]],
Cell[231266, 6357, 4681, 119, 208, "Input",ExpressionUUID->"cf6beb24-72ce-4227-b911-e4b4baf727a9"],
Cell[CellGroupData[{
Cell[235972, 6480, 663, 13, 51, "Input",ExpressionUUID->"48866608-5ae8-466b-8ec0-b2fd44176bf2"],
Cell[236638, 6495, 2175, 60, 104, "Output",ExpressionUUID->"da5958ee-cf51-4458-bc64-4fdf57c0ade7"]
}, Open  ]],
Cell[238828, 6558, 744, 19, 51, "Input",ExpressionUUID->"0eb9ac48-0f9d-4422-bf6a-6860246c6023"],
Cell[CellGroupData[{
Cell[239597, 6581, 3459, 77, 234, "Input",ExpressionUUID->"6c7e2e18-0cde-4e58-8435-505b5cd43295"],
Cell[243059, 6660, 804, 23, 51, "Output",ExpressionUUID->"b45447b8-284c-4073-b653-415c7ef96235"]
}, Open  ]],
Cell[CellGroupData[{
Cell[243900, 6688, 438, 8, 51, "Input",ExpressionUUID->"0c0db729-5a53-41e1-b692-9fc79ea58cd2"],
Cell[244341, 6698, 1814, 49, 78, "Output",ExpressionUUID->"6c62b936-55ce-4eac-8887-dedea24f4b90"]
}, Open  ]]
}, Open  ]]
}
]
*)

