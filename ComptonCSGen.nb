(* Content-type: application/vnd.wolfram.mathematica *)

(*** Wolfram Notebook File ***)
(* http://www.wolfram.com/nb *)

(* CreatedBy='Mathematica 10.0' *)

(*CacheID: 234*)
(* Internal cache information:
NotebookFileLineBreakTest
NotebookFileLineBreakTest
NotebookDataPosition[       158,          7]
NotebookDataLength[    596189,      16530]
NotebookOptionsPosition[    559294,      15944]
NotebookOutlinePosition[    559919,      15964]
CellTagsIndexPosition[    559876,      15961]
WindowFrame->Normal*)

(* Beginning of Notebook Content *)
Notebook[{

Cell[CellGroupData[{
Cell["Loading Packages", "Section",
 CellChangeTimes->{{3.851831445638886*^9, 
  3.851831451080901*^9}},ExpressionUUID->"0441e687-3271-491a-8955-\
dd8d0f7cb479"],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"SetDirectory", "[", 
  "\"\</Users/gangchen/Documents/GitHub/kinematicHopfAlgebra\>\"", 
  "]"}]], "Input",
 CellLabel->"In[1]:=",ExpressionUUID->"e15a1c17-2cfb-46a2-8aa9-607b0a62e713"],

Cell[BoxData["\<\"/Users/gangchen/Documents/GitHub/kinematicHopfAlgebra\"\>"],\
 "Output",
 CellChangeTimes->{{3.876903361280591*^9, 3.87690337645822*^9}, 
   3.876976886374969*^9, 3.8769769654479218`*^9, 3.8770661363411407`*^9, 
   3.8778209354595747`*^9, 3.8780069182245827`*^9, 3.87801160829534*^9, 
   3.8780156063397217`*^9, 3.8783569533644123`*^9, {3.878357018305354*^9, 
   3.8783570280744457`*^9}},
 CellLabel->"Out[1]=",ExpressionUUID->"b0170e05-585c-41aa-82a9-0f68e8713514"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"Get", "[", "\"\<KiHA.wl\>\"", "]"}]], "Input",
 CellChangeTimes->{
  3.857017232176591*^9, {3.871280778936686*^9, 3.8712807820748453`*^9}, {
   3.871880936625079*^9, 3.871881000526787*^9}, {3.876804060646309*^9, 
   3.876804061338099*^9}},
 CellLabel->"In[13]:=",ExpressionUUID->"9e588303-12c7-48e0-b8a5-8c3c446f4c9f"],

Cell["\<\
 KiHA(v1.6),Copyright 2022,author Gang Chen. It is licensed under the GNU \
General Public License v3.0.
 KiHA is based on the work of Kinematic Hopf Algebra in CTP of Queen Mary \
University of London.
 It generates the duality all-n numerator for colour-kinematic duality and \
double copy in heavy mass effective 
 theory(HEFT), Yang-Mills/Gravity theory and Yang-Mills-Scalar/Gravity-Scalar. 
 KiHA is built on some basic functions written by Gustav Mogull and Gregor \
Kaelin.
 use ?KiHA`* for help and a series of papers (2111.15649, 2208.05519, \
2208.05886) for more reference.\
\>", "Print",
 CellFrame->0.5,
 CellChangeTimes->{3.878357449666317*^9},
 FontColor->RGBColor[
  0, 0, 1],ExpressionUUID->"45d594d9-699a-4eec-a71c-17f4cbac052a"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"Get", "[", "\"\<MultiVariateApart.wl\>\"", "]"}]], "Input",
 CellLabel->"In[3]:=",ExpressionUUID->"ffda9edb-2059-4574-84d1-b1affec10b4c"],

Cell["\<\
MultivariateApart -- Multivariate partial fractions. By Matthias Heller \
(maheller@students.uni-mainz.de) and Andreas von Manteuffel (vmante@msu.edu). \
Version 2021-01-18. Please see ?MultivariateApart and ?MultivariateApart`* \
for help.\
\>", "Print",
 CellFrame->0.5,
 CellChangeTimes->{3.8783570346768208`*^9},
 FontColor->RGBColor[
  0.09375, 0.26953125, 
   0.23046875],ExpressionUUID->"351d33eb-53f9-4db4-9a57-a3c5ee12c118"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{
  RowBox[{"Unprotect", "[", 
   RowBox[{"p", ",", "F", ",", "\[Epsilon]"}], "]"}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{"declareVectorHead", "[", 
  RowBox[{"{", 
   RowBox[{
   "p", ",", "q", ",", "l", ",", "\[Epsilon]", ",", "v", ",", "w", ",", 
    "link", ",", "as"}], "}"}], "]"}], "\[IndentingNewLine]", 
 RowBox[{"declareTensorHead", "[", 
  RowBox[{
   RowBox[{"{", 
    RowBox[{"F", ",", "H", ",", "W", ",", "V", ",", "S"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"\"\<rank\>\"", "\[Rule]", " ", "2"}], "}"}]}], 
  "]"}], "\[IndentingNewLine]", 
 RowBox[{"declareAntiTensorHead", "[", 
  RowBox[{"{", 
   RowBox[{"F", ",", "S"}], "}"}], "]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"Protect", "[", 
   RowBox[{"p", ",", "F", ",", "\[Epsilon]"}], "]"}], ";"}]}], "Input",
 CellChangeTimes->CompressedData["
1:eJxTTMoPSmViYGAQBWIQfVK+m4d7/RtHuy05vCA6Qvf3HBB948ul+SD6WBar
Ay+QXt5qDqaX5PtHaAPplk8RYPpNtwST8qY3jhNu+4PpJvWNJ6U2v3H8MO04
mJb8Iug4F0jXBV4C06cK64Wzt7xxVLFaAqbXZJS+LtkKtCdyMpiep6bGMPHq
G0eLH3pgut5v5qVdQLqhdhuYFn0sE7kbSJvYmoDplD3pu02uvXE0cywF0zGG
P26+vA4Uf+p9D0R/yTuo+xZIs3Bv1gfRehu41bIfvXG86SQLpvOT33tOAtJd
l9m8QPTM246fQPSsmt+fQTRbWuHanY/fOAZZMawD0UUv3P8mPH3jOGnSMaZE
IN2bu1IdRLNNltYA0QCmQLSu
  "],
 CellLabel->"In[15]:=",ExpressionUUID->"6e78fb49-dd55-4145-92f6-d81f0c875850"],

Cell[CellGroupData[{

Cell[BoxData["\<\"p declared as a 4-dimensional vector header.\"\>"], "Print",
 CellChangeTimes->{
  3.876903376747521*^9, 3.876976978476327*^9, 3.877066136447813*^9, 
   3.877490032997962*^9, 3.877820935596715*^9, 3.878006918316052*^9, 
   3.878011608364133*^9, 3.878015606541864*^9, {3.878356953462988*^9, 
   3.8783569883214827`*^9}, 3.878357362355804*^9, 3.878357455855433*^9},
 CellLabel->
  "During evaluation of \
In[15]:=",ExpressionUUID->"248b3abd-9d8b-471e-99f5-97b984ec91b0"],

Cell[BoxData["\<\"q declared as a 4-dimensional vector header.\"\>"], "Print",
 CellChangeTimes->{
  3.876903376747521*^9, 3.876976978476327*^9, 3.877066136447813*^9, 
   3.877490032997962*^9, 3.877820935596715*^9, 3.878006918316052*^9, 
   3.878011608364133*^9, 3.878015606541864*^9, {3.878356953462988*^9, 
   3.8783569883214827`*^9}, 3.878357362355804*^9, 3.87835745585891*^9},
 CellLabel->
  "During evaluation of \
In[15]:=",ExpressionUUID->"47c5ca75-1d5f-4872-801c-8666232cb148"],

Cell[BoxData["\<\"l declared as a 4-dimensional vector header.\"\>"], "Print",
 CellChangeTimes->{
  3.876903376747521*^9, 3.876976978476327*^9, 3.877066136447813*^9, 
   3.877490032997962*^9, 3.877820935596715*^9, 3.878006918316052*^9, 
   3.878011608364133*^9, 3.878015606541864*^9, {3.878356953462988*^9, 
   3.8783569883214827`*^9}, 3.878357362355804*^9, 3.8783574558623133`*^9},
 CellLabel->
  "During evaluation of \
In[15]:=",ExpressionUUID->"1a95d653-8044-4976-aa96-4b84628e9350"],

Cell[BoxData["\<\"\[Epsilon] declared as a 4-dimensional vector \
header.\"\>"], "Print",
 CellChangeTimes->{
  3.876903376747521*^9, 3.876976978476327*^9, 3.877066136447813*^9, 
   3.877490032997962*^9, 3.877820935596715*^9, 3.878006918316052*^9, 
   3.878011608364133*^9, 3.878015606541864*^9, {3.878356953462988*^9, 
   3.8783569883214827`*^9}, 3.878357362355804*^9, 3.8783574558651533`*^9},
 CellLabel->
  "During evaluation of \
In[15]:=",ExpressionUUID->"6fbbe2d2-4c3b-4b9b-abce-46cc7dc00b5f"],

Cell[BoxData["\<\"v declared as a 4-dimensional vector header.\"\>"], "Print",
 CellChangeTimes->{
  3.876903376747521*^9, 3.876976978476327*^9, 3.877066136447813*^9, 
   3.877490032997962*^9, 3.877820935596715*^9, 3.878006918316052*^9, 
   3.878011608364133*^9, 3.878015606541864*^9, {3.878356953462988*^9, 
   3.8783569883214827`*^9}, 3.878357362355804*^9, 3.878357455867599*^9},
 CellLabel->
  "During evaluation of \
In[15]:=",ExpressionUUID->"802887a2-b5ab-4287-b0eb-4e59f8eff216"],

Cell[BoxData["\<\"w declared as a 4-dimensional vector header.\"\>"], "Print",
 CellChangeTimes->{
  3.876903376747521*^9, 3.876976978476327*^9, 3.877066136447813*^9, 
   3.877490032997962*^9, 3.877820935596715*^9, 3.878006918316052*^9, 
   3.878011608364133*^9, 3.878015606541864*^9, {3.878356953462988*^9, 
   3.8783569883214827`*^9}, 3.878357362355804*^9, 3.8783574558700542`*^9},
 CellLabel->
  "During evaluation of \
In[15]:=",ExpressionUUID->"4f6caa58-7bc6-4a52-8244-0b636a786050"],

Cell[BoxData["\<\"link declared as a 4-dimensional vector header.\"\>"], \
"Print",
 CellChangeTimes->{
  3.876903376747521*^9, 3.876976978476327*^9, 3.877066136447813*^9, 
   3.877490032997962*^9, 3.877820935596715*^9, 3.878006918316052*^9, 
   3.878011608364133*^9, 3.878015606541864*^9, {3.878356953462988*^9, 
   3.8783569883214827`*^9}, 3.878357362355804*^9, 3.878357455872505*^9},
 CellLabel->
  "During evaluation of \
In[15]:=",ExpressionUUID->"3cf1b7d1-a145-4a2c-b31f-eba853b291ef"],

Cell[BoxData["\<\"as declared as a 4-dimensional vector header.\"\>"], "Print",
 CellChangeTimes->{
  3.876903376747521*^9, 3.876976978476327*^9, 3.877066136447813*^9, 
   3.877490032997962*^9, 3.877820935596715*^9, 3.878006918316052*^9, 
   3.878011608364133*^9, 3.878015606541864*^9, {3.878356953462988*^9, 
   3.8783569883214827`*^9}, 3.878357362355804*^9, 3.8783574558747797`*^9},
 CellLabel->
  "During evaluation of \
In[15]:=",ExpressionUUID->"4bc3c7ff-b640-4d2a-8b86-ad6d69ca059b"],

Cell[BoxData["\<\"F declared as a 4-dimensional rank-2 tensor header.\"\>"], \
"Print",
 CellChangeTimes->{
  3.876903376747521*^9, 3.876976978476327*^9, 3.877066136447813*^9, 
   3.877490032997962*^9, 3.877820935596715*^9, 3.878006918316052*^9, 
   3.878011608364133*^9, 3.878015606541864*^9, {3.878356953462988*^9, 
   3.8783569883214827`*^9}, 3.878357362355804*^9, 3.8783574558767767`*^9},
 CellLabel->
  "During evaluation of \
In[15]:=",ExpressionUUID->"ac95acb0-e990-42ed-a3e2-ee2ac97478c1"],

Cell[BoxData["\<\"H declared as a 4-dimensional rank-2 tensor header.\"\>"], \
"Print",
 CellChangeTimes->{
  3.876903376747521*^9, 3.876976978476327*^9, 3.877066136447813*^9, 
   3.877490032997962*^9, 3.877820935596715*^9, 3.878006918316052*^9, 
   3.878011608364133*^9, 3.878015606541864*^9, {3.878356953462988*^9, 
   3.8783569883214827`*^9}, 3.878357362355804*^9, 3.878357455878628*^9},
 CellLabel->
  "During evaluation of \
In[15]:=",ExpressionUUID->"4db50724-0b86-4c89-8a30-13c68e3ca7cf"],

Cell[BoxData["\<\"W declared as a 4-dimensional rank-2 tensor header.\"\>"], \
"Print",
 CellChangeTimes->{
  3.876903376747521*^9, 3.876976978476327*^9, 3.877066136447813*^9, 
   3.877490032997962*^9, 3.877820935596715*^9, 3.878006918316052*^9, 
   3.878011608364133*^9, 3.878015606541864*^9, {3.878356953462988*^9, 
   3.8783569883214827`*^9}, 3.878357362355804*^9, 3.878357455880492*^9},
 CellLabel->
  "During evaluation of \
In[15]:=",ExpressionUUID->"943cce8f-6030-4da0-89d8-e4b7757cb2e9"],

Cell[BoxData["\<\"V declared as a 4-dimensional rank-2 tensor header.\"\>"], \
"Print",
 CellChangeTimes->{
  3.876903376747521*^9, 3.876976978476327*^9, 3.877066136447813*^9, 
   3.877490032997962*^9, 3.877820935596715*^9, 3.878006918316052*^9, 
   3.878011608364133*^9, 3.878015606541864*^9, {3.878356953462988*^9, 
   3.8783569883214827`*^9}, 3.878357362355804*^9, 3.878357455882291*^9},
 CellLabel->
  "During evaluation of \
In[15]:=",ExpressionUUID->"e56ff6b1-b254-4372-bcc1-7be2e91527aa"],

Cell[BoxData["\<\"S declared as a 4-dimensional rank-2 tensor header.\"\>"], \
"Print",
 CellChangeTimes->{
  3.876903376747521*^9, 3.876976978476327*^9, 3.877066136447813*^9, 
   3.877490032997962*^9, 3.877820935596715*^9, 3.878006918316052*^9, 
   3.878011608364133*^9, 3.878015606541864*^9, {3.878356953462988*^9, 
   3.8783569883214827`*^9}, 3.878357362355804*^9, 3.8783574558840437`*^9},
 CellLabel->
  "During evaluation of \
In[15]:=",ExpressionUUID->"3418ae73-4bb1-424e-9331-243d786e86f4"]
}, Open  ]]
}, Open  ]]
}, Open  ]],

Cell[CellGroupData[{

Cell["SubFunctions", "Section",
 CellChangeTimes->{{3.810011820953319*^9, 
  3.810011824102497*^9}},ExpressionUUID->"b2a7b427-35e1-4c90-a40a-\
a7c43f50ca5a"],

Cell[CellGroupData[{

Cell["general functions", "Subsection",
 CellChangeTimes->{{3.8717162484953003`*^9, 
  3.8717162609396152`*^9}},ExpressionUUID->"b7909353-edfe-4489-b115-\
b6a172af6d7d"],

Cell[BoxData[
 RowBox[{
  RowBox[{"nicevs", "=", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{
      RowBox[{"v", "[", "i_", "]"}], ":>", "v"}], ",", 
     RowBox[{
      RowBox[{"S", "[", "i_", "]"}], ":>", "S"}], ",", 
     RowBox[{
      RowBox[{"c", "[", "i_", "]"}], ":>", 
      SubscriptBox["c", "i"]}]}], "}"}]}], ";"}]], "Input",
 CellChangeTimes->{{3.877388939506537*^9, 3.877388949032188*^9}},
 CellLabel->"In[22]:=",ExpressionUUID->"aae90991-5bc3-401d-87f3-7f8422f12676"],

Cell[BoxData[{
 RowBox[{"ClearAll", "[", 
  RowBox[{"SimplifyMono", ",", "SimplifyMonof"}], 
  "]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"SimplifyMono", "[", "f_", "]"}], ":=", 
  RowBox[{"Module", "[", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{"res", "=", 
      RowBox[{"f", "//", "Expand"}]}], "}"}], ",", 
    RowBox[{
     RowBox[{"If", "[", 
      RowBox[{
       RowBox[{
        RowBox[{"Head", "[", "res", "]"}], "===", "Plus"}], ",", 
       RowBox[{"res", "=", 
        RowBox[{
         RowBox[{
          RowBox[{"(", 
           RowBox[{"List", "@@", "res"}], ")"}], "//", "Simplify"}], "//", 
         "Total"}]}], ",", 
       RowBox[{"res", "=", 
        RowBox[{"Simplify", "[", "res", "]"}]}]}], "]"}], ";", "res"}]}], 
   "]"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"SimplifyMonof", "[", "f_", "]"}], ":=", 
  RowBox[{"Module", "[", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{"res", "=", 
      RowBox[{"f", "//", "Expand"}]}], "}"}], ",", 
    RowBox[{
     RowBox[{"If", "[", 
      RowBox[{
       RowBox[{
        RowBox[{"Head", "[", "res", "]"}], "===", "Plus"}], ",", 
       RowBox[{"res", "=", 
        RowBox[{
         RowBox[{
          RowBox[{"(", 
           RowBox[{"List", "@@", "res"}], ")"}], "//", "Simplify"}], "//", 
         "Total"}]}], ",", 
       RowBox[{"res", "=", 
        RowBox[{"FullSimplify", "[", "res", "]"}]}]}], "]"}], ";", "res"}]}], 
   "]"}]}]}], "Input",
 CellChangeTimes->{{3.871038879132368*^9, 3.871038905309572*^9}},
 CellLabel->"In[23]:=",ExpressionUUID->"b0fdc6fd-2a5b-4d84-97a3-03bddc4e6893"],

Cell[BoxData[{
 RowBox[{"ClearAll", "[", 
  RowBox[{"Collectj", ",", "Collectjf"}], "]"}], "\[IndentingNewLine]", 
 RowBox[{"Collectj", ":=", 
  RowBox[{
   RowBox[{"Collect", "[", 
    RowBox[{"#", ",", 
     RowBox[{"j", "[", "__", "]"}], ",", "Simplify"}], "]"}], 
   "&"}]}], "\[IndentingNewLine]", 
 RowBox[{"Collectjf", ":=", 
  RowBox[{
   RowBox[{"Collect", "[", 
    RowBox[{"#", ",", 
     RowBox[{"j", "[", "__", "]"}], ",", "FullSimplify"}], "]"}], 
   "&"}]}]}], "Input",
 CellChangeTimes->{{3.870563255866166*^9, 3.870563259484146*^9}, {
   3.870655391967127*^9, 3.87065539655599*^9}, 3.870655469270833*^9},
 CellLabel->"In[26]:=",ExpressionUUID->"277d5114-6840-4b27-9460-eac0f86cbc2c"],

Cell[BoxData[{
 RowBox[{"ClearAll", "[", 
  RowBox[{"Collectb", ",", "Collectbf"}], "]"}], "\[IndentingNewLine]", 
 RowBox[{"Collectb", ":=", 
  RowBox[{
   RowBox[{"Collect", "[", 
    RowBox[{"#", ",", 
     RowBox[{"B", "[", "__", "]"}]}], "]"}], "&"}]}], "\[IndentingNewLine]", 
 RowBox[{"Collectbf", ":=", 
  RowBox[{
   RowBox[{"Collect", "[", 
    RowBox[{"#", ",", 
     RowBox[{"B", "[", "__", "]"}], ",", 
     RowBox[{
      RowBox[{"(", 
       RowBox[{
        RowBox[{"Factor", "[", "#1", "]"}], "//", "FullSimplify"}], ")"}], 
      "&"}]}], "]"}], "&"}]}]}], "Input",
 CellChangeTimes->{{3.8705913651404657`*^9, 3.870591383682583*^9}, 
   3.870655472075412*^9, {3.870655517557816*^9, 3.870655550957642*^9}, {
   3.876611424237235*^9, 3.876611424429071*^9}},
 CellLabel->"In[29]:=",ExpressionUUID->"ff95a306-8b51-46ee-8bc6-3e57f67ea494"],

Cell[BoxData[{
 RowBox[{"ClearAll", "[", "Casesdot", "]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"Casesdot", "[", "f_", "]"}], ":=", 
  RowBox[{
   RowBox[{"Cases", "[", 
    RowBox[{"f", ",", 
     RowBox[{"dot", "[", "__", "]"}], ",", 
     RowBox[{"{", 
      RowBox[{"0", ",", "\[Infinity]"}], "}"}]}], "]"}], "//", 
   "Union"}]}]}], "Input",
 CellChangeTimes->{{3.871860800284142*^9, 3.871860849326124*^9}, {
   3.871860880863056*^9, 3.8718609082263327`*^9}, 3.872119829251048*^9},
 CellLabel->"In[32]:=",ExpressionUUID->"a76cbf43-accd-494d-bf74-aaf9211a3950"],

Cell[BoxData[
 RowBox[{"(*", 
  RowBox[{
   RowBox[{"rmzero", "=", 
    RowBox[{"{", 
     RowBox[{
      RowBox[{
       RowBox[{"dot", "[", 
        RowBox[{"v", ",", 
         RowBox[{"F", "[", "i_", "]"}], ",", "v"}], "]"}], ":>", " ", "0"}], 
      ",", 
      RowBox[{
       RowBox[{"dot", "[", 
        RowBox[{
         RowBox[{"p", "[", "]"}], ",", "f__", ",", "v"}], "]"}], ":>", " ", 
       "0"}]}], "}"}]}], ";"}], "*)"}]], "Input",
 CellChangeTimes->{3.871297375601942*^9},
 CellLabel->"In[34]:=",ExpressionUUID->"2787e42e-631b-4f49-a71c-b7b0e075493a"],

Cell[BoxData[{
 RowBox[{
  RowBox[{"ClearAll", "[", 
   RowBox[{"replace", ",", "repg"}], "]"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"replace", "[", 
    RowBox[{"otherDDMOrder_", ",", "n_"}], "]"}], ":=", 
   RowBox[{"Table", "[", 
    RowBox[{
     RowBox[{
      RowBox[{
       RowBox[{"(", 
        RowBox[{"p", "/@", 
         RowBox[{"Range", "[", 
          RowBox[{"n", "-", "1"}], "]"}]}], ")"}], "[", 
       RowBox[{"[", "i", "]"}], "]"}], "\[Rule]", " ", 
      RowBox[{"otherDDMOrder", "[", 
       RowBox[{"[", "i", "]"}], "]"}]}], ",", 
     RowBox[{"{", 
      RowBox[{"i", ",", 
       RowBox[{"n", "-", "1"}]}], "}"}]}], "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"repg", "[", 
   RowBox[{"a_", ",", "otherDDMOrder__"}], "]"}], ":=", 
  RowBox[{"Module", "[", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{"gg", ",", "ggod"}], "}"}], ",", 
    RowBox[{
     RowBox[{"gg", "=", 
      RowBox[{"a", "/@", 
       RowBox[{"{", "otherDDMOrder", "}"}]}]}], ";", 
     RowBox[{"ggod", "=", 
      RowBox[{"Sort", "[", "gg", "]"}]}], ";", 
     RowBox[{"Table", "[", 
      RowBox[{
       RowBox[{
        RowBox[{
         RowBox[{"(", "ggod", ")"}], "[", 
         RowBox[{"[", "i", "]"}], "]"}], "\[Rule]", " ", 
        RowBox[{
         RowBox[{"(", "gg", ")"}], "[", 
         RowBox[{"[", "i", "]"}], "]"}]}], ",", 
       RowBox[{"{", 
        RowBox[{"i", ",", 
         RowBox[{"Length", "@", "gg"}]}], "}"}]}], "]"}]}]}], 
   "]"}]}]}], "Input",
 CellChangeTimes->{{3.853809980519072*^9, 3.8538099861376333`*^9}},
 CellLabel->"In[35]:=",ExpressionUUID->"b4037ea5-93ff-4f7e-a16c-2ab7e7c858e0"],

Cell[BoxData[{
 RowBox[{"ClearAll", "[", 
  RowBox[{"dotOnshell", ",", "vonshell"}], "]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"dotOnshell", "[", "n_", "]"}], ":=", 
  RowBox[{"{", 
   RowBox[{
    RowBox[{
     RowBox[{"dot", "[", 
      RowBox[{
       RowBox[{"p", "[", "n", "]"}], ",", "f_"}], "]"}], "\[RuleDelayed]", 
     " ", 
     RowBox[{"-", 
      RowBox[{"Sum", "[", 
       RowBox[{
        RowBox[{"dot", "[", 
         RowBox[{
          RowBox[{"p", "[", "i", "]"}], ",", "f"}], "]"}], ",", 
        RowBox[{"{", 
         RowBox[{"i", ",", 
          RowBox[{"n", "-", "1"}]}], "}"}]}], "]"}]}]}], ",", 
    RowBox[{
     RowBox[{"dot", "[", 
      RowBox[{"f_", ",", 
       RowBox[{"p", "[", "n", "]"}]}], "]"}], "\[RuleDelayed]", " ", 
     RowBox[{"-", 
      RowBox[{"Sum", "[", 
       RowBox[{
        RowBox[{"dot", "[", 
         RowBox[{
          RowBox[{"p", "[", "i", "]"}], ",", "f"}], "]"}], ",", 
        RowBox[{"{", 
         RowBox[{"i", ",", 
          RowBox[{"n", "-", "1"}]}], "}"}]}], "]"}]}]}], ",", 
    RowBox[{
     RowBox[{"dot", "[", 
      RowBox[{
       RowBox[{"p", "[", "0", "]"}], ",", 
       RowBox[{"\[Epsilon]", "[", 
        RowBox[{"p", "[", "n", "]"}], "]"}]}], "]"}], "\[RuleDelayed]", " ", 
     RowBox[{"-", 
      RowBox[{"Sum", "[", 
       RowBox[{
        RowBox[{"dot", "[", 
         RowBox[{
          RowBox[{"p", "[", "i", "]"}], ",", 
          RowBox[{"\[Epsilon]", "[", 
           RowBox[{"p", "[", "n", "]"}], "]"}]}], "]"}], ",", 
        RowBox[{"{", 
         RowBox[{"i", ",", "1", ",", 
          RowBox[{"n", "-", "1"}]}], "}"}]}], "]"}]}]}], ",", 
    RowBox[{
     RowBox[{"dot", "[", 
      RowBox[{
       RowBox[{"\[Epsilon]", "[", 
        RowBox[{"p", "[", "n", "]"}], "]"}], ",", 
       RowBox[{"p", "[", "0", "]"}]}], "]"}], "\[RuleDelayed]", " ", 
     RowBox[{"-", 
      RowBox[{"Sum", "[", 
       RowBox[{
        RowBox[{"dot", "[", 
         RowBox[{
          RowBox[{"p", "[", "i", "]"}], ",", 
          RowBox[{"\[Epsilon]", "[", 
           RowBox[{"p", "[", "n", "]"}], "]"}]}], "]"}], ",", 
        RowBox[{"{", 
         RowBox[{"i", ",", "1", ",", 
          RowBox[{"n", "-", "1"}]}], "}"}]}], "]"}]}]}]}], 
   "}"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"vonshell", "[", 
   RowBox[{"n_", ",", "i_"}], "]"}], ":=", 
  RowBox[{"{", 
   RowBox[{
    RowBox[{"dot", "[", 
     RowBox[{"v", ",", 
      RowBox[{"p", "[", "i", "]"}]}], "]"}], "\[RuleDelayed]", " ", 
    RowBox[{"(", 
     RowBox[{
      RowBox[{"dot", "[", 
       RowBox[{"v", ",", 
        RowBox[{"p", "[", "i", "]"}]}], "]"}], "-", 
      RowBox[{"Sum", "[", 
       RowBox[{
        RowBox[{"dot", "[", 
         RowBox[{"v", ",", 
          RowBox[{"p", "[", "j", "]"}]}], "]"}], ",", 
        RowBox[{"{", 
         RowBox[{"j", ",", "1", ",", 
          RowBox[{"n", "-", "1"}]}], "}"}]}], "]"}]}], ")"}]}], 
   "}"}]}]}], "Input",
 CellChangeTimes->{{3.727163684521564*^9, 3.727163712580194*^9}, 
   3.728198771127473*^9, {3.7282976424483356`*^9, 3.728297678974709*^9}, {
   3.728297723296649*^9, 3.72829773196879*^9}, {3.7492963246076107`*^9, 
   3.749296346599493*^9}, {3.7492969402526007`*^9, 3.749296945367785*^9}, {
   3.756962173926325*^9, 3.756962173952697*^9}, {3.756962214008494*^9, 
   3.756962214036718*^9}, {3.756962285466909*^9, 3.7569622869241734`*^9}, {
   3.756970904201673*^9, 3.7569709322363663`*^9}, {3.759113304523664*^9, 
   3.759113331527665*^9}, {3.759113382631379*^9, 3.759113498024493*^9}, {
   3.759592650632361*^9, 3.759592657996381*^9}, {3.810004273599478*^9, 
   3.8100042908157053`*^9}, {3.813368130768548*^9, 3.813368161218802*^9}, {
   3.8133682014741793`*^9, 3.813368212397605*^9}, {3.813542982230701*^9, 
   3.813543013179331*^9}, {3.813546153285891*^9, 3.813546158120234*^9}, {
   3.813546308456645*^9, 3.8135463101535473`*^9}, {3.8135464926562147`*^9, 
   3.813546546885747*^9}, 3.813546667616501*^9, {3.813547074493762*^9, 
   3.8135470808592043`*^9}, {3.813547399867567*^9, 3.813547441608583*^9}, {
   3.813559656501801*^9, 3.813559667068569*^9}, {3.8135597068041677`*^9, 
   3.813559710282649*^9}, {3.813559768037219*^9, 3.813559779622561*^9}, {
   3.813560124477251*^9, 3.813560131135003*^9}, {3.813560238138142*^9, 
   3.813560266973859*^9}, {3.813560313088909*^9, 3.81356032625429*^9}, {
   3.8135603625794773`*^9, 3.813560379883116*^9}, {3.813562756751007*^9, 
   3.8135627570797586`*^9}, 3.813587217305232*^9, {3.813631538481387*^9, 
   3.813631541035822*^9}, {3.8136340222518473`*^9, 3.813634050518487*^9}, {
   3.843431280830508*^9, 3.843431302343697*^9}, {3.843553240936262*^9, 
   3.8435532494635687`*^9}, {3.843553679143483*^9, 3.843553679792428*^9}, {
   3.843553831340781*^9, 3.843553834894973*^9}},
 CellLabel->"In[38]:=",ExpressionUUID->"6d280527-7a65-48d0-a19d-73ee85d09955"],

Cell[BoxData[{
 RowBox[{"ClearAll", "[", 
  RowBox[{
  "sortS", ",", "zeroMomentum", ",", "onshell", ",", "onshellQCD", ",", 
   "massless"}], "]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"sortS", "=", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"s", "[", 
      RowBox[{"i_", ",", "j_"}], "]"}], "\[RuleDelayed]", 
     RowBox[{"Sort", "[", 
      RowBox[{"s", "[", 
       RowBox[{"i", ",", "j"}], "]"}], "]"}]}], "}"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"zeroMomentum", "[", "n_", "]"}], ":=", 
  RowBox[{
   RowBox[{"s", "[", 
    RowBox[{"i_", ",", "n"}], "]"}], "\[RuleDelayed]", 
   RowBox[{"-", 
    RowBox[{"Sum", "[", 
     RowBox[{
      RowBox[{"s", "[", 
       RowBox[{"i", ",", "j"}], "]"}], ",", 
      RowBox[{"{", 
       RowBox[{"j", ",", 
        RowBox[{"n", "-", "1"}]}], "}"}]}], 
     "]"}]}]}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"onshell", "[", "n_", "]"}], ":=", 
  RowBox[{
   RowBox[{"s", "[", 
    RowBox[{
     RowBox[{"n", "-", "2"}], ",", 
     RowBox[{"n", "-", "1"}]}], "]"}], "\[Rule]", "  ", 
   RowBox[{
    RowBox[{"-", 
     RowBox[{"Total", "[", 
      RowBox[{
       RowBox[{"Table", "[", 
        RowBox[{
         RowBox[{"Table", "[", 
          RowBox[{
           RowBox[{"s", "[", 
            RowBox[{"i", ",", "j"}], "]"}], ",", 
           RowBox[{"{", 
            RowBox[{"i", ",", 
             RowBox[{"j", "-", "1"}]}], "}"}]}], "]"}], ",", 
         RowBox[{"{", 
          RowBox[{"j", ",", 
           RowBox[{"n", "-", "1"}]}], "}"}]}], "]"}], "//", "Flatten"}], 
      "]"}]}], "+", 
    RowBox[{"s", "[", 
     RowBox[{
      RowBox[{"n", "-", "2"}], ",", 
      RowBox[{"n", "-", "1"}]}], "]"}]}]}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"onshellQCD", "[", "n_", "]"}], ":=", 
  RowBox[{
   RowBox[{"s", "[", 
    RowBox[{
     RowBox[{"n", "-", "2"}], ",", 
     RowBox[{"n", "-", "1"}]}], "]"}], "\[Rule]", "  ", 
   RowBox[{
    RowBox[{"-", 
     RowBox[{"Total", "[", 
      RowBox[{
       RowBox[{"Table", "[", 
        RowBox[{
         RowBox[{"Table", "[", 
          RowBox[{
           RowBox[{"s", "[", 
            RowBox[{"i", ",", "j"}], "]"}], ",", 
           RowBox[{"{", 
            RowBox[{"i", ",", "0", ",", 
             RowBox[{"j", "-", "1"}]}], "}"}]}], "]"}], ",", 
         RowBox[{"{", 
          RowBox[{"j", ",", 
           RowBox[{"n", "-", "1"}]}], "}"}]}], "]"}], "//", "Flatten"}], 
      "]"}]}], "+", 
    RowBox[{"s", "[", 
     RowBox[{
      RowBox[{"n", "-", "2"}], ",", 
      RowBox[{"n", "-", "1"}]}], "]"}]}]}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"massless", "=", 
   RowBox[{
    RowBox[{"s", "[", 
     RowBox[{"i_", ",", "i_"}], "]"}], "\[RuleDelayed]", "0"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{"ClearAll", "[", 
  RowBox[{"sortP", ",", "sortE"}], "]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"sortP", "[", 
   RowBox[{"li_", ",", "lr_"}], "]"}], ":=", 
  RowBox[{"SortBy", "[", 
   RowBox[{"li", ",", " ", 
    RowBox[{
     RowBox[{"Position", "[", 
      RowBox[{"lr", ",", 
       RowBox[{"(", 
        RowBox[{"First", "@", "#"}], ")"}]}], "]"}], "&"}]}], 
   "]"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"sortE", "[", 
   RowBox[{"li_", ",", "lr_"}], "]"}], ":=", 
  RowBox[{"SortBy", "[", 
   RowBox[{"li", ",", " ", 
    RowBox[{
     RowBox[{"Position", "[", 
      RowBox[{"lr", ",", 
       RowBox[{"(", 
        RowBox[{"First", "@@", "#"}], ")"}]}], "]"}], "&"}]}], 
   "]"}]}], "\[IndentingNewLine]", 
 RowBox[{"ClearAll", "[", "repBack", "]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"repBack", "=", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{
      RowBox[{"Subscript", "[", 
       RowBox[{"a_", ",", "i_"}], "]"}], ":>", " ", 
      RowBox[{"a", "[", "i", "]"}]}], ",", 
     RowBox[{"CenterDot", "->", " ", "dot"}]}], "}"}]}], 
  ";"}], "\[IndentingNewLine]"}], "Input",
 CellChangeTimes->{
  3.727163681618944*^9, {3.749179480748872*^9, 3.749179491659102*^9}, {
   3.749296395909049*^9, 3.7492964230074463`*^9}, {3.74929688390792*^9, 
   3.74929689475134*^9}, 3.756962173957769*^9, 3.7569622140447397`*^9, {
   3.756962309850726*^9, 3.7569623219178553`*^9}, {3.75697119019627*^9, 
   3.756971194962592*^9}, {3.810006123538918*^9, 3.810006130187482*^9}, {
   3.813643784231852*^9, 3.813643813331348*^9}, 3.841472859500243*^9, {
   3.851849638478299*^9, 3.851849659664133*^9}, {3.854063182750596*^9, 
   3.854063189346609*^9}},
 CellLabel->"In[41]:=",ExpressionUUID->"0e2780f7-f3c5-41e4-a82a-2661c1254c1e"],

Cell[BoxData[{
 RowBox[{"ClearAll", "[", "V2spBracket", "]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"V2spBracket", "=", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{
      RowBox[{"J", "[", 
       RowBox[{"_", ",", "f_", ",", "m_"}], "]"}], "\[RuleDelayed]", " ", 
      RowBox[{"spBracket", "[", 
       RowBox[{
        RowBox[{"spB", "[", "\[Beta]", "]"}], ",", 
        RowBox[{"f", "/.", 
         RowBox[{
          RowBox[{"CircleTimes", "[", "g___", "]"}], "\[RuleDelayed]", " ", 
          "g"}]}], ",", 
        RowBox[{"spA", "[", "\[Alpha]", "]"}]}], "]"}]}], ",", 
     RowBox[{
      RowBox[{"J", "[", 
       RowBox[{"_", ",", "f_"}], "]"}], "\[RuleDelayed]", " ", 
      RowBox[{"spBracket", "[", 
       RowBox[{
        RowBox[{"spB", "[", "\[Beta]", "]"}], ",", 
        RowBox[{"f", "/.", 
         RowBox[{
          RowBox[{"CircleTimes", "[", "g___", "]"}], "\[RuleDelayed]", " ", 
          "g"}]}], ",", 
        RowBox[{"spA", "[", "\[Alpha]", "]"}]}], "]"}]}]}], "}"}]}], 
  ";"}]}], "Input",
 CellChangeTimes->{{3.849943435749509*^9, 3.8499434443014603`*^9}},
 CellLabel->"In[52]:=",ExpressionUUID->"c9dd0306-42c7-4192-b891-8337c9f7440c"],

Cell[BoxData[{
 RowBox[{"ClearAll", "[", 
  RowBox[{"cyclePermute", ",", "cyclePermuteSum"}], 
  "]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"cyclePermute", "[", "n_", "]"}], ":=", 
  RowBox[{"Module", "[", 
   RowBox[{
    RowBox[{"{", "list", "}"}], ",", 
    RowBox[{
     RowBox[{"list", "=", 
      RowBox[{"Permute", "[", " ", 
       RowBox[{
        RowBox[{"Table", "[", 
         RowBox[{
          RowBox[{"p", "[", "i", "]"}], ",", 
          RowBox[{"{", 
           RowBox[{"i", ",", "n"}], "}"}]}], "]"}], ",", " ", 
        RowBox[{"Cycles", "[", 
         RowBox[{"{", 
          RowBox[{"Table", "[", 
           RowBox[{"i", ",", 
            RowBox[{"{", 
             RowBox[{"i", ",", "n"}], "}"}]}], "]"}], "}"}], "]"}]}], "]"}]}],
      ";", 
     RowBox[{"Table", "[", 
      RowBox[{
       RowBox[{"Rule", "[", 
        RowBox[{
         RowBox[{"p", "[", "i", "]"}], ",", 
         RowBox[{"list", "[", 
          RowBox[{"[", "i", "]"}], "]"}]}], "]"}], ",", 
       RowBox[{"{", 
        RowBox[{"i", ",", "n"}], "}"}]}], "]"}]}]}], 
   "]"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"cyclePermuteSum", "[", 
   RowBox[{"f_", ",", "n_"}], "]"}], ":=", 
  RowBox[{"Module", "[", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{"fsum", ",", 
      RowBox[{"g", "=", 
       RowBox[{"Table", "[", 
        RowBox[{"0", ",", 
         RowBox[{"{", 
          RowBox[{"i", ",", "n"}], "}"}]}], "]"}]}]}], "}"}], ",", 
    RowBox[{
     RowBox[{
      RowBox[{"g", "[", 
       RowBox[{"[", "1", "]"}], "]"}], "=", "f"}], ";", 
     RowBox[{"Do", "[", 
      RowBox[{
       RowBox[{
        RowBox[{"g", "[", 
         RowBox[{"[", 
          RowBox[{"i", "+", "1"}], "]"}], "]"}], "=", 
        RowBox[{
         RowBox[{"g", "[", 
          RowBox[{"[", "i", "]"}], "]"}], "/.", 
         RowBox[{"cyclePermute", "[", "n", "]"}]}]}], ",", 
       RowBox[{"{", 
        RowBox[{"i", ",", 
         RowBox[{"n", "-", "1"}]}], "}"}]}], "]"}], ";", " ", 
     RowBox[{"fsum", "=", 
      RowBox[{"Sum", "[", 
       RowBox[{
        RowBox[{"g", "[", 
         RowBox[{"[", "i", "]"}], "]"}], ",", 
        RowBox[{"{", 
         RowBox[{"i", ",", "n"}], "}"}]}], "]"}]}]}]}], "]"}]}]}], "Input",
 CellChangeTimes->{3.7595925973087378`*^9},
 CellLabel->"In[54]:=",ExpressionUUID->"766abd2e-1994-4be7-9ee6-2a6d0f82c59e"],

Cell[BoxData[{
 RowBox[{"ClearAll", "[", 
  RowBox[{"leadingSeries", ",", "LdTerm"}], "]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"leadingSeries", "[", 
   RowBox[{"expr_", ",", 
    RowBox[{"{", 
     RowBox[{"x_", ",", "x0_"}], "}"}]}], "]"}], ":=", 
  RowBox[{"Normal", "[", 
   RowBox[{
    RowBox[{"expr", "/.", 
     RowBox[{"x", "\[Rule]", 
      RowBox[{"Series", "[", 
       RowBox[{"x", ",", 
        RowBox[{"{", 
         RowBox[{"x", ",", "x0", ",", "1"}], "}"}]}], "]"}]}]}], "/.", 
    RowBox[{
     RowBox[{
      RowBox[{"Verbatim", "[", "SeriesData", "]"}], "[", 
      RowBox[{"a__", ",", 
       RowBox[{"{", 
        RowBox[{"b_", ",", "___"}], "}"}], ",", "c__"}], "]"}], 
     "\[RuleDelayed]", 
     RowBox[{"SeriesData", "[", 
      RowBox[{"a", ",", 
       RowBox[{"{", "b", "}"}], ",", "c"}], "]"}]}]}], "]"}]}], "\n", 
 RowBox[{
  RowBox[{"LdTerm", "[", 
   RowBox[{"f_", ",", "var_"}], "]"}], ":=", 
  RowBox[{
   RowBox[{"leadingSeries", "[", 
    RowBox[{"f", ",", 
     RowBox[{"{", 
      RowBox[{"var", ",", "\[Infinity]"}], "}"}]}], "]"}], "//", 
   "Normal"}]}]}], "Input",
 CellLabel->"In[57]:=",ExpressionUUID->"f32e72bc-d9f0-4994-aff5-11032f993f2a"]
}, Open  ]],

Cell[CellGroupData[{

Cell["Expand Tensors", "Subsection",
 CellChangeTimes->{{3.871715923985506*^9, 
  3.8717159306720257`*^9}},ExpressionUUID->"19c23075-0448-439e-b990-\
e9e57cef0c14"],

Cell[BoxData[{
 RowBox[{"ClearAll", "[", 
  RowBox[{"expandTdot", ",", "expandT"}], "]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"expandTdot", "[", "f_", "]"}], ":=", 
  RowBox[{
   RowBox[{"(", 
    RowBox[{
     RowBox[{
      RowBox[{
       RowBox[{"f", "/.", 
        RowBox[{
         RowBox[{"dot", "[", "g___", "]"}], "\[RuleDelayed]", " ", 
         RowBox[{"expandTensor", "[", 
          RowBox[{"dot", "[", "g", "]"}], "]"}]}]}], "/.", 
       RowBox[{
        RowBox[{
         RowBox[{"F", "[", "i_", "]"}], "[", 
         RowBox[{"a_", ",", "b_"}], "]"}], "\[RuleDelayed]", " ", 
        RowBox[{
         RowBox[{
          RowBox[{
           RowBox[{"p", "[", "i", "]"}], "[", "a", "]"}], 
          RowBox[{
           RowBox[{"\[Epsilon]", "[", "i", "]"}], "[", "b", "]"}]}], "-", 
         RowBox[{
          RowBox[{
           RowBox[{"\[Epsilon]", "[", "i", "]"}], "[", "a", "]"}], 
          RowBox[{
           RowBox[{"p", "[", "i", "]"}], "[", "b", "]"}]}]}]}]}], "/.", 
      RowBox[{
       RowBox[{
        RowBox[{"W", "[", "i_", "]"}], "[", 
        RowBox[{"a_", ",", "b_"}], "]"}], "\[RuleDelayed]", " ", 
       RowBox[{
        RowBox[{
         RowBox[{
          RowBox[{"p", "[", "i", "]"}], "[", "a", "]"}], 
         RowBox[{
          RowBox[{"v", "[", "i", "]"}], "[", "b", "]"}]}], "-", 
        RowBox[{
         RowBox[{
          RowBox[{"v", "[", "i", "]"}], "[", "a", "]"}], 
         RowBox[{
          RowBox[{"p", "[", "i", "]"}], "[", "b", "]"}]}]}]}]}], "/.", 
     RowBox[{
      RowBox[{
       RowBox[{"V", "[", "i___", "]"}], "[", 
       RowBox[{"a_", ",", "b_"}], "]"}], "\[RuleDelayed]", " ", 
      RowBox[{
       RowBox[{
        RowBox[{"v", "[", "0", "]"}], "[", "a", "]"}], 
       RowBox[{
        RowBox[{"p", "[", "i", "]"}], "[", "b", "]"}]}]}]}], ")"}], "//", 
   "contract"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"expandT", "[", "f_", "]"}], ":=", " ", 
  RowBox[{"f", "/.", 
   RowBox[{
    RowBox[{"dot", "[", "g___", "]"}], "\[RuleDelayed]", " ", 
    RowBox[{"expandTdot", "[", 
     RowBox[{"dot", "[", "g", "]"}], "]"}]}]}]}], "\[IndentingNewLine]", 
 RowBox[{"ClearAll", "[", 
  RowBox[{"expandTensorGen", ",", "expandF"}], "]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"expandTensorGen", "[", "f_", "]"}], ":=", 
  RowBox[{"Module", "[", 
   RowBox[{
    RowBox[{"{", "res", "}"}], ",", 
    RowBox[{
     RowBox[{"res", "=", 
      RowBox[{"f", "//.", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{
          RowBox[{"Power", "[", 
           RowBox[{
            RowBox[{"dot", "[", "g__", "]"}], ",", "nn_"}], "]"}], ":>", 
          RowBox[{
           RowBox[{"DC", "@@", 
            RowBox[{"Table", "[", 
             RowBox[{
              RowBox[{"dot", "[", "g", "]"}], ",", 
              RowBox[{"{", 
               RowBox[{"ii", ",", "nn"}], "}"}]}], "]"}]}], "/;", 
           RowBox[{"nn", ">", "0"}]}]}], ",", 
         RowBox[{
          RowBox[{"Times", "[", 
           RowBox[{
            RowBox[{"dot", "[", "g__", "]"}], ",", 
            RowBox[{"dot", "[", "h__", "]"}]}], "]"}], ":>", 
          RowBox[{"DC", "[", 
           RowBox[{
            RowBox[{"dot", "[", "g", "]"}], ",", 
            RowBox[{"dot", "[", "h", "]"}]}], "]"}]}], ",", 
         RowBox[{
          RowBox[{"Times", "[", 
           RowBox[{
            RowBox[{"DC", "[", "g__", "]"}], ",", 
            RowBox[{"dot", "[", "h__", "]"}]}], "]"}], ":>", 
          RowBox[{"DC", "[", 
           RowBox[{"g", ",", 
            RowBox[{"dot", "[", "h", "]"}]}], "]"}]}], ",", 
         RowBox[{
          RowBox[{"Times", "[", 
           RowBox[{
            RowBox[{"dot", "[", "h__", "]"}], ",", 
            RowBox[{"DC", "[", "g__", "]"}]}], "]"}], ":>", 
          RowBox[{"DC", "[", 
           RowBox[{
            RowBox[{"dot", "[", "h", "]"}], ",", "g"}], "]"}]}], ",", 
         RowBox[{
          RowBox[{"Times", "[", 
           RowBox[{
            RowBox[{"DC", "[", "h__", "]"}], ",", 
            RowBox[{"DC", "[", "g__", "]"}]}], "]"}], ":>", 
          RowBox[{"DC", "[", 
           RowBox[{"h", ",", "g"}], "]"}]}]}], "}"}]}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"(*", 
      RowBox[{
       RowBox[{"Print", "[", "res", "]"}], ";"}], "*)"}], 
     "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{
       RowBox[{"res", "/.", 
        RowBox[{
         RowBox[{"dot", "[", "g__", "]"}], ":>", 
         RowBox[{"expandTensor", "[", 
          RowBox[{"dot", "[", "g", "]"}], "]"}]}]}], "/.", 
       RowBox[{
        RowBox[{"DC", "[", "g__", "]"}], ":>", 
        RowBox[{"DC", "@@", 
         RowBox[{"Table", "[", 
          RowBox[{
           RowBox[{
            RowBox[{
             RowBox[{"{", "g", "}"}], "[", 
             RowBox[{"[", "ii", "]"}], "]"}], "/.", 
            RowBox[{
             RowBox[{"lI", "[", "ids__", "]"}], ":>", 
             RowBox[{"lI", "[", 
              RowBox[{"ii", ",", "ids"}], "]"}]}]}], ",", 
           RowBox[{"{", 
            RowBox[{"ii", ",", 
             RowBox[{"Length", "@", 
              RowBox[{"{", "g", "}"}]}]}], "}"}]}], "]"}]}]}]}], "/.", 
      RowBox[{"DC", "->", "Times"}]}]}]}], "\[IndentingNewLine]", 
   "]"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"expandF", "[", 
   RowBox[{"f_", ",", "id_"}], "]"}], ":=", 
  RowBox[{"f", "/.", 
   RowBox[{
    RowBox[{
     RowBox[{"F", "[", "id", "]"}], "[", 
     RowBox[{"a_", ",", "b_"}], "]"}], "\[RuleDelayed]", " ", 
    RowBox[{
     RowBox[{
      RowBox[{
       RowBox[{"p", "[", "id", "]"}], "[", "a", "]"}], 
      RowBox[{
       RowBox[{"\[Epsilon]", "[", "id", "]"}], "[", "b", "]"}]}], "-", 
     RowBox[{
      RowBox[{
       RowBox[{"\[Epsilon]", "[", "id", "]"}], "[", "a", "]"}], 
      RowBox[{
       RowBox[{"p", "[", "id", "]"}], "[", "b", 
       "]"}]}]}]}]}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"expandF", "[", "f_", "]"}], ":=", 
  RowBox[{"f", "/.", 
   RowBox[{
    RowBox[{
     RowBox[{"F", "[", "id_", "]"}], "[", 
     RowBox[{"a_", ",", "b_"}], "]"}], "\[RuleDelayed]", " ", 
    RowBox[{
     RowBox[{
      RowBox[{
       RowBox[{"p", "[", "id", "]"}], "[", "a", "]"}], 
      RowBox[{
       RowBox[{"\[Epsilon]", "[", "id", "]"}], "[", "b", "]"}]}], "-", 
     RowBox[{
      RowBox[{
       RowBox[{"\[Epsilon]", "[", "id", "]"}], "[", "a", "]"}], 
      RowBox[{
       RowBox[{"p", "[", "id", "]"}], "[", "b", "]"}]}]}]}]}]}]}], "Input",
 CellChangeTimes->{{3.8519988490005493`*^9, 3.8519988586312313`*^9}, {
  3.852266080976235*^9, 3.852266083544794*^9}, {3.8522661271732883`*^9, 
  3.8522661315239162`*^9}, {3.8522662312904997`*^9, 3.8522662509717417`*^9}, {
  3.852342321299981*^9, 3.852342321961708*^9}, {3.852342379535592*^9, 
  3.852342380584991*^9}, {3.871691418979636*^9, 3.871691419907322*^9}, {
  3.87169145976577*^9, 3.871691475455221*^9}, {3.871691506816244*^9, 
  3.8716916564787827`*^9}, {3.871691706084654*^9, 3.871691733103662*^9}, {
  3.8717067770260687`*^9, 3.871706787951022*^9}, {3.871706897332698*^9, 
  3.871706919266697*^9}},
 CellLabel->"In[60]:=",ExpressionUUID->"41d8c094-84c5-4ee9-aee4-8c40ac1ee5f3"],

Cell[BoxData[{
 RowBox[{"ClearAll", "[", "expandFDirect", "]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"expandFDirect", "[", 
   RowBox[{"f_", ",", "id_"}], "]"}], ":=", 
  RowBox[{"f", "/.", 
   RowBox[{
    RowBox[{"dot", "[", 
     RowBox[{"a__", ",", 
      RowBox[{"F", "[", "id", "]"}], ",", "b__"}], "]"}], "\[RuleDelayed]", 
    " ", 
    RowBox[{
     RowBox[{
      RowBox[{"dot", "[", 
       RowBox[{"a", ",", 
        RowBox[{"p", "[", "id", "]"}]}], "]"}], 
      RowBox[{"dot", "[", 
       RowBox[{
        RowBox[{"\[Epsilon]", "[", "id", "]"}], ",", "b"}], "]"}]}], "-", " ", 
     RowBox[{
      RowBox[{"dot", "[", 
       RowBox[{"a", ",", 
        RowBox[{"\[Epsilon]", "[", "id", "]"}]}], "]"}], 
      RowBox[{"dot", "[", 
       RowBox[{
        RowBox[{"p", "[", "id", "]"}], ",", "b"}], 
       "]"}]}]}]}]}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"expandFDirect", "[", "f_", "]"}], ":=", 
  RowBox[{"f", "//.", 
   RowBox[{
    RowBox[{"dot", "[", 
     RowBox[{"a__", ",", 
      RowBox[{"F", "[", "id_", "]"}], ",", "b__"}], "]"}], "\[RuleDelayed]", 
    " ", 
    RowBox[{
     RowBox[{
      RowBox[{"dot", "[", 
       RowBox[{"a", ",", 
        RowBox[{"p", "[", "id", "]"}]}], "]"}], 
      RowBox[{"dot", "[", 
       RowBox[{
        RowBox[{"\[Epsilon]", "[", "id", "]"}], ",", "b"}], "]"}]}], "-", " ", 
     RowBox[{
      RowBox[{"dot", "[", 
       RowBox[{"a", ",", 
        RowBox[{"\[Epsilon]", "[", "id", "]"}]}], "]"}], 
      RowBox[{"dot", "[", 
       RowBox[{
        RowBox[{"p", "[", "id", "]"}], ",", "b"}], "]"}]}]}]}]}]}]}], "Input",\

 CellChangeTimes->{{3.876777766242668*^9, 3.87677794338896*^9}},
 CellLabel->"In[67]:=",ExpressionUUID->"078d2120-47c9-45fd-a915-fc4e3e8e373e"],

Cell[BoxData[{
 RowBox[{"ClearAll", "[", "dressdot", "]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"dressdot", "[", "f_", "]"}], ":=", 
  RowBox[{"Module", "[", 
   RowBox[{
    RowBox[{"{", "res", "}"}], ",", 
    RowBox[{"res", "=", 
     RowBox[{
      RowBox[{"f", "/.", 
       RowBox[{
        RowBox[{"dot", "[", 
         RowBox[{"g_", ",", 
          RowBox[{"\[Epsilon]", "[", "id_", "]"}]}], "]"}], ":>", 
        RowBox[{
         RowBox[{"g", "[", 
          RowBox[{"lI", "[", 
           RowBox[{"0", ",", "id"}], "]"}], "]"}], 
         RowBox[{
          RowBox[{"\[Epsilon]", "[", "id", "]"}], "[", 
          RowBox[{"lI", "[", 
           RowBox[{"0", ",", "id"}], "]"}], "]"}]}]}]}], "/.", 
      RowBox[{
       RowBox[{"dot", "[", 
        RowBox[{
         RowBox[{"\[Epsilon]", "[", "id_", "]"}], ",", "g_"}], "]"}], ":>", 
       RowBox[{
        RowBox[{"g", "[", 
         RowBox[{"lI", "[", 
          RowBox[{"0", ",", "id"}], "]"}], "]"}], 
        RowBox[{
         RowBox[{"\[Epsilon]", "[", "id", "]"}], "[", 
         RowBox[{"lI", "[", 
          RowBox[{"0", ",", "id"}], "]"}], "]"}]}]}]}]}]}], 
   "\[IndentingNewLine]", "]"}]}], "\[IndentingNewLine]", 
 RowBox[{"ClearAll", "[", "dressdotGen", "]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"dressdotGen", "[", "f_", "]"}], ":=", 
  RowBox[{"Module", "[", 
   RowBox[{
    RowBox[{"{", "res", "}"}], ",", 
    RowBox[{
     RowBox[{"res", "=", 
      RowBox[{"f", "//", "Expand"}]}], ";", 
     RowBox[{"res", "=", 
      RowBox[{"res", "//.", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{
          RowBox[{"Power", "[", 
           RowBox[{
            RowBox[{"dot", "[", "g__", "]"}], ",", "nn_"}], "]"}], ":>", 
          RowBox[{
           RowBox[{"DC", "@@", 
            RowBox[{"Table", "[", 
             RowBox[{
              RowBox[{"dot", "[", "g", "]"}], ",", 
              RowBox[{"{", 
               RowBox[{"ii", ",", "nn"}], "}"}]}], "]"}]}], "/;", 
           RowBox[{"nn", ">", "0"}]}]}], ",", 
         RowBox[{
          RowBox[{"Times", "[", 
           RowBox[{
            RowBox[{"dot", "[", "g__", "]"}], ",", 
            RowBox[{"dot", "[", "h__", "]"}]}], "]"}], ":>", 
          RowBox[{"DC", "[", 
           RowBox[{
            RowBox[{"dot", "[", "g", "]"}], ",", 
            RowBox[{"dot", "[", "h", "]"}]}], "]"}]}], ",", 
         RowBox[{
          RowBox[{"Times", "[", 
           RowBox[{
            RowBox[{"DC", "[", "g__", "]"}], ",", 
            RowBox[{"dot", "[", "h__", "]"}]}], "]"}], ":>", 
          RowBox[{"DC", "[", 
           RowBox[{"g", ",", 
            RowBox[{"dot", "[", "h", "]"}]}], "]"}]}], ",", 
         RowBox[{
          RowBox[{"Times", "[", 
           RowBox[{
            RowBox[{"dot", "[", "h__", "]"}], ",", 
            RowBox[{"DC", "[", "g__", "]"}]}], "]"}], ":>", 
          RowBox[{"DC", "[", 
           RowBox[{
            RowBox[{"dot", "[", "h", "]"}], ",", "g"}], "]"}]}], ",", 
         RowBox[{
          RowBox[{"Times", "[", 
           RowBox[{
            RowBox[{"DC", "[", "h__", "]"}], ",", 
            RowBox[{"DC", "[", "g__", "]"}]}], "]"}], ":>", 
          RowBox[{"DC", "[", 
           RowBox[{"h", ",", "g"}], "]"}]}]}], "}"}]}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"(*", 
      RowBox[{
       RowBox[{"Print", "[", "res", "]"}], ";"}], "*)"}], 
     "\[IndentingNewLine]", 
     RowBox[{"res", "=", 
      RowBox[{"res", "//", "dressdot"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"res", "/.", 
       RowBox[{
        RowBox[{"DC", "[", "g__", "]"}], ":>", 
        RowBox[{"DC", "@@", 
         RowBox[{"Table", "[", 
          RowBox[{
           RowBox[{
            RowBox[{
             RowBox[{"{", "g", "}"}], "[", 
             RowBox[{"[", "ii", "]"}], "]"}], "/.", 
            RowBox[{
             RowBox[{"lI", "[", "ids__", "]"}], ":>", 
             RowBox[{"lI", "[", 
              RowBox[{"ii", ",", "ids"}], "]"}]}]}], ",", 
           RowBox[{"{", 
            RowBox[{"ii", ",", 
             RowBox[{"Length", "@", 
              RowBox[{"{", "g", "}"}]}]}], "}"}]}], "]"}]}]}]}], "/.", 
      RowBox[{"DC", "->", "Times"}]}]}]}], "\[IndentingNewLine]", 
   "]"}]}]}], "Input",
 CellChangeTimes->{
  3.872034945418346*^9, {3.8720349907917633`*^9, 3.872034993209223*^9}, {
   3.872036261541153*^9, 3.872036291395546*^9}, {3.872036858716271*^9, 
   3.872036870110409*^9}},
 CellLabel->"In[70]:=",ExpressionUUID->"a61f9555-0be9-40b9-bdae-1cc5f6ebe29e"],

Cell[BoxData[{
 RowBox[{"ClearAll", "[", "expandGen", "]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"expandGen", "[", "f_", "]"}], ":=", 
  RowBox[{"Module", "[", 
   RowBox[{
    RowBox[{"{", "res", "}"}], ",", 
    RowBox[{
     RowBox[{"res", "=", 
      RowBox[{"f", "//.", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{
          RowBox[{"Power", "[", 
           RowBox[{
            RowBox[{"dot", "[", "g__", "]"}], ",", "nn_"}], "]"}], ":>", 
          RowBox[{
           RowBox[{"DC", "@@", 
            RowBox[{"Table", "[", 
             RowBox[{
              RowBox[{"dot", "[", "g", "]"}], ",", 
              RowBox[{"{", 
               RowBox[{"ii", ",", "nn"}], "}"}]}], "]"}]}], "/;", 
           RowBox[{"nn", ">", "0"}]}]}], ",", 
         RowBox[{
          RowBox[{"Times", "[", 
           RowBox[{
            RowBox[{"dot", "[", "g__", "]"}], ",", 
            RowBox[{"dot", "[", "h__", "]"}]}], "]"}], ":>", 
          RowBox[{"DC", "[", 
           RowBox[{
            RowBox[{"dot", "[", "g", "]"}], ",", 
            RowBox[{"dot", "[", "h", "]"}]}], "]"}]}], ",", 
         RowBox[{
          RowBox[{"Times", "[", 
           RowBox[{
            RowBox[{"DC", "[", "g__", "]"}], ",", 
            RowBox[{"dot", "[", "h__", "]"}]}], "]"}], ":>", 
          RowBox[{"DC", "[", 
           RowBox[{"g", ",", 
            RowBox[{"dot", "[", "h", "]"}]}], "]"}]}], ",", 
         RowBox[{
          RowBox[{"Times", "[", 
           RowBox[{
            RowBox[{"dot", "[", "h__", "]"}], ",", 
            RowBox[{"DC", "[", "g__", "]"}]}], "]"}], ":>", 
          RowBox[{"DC", "[", 
           RowBox[{
            RowBox[{"dot", "[", "h", "]"}], ",", "g"}], "]"}]}], ",", 
         RowBox[{
          RowBox[{"Times", "[", 
           RowBox[{
            RowBox[{"DC", "[", "h__", "]"}], ",", 
            RowBox[{"DC", "[", "g__", "]"}]}], "]"}], ":>", 
          RowBox[{"DC", "[", 
           RowBox[{"h", ",", "g"}], "]"}]}]}], "}"}]}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"(*", 
      RowBox[{
       RowBox[{"Print", "[", "res", "]"}], ";"}], "*)"}], 
     "\[IndentingNewLine]", 
     RowBox[{"res", "=", 
      RowBox[{"res", "//", "dressdot"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{
       RowBox[{"res", "/.", 
        RowBox[{
         RowBox[{"dot", "[", "g__", "]"}], ":>", 
         RowBox[{"expandTensor", "[", 
          RowBox[{"dot", "[", "g", "]"}], "]"}]}]}], "/.", 
       RowBox[{
        RowBox[{"DC", "[", "g__", "]"}], ":>", 
        RowBox[{"DC", "@@", 
         RowBox[{"Table", "[", 
          RowBox[{
           RowBox[{
            RowBox[{
             RowBox[{"{", "g", "}"}], "[", 
             RowBox[{"[", "ii", "]"}], "]"}], "/.", 
            RowBox[{
             RowBox[{"lI", "[", "ids__", "]"}], ":>", 
             RowBox[{"lI", "[", 
              RowBox[{"ii", ",", "ids"}], "]"}]}]}], ",", 
           RowBox[{"{", 
            RowBox[{"ii", ",", 
             RowBox[{"Length", "@", 
              RowBox[{"{", "g", "}"}]}]}], "}"}]}], "]"}]}]}]}], "/.", 
      RowBox[{"DC", "->", "Times"}]}]}]}], "\[IndentingNewLine]", 
   "]"}]}]}], "Input",
 CellChangeTimes->{{3.872034492365653*^9, 3.872034567286909*^9}, {
  3.8720347035629787`*^9, 3.872034758097516*^9}, {3.8720350050883617`*^9, 
  3.87203501817365*^9}},
 CellLabel->"In[74]:=",ExpressionUUID->"5a749aec-1210-4ad6-84cd-506b5a9ebae9"],

Cell[BoxData[{
 RowBox[{"ClearAll", "[", "FTensorReduce", "]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"FTensorReduce", "[", "f_", "]"}], ":=", 
  RowBox[{"f", "/.", 
   RowBox[{
    RowBox[{"dot", "[", 
     RowBox[{"a__", ",", 
      RowBox[{"F", "[", "i_", "]"}], ",", "b__"}], "]"}], ":>", " ", 
    RowBox[{
     RowBox[{
      FractionBox["1", 
       RowBox[{"dot", "[", 
        RowBox[{
         RowBox[{"v", "[", "2", "]"}], ",", 
         RowBox[{"p", "[", "i", "]"}]}], "]"}]], 
      RowBox[{"(", 
       RowBox[{
        RowBox[{
         RowBox[{"dot", "[", 
          RowBox[{"a", ",", 
           RowBox[{"F", "[", "i", "]"}], ",", 
           RowBox[{"v", "[", "2", "]"}]}], "]"}], 
         RowBox[{"dot", "[", 
          RowBox[{
           RowBox[{"p", "[", "i", "]"}], ",", "b"}], "]"}]}], "+", 
        RowBox[{
         RowBox[{"dot", "[", 
          RowBox[{
           RowBox[{"v", "[", "2", "]"}], ",", 
           RowBox[{"F", "[", "i", "]"}], ",", "b"}], "]"}], 
         RowBox[{"dot", "[", 
          RowBox[{"a", ",", 
           RowBox[{"p", "[", "i", "]"}]}], "]"}]}]}], ")"}]}], "/;", 
     RowBox[{"b", "=!=", 
      RowBox[{"v", "[", "2", "]"}]}]}]}]}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"FTensorReduce", "[", 
   RowBox[{"f_", ",", "v2_"}], "]"}], ":=", 
  RowBox[{"f", "/.", 
   RowBox[{
    RowBox[{"dot", "[", 
     RowBox[{"a__", ",", 
      RowBox[{"F", "[", "i_", "]"}], ",", "b__"}], "]"}], ":>", " ", 
    RowBox[{
     RowBox[{
      FractionBox["1", 
       RowBox[{"dot", "[", 
        RowBox[{"v2", ",", 
         RowBox[{"p", "[", "i", "]"}]}], "]"}]], 
      RowBox[{"(", 
       RowBox[{
        RowBox[{
         RowBox[{"dot", "[", 
          RowBox[{"a", ",", 
           RowBox[{"F", "[", "i", "]"}], ",", "v2"}], "]"}], 
         RowBox[{"dot", "[", 
          RowBox[{
           RowBox[{"p", "[", "i", "]"}], ",", "b"}], "]"}]}], "+", 
        RowBox[{
         RowBox[{"dot", "[", 
          RowBox[{"v2", ",", 
           RowBox[{"F", "[", "i", "]"}], ",", "b"}], "]"}], 
         RowBox[{"dot", "[", 
          RowBox[{"a", ",", 
           RowBox[{"p", "[", "i", "]"}]}], "]"}]}]}], ")"}]}], "/;", 
     RowBox[{"(", 
      RowBox[{
       RowBox[{"b", "=!=", "v2"}], "&&", 
       RowBox[{"a", "=!=", "v2"}]}], ")"}]}]}]}]}]}], "Input",
 CellChangeTimes->{{3.8710113197696133`*^9, 3.8710113205510817`*^9}},
 CellLabel->"In[76]:=",ExpressionUUID->"2ec6dc3b-1485-4a6a-943c-7859b690610e"],

Cell[BoxData[{
 RowBox[{"ClearAll", "[", "FTensorReduceG", "]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"FTensorReduceG", "[", 
   RowBox[{"f_", ",", "i_"}], "]"}], ":=", 
  RowBox[{"f", "/.", 
   RowBox[{
    RowBox[{"dot", "[", 
     RowBox[{"a__", ",", 
      RowBox[{"F", "[", "i", "]"}], ",", "b__"}], "]"}], ":>", " ", 
    RowBox[{
     RowBox[{
      FractionBox["1", 
       RowBox[{"dot", "[", 
        RowBox[{
         RowBox[{"v", "[", "2", "]"}], ",", 
         RowBox[{"p", "[", "i", "]"}]}], "]"}]], 
      RowBox[{"(", 
       RowBox[{
        RowBox[{
         RowBox[{"dot", "[", 
          RowBox[{"a", ",", 
           RowBox[{"F", "[", "i", "]"}], ",", 
           RowBox[{"v", "[", "2", "]"}]}], "]"}], 
         RowBox[{"dot", "[", 
          RowBox[{
           RowBox[{"p", "[", "i", "]"}], ",", "b"}], "]"}]}], "+", 
        RowBox[{
         RowBox[{"dot", "[", 
          RowBox[{
           RowBox[{"v", "[", "2", "]"}], ",", 
           RowBox[{"F", "[", "i", "]"}], ",", "b"}], "]"}], 
         RowBox[{"dot", "[", 
          RowBox[{"a", ",", 
           RowBox[{"p", "[", "i", "]"}]}], "]"}]}]}], ")"}]}], "/;", 
     RowBox[{
      RowBox[{
       RowBox[{"Length", "[", 
        RowBox[{"{", "a", "}"}], "]"}], ">=", "2"}], "&&", 
      RowBox[{
       RowBox[{"Length", "[", 
        RowBox[{"{", "b", "}"}], "]"}], ">=", "2"}]}]}]}]}]}]}], "Input",
 CellChangeTimes->{{3.8766049144819403`*^9, 3.8766049514374*^9}},
 CellLabel->"In[79]:=",ExpressionUUID->"d9319593-268b-4300-9501-a5620af6c839"],

Cell[BoxData[{
 RowBox[{"ClearAll", "[", "expandTr", "]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"expandTr", "[", "f_", "]"}], ":=", 
  RowBox[{
   RowBox[{
    RowBox[{"Module", "[", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{
        RowBox[{"lt", "=", 
         RowBox[{"Length", "[", "f", "]"}]}], ",", "ts"}], "}"}], ",", 
      RowBox[{"ts", "=", 
       RowBox[{"f", "/.", 
        RowBox[{
         RowBox[{"tr", "[", "g___", "]"}], ":>", " ", 
         RowBox[{"dot", "[", 
          RowBox[{
           RowBox[{"lI", "[", 
            RowBox[{"0", ",", "1"}], "]"}], ",", "g", ",", 
           RowBox[{"lI", "[", 
            RowBox[{"0", ",", "1"}], "]"}]}], "]"}]}]}]}]}], "]"}], "//", 
    "expandGen"}], "//", "expandF"}]}]}], "Input",
 CellChangeTimes->{{3.854191039354165*^9, 3.854191039594904*^9}, {
  3.854191096585668*^9, 3.8541911346819267`*^9}, {3.854191258960875*^9, 
  3.8541912891639442`*^9}, {3.854191345530801*^9, 3.8541913487274323`*^9}, {
  3.8541914272027063`*^9, 3.854191501571187*^9}, {3.854191759253392*^9, 
  3.8541917851217737`*^9}, {3.8541918354435787`*^9, 3.854191903651122*^9}, {
  3.8541921068331747`*^9, 3.854192117283308*^9}, {3.8765378395707912`*^9, 
  3.876537841794339*^9}},
 CellLabel->"In[81]:=",ExpressionUUID->"c4708be7-ddac-4167-915b-d46842db745f"],

Cell[BoxData[{
 RowBox[{"ClearAll", "[", "tr2dot", "]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"tr2dot", "[", "f_tr", "]"}], ":=", 
  RowBox[{"Module", "[", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{"last", ",", "vlist", ",", "plast", ",", "v1", ",", "v2"}], 
     "}"}], ",", 
    RowBox[{
     RowBox[{"last", "=", 
      RowBox[{"f", "[", 
       RowBox[{"[", 
        RowBox[{"-", "1"}], "]"}], "]"}]}], ";", 
     RowBox[{"plast", "=", 
      RowBox[{"p", "@@", "last"}]}], ";", 
     RowBox[{"vlist", "=", 
      RowBox[{
       RowBox[{"(", 
        RowBox[{"List", "@@", "f"}], ")"}], "[", 
       RowBox[{"[", 
        RowBox[{"1", ";;", 
         RowBox[{"-", "2"}]}], "]"}], "]"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"v1", "=", 
      RowBox[{"Join", "[", 
       RowBox[{
        RowBox[{"{", "plast", "}"}], ",", "vlist", ",", 
        RowBox[{"{", "last", "}"}], ",", 
        RowBox[{"{", "v", "}"}]}], "]"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"v2", "=", 
      RowBox[{"Join", "[", 
       RowBox[{
        RowBox[{"{", "v", "}"}], ",", 
        RowBox[{"{", "last", "}"}], ",", "vlist", ",", 
        RowBox[{"{", "plast", "}"}]}], "]"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{
      FractionBox[
       RowBox[{"dot", "@@", "v1"}], 
       RowBox[{"dot", "[", 
        RowBox[{"v", ",", "plast"}], "]"}]], "+", 
      FractionBox[
       RowBox[{"dot", "@@", "v2"}], 
       RowBox[{"dot", "[", 
        RowBox[{"v", ",", "plast"}], "]"}]]}]}]}], 
   "]"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"tr2dot", "[", 
   RowBox[{"f_tr", ",", "a_"}], "]"}], ":=", 
  RowBox[{"Module", "[", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{"last", ",", "vlist", ",", "plast", ",", "v1", ",", "v2"}], 
     "}"}], ",", 
    RowBox[{
     RowBox[{"last", "=", 
      RowBox[{"f", "[", 
       RowBox[{"[", 
        RowBox[{"-", "1"}], "]"}], "]"}]}], ";", 
     RowBox[{"plast", "=", 
      RowBox[{"p", "@@", "last"}]}], ";", 
     RowBox[{"vlist", "=", 
      RowBox[{
       RowBox[{"(", 
        RowBox[{"List", "@@", "f"}], ")"}], "[", 
       RowBox[{"[", 
        RowBox[{"1", ";;", 
         RowBox[{"-", "2"}]}], "]"}], "]"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"v1", "=", 
      RowBox[{"Join", "[", 
       RowBox[{
        RowBox[{"{", "plast", "}"}], ",", "vlist", ",", 
        RowBox[{"{", "last", "}"}], ",", 
        RowBox[{"{", "a", "}"}]}], "]"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"v2", "=", 
      RowBox[{"Join", "[", 
       RowBox[{
        RowBox[{"{", "a", "}"}], ",", 
        RowBox[{"{", "last", "}"}], ",", "vlist", ",", 
        RowBox[{"{", "plast", "}"}]}], "]"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{
      FractionBox[
       RowBox[{"dot", "@@", "v1"}], 
       RowBox[{"dot", "[", 
        RowBox[{"a", ",", "plast"}], "]"}]], "+", 
      FractionBox[
       RowBox[{"dot", "@@", "v2"}], 
       RowBox[{"dot", "[", 
        RowBox[{"a", ",", "plast"}], "]"}]]}]}]}], "]"}]}]}], "Input",
 CellLabel->"In[83]:=",ExpressionUUID->"da1678c0-82b0-4300-bfbc-d1f6eb039ac5"],

Cell[BoxData[{
 RowBox[{"ClearAll", "[", "antiSymrep", "]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"antiSymrep", "=", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{
      RowBox[{"dot", "[", 
       RowBox[{"a_", ",", 
        RowBox[{"F", "[", "i_", "]"}], ",", "b_"}], "]"}], ":>", " ", 
      RowBox[{
       RowBox[{"-", 
        RowBox[{"dot", "[", 
         RowBox[{"b", ",", 
          RowBox[{"F", "[", "i", "]"}], ",", "a"}], "]"}]}], "/;", 
       RowBox[{
        RowBox[{"Signature", "[", 
         RowBox[{"{", 
          RowBox[{"a", ",", "b"}], "}"}], "]"}], "<", "0"}]}]}], ",", 
     RowBox[{
      RowBox[{"dot", "[", 
       RowBox[{"a_", ",", 
        RowBox[{"F", "[", "i_", "]"}], ",", 
        RowBox[{"F", "[", "j_", "]"}], ",", "b_"}], "]"}], ":>", " ", 
      RowBox[{
       RowBox[{"dot", "[", 
        RowBox[{"b", ",", 
         RowBox[{"F", "[", "j", "]"}], ",", 
         RowBox[{"F", "[", "i", "]"}], ",", "a"}], "]"}], "/;", 
       RowBox[{"i", ">", "j"}]}]}]}], "}"}]}], ";"}]}], "Input",
 CellChangeTimes->{{3.853462108697447*^9, 3.853462142837044*^9}, {
  3.8534646323189697`*^9, 3.8534646409716263`*^9}},
 CellLabel->"In[86]:=",ExpressionUUID->"bb9d1e39-1bb7-41c6-b251-dcebffea133c"],

Cell[BoxData[{
 RowBox[{"ClearAll", "[", "CombWithRep", "]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"CombWithRep", "[", 
   RowBox[{"ls_", ",", "n_"}], "]"}], ":=", 
  RowBox[{
   RowBox[{"(", 
    RowBox[{"List", "@@", 
     RowBox[{"(", 
      RowBox[{"Diamond", "@@", 
       RowBox[{"Table", "[", 
        RowBox[{
         RowBox[{"Total", "[", "ls", "]"}], ",", 
         RowBox[{"{", 
          RowBox[{"i", ",", "n"}], "}"}]}], "]"}]}], ")"}]}], ")"}], "/.", 
   RowBox[{"Diamond", "->", " ", "List"}]}]}]}], "Input",
 CellLabel->"In[88]:=",ExpressionUUID->"8c7dc4b2-591e-4db4-b91a-1285414fe61d"],

Cell[BoxData[{
 RowBox[{"ClearAll", "[", "minSets", "]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"minSets", "[", "list_List", "]"}], ":=", 
  RowBox[{"Block", "[", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{
      RowBox[{"u", "=", 
       RowBox[{"Union", "@", "list"}]}], ",", "r"}], "}"}], ",", 
    RowBox[{"Pick", "[", 
     RowBox[{"u", ",", 
      RowBox[{"Subtract", "[", 
       RowBox[{
        RowBox[{"BitAnd", "@@@", 
         RowBox[{"Replace", "[", 
          RowBox[{"u", ",", 
           RowBox[{"With", "[", 
            RowBox[{
             RowBox[{"{", 
              RowBox[{"g", "=", 
               RowBox[{"GatherBy", "[", 
                RowBox[{
                 RowBox[{"Transpose", "[", 
                  RowBox[{"{", 
                   RowBox[{
                    RowBox[{"Join", "@@", "u"}], ",", 
                    RowBox[{"Join", "@@", 
                    RowBox[{"MapThread", "[", 
                    RowBox[{"ConstantArray", ",", 
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{"r", "=", 
                    RowBox[{"2", "^", 
                    RowBox[{"Range", "[", 
                    RowBox[{"0", ",", 
                    RowBox[{
                    RowBox[{"Length", "@", "u"}], "-", "1"}]}], "]"}]}]}], 
                    ",", 
                    RowBox[{"Length", "/@", "u"}]}], "}"}]}], "]"}]}]}], 
                   "}"}], "]"}], ",", "First"}], "]"}]}], "}"}], ",", 
             RowBox[{"Dispatch", "@", 
              RowBox[{"Thread", "[", 
               RowBox[{
                RowBox[{"g", "[", 
                 RowBox[{"[", 
                  RowBox[{"All", ",", "1", ",", "1"}], "]"}], "]"}], "->", 
                RowBox[{"Total", "[", 
                 RowBox[{
                  RowBox[{"g", "[", 
                   RowBox[{"[", 
                    RowBox[{"All", ",", "All", ",", "2"}], "]"}], "]"}], ",", 
                  
                  RowBox[{"{", "2", "}"}]}], "]"}]}], "]"}]}]}], "]"}], ",", 
           RowBox[{"{", "2", "}"}]}], "]"}]}], ",", "r"}], "]"}], ",", "0"}], 
     "]"}]}], "]"}]}]}], "Input",
 CellLabel->"In[90]:=",ExpressionUUID->"571ee68b-1968-468a-8457-68ec7313b97e"],

Cell[BoxData[{
 RowBox[{"ClearAll", "[", "expandTensorFi", "]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"expandTensorFi", "[", 
   RowBox[{"f_dot", ",", "id_"}], "]"}], ":=", 
  RowBox[{
   RowBox[{"f", "/.", 
    RowBox[{
     RowBox[{"dot", "[", 
      RowBox[{"a__", ",", 
       RowBox[{"F", "[", "id", "]"}], ",", "g___", ",", 
       RowBox[{"F", "[", "id", "]"}], ",", "b__"}], "]"}], ":>", 
     RowBox[{
      RowBox[{"dot", "[", 
       RowBox[{"a", ",", 
        RowBox[{"lI", "[", 
         RowBox[{"id", ",", "1", ",", "1"}], "]"}]}], "]"}], 
      RowBox[{"dot", "[", 
       RowBox[{
        RowBox[{"lI", "[", 
         RowBox[{"id", ",", "1", ",", "2"}], "]"}], ",", "g", ",", 
        RowBox[{"lI", "[", 
         RowBox[{"id", ",", "2", ",", "1"}], "]"}]}], "]"}], 
      RowBox[{"dot", "[", 
       RowBox[{
        RowBox[{"lI", "[", 
         RowBox[{"id", ",", "2", ",", "2"}], "]"}], ",", "b"}], "]"}], 
      RowBox[{"(", 
       RowBox[{
        RowBox[{
         RowBox[{
          RowBox[{"p", "[", "id", "]"}], "[", 
          RowBox[{"lI", "[", 
           RowBox[{"id", ",", "1", ",", "1"}], "]"}], "]"}], 
         RowBox[{
          RowBox[{"\[Epsilon]", "[", "id", "]"}], "[", 
          RowBox[{"lI", "[", 
           RowBox[{"id", ",", "1", ",", "2"}], "]"}], "]"}]}], "-", 
        RowBox[{
         RowBox[{
          RowBox[{"\[Epsilon]", "[", "id", "]"}], "[", 
          RowBox[{"lI", "[", 
           RowBox[{"id", ",", "1", ",", "1"}], "]"}], "]"}], 
         RowBox[{
          RowBox[{"p", "[", "id", "]"}], "[", 
          RowBox[{"lI", "[", 
           RowBox[{"id", ",", "1", ",", "2"}], "]"}], "]"}]}]}], ")"}], 
      RowBox[{"(", 
       RowBox[{
        RowBox[{
         RowBox[{
          RowBox[{"p", "[", "id", "]"}], "[", 
          RowBox[{"lI", "[", 
           RowBox[{"id", ",", "2", ",", "1"}], "]"}], "]"}], 
         RowBox[{
          RowBox[{"\[Epsilon]", "[", "id", "]"}], "[", 
          RowBox[{"lI", "[", 
           RowBox[{"id", ",", "2", ",", "2"}], "]"}], "]"}]}], "-", 
        RowBox[{
         RowBox[{
          RowBox[{"\[Epsilon]", "[", "id", "]"}], "[", 
          RowBox[{"lI", "[", 
           RowBox[{"id", ",", "2", ",", "1"}], "]"}], "]"}], 
         RowBox[{
          RowBox[{"p", "[", "id", "]"}], "[", 
          RowBox[{"lI", "[", 
           RowBox[{"id", ",", "2", ",", "2"}], "]"}], "]"}]}]}], ")"}]}]}]}], 
   "/.", 
   RowBox[{
    RowBox[{"dot", "[", 
     RowBox[{"a__", ",", 
      RowBox[{"F", "[", "id", "]"}], ",", "b__"}], "]"}], ":>", 
    RowBox[{
     RowBox[{"dot", "[", 
      RowBox[{"a", ",", 
       RowBox[{"lI", "[", 
        RowBox[{"id", ",", "1"}], "]"}]}], "]"}], 
     RowBox[{"dot", "[", 
      RowBox[{
       RowBox[{"lI", "[", 
        RowBox[{"id", ",", "2"}], "]"}], ",", "b"}], "]"}], 
     RowBox[{"(", 
      RowBox[{
       RowBox[{
        RowBox[{
         RowBox[{"p", "[", "id", "]"}], "[", 
         RowBox[{"lI", "[", 
          RowBox[{"id", ",", "1"}], "]"}], "]"}], 
        RowBox[{
         RowBox[{"\[Epsilon]", "[", "id", "]"}], "[", 
         RowBox[{"lI", "[", 
          RowBox[{"id", ",", "2"}], "]"}], "]"}]}], "-", 
       RowBox[{
        RowBox[{
         RowBox[{"\[Epsilon]", "[", "id", "]"}], "[", 
         RowBox[{"lI", "[", 
          RowBox[{"id", ",", "1"}], "]"}], "]"}], 
        RowBox[{
         RowBox[{"p", "[", "id", "]"}], "[", 
         RowBox[{"lI", "[", 
          RowBox[{"id", ",", "2"}], "]"}], "]"}]}]}], 
      ")"}]}]}]}]}], "\[IndentingNewLine]", 
 RowBox[{"ClearAll", "[", "expandTensorFiGen", "]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"expandTensorFiGen", "[", 
   RowBox[{"f_", ",", "id_"}], "]"}], ":=", 
  RowBox[{"Module", "[", 
   RowBox[{
    RowBox[{"{", "res", "}"}], ",", 
    RowBox[{
     RowBox[{"res", "=", 
      RowBox[{"f", "//.", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{
          RowBox[{"Power", "[", 
           RowBox[{
            RowBox[{"dot", "[", 
             RowBox[{"g__", ",", 
              RowBox[{"F", "[", "id", "]"}], ",", "h__"}], "]"}], ",", "2"}], 
           "]"}], ":>", 
          RowBox[{"DC", "@@", 
           RowBox[{"Table", "[", 
            RowBox[{
             RowBox[{"dot", "[", 
              RowBox[{"g", ",", 
               RowBox[{"F", "[", "id", "]"}], ",", "h"}], "]"}], ",", 
             RowBox[{"{", 
              RowBox[{"ii", ",", "2"}], "}"}]}], "]"}]}]}], ",", 
         RowBox[{
          RowBox[{"Times", "[", 
           RowBox[{
            RowBox[{"dot", "[", 
             RowBox[{"g__", ",", 
              RowBox[{"F", "[", "id", "]"}], ",", "h__"}], "]"}], ",", 
            RowBox[{"dot", "[", 
             RowBox[{"g1__", ",", 
              RowBox[{"F", "[", "id", "]"}], ",", "h1__"}], "]"}]}], "]"}], ":>", 
          RowBox[{"DC", "[", 
           RowBox[{
            RowBox[{"dot", "[", 
             RowBox[{"g", ",", 
              RowBox[{"F", "[", "id", "]"}], ",", "h"}], "]"}], ",", 
            RowBox[{"dot", "[", 
             RowBox[{"g1", ",", 
              RowBox[{"F", "[", "id", "]"}], ",", "h1"}], "]"}]}], "]"}]}]}], 
        "}"}]}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"(*", 
      RowBox[{
       RowBox[{"Print", "[", "res", "]"}], ";"}], "*)"}], 
     "\[IndentingNewLine]", 
     RowBox[{"res", "=", 
      RowBox[{"res", "//.", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{
          RowBox[{"Power", "[", 
           RowBox[{
            RowBox[{"dot", "[", 
             RowBox[{"g_", ",", 
              RowBox[{"\[Epsilon]", "[", "id", "]"}]}], "]"}], ",", "2"}], 
           "]"}], ":>", 
          RowBox[{"DC", "@@", 
           RowBox[{"Table", "[", 
            RowBox[{
             RowBox[{"dot", "[", 
              RowBox[{"g", ",", 
               RowBox[{"\[Epsilon]", "[", "id", "]"}]}], "]"}], ",", 
             RowBox[{"{", 
              RowBox[{"ii", ",", "2"}], "}"}]}], "]"}]}]}], ",", 
         RowBox[{
          RowBox[{"Power", "[", 
           RowBox[{
            RowBox[{"dot", "[", 
             RowBox[{
              RowBox[{"\[Epsilon]", "[", "id", "]"}], ",", "g_"}], "]"}], ",",
             "2"}], "]"}], ":>", 
          RowBox[{"DC", "@@", 
           RowBox[{"Table", "[", 
            RowBox[{
             RowBox[{"dot", "[", 
              RowBox[{
               RowBox[{"\[Epsilon]", "[", "id", "]"}], ",", "g"}], "]"}], ",", 
             RowBox[{"{", 
              RowBox[{"ii", ",", "2"}], "}"}]}], "]"}]}]}], ",", 
         RowBox[{
          RowBox[{"Times", "[", 
           RowBox[{
            RowBox[{"dot", "[", 
             RowBox[{"g_", ",", 
              RowBox[{"\[Epsilon]", "[", "id", "]"}]}], "]"}], ",", 
            RowBox[{"dot", "[", 
             RowBox[{"g1_", ",", 
              RowBox[{"\[Epsilon]", "[", "id", "]"}]}], "]"}]}], "]"}], ":>", 
          
          RowBox[{"DC", "[", 
           RowBox[{
            RowBox[{"dot", "[", 
             RowBox[{"g", ",", 
              RowBox[{"\[Epsilon]", "[", "id", "]"}]}], "]"}], ",", 
            RowBox[{"dot", "[", 
             RowBox[{"g1", ",", 
              RowBox[{"\[Epsilon]", "[", "id", "]"}]}], "]"}]}], "]"}]}], ",", 
         RowBox[{
          RowBox[{"Times", "[", 
           RowBox[{
            RowBox[{"dot", "[", 
             RowBox[{
              RowBox[{"\[Epsilon]", "[", "id", "]"}], ",", "g_"}], "]"}], ",", 
            RowBox[{"dot", "[", 
             RowBox[{"g1_", ",", 
              RowBox[{"\[Epsilon]", "[", "id", "]"}]}], "]"}]}], "]"}], ":>", 
          
          RowBox[{"DC", "[", 
           RowBox[{
            RowBox[{"dot", "[", 
             RowBox[{
              RowBox[{"\[Epsilon]", "[", "id", "]"}], ",", "g"}], "]"}], ",", 
            
            RowBox[{"dot", "[", 
             RowBox[{"g1", ",", 
              RowBox[{"\[Epsilon]", "[", "id", "]"}]}], "]"}]}], "]"}]}], ",", 
         RowBox[{
          RowBox[{"Times", "[", 
           RowBox[{
            RowBox[{"dot", "[", 
             RowBox[{"g_", ",", 
              RowBox[{"\[Epsilon]", "[", "id", "]"}]}], "]"}], ",", 
            RowBox[{"dot", "[", 
             RowBox[{
              RowBox[{"\[Epsilon]", "[", "id", "]"}], ",", "g1_"}], "]"}]}], 
           "]"}], ":>", 
          RowBox[{"DC", "[", 
           RowBox[{
            RowBox[{"dot", "[", 
             RowBox[{"g", ",", 
              RowBox[{"\[Epsilon]", "[", "id", "]"}]}], "]"}], ",", 
            RowBox[{"dot", "[", 
             RowBox[{
              RowBox[{"\[Epsilon]", "[", "id", "]"}], ",", "g1"}], "]"}]}], 
           "]"}]}], ",", 
         RowBox[{
          RowBox[{"Times", "[", 
           RowBox[{
            RowBox[{"dot", "[", 
             RowBox[{
              RowBox[{"\[Epsilon]", "[", "id", "]"}], ",", "g_"}], "]"}], ",", 
            RowBox[{"dot", "[", 
             RowBox[{
              RowBox[{"\[Epsilon]", "[", "id", "]"}], ",", "g1_"}], "]"}]}], 
           "]"}], ":>", 
          RowBox[{"DC", "[", 
           RowBox[{
            RowBox[{"dot", "[", 
             RowBox[{
              RowBox[{"\[Epsilon]", "[", "id", "]"}], ",", "g"}], "]"}], ",", 
            
            RowBox[{"dot", "[", 
             RowBox[{
              RowBox[{"\[Epsilon]", "[", "id", "]"}], ",", "g1"}], "]"}]}], 
           "]"}]}]}], "}"}]}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"(*", 
      RowBox[{
       RowBox[{"Print", "[", "res", "]"}], ";"}], "*)"}], 
     "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{
       RowBox[{
        RowBox[{
         RowBox[{"res", "/.", 
          RowBox[{
           RowBox[{"dot", "[", "g__", "]"}], ":>", 
           RowBox[{"expandTensorFi", "[", 
            RowBox[{
             RowBox[{"dot", "[", "g", "]"}], ",", "id"}], "]"}]}]}], "/.", 
         RowBox[{
          RowBox[{"dot", "[", 
           RowBox[{"g_", ",", 
            RowBox[{"\[Epsilon]", "[", "id", "]"}]}], "]"}], ":>", 
          RowBox[{
           RowBox[{"g", "[", 
            RowBox[{"lI", "[", 
             RowBox[{"0", ",", "id"}], "]"}], "]"}], 
           RowBox[{
            RowBox[{"\[Epsilon]", "[", "id", "]"}], "[", 
            RowBox[{"lI", "[", 
             RowBox[{"0", ",", "id"}], "]"}], "]"}]}]}]}], "/.", 
        RowBox[{
         RowBox[{"dot", "[", 
          RowBox[{
           RowBox[{"\[Epsilon]", "[", "id", "]"}], ",", "g_"}], "]"}], ":>", 
         RowBox[{
          RowBox[{"g", "[", 
           RowBox[{"lI", "[", 
            RowBox[{"0", ",", "id"}], "]"}], "]"}], 
          RowBox[{
           RowBox[{"\[Epsilon]", "[", "id", "]"}], "[", 
           RowBox[{"lI", "[", 
            RowBox[{"0", ",", "id"}], "]"}], "]"}]}]}]}], "/.", 
       RowBox[{
        RowBox[{"DC", "[", "g__", "]"}], ":>", 
        RowBox[{"DC", "@@", 
         RowBox[{"Table", "[", 
          RowBox[{
           RowBox[{
            RowBox[{
             RowBox[{"{", "g", "}"}], "[", 
             RowBox[{"[", "ii", "]"}], "]"}], "/.", 
            RowBox[{
             RowBox[{"lI", "[", "ids__", "]"}], ":>", 
             RowBox[{"lI", "[", 
              RowBox[{"ii", ",", "ids"}], "]"}]}]}], ",", 
           RowBox[{"{", 
            RowBox[{"ii", ",", 
             RowBox[{"Length", "@", 
              RowBox[{"{", "g", "}"}]}]}], "}"}]}], "]"}]}]}]}], "/.", 
      RowBox[{"DC", "->", "Times"}]}]}]}], "\[IndentingNewLine]", 
   "]"}]}]}], "Input",
 CellChangeTimes->{{3.8717101857556257`*^9, 3.871710247171233*^9}, {
   3.871710344490424*^9, 3.871710464250885*^9}, {3.871710514216856*^9, 
   3.871710535067227*^9}, {3.871710577772479*^9, 3.871710619653611*^9}, {
   3.87171070099017*^9, 3.871710793817266*^9}, {3.8717110547727757`*^9, 
   3.871711098694851*^9}, {3.871711566802866*^9, 3.8717116001589727`*^9}, {
   3.8717925794231157`*^9, 3.8717926279638968`*^9}, {3.871792658993463*^9, 
   3.871792659631276*^9}, 3.871792836017084*^9, {3.871792881937099*^9, 
   3.871792936440737*^9}, {3.871793027757831*^9, 3.871793027984799*^9}, {
   3.8717930770034943`*^9, 3.8717931563424873`*^9}, {3.871793189683238*^9, 
   3.871793219777211*^9}, {3.871794218005933*^9, 3.8717942969355288`*^9}, {
   3.871794593480941*^9, 3.871794608503077*^9}, {3.871794745604311*^9, 
   3.87179476760977*^9}, {3.871794877507155*^9, 3.871794880713606*^9}, {
   3.871794991131771*^9, 3.87179509392428*^9}, {3.8717951470684958`*^9, 
   3.871795182954617*^9}, {3.8718603028865423`*^9, 3.871860327016007*^9}, {
   3.871860459558563*^9, 3.871860475007077*^9}, {3.871878859716531*^9, 
   3.871878883200115*^9}, {3.871878943674459*^9, 3.8718789878517*^9}, {
   3.871879040687913*^9, 3.871879042718019*^9}, {3.8718797681531343`*^9, 
   3.871879772859611*^9}, {3.8718798541089087`*^9, 3.871880037163097*^9}, {
   3.8765284853468723`*^9, 3.8765285056137733`*^9}, {3.876528614447425*^9, 
   3.8765286203250027`*^9}, {3.876529061202283*^9, 3.876529118675256*^9}, {
   3.876535688731642*^9, 3.876535689308138*^9}},
 CellLabel->"In[92]:=",ExpressionUUID->"f6470b2b-1430-493f-b954-d80193a6e8b3"],

Cell[BoxData[{
 RowBox[{
  RowBox[{"ClearAll", "[", "GlueAmp2", "]"}], " ", 
  RowBox[{"(*", 
   RowBox[{"Slow", " ", "function", " ", "for", " ", "testing"}], 
   "*)"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"GlueAmp2", "[", 
   RowBox[{"f__", ",", "pi_"}], "]"}], ":=", 
  RowBox[{"Module", "[", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{"res", ",", 
      RowBox[{"los", "=", 
       RowBox[{"lo", "@@", "pi"}]}], ",", 
      RowBox[{"lis", "=", "pi"}]}], "}"}], ",", 
    RowBox[{
     RowBox[{"res", "=", 
      RowBox[{
       RowBox[{"Times", "[", "f", "]"}], "/.", 
       RowBox[{
        RowBox[{"A", "[", 
         RowBox[{"g_", ",", "vv_", ",", "ps_"}], "]"}], ":>", 
        RowBox[{"(", 
         RowBox[{
          RowBox[{"g", "/.", 
           RowBox[{"v", "->", "vv"}]}], "/.", 
          RowBox[{"MapThread", "[", 
           RowBox[{"Rule", ",", 
            RowBox[{"{", 
             RowBox[{
              RowBox[{"p", "/@", 
               RowBox[{"Range", "[", 
                RowBox[{"Length", "@", "ps"}], "]"}]}], ",", "ps"}], "}"}]}], 
           "]"}]}], ")"}]}]}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"res", "=", 
      RowBox[{
       RowBox[{
        RowBox[{
         RowBox[{"res", "//", "expandGen"}], "//", 
         RowBox[{
          RowBox[{"expandF", "[", 
           RowBox[{"#", ",", "lis"}], "]"}], "&"}]}], "//", 
        RowBox[{
         RowBox[{"expandF", "[", 
          RowBox[{"#", ",", "los"}], "]"}], "&"}]}], "//", "Expand"}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"res", "=", 
      RowBox[{
       RowBox[{"res", "/.", 
        RowBox[{
         RowBox[{
          RowBox[{
           RowBox[{"\[Epsilon]", "[", "lis", "]"}], "[", "a1_", "]"}], 
          RowBox[{
           RowBox[{"\[Epsilon]", "[", "lis", "]"}], "[", "a2_", "]"}], 
          RowBox[{
           RowBox[{"\[Epsilon]", "[", "los", "]"}], "[", "b1_", "]"}], 
          RowBox[{
           RowBox[{"\[Epsilon]", "[", "los", "]"}], "[", "b2_", "]"}]}], ":>", 
         RowBox[{
          FractionBox["1", "2"], 
          RowBox[{"(", 
           RowBox[{
            RowBox[{
             RowBox[{"eta", "[", 
              RowBox[{"a1", ",", "b1"}], "]"}], 
             RowBox[{"eta", "[", 
              RowBox[{"a2", ",", "b2"}], "]"}]}], "+", 
            RowBox[{
             RowBox[{"eta", "[", 
              RowBox[{"a1", ",", "b2"}], "]"}], 
             RowBox[{"eta", "[", 
              RowBox[{"a2", ",", "b1"}], "]"}]}], "-", 
            RowBox[{
             FractionBox["2", 
              RowBox[{"DD", "-", "2"}]], 
             RowBox[{"eta", "[", 
              RowBox[{"a1", ",", "a2"}], "]"}], 
             RowBox[{"eta", "[", 
              RowBox[{"b1", ",", "b2"}], "]"}]}]}], ")"}]}]}]}], "//", 
       "contractAnti"}]}]}]}], "\[IndentingNewLine]", "]"}]}]}], "Input",
 CellChangeTimes->{{3.871712600587709*^9, 3.871712670352553*^9}, {
  3.871712848705008*^9, 3.8717128512044077`*^9}, {3.8717156142755423`*^9, 
  3.871715631992737*^9}, {3.871945244409588*^9, 3.871945272183694*^9}, {
  3.872034874753574*^9, 3.872034875714731*^9}},
 CellLabel->"In[96]:=",ExpressionUUID->"311cb0de-bc70-4e6d-8af5-84e5a3960e94"],

Cell[BoxData[{
 RowBox[{"ClearAll", "[", "GlueAmp3", "]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"GlueAmp3", "[", 
   RowBox[{"f__", ",", "pi_"}], "]"}], ":=", 
  RowBox[{"Module", "[", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{"res", ",", 
      RowBox[{"los", "=", 
       RowBox[{"lo", "@@", "pi"}]}], ",", 
      RowBox[{"lis", "=", "pi"}]}], "}"}], ",", 
    RowBox[{
     RowBox[{"res", "=", 
      RowBox[{
       RowBox[{"Times", "[", "f", "]"}], "/.", 
       RowBox[{
        RowBox[{"A", "[", 
         RowBox[{"g_", ",", "vv_", ",", "ps_"}], "]"}], ":>", 
        RowBox[{"(", 
         RowBox[{
          RowBox[{"g", "/.", 
           RowBox[{"v", "->", "vv"}]}], "/.", 
          RowBox[{"MapThread", "[", 
           RowBox[{"Rule", ",", 
            RowBox[{"{", 
             RowBox[{
              RowBox[{"p", "/@", 
               RowBox[{"Range", "[", 
                RowBox[{"Length", "@", "ps"}], "]"}]}], ",", "ps"}], "}"}]}], 
           "]"}]}], ")"}]}]}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"res", "=", 
      RowBox[{
       RowBox[{"res", "//", 
        RowBox[{
         RowBox[{"expandTensorFiGen", "[", 
          RowBox[{"#", ",", "lis"}], "]"}], "&"}]}], "//", "Expand"}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"res", "=", 
      RowBox[{
       RowBox[{"res", "//", 
        RowBox[{
         RowBox[{"expandTensorFiGen", "[", 
          RowBox[{"#", ",", "los"}], "]"}], "&"}]}], "//", "Expand"}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"res", "=", 
      RowBox[{"res", "/.", 
       RowBox[{
        RowBox[{
         RowBox[{
          RowBox[{"\[Epsilon]", "[", "lis", "]"}], "[", "a1_", "]"}], 
         RowBox[{
          RowBox[{"\[Epsilon]", "[", "lis", "]"}], "[", "a2_", "]"}], 
         RowBox[{
          RowBox[{"\[Epsilon]", "[", "los", "]"}], "[", "b1_", "]"}], 
         RowBox[{
          RowBox[{"\[Epsilon]", "[", "los", "]"}], "[", "b2_", "]"}]}], ":>", 
        
        RowBox[{
         FractionBox["1", "2"], 
         RowBox[{"(", 
          RowBox[{
           RowBox[{
            RowBox[{"eta", "[", 
             RowBox[{"a1", ",", "b1"}], "]"}], 
            RowBox[{"eta", "[", 
             RowBox[{"a2", ",", "b2"}], "]"}]}], "+", 
           RowBox[{
            RowBox[{"eta", "[", 
             RowBox[{"a1", ",", "b2"}], "]"}], 
            RowBox[{"eta", "[", 
             RowBox[{"a2", ",", "b1"}], "]"}]}], "-", 
           RowBox[{
            FractionBox["2", 
             RowBox[{"DD", "-", "2"}]], 
            RowBox[{"eta", "[", 
             RowBox[{"a1", ",", "a2"}], "]"}], 
            RowBox[{"eta", "[", 
             RowBox[{"b1", ",", "b2"}], "]"}]}]}], ")"}]}]}]}]}]}]}], 
   "\[IndentingNewLine]", "]"}]}]}], "Input",
 CellChangeTimes->{{3.87194534060808*^9, 3.871945346058714*^9}},
 CellLabel->"In[98]:=",ExpressionUUID->"9ba83756-e9e0-4b81-b452-76fe18ad8619"],

Cell[BoxData[{
 RowBox[{"ClearAll", "[", "GlueAmp", "]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"GlueAmp", "[", 
   RowBox[{"f__", ",", "pi_li"}], "]"}], ":=", 
  RowBox[{"Module", "[", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{"res", ",", 
      RowBox[{"los", "=", 
       RowBox[{"lo", "@@", "pi"}]}], ",", 
      RowBox[{"lis", "=", "pi"}]}], "}"}], ",", 
    RowBox[{
     RowBox[{"res", "=", 
      RowBox[{
       RowBox[{
        RowBox[{"Times", "[", "f", "]"}], "/.", 
        RowBox[{
         RowBox[{"A", "[", 
          RowBox[{"g_", ",", "vv_", ",", "ps_"}], "]"}], ":>", 
         RowBox[{"(", 
          RowBox[{
           RowBox[{"g", "/.", 
            RowBox[{"v", "->", "vv"}]}], "/.", 
           RowBox[{"MapThread", "[", 
            RowBox[{"Rule", ",", 
             RowBox[{"{", 
              RowBox[{
               RowBox[{"p", "/@", 
                RowBox[{"Range", "[", 
                 RowBox[{"Length", "@", "ps"}], "]"}]}], ",", "ps"}], "}"}]}],
             "]"}]}], ")"}]}]}], "//", "Expand"}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"res", "=", 
      RowBox[{
       RowBox[{"res", "//", 
        RowBox[{
         RowBox[{"expandTensorFiGen", "[", 
          RowBox[{"#", ",", "lis"}], "]"}], "&"}]}], "//", "Expand"}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"res", "=", 
      RowBox[{
       RowBox[{"res", "//", 
        RowBox[{
         RowBox[{"expandTensorFiGen", "[", 
          RowBox[{"#", ",", "los"}], "]"}], "&"}]}], "//", "Expand"}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"res", "=", 
      RowBox[{
       RowBox[{"res", "/.", 
        RowBox[{
         RowBox[{
          RowBox[{
           RowBox[{"\[Epsilon]", "[", "lis", "]"}], "[", "a1_", "]"}], 
          RowBox[{
           RowBox[{"\[Epsilon]", "[", "lis", "]"}], "[", "a2_", "]"}], 
          RowBox[{
           RowBox[{"\[Epsilon]", "[", "los", "]"}], "[", "b1_", "]"}], 
          RowBox[{
           RowBox[{"\[Epsilon]", "[", "los", "]"}], "[", "b2_", "]"}]}], ":>", 
         RowBox[{
          FractionBox["1", "2"], 
          RowBox[{"(", 
           RowBox[{
            RowBox[{
             RowBox[{"eta", "[", 
              RowBox[{"a1", ",", "b1"}], "]"}], 
             RowBox[{"eta", "[", 
              RowBox[{"a2", ",", "b2"}], "]"}]}], "+", 
            RowBox[{
             RowBox[{"eta", "[", 
              RowBox[{"a1", ",", "b2"}], "]"}], 
             RowBox[{"eta", "[", 
              RowBox[{"a2", ",", "b1"}], "]"}]}], "-", 
            RowBox[{
             FractionBox["2", 
              RowBox[{"DD", "-", "2"}]], 
             RowBox[{"eta", "[", 
              RowBox[{"a1", ",", "a2"}], "]"}], 
             RowBox[{"eta", "[", 
              RowBox[{"b1", ",", "b2"}], "]"}]}]}], ")"}]}]}]}], "//", 
       "contractAnti"}]}]}]}], "\[IndentingNewLine]", "]"}]}]}], "Input",
 CellChangeTimes->{{3.717672845976037*^9, 3.717672889169771*^9}, {
   3.717674925531893*^9, 3.71767495835476*^9}, {3.717675063695549*^9, 
   3.717675066478118*^9}, {3.717675300930599*^9, 3.7176753267138968`*^9}, {
   3.7176753870934343`*^9, 3.717675403057289*^9}, {3.7176754381874647`*^9, 
   3.71767547431498*^9}, 3.717675660783152*^9, {3.717736602639456*^9, 
   3.7177366242846107`*^9}, {3.717737468069676*^9, 3.717737480653091*^9}, {
   3.717750828787468*^9, 3.717750872340436*^9}, {3.718860636025526*^9, 
   3.718860640412352*^9}, {3.7188607903613377`*^9, 3.718860795560849*^9}, 
   3.71886086446344*^9, {3.718860948446919*^9, 3.718860951595491*^9}, 
   3.718860984899868*^9, {3.721238842235695*^9, 3.721238843744174*^9}, {
   3.721410336076936*^9, 3.7214103369702473`*^9}, {3.721412975267428*^9, 
   3.721412988890263*^9}, {3.72141323618769*^9, 3.7214132364838457`*^9}, 
   3.7214147264125347`*^9, {3.722247891811057*^9, 3.722247901391345*^9}, {
   3.727163630705885*^9, 3.727163679035369*^9}, {3.7271813171878366`*^9, 
   3.727181351523305*^9}, {3.727181477010126*^9, 3.727181501954378*^9}, {
   3.7569617666765738`*^9, 3.756961766784175*^9}, {3.756961870648288*^9, 
   3.756961949579342*^9}, {3.756962094598337*^9, 3.7569621098574553`*^9}, {
   3.756962167672611*^9, 3.7569621739207697`*^9}, {3.7569622139938307`*^9, 
   3.7569622426119537`*^9}, 3.756962373458827*^9, {3.809660362743723*^9, 
   3.809660418070587*^9}, {3.8096614085618067`*^9, 3.809661412551626*^9}, {
   3.809662049147789*^9, 3.809662101747892*^9}, {3.8096621462298317`*^9, 
   3.809662152164967*^9}, {3.809695613944919*^9, 3.809695685233942*^9}, 
   3.809695754647512*^9, {3.809695795605771*^9, 3.809695832316655*^9}, {
   3.809695960033867*^9, 3.809696106429303*^9}, {3.809696168645002*^9, 
   3.8096962031609497`*^9}, {3.80969630311021*^9, 3.809696333870982*^9}, {
   3.809696500996005*^9, 3.809696552942379*^9}, {3.8096965843172007`*^9, 
   3.809696642216886*^9}, {3.80969668037805*^9, 3.809696725452177*^9}, {
   3.8096968004483547`*^9, 3.809696937098598*^9}, {3.8096969918981867`*^9, 
   3.8096970974956913`*^9}, {3.809697150172176*^9, 3.809697151784438*^9}, {
   3.809851404069126*^9, 3.8098514312721767`*^9}, {3.8098515608428*^9, 
   3.8098515619391623`*^9}, {3.81000416196408*^9, 3.81000419966461*^9}, {
   3.810004329672138*^9, 3.810004330140016*^9}, {3.810012567227653*^9, 
   3.8100125857543917`*^9}, {3.849077219402678*^9, 3.8490772205862703`*^9}, {
   3.849077274201914*^9, 3.849077275031169*^9}, {3.8499313915236273`*^9, 
   3.84993139457652*^9}, {3.849936499751693*^9, 3.849936522953876*^9}, {
   3.8500933864282*^9, 3.850093395755972*^9}, {3.8500936471419897`*^9, 
   3.85009368571201*^9}, 3.8518569570609493`*^9, 3.853202602524168*^9, 
   3.853215130512108*^9, 3.857451044110569*^9, 3.871297285245735*^9, {
   3.871619444103547*^9, 3.871619451260944*^9}, {3.871619490117971*^9, 
   3.871619521315403*^9}, {3.871619619378182*^9, 3.87161962417244*^9}, {
   3.8716196556270733`*^9, 3.871619681596793*^9}, {3.871619831706586*^9, 
   3.871619864427882*^9}, {3.8716213205601892`*^9, 3.871621333226293*^9}, {
   3.871625017999157*^9, 3.871625241366728*^9}, {3.871625291216332*^9, 
   3.871625359241075*^9}, {3.871625493107828*^9, 3.8716254955113497`*^9}, {
   3.8716255615364437`*^9, 3.871625564022999*^9}, 3.871625841369969*^9, {
   3.87162607082874*^9, 3.871626075743566*^9}, {3.8716899594033813`*^9, 
   3.8716899600539207`*^9}, {3.8716900784125357`*^9, 
   3.8716900789351377`*^9}, {3.871705590182193*^9, 3.871705593089178*^9}, {
   3.871705721469871*^9, 3.871705813886736*^9}, {3.871705853265871*^9, 
   3.8717058662856207`*^9}, {3.8717059035408707`*^9, 3.871706011684908*^9}, 
   3.871706045343543*^9, {3.871706484816691*^9, 3.87170652555105*^9}, 
   3.8717069814938707`*^9, {3.871707150080432*^9, 3.871707168903172*^9}, {
   3.871707495653973*^9, 3.871707602306806*^9}, {3.8717076664684687`*^9, 
   3.871707692027851*^9}, {3.87170782927689*^9, 3.871707831107004*^9}, {
   3.8717078660880747`*^9, 3.871707868174891*^9}, 3.8717079100251617`*^9, 
   3.871708016362279*^9, 3.871708514321631*^9, {3.871709414281816*^9, 
   3.8717094266664257`*^9}, {3.8717108986134253`*^9, 3.871710934064623*^9}, 
   3.871711118911961*^9, 3.8717113235660048`*^9, 3.871711699746305*^9, {
   3.871711841537026*^9, 3.871711852394979*^9}, {3.871711988334196*^9, 
   3.871712020526985*^9}, {3.871715537622472*^9, 3.871715540368991*^9}, {
   3.872118897251507*^9, 3.872118897481187*^9}, {3.876454167099728*^9, 
   3.876454170049754*^9}},
 CellLabel->
  "In[100]:=",ExpressionUUID->"acba7d38-218d-4ab3-8d17-064d5bb3ae6c"]
}, Open  ]],

Cell[CellGroupData[{

Cell["MonomialTransformation", "Subsection",
 CellChangeTimes->{{3.871716025388597*^9, 
  3.871716031302944*^9}},ExpressionUUID->"ca53f43b-0c6f-4f8f-9ad8-\
87cfea3279c2"],

Cell[BoxData[{
 RowBox[{"ClearAll", "[", 
  RowBox[{"Mono2List", ",", "deg", ",", "degDotp"}], 
  "]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"deg", "[", 
   RowBox[{"f_", ",", "var_List"}], "]"}], ":=", 
  RowBox[{"Module", "[", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{
      RowBox[{"num", "=", 
       RowBox[{"Numerator", "[", "f", "]"}]}], ",", 
      RowBox[{"den", "=", 
       RowBox[{"Denominator", "[", "f", "]"}]}]}], "}"}], ",", 
    RowBox[{
     RowBox[{"(", 
      RowBox[{
       RowBox[{
        RowBox[{"Max", "[", 
         RowBox[{"Plus", "@@@", 
          RowBox[{
           RowBox[{"CoefficientRules", "[", 
            RowBox[{"#", ",", "var"}], "]"}], "[", 
           RowBox[{"[", 
            RowBox[{"All", ",", "1"}], "]"}], "]"}]}], "]"}], "&"}], "@", 
       RowBox[{"(", "num", ")"}]}], ")"}], "-", 
     RowBox[{"(", 
      RowBox[{
       RowBox[{
        RowBox[{"Max", "[", 
         RowBox[{"Plus", "@@@", 
          RowBox[{
           RowBox[{"CoefficientRules", "[", 
            RowBox[{"#", ",", "var"}], "]"}], "[", 
           RowBox[{"[", 
            RowBox[{"All", ",", "1"}], "]"}], "]"}]}], "]"}], "&"}], "@", 
       RowBox[{"(", "den", ")"}]}], ")"}]}]}], "]"}]}], "\n", 
 RowBox[{
  RowBox[{"degDotp", "[", "f_", "]"}], ":=", 
  RowBox[{"Module", "[", 
   RowBox[{
    RowBox[{"{", "x", "}"}], ",", 
    RowBox[{"deg", "[", 
     RowBox[{
      RowBox[{
       RowBox[{"f", "/.", 
        RowBox[{
         RowBox[{"dot", "[", 
          RowBox[{"a_p", ",", "b_p"}], "]"}], ":>", "x"}]}], "/.", 
       RowBox[{
        RowBox[{"dot", "[", "g__", "]"}], ":>", " ", "1"}]}], " ", ",", 
      RowBox[{"{", "x", "}"}]}], "]"}]}], "]"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"Mono2List", "[", 
   RowBox[{"f_", ",", "dimDen_"}], "]"}], ":=", 
  RowBox[{"FF", "[", 
   RowBox[{"1", ",", 
    RowBox[{"-", 
     RowBox[{"Table", "[", 
      RowBox[{
       RowBox[{"deg", "[", 
        RowBox[{"f", ",", 
         RowBox[{"{", 
          RowBox[{"\[ScriptCapitalD]", "[", "ii", "]"}], "}"}]}], "]"}], ",", 
       
       RowBox[{"{", 
        RowBox[{"ii", ",", "dimDen"}], "}"}]}], "]"}]}]}], "]"}]}], "\n", 
 RowBox[{
  RowBox[{"Mono2List", "[", 
   RowBox[{"f_", ",", "dimDen_List"}], "]"}], ":=", 
  RowBox[{"FF", "[", 
   RowBox[{"1", ",", 
    RowBox[{"-", 
     RowBox[{"Table", "[", 
      RowBox[{
       RowBox[{"deg", "[", 
        RowBox[{"f", ",", 
         RowBox[{"{", 
          RowBox[{"dimDen", "[", 
           RowBox[{"[", "ii", "]"}], "]"}], "}"}]}], "]"}], ",", 
       RowBox[{"{", 
        RowBox[{"ii", ",", 
         RowBox[{"Length", "@", "dimDen"}]}], "}"}]}], "]"}]}]}], 
   "]"}]}]}], "Input",
 CellChangeTimes->{{3.871716074820694*^9, 3.8717160840867434`*^9}},
 CellLabel->
  "In[102]:=",ExpressionUUID->"f8177a59-b548-4f5d-a062-3e46a97c4ed8"],

Cell[BoxData[{
 RowBox[{"ClearAll", "[", "GetDenominatorFun", "]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"GetDenominatorFun", "[", 
   RowBox[{"h_", ",", "vars_"}], "]"}], ":=", 
  RowBox[{"Module", "[", 
   RowBox[{
    RowBox[{"{", "alldeno", "}"}], ",", 
    RowBox[{
     RowBox[{"alldeno", "=", 
      RowBox[{"(", 
       RowBox[{"List", "@@", 
        RowBox[{"(", 
         RowBox[{
          RowBox[{"auxilaryVariables", "*", 
           RowBox[{"Denominator", "[", "h", "]"}]}], "/.", 
          RowBox[{
           RowBox[{"Power", "[", 
            RowBox[{"f_", ",", "n_"}], "]"}], ":>", " ", "f"}]}], ")"}]}], 
       ")"}]}], ";", 
     RowBox[{"Table", "[", 
      RowBox[{
       RowBox[{"If", "[", 
        RowBox[{
         RowBox[{
          RowBox[{"Intersection", "[", 
           RowBox[{
            RowBox[{
             RowBox[{"alldeno", "[", 
              RowBox[{"[", "i", "]"}], "]"}], "//", 
             RowBox[{
              RowBox[{"Cases", "[", 
               RowBox[{"#", ",", 
                RowBox[{"dot", "[", "__", "]"}], ",", 
                RowBox[{"{", 
                 RowBox[{"0", ",", "\[Infinity]"}], "}"}]}], "]"}], "&"}]}], 
            ",", "vars"}], "]"}], "==", 
          RowBox[{"{", "}"}]}], ",", "Nothing", ",", 
         RowBox[{"alldeno", "[", 
          RowBox[{"[", "i", "]"}], "]"}]}], "]"}], ",", 
       RowBox[{"{", 
        RowBox[{"i", ",", 
         RowBox[{"Length", "@", "alldeno"}]}], "}"}]}], "]"}]}]}], 
   "\[IndentingNewLine]", "]"}]}], "\[IndentingNewLine]", 
 RowBox[{"ClearAll", "[", "GenIBPdotList", "]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"GenIBPdotList", "[", 
   RowBox[{"h_", ",", "vars_List", ",", "numeratordots_List"}], "]"}], ":=", 
  RowBox[{"Module", "[", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{"pplist", ",", "he"}], "}"}], ",", 
    RowBox[{
     RowBox[{"he", "=", 
      RowBox[{"h", "//", "Expand"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"pplist", "=", 
      RowBox[{
       RowBox[{
        RowBox[{
         RowBox[{"GetDenominatorFun", "[", 
          RowBox[{"#", ",", "vars"}], "]"}], "&"}], "/@", 
        RowBox[{"(", 
         RowBox[{"List", "@@", "he"}], ")"}]}], "//", "Union"}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"pplist", "=", 
      RowBox[{"minSets", "[", "pplist", "]"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"(*", 
      RowBox[{
       RowBox[{"pplist", "=", 
        RowBox[{
         RowBox[{
          RowBox[{"Intersection", "[", 
           RowBox[{"#", ",", "vars"}], "]"}], "&"}], "/@", "pplist"}]}], 
       ";"}], "*)"}], "\[IndentingNewLine]", 
     RowBox[{"Table", "[", 
      RowBox[{
       RowBox[{
        RowBox[{
         RowBox[{"Join", "[", 
          RowBox[{
           RowBox[{"pplist", "[", 
            RowBox[{"[", "ii", "]"}], "]"}], ",", "numeratordots"}], "]"}], "//",
          "DeleteDuplicates"}], "//", "Union"}], ",", 
       RowBox[{"{", 
        RowBox[{"ii", ",", 
         RowBox[{"Length", "@", "pplist"}]}], "}"}]}], "]"}]}]}], 
   "\[IndentingNewLine]", "]"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"GenIBPdotList", "[", 
   RowBox[{"h_", ",", "vars_List"}], "]"}], ":=", 
  RowBox[{"Module", "[", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{"pplist", ",", "he"}], "}"}], ",", 
    RowBox[{
     RowBox[{"he", "=", 
      RowBox[{"h", "//", "Expand"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"pplist", "=", 
      RowBox[{
       RowBox[{
        RowBox[{
         RowBox[{"GetDenominatorFun", "[", 
          RowBox[{"#", ",", "vars"}], "]"}], "&"}], "/@", 
        RowBox[{"(", 
         RowBox[{"List", "@@", "he"}], ")"}]}], "//", "Union"}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"pplist", "=", 
      RowBox[{"minSets", "[", "pplist", "]"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"Table", "[", 
      RowBox[{
       RowBox[{"Join", "[", 
        RowBox[{
         RowBox[{"pplist", "[", 
          RowBox[{"[", "ii", "]"}], "]"}], ",", 
         RowBox[{"Complement", "[", 
          RowBox[{"vars", ",", 
           RowBox[{
            RowBox[{"pplist", "[", 
             RowBox[{"[", "ii", "]"}], "]"}], "//", 
            RowBox[{
             RowBox[{"Cases", "[", 
              RowBox[{"#", ",", 
               RowBox[{"dot", "[", "__", "]"}], ",", 
               RowBox[{"{", 
                RowBox[{"0", ",", "\[Infinity]"}], "}"}]}], "]"}], "&"}]}]}], 
          "]"}]}], "]"}], ",", 
       RowBox[{"{", 
        RowBox[{"ii", ",", 
         RowBox[{"Length", "@", "pplist"}]}], "}"}]}], "]"}]}]}], 
   "\[IndentingNewLine]", "]"}]}], "\[IndentingNewLine]", 
 RowBox[{"ClearAll", "[", 
  RowBox[{"mono2j", ",", "mono2B"}], "]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"mono2j", "[", 
   RowBox[{"g_", ",", "pplist_", ",", "vars_"}], "]"}], ":=", 
  RowBox[{"Module", "[", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{
     "numt", ",", "pid", ",", "dds", ",", "dot2D", ",", "propgatorlist"}], 
     "}"}], ",", 
    RowBox[{
     RowBox[{"numt", "=", "g"}], ";", "\[IndentingNewLine]", 
     RowBox[{"propgatorlist", "=", 
      RowBox[{"GetDenominatorFun", "[", 
       RowBox[{"numt", ",", "vars"}], "]"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"pid", "=", 
      RowBox[{
       RowBox[{
        RowBox[{"Position", "[", 
         RowBox[{
          RowBox[{
           RowBox[{
            RowBox[{"SubsetQ", "[", 
             RowBox[{"#", ",", "propgatorlist"}], "]"}], "&"}], "/@", 
           "pplist"}], ",", "True"}], "]"}], "//", "Flatten"}], "//", 
       "First"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"dds", "=", 
      RowBox[{"Table", "[", 
       RowBox[{
        RowBox[{"\[ScriptCapitalD]", "[", "ii", "]"}], ",", 
        RowBox[{"{", 
         RowBox[{"ii", ",", 
          RowBox[{"Length", "@", 
           RowBox[{"pplist", "[", 
            RowBox[{"[", "pid", "]"}], "]"}]}]}], "}"}]}], "]"}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"dot2D", "=", 
      RowBox[{
       RowBox[{"Solve", "[", 
        RowBox[{
         RowBox[{
          RowBox[{"pplist", "[", 
           RowBox[{"[", "pid", "]"}], "]"}], "==", "dds"}], ",", "vars"}], 
        "]"}], "[", 
       RowBox[{"[", "1", "]"}], "]"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"numt", "=", 
      RowBox[{
       RowBox[{"numt", "/.", "dot2D"}], "//", "Expand"}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"numt", "=", 
      RowBox[{"If", "[", 
       RowBox[{
        RowBox[{
         RowBox[{"Head", "[", "numt", "]"}], "===", "Plus"}], ",", 
        RowBox[{"List", "@@", "numt"}], ",", 
        RowBox[{"{", "numt", "}"}]}], "]"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"(*", 
      RowBox[{
       RowBox[{"Print", "[", "numt", "]"}], ";"}], "*)"}], 
     "\[IndentingNewLine]", 
     RowBox[{"numt", "=", 
      RowBox[{"Sum", "[", 
       RowBox[{
        RowBox[{
         RowBox[{
          RowBox[{"(", 
           RowBox[{
            RowBox[{"numt", "[", 
             RowBox[{"[", "ii", "]"}], "]"}], "/.", 
            RowBox[{
             RowBox[{"\[ScriptCapitalD]", "[", "i_", "]"}], ":>", " ", 
             "1"}]}], ")"}], 
          RowBox[{"Mono2List", "[", 
           RowBox[{
            RowBox[{"numt", "[", 
             RowBox[{"[", "ii", "]"}], "]"}], ",", "dds"}], "]"}]}], "/.", 
         RowBox[{
          RowBox[{"FF", "[", 
           RowBox[{"1", ",", 
            RowBox[{"{", "f___", "}"}]}], "]"}], ":>", " ", 
          RowBox[{"j", "[", 
           RowBox[{
            RowBox[{"ToExpression", "[", 
             RowBox[{"\"\<gr\>\"", "<>", 
              RowBox[{"ToString", "[", "pid", "]"}]}], "]"}], ",", "f"}], 
           "]"}]}]}], ",", 
        RowBox[{"{", 
         RowBox[{"ii", ",", 
          RowBox[{"Length", "@", "numt"}]}], "}"}]}], "]"}]}]}]}], 
   "\[IndentingNewLine]", "]"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"mono2j", "[", 
   RowBox[{"g_", ",", "pplist_"}], "]"}], ":=", 
  RowBox[{"Module", "[", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{
     "numt", ",", "pid", ",", "dds", ",", "dot2D", ",", "propgatorlist"}], 
     "}"}], ",", 
    RowBox[{
     RowBox[{"numt", "=", "g"}], ";", "\[IndentingNewLine]", 
     RowBox[{"(*", 
      RowBox[{
       RowBox[{"propgatorlist", "=", 
        RowBox[{"GetDenominatorFun", "[", 
         RowBox[{"numt", ",", "vars"}], "]"}]}], ";", "\[IndentingNewLine]", 
       RowBox[{"pid", "=", 
        RowBox[{
         RowBox[{
          RowBox[{"Position", "[", 
           RowBox[{
            RowBox[{
             RowBox[{
              RowBox[{"SubsetQ", "[", 
               RowBox[{"#", ",", "propgatorlist"}], "]"}], "&"}], "/@", 
             "pplist"}], ",", "True"}], "]"}], "//", "Flatten"}], "//", 
         "First"}]}], ";"}], "*)"}], "\[IndentingNewLine]", 
     RowBox[{"dds", "=", 
      RowBox[{"Table", "[", 
       RowBox[{
        RowBox[{"\[ScriptCapitalD]", "[", "ii", "]"}], ",", 
        RowBox[{"{", 
         RowBox[{"ii", ",", 
          RowBox[{"Length", "@", "pplist"}]}], "}"}]}], "]"}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"dot2D", "=", 
      RowBox[{
       RowBox[{"Solve", "[", 
        RowBox[{
         RowBox[{"pplist", "==", "dds"}], ",", "pplist"}], "]"}], "[", 
       RowBox[{"[", "1", "]"}], "]"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"numt", "=", 
      RowBox[{
       RowBox[{"numt", "/.", "dot2D"}], "//", "Expand"}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"numt", "=", 
      RowBox[{"If", "[", 
       RowBox[{
        RowBox[{
         RowBox[{"Head", "[", "numt", "]"}], "===", "Plus"}], ",", 
        RowBox[{"List", "@@", "numt"}], ",", 
        RowBox[{"{", "numt", "}"}]}], "]"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"(*", 
      RowBox[{
       RowBox[{"Print", "[", "numt", "]"}], ";"}], "*)"}], 
     "\[IndentingNewLine]", 
     RowBox[{"numt", "=", 
      RowBox[{"Sum", "[", 
       RowBox[{
        RowBox[{
         RowBox[{
          RowBox[{"(", 
           RowBox[{
            RowBox[{"numt", "[", 
             RowBox[{"[", "ii", "]"}], "]"}], "/.", 
            RowBox[{
             RowBox[{"\[ScriptCapitalD]", "[", "i_", "]"}], ":>", " ", 
             "1"}]}], ")"}], 
          RowBox[{"Mono2List", "[", 
           RowBox[{
            RowBox[{"numt", "[", 
             RowBox[{"[", "ii", "]"}], "]"}], ",", "dds"}], "]"}]}], "/.", 
         RowBox[{
          RowBox[{"FF", "[", 
           RowBox[{"1", ",", 
            RowBox[{"{", "f___", "}"}]}], "]"}], ":>", " ", 
          RowBox[{"B", "@@", 
           RowBox[{"(", 
            RowBox[{"-", 
             RowBox[{"{", "f", "}"}]}], ")"}]}]}]}], ",", 
        RowBox[{"{", 
         RowBox[{"ii", ",", 
          RowBox[{"Length", "@", "numt"}]}], "}"}]}], "]"}]}]}]}], 
   "\[IndentingNewLine]", "]"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"mono2B", "[", 
   RowBox[{"g_", ",", "pplist_"}], "]"}], ":=", 
  RowBox[{"Module", "[", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{
     "numt", ",", "pid", ",", "dds", ",", "dot2D", ",", "propgatorlist"}], 
     "}"}], ",", 
    RowBox[{
     RowBox[{"numt", "=", "g"}], ";", "\[IndentingNewLine]", 
     RowBox[{"(*", 
      RowBox[{
       RowBox[{"propgatorlist", "=", 
        RowBox[{"GetDenominatorFun", "[", 
         RowBox[{"numt", ",", "vars"}], "]"}]}], ";", "\[IndentingNewLine]", 
       RowBox[{"pid", "=", 
        RowBox[{
         RowBox[{
          RowBox[{"Position", "[", 
           RowBox[{
            RowBox[{
             RowBox[{
              RowBox[{"SubsetQ", "[", 
               RowBox[{"#", ",", "propgatorlist"}], "]"}], "&"}], "/@", 
             "pplist"}], ",", "True"}], "]"}], "//", "Flatten"}], "//", 
         "First"}]}], ";"}], "*)"}], "\[IndentingNewLine]", 
     RowBox[{"dds", "=", 
      RowBox[{"Table", "[", 
       RowBox[{
        RowBox[{"\[ScriptCapitalD]", "[", "ii", "]"}], ",", 
        RowBox[{"{", 
         RowBox[{"ii", ",", 
          RowBox[{"Length", "@", "pplist"}]}], "}"}]}], "]"}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"dot2D", "=", 
      RowBox[{"MapThread", "[", 
       RowBox[{"Rule", ",", 
        RowBox[{"{", 
         RowBox[{"pplist", ",", "dds"}], "}"}]}], "]"}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"numt", "=", 
      RowBox[{
       RowBox[{"numt", "/.", "dot2D"}], "//", "Expand"}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"numt", "=", 
      RowBox[{"If", "[", 
       RowBox[{
        RowBox[{
         RowBox[{"Head", "[", "numt", "]"}], "===", "Plus"}], ",", 
        RowBox[{"List", "@@", "numt"}], ",", 
        RowBox[{"{", "numt", "}"}]}], "]"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"(*", 
      RowBox[{
       RowBox[{"Print", "[", "numt", "]"}], ";"}], "*)"}], 
     "\[IndentingNewLine]", 
     RowBox[{"numt", "=", 
      RowBox[{"Sum", "[", 
       RowBox[{
        RowBox[{
         RowBox[{
          RowBox[{"(", 
           RowBox[{
            RowBox[{"numt", "[", 
             RowBox[{"[", "ii", "]"}], "]"}], "/.", 
            RowBox[{
             RowBox[{"\[ScriptCapitalD]", "[", "i_", "]"}], ":>", " ", 
             "1"}]}], ")"}], 
          RowBox[{"Mono2List", "[", 
           RowBox[{
            RowBox[{"numt", "[", 
             RowBox[{"[", "ii", "]"}], "]"}], ",", "dds"}], "]"}]}], "/.", 
         RowBox[{
          RowBox[{"FF", "[", 
           RowBox[{"1", ",", 
            RowBox[{"{", "f___", "}"}]}], "]"}], ":>", " ", 
          RowBox[{"B", "@@", 
           RowBox[{"(", 
            RowBox[{"-", 
             RowBox[{"{", "f", "}"}]}], ")"}]}]}]}], ",", 
        RowBox[{"{", 
         RowBox[{"ii", ",", 
          RowBox[{"Length", "@", "numt"}]}], "}"}]}], "]"}]}]}]}], 
   "\[IndentingNewLine]", "]"}]}]}], "Input",
 CellChangeTimes->{{3.87013929658813*^9, 3.87013929709615*^9}, 
   3.87015456888785*^9, {3.870155204422731*^9, 3.870155217666298*^9}, {
   3.8701553410718737`*^9, 3.87015535134295*^9}, 3.870155401400276*^9, {
   3.8704311873876657`*^9, 3.870431268553248*^9}, {3.8705917169072323`*^9, 
   3.870591717418168*^9}, {3.876610362699594*^9, 3.8766104319483433`*^9}, {
   3.876610942764016*^9, 3.876610989180686*^9}},
 CellLabel->
  "In[107]:=",ExpressionUUID->"99fc1734-0a78-4f56-9085-9e1deef01c83"]
}, Closed]],

Cell[CellGroupData[{

Cell["Levi-Civita Expansion", "Subsection",
 CellChangeTimes->{{3.8768839877249594`*^9, 
  3.8768840068850174`*^9}},ExpressionUUID->"a0b21b7b-22d9-43b7-b714-\
f04ca4b20753"],

Cell[BoxData[{
 RowBox[{"ClearAll", "[", "etaMatrix", "]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"etaMatrix", "[", 
    RowBox[{
    "x1_", ",", "x2_", ",", "x3_", ",", "x4_", ",", "x5_", ",", "x6_", ",", 
     "x7_", ",", "x8_"}], "]"}], ":=", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{
       RowBox[{"dot", "[", 
        RowBox[{"x1", ",", "x3"}], "]"}], ",", 
       RowBox[{"dot", "[", 
        RowBox[{"x1", ",", "x4"}], "]"}], ",", 
       RowBox[{"dot", "[", 
        RowBox[{"x1", ",", "x7"}], "]"}], ",", 
       RowBox[{"dot", "[", 
        RowBox[{"x1", ",", "x8"}], "]"}]}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"dot", "[", 
        RowBox[{"x2", ",", "x3"}], "]"}], ",", 
       RowBox[{"dot", "[", 
        RowBox[{"x2", ",", "x4"}], "]"}], ",", 
       RowBox[{"dot", "[", 
        RowBox[{"x2", ",", "x7"}], "]"}], ",", 
       RowBox[{"dot", "[", 
        RowBox[{"x2", ",", "x8"}], "]"}]}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"dot", "[", 
        RowBox[{"x5", ",", "x3"}], "]"}], ",", 
       RowBox[{"dot", "[", 
        RowBox[{"x5", ",", "x4"}], "]"}], ",", 
       RowBox[{"dot", "[", 
        RowBox[{"x5", ",", "x7"}], "]"}], ",", 
       RowBox[{"dot", "[", 
        RowBox[{"x5", ",", "x8"}], "]"}]}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"dot", "[", 
        RowBox[{"x6", ",", "x3"}], "]"}], ",", 
       RowBox[{"dot", "[", 
        RowBox[{"x6", ",", "x4"}], "]"}], ",", 
       RowBox[{"dot", "[", 
        RowBox[{"x6", ",", "x7"}], "]"}], ",", 
       RowBox[{"dot", "[", 
        RowBox[{"x6", ",", "x8"}], "]"}]}], "}"}]}], "}"}]}], ";"}]}], "Input",\

 CellChangeTimes->{{3.87742287808566*^9, 3.8774229129952793`*^9}, {
  3.8774230721070642`*^9, 3.8774230801424713`*^9}, {3.877423501400942*^9, 
  3.877423508889386*^9}, {3.877423973554997*^9, 3.8774239752112007`*^9}},
 CellLabel->
  "In[116]:=",ExpressionUUID->"90a8135e-812a-4d57-9d3d-6bdd9005cd47"],

Cell[BoxData[{
 RowBox[{"ClearAll", "[", "expandFS", "]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"expandFS", "[", "f_", "]"}], ":=", 
  RowBox[{
   RowBox[{"(", 
    RowBox[{"f", "//", "expandFDirect"}], ")"}], "/.", 
   RowBox[{
    RowBox[{"dot", "[", "g__", "]"}], ":>", 
    RowBox[{"(", 
     RowBox[{
      RowBox[{
       RowBox[{"(", 
        RowBox[{
         RowBox[{"dot", "[", "g", "]"}], "//", "expandGen"}], ")"}], "/.", 
       RowBox[{
        RowBox[{
         RowBox[{
          RowBox[{"S", "[", "0", "]"}], "[", 
          RowBox[{"a_", ",", "b_"}], "]"}], " ", 
         RowBox[{
          RowBox[{"S", "[", "0", "]"}], "[", 
          RowBox[{"c_", ",", "d_"}], "]"}]}], ":>", 
        RowBox[{"Det", "[", 
         RowBox[{"etaMatrix", "[", 
          RowBox[{"a", ",", "b", ",", "c", ",", "d", ",", 
           RowBox[{"v", "[", "1", "]"}], ",", 
           RowBox[{"as", "[", "1", "]"}], ",", 
           RowBox[{"v", "[", "1", "]"}], ",", 
           RowBox[{"as", "[", "1", "]"}]}], "]"}], "]"}]}]}], "//", 
      "contractAnti"}], ")"}]}]}]}]}], "Input",
 CellChangeTimes->{{3.8774239821267138`*^9, 3.877424021716002*^9}, {
  3.87742429888728*^9, 3.877424396304152*^9}, {3.8774246172079277`*^9, 
  3.8774246345014153`*^9}},
 CellLabel->
  "In[118]:=",ExpressionUUID->"cc21b2cf-79d9-4be8-990b-72e461cf7fe8"]
}, Open  ]]
}, Closed]],

Cell[CellGroupData[{

Cell["SubFunctions Spin Ansatz", "Section",
 CellChangeTimes->{{3.8768042159264*^9, 3.876804221321859*^9}, {
  3.877066238287374*^9, 
  3.877066252520989*^9}},ExpressionUUID->"920e92b2-f483-4633-8572-\
95f7ad2029ee"],

Cell[BoxData[{
 RowBox[{"ClearAll", "[", 
  RowBox[{
  "KSetPartitions", ",", "SetPartitions", ",", "KSetPartitionsEmpty"}], 
  "]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"KSetPartitions", "[", 
   RowBox[{"0", ",", " ", "0"}], "]"}], " ", ":=", " ", 
  RowBox[{"{", 
   RowBox[{"{", "}"}], "}"}]}], "\n", 
 RowBox[{
  RowBox[{"KSetPartitions", "[", 
   RowBox[{
    RowBox[{"{", "}"}], ",", " ", "0"}], "]"}], " ", ":=", " ", 
  RowBox[{"{", 
   RowBox[{"{", "}"}], "}"}]}], "\n", 
 RowBox[{
  RowBox[{"KSetPartitions", "[", 
   RowBox[{"s_List", ",", " ", "0"}], "]"}], " ", ":=", " ", 
  RowBox[{"{", "}"}]}], "\n", 
 RowBox[{
  RowBox[{
   RowBox[{"KSetPartitions", "[", 
    RowBox[{"s_List", ",", " ", "k_Integer"}], "]"}], " ", ":=", " ", 
   RowBox[{
    RowBox[{"{", "}"}], " ", "/;", " ", 
    RowBox[{"k", " ", ">", " ", 
     RowBox[{"Length", "[", "s", "]"}]}]}]}], " "}], "\n", 
 RowBox[{
  RowBox[{"KSetPartitions", "[", 
   RowBox[{"s_List", ",", " ", "k_Integer"}], "]"}], " ", ":=", " ", 
  RowBox[{
   RowBox[{"{", 
    RowBox[{
     RowBox[{"(", 
      RowBox[{
       RowBox[{"{", "#1", "}"}], " ", "&"}], " ", ")"}], " ", "/@", " ", 
     "s"}], "}"}], " ", "/;", " ", 
   RowBox[{"k", " ", "===", " ", 
    RowBox[{"Length", "[", "s", "]"}]}]}]}], "\n", 
 RowBox[{
  RowBox[{"KSetPartitions", "[", 
   RowBox[{"s_List", ",", " ", "k_Integer"}], "]"}], " ", ":=", " ", 
  RowBox[{
   RowBox[{"Block", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{
       RowBox[{"$RecursionLimit", " ", "=", " ", "Infinity"}], ",", " ", 
       "j"}], "}"}], ",", " ", 
     RowBox[{"Join", "[", 
      RowBox[{
       RowBox[{
        RowBox[{"(", 
         RowBox[{
          RowBox[{"Prepend", "[", 
           RowBox[{"#1", ",", " ", 
            RowBox[{"{", 
             RowBox[{"First", "[", "s", "]"}], "}"}]}], "]"}], " ", "&"}], 
         " ", ")"}], " ", "/@", " ", 
        RowBox[{"KSetPartitions", "[", 
         RowBox[{
          RowBox[{"Rest", "[", "s", "]"}], ",", " ", 
          RowBox[{"k", " ", "-", " ", "1"}]}], "]"}]}], ",", " ", 
       RowBox[{"Flatten", "[", 
        RowBox[{
         RowBox[{
          RowBox[{"(", 
           RowBox[{
            RowBox[{"Table", "[", 
             RowBox[{
              RowBox[{"Prepend", "[", 
               RowBox[{
                RowBox[{"Delete", "[", 
                 RowBox[{"#1", ",", " ", "j"}], "]"}], ",", " ", 
                RowBox[{"Prepend", "[", 
                 RowBox[{
                  RowBox[{"#1", "[", 
                   RowBox[{"[", "j", "]"}], "]"}], ",", " ", 
                  RowBox[{"s", "[", 
                   RowBox[{"[", "1", "]"}], "]"}]}], "]"}]}], "]"}], ",", " ", 
              RowBox[{"{", 
               RowBox[{"j", ",", " ", 
                RowBox[{"Length", "[", "#1", "]"}]}], "}"}]}], "]"}], " ", 
            "&"}], " ", ")"}], " ", "/@", " ", 
          RowBox[{"KSetPartitions", "[", 
           RowBox[{
            RowBox[{"Rest", "[", "s", "]"}], ",", " ", "k"}], "]"}]}], ",", 
         " ", "1"}], "]"}]}], "]"}]}], "]"}], " ", "/;", " ", 
   RowBox[{
    RowBox[{"k", " ", ">", " ", "0"}], " ", "&&", " ", 
    RowBox[{"k", " ", "<", " ", 
     RowBox[{"Length", "[", "s", "]"}]}]}]}]}], "\n", 
 RowBox[{
  RowBox[{"KSetPartitions", "[", 
   RowBox[{"0", ",", " ", 
    RowBox[{
     RowBox[{"(", "k_Integer", ")"}], "?", "Positive"}]}], "]"}], " ", ":=", 
  " ", 
  RowBox[{"{", "}"}]}], "\n", 
 RowBox[{
  RowBox[{"KSetPartitions", "[", 
   RowBox[{
    RowBox[{
     RowBox[{"(", "n_Integer", ")"}], "?", "Positive"}], ",", " ", "0"}], 
   "]"}], " ", ":=", " ", 
  RowBox[{"{", "}"}]}], "\n", 
 RowBox[{
  RowBox[{"KSetPartitions", "[", 
   RowBox[{
    RowBox[{
     RowBox[{"(", "n_Integer", ")"}], "?", "Positive"}], ",", " ", 
    RowBox[{
     RowBox[{"(", "k_Integer", ")"}], "?", "Positive"}]}], "]"}], " ", ":=", 
  " ", 
  RowBox[{"KSetPartitions", "[", 
   RowBox[{
    RowBox[{"Range", "[", "n", "]"}], ",", " ", "k"}], 
   "]"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"SetPartitions", "[", "0", "]"}], " ", ":=", " ", 
  RowBox[{"{", 
   RowBox[{"{", "}"}], "}"}]}], "\n", 
 RowBox[{
  RowBox[{"SetPartitions", "[", 
   RowBox[{"{", "}"}], "]"}], " ", ":=", " ", 
  RowBox[{"{", 
   RowBox[{"{", "}"}], "}"}]}], "\n", 
 RowBox[{
  RowBox[{"SetPartitions", "[", "s_List", "]"}], " ", ":=", " ", 
  RowBox[{"Flatten", "[", 
   RowBox[{
    RowBox[{"Table", "[", 
     RowBox[{
      RowBox[{"KSetPartitions", "[", 
       RowBox[{"s", ",", " ", "i"}], "]"}], ",", " ", 
      RowBox[{"{", 
       RowBox[{"i", ",", " ", "2", ",", 
        RowBox[{
         RowBox[{"Length", "[", "s", "]"}], "-", "2"}]}], "}"}]}], "]"}], ",",
     " ", "1"}], "]"}]}], "\n", 
 RowBox[{
  RowBox[{"SetPartitions", "[", 
   RowBox[{
    RowBox[{"(", "n_Integer", ")"}], "?", "Positive"}], "]"}], " ", ":=", " ", 
  RowBox[{"SetPartitions", "[", 
   RowBox[{"Range", "[", "n", "]"}], "]"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"KSetPartitionsEmpty", "[", 
    RowBox[{"s_List", ",", "k_Integer"}], "]"}], ":=", 
   RowBox[{"Module", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"app", ",", "KMod"}], "}"}], ",", 
     RowBox[{
      RowBox[{"app", "=", 
       RowBox[{"KSetPartitions", "[", 
        RowBox[{"s", ",", "k"}], "]"}]}], ";", 
      RowBox[{"Do", "[", 
       RowBox[{
        RowBox[{
         RowBox[{"KMod", "=", 
          RowBox[{"KSetPartitions", "[", 
           RowBox[{"s", ",", "q"}], "]"}]}], ";", 
         RowBox[{"Do", "[", 
          RowBox[{
           RowBox[{
            RowBox[{"Do", "[", 
             RowBox[{
              RowBox[{"AppendTo", "[", 
               RowBox[{
                RowBox[{"KMod", "[", 
                 RowBox[{"[", "i", "]"}], "]"}], ",", 
                RowBox[{"{", "}"}]}], "]"}], ",", 
              RowBox[{"{", 
               RowBox[{"j", ",", "1", ",", 
                RowBox[{"k", "-", "q"}]}], "}"}]}], "]"}], ";", 
            RowBox[{"AppendTo", "[", 
             RowBox[{"app", ",", 
              RowBox[{"KMod", "[", 
               RowBox[{"[", "i", "]"}], "]"}]}], "]"}]}], ",", 
           RowBox[{"{", 
            RowBox[{"i", ",", 
             RowBox[{"Length", "[", 
              RowBox[{"KSetPartitions", "[", 
               RowBox[{"s", ",", "q"}], "]"}], "]"}]}], "}"}]}], "]"}]}], ",", 
        RowBox[{"{", 
         RowBox[{"q", ",", "1", ",", 
          RowBox[{"k", "-", "1"}]}], "}"}]}], "]"}], ";", 
      RowBox[{"Return", "[", "app", "]"}]}]}], "]"}]}], ";"}]}], "Input",
 CellChangeTimes->{{3.876811307266223*^9, 3.876811357406602*^9}, {
  3.876814773296413*^9, 3.876814814709012*^9}, {3.8768150847160673`*^9, 
  3.876815104266962*^9}},
 CellLabel->
  "In[154]:=",ExpressionUUID->"a59468cd-400d-4953-be9d-1224995358e2"],

Cell[BoxData[{
 RowBox[{"ClearAll", "[", "monomialsAnsSingle", 
  "]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"monomialsAnsSingle", "[", 
   RowBox[{"lv_", ",", "od_List", ",", "rv_"}], "]"}], ":=", 
  RowBox[{"Module", "[", 
   RowBox[{
    RowBox[{"{", "pt", "}"}], ",", 
    RowBox[{
     RowBox[{"pt", "=", 
      RowBox[{
       RowBox[{"Permutations", "[", "od", "]"}], "//", "DeleteDuplicates"}]}],
      ";", 
     RowBox[{"(", 
      RowBox[{
       RowBox[{
        RowBox[{"dot", "[", 
         RowBox[{"lv", ",", "##", ",", "rv"}], "]"}], "&"}], "@@@", "pt"}], 
      ")"}]}]}], "]"}]}]}], "Input",
 CellChangeTimes->{{3.876804285141453*^9, 3.876804311219627*^9}, {
   3.876804354297196*^9, 3.876804394553791*^9}, {3.876804547147678*^9, 
   3.876804564077526*^9}, 3.8768046310569696`*^9, {3.8768046788966293`*^9, 
   3.876804767317877*^9}, {3.876804900865148*^9, 3.87680509438022*^9}, {
   3.8768051395051527`*^9, 3.876805155807871*^9}, {3.876805253968152*^9, 
   3.876805264267679*^9}, {3.8768053169740458`*^9, 3.876805320484037*^9}, 
   3.876805351239914*^9, {3.8768054423488283`*^9, 3.8768054713281593`*^9}, {
   3.8768055021330214`*^9, 3.876805503038082*^9}, {3.87680557435063*^9, 
   3.8768056288868513`*^9}, {3.876806417065815*^9, 3.876806469431156*^9}, {
   3.876810617157659*^9, 3.876810647969964*^9}, 3.876810746169541*^9, 
   3.877066211011817*^9},
 CellLabel->
  "In[169]:=",ExpressionUUID->"b391ede9-be00-4b65-b0fd-aa1f912d39f2"],

Cell[BoxData[{
 RowBox[{"ClearAll", "[", "partitions", "]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"partitions", "[", 
   RowBox[{"list_", ",", "l_"}], "]"}], ":=", 
  RowBox[{"Join", "@@", 
   RowBox[{"Table", "[", 
    RowBox[{
     RowBox[{
      RowBox[{
       RowBox[{"{", 
        RowBox[{"x", ",", "##"}], "}"}], "&"}], "@@@", 
      RowBox[{"partitions", "[", 
       RowBox[{
        RowBox[{"list", "~", "Complement", "~", "x"}], ",", "l"}], "]"}]}], 
     ",", 
     RowBox[{"{", 
      RowBox[{"x", ",", 
       RowBox[{"Subsets", "[", 
        RowBox[{"list", ",", 
         RowBox[{"{", "l", "}"}], ",", 
         RowBox[{"Binomial", "[", 
          RowBox[{
           RowBox[{
            RowBox[{"Length", "[", "list", "]"}], "-", "1"}], ",", 
           RowBox[{"l", "-", "1"}]}], "]"}]}], "]"}]}], "}"}]}], 
    "]"}]}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"partitions", "[", 
    RowBox[{"list_", ",", "l_"}], "]"}], "/;", 
   RowBox[{
    RowBox[{"Length", "[", "list", "]"}], "===", "l"}]}], ":=", 
  RowBox[{"{", 
   RowBox[{"{", "list", "}"}], "}"}]}]}], "Input",
 CellChangeTimes->{{3.876813314352524*^9, 3.876813328750271*^9}},
 CellLabel->
  "In[171]:=",ExpressionUUID->"55f9f031-ef59-4843-b717-d41b3d5f725a"],

Cell[BoxData[{
 RowBox[{"ClearAll", "[", "monoAllF", "]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"monoAllF", "[", 
   RowBox[{"ptsets_", ",", "vs_"}], "]"}], ":=", 
  RowBox[{"Module", "[", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{"mono1", ",", "mono2", ",", "monoAll", ",", "a"}], "}"}], ",", 
    RowBox[{
     RowBox[{
      RowBox[{"Table", "[", 
       RowBox[{
        RowBox[{
         RowBox[{"mono1", "=", 
          RowBox[{"Table", "[", 
           RowBox[{
            RowBox[{
             RowBox[{"monomialsAnsSingle", "[", 
              RowBox[{
               RowBox[{"vs", "[", 
                RowBox[{"[", 
                 RowBox[{"jj", ",", "1"}], "]"}], "]"}], ",", 
               RowBox[{"ptsets", "[", 
                RowBox[{"[", 
                 RowBox[{"ii", ",", "jj"}], "]"}], "]"}], ",", 
               RowBox[{"vs", "[", 
                RowBox[{"[", 
                 RowBox[{"jj", ",", "2"}], "]"}], "]"}]}], "]"}], "//", 
             "Total"}], ",", 
            RowBox[{"{", 
             RowBox[{"jj", ",", 
              RowBox[{"Length", "@", 
               RowBox[{"ptsets", "[", 
                RowBox[{"[", "ii", "]"}], "]"}]}]}], "}"}]}], "]"}]}], ";", 
         "\[IndentingNewLine]", 
         RowBox[{"mono2", "=", 
          RowBox[{"(", 
           RowBox[{"Times", "@@", "mono1"}], ")"}]}], ";", 
         "\[IndentingNewLine]", 
         RowBox[{"monoAll", "=", 
          RowBox[{"DeleteCases", "[", 
           RowBox[{
            RowBox[{"List", "@@", 
             RowBox[{"(", 
              RowBox[{
               RowBox[{"a", "+", "mono2"}], "//", "Expand"}], ")"}]}], ",", 
            "a"}], "]"}]}]}], ",", 
        RowBox[{"{", 
         RowBox[{"ii", ",", 
          RowBox[{"Length", "@", "ptsets"}]}], "}"}]}], "]"}], "//", 
      "Flatten"}], "//", "DeleteDuplicates"}]}], "]"}]}]}], "Input",
 CellChangeTimes->{{3.876811369960775*^9, 3.8768113727341633`*^9}, {
   3.876811485009445*^9, 3.876811595092298*^9}, {3.876811639699731*^9, 
   3.876811640893647*^9}, 3.8768116783304043`*^9, {3.876811716061986*^9, 
   3.876811732470446*^9}, {3.876811790156522*^9, 3.876811796540135*^9}, {
   3.8768118801902447`*^9, 3.876811892921207*^9}, {3.876811927282494*^9, 
   3.876812045955064*^9}, {3.876812090166971*^9, 3.876812166246018*^9}, {
   3.876812217543675*^9, 3.8768122751008883`*^9}, {3.876812307151626*^9, 
   3.876812392859235*^9}, 3.876812451314582*^9, 3.8773367732900352`*^9, {
   3.877344524700871*^9, 3.877344554764751*^9}, {3.8773446377947187`*^9, 
   3.877344642934064*^9}, {3.877344709517954*^9, 3.8773447168750067`*^9}, {
   3.877344826511199*^9, 3.877344918321042*^9}, {3.877351477664247*^9, 
   3.8773514780370626`*^9}, {3.877351529018159*^9, 3.877351561254724*^9}, {
   3.877353282330694*^9, 3.877353342917494*^9}, {3.877353392697257*^9, 
   3.8773534009593678`*^9}},
 CellLabel->
  "In[174]:=",ExpressionUUID->"c5bb3695-411a-4d6d-9a74-02514b7878ff"],

Cell[BoxData[{
 RowBox[{"ClearAll", "[", "BoundaryPatitions", "]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"BoundaryPatitions", "[", "ls_List", "]"}], ":=", 
  RowBox[{"Module", "[", 
   RowBox[{
    RowBox[{"{", "L", "}"}], ",", 
    RowBox[{
     RowBox[{"(", 
      RowBox[{
       RowBox[{
        RowBox[{"L", "@@@", 
         RowBox[{"Permutations", "[", "ls", "]"}]}], "/.", 
        RowBox[{
         RowBox[{"L", "[", "f__", "]"}], ":>", 
         RowBox[{"L", "@@", 
          RowBox[{"Sort", "/@", 
           RowBox[{"ArrayReshape", "[", 
            RowBox[{
             RowBox[{"{", "f", "}"}], ",", 
             RowBox[{"{", 
              RowBox[{
               RowBox[{
                FractionBox["1", "2"], 
                RowBox[{"Length", "@", 
                 RowBox[{"{", "f", "}"}]}]}], ",", "2"}], "}"}]}], 
            "]"}]}]}]}]}], "//", "Union"}], ")"}], "/.", 
     RowBox[{
      RowBox[{"L", "[", "g__", "]"}], ":>", 
      RowBox[{"{", "g", "}"}]}]}]}], "]"}]}]}], "Input",
 CellChangeTimes->{{3.87733744584068*^9, 3.877337473186795*^9}},
 CellLabel->
  "In[176]:=",ExpressionUUID->"7e5a8741-43ac-4327-aa5f-6dbd2093223d"],

Cell[BoxData[{
 RowBox[{"ClearAll", "[", "BoundaryVectors", "]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"BoundaryVectors", "[", 
   RowBox[{"spinOrder_", ",", "head_"}], "]"}], ":=", 
  RowBox[{"Module", "[", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{"a", ",", "b", ",", "L", ",", "pv"}], "}"}], ",", 
    RowBox[{
     RowBox[{"If", "[", 
      RowBox[{
       RowBox[{"spinOrder", "==", "0"}], ",", 
       RowBox[{"pv", "=", 
        RowBox[{"{", 
         RowBox[{
          RowBox[{"v", "[", "1", "]"}], ",", 
          RowBox[{"v", "[", "1", "]"}]}], "}"}]}]}], "]"}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"If", "[", 
      RowBox[{
       RowBox[{"spinOrder", "==", "1"}], ",", 
       RowBox[{"pv", "=", 
        RowBox[{"{", 
         RowBox[{
          RowBox[{"{", 
           RowBox[{
            RowBox[{"v", "[", "1", "]"}], ",", 
            RowBox[{"p", "[", "1", "]"}]}], "}"}], ",", 
          RowBox[{"{", 
           RowBox[{
            RowBox[{"v", "[", "1", "]"}], ",", 
            RowBox[{"p", "[", "2", "]"}]}], "}"}]}], "}"}]}]}], "]"}], ";", 
     RowBox[{"If", "[", 
      RowBox[{
       RowBox[{
        RowBox[{"EvenQ", "[", "spinOrder", "]"}], "&&", " ", 
        RowBox[{"spinOrder", ">", "1"}]}], ",", 
       RowBox[{"pv", "=", 
        RowBox[{
         RowBox[{
          RowBox[{"Join", "[", 
           RowBox[{
            RowBox[{"{", 
             RowBox[{
              RowBox[{"v", "[", "1", "]"}], ",", 
              RowBox[{"v", "[", "1", "]"}]}], "}"}], ",", "#"}], "]"}], "&"}],
          "/@", 
         RowBox[{"(", 
          RowBox[{
           RowBox[{
            RowBox[{
             RowBox[{
              RowBox[{
               RowBox[{"List", "@@", 
                RowBox[{"(", 
                 RowBox[{
                  SuperscriptBox[
                   RowBox[{"(", 
                    RowBox[{"a", "+", "b"}], ")"}], "spinOrder"], "//", 
                  "Expand"}], ")"}]}], "/.", 
               RowBox[{
                RowBox[{
                 RowBox[{"a_", " ", "b_"}], "/;", 
                 RowBox[{"NumericQ", "[", "a", "]"}]}], ":>", "b"}]}], "/.", 
              RowBox[{"Times", "->", "L"}]}], "/.", 
             RowBox[{
              RowBox[{"Power", "[", 
               RowBox[{"x_", ",", "n_"}], "]"}], ":>", 
              RowBox[{"ConstantArray", "[", 
               RowBox[{"x", ",", "n"}], "]"}]}]}], "/.", 
            RowBox[{
             RowBox[{"L", "[", "f__", "]"}], ":>", 
             RowBox[{"Flatten", "[", 
              RowBox[{"{", "f", "}"}], "]"}]}]}], "/.", 
           RowBox[{"{", 
            RowBox[{
             RowBox[{"a", "->", 
              RowBox[{"head", "[", "1", "]"}]}], ",", 
             RowBox[{"b", "->", 
              RowBox[{"head", "[", "2", "]"}]}]}], "}"}]}], ")"}]}]}]}], 
      "]"}], ";", "\[IndentingNewLine]", 
     RowBox[{"If", "[", 
      RowBox[{
       RowBox[{
        RowBox[{"OddQ", "[", "spinOrder", "]"}], "&&", " ", 
        RowBox[{"spinOrder", ">", "1"}]}], ",", 
       RowBox[{"pv", "=", 
        RowBox[{
         RowBox[{
          RowBox[{"Join", "[", 
           RowBox[{
            RowBox[{"{", 
             RowBox[{"v", "[", "1", "]"}], "}"}], ",", "#"}], "]"}], "&"}], "/@", 
         RowBox[{"(", 
          RowBox[{
           RowBox[{
            RowBox[{
             RowBox[{
              RowBox[{
               RowBox[{"List", "@@", 
                RowBox[{"(", 
                 RowBox[{
                  SuperscriptBox[
                   RowBox[{"(", 
                    RowBox[{"a", "+", "b"}], ")"}], "spinOrder"], "//", 
                  "Expand"}], ")"}]}], "/.", 
               RowBox[{
                RowBox[{
                 RowBox[{"a_", " ", "b_"}], "/;", 
                 RowBox[{"NumericQ", "[", "a", "]"}]}], ":>", "b"}]}], "/.", 
              RowBox[{"Times", "->", "L"}]}], "/.", 
             RowBox[{
              RowBox[{"Power", "[", 
               RowBox[{"x_", ",", "n_"}], "]"}], ":>", 
              RowBox[{"ConstantArray", "[", 
               RowBox[{"x", ",", "n"}], "]"}]}]}], "/.", 
            RowBox[{
             RowBox[{"L", "[", "f__", "]"}], ":>", 
             RowBox[{"Flatten", "[", 
              RowBox[{"{", "f", "}"}], "]"}]}]}], "/.", 
           RowBox[{"{", 
            RowBox[{
             RowBox[{"a", "->", 
              RowBox[{"head", "[", "1", "]"}]}], ",", 
             RowBox[{"b", "->", 
              RowBox[{"head", "[", "2", "]"}]}]}], "}"}]}], ")"}]}]}]}], 
      "]"}], ";", "\[IndentingNewLine]", "pv"}]}], "]"}]}]}], "Input",
 CellChangeTimes->{{3.8773416566037617`*^9, 3.877341711224474*^9}, {
  3.877341776918145*^9, 3.8773419063009233`*^9}, {3.877341937520246*^9, 
  3.877341952447928*^9}, {3.877342001926*^9, 3.8773420048454742`*^9}},
 CellLabel->
  "In[178]:=",ExpressionUUID->"38b08510-db19-43f8-a58a-03d08123cfc5"],

Cell[BoxData[{
 RowBox[{"ClearAll", "[", "BoundaryVectorsG", "]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"BoundaryVectorsG", "[", 
   RowBox[{"spinOrder_", ",", "head_", ",", "pvars_"}], "]"}], ":=", 
  RowBox[{"Module", "[", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{"a", ",", "b", ",", "L", ",", "pv"}], "}"}], ",", 
    "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"If", "[", 
      RowBox[{
       RowBox[{"spinOrder", "==", "1"}], ",", 
       RowBox[{"pv", "=", 
        RowBox[{"Table", "[", 
         RowBox[{
          RowBox[{"{", 
           RowBox[{
            RowBox[{"v", "[", "1", "]"}], ",", 
            RowBox[{"p", "[", "ii", "]"}]}], "}"}], ",", 
          RowBox[{"{", 
           RowBox[{"ii", ",", "pvars"}], "}"}]}], "]"}]}]}], "]"}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"If", "[", 
      RowBox[{
       RowBox[{"spinOrder", ">", "1"}], ",", 
       RowBox[{"pv", "=", 
        RowBox[{
         RowBox[{
          RowBox[{"Join", "[", 
           RowBox[{
            RowBox[{"Table", "[", 
             RowBox[{
              RowBox[{"v", "[", "1", "]"}], ",", "spinOrder"}], "]"}], ",", 
            "#"}], "]"}], "&"}], "/@", 
         RowBox[{"(", 
          RowBox[{
           RowBox[{
            RowBox[{
             RowBox[{
              RowBox[{
               RowBox[{"List", "@@", 
                RowBox[{"(", 
                 RowBox[{
                  SuperscriptBox[
                   RowBox[{"(", 
                    RowBox[{"Total", "[", 
                    RowBox[{"a", "/@", 
                    RowBox[{"Range", "[", "pvars", "]"}]}], "]"}], ")"}], 
                   "spinOrder"], "//", "Expand"}], ")"}]}], "/.", 
               RowBox[{
                RowBox[{
                 RowBox[{"a_", " ", "b_"}], "/;", 
                 RowBox[{"NumericQ", "[", "a", "]"}]}], ":>", "b"}]}], "/.", 
              RowBox[{"Times", "->", "L"}]}], "/.", 
             RowBox[{
              RowBox[{"Power", "[", 
               RowBox[{"x_", ",", "n_"}], "]"}], ":>", 
              RowBox[{"ConstantArray", "[", 
               RowBox[{"x", ",", "n"}], "]"}]}]}], "/.", 
            RowBox[{
             RowBox[{"L", "[", "f__", "]"}], ":>", 
             RowBox[{"Flatten", "[", 
              RowBox[{"{", "f", "}"}], "]"}]}]}], "/.", 
           RowBox[{"{", 
            RowBox[{
             RowBox[{"a", "[", "i_", "]"}], ":>", 
             RowBox[{"head", "[", "i", "]"}]}], "}"}]}], ")"}]}]}]}], "]"}], 
     ";", "\[IndentingNewLine]", "pv"}]}], "]"}]}]}], "Input",
 CellChangeTimes->{{3.878027626618311*^9, 3.8780276287971983`*^9}, {
  3.8780276749699907`*^9, 3.878027685969224*^9}, {3.87802772683783*^9, 
  3.878027789220231*^9}, {3.878027847412304*^9, 3.878027849386404*^9}, {
  3.87802789491831*^9, 3.8780279030166693`*^9}, {3.878028006175324*^9, 
  3.8780280168002443`*^9}, {3.878028047804*^9, 3.878028104335112*^9}},
 CellLabel->
  "In[180]:=",ExpressionUUID->"9e85ef89-ef79-46cb-be32-c43025585f9e"],

Cell[BoxData[{
 RowBox[{"ClearAll", "[", "BoundaryPatitionsAll", 
  "]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"BoundaryPatitionsAll", "[", 
   RowBox[{"spinOrder_", ",", "head_", ",", "glueNumber_"}], "]"}], ":=", 
  RowBox[{
   RowBox[{"Flatten", "[", 
    RowBox[{
     RowBox[{"BoundaryPatitions", "/@", 
      RowBox[{"BoundaryVectorsG", "[", 
       RowBox[{"spinOrder", ",", "head", ",", "glueNumber"}], "]"}]}], ",", 
     "1"}], "]"}], "//", "Union"}]}]}], "Input",
 CellChangeTimes->{{3.878028376498678*^9, 3.878028397332559*^9}},
 CellLabel->
  "In[182]:=",ExpressionUUID->"e6c49810-516a-46b3-91d2-9f6cc77989d2"],

Cell[BoxData[{
 RowBox[{"ClearAll", "[", "monoFS", "]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"monoFS", "[", 
   RowBox[{"spinOrder_", ",", "glueNumber_"}], "]"}], ":=", 
  RowBox[{"Module", "[", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{"factorNumber", ",", "allmonos", ",", "ptsets"}], "}"}], ",", 
    "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"ptsets", "=", 
      RowBox[{"KSetPartitionsEmpty", "[", 
       RowBox[{
        RowBox[{"Join", "[", 
         RowBox[{
          RowBox[{"Table", "[", 
           RowBox[{
            RowBox[{"F", "[", "ii", "]"}], ",", 
            RowBox[{"{", 
             RowBox[{"ii", ",", "glueNumber"}], "}"}]}], "]"}], ",", 
          RowBox[{"{", 
           RowBox[{"S", "[", "0", "]"}], "}"}]}], "]"}], ",", "spinOrder"}], 
       "]"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"allmonos", "=", 
      RowBox[{"DeleteCases", "[", 
       RowBox[{
        RowBox[{
         RowBox[{
          RowBox[{
           RowBox[{
            RowBox[{"(", 
             RowBox[{
              RowBox[{"(", 
               RowBox[{
                RowBox[{
                 RowBox[{"monoAllF", "[", 
                  RowBox[{"ptsets", ",", "#"}], "]"}], "&"}], "/@", 
                RowBox[{"BoundaryPatitionsAll", "[", 
                 RowBox[{"spinOrder", ",", "p", ",", "glueNumber"}], "]"}]}], 
               ")"}], "//", "Flatten"}], ")"}], "//.", "dotRules"}], "/.", 
           RowBox[{
            RowBox[{"a_", " ", "b_"}], "\[RuleDelayed]", " ", 
            RowBox[{"b", "/;", 
             RowBox[{"NumericQ", "[", "a", "]"}]}]}]}], "//", "Flatten"}], "//",
          "DeleteDuplicates"}], ",", "0"}], "]"}]}]}]}], "]"}]}]}], "Input",
 CellChangeTimes->{{3.878028273762349*^9, 3.878028351937826*^9}, {
  3.878028412268785*^9, 3.878028416383037*^9}},
 CellLabel->
  "In[184]:=",ExpressionUUID->"acf5035f-ca44-45ac-b48d-85cb79e62689"],

Cell[BoxData[
 RowBox[{"(*", 
  RowBox[{
   RowBox[{
    RowBox[{"ClearAll", "[", "BoundaryVectorsLinSpin", "]"}], 
    "\[IndentingNewLine]", 
    RowBox[{"BoundaryVectorsLinSpin", "[", 
     RowBox[{"denOrder_", ",", "head_", ",", "pvars_"}], "]"}]}], ":=", 
   RowBox[{"Module", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"a", ",", "b", ",", "L", ",", "pv"}], "}"}], ",", 
     "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"pv", "=", 
       RowBox[{"(", 
        RowBox[{
         RowBox[{
          RowBox[{
           RowBox[{
            RowBox[{
             RowBox[{"List", "@@", 
              RowBox[{"(", 
               RowBox[{
                RowBox[{"(", 
                 RowBox[{"NonCommutativeMultiply", "@@", 
                  RowBox[{"Table", "[", 
                   RowBox[{
                    RowBox[{"Total", "[", 
                    RowBox[{"a", "/@", 
                    RowBox[{"Range", "[", "pvars", "]"}]}], "]"}], ",", 
                    RowBox[{"{", "denOrder", "}"}]}], "]"}]}], ")"}], "//", 
                "ExpandNCM"}], ")"}]}], "/.", 
             RowBox[{
              RowBox[{
               RowBox[{"a_", " ", "b_"}], "/;", 
               RowBox[{"NumericQ", "[", "a", "]"}]}], ":>", "b"}]}], "/.", 
            RowBox[{"NonCommutativeMultiply", "->", "L"}]}], "/.", 
           RowBox[{
            RowBox[{"Power", "[", 
             RowBox[{"x_", ",", "n_"}], "]"}], ":>", 
            RowBox[{"ConstantArray", "[", 
             RowBox[{"x", ",", "n"}], "]"}]}]}], "/.", 
          RowBox[{
           RowBox[{"L", "[", "f__", "]"}], ":>", 
           RowBox[{"Flatten", "[", 
            RowBox[{"{", "f", "}"}], "]"}]}]}], "/.", 
         RowBox[{"{", 
          RowBox[{
           RowBox[{"a", "[", "i_", "]"}], ":>", 
           RowBox[{"{", 
            RowBox[{
             RowBox[{"head", "[", "i", "]"}], ",", 
             RowBox[{"v", "[", "1", "]"}]}], "}"}]}], "}"}]}], ")"}]}], ";", 
      "\[IndentingNewLine]", "pv"}]}], "]"}]}], "*)"}]], "Input",
 CellChangeTimes->{{3.878013329545788*^9, 3.878013406973668*^9}, {
   3.878013472617844*^9, 3.8780134992288218`*^9}, {3.878013576985078*^9, 
   3.878013601845764*^9}, {3.878013635900785*^9, 3.878013706366001*^9}, {
   3.878013741332303*^9, 3.878013774072772*^9}, {3.878013850666292*^9, 
   3.878013858431641*^9}, 3.8780140830272913`*^9, {3.878014413650999*^9, 
   3.878014425329073*^9}, {3.878015716730817*^9, 3.878015754155943*^9}, {
   3.878015797018319*^9, 3.878015851887788*^9}, 3.878020114438388*^9, 
   3.8780282223331757`*^9},
 CellLabel->
  "In[186]:=",ExpressionUUID->"f096a91e-a14a-422f-9dad-273215327dad"],

Cell[BoxData[
 RowBox[{
  RowBox[{"dotRules", "=", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{
      RowBox[{"dot", "[", 
       RowBox[{"a_", ",", 
        RowBox[{"S", "[", "i_", "]"}], ",", "a_"}], "]"}], "\[RuleDelayed]", 
      " ", "0"}], ",", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"dot", "[", 
       RowBox[{"a__", ",", 
        RowBox[{"S", "[", "i_", "]"}], ",", "b__"}], "]"}], "\[RuleDelayed]", 
      " ", 
      RowBox[{"0", "/;", 
       RowBox[{
        RowBox[{
         RowBox[{"{", 
          RowBox[{"a", ",", 
           RowBox[{"S", "[", "i", "]"}], ",", "b"}], "}"}], "==", 
         RowBox[{"Reverse", "[", 
          RowBox[{"{", 
           RowBox[{"a", ",", 
            RowBox[{"S", "[", "i", "]"}], ",", "b"}], "}"}], "]"}]}], "&&", 
        RowBox[{
         RowBox[{"Length", "[", 
          RowBox[{"{", "a", "}"}], "]"}], "\[Equal]", 
         RowBox[{"Length", "[", 
          RowBox[{"{", "b", "}"}], "]"}]}]}]}]}], ",", "\[IndentingNewLine]", 
     
     RowBox[{
      RowBox[{"dot", "[", 
       RowBox[{"a__", ",", 
        RowBox[{"F", "[", "i_", "]"}], ",", "b__"}], "]"}], "\[RuleDelayed]", 
      " ", 
      RowBox[{"0", "/;", 
       RowBox[{
        RowBox[{"{", 
         RowBox[{"a", ",", 
          RowBox[{"F", "[", "i", "]"}], ",", "b"}], "}"}], "==", 
        RowBox[{"Reverse", "[", 
         RowBox[{"{", 
          RowBox[{"a", ",", 
           RowBox[{"F", "[", "i", "]"}], ",", "b"}], "}"}], "]"}]}]}]}], ",", 
     "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"dot", "[", 
       RowBox[{"a_", ",", 
        RowBox[{"F", "[", "i_", "]"}], ",", "a_"}], "]"}], "\[RuleDelayed]", 
      " ", "0"}], ",", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"dot", "[", 
       RowBox[{"a_", ",", 
        RowBox[{"S", "[", "i_", "]"}], ",", "b_"}], "]"}], "\[RuleDelayed]", 
      " ", 
      RowBox[{
       RowBox[{"-", 
        RowBox[{"dot", "[", 
         RowBox[{"b", ",", 
          RowBox[{"S", "[", "i", "]"}], ",", "a"}], "]"}]}], "/;", 
       RowBox[{
        RowBox[{"Sort", "[", 
         RowBox[{"{", 
          RowBox[{"a", ",", "b"}], "}"}], "]"}], "\[NotEqual]", 
        RowBox[{"{", 
         RowBox[{"a", ",", "b"}], "}"}]}]}]}], ",", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"dot", "[", 
       RowBox[{"a_", ",", 
        RowBox[{"F", "[", "i_", "]"}], ",", "b_"}], "]"}], "\[RuleDelayed]", 
      " ", 
      RowBox[{
       RowBox[{"-", 
        RowBox[{"dot", "[", 
         RowBox[{"b", ",", 
          RowBox[{"F", "[", "i", "]"}], ",", "a"}], "]"}]}], "/;", 
       RowBox[{
        RowBox[{"Sort", "[", 
         RowBox[{"{", 
          RowBox[{"a", ",", "b"}], "}"}], "]"}], "\[NotEqual]", 
        RowBox[{"{", 
         RowBox[{"a", ",", "b"}], "}"}]}]}]}], ",", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"dot", "[", 
       RowBox[{
        RowBox[{"p", "[", "a_", "]"}], ",", 
        RowBox[{"F", "[", "a_", "]"}], ",", "b__"}], "]"}], "\[RuleDelayed]", 
      " ", "0"}], ",", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"dot", "[", 
       RowBox[{"b__", ",", 
        RowBox[{"F", "[", "a_", "]"}], ",", 
        RowBox[{"p", "[", "a_", "]"}]}], "]"}], "\[RuleDelayed]", " ", "0"}], 
     ",", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"dot", "[", 
       RowBox[{"a__", ",", 
        RowBox[{"S", "[", "i_", "]"}], ",", 
        RowBox[{"v", "[", "1", "]"}]}], "]"}], "\[RuleDelayed]", " ", "0"}], 
     ",", 
     RowBox[{
      RowBox[{"dot", "[", 
       RowBox[{"b__", ",", 
        RowBox[{"S", "[", "i_", "]"}], ",", 
        RowBox[{"as", "[", "1", "]"}]}], "]"}], "\[RuleDelayed]", " ", "0"}], 
     ",", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"dot", "[", 
       RowBox[{
        RowBox[{"v", "[", "1", "]"}], ",", 
        RowBox[{"v", "[", "1", "]"}]}], "]"}], "\[RuleDelayed]", "1"}], ",", 
     "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"dot", "[", 
       RowBox[{
        RowBox[{"v", "[", "1", "]"}], ",", 
        RowBox[{"S", "[", "i_", "]"}], ",", "a__"}], "]"}], "\[RuleDelayed]", 
      " ", "0"}], ",", 
     RowBox[{
      RowBox[{"dot", "[", 
       RowBox[{
        RowBox[{"as", "[", "1", "]"}], ",", 
        RowBox[{"S", "[", "i_", "]"}], ",", "a__"}], "]"}], "\[RuleDelayed]", 
      " ", "0"}], ",", 
     RowBox[{
      RowBox[{"dot", "[", 
       RowBox[{
        RowBox[{"p", "[", "i_", "]"}], ",", 
        RowBox[{"\[Epsilon]", "[", "i_", "]"}]}], "]"}], "\[RuleDelayed]", 
      "0"}], ",", 
     RowBox[{
      RowBox[{"dot", "[", 
       RowBox[{
        RowBox[{"p", "[", "i_", "]"}], ",", 
        RowBox[{"p", "[", "i_", "]"}]}], "]"}], "\[RuleDelayed]", " ", "0"}], 
     " ", ",", 
     RowBox[{
      RowBox[{"dot", "[", 
       RowBox[{
        RowBox[{"\[Epsilon]", "[", "i_", "]"}], ",", 
        RowBox[{"\[Epsilon]", "[", "i_", "]"}]}], "]"}], "\[RuleDelayed]", 
      " ", "0"}], ",", 
     RowBox[{
      RowBox[{"dot", "[", "a__", "]"}], "\[RuleDelayed]", 
      "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{
        RowBox[{
         RowBox[{"(", 
          RowBox[{"-", "1"}], ")"}], "^", 
         RowBox[{"Length", "[", 
          RowBox[{"{", "a", "}"}], "]"}]}], "*", 
        RowBox[{"dot", "@@", 
         RowBox[{"Reverse", "[", 
          RowBox[{"{", "a", "}"}], "]"}]}]}], "/;", 
       RowBox[{
        RowBox[{"OrderedQ", "[", 
         RowBox[{"{", 
          RowBox[{
           RowBox[{
            RowBox[{"{", "a", "}"}], "//", "Reverse"}], ",", 
           RowBox[{"{", "a", "}"}]}], "}"}], "]"}], "&&", 
        RowBox[{
         RowBox[{"{", "a", "}"}], "=!=", 
         RowBox[{"Reverse", "[", 
          RowBox[{"{", "a", "}"}], "]"}]}]}]}]}]}], "}"}]}], ";"}]], "Input",
 CellChangeTimes->{{3.87735352765903*^9, 3.877353575291686*^9}, {
   3.877506147842967*^9, 3.877506190551264*^9}, 3.878020458873892*^9},
 CellLabel->
  "In[187]:=",ExpressionUUID->"26efa189-4ecc-4695-99da-a77c9b57d98f"]
}, Closed]],

Cell[CellGroupData[{

Cell["Cut conditions general", "Section",
 CellChangeTimes->{{3.877407131689956*^9, 
  3.87740713904277*^9}},ExpressionUUID->"2facbcdd-6529-421e-b087-\
7362503df697"],

Cell[BoxData[
 RowBox[{"ClearAll", "[", 
  RowBox[{
  "CutP12", ",", "ThreePtSpin", ",", "ThreePtSpin", ",", "Cutv1", ",", 
   "ConditionP12", ",", "Conditionv1"}], "]"}]], "Input",
 CellChangeTimes->{{3.87740734109801*^9, 3.877407401096468*^9}},
 CellLabel->
  "In[188]:=",ExpressionUUID->"1ed94398-ee3d-4f3a-bf90-559c2258774b"],

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{"CutP12", "[", "n_", "]"}], ":=", 
   RowBox[{
    RowBox[{
     RowBox[{
      RowBox[{"(", 
       RowBox[{"-", "1"}], ")"}], "^", 
      RowBox[{"(", 
       RowBox[{"n", "/", "2"}], ")"}]}], "*", 
     RowBox[{"1", "/", 
      RowBox[{"Factorial", "[", "n", "]"}]}], "*", 
     RowBox[{
      RowBox[{"(", 
       RowBox[{"dot", "[", 
        RowBox[{
         RowBox[{
          RowBox[{"p", "[", "1", "]"}], "+", 
          RowBox[{"p", "[", "2", "]"}]}], ",", 
         RowBox[{"S", "[", "0", "]"}], ",", 
         RowBox[{"S", "[", "0", "]"}], ",", 
         RowBox[{
          RowBox[{"p", "[", "1", "]"}], "+", 
          RowBox[{"p", "[", "2", "]"}]}]}], "]"}], ")"}], "^", 
      RowBox[{"(", 
       RowBox[{"n", "/", "2"}], ")"}]}], 
     RowBox[{"(", 
      RowBox[{
       RowBox[{
        RowBox[{"dot", "[", 
         RowBox[{
          RowBox[{"\[Epsilon]", "[", "2", "]"}], ",", 
          RowBox[{"p", "[", "1", "]"}]}], "]"}], 
        RowBox[{"dot", "[", 
         RowBox[{
          RowBox[{"v", "[", "1", "]"}], ",", 
          RowBox[{"\[Epsilon]", "[", "1", "]"}]}], "]"}]}], "-", 
       RowBox[{
        RowBox[{"dot", "[", 
         RowBox[{
          RowBox[{"\[Epsilon]", "[", "1", "]"}], ",", 
          RowBox[{"p", "[", "2", "]"}]}], "]"}], 
        RowBox[{"dot", "[", 
         RowBox[{
          RowBox[{"v", "[", "1", "]"}], ",", 
          RowBox[{"\[Epsilon]", "[", "2", "]"}]}], "]"}]}], "+", 
       RowBox[{
        RowBox[{"dot", "[", 
         RowBox[{
          RowBox[{"\[Epsilon]", "[", "1", "]"}], ",", 
          RowBox[{"\[Epsilon]", "[", "2", "]"}]}], "]"}], 
        RowBox[{"dot", "[", 
         RowBox[{
          RowBox[{"v", "[", "1", "]"}], ",", 
          RowBox[{"p", "[", "2", "]"}]}], "]"}]}]}], ")"}]}], "/;", 
    RowBox[{"EvenQ", "[", "n", "]"}]}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"CutP12", "[", "n_", "]"}], ":=", 
   RowBox[{
    RowBox[{
     RowBox[{
      RowBox[{"(", 
       RowBox[{"-", "1"}], ")"}], "^", 
      RowBox[{"(", 
       RowBox[{"Ceiling", "[", 
        RowBox[{"n", "/", "2"}], "]"}], ")"}]}], "*", 
     RowBox[{"1", "/", 
      RowBox[{"Factorial", "[", "n", "]"}]}], "*", 
     RowBox[{
      RowBox[{"(", 
       RowBox[{"dot", "[", 
        RowBox[{
         RowBox[{
          RowBox[{"p", "[", "1", "]"}], "+", 
          RowBox[{"p", "[", "2", "]"}]}], ",", 
         RowBox[{"S", "[", "0", "]"}], ",", 
         RowBox[{"S", "[", "0", "]"}], ",", 
         RowBox[{
          RowBox[{"p", "[", "1", "]"}], "+", 
          RowBox[{"p", "[", "2", "]"}]}]}], "]"}], ")"}], "^", 
      RowBox[{"(", 
       RowBox[{"Floor", "[", 
        RowBox[{"n", "/", "2"}], "]"}], ")"}]}], "*", 
     RowBox[{"(", 
      RowBox[{
       RowBox[{
        RowBox[{"dot", "[", 
         RowBox[{
          RowBox[{"\[Epsilon]", "[", "2", "]"}], ",", 
          RowBox[{"p", "[", "1", "]"}]}], "]"}], 
        RowBox[{"dot", "[", 
         RowBox[{
          RowBox[{
           RowBox[{"p", "[", "1", "]"}], "+", 
           RowBox[{"p", "[", "2", "]"}]}], ",", 
          RowBox[{"S", "[", "0", "]"}], ",", 
          RowBox[{"\[Epsilon]", "[", "1", "]"}]}], "]"}]}], "-", 
       RowBox[{
        RowBox[{"dot", "[", 
         RowBox[{
          RowBox[{"\[Epsilon]", "[", "1", "]"}], ",", 
          RowBox[{"p", "[", "2", "]"}]}], "]"}], 
        RowBox[{"dot", "[", 
         RowBox[{
          RowBox[{
           RowBox[{"p", "[", "1", "]"}], "+", 
           RowBox[{"p", "[", "2", "]"}]}], ",", 
          RowBox[{"S", "[", "0", "]"}], ",", 
          RowBox[{"\[Epsilon]", "[", "2", "]"}]}], "]"}]}], "+", 
       RowBox[{
        RowBox[{"dot", "[", 
         RowBox[{
          RowBox[{"\[Epsilon]", "[", "1", "]"}], ",", 
          RowBox[{"\[Epsilon]", "[", "2", "]"}]}], "]"}], 
        RowBox[{"dot", "[", 
         RowBox[{
          RowBox[{"p", "[", "1", "]"}], ",", 
          RowBox[{"S", "[", "0", "]"}], ",", 
          RowBox[{"p", "[", "2", "]"}]}], "]"}]}]}], ")"}]}], "/;", 
    RowBox[{"OddQ", "[", "n", "]"}]}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"ThreePtSpin", "[", 
    RowBox[{"i_", ",", "n_"}], "]"}], ":=", 
   RowBox[{
    RowBox[{
     RowBox[{
      RowBox[{"(", 
       RowBox[{"-", "1"}], ")"}], "^", 
      RowBox[{"(", 
       RowBox[{"n", "/", "2"}], ")"}]}], "*", 
     RowBox[{"1", "/", 
      RowBox[{"Factorial", "[", "n", "]"}]}], "*", 
     RowBox[{"dot", "[", 
      RowBox[{
       RowBox[{"v", "[", "1", "]"}], ",", 
       RowBox[{"\[Epsilon]", "[", "i", "]"}]}], "]"}], "*", 
     RowBox[{
      RowBox[{"(", 
       RowBox[{"dot", "[", 
        RowBox[{
         RowBox[{"p", "[", "i", "]"}], ",", 
         RowBox[{"S", "[", "0", "]"}], ",", 
         RowBox[{"S", "[", "0", "]"}], ",", 
         RowBox[{"p", "[", "i", "]"}]}], "]"}], ")"}], "^", 
      RowBox[{"(", 
       RowBox[{"n", "/", "2"}], ")"}]}]}], "/;", 
    RowBox[{"EvenQ", "[", "n", "]"}]}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"ThreePtSpin", "[", 
    RowBox[{"i_", ",", "n_"}], "]"}], ":=", 
   RowBox[{
    RowBox[{
     RowBox[{
      RowBox[{"(", 
       RowBox[{"-", "1"}], ")"}], "^", 
      RowBox[{"(", 
       RowBox[{"Ceiling", "[", 
        RowBox[{"n", "/", "2"}], "]"}], ")"}]}], "*", 
     RowBox[{"1", "/", 
      RowBox[{"Factorial", "[", "n", "]"}]}], "*", 
     RowBox[{"dot", "[", 
      RowBox[{
       RowBox[{"p", "[", "i", "]"}], ",", 
       RowBox[{"S", "[", "0", "]"}], ",", 
       RowBox[{"\[Epsilon]", "[", "i", "]"}]}], "]"}], "*", 
     RowBox[{
      RowBox[{"(", 
       RowBox[{"dot", "[", 
        RowBox[{
         RowBox[{"p", "[", "i", "]"}], ",", 
         RowBox[{"S", "[", "0", "]"}], ",", 
         RowBox[{"S", "[", "0", "]"}], ",", 
         RowBox[{"p", "[", "i", "]"}]}], "]"}], ")"}], "^", 
      RowBox[{"(", 
       RowBox[{"Floor", "[", 
        RowBox[{"n", "/", "2"}], "]"}], ")"}]}]}], "/;", 
    RowBox[{"OddQ", "[", "n", "]"}]}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"Cutv1", "[", "n_", "]"}], ":=", 
   RowBox[{"Module", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"terms", "=", 
       RowBox[{"{", "}"}]}], "}"}], ",", 
     RowBox[{
      RowBox[{"Do", "[", 
       RowBox[{
        RowBox[{"AppendTo", "[", 
         RowBox[{"terms", ",", 
          RowBox[{
           RowBox[{"ThreePtSpin", "[", 
            RowBox[{"1", ",", "j"}], "]"}], "*", 
           RowBox[{"ThreePtSpin", "[", 
            RowBox[{"2", ",", 
             RowBox[{"n", "-", "j"}]}], "]"}]}]}], "]"}], ",", 
        RowBox[{"{", 
         RowBox[{"j", ",", "0", ",", "n"}], "}"}]}], "]"}], ";", 
      RowBox[{"Return", "[", 
       RowBox[{"Total", "[", "terms", "]"}], "]"}]}]}], "]"}]}], 
  ";"}]}], "Input",
 CellChangeTimes->{{3.8774051676985087`*^9, 3.8774052165574255`*^9}, {
  3.8774052822446847`*^9, 3.8774052878093433`*^9}, {3.877405396564592*^9, 
  3.877405423680915*^9}, {3.8774054558087597`*^9, 3.8774055498464317`*^9}, {
  3.877405587031207*^9, 3.8774056885754414`*^9}, {3.87740575204082*^9, 
  3.877405754912343*^9}, {3.877405808059714*^9, 3.877405991969165*^9}, {
  3.877406069124985*^9, 3.8774062616973658`*^9}, {3.8774063257692013`*^9, 
  3.8774063498654776`*^9}, {3.87740644671277*^9, 3.877406587677663*^9}, {
  3.8774066202826347`*^9, 3.8774066224990144`*^9}, {3.8774066565456324`*^9, 
  3.877406728103804*^9}, {3.87740675908631*^9, 3.877406806027347*^9}, {
  3.8774068389284067`*^9, 3.8774068458261347`*^9}, {3.8774068771038003`*^9, 
  3.8774069023757334`*^9}},
 CellLabel->
  "In[189]:=",ExpressionUUID->"addf7f2a-cd5d-49f7-8f50-dd1ab1616ed6"],

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{"ConditionP12", "[", 
    RowBox[{"Ansatz_", ",", "n_"}], "]"}], ":=", 
   RowBox[{
    RowBox[{"(", 
     RowBox[{
      RowBox[{"(", 
       RowBox[{"Ansatz", "//.", 
        RowBox[{"{", 
         RowBox[{
          RowBox[{
           RowBox[{"dot", "[", 
            RowBox[{"x__", ",", 
             RowBox[{"F", "[", "c_", "]"}], ",", "y__"}], "]"}], 
           "\[RuleDelayed]", 
           RowBox[{
            RowBox[{
             RowBox[{"dot", "[", 
              RowBox[{"x", ",", 
               RowBox[{"p", "[", "c", "]"}]}], "]"}], "*", 
             RowBox[{"dot", "[", 
              RowBox[{
               RowBox[{"\[Epsilon]", "[", "c", "]"}], ",", "y"}], "]"}]}], 
            "-", 
            RowBox[{
             RowBox[{"dot", "[", 
              RowBox[{"x", ",", 
               RowBox[{"\[Epsilon]", "[", "c", "]"}]}], "]"}], "*", 
             RowBox[{"dot", "[", 
              RowBox[{
               RowBox[{"p", "[", "c", "]"}], ",", "y"}], "]"}]}]}]}], " ", 
          ",", 
          RowBox[{
           RowBox[{"dot", "[", 
            RowBox[{
             RowBox[{"p", "[", "1", "]"}], ",", 
             RowBox[{"p", "[", "2", "]"}]}], "]"}], "\[RuleDelayed]", "0"}], 
          ",", 
          RowBox[{
           RowBox[{"dot", "[", 
            RowBox[{
             RowBox[{"v", "[", "1", "]"}], ",", 
             RowBox[{"p", "[", "2", "]"}]}], "]"}], "\[RuleDelayed]", 
           RowBox[{"-", 
            RowBox[{"dot", "[", 
             RowBox[{
              RowBox[{"v", "[", "1", "]"}], ",", 
              RowBox[{"p", "[", "1", "]"}]}], "]"}]}]}]}], "}"}]}], ")"}], 
      "\[Equal]", 
      RowBox[{"4", "*", 
       RowBox[{"dot", "[", 
        RowBox[{
         RowBox[{"v", "[", "1", "]"}], ",", 
         RowBox[{"p", "[", "1", "]"}]}], "]"}], "*", 
       RowBox[{"CutP12", "[", "n", "]"}]}]}], ")"}], "//.", "dotRules"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"Conditionv1", "[", 
    RowBox[{"Ansatz_", ",", "n_"}], "]"}], ":=", 
   RowBox[{
    RowBox[{"(", 
     RowBox[{
      RowBox[{"(", 
       RowBox[{"Ansatz", "//.", 
        RowBox[{"{", 
         RowBox[{
          RowBox[{
           RowBox[{"dot", "[", 
            RowBox[{"x__", ",", 
             RowBox[{"F", "[", "c_", "]"}], ",", "y__"}], "]"}], 
           "\[RuleDelayed]", 
           RowBox[{
            RowBox[{
             RowBox[{"dot", "[", 
              RowBox[{"x", ",", 
               RowBox[{"p", "[", "c", "]"}]}], "]"}], "*", 
             RowBox[{"dot", "[", 
              RowBox[{
               RowBox[{"\[Epsilon]", "[", "c", "]"}], ",", "y"}], "]"}]}], 
            "-", 
            RowBox[{
             RowBox[{"dot", "[", 
              RowBox[{"x", ",", 
               RowBox[{"\[Epsilon]", "[", "c", "]"}]}], "]"}], "*", 
             RowBox[{"dot", "[", 
              RowBox[{
               RowBox[{"p", "[", "c", "]"}], ",", "y"}], "]"}]}]}]}], " ", 
          ",", 
          RowBox[{
           RowBox[{"dot", "[", 
            RowBox[{
             RowBox[{"v", "[", "1", "]"}], ",", 
             RowBox[{"p", "[", "1", "]"}]}], "]"}], "\[RuleDelayed]", "0"}], 
          ",", 
          RowBox[{
           RowBox[{"dot", "[", 
            RowBox[{
             RowBox[{"v", "[", "1", "]"}], ",", 
             RowBox[{"p", "[", "2", "]"}]}], "]"}], "\[RuleDelayed]", "0"}]}],
          "}"}]}], ")"}], "\[Equal]", 
      RowBox[{"4", "*", 
       RowBox[{"dot", "[", 
        RowBox[{
         RowBox[{"p", "[", "1", "]"}], ",", 
         RowBox[{"p", "[", "2", "]"}]}], "]"}], "*", 
       RowBox[{"Cutv1", "[", "n", "]"}]}]}], ")"}], "//.", "dotRules"}]}], 
  ";"}]}], "Input",
 CellChangeTimes->{
  3.87740613733956*^9, {3.8774069094613323`*^9, 3.8774069103410287`*^9}, {
   3.877407016126568*^9, 3.8774071060978546`*^9}, {3.877407273815625*^9, 
   3.8774073354233522`*^9}},
 CellLabel->
  "In[194]:=",ExpressionUUID->"093ebe73-7fa6-421a-a7cb-b6566c057327"]
}, Closed]],

Cell[CellGroupData[{

Cell["Example S Five point", "Section",
 CellChangeTimes->{{3.877008171032135*^9, 3.877008177039516*^9}, {
  3.8773818494951763`*^9, 3.877381857475391*^9}, {3.878020608795433*^9, 
  3.87802061200184*^9}},ExpressionUUID->"604156b9-0508-4c7d-9a7a-\
b99be3f8fadc"],

Cell[CellGroupData[{

Cell["Setup ansatz", "Subsection",
 CellChangeTimes->{{3.877386203620414*^9, 
  3.877386209613765*^9}},ExpressionUUID->"1f37adfe-a673-4b37-93f5-\
fd1884b57adf"],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{
  RowBox[{"n", "=", "5"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"vponshell", "=", 
   RowBox[{
    RowBox[{"vonshell", "[", 
     RowBox[{
      RowBox[{"n", "-", "1"}], ",", "1"}], "]"}], "/.", 
    RowBox[{"v", "->", 
     RowBox[{"v", "[", "1", "]"}]}]}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{"gponshell", "=", 
  RowBox[{
   RowBox[{"onshell", "[", 
    RowBox[{"n", "-", "1"}], "]"}], "/.", 
   RowBox[{
    RowBox[{"s", "[", 
     RowBox[{"i_", ",", "j_"}], "]"}], ":>", 
    RowBox[{"dot", "[", 
     RowBox[{
      RowBox[{"p", "[", "i", "]"}], ",", 
      RowBox[{"p", "[", "j", "]"}]}], "]"}]}]}]}]}], "Input",
 CellChangeTimes->{{3.878020618673658*^9, 3.878020625406555*^9}, {
   3.878020685245474*^9, 3.8780206881234617`*^9}, 3.878021076476811*^9, {
   3.878022447789905*^9, 3.8780224652203074`*^9}, {3.878024579094555*^9, 
   3.87802460824821*^9}},
 CellLabel->
  "In[1409]:=",ExpressionUUID->"8e07d938-6c93-4c35-b475-53b3cf5a05b4"],

Cell[BoxData[
 RowBox[{
  RowBox[{"dot", "[", 
   RowBox[{
    RowBox[{"p", "[", "2", "]"}], ",", 
    RowBox[{"p", "[", "3", "]"}]}], "]"}], "\[Rule]", 
  RowBox[{
   RowBox[{"-", 
    RowBox[{"dot", "[", 
     RowBox[{
      RowBox[{"p", "[", "1", "]"}], ",", 
      RowBox[{"p", "[", "2", "]"}]}], "]"}]}], "-", 
   RowBox[{"dot", "[", 
    RowBox[{
     RowBox[{"p", "[", "1", "]"}], ",", 
     RowBox[{"p", "[", "3", "]"}]}], "]"}]}]}]], "Output",
 CellChangeTimes->{{3.878024603364303*^9, 3.8780246086311693`*^9}, 
   3.8780958347602053`*^9},
 CellLabel->
  "Out[1411]=",ExpressionUUID->"06db6142-f828-4d52-b9de-b5925cdaafcd"]
}, Open  ]],

Cell[BoxData[{
 RowBox[{
  RowBox[{"denOrder", "=", "1"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"monofs1", "=", 
   RowBox[{"monoFS", "[", 
    RowBox[{"denOrder", ",", 
     RowBox[{"n", "-", "2"}]}], "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"denOrder", "=", "2"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"monofs2", "=", 
   RowBox[{"monoFS", "[", 
    RowBox[{"denOrder", ",", 
     RowBox[{"n", "-", "2"}]}], "]"}]}], ";"}]}], "Input",
 CellChangeTimes->{{3.877381049405899*^9, 3.877381116483204*^9}, {
  3.877381244223319*^9, 3.877381284761427*^9}, {3.877381353256666*^9, 
  3.877381353488029*^9}, {3.87738186344316*^9, 3.877381863777376*^9}, {
  3.8773822047453117`*^9, 3.877382204987795*^9}, {3.8773825485753727`*^9, 
  3.877382548830839*^9}, {3.877382654557598*^9, 3.877382674685717*^9}, {
  3.878016251644945*^9, 3.87801627282722*^9}, {3.878018811842737*^9, 
  3.878018821618462*^9}, {3.878019111987747*^9, 3.8780191881088953`*^9}, {
  3.8780192243067636`*^9, 3.878019263820836*^9}, {3.8780196953188877`*^9, 
  3.8780197336534443`*^9}, {3.878028860196001*^9, 3.878028905573225*^9}},
 CellLabel->
  "In[1412]:=",ExpressionUUID->"a92b9c8e-51f8-407e-8224-ece3eaae9f04"],

Cell[BoxData[
 RowBox[{
  RowBox[{"numAnsatz", "=", 
   RowBox[{
    RowBox[{"(", 
     RowBox[{
      FractionBox[
       RowBox[{
        RowBox[{
         RowBox[{"(", 
          RowBox[{"c", "/@", 
           RowBox[{"Range", "[", 
            RowBox[{"Length", "@", "monofs2"}], "]"}]}], ")"}], ".", 
         "monofs2"}], "/.", 
        RowBox[{
         RowBox[{"c", "[", "i_", "]"}], ":>", 
         RowBox[{"c", "[", 
          RowBox[{"1", ",", "i"}], "]"}]}]}], 
       RowBox[{
        RowBox[{"dot", "[", 
         RowBox[{
          RowBox[{"v", "[", "1", "]"}], ",", 
          RowBox[{"p", "[", "1", "]"}]}], "]"}], 
        RowBox[{"dot", "[", 
         RowBox[{
          RowBox[{"v", "[", "1", "]"}], ",", 
          RowBox[{
           RowBox[{"p", "[", "1", "]"}], "+", 
           RowBox[{"p", "[", "2", "]"}]}]}], "]"}]}]], "+", 
      FractionBox[
       RowBox[{
        RowBox[{
         RowBox[{"(", 
          RowBox[{"c", "/@", 
           RowBox[{"Range", "[", 
            RowBox[{"Length", "@", "monofs2"}], "]"}]}], ")"}], ".", 
         "monofs2"}], "/.", 
        RowBox[{
         RowBox[{"c", "[", "i_", "]"}], ":>", 
         RowBox[{"c", "[", 
          RowBox[{"2", ",", "i"}], "]"}]}]}], 
       RowBox[{
        RowBox[{"dot", "[", 
         RowBox[{
          RowBox[{"v", "[", "1", "]"}], ",", 
          RowBox[{"p", "[", "1", "]"}]}], "]"}], 
        RowBox[{"dot", "[", 
         RowBox[{
          RowBox[{"v", "[", "1", "]"}], ",", 
          RowBox[{
           RowBox[{"p", "[", "1", "]"}], "+", 
           RowBox[{"p", "[", "3", "]"}]}]}], "]"}]}]], "+", 
      FractionBox[
       RowBox[{
        RowBox[{
         RowBox[{"(", 
          RowBox[{"c", "/@", 
           RowBox[{"Range", "[", 
            RowBox[{"Length", "@", "monofs1"}], "]"}]}], ")"}], ".", 
         "monofs1"}], "/.", 
        RowBox[{
         RowBox[{"c", "[", "i_", "]"}], ":>", 
         RowBox[{"c", "[", 
          RowBox[{"3", ",", "i"}], "]"}]}]}], 
       RowBox[{"dot", "[", 
        RowBox[{
         RowBox[{"v", "[", "1", "]"}], ",", 
         RowBox[{"p", "[", "1", "]"}]}], "]"}]]}], ")"}], "//", "Expand"}]}], 
  ";"}]], "Input",
 CellChangeTimes->{{3.878019818828724*^9, 3.8780199018739433`*^9}, {
  3.878019938561898*^9, 3.878020036527034*^9}, {3.8780201912905703`*^9, 
  3.878020210990015*^9}, {3.87802091215549*^9, 3.8780209153502007`*^9}, {
  3.8780300130461073`*^9, 3.8780300429155807`*^9}, {3.8780319820804033`*^9, 
  3.87803198404319*^9}, {3.878032548017993*^9, 3.87803254970131*^9}, {
  3.8780755773066597`*^9, 3.878075579486418*^9}, {3.87808020451082*^9, 
  3.878080207422474*^9}, {3.8780802418491573`*^9, 3.878080244847021*^9}, {
  3.878080502097672*^9, 3.878080502683258*^9}},
 CellLabel->
  "In[1417]:=",ExpressionUUID->"2eb92c90-3759-413d-bc7f-1a09bf3e2c53"],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"(", 
     RowBox[{"List", "@@", 
      RowBox[{"(", 
       RowBox[{
        RowBox[{
         RowBox[{"monofs1", "/.", "vponshell"}], "//", "Total"}], "//", 
        "Expand"}], ")"}]}], ")"}], "/.", 
    RowBox[{
     RowBox[{"a_", " ", "b_"}], ":>", " ", 
     RowBox[{"b", "/;", 
      RowBox[{"NumberQ", "[", "a", "]"}]}]}]}], "//", "Union"}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{"%", "//", "Length"}]}], "Input",
 CellChangeTimes->{{3.878098216984212*^9, 3.8780982186909924`*^9}, {
  3.878098255906135*^9, 
  3.878098397555876*^9}},ExpressionUUID->"74abc309-0cb3-4d4b-9a63-\
a72a96bc37ec"],

Cell[BoxData["42"], "Output",
 CellChangeTimes->{{3.878098214544024*^9, 3.878098219300254*^9}, 
   3.878098259809623*^9, {3.878098292569996*^9, 3.87809839248168*^9}},
 CellLabel->
  "Out[1591]=",ExpressionUUID->"f0e1ac81-aa3e-4911-ac6c-6355c77a2708"]
}, Open  ]]
}, Open  ]],

Cell[CellGroupData[{

Cell["Cut condition Massless", "Subsection",
 CellChangeTimes->{{3.878076730024465*^9, 
  3.8780767381983347`*^9}},ExpressionUUID->"a99cbca3-c478-412c-a3d7-\
706d91371810"],

Cell[BoxData[
 RowBox[{
  RowBox[{"nod", "=", 
   RowBox[{
    RowBox[{
     RowBox[{
      RowBox[{
       RowBox[{"(", 
        RowBox[{"numAnsatz", "//", "expandFS"}], ")"}], "//.", "dotRules"}], "/.",
       "vponshell"}], "/.", 
     RowBox[{
      RowBox[{"\[Epsilon]", "[", "i_", "]"}], ":>", 
      RowBox[{"\[Epsilon]", "[", 
       RowBox[{"p", "[", "i", "]"}], "]"}]}]}], "//", "Expand"}]}], 
  ";"}]], "Input",
 CellChangeTimes->{{3.8780203515119047`*^9, 3.878020399229755*^9}, {
   3.878020431526237*^9, 3.8780204339818277`*^9}, {3.8780205335571136`*^9, 
   3.878020540776443*^9}, 3.8780206405534067`*^9, {3.878020888923959*^9, 
   3.878020889972404*^9}, 3.878021112062257*^9, {3.878022714056156*^9, 
   3.878022715411971*^9}, {3.8780319378374166`*^9, 3.878031956823164*^9}},
 CellLabel->
  "In[1537]:=",ExpressionUUID->"2f3f69f3-5124-4b81-9552-2cb53ab12d1e"],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{"bpeff2", "=", 
  RowBox[{"BinaryProduct", "[", 
   RowBox[{"Range", "[", 
    RowBox[{"n", "-", "2"}], "]"}], "]"}]}], "\n", 
 RowBox[{
  RowBox[{"numList", "=", 
   RowBox[{
    RowBox[{
     RowBox[{"ExpandNCM", "/@", 
      RowBox[{"(", 
       RowBox[{"bpeff2", "/.", 
        RowBox[{"X", "\[Rule]", " ", "NC"}]}], ")"}]}], "/.", 
     RowBox[{"NonCommutativeMultiply", "\[Rule]", " ", "T"}]}], "/.", 
    RowBox[{
     RowBox[{"T", "[", 
      RowBox[{"i1_", ",", "f___"}], "]"}], ":>", " ", 
     RowBox[{"0", "/;", 
      RowBox[{"i1", "\[NotEqual]", "1"}]}]}]}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"numListL", "=", 
   RowBox[{"numList", "/.", 
    RowBox[{
     RowBox[{"T", "[", "f___", "]"}], "\[RuleDelayed]", " ", 
     RowBox[{"(", 
      RowBox[{"nod", "/.", 
       RowBox[{"replace", "[", 
        RowBox[{
         RowBox[{"p", "/@", 
          RowBox[{"{", "f", "}"}]}], ",", 
         RowBox[{"n", "-", "1"}]}], "]"}]}], ")"}]}]}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"numListL", "=", 
   RowBox[{
    RowBox[{"(", 
     RowBox[{"numListL", "/.", 
      RowBox[{
       RowBox[{"F", "[", 
        RowBox[{"p", "[", "i_", "]"}], "]"}], ":>", " ", 
       RowBox[{"F", "[", "i", "]"}]}]}], ")"}], "//", "Expand"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"ppListD", "=", 
   RowBox[{"(", 
    RowBox[{"X2Prop", "/@", "bpeff2"}], ")"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"ppListD", "=", 
   RowBox[{
    RowBox[{"ppListD", "/.", 
     RowBox[{
      RowBox[{"p", "[", "f__", "]"}], "\[RuleDelayed]", 
      RowBox[{"Total", "[", 
       RowBox[{"p", "/@", 
        RowBox[{"{", "f", "}"}]}], "]"}]}]}], "/.", 
    RowBox[{
     RowBox[{"dot", "[", 
      RowBox[{
       RowBox[{"p", "[", "i_", "]"}], ",", 
       RowBox[{"p", "[", "i_", "]"}]}], "]"}], ":>", " ", "0"}]}]}], 
  ";"}], "\n", 
 RowBox[{
  RowBox[{"denAll", "=", 
   RowBox[{"Table", "[", 
    RowBox[{
     RowBox[{"ppListD", "[", 
      RowBox[{"[", "ii", "]"}], "]"}], ",", 
     RowBox[{"{", 
      RowBox[{"ii", ",", 
       RowBox[{"Length", "@", "ppListD"}]}], "}"}]}], "]"}]}], ";"}], "\n", 
 RowBox[{
  RowBox[{"amp5", "=", 
   RowBox[{
    RowBox[{
     RowBox[{"Sum", "[", 
      RowBox[{
       FractionBox[
        RowBox[{"numListL", "[", 
         RowBox[{"[", "ii", "]"}], "]"}], 
        RowBox[{"denAll", "[", 
         RowBox[{"[", "ii", "]"}], "]"}]], ",", 
       RowBox[{"{", 
        RowBox[{"ii", ",", 
         RowBox[{"Length", "@", "ppListD"}]}], "}"}]}], "]"}], "/.", 
     RowBox[{
      RowBox[{"\[Epsilon]", "[", 
       RowBox[{"p", "[", "i_", "]"}], "]"}], ":>", 
      RowBox[{"\[Epsilon]", "[", "i", "]"}]}]}], "//", "Expand"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"amp5", "=", 
   RowBox[{
    RowBox[{
     RowBox[{
      RowBox[{"amp5", "/.", "dotRules"}], "/.", "vponshell"}], "/.", 
     "gponshell"}], "//", "Expand"}]}], ";"}]}], "Input",
 CellChangeTimes->{{3.878022027028722*^9, 3.878022028483653*^9}, {
  3.8780224366059227`*^9, 3.878022442198484*^9}, {3.878022763644738*^9, 
  3.878022823789957*^9}, {3.878022855805319*^9, 3.8780228836038427`*^9}, {
  3.878022958964085*^9, 3.8780229728251*^9}, {3.878025964817404*^9, 
  3.878025974154643*^9}, {3.878032030200883*^9, 3.878032043291239*^9}, {
  3.87807694175404*^9, 3.878076942268965*^9}},
 CellLabel->
  "In[1538]:=",ExpressionUUID->"f3ddb63b-7d8f-4997-9389-f334fbed6258"],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
   RowBox[{"X", "[", 
    RowBox[{"1", ",", 
     RowBox[{"X", "[", 
      RowBox[{"2", ",", "3"}], "]"}]}], "]"}], ",", 
   RowBox[{"X", "[", 
    RowBox[{
     RowBox[{"X", "[", 
      RowBox[{"1", ",", "2"}], "]"}], ",", "3"}], "]"}]}], "}"}]], "Output",
 CellChangeTimes->{
  3.8780227866981993`*^9, 3.8780228244290047`*^9, {3.878022856995924*^9, 
   3.878022886712186*^9}, {3.878022959975482*^9, 3.8780229734233837`*^9}, 
   3.878025942910557*^9, 3.878025974822631*^9, 3.87802604880019*^9, 
   3.87802893737528*^9, 3.8780300797739983`*^9, 3.87803201555766*^9, 
   3.878032046557034*^9, 3.8780325721214447`*^9, 3.878075893987146*^9, 
   3.8780808478320103`*^9, 3.878093449603753*^9, 3.878095848723765*^9, 
   3.878097128656351*^9},
 CellLabel->
  "Out[1538]=",ExpressionUUID->"40828b73-7477-4712-8bf3-39c2327b3db2"]
}, Open  ]],

Cell[BoxData[{
 RowBox[{
  RowBox[{"num", "=", 
   RowBox[{"\[FivePointedStar]", "[", 
    RowBox[{
     RowBox[{"T", "[", 
      RowBox[{"{", "1", "}"}], "]"}], ",", 
     RowBox[{"T", "[", 
      RowBox[{"{", "2", "}"}], "]"}], ",", 
     RowBox[{"T", "[", 
      RowBox[{"{", "3", "}"}], "]"}]}], "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"nod", "=", 
   RowBox[{
    RowBox[{
     RowBox[{"(", 
      RowBox[{
       RowBox[{
        RowBox[{"num", "/.", 
         RowBox[{"T", "->", "T2F"}]}], "/.", "rmzero"}], "/.", 
       RowBox[{"v", "->", " ", 
        RowBox[{"v", "[", "1", "]"}]}]}], ")"}], "/.", 
     RowBox[{
      RowBox[{"F", "[", "i_", "]"}], ":>", " ", 
      RowBox[{"F", "[", 
       RowBox[{"p", "[", "i", "]"}], "]"}]}]}], "/.", 
    RowBox[{
     RowBox[{"p", "[", 
      RowBox[{"f1_", ",", "g__"}], "]"}], ":>", 
     RowBox[{"P", "[", " ", 
      RowBox[{"Total", "[", 
       RowBox[{"p", "/@", 
        RowBox[{"{", 
         RowBox[{"f1", ",", "g"}], "}"}]}], "]"}], "]"}]}]}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"bpeff2", "=", 
   RowBox[{"BinaryProduct", "[", 
    RowBox[{"Range", "[", 
     RowBox[{"n", "-", "2"}], "]"}], "]"}]}], ";"}], "\n", 
 RowBox[{
  RowBox[{"numList", "=", 
   RowBox[{
    RowBox[{
     RowBox[{"ExpandNCM", "/@", 
      RowBox[{"(", 
       RowBox[{"bpeff2", "/.", 
        RowBox[{"X", "\[Rule]", " ", "NC"}]}], ")"}]}], "/.", 
     RowBox[{"NonCommutativeMultiply", "\[Rule]", " ", "T"}]}], "/.", 
    RowBox[{
     RowBox[{"T", "[", 
      RowBox[{"i1_", ",", "f___"}], "]"}], ":>", " ", 
     RowBox[{"0", "/;", 
      RowBox[{"i1", "\[NotEqual]", "1"}]}]}]}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"numListL", "=", 
   RowBox[{"numList", "/.", 
    RowBox[{
     RowBox[{"T", "[", "f___", "]"}], "\[RuleDelayed]", " ", 
     RowBox[{"(", 
      RowBox[{"nod", "/.", 
       RowBox[{"replace", "[", 
        RowBox[{
         RowBox[{"p", "/@", 
          RowBox[{"{", "f", "}"}]}], ",", 
         RowBox[{"n", "-", "1"}]}], "]"}]}], ")"}]}]}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"numListL", "=", 
   RowBox[{
    RowBox[{"(", 
     RowBox[{"numListL", "/.", 
      RowBox[{
       RowBox[{"F", "[", 
        RowBox[{"p", "[", "i_", "]"}], "]"}], ":>", " ", 
       RowBox[{"F", "[", "i", "]"}]}]}], ")"}], "//", "Expand"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"ppListD", "=", 
   RowBox[{"(", 
    RowBox[{"X2Prop", "/@", "bpeff2"}], ")"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"ppListD", "=", 
   RowBox[{
    RowBox[{"ppListD", "/.", 
     RowBox[{
      RowBox[{"p", "[", "f__", "]"}], "\[RuleDelayed]", 
      RowBox[{"Total", "[", 
       RowBox[{"p", "/@", 
        RowBox[{"{", "f", "}"}]}], "]"}]}]}], "/.", 
    RowBox[{
     RowBox[{"dot", "[", 
      RowBox[{
       RowBox[{"p", "[", "i_", "]"}], ",", 
       RowBox[{"p", "[", "i_", "]"}]}], "]"}], ":>", " ", "0"}]}]}], 
  ";"}], "\n", 
 RowBox[{
  RowBox[{"denAll", "=", 
   RowBox[{"Table", "[", 
    RowBox[{
     RowBox[{"ppListD", "[", 
      RowBox[{"[", "ii", "]"}], "]"}], ",", 
     RowBox[{"{", 
      RowBox[{"ii", ",", 
       RowBox[{"Length", "@", "ppListD"}]}], "}"}]}], "]"}]}], ";"}], "\n", 
 RowBox[{
  RowBox[{"ampYM", "=", 
   RowBox[{
    RowBox[{
     RowBox[{"Sum", "[", 
      RowBox[{
       FractionBox[
        RowBox[{"numListL", "[", 
         RowBox[{"[", "ii", "]"}], "]"}], 
        RowBox[{"denAll", "[", 
         RowBox[{"[", "ii", "]"}], "]"}]], ",", 
       RowBox[{"{", 
        RowBox[{"ii", ",", 
         RowBox[{"Length", "@", "ppListD"}]}], "}"}]}], "]"}], "/.", 
     RowBox[{
      RowBox[{"P", "[", "f_", "]"}], ":>", "f"}]}], "//", "Expand"}]}], 
  ";"}]}], "Input",
 CellChangeTimes->{{3.878023857740679*^9, 3.878023860158512*^9}, {
   3.87802396296658*^9, 3.878024017862441*^9}, {3.878024052254986*^9, 
   3.878024058839876*^9}, {3.8780241059261007`*^9, 3.8780241103419027`*^9}, {
   3.878024288644836*^9, 3.8780243205537767`*^9}, 3.878076927512285*^9},
 CellLabel->
  "In[1547]:=",ExpressionUUID->"4ba38add-1e90-4973-a0eb-a9f5230a3a29"],

Cell[BoxData[{
 RowBox[{
  RowBox[{"ampYM", "=", 
   RowBox[{
    RowBox[{"(", 
     RowBox[{
      RowBox[{
       RowBox[{
        RowBox[{
         RowBox[{"(", 
          RowBox[{"ampYM", "//", "expandFS"}], ")"}], "/.", "dotRules"}], "/.",
         "vponshell"}], "/.", "gponshell"}], "//", "Expand"}], ")"}], "//", 
    "MultivariateApart"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"ampYMGlueNum3", "=", 
   RowBox[{
    RowBox[{
     RowBox[{
      RowBox[{
       RowBox[{"ampYM", "/.", 
        RowBox[{"{", 
         RowBox[{
          RowBox[{
           RowBox[{"dot", "[", 
            RowBox[{
             RowBox[{"v", "[", "1", "]"}], ",", "f_"}], "]"}], ":>", 
           RowBox[{"dot", "[", 
            RowBox[{
             RowBox[{
              RowBox[{"p", "[", "1", "]"}], "+", 
              RowBox[{"p", "[", "2", "]"}], "+", 
              RowBox[{"p", "[", "3", "]"}]}], ",", 
             RowBox[{"S", "[", "0", "]"}], ",", "f"}], "]"}]}], ",", 
          RowBox[{
           RowBox[{"dot", "[", 
            RowBox[{"f_", ",", 
             RowBox[{"v", "[", "1", "]"}]}], "]"}], ":>", 
           RowBox[{"dot", "[", 
            RowBox[{
             RowBox[{
              RowBox[{"p", "[", "1", "]"}], "+", 
              RowBox[{"p", "[", "2", "]"}], "+", 
              RowBox[{"p", "[", "3", "]"}]}], ",", 
             RowBox[{"S", "[", "0", "]"}], ",", "f"}], "]"}]}]}], "}"}]}], "/.",
        "dotRules"}], "/.", "vponshell"}], "/.", "gponshell"}], "//", 
    "Expand"}]}], ";"}]}], "Input",
 CellChangeTimes->{{3.878024069941125*^9, 3.87802415205725*^9}, {
   3.878024331157475*^9, 3.878024340048336*^9}, {3.8780243883823147`*^9, 
   3.87802443440853*^9}, {3.878024623562881*^9, 3.878024662661223*^9}, {
   3.878024820522764*^9, 3.878024839044957*^9}, {3.878025373216962*^9, 
   3.878025408461379*^9}, {3.878025474618256*^9, 3.878025484493874*^9}, 
   3.878025529761257*^9, {3.8780757748389797`*^9, 3.878075783185919*^9}, 
   3.878075831065405*^9},
 CellLabel->
  "In[1557]:=",ExpressionUUID->"50109fa6-4aef-4b99-98a7-c5ed1149348c"],

Cell[BoxData[
 RowBox[{
  RowBox[{"comp", "=", 
   RowBox[{
    RowBox[{"amp5", "-", "ampYMGlueNum3"}], "//", "Expand"}]}], 
  ";"}]], "Input",
 CellLabel->
  "In[1559]:=",ExpressionUUID->"d6b198be-e867-4bbb-b3d5-34b139716bfc"],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"ampYMGlueNum3", "//", "Casesdot"}]], "Input",
 CellChangeTimes->{{3.878025359578898*^9, 3.878025361651252*^9}, 
   3.878025545392538*^9},
 CellLabel->
  "In[1441]:=",ExpressionUUID->"cb22c795-a365-4f26-a2e3-e6ef2eb88c94"],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
   RowBox[{"dot", "[", 
    RowBox[{
     RowBox[{"p", "[", "1", "]"}], ",", 
     RowBox[{"p", "[", "2", "]"}]}], "]"}], ",", 
   RowBox[{"dot", "[", 
    RowBox[{
     RowBox[{"p", "[", "1", "]"}], ",", 
     RowBox[{"p", "[", "3", "]"}]}], "]"}], ",", 
   RowBox[{"dot", "[", 
    RowBox[{
     RowBox[{"p", "[", "1", "]"}], ",", 
     RowBox[{"\[Epsilon]", "[", "2", "]"}]}], "]"}], ",", 
   RowBox[{"dot", "[", 
    RowBox[{
     RowBox[{"p", "[", "1", "]"}], ",", 
     RowBox[{"\[Epsilon]", "[", "3", "]"}]}], "]"}], ",", 
   RowBox[{"dot", "[", 
    RowBox[{
     RowBox[{"p", "[", "2", "]"}], ",", 
     RowBox[{"\[Epsilon]", "[", "1", "]"}]}], "]"}], ",", 
   RowBox[{"dot", "[", 
    RowBox[{
     RowBox[{"p", "[", "2", "]"}], ",", 
     RowBox[{"\[Epsilon]", "[", "3", "]"}]}], "]"}], ",", 
   RowBox[{"dot", "[", 
    RowBox[{
     RowBox[{"p", "[", "3", "]"}], ",", 
     RowBox[{"\[Epsilon]", "[", "1", "]"}]}], "]"}], ",", 
   RowBox[{"dot", "[", 
    RowBox[{
     RowBox[{"p", "[", "3", "]"}], ",", 
     RowBox[{"\[Epsilon]", "[", "2", "]"}]}], "]"}], ",", 
   RowBox[{"dot", "[", 
    RowBox[{
     RowBox[{"\[Epsilon]", "[", "1", "]"}], ",", 
     RowBox[{"\[Epsilon]", "[", "2", "]"}]}], "]"}], ",", 
   RowBox[{"dot", "[", 
    RowBox[{
     RowBox[{"\[Epsilon]", "[", "1", "]"}], ",", 
     RowBox[{"\[Epsilon]", "[", "3", "]"}]}], "]"}], ",", 
   RowBox[{"dot", "[", 
    RowBox[{
     RowBox[{"\[Epsilon]", "[", "2", "]"}], ",", 
     RowBox[{"\[Epsilon]", "[", "3", "]"}]}], "]"}], ",", 
   RowBox[{"dot", "[", 
    RowBox[{
     RowBox[{"p", "[", "1", "]"}], ",", 
     RowBox[{"S", "[", "0", "]"}], ",", 
     RowBox[{"p", "[", "2", "]"}]}], "]"}], ",", 
   RowBox[{"dot", "[", 
    RowBox[{
     RowBox[{"p", "[", "1", "]"}], ",", 
     RowBox[{"S", "[", "0", "]"}], ",", 
     RowBox[{"p", "[", "3", "]"}]}], "]"}], ",", 
   RowBox[{"dot", "[", 
    RowBox[{
     RowBox[{"p", "[", "1", "]"}], ",", 
     RowBox[{"S", "[", "0", "]"}], ",", 
     RowBox[{"\[Epsilon]", "[", "1", "]"}]}], "]"}], ",", 
   RowBox[{"dot", "[", 
    RowBox[{
     RowBox[{"p", "[", "1", "]"}], ",", 
     RowBox[{"S", "[", "0", "]"}], ",", 
     RowBox[{"\[Epsilon]", "[", "2", "]"}]}], "]"}], ",", 
   RowBox[{"dot", "[", 
    RowBox[{
     RowBox[{"p", "[", "1", "]"}], ",", 
     RowBox[{"S", "[", "0", "]"}], ",", 
     RowBox[{"\[Epsilon]", "[", "3", "]"}]}], "]"}], ",", 
   RowBox[{"dot", "[", 
    RowBox[{
     RowBox[{"p", "[", "2", "]"}], ",", 
     RowBox[{"S", "[", "0", "]"}], ",", 
     RowBox[{"p", "[", "3", "]"}]}], "]"}], ",", 
   RowBox[{"dot", "[", 
    RowBox[{
     RowBox[{"p", "[", "2", "]"}], ",", 
     RowBox[{"S", "[", "0", "]"}], ",", 
     RowBox[{"\[Epsilon]", "[", "1", "]"}]}], "]"}], ",", 
   RowBox[{"dot", "[", 
    RowBox[{
     RowBox[{"p", "[", "2", "]"}], ",", 
     RowBox[{"S", "[", "0", "]"}], ",", 
     RowBox[{"\[Epsilon]", "[", "2", "]"}]}], "]"}], ",", 
   RowBox[{"dot", "[", 
    RowBox[{
     RowBox[{"p", "[", "2", "]"}], ",", 
     RowBox[{"S", "[", "0", "]"}], ",", 
     RowBox[{"\[Epsilon]", "[", "3", "]"}]}], "]"}], ",", 
   RowBox[{"dot", "[", 
    RowBox[{
     RowBox[{"p", "[", "3", "]"}], ",", 
     RowBox[{"S", "[", "0", "]"}], ",", 
     RowBox[{"\[Epsilon]", "[", "1", "]"}]}], "]"}], ",", 
   RowBox[{"dot", "[", 
    RowBox[{
     RowBox[{"p", "[", "3", "]"}], ",", 
     RowBox[{"S", "[", "0", "]"}], ",", 
     RowBox[{"\[Epsilon]", "[", "2", "]"}]}], "]"}], ",", 
   RowBox[{"dot", "[", 
    RowBox[{
     RowBox[{"p", "[", "3", "]"}], ",", 
     RowBox[{"S", "[", "0", "]"}], ",", 
     RowBox[{"\[Epsilon]", "[", "3", "]"}]}], "]"}]}], "}"}]], "Output",
 CellChangeTimes->{
  3.87802536200679*^9, {3.878025540305586*^9, 3.878025545855358*^9}, 
   3.8780300933405113`*^9, 3.878032064069356*^9, 3.878075792934668*^9, 
   3.878075839458539*^9, 3.878075937649824*^9, 3.87808085634507*^9, 
   3.8780934582049007`*^9, 3.8780958573056183`*^9},
 CellLabel->
  "Out[1441]=",ExpressionUUID->"a9d70966-3ea4-4b2c-8fe0-91e1006c6e28"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"amp5", "//", "Casesdot"}]], "Input",
 CellChangeTimes->{3.878025559520433*^9},
 CellLabel->
  "In[1442]:=",ExpressionUUID->"61e32d22-3e04-4e8a-b0e1-dc5ba8c54a93"],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
   RowBox[{"dot", "[", 
    RowBox[{
     RowBox[{"p", "[", "1", "]"}], ",", 
     RowBox[{"p", "[", "2", "]"}]}], "]"}], ",", 
   RowBox[{"dot", "[", 
    RowBox[{
     RowBox[{"p", "[", "1", "]"}], ",", 
     RowBox[{"p", "[", "3", "]"}]}], "]"}], ",", 
   RowBox[{"dot", "[", 
    RowBox[{
     RowBox[{"p", "[", "1", "]"}], ",", 
     RowBox[{"\[Epsilon]", "[", "2", "]"}]}], "]"}], ",", 
   RowBox[{"dot", "[", 
    RowBox[{
     RowBox[{"p", "[", "1", "]"}], ",", 
     RowBox[{"\[Epsilon]", "[", "3", "]"}]}], "]"}], ",", 
   RowBox[{"dot", "[", 
    RowBox[{
     RowBox[{"p", "[", "2", "]"}], ",", 
     RowBox[{"v", "[", "1", "]"}]}], "]"}], ",", 
   RowBox[{"dot", "[", 
    RowBox[{
     RowBox[{"p", "[", "2", "]"}], ",", 
     RowBox[{"\[Epsilon]", "[", "1", "]"}]}], "]"}], ",", 
   RowBox[{"dot", "[", 
    RowBox[{
     RowBox[{"p", "[", "2", "]"}], ",", 
     RowBox[{"\[Epsilon]", "[", "3", "]"}]}], "]"}], ",", 
   RowBox[{"dot", "[", 
    RowBox[{
     RowBox[{"p", "[", "3", "]"}], ",", 
     RowBox[{"v", "[", "1", "]"}]}], "]"}], ",", 
   RowBox[{"dot", "[", 
    RowBox[{
     RowBox[{"p", "[", "3", "]"}], ",", 
     RowBox[{"\[Epsilon]", "[", "1", "]"}]}], "]"}], ",", 
   RowBox[{"dot", "[", 
    RowBox[{
     RowBox[{"p", "[", "3", "]"}], ",", 
     RowBox[{"\[Epsilon]", "[", "2", "]"}]}], "]"}], ",", 
   RowBox[{"dot", "[", 
    RowBox[{
     RowBox[{"v", "[", "1", "]"}], ",", 
     RowBox[{"\[Epsilon]", "[", "1", "]"}]}], "]"}], ",", 
   RowBox[{"dot", "[", 
    RowBox[{
     RowBox[{"v", "[", "1", "]"}], ",", 
     RowBox[{"\[Epsilon]", "[", "2", "]"}]}], "]"}], ",", 
   RowBox[{"dot", "[", 
    RowBox[{
     RowBox[{"v", "[", "1", "]"}], ",", 
     RowBox[{"\[Epsilon]", "[", "3", "]"}]}], "]"}], ",", 
   RowBox[{"dot", "[", 
    RowBox[{
     RowBox[{"\[Epsilon]", "[", "1", "]"}], ",", 
     RowBox[{"\[Epsilon]", "[", "2", "]"}]}], "]"}], ",", 
   RowBox[{"dot", "[", 
    RowBox[{
     RowBox[{"\[Epsilon]", "[", "1", "]"}], ",", 
     RowBox[{"\[Epsilon]", "[", "3", "]"}]}], "]"}], ",", 
   RowBox[{"dot", "[", 
    RowBox[{
     RowBox[{"\[Epsilon]", "[", "2", "]"}], ",", 
     RowBox[{"\[Epsilon]", "[", "3", "]"}]}], "]"}], ",", 
   RowBox[{"dot", "[", 
    RowBox[{
     RowBox[{"p", "[", "1", "]"}], ",", 
     RowBox[{"S", "[", "0", "]"}], ",", 
     RowBox[{"p", "[", "2", "]"}]}], "]"}], ",", 
   RowBox[{"dot", "[", 
    RowBox[{
     RowBox[{"p", "[", "1", "]"}], ",", 
     RowBox[{"S", "[", "0", "]"}], ",", 
     RowBox[{"p", "[", "3", "]"}]}], "]"}], ",", 
   RowBox[{"dot", "[", 
    RowBox[{
     RowBox[{"p", "[", "1", "]"}], ",", 
     RowBox[{"S", "[", "0", "]"}], ",", 
     RowBox[{"\[Epsilon]", "[", "1", "]"}]}], "]"}], ",", 
   RowBox[{"dot", "[", 
    RowBox[{
     RowBox[{"p", "[", "1", "]"}], ",", 
     RowBox[{"S", "[", "0", "]"}], ",", 
     RowBox[{"\[Epsilon]", "[", "2", "]"}]}], "]"}], ",", 
   RowBox[{"dot", "[", 
    RowBox[{
     RowBox[{"p", "[", "1", "]"}], ",", 
     RowBox[{"S", "[", "0", "]"}], ",", 
     RowBox[{"\[Epsilon]", "[", "3", "]"}]}], "]"}], ",", 
   RowBox[{"dot", "[", 
    RowBox[{
     RowBox[{"p", "[", "2", "]"}], ",", 
     RowBox[{"S", "[", "0", "]"}], ",", 
     RowBox[{"p", "[", "3", "]"}]}], "]"}], ",", 
   RowBox[{"dot", "[", 
    RowBox[{
     RowBox[{"p", "[", "2", "]"}], ",", 
     RowBox[{"S", "[", "0", "]"}], ",", 
     RowBox[{"\[Epsilon]", "[", "1", "]"}]}], "]"}], ",", 
   RowBox[{"dot", "[", 
    RowBox[{
     RowBox[{"p", "[", "2", "]"}], ",", 
     RowBox[{"S", "[", "0", "]"}], ",", 
     RowBox[{"\[Epsilon]", "[", "2", "]"}]}], "]"}], ",", 
   RowBox[{"dot", "[", 
    RowBox[{
     RowBox[{"p", "[", "2", "]"}], ",", 
     RowBox[{"S", "[", "0", "]"}], ",", 
     RowBox[{"\[Epsilon]", "[", "3", "]"}]}], "]"}], ",", 
   RowBox[{"dot", "[", 
    RowBox[{
     RowBox[{"p", "[", "3", "]"}], ",", 
     RowBox[{"S", "[", "0", "]"}], ",", 
     RowBox[{"\[Epsilon]", "[", "1", "]"}]}], "]"}], ",", 
   RowBox[{"dot", "[", 
    RowBox[{
     RowBox[{"p", "[", "3", "]"}], ",", 
     RowBox[{"S", "[", "0", "]"}], ",", 
     RowBox[{"\[Epsilon]", "[", "2", "]"}]}], "]"}], ",", 
   RowBox[{"dot", "[", 
    RowBox[{
     RowBox[{"p", "[", "3", "]"}], ",", 
     RowBox[{"S", "[", "0", "]"}], ",", 
     RowBox[{"\[Epsilon]", "[", "3", "]"}]}], "]"}], ",", 
   RowBox[{"dot", "[", 
    RowBox[{
     RowBox[{"\[Epsilon]", "[", "1", "]"}], ",", 
     RowBox[{"S", "[", "0", "]"}], ",", 
     RowBox[{"\[Epsilon]", "[", "2", "]"}]}], "]"}], ",", 
   RowBox[{"dot", "[", 
    RowBox[{
     RowBox[{"\[Epsilon]", "[", "1", "]"}], ",", 
     RowBox[{"S", "[", "0", "]"}], ",", 
     RowBox[{"\[Epsilon]", "[", "3", "]"}]}], "]"}], ",", 
   RowBox[{"dot", "[", 
    RowBox[{
     RowBox[{"\[Epsilon]", "[", "2", "]"}], ",", 
     RowBox[{"S", "[", "0", "]"}], ",", 
     RowBox[{"\[Epsilon]", "[", "3", "]"}]}], "]"}]}], "}"}]], "Output",
 CellChangeTimes->{3.878025560137146*^9, 3.878025704095583*^9, 
  3.87802595149117*^9, 3.878025989628029*^9, 3.878026059569775*^9, 
  3.878030096513131*^9, 3.878032067650799*^9, 3.878075941938496*^9, 
  3.878080856467115*^9, 3.878093458316214*^9, 3.878095857415905*^9},
 CellLabel->
  "Out[1442]=",ExpressionUUID->"4562bbeb-45c2-455c-9c05-6c419d329978"]
}, Open  ]],

Cell[BoxData[
 RowBox[{
  RowBox[{"cvars", "=", 
   RowBox[{
    RowBox[{"Cases", "[", 
     RowBox[{"comp", ",", 
      RowBox[{"c", "[", "__", "]"}], ",", 
      RowBox[{"{", 
       RowBox[{"0", ",", "\[Infinity]"}], "}"}]}], "]"}], "//", "Union"}]}], 
  ";"}]], "Input",
 CellChangeTimes->{{3.8780251119523973`*^9, 3.87802515275441*^9}, {
  3.878033238685581*^9, 3.8780332388754597`*^9}, {3.87807596060207*^9, 
  3.878075960778406*^9}},
 CellLabel->
  "In[1560]:=",ExpressionUUID->"9193ff38-c4f5-4984-9621-f6856f883032"],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"cvars", "//", "Length"}]], "Input",
 CellChangeTimes->{{3.878025163562392*^9, 3.878025164327901*^9}},
 CellLabel->
  "In[1561]:=",ExpressionUUID->"39adadc5-5e48-4120-8f60-48c236838f1e"],

Cell[BoxData["702"], "Output",
 CellChangeTimes->{3.87802516477238*^9, 3.878026076988738*^9, 
  3.878028973567272*^9, 3.8780301059729843`*^9, 3.87803208614393*^9, 
  3.878033255460141*^9, 3.878075964691884*^9, 3.878080856512931*^9, 
  3.878093458365816*^9, 3.878095857461788*^9, 3.878097147230905*^9},
 CellLabel->
  "Out[1561]=",ExpressionUUID->"5e2f3efe-b977-4c5e-92e6-242e39fb4c87"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{
  RowBox[{"vardot", "=", 
   RowBox[{"comp", "//", "Casesdot"}]}], ";"}], "\n", 
 RowBox[{
  RowBox[{"dot2num", ":=", 
   RowBox[{"Table", "[", 
    RowBox[{
     RowBox[{"Rule", "[", 
      RowBox[{
       RowBox[{"vardot", "[", 
        RowBox[{"[", "ii", "]"}], "]"}], ",", 
       RowBox[{"RandomInteger", "[", 
        RowBox[{"{", 
         RowBox[{"10", ",", "100"}], "}"}], "]"}]}], "]"}], ",", 
     RowBox[{"{", 
      RowBox[{"ii", ",", 
       RowBox[{"Length", "[", "vardot", "]"}]}], "}"}]}], "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{"Monitor", "[", 
  RowBox[{
   RowBox[{
    RowBox[{"eqDep", "=", 
     RowBox[{"Table", "[", 
      RowBox[{
       RowBox[{
        RowBox[{"comp", "\[Equal]", "0"}], "/.", "dot2num"}], ",", 
       RowBox[{"{", 
        RowBox[{"ii", ",", 
         RowBox[{"10", "+", 
          RowBox[{"Length", "[", "cvars", "]"}]}]}], "}"}]}], "]"}]}], ";"}], 
   ",", "ii"}], "]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"sols", "=", 
   RowBox[{
    RowBox[{"Solve", "[", 
     RowBox[{"eqDep", ",", "cvars"}], "]"}], "[", 
    RowBox[{"[", "1", "]"}], "]"}]}], ";"}]}], "Input",
 CellChangeTimes->{{3.878025083563089*^9, 3.878025098342598*^9}, {
  3.87802516936078*^9, 3.878025185960835*^9}, {3.878033243467019*^9, 
  3.8780332467055893`*^9}, {3.8780759694484453`*^9, 3.878075974363841*^9}},
 CellLabel->
  "In[1562]:=",ExpressionUUID->"fddf6110-1455-45a2-bf6f-04258e5c7966"],

Cell[BoxData[
 TemplateBox[{
  "Solve", "svars", 
   "\"Equations may not give solutions for all \\\"solve\\\" variables.\"", 2,
    1565, 79, 28410112452836994704, "Local"},
  "MessageTemplate"]], "Message", "MSG",
 CellChangeTimes->{3.87802613489694*^9, 3.878029156688776*^9, 
  3.8780303199023113`*^9, 3.8780322863051863`*^9, 3.878032831294737*^9, 
  3.878033318277973*^9, 3.878076165657085*^9, 3.8780810434805603`*^9, 
  3.878093646396821*^9, 3.878096045334003*^9, 3.878097342954261*^9},
 CellLabel->
  "During evaluation of \
In[1562]:=",ExpressionUUID->"c5532ae2-0ab9-4043-b427-b979192da345"]
}, Open  ]]
}, Open  ]],

Cell[CellGroupData[{

Cell["Factorisation condition v.p1", "Subsection",
 CellChangeTimes->{{3.878076748965989*^9, 3.878076767862722*^9}, {
  3.87809373543461*^9, 
  3.8780937386875668`*^9}},ExpressionUUID->"59008d8c-f1bc-4395-90d7-\
7585486b8a07"],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{
  RowBox[{"numAnsatz2", "=", 
   RowBox[{
    RowBox[{
     RowBox[{
      RowBox[{
       RowBox[{"(", 
        RowBox[{"numAnsatz", "//", "expandFS"}], ")"}], "//.", "dotRules"}], "/.", 
      RowBox[{"(", 
       RowBox[{
        RowBox[{"vonshell", "[", 
         RowBox[{
          RowBox[{"n", "-", "1"}], ",", "3"}], "]"}], "/.", 
        RowBox[{"v", "->", 
         RowBox[{"v", "[", "1", "]"}]}]}], ")"}]}], "/.", "sols"}], "//", 
    "Expand"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{"%", "//", "Length"}]}], "Input",
 CellChangeTimes->{{3.878076776346158*^9, 3.878076791822427*^9}, {
   3.878076863747164*^9, 3.8780768651784353`*^9}, {3.878077446334421*^9, 
   3.878077450450157*^9}, 3.878080568874198*^9, 3.878080843522138*^9, {
   3.878084931218405*^9, 3.8780849369136047`*^9}, {3.878085107286035*^9, 
   3.878085112014679*^9}, {3.8780852927862673`*^9, 3.878085294285921*^9}},
 CellLabel->
  "In[1449]:=",ExpressionUUID->"dc0dd67c-3dde-4e59-b697-febe97da0a1a"],

Cell[BoxData["7043"], "Output",
 CellChangeTimes->{{3.87807677960294*^9, 3.878076792387086*^9}, 
   3.878076869394702*^9, 3.878077463656658*^9, 3.878080582971023*^9, 
   3.878081061748372*^9, 3.878084951014349*^9, 3.878085126532173*^9, 
   3.878085312641127*^9, 3.878093665706396*^9, 3.87809605896621*^9},
 CellLabel->
  "Out[1450]=",ExpressionUUID->"8a76cba9-f261-4be5-b14f-63fa4d5cfc67"]
}, Open  ]],

Cell[BoxData[
 RowBox[{
  RowBox[{"numAnsatzvp1", "=", 
   RowBox[{
    RowBox[{
     RowBox[{
      RowBox[{"(", 
       RowBox[{
        RowBox[{
         RowBox[{"(", 
          RowBox[{"numAnsatz2", "//", 
           RowBox[{"Cases", "[", 
            RowBox[{"Times", "[", 
             RowBox[{"f___", ",", 
              RowBox[{"Power", "[", 
               RowBox[{
                RowBox[{"dot", "[", 
                 RowBox[{
                  RowBox[{"p", "[", "1", "]"}], ",", 
                  RowBox[{"v", "[", "1", "]"}]}], "]"}], ",", 
                RowBox[{"-", "1"}]}], "]"}], ",", "g___"}], "]"}], "]"}]}], 
          ")"}], "/.", 
         RowBox[{
          RowBox[{"Power", "[", 
           RowBox[{
            RowBox[{"dot", "[", 
             RowBox[{
              RowBox[{"p", "[", "1", "]"}], ",", 
              RowBox[{"v", "[", "1", "]"}]}], "]"}], ",", 
            RowBox[{"-", "1"}]}], "]"}], "->", "1"}]}], "//", "Total"}], 
       ")"}], "//.", "dotRules"}], "/.", "vponshell"}], "/.", 
    RowBox[{"{", 
     RowBox[{
      RowBox[{
       RowBox[{"dot", "[", 
        RowBox[{
         RowBox[{"p", "[", "1", "]"}], ",", 
         RowBox[{"v", "[", "1", "]"}]}], "]"}], "->", "0"}], ",", 
      RowBox[{
       RowBox[{"dot", "[", 
        RowBox[{
         RowBox[{"p", "[", "2", "]"}], ",", 
         RowBox[{"v", "[", "1", "]"}]}], "]"}], "->", 
       RowBox[{"-", 
        RowBox[{"dot", "[", 
         RowBox[{
          RowBox[{"p", "[", "3", "]"}], ",", 
          RowBox[{"v", "[", "1", "]"}]}], "]"}]}]}]}], "}"}]}]}], 
  ";"}]], "Input",
 CellChangeTimes->{{3.878077052129978*^9, 3.878077125591745*^9}, {
   3.878077237157652*^9, 3.878077281353335*^9}, {3.8780773702267103`*^9, 
   3.8780774435353603`*^9}, {3.8780774739935207`*^9, 3.8780775017717133`*^9}, 
   3.878079930873101*^9, 3.878079973240665*^9, {3.878085415182927*^9, 
   3.8780854153236303`*^9}, 3.878085446328352*^9},
 CellLabel->
  "In[1451]:=",ExpressionUUID->"dd10c95d-9715-47e2-bb63-16e790130cca"],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"numAnsatzvp1", "//", "Length"}]], "Input",
 CellChangeTimes->{{3.878085457345728*^9, 3.878085458484248*^9}},
 CellLabel->
  "In[1452]:=",ExpressionUUID->"41dc9814-153d-4905-baad-0973404bfe2d"],

Cell[BoxData["1830"], "Output",
 CellChangeTimes->{{3.878085424115284*^9, 3.8780854589677*^9}, 
   3.878093671135722*^9, 3.878096059862764*^9},
 CellLabel->
  "Out[1452]=",ExpressionUUID->"3753f080-830a-4d22-9ce1-517e08bb0017"]
}, Open  ]],

Cell[BoxData[{
 RowBox[{
  RowBox[{"num1", "=", 
   RowBox[{
    RowBox[{
     RowBox[{"T", "[", 
      RowBox[{"{", "1", "}"}], "]"}], "/.", 
     RowBox[{"T", "->", "T2F"}]}], "/.", 
    RowBox[{"v", "->", 
     RowBox[{"v", "[", "1", "]"}]}]}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"num2", "=", 
   RowBox[{"(", 
    RowBox[{
     FractionBox[
      RowBox[{"dot", "[", 
       RowBox[{
        RowBox[{"p", "[", "2", "]"}], ",", 
        RowBox[{"S", "[", "0", "]"}], ",", 
        RowBox[{"F", "[", "2", "]"}], ",", 
        RowBox[{"F", "[", "3", "]"}], ",", 
        RowBox[{"v", "[", "1", "]"}]}], "]"}], 
      RowBox[{"dot", "[", 
       RowBox[{
        RowBox[{"p", "[", "2", "]"}], ",", 
        RowBox[{"v", "[", "1", "]"}]}], "]"}]], "+", 
     FractionBox[
      RowBox[{"dot", "[", 
       RowBox[{
        RowBox[{"p", "[", "2", "]"}], ",", 
        RowBox[{"S", "[", "0", "]"}], ",", 
        RowBox[{"F", "[", "3", "]"}], ",", 
        RowBox[{"F", "[", "2", "]"}], ",", 
        RowBox[{"v", "[", "1", "]"}]}], "]"}], 
      RowBox[{"dot", "[", 
       RowBox[{
        RowBox[{"p", "[", "2", "]"}], ",", 
        RowBox[{"v", "[", "1", "]"}]}], "]"}]], "-", 
     FractionBox[
      RowBox[{"dot", "[", 
       RowBox[{
        RowBox[{"p", "[", "2", "]"}], ",", 
        RowBox[{"F", "[", "3", "]"}], ",", 
        RowBox[{"S", "[", "0", "]"}], ",", 
        RowBox[{"F", "[", "2", "]"}], ",", 
        RowBox[{"v", "[", "1", "]"}]}], "]"}], 
      RowBox[{"dot", "[", 
       RowBox[{
        RowBox[{"p", "[", "2", "]"}], ",", 
        RowBox[{"v", "[", "1", "]"}]}], "]"}]], "+", 
     FractionBox[
      RowBox[{"dot", "[", 
       RowBox[{
        RowBox[{"p", "[", "3", "]"}], ",", 
        RowBox[{"S", "[", "0", "]"}], ",", 
        RowBox[{"F", "[", "3", "]"}], ",", 
        RowBox[{"F", "[", "2", "]"}], ",", 
        RowBox[{"v", "[", "1", "]"}]}], "]"}], 
      RowBox[{"dot", "[", 
       RowBox[{
        RowBox[{"p", "[", "2", "]"}], ",", 
        RowBox[{"v", "[", "1", "]"}]}], "]"}]]}], ")"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"numvp1", "=", 
   RowBox[{
    RowBox[{
     RowBox[{
      RowBox[{
       RowBox[{"dot", "[", 
        RowBox[{
         RowBox[{"p", "[", "1", "]"}], ",", 
         RowBox[{"p", "[", "2", "]"}]}], "]"}], 
       RowBox[{"(", 
        RowBox[{
         RowBox[{
          RowBox[{"c", "[", "0", "]"}], "num1", "*", "num2"}], "+", 
         RowBox[{
          FractionBox["1", 
           RowBox[{"dot", "[", 
            RowBox[{
             RowBox[{"p", "[", "2", "]"}], ",", 
             RowBox[{"v", "[", "1", "]"}]}], "]"}]], 
          RowBox[{"c", "[", "1", "]"}], 
          RowBox[{"dot", "[", 
           RowBox[{
            RowBox[{"p", "[", "1", "]"}], ",", 
            RowBox[{"S", "[", "0", "]"}], ",", 
            RowBox[{"\[Epsilon]", "[", "1", "]"}]}], "]"}], "*", 
          RowBox[{"dot", "[", 
           RowBox[{
            RowBox[{"v", "[", "1", "]"}], ",", 
            RowBox[{"F", "[", "2", "]"}], ",", 
            RowBox[{"F", "[", "3", "]"}], ",", 
            RowBox[{"v", "[", "1", "]"}]}], "]"}]}]}], ")"}]}], "//.", 
      "dotRules"}], "//", "expandFS"}], "//", "Expand"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"numvp1", "=", 
   RowBox[{
    RowBox[{
     RowBox[{"numvp1", "//.", "dotRules"}], "/.", "vponshell"}], "/.", 
    RowBox[{"{", 
     RowBox[{
      RowBox[{
       RowBox[{"dot", "[", 
        RowBox[{
         RowBox[{"p", "[", "1", "]"}], ",", 
         RowBox[{"v", "[", "1", "]"}]}], "]"}], "->", "0"}], ",", 
      RowBox[{
       RowBox[{"dot", "[", 
        RowBox[{
         RowBox[{"p", "[", "2", "]"}], ",", 
         RowBox[{"v", "[", "1", "]"}]}], "]"}], "->", 
       RowBox[{"-", 
        RowBox[{"dot", "[", 
         RowBox[{
          RowBox[{"p", "[", "3", "]"}], ",", 
          RowBox[{"v", "[", "1", "]"}]}], "]"}]}]}]}], "}"}]}]}], 
  ";"}]}], "Input",
 CellChangeTimes->{{3.878077591985273*^9, 3.8780776461342783`*^9}, {
   3.878077953502172*^9, 3.878077980733405*^9}, {3.878078491930747*^9, 
   3.878078549563458*^9}, {3.878078580745262*^9, 3.87807865251903*^9}, 
   3.878078684800146*^9, {3.878079206140265*^9, 3.878079212664543*^9}, {
   3.878079938416065*^9, 3.8780799390210323`*^9}, {3.878079982854789*^9, 
   3.878079996138009*^9}, 3.878080718496252*^9, 3.878080776110016*^9, {
   3.878081116226698*^9, 3.8780811179219093`*^9}, {3.878081897887516*^9, 
   3.878081929737031*^9}, {3.8780819770250673`*^9, 3.8780819885274878`*^9}, 
   3.8780820357161922`*^9, {3.878082093586617*^9, 3.878082094494379*^9}, 
   3.878082200584118*^9, 3.8780823524734297`*^9, 3.8780843780876017`*^9, {
   3.87808451838385*^9, 3.878084553403726*^9}, {3.878084767872551*^9, 
   3.878084809993238*^9}, {3.878093413770879*^9, 3.878093418381057*^9}},
 CellLabel->
  "In[1453]:=",ExpressionUUID->"ca9ad445-a783-4399-bc8f-cb27decc7264"],

Cell[BoxData[
 RowBox[{
  RowBox[{"compvp1", "=", 
   RowBox[{"numAnsatzvp1", "-", "numvp1"}]}], ";"}]], "Input",
 CellChangeTimes->{{3.8780781147500143`*^9, 3.878078179889933*^9}, {
   3.878078714167301*^9, 3.878078719908218*^9}, {3.878078864983605*^9, 
   3.8780788894932623`*^9}, 3.878079927920136*^9, 3.87808000213634*^9},
 CellLabel->
  "In[1457]:=",ExpressionUUID->"4c9c479b-3f9e-47b7-87cc-4f2aaffc75ff"],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  RowBox[{"4", " ", 
   RowBox[{
    SubscriptBox["p", "1"], "\[CenterDot]", "S", "\[CenterDot]", 
    SubscriptBox["F", "1"], "\[CenterDot]", 
    SubscriptBox["F", "2"], "\[CenterDot]", "v"}]}], "+", 
  RowBox[{"4", 
   RowBox[{
    SubscriptBox["p", "1"], "\[CenterDot]", "S", "\[CenterDot]", 
    SubscriptBox["F", "2"], "\[CenterDot]", 
    SubscriptBox["F", "1"], "\[CenterDot]", "v"}]}], "-", 
  RowBox[{"4", " ", 
   RowBox[{
    SubscriptBox["p", "1"], "\[CenterDot]", 
    SubscriptBox["F", "2"], "\[CenterDot]", "S", "\[CenterDot]", 
    SubscriptBox["F", "1"], "\[CenterDot]", "v"}]}], "+", 
  RowBox[{"4", " ", 
   RowBox[{
    SubscriptBox["p", "2"], "\[CenterDot]", "S", "\[CenterDot]", 
    SubscriptBox["F", "2"], "\[CenterDot]", 
    SubscriptBox["F", "1"], "\[CenterDot]", "v"}]}]}]], "Input",
 CellChangeTimes->{{3.878078468972107*^9, 3.8780784821254663`*^9}},
 CellLabel->
  "In[1458]:=",ExpressionUUID->"7b804a7e-9ab9-4bf6-9230-5156345eb783"],

Cell[BoxData[
 RowBox[{
  RowBox[{"4", " ", 
   RowBox[{
    SubscriptBox["p", "1"], "\[CenterDot]", "S", "\[CenterDot]", 
    SubscriptBox["F", "1"], "\[CenterDot]", 
    SubscriptBox["F", "2"], "\[CenterDot]", "v"}]}], "+", 
  RowBox[{"4", " ", 
   RowBox[{
    SubscriptBox["p", "1"], "\[CenterDot]", "S", "\[CenterDot]", 
    SubscriptBox["F", "2"], "\[CenterDot]", 
    SubscriptBox["F", "1"], "\[CenterDot]", "v"}]}], "-", 
  RowBox[{"4", " ", 
   RowBox[{
    SubscriptBox["p", "1"], "\[CenterDot]", 
    SubscriptBox["F", "2"], "\[CenterDot]", "S", "\[CenterDot]", 
    SubscriptBox["F", "1"], "\[CenterDot]", "v"}]}], "+", 
  RowBox[{"4", " ", 
   RowBox[{
    SubscriptBox["p", "2"], "\[CenterDot]", "S", "\[CenterDot]", 
    SubscriptBox["F", "2"], "\[CenterDot]", 
    SubscriptBox["F", "1"], "\[CenterDot]", "v"}]}]}]], "Output",
 CellChangeTimes->{3.878096059926221*^9},
 CellLabel->
  "Out[1458]=",ExpressionUUID->"8d72b292-802c-43a4-a0ca-d38966e7416c"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"compvp1", "//", "Casesdot"}]], "Input",
 CellChangeTimes->{{3.8780788203554583`*^9, 3.878078825352446*^9}},
 CellLabel->
  "In[1459]:=",ExpressionUUID->"062d9e59-9330-4ae3-a27e-eaeb0141a898"],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
   RowBox[{"dot", "[", 
    RowBox[{
     RowBox[{"p", "[", "1", "]"}], ",", 
     RowBox[{"p", "[", "2", "]"}]}], "]"}], ",", 
   RowBox[{"dot", "[", 
    RowBox[{
     RowBox[{"p", "[", "1", "]"}], ",", 
     RowBox[{"p", "[", "3", "]"}]}], "]"}], ",", 
   RowBox[{"dot", "[", 
    RowBox[{
     RowBox[{"p", "[", "1", "]"}], ",", 
     RowBox[{"\[Epsilon]", "[", "2", "]"}]}], "]"}], ",", 
   RowBox[{"dot", "[", 
    RowBox[{
     RowBox[{"p", "[", "1", "]"}], ",", 
     RowBox[{"\[Epsilon]", "[", "3", "]"}]}], "]"}], ",", 
   RowBox[{"dot", "[", 
    RowBox[{
     RowBox[{"p", "[", "2", "]"}], ",", 
     RowBox[{"p", "[", "3", "]"}]}], "]"}], ",", 
   RowBox[{"dot", "[", 
    RowBox[{
     RowBox[{"p", "[", "2", "]"}], ",", 
     RowBox[{"\[Epsilon]", "[", "1", "]"}]}], "]"}], ",", 
   RowBox[{"dot", "[", 
    RowBox[{
     RowBox[{"p", "[", "2", "]"}], ",", 
     RowBox[{"\[Epsilon]", "[", "3", "]"}]}], "]"}], ",", 
   RowBox[{"dot", "[", 
    RowBox[{
     RowBox[{"p", "[", "3", "]"}], ",", 
     RowBox[{"v", "[", "1", "]"}]}], "]"}], ",", 
   RowBox[{"dot", "[", 
    RowBox[{
     RowBox[{"p", "[", "3", "]"}], ",", 
     RowBox[{"\[Epsilon]", "[", "1", "]"}]}], "]"}], ",", 
   RowBox[{"dot", "[", 
    RowBox[{
     RowBox[{"p", "[", "3", "]"}], ",", 
     RowBox[{"\[Epsilon]", "[", "2", "]"}]}], "]"}], ",", 
   RowBox[{"dot", "[", 
    RowBox[{
     RowBox[{"v", "[", "1", "]"}], ",", 
     RowBox[{"\[Epsilon]", "[", "1", "]"}]}], "]"}], ",", 
   RowBox[{"dot", "[", 
    RowBox[{
     RowBox[{"v", "[", "1", "]"}], ",", 
     RowBox[{"\[Epsilon]", "[", "2", "]"}]}], "]"}], ",", 
   RowBox[{"dot", "[", 
    RowBox[{
     RowBox[{"v", "[", "1", "]"}], ",", 
     RowBox[{"\[Epsilon]", "[", "3", "]"}]}], "]"}], ",", 
   RowBox[{"dot", "[", 
    RowBox[{
     RowBox[{"\[Epsilon]", "[", "1", "]"}], ",", 
     RowBox[{"\[Epsilon]", "[", "2", "]"}]}], "]"}], ",", 
   RowBox[{"dot", "[", 
    RowBox[{
     RowBox[{"\[Epsilon]", "[", "1", "]"}], ",", 
     RowBox[{"\[Epsilon]", "[", "3", "]"}]}], "]"}], ",", 
   RowBox[{"dot", "[", 
    RowBox[{
     RowBox[{"\[Epsilon]", "[", "2", "]"}], ",", 
     RowBox[{"\[Epsilon]", "[", "3", "]"}]}], "]"}], ",", 
   RowBox[{"dot", "[", 
    RowBox[{
     RowBox[{"p", "[", "1", "]"}], ",", 
     RowBox[{"S", "[", "0", "]"}], ",", 
     RowBox[{"p", "[", "2", "]"}]}], "]"}], ",", 
   RowBox[{"dot", "[", 
    RowBox[{
     RowBox[{"p", "[", "1", "]"}], ",", 
     RowBox[{"S", "[", "0", "]"}], ",", 
     RowBox[{"p", "[", "3", "]"}]}], "]"}], ",", 
   RowBox[{"dot", "[", 
    RowBox[{
     RowBox[{"p", "[", "1", "]"}], ",", 
     RowBox[{"S", "[", "0", "]"}], ",", 
     RowBox[{"\[Epsilon]", "[", "1", "]"}]}], "]"}], ",", 
   RowBox[{"dot", "[", 
    RowBox[{
     RowBox[{"p", "[", "1", "]"}], ",", 
     RowBox[{"S", "[", "0", "]"}], ",", 
     RowBox[{"\[Epsilon]", "[", "2", "]"}]}], "]"}], ",", 
   RowBox[{"dot", "[", 
    RowBox[{
     RowBox[{"p", "[", "1", "]"}], ",", 
     RowBox[{"S", "[", "0", "]"}], ",", 
     RowBox[{"\[Epsilon]", "[", "3", "]"}]}], "]"}], ",", 
   RowBox[{"dot", "[", 
    RowBox[{
     RowBox[{"p", "[", "2", "]"}], ",", 
     RowBox[{"S", "[", "0", "]"}], ",", 
     RowBox[{"p", "[", "3", "]"}]}], "]"}], ",", 
   RowBox[{"dot", "[", 
    RowBox[{
     RowBox[{"p", "[", "2", "]"}], ",", 
     RowBox[{"S", "[", "0", "]"}], ",", 
     RowBox[{"\[Epsilon]", "[", "1", "]"}]}], "]"}], ",", 
   RowBox[{"dot", "[", 
    RowBox[{
     RowBox[{"p", "[", "2", "]"}], ",", 
     RowBox[{"S", "[", "0", "]"}], ",", 
     RowBox[{"\[Epsilon]", "[", "2", "]"}]}], "]"}], ",", 
   RowBox[{"dot", "[", 
    RowBox[{
     RowBox[{"p", "[", "2", "]"}], ",", 
     RowBox[{"S", "[", "0", "]"}], ",", 
     RowBox[{"\[Epsilon]", "[", "3", "]"}]}], "]"}], ",", 
   RowBox[{"dot", "[", 
    RowBox[{
     RowBox[{"p", "[", "3", "]"}], ",", 
     RowBox[{"S", "[", "0", "]"}], ",", 
     RowBox[{"\[Epsilon]", "[", "1", "]"}]}], "]"}], ",", 
   RowBox[{"dot", "[", 
    RowBox[{
     RowBox[{"p", "[", "3", "]"}], ",", 
     RowBox[{"S", "[", "0", "]"}], ",", 
     RowBox[{"\[Epsilon]", "[", "2", "]"}]}], "]"}], ",", 
   RowBox[{"dot", "[", 
    RowBox[{
     RowBox[{"p", "[", "3", "]"}], ",", 
     RowBox[{"S", "[", "0", "]"}], ",", 
     RowBox[{"\[Epsilon]", "[", "3", "]"}]}], "]"}], ",", 
   RowBox[{"dot", "[", 
    RowBox[{
     RowBox[{"\[Epsilon]", "[", "1", "]"}], ",", 
     RowBox[{"S", "[", "0", "]"}], ",", 
     RowBox[{"\[Epsilon]", "[", "2", "]"}]}], "]"}], ",", 
   RowBox[{"dot", "[", 
    RowBox[{
     RowBox[{"\[Epsilon]", "[", "1", "]"}], ",", 
     RowBox[{"S", "[", "0", "]"}], ",", 
     RowBox[{"\[Epsilon]", "[", "3", "]"}]}], "]"}], ",", 
   RowBox[{"dot", "[", 
    RowBox[{
     RowBox[{"\[Epsilon]", "[", "2", "]"}], ",", 
     RowBox[{"S", "[", "0", "]"}], ",", 
     RowBox[{"\[Epsilon]", "[", "3", "]"}]}], "]"}]}], "}"}]], "Output",
 CellChangeTimes->{3.8780787909855328`*^9, 3.878078825754147*^9, 
  3.8780789139500523`*^9, 3.878079583885482*^9, 3.8780807366766977`*^9, 
  3.87808078442798*^9, 3.878096059944249*^9},
 CellLabel->
  "Out[1459]=",ExpressionUUID->"d3da7001-1f97-47df-9928-052b7b263da5"]
}, Open  ]],

Cell[BoxData[{
 RowBox[{
  RowBox[{"cvars", "=", 
   RowBox[{
    RowBox[{"Cases", "[", 
     RowBox[{"compvp1", ",", 
      RowBox[{"c", "[", "__", "]"}], ",", 
      RowBox[{"{", 
       RowBox[{"0", ",", "\[Infinity]"}], "}"}]}], "]"}], "//", "Union"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"vardot", "=", 
   RowBox[{"compvp1", "//", "Casesdot"}]}], ";"}]}], "Input",
 CellChangeTimes->{{3.878078218083035*^9, 3.878078227195683*^9}},
 CellLabel->
  "In[1460]:=",ExpressionUUID->"0bebda31-7cb7-4bff-9b51-527173edc4e6"],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"cvars", "//", "Length"}]], "Input",
 CellChangeTimes->{{3.878078250405406*^9, 3.8780782515980988`*^9}, 
   3.8780793030421352`*^9, {3.878080618122617*^9, 3.878080619511405*^9}},
 CellLabel->
  "In[1462]:=",ExpressionUUID->"2d742d42-c9ab-44d1-a0ff-2066ee294ede"],

Cell[BoxData["109"], "Output",
 CellChangeTimes->{
  3.878078252063862*^9, 3.878078732430634*^9, {3.8780792683050127`*^9, 
   3.878079303531766*^9}, {3.8780806116761723`*^9, 3.878080620497012*^9}, 
   3.878080793272333*^9, 3.8780810935750732`*^9, 3.8780811318686132`*^9, 
   3.878081941084124*^9, 3.8780820011325197`*^9, 3.878082120982493*^9, 
   3.878084828486793*^9, 3.878085517830093*^9, 3.878093680935251*^9, 
   3.878096059965028*^9},
 CellLabel->
  "Out[1462]=",ExpressionUUID->"9e4d7f82-f9d7-4a6b-ad9b-31923aefe943"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{
  RowBox[{"dot2num", ":=", 
   RowBox[{"Table", "[", 
    RowBox[{
     RowBox[{"Rule", "[", 
      RowBox[{
       RowBox[{"vardot", "[", 
        RowBox[{"[", "ii", "]"}], "]"}], ",", 
       RowBox[{"RandomInteger", "[", 
        RowBox[{"{", 
         RowBox[{"10", ",", "100"}], "}"}], "]"}]}], "]"}], ",", 
     RowBox[{"{", 
      RowBox[{"ii", ",", 
       RowBox[{"Length", "[", "vardot", "]"}]}], "}"}]}], "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{"Monitor", "[", 
  RowBox[{
   RowBox[{
    RowBox[{"eqDep", "=", 
     RowBox[{"Table", "[", 
      RowBox[{
       RowBox[{
        RowBox[{"compvp1", "\[Equal]", "0"}], "/.", "dot2num"}], ",", 
       RowBox[{"{", 
        RowBox[{"ii", ",", 
         RowBox[{"10", "+", 
          RowBox[{"Length", "[", "cvars", "]"}]}]}], "}"}]}], "]"}]}], ";"}], 
   ",", "ii"}], "]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"solsvp1", "=", 
   RowBox[{
    RowBox[{"Solve", "[", 
     RowBox[{"eqDep", ",", "cvars"}], "]"}], "[", 
    RowBox[{"[", "1", "]"}], "]"}]}], ";"}]}], "Input",
 CellChangeTimes->{{3.878078221639757*^9, 3.878078240954069*^9}, {
  3.878081064658252*^9, 3.8780810690042477`*^9}},
 CellLabel->
  "In[1463]:=",ExpressionUUID->"b8fa77cc-1b35-4922-9129-b08f865e4e9e"],

Cell[BoxData[
 TemplateBox[{
  "Solve", "svars", 
   "\"Equations may not give solutions for all \\\"solve\\\" variables.\"", 2,
    1465, 77, 28410112452836994704, "Local"},
  "MessageTemplate"]], "Message", "MSG",
 CellChangeTimes->{3.878078269494465*^9, 3.878078742583606*^9, 
  3.878078899618535*^9, 3.878079253865985*^9, 3.878079430819562*^9, 
  3.878080637128373*^9, 3.8780808095370073`*^9, 3.878081098149448*^9, 
  3.878081136137045*^9, 3.8780819450782824`*^9, 3.8780820048796787`*^9, 
  3.878082047763628*^9, 3.878082109462324*^9, 3.878082376640708*^9, 
  3.878084831921735*^9, 3.878085522082589*^9, 3.878093683954672*^9, 
  3.878096061390531*^9},
 CellLabel->
  "During evaluation of \
In[1463]:=",ExpressionUUID->"8b8d129b-9eed-47e1-830e-fa9283394d46"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData["solsvp1"], "Input",
 CellLabel->
  "In[1466]:=",ExpressionUUID->"c8e08eb4-3b1b-41d6-9bea-cd47cdf8746d"],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
   RowBox[{
    RowBox[{"c", "[", "0", "]"}], "\[Rule]", 
    RowBox[{"-", "1"}]}], ",", 
   RowBox[{
    RowBox[{"c", "[", 
     RowBox[{"1", ",", "18"}], "]"}], "\[Rule]", "0"}], ",", 
   RowBox[{
    RowBox[{"c", "[", 
     RowBox[{"1", ",", "23"}], "]"}], "\[Rule]", 
    RowBox[{"c", "[", 
     RowBox[{"1", ",", "14"}], "]"}]}], ",", 
   RowBox[{
    RowBox[{"c", "[", 
     RowBox[{"1", ",", "27"}], "]"}], "\[Rule]", 
    RowBox[{
     RowBox[{"c", "[", 
      RowBox[{"1", ",", "13"}], "]"}], "-", 
     RowBox[{"c", "[", 
      RowBox[{"1", ",", "26"}], "]"}]}]}], ",", 
   RowBox[{
    RowBox[{"c", "[", 
     RowBox[{"1", ",", "30"}], "]"}], "\[Rule]", 
    RowBox[{
     RowBox[{"c", "[", 
      RowBox[{"1", ",", "11"}], "]"}], "+", 
     RowBox[{"c", "[", 
      RowBox[{"1", ",", "12"}], "]"}], "+", 
     RowBox[{"c", "[", 
      RowBox[{"1", ",", "16"}], "]"}], "-", 
     RowBox[{"c", "[", 
      RowBox[{"1", ",", "24"}], "]"}], "-", 
     RowBox[{"c", "[", 
      RowBox[{"1", ",", "25"}], "]"}], "-", 
     RowBox[{"c", "[", 
      RowBox[{"1", ",", "29"}], "]"}]}]}], ",", 
   RowBox[{
    RowBox[{"c", "[", 
     RowBox[{"1", ",", "64"}], "]"}], "\[Rule]", 
    RowBox[{
     RowBox[{"-", 
      FractionBox["1", "2"]}], "+", 
     FractionBox[
      RowBox[{"c", "[", "1", "]"}], "2"], "+", 
     RowBox[{"c", "[", 
      RowBox[{"1", ",", "7"}], "]"}]}]}], ",", 
   RowBox[{
    RowBox[{"c", "[", 
     RowBox[{"1", ",", "305"}], "]"}], "\[Rule]", 
    RowBox[{
     RowBox[{"-", 
      RowBox[{"c", "[", 
       RowBox[{"1", ",", "138"}], "]"}]}], "+", 
     RowBox[{"c", "[", 
      RowBox[{"1", ",", "219"}], "]"}], "+", 
     RowBox[{"c", "[", 
      RowBox[{"1", ",", "298"}], "]"}]}]}], ",", 
   RowBox[{
    RowBox[{"c", "[", 
     RowBox[{"1", ",", "313"}], "]"}], "\[Rule]", 
    RowBox[{
     RowBox[{"-", 
      RowBox[{"c", "[", 
       RowBox[{"1", ",", "50"}], "]"}]}], "+", 
     RowBox[{"c", "[", 
      RowBox[{"1", ",", "54"}], "]"}], "+", 
     RowBox[{"c", "[", 
      RowBox[{"1", ",", "70"}], "]"}], "-", 
     RowBox[{"c", "[", 
      RowBox[{"1", ",", "74"}], "]"}], "-", 
     RowBox[{"c", "[", 
      RowBox[{"1", ",", "108"}], "]"}], "-", 
     RowBox[{"c", "[", 
      RowBox[{"1", ",", "125"}], "]"}], "-", 
     RowBox[{"c", "[", 
      RowBox[{"1", ",", "126"}], "]"}], "-", 
     RowBox[{"c", "[", 
      RowBox[{"1", ",", "188"}], "]"}], "+", 
     RowBox[{"c", "[", 
      RowBox[{"1", ",", "212"}], "]"}], "+", 
     RowBox[{"c", "[", 
      RowBox[{"1", ",", "225"}], "]"}], "-", 
     RowBox[{"c", "[", 
      RowBox[{"1", ",", "227"}], "]"}], "+", 
     RowBox[{"c", "[", 
      RowBox[{"1", ",", "237"}], "]"}], "+", 
     RowBox[{"c", "[", 
      RowBox[{"1", ",", "252"}], "]"}], "-", 
     RowBox[{"c", "[", 
      RowBox[{"1", ",", "262"}], "]"}], "+", 
     RowBox[{"c", "[", 
      RowBox[{"1", ",", "299"}], "]"}], "+", 
     RowBox[{"c", "[", 
      RowBox[{"1", ",", "300"}], "]"}], "-", 
     RowBox[{"c", "[", 
      RowBox[{"1", ",", "312"}], "]"}]}]}], ",", 
   RowBox[{
    RowBox[{"c", "[", 
     RowBox[{"1", ",", "315"}], "]"}], "\[Rule]", 
    RowBox[{
     RowBox[{"-", 
      RowBox[{"c", "[", 
       RowBox[{"1", ",", "48"}], "]"}]}], "+", 
     RowBox[{"c", "[", 
      RowBox[{"1", ",", "60"}], "]"}], "-", 
     RowBox[{"c", "[", 
      RowBox[{"1", ",", "63"}], "]"}], "-", 
     RowBox[{"c", "[", 
      RowBox[{"1", ",", "65"}], "]"}], "+", 
     RowBox[{"c", "[", 
      RowBox[{"1", ",", "68"}], "]"}], "-", 
     RowBox[{"c", "[", 
      RowBox[{"1", ",", "80"}], "]"}], "+", 
     RowBox[{"c", "[", 
      RowBox[{"1", ",", "82"}], "]"}], "+", 
     RowBox[{"c", "[", 
      RowBox[{"1", ",", "84"}], "]"}], "+", 
     RowBox[{"c", "[", 
      RowBox[{"1", ",", "110"}], "]"}], "-", 
     RowBox[{"c", "[", 
      RowBox[{"1", ",", "127"}], "]"}], "-", 
     RowBox[{"c", "[", 
      RowBox[{"1", ",", "128"}], "]"}], "-", 
     RowBox[{"c", "[", 
      RowBox[{"1", ",", "185"}], "]"}], "+", 
     RowBox[{"c", "[", 
      RowBox[{"1", ",", "214"}], "]"}], "+", 
     RowBox[{"c", "[", 
      RowBox[{"1", ",", "223"}], "]"}], "-", 
     RowBox[{"c", "[", 
      RowBox[{"1", ",", "229"}], "]"}], "+", 
     RowBox[{"c", "[", 
      RowBox[{"1", ",", "233"}], "]"}], "+", 
     RowBox[{"c", "[", 
      RowBox[{"1", ",", "254"}], "]"}], "-", 
     RowBox[{"c", "[", 
      RowBox[{"1", ",", "258"}], "]"}], "+", 
     RowBox[{"c", "[", 
      RowBox[{"1", ",", "301"}], "]"}], "+", 
     RowBox[{"c", "[", 
      RowBox[{"1", ",", "302"}], "]"}], "-", 
     RowBox[{"c", "[", 
      RowBox[{"1", ",", "314"}], "]"}]}]}], ",", 
   RowBox[{
    RowBox[{"c", "[", 
     RowBox[{"1", ",", "317"}], "]"}], "\[Rule]", 
    RowBox[{"1", "-", 
     RowBox[{"c", "[", 
      RowBox[{"1", ",", "37"}], "]"}], "-", 
     RowBox[{"c", "[", 
      RowBox[{"1", ",", "43"}], "]"}], "-", 
     RowBox[{"c", "[", 
      RowBox[{"1", ",", "47"}], "]"}], "-", 
     RowBox[{"c", "[", 
      RowBox[{"1", ",", "49"}], "]"}], "+", 
     RowBox[{"c", "[", 
      RowBox[{"1", ",", "67"}], "]"}], "+", 
     RowBox[{"c", "[", 
      RowBox[{"1", ",", "69"}], "]"}], "+", 
     RowBox[{"c", "[", 
      RowBox[{"1", ",", "129"}], "]"}], "-", 
     RowBox[{"c", "[", 
      RowBox[{"1", ",", "136"}], "]"}], "+", 
     RowBox[{"c", "[", 
      RowBox[{"1", ",", "217"}], "]"}], "+", 
     RowBox[{"c", "[", 
      RowBox[{"1", ",", "218"}], "]"}], "+", 
     RowBox[{"c", "[", 
      RowBox[{"1", ",", "222"}], "]"}], "+", 
     RowBox[{"c", "[", 
      RowBox[{"1", ",", "224"}], "]"}], "+", 
     RowBox[{"c", "[", 
      RowBox[{"1", ",", "303"}], "]"}], "+", 
     RowBox[{"c", "[", 
      RowBox[{"1", ",", "304"}], "]"}], "-", 
     RowBox[{"c", "[", 
      RowBox[{"1", ",", "316"}], "]"}]}]}], ",", 
   RowBox[{
    RowBox[{"c", "[", 
     RowBox[{"2", ",", "11"}], "]"}], "\[Rule]", 
    RowBox[{"c", "[", 
     RowBox[{"1", ",", "11"}], "]"}]}], ",", 
   RowBox[{
    RowBox[{"c", "[", 
     RowBox[{"2", ",", "13"}], "]"}], "\[Rule]", 
    RowBox[{"c", "[", 
     RowBox[{"1", ",", "13"}], "]"}]}], ",", 
   RowBox[{
    RowBox[{"c", "[", 
     RowBox[{"2", ",", "16"}], "]"}], "\[Rule]", 
    RowBox[{
     RowBox[{"c", "[", 
      RowBox[{"1", ",", "12"}], "]"}], "+", 
     RowBox[{"c", "[", 
      RowBox[{"1", ",", "16"}], "]"}], "-", 
     RowBox[{"c", "[", 
      RowBox[{"2", ",", "12"}], "]"}]}]}], ",", 
   RowBox[{
    RowBox[{"c", "[", 
     RowBox[{"2", ",", "299"}], "]"}], "\[Rule]", 
    RowBox[{
     RowBox[{"-", 
      RowBox[{"c", "[", 
       RowBox[{"1", ",", "125"}], "]"}]}], "+", 
     RowBox[{"c", "[", 
      RowBox[{"1", ",", "299"}], "]"}], "+", 
     RowBox[{"c", "[", 
      RowBox[{"2", ",", "125"}], "]"}]}]}], ",", 
   RowBox[{
    RowBox[{"c", "[", 
     RowBox[{"2", ",", "300"}], "]"}], "\[Rule]", 
    RowBox[{
     RowBox[{"-", 
      RowBox[{"c", "[", 
       RowBox[{"1", ",", "50"}], "]"}]}], "+", 
     RowBox[{"c", "[", 
      RowBox[{"1", ",", "54"}], "]"}], "+", 
     RowBox[{"c", "[", 
      RowBox[{"1", ",", "70"}], "]"}], "-", 
     RowBox[{"c", "[", 
      RowBox[{"1", ",", "74"}], "]"}], "-", 
     RowBox[{"c", "[", 
      RowBox[{"1", ",", "126"}], "]"}], "+", 
     RowBox[{"c", "[", 
      RowBox[{"1", ",", "300"}], "]"}], "-", 
     RowBox[{"c", "[", 
      RowBox[{"2", ",", "108"}], "]"}], "+", 
     RowBox[{"c", "[", 
      RowBox[{"2", ",", "133"}], "]"}], "-", 
     RowBox[{"c", "[", 
      RowBox[{"2", ",", "142"}], "]"}], "+", 
     RowBox[{"c", "[", 
      RowBox[{"2", ",", "153"}], "]"}], "+", 
     RowBox[{"c", "[", 
      RowBox[{"2", ",", "191"}], "]"}], "-", 
     RowBox[{"c", "[", 
      RowBox[{"2", ",", "202"}], "]"}], "-", 
     RowBox[{"c", "[", 
      RowBox[{"2", ",", "244"}], "]"}]}]}], ",", 
   RowBox[{
    RowBox[{"c", "[", 
     RowBox[{"2", ",", "301"}], "]"}], "\[Rule]", 
    RowBox[{
     RowBox[{"-", 
      RowBox[{"c", "[", 
       RowBox[{"1", ",", "63"}], "]"}]}], "-", 
     RowBox[{"c", "[", 
      RowBox[{"1", ",", "65"}], "]"}], "-", 
     RowBox[{"c", "[", 
      RowBox[{"1", ",", "127"}], "]"}], "+", 
     RowBox[{"c", "[", 
      RowBox[{"1", ",", "301"}], "]"}], "+", 
     RowBox[{"c", "[", 
      RowBox[{"2", ",", "63"}], "]"}], "+", 
     RowBox[{"c", "[", 
      RowBox[{"2", ",", "65"}], "]"}], "+", 
     RowBox[{"c", "[", 
      RowBox[{"2", ",", "127"}], "]"}]}]}], ",", 
   RowBox[{
    RowBox[{"c", "[", 
     RowBox[{"2", ",", "302"}], "]"}], "\[Rule]", 
    RowBox[{
     RowBox[{"-", 
      RowBox[{"c", "[", 
       RowBox[{"1", ",", "48"}], "]"}]}], "+", 
     RowBox[{"c", "[", 
      RowBox[{"1", ",", "60"}], "]"}], "+", 
     RowBox[{"c", "[", 
      RowBox[{"1", ",", "68"}], "]"}], "-", 
     RowBox[{"c", "[", 
      RowBox[{"1", ",", "80"}], "]"}], "-", 
     RowBox[{"c", "[", 
      RowBox[{"1", ",", "128"}], "]"}], "+", 
     RowBox[{"c", "[", 
      RowBox[{"1", ",", "302"}], "]"}], "+", 
     RowBox[{"c", "[", 
      RowBox[{"2", ",", "109"}], "]"}], "+", 
     RowBox[{"c", "[", 
      RowBox[{"2", ",", "131"}], "]"}], "-", 
     RowBox[{"c", "[", 
      RowBox[{"2", ",", "144"}], "]"}], "+", 
     RowBox[{"c", "[", 
      RowBox[{"2", ",", "147"}], "]"}], "+", 
     RowBox[{"c", "[", 
      RowBox[{"2", ",", "193"}], "]"}], "-", 
     RowBox[{"c", "[", 
      RowBox[{"2", ",", "196"}], "]"}], "-", 
     RowBox[{"c", "[", 
      RowBox[{"2", ",", "249"}], "]"}]}]}], ",", 
   RowBox[{
    RowBox[{"c", "[", 
     RowBox[{"2", ",", "303"}], "]"}], "\[Rule]", 
    RowBox[{
     RowBox[{"-", 
      RowBox[{"c", "[", 
       RowBox[{"1", ",", "37"}], "]"}]}], "-", 
     RowBox[{"c", "[", 
      RowBox[{"1", ",", "47"}], "]"}], "+", 
     RowBox[{"c", "[", 
      RowBox[{"1", ",", "67"}], "]"}], "+", 
     RowBox[{"c", "[", 
      RowBox[{"1", ",", "129"}], "]"}], "+", 
     RowBox[{"c", "[", 
      RowBox[{"1", ",", "303"}], "]"}], "+", 
     RowBox[{"c", "[", 
      RowBox[{"2", ",", "130"}], "]"}]}]}], ",", 
   RowBox[{
    RowBox[{"c", "[", 
     RowBox[{"2", ",", "304"}], "]"}], "\[Rule]", 
    RowBox[{"1", "-", 
     RowBox[{"c", "[", 
      RowBox[{"1", ",", "43"}], "]"}], "-", 
     RowBox[{"c", "[", 
      RowBox[{"1", ",", "49"}], "]"}], "+", 
     RowBox[{"c", "[", 
      RowBox[{"1", ",", "69"}], "]"}], "-", 
     RowBox[{"c", "[", 
      RowBox[{"1", ",", "136"}], "]"}], "+", 
     RowBox[{"c", "[", 
      RowBox[{"1", ",", "304"}], "]"}], "+", 
     RowBox[{"c", "[", 
      RowBox[{"2", ",", "132"}], "]"}], "+", 
     RowBox[{"c", "[", 
      RowBox[{"2", ",", "136"}], "]"}], "+", 
     RowBox[{"c", "[", 
      RowBox[{"2", ",", "137"}], "]"}]}]}]}], "}"}]], "Output",
 CellChangeTimes->{3.878093691306862*^9, 3.878096061413385*^9},
 CellLabel->
  "Out[1466]=",ExpressionUUID->"97ce6a18-e105-47a5-990d-c0a183675f6f"]
}, Open  ]]
}, Open  ]],

Cell[CellGroupData[{

Cell["Factorisation condition v.p2", "Subsection",
 CellChangeTimes->{{3.878076748965989*^9, 3.878076767862722*^9}, {
  3.878093747799068*^9, 
  3.8780937495889473`*^9}},ExpressionUUID->"0dc6dbc1-eeb3-4f11-b2bc-\
668fae0eba77"],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{
  RowBox[{"numAnsatz3", "=", 
   RowBox[{
    RowBox[{
     RowBox[{
      RowBox[{
       RowBox[{"(", "numAnsatz2", ")"}], "//.", "dotRules"}], "/.", 
      RowBox[{"(", 
       RowBox[{
        RowBox[{"vonshell", "[", 
         RowBox[{
          RowBox[{"n", "-", "1"}], ",", "3"}], "]"}], "/.", 
        RowBox[{"v", "->", 
         RowBox[{"v", "[", "1", "]"}]}]}], ")"}]}], "/.", "solsvp1"}], "//", 
    "Expand"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{"%", "//", "Length"}]}], "Input",
 CellChangeTimes->{{3.878076776346158*^9, 3.878076791822427*^9}, {
   3.878076863747164*^9, 3.8780768651784353`*^9}, {3.878077446334421*^9, 
   3.878077450450157*^9}, 3.878080568874198*^9, 3.878080843522138*^9, {
   3.878084931218405*^9, 3.8780849369136047`*^9}, {3.878085107286035*^9, 
   3.878085112014679*^9}, {3.8780852927862673`*^9, 3.878085294285921*^9}, {
   3.8780937634764643`*^9, 3.8780937712084923`*^9}, {3.878094578752013*^9, 
   3.87809458003332*^9}},
 CellLabel->
  "In[1491]:=",ExpressionUUID->"30f56ef6-5b13-4baa-b8bf-15b7090ac3f7"],

Cell[BoxData["7321"], "Output",
 CellChangeTimes->{{3.87807677960294*^9, 3.878076792387086*^9}, 
   3.878076869394702*^9, 3.878077463656658*^9, 3.878080582971023*^9, 
   3.878081061748372*^9, 3.878084951014349*^9, 3.878085126532173*^9, 
   3.878085312641127*^9, 3.878093665706396*^9, 3.878094602309922*^9, 
   3.8780960624008083`*^9},
 CellLabel->
  "Out[1492]=",ExpressionUUID->"ef10fc4b-b910-45e4-aa69-172c1bd4f155"]
}, Open  ]],

Cell[BoxData[
 RowBox[{
  RowBox[{"numAnsatzvp1", "=", 
   RowBox[{
    RowBox[{
     RowBox[{
      RowBox[{"(", 
       RowBox[{
        RowBox[{
         RowBox[{"(", 
          RowBox[{"numAnsatz3", "//", 
           RowBox[{"Cases", "[", 
            RowBox[{"Times", "[", 
             RowBox[{"f___", ",", 
              RowBox[{"Power", "[", 
               RowBox[{
                RowBox[{"dot", "[", 
                 RowBox[{
                  RowBox[{"p", "[", "2", "]"}], ",", 
                  RowBox[{"v", "[", "1", "]"}]}], "]"}], ",", 
                RowBox[{"-", "1"}]}], "]"}], ",", "g___"}], "]"}], "]"}]}], 
          ")"}], "/.", 
         RowBox[{
          RowBox[{"Power", "[", 
           RowBox[{
            RowBox[{"dot", "[", 
             RowBox[{
              RowBox[{"p", "[", "2", "]"}], ",", 
              RowBox[{"v", "[", "1", "]"}]}], "]"}], ",", 
            RowBox[{"-", "1"}]}], "]"}], "->", "1"}]}], "//", "Total"}], 
       ")"}], "//.", "dotRules"}], "/.", "vponshell"}], "/.", 
    RowBox[{"{", 
     RowBox[{
      RowBox[{
       RowBox[{"dot", "[", 
        RowBox[{
         RowBox[{"p", "[", "2", "]"}], ",", 
         RowBox[{"v", "[", "1", "]"}]}], "]"}], "->", "0"}], ",", 
      RowBox[{
       RowBox[{"dot", "[", 
        RowBox[{
         RowBox[{"p", "[", "3", "]"}], ",", 
         RowBox[{"v", "[", "1", "]"}]}], "]"}], "->", 
       RowBox[{"-", 
        RowBox[{"dot", "[", 
         RowBox[{
          RowBox[{"p", "[", "1", "]"}], ",", 
          RowBox[{"v", "[", "1", "]"}]}], "]"}]}]}]}], "}"}]}]}], 
  ";"}]], "Input",
 CellChangeTimes->{{3.878077052129978*^9, 3.878077125591745*^9}, {
   3.878077237157652*^9, 3.878077281353335*^9}, {3.8780773702267103`*^9, 
   3.8780774435353603`*^9}, {3.8780774739935207`*^9, 3.8780775017717133`*^9}, 
   3.878079930873101*^9, 3.878079973240665*^9, {3.878085415182927*^9, 
   3.8780854153236303`*^9}, 3.878085446328352*^9, {3.878094648731681*^9, 
   3.878094651846068*^9}, {3.878094696417069*^9, 3.878094712612356*^9}},
 CellLabel->
  "In[1493]:=",ExpressionUUID->"7e4c037d-b2c8-4b94-a37c-c87c5346d37a"],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"numAnsatzvp1", "//", "Length"}]], "Input",
 CellChangeTimes->{{3.878085457345728*^9, 3.878085458484248*^9}},
 CellLabel->
  "In[1494]:=",ExpressionUUID->"59f786bb-5094-42ab-b9d0-362b1e405323"],

Cell[BoxData["1048"], "Output",
 CellChangeTimes->{{3.878085424115284*^9, 3.8780854589677*^9}, 
   3.878093671135722*^9, 3.878094722221806*^9, 3.878096062738055*^9},
 CellLabel->
  "Out[1494]=",ExpressionUUID->"16d96285-ed54-496a-bcae-ade69b7185a2"]
}, Open  ]],

Cell[BoxData[{
 RowBox[{
  RowBox[{"num1", "=", 
   RowBox[{
    RowBox[{
     RowBox[{"T", "[", 
      RowBox[{"{", "2", "}"}], "]"}], "/.", 
     RowBox[{"T", "->", "T2F"}]}], "/.", 
    RowBox[{"v", "->", 
     RowBox[{"v", "[", "1", "]"}]}]}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"num2", "=", 
   RowBox[{"(", 
    RowBox[{
     FractionBox[
      RowBox[{"dot", "[", 
       RowBox[{
        RowBox[{"p", "[", "1", "]"}], ",", 
        RowBox[{"S", "[", "0", "]"}], ",", 
        RowBox[{"F", "[", "1", "]"}], ",", 
        RowBox[{"F", "[", "3", "]"}], ",", 
        RowBox[{"v", "[", "1", "]"}]}], "]"}], 
      RowBox[{"dot", "[", 
       RowBox[{
        RowBox[{"p", "[", "1", "]"}], ",", 
        RowBox[{"v", "[", "1", "]"}]}], "]"}]], "+", 
     FractionBox[
      RowBox[{"dot", "[", 
       RowBox[{
        RowBox[{"p", "[", "1", "]"}], ",", 
        RowBox[{"S", "[", "0", "]"}], ",", 
        RowBox[{"F", "[", "3", "]"}], ",", 
        RowBox[{"F", "[", "1", "]"}], ",", 
        RowBox[{"v", "[", "1", "]"}]}], "]"}], 
      RowBox[{"dot", "[", 
       RowBox[{
        RowBox[{"p", "[", "1", "]"}], ",", 
        RowBox[{"v", "[", "1", "]"}]}], "]"}]], "-", 
     FractionBox[
      RowBox[{"dot", "[", 
       RowBox[{
        RowBox[{"p", "[", "1", "]"}], ",", 
        RowBox[{"F", "[", "3", "]"}], ",", 
        RowBox[{"S", "[", "0", "]"}], ",", 
        RowBox[{"F", "[", "1", "]"}], ",", 
        RowBox[{"v", "[", "1", "]"}]}], "]"}], 
      RowBox[{"dot", "[", 
       RowBox[{
        RowBox[{"p", "[", "1", "]"}], ",", 
        RowBox[{"v", "[", "1", "]"}]}], "]"}]], "+", 
     FractionBox[
      RowBox[{"dot", "[", 
       RowBox[{
        RowBox[{"p", "[", "3", "]"}], ",", 
        RowBox[{"S", "[", "0", "]"}], ",", 
        RowBox[{"F", "[", "3", "]"}], ",", 
        RowBox[{"F", "[", "1", "]"}], ",", 
        RowBox[{"v", "[", "1", "]"}]}], "]"}], 
      RowBox[{"dot", "[", 
       RowBox[{
        RowBox[{"p", "[", "1", "]"}], ",", 
        RowBox[{"v", "[", "1", "]"}]}], "]"}]]}], ")"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"numvp1", "=", 
   RowBox[{
    RowBox[{
     RowBox[{
      RowBox[{
       RowBox[{"dot", "[", 
        RowBox[{
         RowBox[{"p", "[", "1", "]"}], ",", 
         RowBox[{"p", "[", "2", "]"}]}], "]"}], 
       RowBox[{"(", 
        RowBox[{
         RowBox[{
          RowBox[{"c", "[", "2", "]"}], "num1", "*", "num2"}], "+", 
         RowBox[{
          FractionBox["1", 
           RowBox[{"dot", "[", 
            RowBox[{
             RowBox[{"p", "[", "1", "]"}], ",", 
             RowBox[{"v", "[", "1", "]"}]}], "]"}]], 
          RowBox[{"c", "[", "3", "]"}], 
          RowBox[{"dot", "[", 
           RowBox[{
            RowBox[{"p", "[", "2", "]"}], ",", 
            RowBox[{"S", "[", "0", "]"}], ",", 
            RowBox[{"\[Epsilon]", "[", "2", "]"}]}], "]"}], "*", 
          RowBox[{"dot", "[", 
           RowBox[{
            RowBox[{"v", "[", "1", "]"}], ",", 
            RowBox[{"F", "[", "1", "]"}], ",", 
            RowBox[{"F", "[", "3", "]"}], ",", 
            RowBox[{"v", "[", "1", "]"}]}], "]"}]}]}], ")"}]}], "//.", 
      "dotRules"}], "//", "expandFS"}], "//", "Expand"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"numvp1", "=", 
   RowBox[{
    RowBox[{
     RowBox[{"numvp1", "//.", "dotRules"}], "/.", "vponshell"}], "/.", 
    RowBox[{"{", 
     RowBox[{
      RowBox[{
       RowBox[{"dot", "[", 
        RowBox[{
         RowBox[{"p", "[", "2", "]"}], ",", 
         RowBox[{"v", "[", "1", "]"}]}], "]"}], "->", "0"}], ",", 
      RowBox[{
       RowBox[{"dot", "[", 
        RowBox[{
         RowBox[{"p", "[", "3", "]"}], ",", 
         RowBox[{"v", "[", "1", "]"}]}], "]"}], "->", 
       RowBox[{"-", 
        RowBox[{"dot", "[", 
         RowBox[{
          RowBox[{"p", "[", "1", "]"}], ",", 
          RowBox[{"v", "[", "1", "]"}]}], "]"}]}]}]}], "}"}]}]}], 
  ";"}]}], "Input",
 CellChangeTimes->{{3.878077591985273*^9, 3.8780776461342783`*^9}, {
   3.878077953502172*^9, 3.878077980733405*^9}, {3.878078491930747*^9, 
   3.878078549563458*^9}, {3.878078580745262*^9, 3.87807865251903*^9}, 
   3.878078684800146*^9, {3.878079206140265*^9, 3.878079212664543*^9}, {
   3.878079938416065*^9, 3.8780799390210323`*^9}, {3.878079982854789*^9, 
   3.878079996138009*^9}, 3.878080718496252*^9, 3.878080776110016*^9, {
   3.878081116226698*^9, 3.8780811179219093`*^9}, {3.878081897887516*^9, 
   3.878081929737031*^9}, {3.8780819770250673`*^9, 3.8780819885274878`*^9}, 
   3.8780820357161922`*^9, {3.878082093586617*^9, 3.878082094494379*^9}, 
   3.878082200584118*^9, 3.8780823524734297`*^9, 3.8780843780876017`*^9, {
   3.87808451838385*^9, 3.878084553403726*^9}, {3.878084767872551*^9, 
   3.878084809993238*^9}, {3.878093413770879*^9, 3.878093418381057*^9}, 
   3.878094731163116*^9, {3.878094787760552*^9, 3.878094870939351*^9}, {
   3.878094944453622*^9, 3.878094946794712*^9}},
 CellLabel->
  "In[1495]:=",ExpressionUUID->"015a8192-0e34-496c-b9e8-94d006b23504"],

Cell[BoxData[
 RowBox[{
  RowBox[{"compvp1", "=", 
   RowBox[{"numAnsatzvp1", "-", "numvp1"}]}], ";"}]], "Input",
 CellChangeTimes->{{3.8780781147500143`*^9, 3.878078179889933*^9}, {
   3.878078714167301*^9, 3.878078719908218*^9}, {3.878078864983605*^9, 
   3.8780788894932623`*^9}, 3.878079927920136*^9, 3.87808000213634*^9},
 CellLabel->
  "In[1499]:=",ExpressionUUID->"a6114a56-cddf-4bbf-96d0-7d324e0ac67b"],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  RowBox[{"4", " ", 
   RowBox[{
    SubscriptBox["p", "1"], "\[CenterDot]", "S", "\[CenterDot]", 
    SubscriptBox["F", "1"], "\[CenterDot]", 
    SubscriptBox["F", "2"], "\[CenterDot]", "v"}]}], "+", 
  RowBox[{"4", 
   RowBox[{
    SubscriptBox["p", "1"], "\[CenterDot]", "S", "\[CenterDot]", 
    SubscriptBox["F", "2"], "\[CenterDot]", 
    SubscriptBox["F", "1"], "\[CenterDot]", "v"}]}], "-", 
  RowBox[{"4", " ", 
   RowBox[{
    SubscriptBox["p", "1"], "\[CenterDot]", 
    SubscriptBox["F", "2"], "\[CenterDot]", "S", "\[CenterDot]", 
    SubscriptBox["F", "1"], "\[CenterDot]", "v"}]}], "+", 
  RowBox[{"4", " ", 
   RowBox[{
    SubscriptBox["p", "2"], "\[CenterDot]", "S", "\[CenterDot]", 
    SubscriptBox["F", "2"], "\[CenterDot]", 
    SubscriptBox["F", "1"], "\[CenterDot]", "v"}]}]}]], "Input",
 CellChangeTimes->{{3.878078468972107*^9, 3.8780784821254663`*^9}},
 CellLabel->
  "In[1500]:=",ExpressionUUID->"7563fbcc-606e-49f5-ba0e-0582f8aa8a63"],

Cell[BoxData[
 RowBox[{
  RowBox[{"4", " ", 
   RowBox[{
    SubscriptBox["p", "1"], "\[CenterDot]", "S", "\[CenterDot]", 
    SubscriptBox["F", "1"], "\[CenterDot]", 
    SubscriptBox["F", "2"], "\[CenterDot]", "v"}]}], "+", 
  RowBox[{"4", " ", 
   RowBox[{
    SubscriptBox["p", "1"], "\[CenterDot]", "S", "\[CenterDot]", 
    SubscriptBox["F", "2"], "\[CenterDot]", 
    SubscriptBox["F", "1"], "\[CenterDot]", "v"}]}], "-", 
  RowBox[{"4", " ", 
   RowBox[{
    SubscriptBox["p", "1"], "\[CenterDot]", 
    SubscriptBox["F", "2"], "\[CenterDot]", "S", "\[CenterDot]", 
    SubscriptBox["F", "1"], "\[CenterDot]", "v"}]}], "+", 
  RowBox[{"4", " ", 
   RowBox[{
    SubscriptBox["p", "2"], "\[CenterDot]", "S", "\[CenterDot]", 
    SubscriptBox["F", "2"], "\[CenterDot]", 
    SubscriptBox["F", "1"], "\[CenterDot]", "v"}]}]}]], "Output",
 CellChangeTimes->{3.8780960628033333`*^9},
 CellLabel->
  "Out[1500]=",ExpressionUUID->"7b370499-a70f-4080-915f-3674e800bb34"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"compvp1", "//", "Casesdot"}]], "Input",
 CellChangeTimes->{{3.8780788203554583`*^9, 3.878078825352446*^9}},
 CellLabel->
  "In[1501]:=",ExpressionUUID->"08cbae83-330d-4c78-afa6-d9025cba7d1c"],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
   RowBox[{"dot", "[", 
    RowBox[{
     RowBox[{"p", "[", "1", "]"}], ",", 
     RowBox[{"p", "[", "2", "]"}]}], "]"}], ",", 
   RowBox[{"dot", "[", 
    RowBox[{
     RowBox[{"p", "[", "1", "]"}], ",", 
     RowBox[{"p", "[", "3", "]"}]}], "]"}], ",", 
   RowBox[{"dot", "[", 
    RowBox[{
     RowBox[{"p", "[", "1", "]"}], ",", 
     RowBox[{"v", "[", "1", "]"}]}], "]"}], ",", 
   RowBox[{"dot", "[", 
    RowBox[{
     RowBox[{"p", "[", "1", "]"}], ",", 
     RowBox[{"\[Epsilon]", "[", "2", "]"}]}], "]"}], ",", 
   RowBox[{"dot", "[", 
    RowBox[{
     RowBox[{"p", "[", "1", "]"}], ",", 
     RowBox[{"\[Epsilon]", "[", "3", "]"}]}], "]"}], ",", 
   RowBox[{"dot", "[", 
    RowBox[{
     RowBox[{"p", "[", "2", "]"}], ",", 
     RowBox[{"p", "[", "3", "]"}]}], "]"}], ",", 
   RowBox[{"dot", "[", 
    RowBox[{
     RowBox[{"p", "[", "2", "]"}], ",", 
     RowBox[{"\[Epsilon]", "[", "1", "]"}]}], "]"}], ",", 
   RowBox[{"dot", "[", 
    RowBox[{
     RowBox[{"p", "[", "2", "]"}], ",", 
     RowBox[{"\[Epsilon]", "[", "3", "]"}]}], "]"}], ",", 
   RowBox[{"dot", "[", 
    RowBox[{
     RowBox[{"p", "[", "3", "]"}], ",", 
     RowBox[{"\[Epsilon]", "[", "1", "]"}]}], "]"}], ",", 
   RowBox[{"dot", "[", 
    RowBox[{
     RowBox[{"p", "[", "3", "]"}], ",", 
     RowBox[{"\[Epsilon]", "[", "2", "]"}]}], "]"}], ",", 
   RowBox[{"dot", "[", 
    RowBox[{
     RowBox[{"v", "[", "1", "]"}], ",", 
     RowBox[{"\[Epsilon]", "[", "1", "]"}]}], "]"}], ",", 
   RowBox[{"dot", "[", 
    RowBox[{
     RowBox[{"v", "[", "1", "]"}], ",", 
     RowBox[{"\[Epsilon]", "[", "2", "]"}]}], "]"}], ",", 
   RowBox[{"dot", "[", 
    RowBox[{
     RowBox[{"v", "[", "1", "]"}], ",", 
     RowBox[{"\[Epsilon]", "[", "3", "]"}]}], "]"}], ",", 
   RowBox[{"dot", "[", 
    RowBox[{
     RowBox[{"\[Epsilon]", "[", "1", "]"}], ",", 
     RowBox[{"\[Epsilon]", "[", "2", "]"}]}], "]"}], ",", 
   RowBox[{"dot", "[", 
    RowBox[{
     RowBox[{"\[Epsilon]", "[", "1", "]"}], ",", 
     RowBox[{"\[Epsilon]", "[", "3", "]"}]}], "]"}], ",", 
   RowBox[{"dot", "[", 
    RowBox[{
     RowBox[{"\[Epsilon]", "[", "2", "]"}], ",", 
     RowBox[{"\[Epsilon]", "[", "3", "]"}]}], "]"}], ",", 
   RowBox[{"dot", "[", 
    RowBox[{
     RowBox[{"p", "[", "1", "]"}], ",", 
     RowBox[{"S", "[", "0", "]"}], ",", 
     RowBox[{"p", "[", "2", "]"}]}], "]"}], ",", 
   RowBox[{"dot", "[", 
    RowBox[{
     RowBox[{"p", "[", "1", "]"}], ",", 
     RowBox[{"S", "[", "0", "]"}], ",", 
     RowBox[{"p", "[", "3", "]"}]}], "]"}], ",", 
   RowBox[{"dot", "[", 
    RowBox[{
     RowBox[{"p", "[", "1", "]"}], ",", 
     RowBox[{"S", "[", "0", "]"}], ",", 
     RowBox[{"\[Epsilon]", "[", "1", "]"}]}], "]"}], ",", 
   RowBox[{"dot", "[", 
    RowBox[{
     RowBox[{"p", "[", "1", "]"}], ",", 
     RowBox[{"S", "[", "0", "]"}], ",", 
     RowBox[{"\[Epsilon]", "[", "2", "]"}]}], "]"}], ",", 
   RowBox[{"dot", "[", 
    RowBox[{
     RowBox[{"p", "[", "1", "]"}], ",", 
     RowBox[{"S", "[", "0", "]"}], ",", 
     RowBox[{"\[Epsilon]", "[", "3", "]"}]}], "]"}], ",", 
   RowBox[{"dot", "[", 
    RowBox[{
     RowBox[{"p", "[", "2", "]"}], ",", 
     RowBox[{"S", "[", "0", "]"}], ",", 
     RowBox[{"p", "[", "3", "]"}]}], "]"}], ",", 
   RowBox[{"dot", "[", 
    RowBox[{
     RowBox[{"p", "[", "2", "]"}], ",", 
     RowBox[{"S", "[", "0", "]"}], ",", 
     RowBox[{"\[Epsilon]", "[", "1", "]"}]}], "]"}], ",", 
   RowBox[{"dot", "[", 
    RowBox[{
     RowBox[{"p", "[", "2", "]"}], ",", 
     RowBox[{"S", "[", "0", "]"}], ",", 
     RowBox[{"\[Epsilon]", "[", "2", "]"}]}], "]"}], ",", 
   RowBox[{"dot", "[", 
    RowBox[{
     RowBox[{"p", "[", "2", "]"}], ",", 
     RowBox[{"S", "[", "0", "]"}], ",", 
     RowBox[{"\[Epsilon]", "[", "3", "]"}]}], "]"}], ",", 
   RowBox[{"dot", "[", 
    RowBox[{
     RowBox[{"p", "[", "3", "]"}], ",", 
     RowBox[{"S", "[", "0", "]"}], ",", 
     RowBox[{"\[Epsilon]", "[", "1", "]"}]}], "]"}], ",", 
   RowBox[{"dot", "[", 
    RowBox[{
     RowBox[{"p", "[", "3", "]"}], ",", 
     RowBox[{"S", "[", "0", "]"}], ",", 
     RowBox[{"\[Epsilon]", "[", "2", "]"}]}], "]"}], ",", 
   RowBox[{"dot", "[", 
    RowBox[{
     RowBox[{"p", "[", "3", "]"}], ",", 
     RowBox[{"S", "[", "0", "]"}], ",", 
     RowBox[{"\[Epsilon]", "[", "3", "]"}]}], "]"}], ",", 
   RowBox[{"dot", "[", 
    RowBox[{
     RowBox[{"\[Epsilon]", "[", "1", "]"}], ",", 
     RowBox[{"S", "[", "0", "]"}], ",", 
     RowBox[{"\[Epsilon]", "[", "2", "]"}]}], "]"}], ",", 
   RowBox[{"dot", "[", 
    RowBox[{
     RowBox[{"\[Epsilon]", "[", "1", "]"}], ",", 
     RowBox[{"S", "[", "0", "]"}], ",", 
     RowBox[{"\[Epsilon]", "[", "3", "]"}]}], "]"}], ",", 
   RowBox[{"dot", "[", 
    RowBox[{
     RowBox[{"\[Epsilon]", "[", "2", "]"}], ",", 
     RowBox[{"S", "[", "0", "]"}], ",", 
     RowBox[{"\[Epsilon]", "[", "3", "]"}]}], "]"}]}], "}"}]], "Output",
 CellChangeTimes->{3.8780787909855328`*^9, 3.878078825754147*^9, 
  3.8780789139500523`*^9, 3.878079583885482*^9, 3.8780807366766977`*^9, 
  3.87808078442798*^9, 3.878095061451518*^9, 3.87809606280996*^9},
 CellLabel->
  "Out[1501]=",ExpressionUUID->"07e1a2b6-3037-4ca0-8400-48e99ad86635"]
}, Open  ]],

Cell[BoxData[{
 RowBox[{
  RowBox[{"cvars", "=", 
   RowBox[{
    RowBox[{"Cases", "[", 
     RowBox[{"compvp1", ",", 
      RowBox[{"c", "[", "__", "]"}], ",", 
      RowBox[{"{", 
       RowBox[{"0", ",", "\[Infinity]"}], "}"}]}], "]"}], "//", "Union"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"vardot", "=", 
   RowBox[{"compvp1", "//", "Casesdot"}]}], ";"}]}], "Input",
 CellChangeTimes->{{3.878078218083035*^9, 3.878078227195683*^9}},
 CellLabel->
  "In[1502]:=",ExpressionUUID->"3660df7e-5e63-4b2d-a97d-18687b7e7e55"],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"cvars", "//", "Length"}]], "Input",
 CellChangeTimes->{{3.878078250405406*^9, 3.8780782515980988`*^9}, 
   3.8780793030421352`*^9, {3.878080618122617*^9, 3.878080619511405*^9}},
 CellLabel->
  "In[1504]:=",ExpressionUUID->"fa8ba1fd-a186-49cc-9bf9-aa75c0ff688a"],

Cell[BoxData["61"], "Output",
 CellChangeTimes->{
  3.878078252063862*^9, 3.878078732430634*^9, {3.8780792683050127`*^9, 
   3.878079303531766*^9}, {3.8780806116761723`*^9, 3.878080620497012*^9}, 
   3.878080793272333*^9, 3.8780810935750732`*^9, 3.8780811318686132`*^9, 
   3.878081941084124*^9, 3.8780820011325197`*^9, 3.878082120982493*^9, 
   3.878084828486793*^9, 3.878085517830093*^9, 3.878093680935251*^9, 
   3.878095084936636*^9, 3.878096062833789*^9},
 CellLabel->
  "Out[1504]=",ExpressionUUID->"25c49caa-8a9e-4265-9d5d-81c8dde158ea"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{
  RowBox[{"dot2num", ":=", 
   RowBox[{"Table", "[", 
    RowBox[{
     RowBox[{"Rule", "[", 
      RowBox[{
       RowBox[{"vardot", "[", 
        RowBox[{"[", "ii", "]"}], "]"}], ",", 
       RowBox[{"RandomInteger", "[", 
        RowBox[{"{", 
         RowBox[{"10", ",", "100"}], "}"}], "]"}]}], "]"}], ",", 
     RowBox[{"{", 
      RowBox[{"ii", ",", 
       RowBox[{"Length", "[", "vardot", "]"}]}], "}"}]}], "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{"Monitor", "[", 
  RowBox[{
   RowBox[{
    RowBox[{"eqDep", "=", 
     RowBox[{"Table", "[", 
      RowBox[{
       RowBox[{
        RowBox[{"compvp1", "\[Equal]", "0"}], "/.", "dot2num"}], ",", 
       RowBox[{"{", 
        RowBox[{"ii", ",", 
         RowBox[{"10", "+", 
          RowBox[{"Length", "[", "cvars", "]"}]}]}], "}"}]}], "]"}]}], ";"}], 
   ",", "ii"}], "]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"solsvp2", "=", 
   RowBox[{
    RowBox[{"Solve", "[", 
     RowBox[{"eqDep", ",", "cvars"}], "]"}], "[", 
    RowBox[{"[", "1", "]"}], "]"}]}], ";"}]}], "Input",
 CellChangeTimes->{{3.878078221639757*^9, 3.878078240954069*^9}, {
  3.878081064658252*^9, 3.8780810690042477`*^9}, {3.878095748981908*^9, 
  3.878095749098365*^9}},
 CellLabel->
  "In[1505]:=",ExpressionUUID->"05540f17-9558-47af-a39a-04f87039a3ef"],

Cell[BoxData[
 TemplateBox[{
  "Solve", "svars", 
   "\"Equations may not give solutions for all \\\"solve\\\" variables.\"", 2,
    1507, 78, 28410112452836994704, "Local"},
  "MessageTemplate"]], "Message", "MSG",
 CellChangeTimes->{3.878078269494465*^9, 3.878078742583606*^9, 
  3.878078899618535*^9, 3.878079253865985*^9, 3.878079430819562*^9, 
  3.878080637128373*^9, 3.8780808095370073`*^9, 3.878081098149448*^9, 
  3.878081136137045*^9, 3.8780819450782824`*^9, 3.8780820048796787`*^9, 
  3.878082047763628*^9, 3.878082109462324*^9, 3.878082376640708*^9, 
  3.878084831921735*^9, 3.878085522082589*^9, 3.878093683954672*^9, 
  3.8780951097061853`*^9, 3.8780960633261843`*^9},
 CellLabel->
  "During evaluation of \
In[1505]:=",ExpressionUUID->"baf5d4a3-61a8-4221-bd13-5e44a930ef75"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData["solsvp2"], "Input",
 CellLabel->
  "In[1593]:=",ExpressionUUID->"d5ee2776-4386-4864-a97b-c3438dc9d059"],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
   RowBox[{
    RowBox[{"c", "[", "1", "]"}], "\[Rule]", 
    RowBox[{"-", "1"}]}], ",", 
   RowBox[{
    RowBox[{"c", "[", "2", "]"}], "\[Rule]", "1"}], ",", 
   RowBox[{
    RowBox[{"c", "[", "3", "]"}], "\[Rule]", "1"}], ",", 
   RowBox[{
    RowBox[{"c", "[", 
     RowBox[{"1", ",", "11"}], "]"}], "\[Rule]", "0"}], ",", 
   RowBox[{
    RowBox[{"c", "[", 
     RowBox[{"1", ",", "13"}], "]"}], "\[Rule]", "0"}], ",", 
   RowBox[{
    RowBox[{"c", "[", 
     RowBox[{"1", ",", "14"}], "]"}], "\[Rule]", "0"}], ",", 
   RowBox[{
    RowBox[{"c", "[", 
     RowBox[{"1", ",", "16"}], "]"}], "\[Rule]", 
    RowBox[{"-", 
     RowBox[{"c", "[", 
      RowBox[{"1", ",", "12"}], "]"}]}]}], ",", 
   RowBox[{
    RowBox[{"c", "[", 
     RowBox[{"1", ",", "29"}], "]"}], "\[Rule]", 
    RowBox[{
     RowBox[{"-", 
      RowBox[{"c", "[", 
       RowBox[{"1", ",", "24"}], "]"}]}], "-", 
     RowBox[{"c", "[", 
      RowBox[{"1", ",", "25"}], "]"}]}]}], ",", 
   RowBox[{
    RowBox[{"c", "[", 
     RowBox[{"1", ",", "298"}], "]"}], "\[Rule]", 
    RowBox[{"1", "+", 
     RowBox[{"c", "[", 
      RowBox[{"1", ",", "138"}], "]"}]}]}], ",", 
   RowBox[{
    RowBox[{"c", "[", 
     RowBox[{"1", ",", "299"}], "]"}], "\[Rule]", 
    RowBox[{"c", "[", 
     RowBox[{"1", ",", "125"}], "]"}]}], ",", 
   RowBox[{
    RowBox[{"c", "[", 
     RowBox[{"1", ",", "300"}], "]"}], "\[Rule]", 
    RowBox[{
     RowBox[{"c", "[", 
      RowBox[{"1", ",", "50"}], "]"}], "-", 
     RowBox[{"c", "[", 
      RowBox[{"1", ",", "54"}], "]"}], "-", 
     RowBox[{"c", "[", 
      RowBox[{"1", ",", "70"}], "]"}], "+", 
     RowBox[{"c", "[", 
      RowBox[{"1", ",", "74"}], "]"}], "+", 
     RowBox[{"c", "[", 
      RowBox[{"1", ",", "126"}], "]"}]}]}], ",", 
   RowBox[{
    RowBox[{"c", "[", 
     RowBox[{"1", ",", "301"}], "]"}], "\[Rule]", 
    RowBox[{
     RowBox[{"c", "[", 
      RowBox[{"1", ",", "63"}], "]"}], "+", 
     RowBox[{"c", "[", 
      RowBox[{"1", ",", "65"}], "]"}], "+", 
     RowBox[{"c", "[", 
      RowBox[{"1", ",", "127"}], "]"}]}]}], ",", 
   RowBox[{
    RowBox[{"c", "[", 
     RowBox[{"1", ",", "302"}], "]"}], "\[Rule]", 
    RowBox[{
     RowBox[{"c", "[", 
      RowBox[{"1", ",", "48"}], "]"}], "-", 
     RowBox[{"c", "[", 
      RowBox[{"1", ",", "60"}], "]"}], "-", 
     RowBox[{"c", "[", 
      RowBox[{"1", ",", "68"}], "]"}], "+", 
     RowBox[{"c", "[", 
      RowBox[{"1", ",", "80"}], "]"}], "+", 
     RowBox[{"c", "[", 
      RowBox[{"1", ",", "128"}], "]"}]}]}], ",", 
   RowBox[{
    RowBox[{"c", "[", 
     RowBox[{"1", ",", "303"}], "]"}], "\[Rule]", 
    RowBox[{
     RowBox[{"c", "[", 
      RowBox[{"1", ",", "37"}], "]"}], "+", 
     RowBox[{"c", "[", 
      RowBox[{"1", ",", "47"}], "]"}], "-", 
     RowBox[{"c", "[", 
      RowBox[{"1", ",", "67"}], "]"}], "-", 
     RowBox[{"c", "[", 
      RowBox[{"1", ",", "129"}], "]"}]}]}], ",", 
   RowBox[{
    RowBox[{"c", "[", 
     RowBox[{"1", ",", "304"}], "]"}], "\[Rule]", 
    RowBox[{
     RowBox[{"-", "1"}], "+", 
     RowBox[{"c", "[", 
      RowBox[{"1", ",", "43"}], "]"}], "+", 
     RowBox[{"c", "[", 
      RowBox[{"1", ",", "49"}], "]"}], "-", 
     RowBox[{"c", "[", 
      RowBox[{"1", ",", "69"}], "]"}], "+", 
     RowBox[{"c", "[", 
      RowBox[{"1", ",", "136"}], "]"}]}]}], ",", 
   RowBox[{
    RowBox[{"c", "[", 
     RowBox[{"1", ",", "312"}], "]"}], "\[Rule]", 
    RowBox[{
     RowBox[{"-", 
      RowBox[{"c", "[", 
       RowBox[{"1", ",", "108"}], "]"}]}], "-", 
     RowBox[{"c", "[", 
      RowBox[{"1", ",", "188"}], "]"}], "+", 
     RowBox[{"c", "[", 
      RowBox[{"1", ",", "225"}], "]"}], "-", 
     RowBox[{"c", "[", 
      RowBox[{"1", ",", "227"}], "]"}], "+", 
     RowBox[{"c", "[", 
      RowBox[{"1", ",", "237"}], "]"}], "+", 
     RowBox[{"c", "[", 
      RowBox[{"1", ",", "252"}], "]"}], "-", 
     RowBox[{"c", "[", 
      RowBox[{"1", ",", "262"}], "]"}]}]}], ",", 
   RowBox[{
    RowBox[{"c", "[", 
     RowBox[{"1", ",", "314"}], "]"}], "\[Rule]", 
    RowBox[{
     RowBox[{"c", "[", 
      RowBox[{"1", ",", "110"}], "]"}], "-", 
     RowBox[{"c", "[", 
      RowBox[{"1", ",", "185"}], "]"}], "+", 
     RowBox[{"c", "[", 
      RowBox[{"1", ",", "223"}], "]"}], "-", 
     RowBox[{"c", "[", 
      RowBox[{"1", ",", "229"}], "]"}], "+", 
     RowBox[{"c", "[", 
      RowBox[{"1", ",", "233"}], "]"}], "+", 
     RowBox[{"c", "[", 
      RowBox[{"1", ",", "254"}], "]"}], "-", 
     RowBox[{"c", "[", 
      RowBox[{"1", ",", "258"}], "]"}]}]}], ",", 
   RowBox[{
    RowBox[{"c", "[", 
     RowBox[{"1", ",", "316"}], "]"}], "\[Rule]", 
    RowBox[{
     RowBox[{"c", "[", 
      RowBox[{"1", ",", "217"}], "]"}], "+", 
     RowBox[{"c", "[", 
      RowBox[{"1", ",", "218"}], "]"}], "+", 
     RowBox[{"c", "[", 
      RowBox[{"1", ",", "224"}], "]"}]}]}]}], "}"}]], "Output",
 CellChangeTimes->{3.878105405899537*^9},
 CellLabel->
  "Out[1593]=",ExpressionUUID->"accb4a05-0f2a-4623-b5e6-282c542e3e1d"]
}, Open  ]]
}, Open  ]],

Cell[CellGroupData[{

Cell["Factorisation condition v.p3", "Subsection",
 CellChangeTimes->{{3.878076748965989*^9, 3.878076767862722*^9}, {
  3.878093747799068*^9, 3.8780937495889473`*^9}, {3.878095192789927*^9, 
  3.8780951929813747`*^9}},ExpressionUUID->"13628a4d-25c7-44e5-9dd8-\
790fd349801b"],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{
  RowBox[{"numAnsatz4", "=", 
   RowBox[{
    RowBox[{
     RowBox[{
      RowBox[{
       RowBox[{"(", "numAnsatz3", ")"}], "//.", "dotRules"}], "/.", 
      RowBox[{"(", 
       RowBox[{
        RowBox[{"vonshell", "[", 
         RowBox[{
          RowBox[{"n", "-", "1"}], ",", "2"}], "]"}], "/.", 
        RowBox[{"v", "->", 
         RowBox[{"v", "[", "1", "]"}]}]}], ")"}]}], "/.", "solsvp2"}], "//", 
    "Expand"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{"%", "//", "Length"}]}], "Input",
 CellChangeTimes->{{3.878076776346158*^9, 3.878076791822427*^9}, {
   3.878076863747164*^9, 3.8780768651784353`*^9}, {3.878077446334421*^9, 
   3.878077450450157*^9}, 3.878080568874198*^9, 3.878080843522138*^9, {
   3.878084931218405*^9, 3.8780849369136047`*^9}, {3.878085107286035*^9, 
   3.878085112014679*^9}, {3.8780852927862673`*^9, 3.878085294285921*^9}, {
   3.8780937634764643`*^9, 3.8780937712084923`*^9}, {3.878094578752013*^9, 
   3.87809458003332*^9}, {3.8780951988903418`*^9, 3.8780952057126427`*^9}, {
   3.8780957389282017`*^9, 3.878095739594145*^9}},
 CellLabel->
  "In[1508]:=",ExpressionUUID->"03460e8f-7d6e-4d1f-a8f9-dbc21d11e43f"],

Cell[BoxData["85"], "Output",
 CellChangeTimes->{{3.87807677960294*^9, 3.878076792387086*^9}, 
   3.878076869394702*^9, 3.878077463656658*^9, 3.878080582971023*^9, 
   3.878081061748372*^9, 3.878084951014349*^9, 3.878085126532173*^9, 
   3.878085312641127*^9, 3.878093665706396*^9, 3.878094602309922*^9, 
   3.878095215999476*^9, 3.878096067273143*^9},
 CellLabel->
  "Out[1509]=",ExpressionUUID->"81a189d5-7804-48f2-a773-178259a5e586"]
}, Open  ]],

Cell[BoxData[
 RowBox[{
  RowBox[{"numAnsatzvp1", "=", 
   RowBox[{
    RowBox[{
     RowBox[{
      RowBox[{"(", 
       RowBox[{
        RowBox[{
         RowBox[{"(", 
          RowBox[{"numAnsatz4", "//", 
           RowBox[{"Cases", "[", 
            RowBox[{"Times", "[", 
             RowBox[{"f___", ",", 
              RowBox[{"Power", "[", 
               RowBox[{
                RowBox[{"dot", "[", 
                 RowBox[{
                  RowBox[{"p", "[", "3", "]"}], ",", 
                  RowBox[{"v", "[", "1", "]"}]}], "]"}], ",", 
                RowBox[{"-", "1"}]}], "]"}], ",", "g___"}], "]"}], "]"}]}], 
          ")"}], "/.", 
         RowBox[{
          RowBox[{"Power", "[", 
           RowBox[{
            RowBox[{"dot", "[", 
             RowBox[{
              RowBox[{"p", "[", "3", "]"}], ",", 
              RowBox[{"v", "[", "1", "]"}]}], "]"}], ",", 
            RowBox[{"-", "1"}]}], "]"}], "->", "1"}]}], "//", "Total"}], 
       ")"}], "//.", "dotRules"}], "/.", "vponshell"}], "/.", 
    RowBox[{"{", 
     RowBox[{
      RowBox[{
       RowBox[{"dot", "[", 
        RowBox[{
         RowBox[{"p", "[", "3", "]"}], ",", 
         RowBox[{"v", "[", "1", "]"}]}], "]"}], "->", "0"}], ",", 
      RowBox[{
       RowBox[{"dot", "[", 
        RowBox[{
         RowBox[{"p", "[", "2", "]"}], ",", 
         RowBox[{"v", "[", "1", "]"}]}], "]"}], "->", 
       RowBox[{"-", 
        RowBox[{"dot", "[", 
         RowBox[{
          RowBox[{"p", "[", "1", "]"}], ",", 
          RowBox[{"v", "[", "1", "]"}]}], "]"}]}]}]}], "}"}]}]}], 
  ";"}]], "Input",
 CellChangeTimes->{{3.878077052129978*^9, 3.878077125591745*^9}, {
   3.878077237157652*^9, 3.878077281353335*^9}, {3.8780773702267103`*^9, 
   3.8780774435353603`*^9}, {3.8780774739935207`*^9, 3.8780775017717133`*^9}, 
   3.878079930873101*^9, 3.878079973240665*^9, {3.878085415182927*^9, 
   3.8780854153236303`*^9}, 3.878085446328352*^9, {3.878094648731681*^9, 
   3.878094651846068*^9}, {3.878094696417069*^9, 3.878094712612356*^9}, 
   3.8780952799470053`*^9, {3.878095329611971*^9, 3.878095354825946*^9}},
 CellLabel->
  "In[1511]:=",ExpressionUUID->"fde1bdc7-1d3b-4353-b9ad-7ae5dd60398a"],

Cell[BoxData[{
 RowBox[{
  RowBox[{"num1", "=", 
   RowBox[{
    RowBox[{
     RowBox[{"T", "[", 
      RowBox[{"{", "3", "}"}], "]"}], "/.", 
     RowBox[{"T", "->", "T2F"}]}], "/.", 
    RowBox[{"v", "->", 
     RowBox[{"v", "[", "1", "]"}]}]}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"num2", "=", 
   RowBox[{"(", 
    RowBox[{
     FractionBox[
      RowBox[{"dot", "[", 
       RowBox[{
        RowBox[{"p", "[", "1", "]"}], ",", 
        RowBox[{"S", "[", "0", "]"}], ",", 
        RowBox[{"F", "[", "1", "]"}], ",", 
        RowBox[{"F", "[", "2", "]"}], ",", 
        RowBox[{"v", "[", "1", "]"}]}], "]"}], 
      RowBox[{"dot", "[", 
       RowBox[{
        RowBox[{"p", "[", "1", "]"}], ",", 
        RowBox[{"v", "[", "1", "]"}]}], "]"}]], "+", 
     FractionBox[
      RowBox[{"dot", "[", 
       RowBox[{
        RowBox[{"p", "[", "1", "]"}], ",", 
        RowBox[{"S", "[", "0", "]"}], ",", 
        RowBox[{"F", "[", "2", "]"}], ",", 
        RowBox[{"F", "[", "1", "]"}], ",", 
        RowBox[{"v", "[", "1", "]"}]}], "]"}], 
      RowBox[{"dot", "[", 
       RowBox[{
        RowBox[{"p", "[", "1", "]"}], ",", 
        RowBox[{"v", "[", "1", "]"}]}], "]"}]], "-", 
     FractionBox[
      RowBox[{"dot", "[", 
       RowBox[{
        RowBox[{"p", "[", "1", "]"}], ",", 
        RowBox[{"F", "[", "2", "]"}], ",", 
        RowBox[{"S", "[", "0", "]"}], ",", 
        RowBox[{"F", "[", "1", "]"}], ",", 
        RowBox[{"v", "[", "1", "]"}]}], "]"}], 
      RowBox[{"dot", "[", 
       RowBox[{
        RowBox[{"p", "[", "1", "]"}], ",", 
        RowBox[{"v", "[", "1", "]"}]}], "]"}]], "+", 
     FractionBox[
      RowBox[{"dot", "[", 
       RowBox[{
        RowBox[{"p", "[", "2", "]"}], ",", 
        RowBox[{"S", "[", "0", "]"}], ",", 
        RowBox[{"F", "[", "2", "]"}], ",", 
        RowBox[{"F", "[", "1", "]"}], ",", 
        RowBox[{"v", "[", "1", "]"}]}], "]"}], 
      RowBox[{"dot", "[", 
       RowBox[{
        RowBox[{"p", "[", "1", "]"}], ",", 
        RowBox[{"v", "[", "1", "]"}]}], "]"}]]}], ")"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"numvp1", "=", 
   RowBox[{
    RowBox[{
     RowBox[{
      RowBox[{
       RowBox[{"dot", "[", 
        RowBox[{
         RowBox[{
          RowBox[{"p", "[", "1", "]"}], "+", 
          RowBox[{"p", "[", "2", "]"}]}], ",", 
         RowBox[{"p", "[", "3", "]"}]}], "]"}], 
       RowBox[{"(", 
        RowBox[{
         RowBox[{
          RowBox[{"c", "[", "3", "]"}], "num1", "*", "num2"}], "+", 
         RowBox[{
          FractionBox["1", 
           RowBox[{"dot", "[", 
            RowBox[{
             RowBox[{"p", "[", "1", "]"}], ",", 
             RowBox[{"v", "[", "1", "]"}]}], "]"}]], 
          RowBox[{"c", "[", "4", "]"}], 
          RowBox[{"dot", "[", 
           RowBox[{
            RowBox[{"p", "[", "3", "]"}], ",", 
            RowBox[{"S", "[", "0", "]"}], ",", 
            RowBox[{"\[Epsilon]", "[", "3", "]"}]}], "]"}], "*", 
          RowBox[{"dot", "[", 
           RowBox[{
            RowBox[{"v", "[", "1", "]"}], ",", 
            RowBox[{"F", "[", "1", "]"}], ",", 
            RowBox[{"F", "[", "2", "]"}], ",", 
            RowBox[{"v", "[", "1", "]"}]}], "]"}]}]}], ")"}]}], "//.", 
      "dotRules"}], "//", "expandFS"}], "//", "Expand"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"numvp1", "=", 
   RowBox[{
    RowBox[{
     RowBox[{"numvp1", "//.", "dotRules"}], "/.", "vponshell"}], "/.", 
    RowBox[{"{", 
     RowBox[{
      RowBox[{
       RowBox[{"dot", "[", 
        RowBox[{
         RowBox[{"p", "[", "3", "]"}], ",", 
         RowBox[{"v", "[", "1", "]"}]}], "]"}], "->", "0"}], ",", 
      RowBox[{
       RowBox[{"dot", "[", 
        RowBox[{
         RowBox[{"p", "[", "2", "]"}], ",", 
         RowBox[{"v", "[", "1", "]"}]}], "]"}], "->", 
       RowBox[{"-", 
        RowBox[{"dot", "[", 
         RowBox[{
          RowBox[{"p", "[", "1", "]"}], ",", 
          RowBox[{"v", "[", "1", "]"}]}], "]"}]}]}]}], "}"}]}]}], 
  ";"}]}], "Input",
 CellChangeTimes->{{3.878077591985273*^9, 3.8780776461342783`*^9}, {
   3.878077953502172*^9, 3.878077980733405*^9}, {3.878078491930747*^9, 
   3.878078549563458*^9}, {3.878078580745262*^9, 3.87807865251903*^9}, 
   3.878078684800146*^9, {3.878079206140265*^9, 3.878079212664543*^9}, {
   3.878079938416065*^9, 3.8780799390210323`*^9}, {3.878079982854789*^9, 
   3.878079996138009*^9}, 3.878080718496252*^9, 3.878080776110016*^9, {
   3.878081116226698*^9, 3.8780811179219093`*^9}, {3.878081897887516*^9, 
   3.878081929737031*^9}, {3.8780819770250673`*^9, 3.8780819885274878`*^9}, 
   3.8780820357161922`*^9, {3.878082093586617*^9, 3.878082094494379*^9}, 
   3.878082200584118*^9, 3.8780823524734297`*^9, 3.8780843780876017`*^9, {
   3.87808451838385*^9, 3.878084553403726*^9}, {3.878084767872551*^9, 
   3.878084809993238*^9}, {3.878093413770879*^9, 3.878093418381057*^9}, 
   3.878094731163116*^9, {3.878094787760552*^9, 3.878094870939351*^9}, {
   3.878094944453622*^9, 3.878094946794712*^9}, {3.878095374742682*^9, 
   3.878095391986203*^9}, {3.8780954563856373`*^9, 3.878095483306056*^9}, {
   3.878095605265438*^9, 3.878095616154799*^9}, {3.878095684075735*^9, 
   3.878095688268168*^9}},
 CellLabel->
  "In[1513]:=",ExpressionUUID->"7e25f5e8-947e-4019-bee6-69b028ad1707"],

Cell[BoxData[
 RowBox[{
  RowBox[{"compvp1", "=", 
   RowBox[{"numAnsatzvp1", "-", "numvp1"}]}], ";"}]], "Input",
 CellChangeTimes->{{3.8780781147500143`*^9, 3.878078179889933*^9}, {
   3.878078714167301*^9, 3.878078719908218*^9}, {3.878078864983605*^9, 
   3.8780788894932623`*^9}, 3.878079927920136*^9, 3.87808000213634*^9},
 CellLabel->
  "In[1517]:=",ExpressionUUID->"852c1b9c-61ce-4cbd-b3ae-6cd8d1457d71"],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"compvp1", "/.", 
  RowBox[{"{", 
   RowBox[{
    RowBox[{
     RowBox[{"c", "[", "3", "]"}], "->", "1"}], ",", 
    RowBox[{
     RowBox[{"c", "[", "4", "]"}], "->", "1"}]}], "}"}]}]], "Input",
 CellChangeTimes->{{3.878095527643024*^9, 3.878095578279685*^9}, {
  3.878095625110869*^9, 3.878095641471002*^9}},
 CellLabel->
  "In[1518]:=",ExpressionUUID->"47ef6b8b-d114-4491-bb3e-09a9342ebb8f"],

Cell[BoxData["0"], "Output",
 CellChangeTimes->{{3.878095519546192*^9, 3.878095530830967*^9}, {
   3.8780955685470467`*^9, 3.878095578769575*^9}, {3.8780956254979887`*^9, 
   3.87809564203146*^9}, 3.878095695176092*^9, 3.8780960673961983`*^9},
 CellLabel->
  "Out[1518]=",ExpressionUUID->"23709299-613b-4db1-aff3-46f53a334542"]
}, Open  ]],

Cell[BoxData[{
 RowBox[{
  RowBox[{"cvars", "=", 
   RowBox[{
    RowBox[{"Cases", "[", 
     RowBox[{"compvp1", ",", 
      RowBox[{"c", "[", "__", "]"}], ",", 
      RowBox[{"{", 
       RowBox[{"0", ",", "\[Infinity]"}], "}"}]}], "]"}], "//", "Union"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"vardot", "=", 
   RowBox[{"compvp1", "//", "Casesdot"}]}], ";"}]}], "Input",
 CellChangeTimes->{{3.878078218083035*^9, 3.878078227195683*^9}},
 CellLabel->
  "In[1519]:=",ExpressionUUID->"269e8e9f-94be-45a7-95c8-e950994ff4c7"],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"cvars", "//", "Length"}]], "Input",
 CellChangeTimes->{{3.878078250405406*^9, 3.8780782515980988`*^9}, 
   3.8780793030421352`*^9, {3.878080618122617*^9, 3.878080619511405*^9}},
 CellLabel->
  "In[1521]:=",ExpressionUUID->"1eff3f89-c5c1-4c61-9f1f-4ce2abd924ea"],

Cell[BoxData["2"], "Output",
 CellChangeTimes->{
  3.878078252063862*^9, 3.878078732430634*^9, {3.8780792683050127`*^9, 
   3.878079303531766*^9}, {3.8780806116761723`*^9, 3.878080620497012*^9}, 
   3.878080793272333*^9, 3.8780810935750732`*^9, 3.8780811318686132`*^9, 
   3.878081941084124*^9, 3.8780820011325197`*^9, 3.878082120982493*^9, 
   3.878084828486793*^9, 3.878085517830093*^9, 3.878093680935251*^9, 
   3.878095084936636*^9, 3.878095713545517*^9, 3.878096067412579*^9},
 CellLabel->
  "Out[1521]=",ExpressionUUID->"0d450e5b-5041-4237-9d60-5120eac3cc9b"]
}, Open  ]],

Cell[BoxData[{
 RowBox[{
  RowBox[{"dot2num", ":=", 
   RowBox[{"Table", "[", 
    RowBox[{
     RowBox[{"Rule", "[", 
      RowBox[{
       RowBox[{"vardot", "[", 
        RowBox[{"[", "ii", "]"}], "]"}], ",", 
       RowBox[{"RandomInteger", "[", 
        RowBox[{"{", 
         RowBox[{"10", ",", "100"}], "}"}], "]"}]}], "]"}], ",", 
     RowBox[{"{", 
      RowBox[{"ii", ",", 
       RowBox[{"Length", "[", "vardot", "]"}]}], "}"}]}], "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{"Monitor", "[", 
  RowBox[{
   RowBox[{
    RowBox[{"eqDep", "=", 
     RowBox[{"Table", "[", 
      RowBox[{
       RowBox[{
        RowBox[{"compvp1", "\[Equal]", "0"}], "/.", "dot2num"}], ",", 
       RowBox[{"{", 
        RowBox[{"ii", ",", 
         RowBox[{"10", "+", 
          RowBox[{"Length", "[", "cvars", "]"}]}]}], "}"}]}], "]"}]}], ";"}], 
   ",", "ii"}], "]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"solsvp3", "=", 
   RowBox[{
    RowBox[{"Solve", "[", 
     RowBox[{"eqDep", ",", "cvars"}], "]"}], "[", 
    RowBox[{"[", "1", "]"}], "]"}]}], ";"}]}], "Input",
 CellChangeTimes->{{3.878078221639757*^9, 3.878078240954069*^9}, {
  3.878081064658252*^9, 3.8780810690042477`*^9}, {3.878095733492796*^9, 
  3.878095733629385*^9}},
 CellLabel->
  "In[1522]:=",ExpressionUUID->"ff21824b-8ef3-4cd6-9556-da46ed6b1cca"],

Cell[CellGroupData[{

Cell[BoxData["solsvp3"], "Input",
 CellChangeTimes->{{3.878096861054673*^9, 3.8780968614695673`*^9}},
 CellLabel->
  "In[1527]:=",ExpressionUUID->"43a0151e-8ebd-4243-a5e4-1ed70ee22f2f"],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
   RowBox[{
    RowBox[{"c", "[", "3", "]"}], "\[Rule]", "1"}], ",", 
   RowBox[{
    RowBox[{"c", "[", "4", "]"}], "\[Rule]", "1"}]}], "}"}]], "Output",
 CellChangeTimes->{3.878093691306862*^9, 3.878095112706624*^9, 
  3.878095717543086*^9, 3.878096067453002*^9, 3.878096861847978*^9},
 CellLabel->
  "Out[1527]=",ExpressionUUID->"5d034607-d61e-4893-b8f8-caaf0b40a516"]
}, Open  ]]
}, Open  ]],

Cell[CellGroupData[{

Cell["Final Result", "Subsection",
 CellChangeTimes->{{3.878095815607132*^9, 
  3.878095824409616*^9}},ExpressionUUID->"53d2eeec-1112-4cce-b7d4-\
5104623dfb30"],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{
     RowBox[{"numAnsatz", "/.", "sols"}], "/.", "solsvp1"}], "/.", 
    "solsvp2"}], "/.", 
   RowBox[{
    RowBox[{"c", "[", "__", "]"}], ":>", "0"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{"%", "//.", "nice"}]}], "Input",
 CellChangeTimes->{{3.8780958303263483`*^9, 3.878095831726018*^9}, {
  3.878096867922544*^9, 3.878096935558015*^9}, {3.878097392092999*^9, 
  3.878097396030863*^9}},
 CellLabel->
  "In[1567]:=",ExpressionUUID->"41b68abb-e62d-4676-bed1-4a7b029d8a85"],

Cell[BoxData[
 RowBox[{
  FractionBox[
   RowBox[{
    RowBox[{
     SubscriptBox["p", "1"], "\[CenterDot]", 
     SubscriptBox["S", "0"], "\[CenterDot]", 
     SubscriptBox["F", "2"], "\[CenterDot]", 
     SubscriptBox["v", "1"]}], " ", 
    RowBox[{
     SubscriptBox["p", "2"], "\[CenterDot]", 
     SubscriptBox["F", "1"], "\[CenterDot]", 
     SubscriptBox["F", "3"], "\[CenterDot]", 
     SubscriptBox["v", "1"]}]}], 
   RowBox[{
    RowBox[{
     SubscriptBox["p", "1"], "\[CenterDot]", 
     SubscriptBox["v", "1"]}], " ", 
    RowBox[{"(", 
     RowBox[{
      RowBox[{
       SubscriptBox["p", "1"], "\[CenterDot]", 
       SubscriptBox["v", "1"]}], "+", 
      RowBox[{
       SubscriptBox["p", "2"], "\[CenterDot]", 
       SubscriptBox["v", "1"]}]}], ")"}]}]], "+", 
  FractionBox[
   RowBox[{
    RowBox[{
     SubscriptBox["p", "1"], "\[CenterDot]", 
     SubscriptBox["F", "3"], "\[CenterDot]", 
     SubscriptBox["S", "0"], "\[CenterDot]", 
     SubscriptBox["p", "3"]}], " ", 
    RowBox[{
     SubscriptBox["v", "1"], "\[CenterDot]", 
     SubscriptBox["F", "1"], "\[CenterDot]", 
     SubscriptBox["F", "2"], "\[CenterDot]", 
     SubscriptBox["v", "1"]}]}], 
   RowBox[{
    RowBox[{
     SubscriptBox["p", "1"], "\[CenterDot]", 
     SubscriptBox["v", "1"]}], " ", 
    RowBox[{"(", 
     RowBox[{
      RowBox[{
       SubscriptBox["p", "1"], "\[CenterDot]", 
       SubscriptBox["v", "1"]}], "+", 
      RowBox[{
       SubscriptBox["p", "2"], "\[CenterDot]", 
       SubscriptBox["v", "1"]}]}], ")"}]}]], "+", 
  FractionBox[
   RowBox[{
    RowBox[{
     SubscriptBox["p", "1"], "\[CenterDot]", 
     SubscriptBox["F", "3"], "\[CenterDot]", 
     SubscriptBox["S", "0"], "\[CenterDot]", 
     SubscriptBox["p", "3"]}], " ", 
    RowBox[{
     SubscriptBox["v", "1"], "\[CenterDot]", 
     SubscriptBox["F", "1"], "\[CenterDot]", 
     SubscriptBox["F", "2"], "\[CenterDot]", 
     SubscriptBox["v", "1"]}]}], 
   RowBox[{
    RowBox[{
     SubscriptBox["p", "1"], "\[CenterDot]", 
     SubscriptBox["v", "1"]}], " ", 
    RowBox[{"(", 
     RowBox[{
      RowBox[{
       SubscriptBox["p", "1"], "\[CenterDot]", 
       SubscriptBox["v", "1"]}], "+", 
      RowBox[{
       SubscriptBox["p", "3"], "\[CenterDot]", 
       SubscriptBox["v", "1"]}]}], ")"}]}]], "+", 
  FractionBox[
   RowBox[{
    RowBox[{
     SubscriptBox["p", "2"], "\[CenterDot]", 
     SubscriptBox["F", "3"], "\[CenterDot]", 
     SubscriptBox["S", "0"], "\[CenterDot]", 
     SubscriptBox["p", "3"]}], " ", 
    RowBox[{
     SubscriptBox["v", "1"], "\[CenterDot]", 
     SubscriptBox["F", "1"], "\[CenterDot]", 
     SubscriptBox["F", "2"], "\[CenterDot]", 
     SubscriptBox["v", "1"]}]}], 
   RowBox[{
    RowBox[{
     SubscriptBox["p", "1"], "\[CenterDot]", 
     SubscriptBox["v", "1"]}], " ", 
    RowBox[{"(", 
     RowBox[{
      RowBox[{
       SubscriptBox["p", "1"], "\[CenterDot]", 
       SubscriptBox["v", "1"]}], "+", 
      RowBox[{
       SubscriptBox["p", "2"], "\[CenterDot]", 
       SubscriptBox["v", "1"]}]}], ")"}]}]], "+", 
  FractionBox[
   RowBox[{
    RowBox[{
     SubscriptBox["p", "1"], "\[CenterDot]", 
     SubscriptBox["F", "2"], "\[CenterDot]", 
     SubscriptBox["S", "0"], "\[CenterDot]", 
     SubscriptBox["p", "2"]}], " ", 
    RowBox[{
     SubscriptBox["v", "1"], "\[CenterDot]", 
     SubscriptBox["F", "1"], "\[CenterDot]", 
     SubscriptBox["F", "3"], "\[CenterDot]", 
     SubscriptBox["v", "1"]}]}], 
   RowBox[{
    RowBox[{
     SubscriptBox["p", "1"], "\[CenterDot]", 
     SubscriptBox["v", "1"]}], " ", 
    RowBox[{"(", 
     RowBox[{
      RowBox[{
       SubscriptBox["p", "1"], "\[CenterDot]", 
       SubscriptBox["v", "1"]}], "+", 
      RowBox[{
       SubscriptBox["p", "2"], "\[CenterDot]", 
       SubscriptBox["v", "1"]}]}], ")"}]}]], "+", 
  FractionBox[
   RowBox[{
    RowBox[{
     SubscriptBox["p", "1"], "\[CenterDot]", 
     SubscriptBox["F", "2"], "\[CenterDot]", 
     SubscriptBox["S", "0"], "\[CenterDot]", 
     SubscriptBox["p", "2"]}], " ", 
    RowBox[{
     SubscriptBox["v", "1"], "\[CenterDot]", 
     SubscriptBox["F", "1"], "\[CenterDot]", 
     SubscriptBox["F", "3"], "\[CenterDot]", 
     SubscriptBox["v", "1"]}]}], 
   RowBox[{
    RowBox[{
     SubscriptBox["p", "1"], "\[CenterDot]", 
     SubscriptBox["v", "1"]}], " ", 
    RowBox[{"(", 
     RowBox[{
      RowBox[{
       SubscriptBox["p", "1"], "\[CenterDot]", 
       SubscriptBox["v", "1"]}], "+", 
      RowBox[{
       SubscriptBox["p", "3"], "\[CenterDot]", 
       SubscriptBox["v", "1"]}]}], ")"}]}]], "-", 
  FractionBox[
   RowBox[{
    RowBox[{
     SubscriptBox["p", "1"], "\[CenterDot]", 
     SubscriptBox["F", "3"], "\[CenterDot]", 
     SubscriptBox["v", "1"]}], " ", 
    RowBox[{
     SubscriptBox["p", "1"], "\[CenterDot]", 
     SubscriptBox["S", "0"], "\[CenterDot]", 
     SubscriptBox["F", "1"], "\[CenterDot]", 
     SubscriptBox["F", "2"], "\[CenterDot]", 
     SubscriptBox["v", "1"]}]}], 
   RowBox[{
    RowBox[{
     SubscriptBox["p", "1"], "\[CenterDot]", 
     SubscriptBox["v", "1"]}], " ", 
    RowBox[{"(", 
     RowBox[{
      RowBox[{
       SubscriptBox["p", "1"], "\[CenterDot]", 
       SubscriptBox["v", "1"]}], "+", 
      RowBox[{
       SubscriptBox["p", "2"], "\[CenterDot]", 
       SubscriptBox["v", "1"]}]}], ")"}]}]], "-", 
  FractionBox[
   RowBox[{
    RowBox[{
     SubscriptBox["p", "1"], "\[CenterDot]", 
     SubscriptBox["F", "3"], "\[CenterDot]", 
     SubscriptBox["v", "1"]}], " ", 
    RowBox[{
     SubscriptBox["p", "1"], "\[CenterDot]", 
     SubscriptBox["S", "0"], "\[CenterDot]", 
     SubscriptBox["F", "1"], "\[CenterDot]", 
     SubscriptBox["F", "2"], "\[CenterDot]", 
     SubscriptBox["v", "1"]}]}], 
   RowBox[{
    RowBox[{
     SubscriptBox["p", "1"], "\[CenterDot]", 
     SubscriptBox["v", "1"]}], " ", 
    RowBox[{"(", 
     RowBox[{
      RowBox[{
       SubscriptBox["p", "1"], "\[CenterDot]", 
       SubscriptBox["v", "1"]}], "+", 
      RowBox[{
       SubscriptBox["p", "3"], "\[CenterDot]", 
       SubscriptBox["v", "1"]}]}], ")"}]}]], "-", 
  FractionBox[
   RowBox[{
    RowBox[{
     SubscriptBox["p", "2"], "\[CenterDot]", 
     SubscriptBox["F", "3"], "\[CenterDot]", 
     SubscriptBox["v", "1"]}], " ", 
    RowBox[{
     SubscriptBox["p", "1"], "\[CenterDot]", 
     SubscriptBox["S", "0"], "\[CenterDot]", 
     SubscriptBox["F", "1"], "\[CenterDot]", 
     SubscriptBox["F", "2"], "\[CenterDot]", 
     SubscriptBox["v", "1"]}]}], 
   RowBox[{
    RowBox[{
     SubscriptBox["p", "1"], "\[CenterDot]", 
     SubscriptBox["v", "1"]}], " ", 
    RowBox[{"(", 
     RowBox[{
      RowBox[{
       SubscriptBox["p", "1"], "\[CenterDot]", 
       SubscriptBox["v", "1"]}], "+", 
      RowBox[{
       SubscriptBox["p", "2"], "\[CenterDot]", 
       SubscriptBox["v", "1"]}]}], ")"}]}]], "-", 
  FractionBox[
   RowBox[{
    RowBox[{
     SubscriptBox["p", "1"], "\[CenterDot]", 
     SubscriptBox["F", "3"], "\[CenterDot]", 
     SubscriptBox["v", "1"]}], " ", 
    RowBox[{
     SubscriptBox["p", "2"], "\[CenterDot]", 
     SubscriptBox["S", "0"], "\[CenterDot]", 
     SubscriptBox["F", "1"], "\[CenterDot]", 
     SubscriptBox["F", "2"], "\[CenterDot]", 
     SubscriptBox["v", "1"]}]}], 
   RowBox[{
    RowBox[{
     SubscriptBox["p", "1"], "\[CenterDot]", 
     SubscriptBox["v", "1"]}], " ", 
    RowBox[{"(", 
     RowBox[{
      RowBox[{
       SubscriptBox["p", "1"], "\[CenterDot]", 
       SubscriptBox["v", "1"]}], "+", 
      RowBox[{
       SubscriptBox["p", "2"], "\[CenterDot]", 
       SubscriptBox["v", "1"]}]}], ")"}]}]], "-", 
  FractionBox[
   RowBox[{
    RowBox[{
     SubscriptBox["p", "2"], "\[CenterDot]", 
     SubscriptBox["F", "3"], "\[CenterDot]", 
     SubscriptBox["v", "1"]}], " ", 
    RowBox[{
     SubscriptBox["p", "2"], "\[CenterDot]", 
     SubscriptBox["S", "0"], "\[CenterDot]", 
     SubscriptBox["F", "2"], "\[CenterDot]", 
     SubscriptBox["F", "1"], "\[CenterDot]", 
     SubscriptBox["v", "1"]}]}], 
   RowBox[{
    RowBox[{
     SubscriptBox["p", "1"], "\[CenterDot]", 
     SubscriptBox["v", "1"]}], " ", 
    RowBox[{"(", 
     RowBox[{
      RowBox[{
       SubscriptBox["p", "1"], "\[CenterDot]", 
       SubscriptBox["v", "1"]}], "+", 
      RowBox[{
       SubscriptBox["p", "2"], "\[CenterDot]", 
       SubscriptBox["v", "1"]}]}], ")"}]}]], "+", 
  FractionBox[
   RowBox[{
    RowBox[{
     SubscriptBox["p", "1"], "\[CenterDot]", 
     SubscriptBox["F", "2"], "\[CenterDot]", 
     SubscriptBox["v", "1"]}], " ", 
    RowBox[{
     SubscriptBox["p", "3"], "\[CenterDot]", 
     SubscriptBox["F", "1"], "\[CenterDot]", 
     SubscriptBox["S", "0"], "\[CenterDot]", 
     SubscriptBox["F", "3"], "\[CenterDot]", 
     SubscriptBox["v", "1"]}]}], 
   RowBox[{
    RowBox[{
     SubscriptBox["p", "1"], "\[CenterDot]", 
     SubscriptBox["v", "1"]}], " ", 
    RowBox[{"(", 
     RowBox[{
      RowBox[{
       SubscriptBox["p", "1"], "\[CenterDot]", 
       SubscriptBox["v", "1"]}], "+", 
      RowBox[{
       SubscriptBox["p", "3"], "\[CenterDot]", 
       SubscriptBox["v", "1"]}]}], ")"}]}]], "-", 
  FractionBox[
   RowBox[{
    RowBox[{
     SubscriptBox["p", "1"], "\[CenterDot]", 
     SubscriptBox["F", "3"], "\[CenterDot]", 
     SubscriptBox["v", "1"]}], " ", 
    RowBox[{
     SubscriptBox["p", "3"], "\[CenterDot]", 
     SubscriptBox["S", "0"], "\[CenterDot]", 
     SubscriptBox["F", "1"], "\[CenterDot]", 
     SubscriptBox["F", "2"], "\[CenterDot]", 
     SubscriptBox["v", "1"]}]}], 
   RowBox[{
    RowBox[{
     SubscriptBox["p", "1"], "\[CenterDot]", 
     SubscriptBox["v", "1"]}], " ", 
    RowBox[{"(", 
     RowBox[{
      RowBox[{
       SubscriptBox["p", "1"], "\[CenterDot]", 
       SubscriptBox["v", "1"]}], "+", 
      RowBox[{
       SubscriptBox["p", "3"], "\[CenterDot]", 
       SubscriptBox["v", "1"]}]}], ")"}]}]], "-", 
  FractionBox[
   RowBox[{
    RowBox[{
     SubscriptBox["p", "1"], "\[CenterDot]", 
     SubscriptBox["S", "0"], "\[CenterDot]", 
     SubscriptBox["p", "3"]}], " ", 
    RowBox[{
     SubscriptBox["v", "1"], "\[CenterDot]", 
     SubscriptBox["F", "2"], "\[CenterDot]", 
     SubscriptBox["F", "1"], "\[CenterDot]", 
     SubscriptBox["F", "3"], "\[CenterDot]", 
     SubscriptBox["v", "1"]}]}], 
   RowBox[{
    RowBox[{
     SubscriptBox["p", "1"], "\[CenterDot]", 
     SubscriptBox["v", "1"]}], " ", 
    RowBox[{"(", 
     RowBox[{
      RowBox[{
       SubscriptBox["p", "1"], "\[CenterDot]", 
       SubscriptBox["v", "1"]}], "+", 
      RowBox[{
       SubscriptBox["p", "3"], "\[CenterDot]", 
       SubscriptBox["v", "1"]}]}], ")"}]}]], "+", 
  FractionBox[
   RowBox[{
    SubscriptBox["p", "1"], "\[CenterDot]", 
    SubscriptBox["F", "2"], "\[CenterDot]", 
    SubscriptBox["S", "0"], "\[CenterDot]", 
    SubscriptBox["F", "1"], "\[CenterDot]", 
    SubscriptBox["F", "3"], "\[CenterDot]", 
    SubscriptBox["v", "1"]}], 
   RowBox[{
    SubscriptBox["p", "1"], "\[CenterDot]", 
    SubscriptBox["v", "1"]}]], "+", 
  FractionBox[
   RowBox[{
    SubscriptBox["p", "1"], "\[CenterDot]", 
    SubscriptBox["F", "3"], "\[CenterDot]", 
    SubscriptBox["S", "0"], "\[CenterDot]", 
    SubscriptBox["F", "1"], "\[CenterDot]", 
    SubscriptBox["F", "2"], "\[CenterDot]", 
    SubscriptBox["v", "1"]}], 
   RowBox[{
    SubscriptBox["p", "1"], "\[CenterDot]", 
    SubscriptBox["v", "1"]}]], "+", 
  FractionBox[
   RowBox[{
    SubscriptBox["p", "1"], "\[CenterDot]", 
    SubscriptBox["S", "0"], "\[CenterDot]", 
    SubscriptBox["F", "1"], "\[CenterDot]", 
    SubscriptBox["F", "2"], "\[CenterDot]", 
    SubscriptBox["F", "3"], "\[CenterDot]", 
    SubscriptBox["v", "1"]}], 
   RowBox[{
    SubscriptBox["p", "1"], "\[CenterDot]", 
    SubscriptBox["v", "1"]}]], "-", 
  FractionBox[
   RowBox[{
    SubscriptBox["p", "1"], "\[CenterDot]", 
    SubscriptBox["S", "0"], "\[CenterDot]", 
    SubscriptBox["F", "2"], "\[CenterDot]", 
    SubscriptBox["F", "1"], "\[CenterDot]", 
    SubscriptBox["F", "3"], "\[CenterDot]", 
    SubscriptBox["v", "1"]}], 
   RowBox[{
    SubscriptBox["p", "1"], "\[CenterDot]", 
    SubscriptBox["v", "1"]}]], "-", 
  FractionBox[
   RowBox[{
    SubscriptBox["p", "1"], "\[CenterDot]", 
    SubscriptBox["S", "0"], "\[CenterDot]", 
    SubscriptBox["F", "3"], "\[CenterDot]", 
    SubscriptBox["F", "1"], "\[CenterDot]", 
    SubscriptBox["F", "2"], "\[CenterDot]", 
    SubscriptBox["v", "1"]}], 
   RowBox[{
    SubscriptBox["p", "1"], "\[CenterDot]", 
    SubscriptBox["v", "1"]}]], "-", 
  FractionBox[
   RowBox[{
    SubscriptBox["p", "2"], "\[CenterDot]", 
    SubscriptBox["F", "1"], "\[CenterDot]", 
    SubscriptBox["F", "3"], "\[CenterDot]", 
    SubscriptBox["S", "0"], "\[CenterDot]", 
    SubscriptBox["F", "2"], "\[CenterDot]", 
    SubscriptBox["v", "1"]}], 
   RowBox[{
    SubscriptBox["p", "1"], "\[CenterDot]", 
    SubscriptBox["v", "1"]}]], "-", 
  FractionBox[
   RowBox[{
    SubscriptBox["p", "2"], "\[CenterDot]", 
    SubscriptBox["F", "1"], "\[CenterDot]", 
    SubscriptBox["S", "0"], "\[CenterDot]", 
    SubscriptBox["F", "2"], "\[CenterDot]", 
    SubscriptBox["F", "3"], "\[CenterDot]", 
    SubscriptBox["v", "1"]}], 
   RowBox[{
    SubscriptBox["p", "1"], "\[CenterDot]", 
    SubscriptBox["v", "1"]}]], "+", 
  FractionBox[
   RowBox[{
    RowBox[{
     SubscriptBox["p", "2"], "\[CenterDot]", 
     SubscriptBox["v", "1"]}], " ", 
    RowBox[{
     SubscriptBox["p", "2"], "\[CenterDot]", 
     SubscriptBox["F", "1"], "\[CenterDot]", 
     SubscriptBox["S", "0"], "\[CenterDot]", 
     SubscriptBox["F", "2"], "\[CenterDot]", 
     SubscriptBox["F", "3"], "\[CenterDot]", 
     SubscriptBox["v", "1"]}]}], 
   RowBox[{
    RowBox[{
     SubscriptBox["p", "1"], "\[CenterDot]", 
     SubscriptBox["v", "1"]}], " ", 
    RowBox[{"(", 
     RowBox[{
      RowBox[{
       SubscriptBox["p", "1"], "\[CenterDot]", 
       SubscriptBox["v", "1"]}], "+", 
      RowBox[{
       SubscriptBox["p", "2"], "\[CenterDot]", 
       SubscriptBox["v", "1"]}]}], ")"}]}]], "+", 
  FractionBox[
   RowBox[{
    SubscriptBox["p", "2"], "\[CenterDot]", 
    SubscriptBox["F", "1"], "\[CenterDot]", 
    SubscriptBox["S", "0"], "\[CenterDot]", 
    SubscriptBox["F", "3"], "\[CenterDot]", 
    SubscriptBox["F", "2"], "\[CenterDot]", 
    SubscriptBox["v", "1"]}], 
   RowBox[{
    SubscriptBox["p", "1"], "\[CenterDot]", 
    SubscriptBox["v", "1"]}]], "+", 
  FractionBox[
   RowBox[{
    SubscriptBox["p", "2"], "\[CenterDot]", 
    SubscriptBox["F", "3"], "\[CenterDot]", 
    SubscriptBox["S", "0"], "\[CenterDot]", 
    SubscriptBox["F", "1"], "\[CenterDot]", 
    SubscriptBox["F", "2"], "\[CenterDot]", 
    SubscriptBox["v", "1"]}], 
   RowBox[{
    SubscriptBox["p", "1"], "\[CenterDot]", 
    SubscriptBox["v", "1"]}]], "+", 
  FractionBox[
   RowBox[{
    SubscriptBox["p", "2"], "\[CenterDot]", 
    SubscriptBox["F", "3"], "\[CenterDot]", 
    SubscriptBox["S", "0"], "\[CenterDot]", 
    SubscriptBox["F", "2"], "\[CenterDot]", 
    SubscriptBox["F", "1"], "\[CenterDot]", 
    SubscriptBox["v", "1"]}], 
   RowBox[{
    SubscriptBox["p", "1"], "\[CenterDot]", 
    SubscriptBox["v", "1"]}]], "+", 
  FractionBox[
   RowBox[{
    SubscriptBox["p", "2"], "\[CenterDot]", 
    SubscriptBox["S", "0"], "\[CenterDot]", 
    SubscriptBox["F", "1"], "\[CenterDot]", 
    SubscriptBox["F", "2"], "\[CenterDot]", 
    SubscriptBox["F", "3"], "\[CenterDot]", 
    SubscriptBox["v", "1"]}], 
   RowBox[{
    SubscriptBox["p", "1"], "\[CenterDot]", 
    SubscriptBox["v", "1"]}]], "-", 
  FractionBox[
   RowBox[{
    RowBox[{
     SubscriptBox["p", "2"], "\[CenterDot]", 
     SubscriptBox["v", "1"]}], " ", 
    RowBox[{
     SubscriptBox["p", "2"], "\[CenterDot]", 
     SubscriptBox["S", "0"], "\[CenterDot]", 
     SubscriptBox["F", "1"], "\[CenterDot]", 
     SubscriptBox["F", "2"], "\[CenterDot]", 
     SubscriptBox["F", "3"], "\[CenterDot]", 
     SubscriptBox["v", "1"]}]}], 
   RowBox[{
    RowBox[{
     SubscriptBox["p", "1"], "\[CenterDot]", 
     SubscriptBox["v", "1"]}], " ", 
    RowBox[{"(", 
     RowBox[{
      RowBox[{
       SubscriptBox["p", "1"], "\[CenterDot]", 
       SubscriptBox["v", "1"]}], "+", 
      RowBox[{
       SubscriptBox["p", "2"], "\[CenterDot]", 
       SubscriptBox["v", "1"]}]}], ")"}]}]], "-", 
  FractionBox[
   RowBox[{
    SubscriptBox["p", "2"], "\[CenterDot]", 
    SubscriptBox["S", "0"], "\[CenterDot]", 
    SubscriptBox["F", "2"], "\[CenterDot]", 
    SubscriptBox["F", "1"], "\[CenterDot]", 
    SubscriptBox["F", "3"], "\[CenterDot]", 
    SubscriptBox["v", "1"]}], 
   RowBox[{
    SubscriptBox["p", "1"], "\[CenterDot]", 
    SubscriptBox["v", "1"]}]], "+", 
  FractionBox[
   RowBox[{
    RowBox[{
     SubscriptBox["p", "2"], "\[CenterDot]", 
     SubscriptBox["v", "1"]}], " ", 
    RowBox[{
     SubscriptBox["p", "2"], "\[CenterDot]", 
     SubscriptBox["S", "0"], "\[CenterDot]", 
     SubscriptBox["F", "2"], "\[CenterDot]", 
     SubscriptBox["F", "1"], "\[CenterDot]", 
     SubscriptBox["F", "3"], "\[CenterDot]", 
     SubscriptBox["v", "1"]}]}], 
   RowBox[{
    RowBox[{
     SubscriptBox["p", "1"], "\[CenterDot]", 
     SubscriptBox["v", "1"]}], " ", 
    RowBox[{"(", 
     RowBox[{
      RowBox[{
       SubscriptBox["p", "1"], "\[CenterDot]", 
       SubscriptBox["v", "1"]}], "+", 
      RowBox[{
       SubscriptBox["p", "2"], "\[CenterDot]", 
       SubscriptBox["v", "1"]}]}], ")"}]}]], "-", 
  FractionBox[
   RowBox[{
    SubscriptBox["p", "2"], "\[CenterDot]", 
    SubscriptBox["S", "0"], "\[CenterDot]", 
    SubscriptBox["F", "3"], "\[CenterDot]", 
    SubscriptBox["F", "1"], "\[CenterDot]", 
    SubscriptBox["F", "2"], "\[CenterDot]", 
    SubscriptBox["v", "1"]}], 
   RowBox[{
    SubscriptBox["p", "1"], "\[CenterDot]", 
    SubscriptBox["v", "1"]}]], "-", 
  FractionBox[
   RowBox[{
    SubscriptBox["p", "2"], "\[CenterDot]", 
    SubscriptBox["S", "0"], "\[CenterDot]", 
    SubscriptBox["F", "3"], "\[CenterDot]", 
    SubscriptBox["F", "2"], "\[CenterDot]", 
    SubscriptBox["F", "1"], "\[CenterDot]", 
    SubscriptBox["v", "1"]}], 
   RowBox[{
    SubscriptBox["p", "1"], "\[CenterDot]", 
    SubscriptBox["v", "1"]}]], "-", 
  FractionBox[
   RowBox[{
    SubscriptBox["p", "3"], "\[CenterDot]", 
    SubscriptBox["F", "1"], "\[CenterDot]", 
    SubscriptBox["F", "2"], "\[CenterDot]", 
    SubscriptBox["S", "0"], "\[CenterDot]", 
    SubscriptBox["F", "3"], "\[CenterDot]", 
    SubscriptBox["v", "1"]}], 
   RowBox[{
    SubscriptBox["p", "1"], "\[CenterDot]", 
    SubscriptBox["v", "1"]}]], "+", 
  FractionBox[
   RowBox[{
    SubscriptBox["p", "3"], "\[CenterDot]", 
    SubscriptBox["F", "2"], "\[CenterDot]", 
    SubscriptBox["F", "1"], "\[CenterDot]", 
    SubscriptBox["S", "0"], "\[CenterDot]", 
    SubscriptBox["F", "3"], "\[CenterDot]", 
    SubscriptBox["v", "1"]}], 
   RowBox[{
    SubscriptBox["p", "1"], "\[CenterDot]", 
    SubscriptBox["v", "1"]}]], "+", 
  FractionBox[
   RowBox[{
    SubscriptBox["p", "3"], "\[CenterDot]", 
    SubscriptBox["S", "0"], "\[CenterDot]", 
    SubscriptBox["F", "1"], "\[CenterDot]", 
    SubscriptBox["F", "2"], "\[CenterDot]", 
    SubscriptBox["F", "3"], "\[CenterDot]", 
    SubscriptBox["v", "1"]}], 
   RowBox[{
    SubscriptBox["p", "1"], "\[CenterDot]", 
    SubscriptBox["v", "1"]}]], "-", 
  FractionBox[
   RowBox[{
    SubscriptBox["p", "3"], "\[CenterDot]", 
    SubscriptBox["S", "0"], "\[CenterDot]", 
    SubscriptBox["F", "2"], "\[CenterDot]", 
    SubscriptBox["F", "1"], "\[CenterDot]", 
    SubscriptBox["F", "3"], "\[CenterDot]", 
    SubscriptBox["v", "1"]}], 
   RowBox[{
    SubscriptBox["p", "1"], "\[CenterDot]", 
    SubscriptBox["v", "1"]}]], "-", 
  FractionBox[
   RowBox[{
    SubscriptBox["p", "3"], "\[CenterDot]", 
    SubscriptBox["S", "0"], "\[CenterDot]", 
    SubscriptBox["F", "3"], "\[CenterDot]", 
    SubscriptBox["F", "1"], "\[CenterDot]", 
    SubscriptBox["F", "2"], "\[CenterDot]", 
    SubscriptBox["v", "1"]}], 
   RowBox[{
    SubscriptBox["p", "1"], "\[CenterDot]", 
    SubscriptBox["v", "1"]}]], "+", 
  FractionBox[
   RowBox[{
    RowBox[{
     SubscriptBox["p", "3"], "\[CenterDot]", 
     SubscriptBox["v", "1"]}], " ", 
    RowBox[{
     SubscriptBox["p", "3"], "\[CenterDot]", 
     SubscriptBox["S", "0"], "\[CenterDot]", 
     SubscriptBox["F", "3"], "\[CenterDot]", 
     SubscriptBox["F", "1"], "\[CenterDot]", 
     SubscriptBox["F", "2"], "\[CenterDot]", 
     SubscriptBox["v", "1"]}]}], 
   RowBox[{
    RowBox[{
     SubscriptBox["p", "1"], "\[CenterDot]", 
     SubscriptBox["v", "1"]}], " ", 
    RowBox[{"(", 
     RowBox[{
      RowBox[{
       SubscriptBox["p", "1"], "\[CenterDot]", 
       SubscriptBox["v", "1"]}], "+", 
      RowBox[{
       SubscriptBox["p", "3"], "\[CenterDot]", 
       SubscriptBox["v", "1"]}]}], ")"}]}]], "-", 
  FractionBox[
   RowBox[{
    SubscriptBox["p", "3"], "\[CenterDot]", 
    SubscriptBox["S", "0"], "\[CenterDot]", 
    SubscriptBox["F", "3"], "\[CenterDot]", 
    SubscriptBox["F", "2"], "\[CenterDot]", 
    SubscriptBox["F", "1"], "\[CenterDot]", 
    SubscriptBox["v", "1"]}], 
   RowBox[{
    SubscriptBox["p", "1"], "\[CenterDot]", 
    SubscriptBox["v", "1"]}]], "-", 
  FractionBox[
   RowBox[{
    RowBox[{
     SubscriptBox["p", "1"], "\[CenterDot]", 
     SubscriptBox["p", "2"]}], " ", 
    RowBox[{
     SubscriptBox["v", "1"], "\[CenterDot]", 
     SubscriptBox["F", "2"], "\[CenterDot]", 
     SubscriptBox["S", "0"], "\[CenterDot]", 
     SubscriptBox["F", "1"], "\[CenterDot]", 
     SubscriptBox["F", "3"], "\[CenterDot]", 
     SubscriptBox["v", "1"]}]}], 
   RowBox[{
    RowBox[{
     SubscriptBox["p", "1"], "\[CenterDot]", 
     SubscriptBox["v", "1"]}], " ", 
    RowBox[{"(", 
     RowBox[{
      RowBox[{
       SubscriptBox["p", "1"], "\[CenterDot]", 
       SubscriptBox["v", "1"]}], "+", 
      RowBox[{
       SubscriptBox["p", "2"], "\[CenterDot]", 
       SubscriptBox["v", "1"]}]}], ")"}]}]]}]], "Output",
 CellChangeTimes->{
  3.878096067467098*^9, {3.878096905251871*^9, 3.8780969362442007`*^9}, {
   3.878097382044546*^9, 3.878097396682747*^9}},
 CellLabel->
  "Out[1568]=",ExpressionUUID->"99b8b527-2c8f-49ce-a350-6db15fb6ebc8"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{
     RowBox[{
      RowBox[{"numAnsatz", "/.", "sols"}], "/.", "solsvp1"}], "/.", 
     "solsvp2"}], "//", 
    RowBox[{
     RowBox[{"Cases", "[", 
      RowBox[{"#", ",", 
       RowBox[{"c", "[", "__", "]"}], ",", 
       RowBox[{"{", 
        RowBox[{"0", ",", "\[Infinity]"}], "}"}]}], "]"}], "&"}]}], "//", 
   "Union"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{"%", "//", "Length"}]}], "Input",
 CellChangeTimes->{{3.878097740252308*^9, 3.8780977941772013`*^9}},
 CellLabel->
  "In[1573]:=",ExpressionUUID->"b1392e9f-0802-4547-8291-d9d836b6a531"],

Cell[BoxData["420"], "Output",
 CellChangeTimes->{
  3.87809706529457*^9, {3.878097742428525*^9, 3.878097794716721*^9}},
 CellLabel->
  "Out[1574]=",ExpressionUUID->"591470bc-bf1a-44f5-900e-5da6e2a4c439"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{
     RowBox[{
      RowBox[{"numAnsatz", "/.", "sols"}], "/.", "solsvp1"}], "/.", 
     "solsvp2"}], "/.", 
    RowBox[{
     RowBox[{"c", "[", "__", "]"}], ":>", "0"}]}], "/.", "nicevs"}], "//.", 
  "nice"}]], "Input",
 CellChangeTimes->{{3.878096992646886*^9, 3.8780970253597383`*^9}, {
  3.878097865895237*^9, 3.878097895808736*^9}},
 CellLabel->
  "In[1576]:=",ExpressionUUID->"8e1a2554-41a4-4f32-a8dc-9e90074da6ee"],

Cell[BoxData[
 RowBox[{
  FractionBox[
   RowBox[{
    RowBox[{"v", "\[CenterDot]", 
     SubscriptBox["F", "1"], "\[CenterDot]", 
     SubscriptBox["F", "3"], "\[CenterDot]", "v"}], " ", 
    RowBox[{
     SubscriptBox["p", "1"], "\[CenterDot]", 
     SubscriptBox["F", "2"], "\[CenterDot]", "S", "\[CenterDot]", 
     SubscriptBox["p", "2"]}]}], 
   RowBox[{
    RowBox[{"v", "\[CenterDot]", 
     SubscriptBox["p", "1"]}], " ", 
    RowBox[{"(", 
     RowBox[{
      RowBox[{"v", "\[CenterDot]", 
       SubscriptBox["p", "1"]}], "+", 
      RowBox[{"v", "\[CenterDot]", 
       SubscriptBox["p", "2"]}]}], ")"}]}]], "+", 
  FractionBox[
   RowBox[{
    RowBox[{"v", "\[CenterDot]", 
     SubscriptBox["F", "1"], "\[CenterDot]", 
     SubscriptBox["F", "3"], "\[CenterDot]", "v"}], " ", 
    RowBox[{
     SubscriptBox["p", "1"], "\[CenterDot]", 
     SubscriptBox["F", "2"], "\[CenterDot]", "S", "\[CenterDot]", 
     SubscriptBox["p", "2"]}]}], 
   RowBox[{
    RowBox[{"v", "\[CenterDot]", 
     SubscriptBox["p", "1"]}], " ", 
    RowBox[{"(", 
     RowBox[{
      RowBox[{"v", "\[CenterDot]", 
       SubscriptBox["p", "1"]}], "+", 
      RowBox[{"v", "\[CenterDot]", 
       SubscriptBox["p", "3"]}]}], ")"}]}]], "+", 
  FractionBox[
   RowBox[{
    RowBox[{"v", "\[CenterDot]", 
     SubscriptBox["F", "1"], "\[CenterDot]", 
     SubscriptBox["F", "2"], "\[CenterDot]", "v"}], " ", 
    RowBox[{
     SubscriptBox["p", "1"], "\[CenterDot]", 
     SubscriptBox["F", "3"], "\[CenterDot]", "S", "\[CenterDot]", 
     SubscriptBox["p", "3"]}]}], 
   RowBox[{
    RowBox[{"v", "\[CenterDot]", 
     SubscriptBox["p", "1"]}], " ", 
    RowBox[{"(", 
     RowBox[{
      RowBox[{"v", "\[CenterDot]", 
       SubscriptBox["p", "1"]}], "+", 
      RowBox[{"v", "\[CenterDot]", 
       SubscriptBox["p", "2"]}]}], ")"}]}]], "+", 
  FractionBox[
   RowBox[{
    RowBox[{"v", "\[CenterDot]", 
     SubscriptBox["F", "1"], "\[CenterDot]", 
     SubscriptBox["F", "2"], "\[CenterDot]", "v"}], " ", 
    RowBox[{
     SubscriptBox["p", "1"], "\[CenterDot]", 
     SubscriptBox["F", "3"], "\[CenterDot]", "S", "\[CenterDot]", 
     SubscriptBox["p", "3"]}]}], 
   RowBox[{
    RowBox[{"v", "\[CenterDot]", 
     SubscriptBox["p", "1"]}], " ", 
    RowBox[{"(", 
     RowBox[{
      RowBox[{"v", "\[CenterDot]", 
       SubscriptBox["p", "1"]}], "+", 
      RowBox[{"v", "\[CenterDot]", 
       SubscriptBox["p", "3"]}]}], ")"}]}]], "+", 
  FractionBox[
   RowBox[{
    RowBox[{
     SubscriptBox["p", "1"], "\[CenterDot]", "S", "\[CenterDot]", 
     SubscriptBox["F", "2"], "\[CenterDot]", "v"}], " ", 
    RowBox[{
     SubscriptBox["p", "2"], "\[CenterDot]", 
     SubscriptBox["F", "1"], "\[CenterDot]", 
     SubscriptBox["F", "3"], "\[CenterDot]", "v"}]}], 
   RowBox[{
    RowBox[{"v", "\[CenterDot]", 
     SubscriptBox["p", "1"]}], " ", 
    RowBox[{"(", 
     RowBox[{
      RowBox[{"v", "\[CenterDot]", 
       SubscriptBox["p", "1"]}], "+", 
      RowBox[{"v", "\[CenterDot]", 
       SubscriptBox["p", "2"]}]}], ")"}]}]], "+", 
  FractionBox[
   RowBox[{
    RowBox[{"v", "\[CenterDot]", 
     SubscriptBox["F", "1"], "\[CenterDot]", 
     SubscriptBox["F", "2"], "\[CenterDot]", "v"}], " ", 
    RowBox[{
     SubscriptBox["p", "2"], "\[CenterDot]", 
     SubscriptBox["F", "3"], "\[CenterDot]", "S", "\[CenterDot]", 
     SubscriptBox["p", "3"]}]}], 
   RowBox[{
    RowBox[{"v", "\[CenterDot]", 
     SubscriptBox["p", "1"]}], " ", 
    RowBox[{"(", 
     RowBox[{
      RowBox[{"v", "\[CenterDot]", 
       SubscriptBox["p", "1"]}], "+", 
      RowBox[{"v", "\[CenterDot]", 
       SubscriptBox["p", "2"]}]}], ")"}]}]], "-", 
  FractionBox[
   RowBox[{
    RowBox[{
     SubscriptBox["p", "1"], "\[CenterDot]", "S", "\[CenterDot]", 
     SubscriptBox["p", "3"]}], " ", 
    RowBox[{"v", "\[CenterDot]", 
     SubscriptBox["F", "2"], "\[CenterDot]", 
     SubscriptBox["F", "1"], "\[CenterDot]", 
     SubscriptBox["F", "3"], "\[CenterDot]", "v"}]}], 
   RowBox[{
    RowBox[{"v", "\[CenterDot]", 
     SubscriptBox["p", "1"]}], " ", 
    RowBox[{"(", 
     RowBox[{
      RowBox[{"v", "\[CenterDot]", 
       SubscriptBox["p", "1"]}], "+", 
      RowBox[{"v", "\[CenterDot]", 
       SubscriptBox["p", "3"]}]}], ")"}]}]], "-", 
  FractionBox[
   RowBox[{
    RowBox[{
     SubscriptBox["p", "1"], "\[CenterDot]", 
     SubscriptBox["F", "3"], "\[CenterDot]", "v"}], " ", 
    RowBox[{
     SubscriptBox["p", "1"], "\[CenterDot]", "S", "\[CenterDot]", 
     SubscriptBox["F", "1"], "\[CenterDot]", 
     SubscriptBox["F", "2"], "\[CenterDot]", "v"}]}], 
   RowBox[{
    RowBox[{"v", "\[CenterDot]", 
     SubscriptBox["p", "1"]}], " ", 
    RowBox[{"(", 
     RowBox[{
      RowBox[{"v", "\[CenterDot]", 
       SubscriptBox["p", "1"]}], "+", 
      RowBox[{"v", "\[CenterDot]", 
       SubscriptBox["p", "2"]}]}], ")"}]}]], "-", 
  FractionBox[
   RowBox[{
    RowBox[{
     SubscriptBox["p", "1"], "\[CenterDot]", 
     SubscriptBox["F", "3"], "\[CenterDot]", "v"}], " ", 
    RowBox[{
     SubscriptBox["p", "1"], "\[CenterDot]", "S", "\[CenterDot]", 
     SubscriptBox["F", "1"], "\[CenterDot]", 
     SubscriptBox["F", "2"], "\[CenterDot]", "v"}]}], 
   RowBox[{
    RowBox[{"v", "\[CenterDot]", 
     SubscriptBox["p", "1"]}], " ", 
    RowBox[{"(", 
     RowBox[{
      RowBox[{"v", "\[CenterDot]", 
       SubscriptBox["p", "1"]}], "+", 
      RowBox[{"v", "\[CenterDot]", 
       SubscriptBox["p", "3"]}]}], ")"}]}]], "-", 
  FractionBox[
   RowBox[{
    RowBox[{
     SubscriptBox["p", "2"], "\[CenterDot]", 
     SubscriptBox["F", "3"], "\[CenterDot]", "v"}], " ", 
    RowBox[{
     SubscriptBox["p", "1"], "\[CenterDot]", "S", "\[CenterDot]", 
     SubscriptBox["F", "1"], "\[CenterDot]", 
     SubscriptBox["F", "2"], "\[CenterDot]", "v"}]}], 
   RowBox[{
    RowBox[{"v", "\[CenterDot]", 
     SubscriptBox["p", "1"]}], " ", 
    RowBox[{"(", 
     RowBox[{
      RowBox[{"v", "\[CenterDot]", 
       SubscriptBox["p", "1"]}], "+", 
      RowBox[{"v", "\[CenterDot]", 
       SubscriptBox["p", "2"]}]}], ")"}]}]], "-", 
  FractionBox[
   RowBox[{
    RowBox[{
     SubscriptBox["p", "1"], "\[CenterDot]", 
     SubscriptBox["F", "3"], "\[CenterDot]", "v"}], " ", 
    RowBox[{
     SubscriptBox["p", "2"], "\[CenterDot]", "S", "\[CenterDot]", 
     SubscriptBox["F", "1"], "\[CenterDot]", 
     SubscriptBox["F", "2"], "\[CenterDot]", "v"}]}], 
   RowBox[{
    RowBox[{"v", "\[CenterDot]", 
     SubscriptBox["p", "1"]}], " ", 
    RowBox[{"(", 
     RowBox[{
      RowBox[{"v", "\[CenterDot]", 
       SubscriptBox["p", "1"]}], "+", 
      RowBox[{"v", "\[CenterDot]", 
       SubscriptBox["p", "2"]}]}], ")"}]}]], "-", 
  FractionBox[
   RowBox[{
    RowBox[{
     SubscriptBox["p", "2"], "\[CenterDot]", 
     SubscriptBox["F", "3"], "\[CenterDot]", "v"}], " ", 
    RowBox[{
     SubscriptBox["p", "2"], "\[CenterDot]", "S", "\[CenterDot]", 
     SubscriptBox["F", "2"], "\[CenterDot]", 
     SubscriptBox["F", "1"], "\[CenterDot]", "v"}]}], 
   RowBox[{
    RowBox[{"v", "\[CenterDot]", 
     SubscriptBox["p", "1"]}], " ", 
    RowBox[{"(", 
     RowBox[{
      RowBox[{"v", "\[CenterDot]", 
       SubscriptBox["p", "1"]}], "+", 
      RowBox[{"v", "\[CenterDot]", 
       SubscriptBox["p", "2"]}]}], ")"}]}]], "-", 
  FractionBox[
   RowBox[{
    RowBox[{
     SubscriptBox["p", "1"], "\[CenterDot]", 
     SubscriptBox["F", "3"], "\[CenterDot]", "v"}], " ", 
    RowBox[{
     SubscriptBox["p", "3"], "\[CenterDot]", "S", "\[CenterDot]", 
     SubscriptBox["F", "1"], "\[CenterDot]", 
     SubscriptBox["F", "2"], "\[CenterDot]", "v"}]}], 
   RowBox[{
    RowBox[{"v", "\[CenterDot]", 
     SubscriptBox["p", "1"]}], " ", 
    RowBox[{"(", 
     RowBox[{
      RowBox[{"v", "\[CenterDot]", 
       SubscriptBox["p", "1"]}], "+", 
      RowBox[{"v", "\[CenterDot]", 
       SubscriptBox["p", "3"]}]}], ")"}]}]], "+", 
  FractionBox[
   RowBox[{
    RowBox[{
     SubscriptBox["p", "1"], "\[CenterDot]", 
     SubscriptBox["F", "2"], "\[CenterDot]", "v"}], " ", 
    RowBox[{
     SubscriptBox["p", "3"], "\[CenterDot]", 
     SubscriptBox["F", "1"], "\[CenterDot]", "S", "\[CenterDot]", 
     SubscriptBox["F", "3"], "\[CenterDot]", "v"}]}], 
   RowBox[{
    RowBox[{"v", "\[CenterDot]", 
     SubscriptBox["p", "1"]}], " ", 
    RowBox[{"(", 
     RowBox[{
      RowBox[{"v", "\[CenterDot]", 
       SubscriptBox["p", "1"]}], "+", 
      RowBox[{"v", "\[CenterDot]", 
       SubscriptBox["p", "3"]}]}], ")"}]}]], "-", 
  FractionBox[
   RowBox[{
    RowBox[{
     SubscriptBox["p", "1"], "\[CenterDot]", 
     SubscriptBox["p", "2"]}], " ", 
    RowBox[{"v", "\[CenterDot]", 
     SubscriptBox["F", "2"], "\[CenterDot]", "S", "\[CenterDot]", 
     SubscriptBox["F", "1"], "\[CenterDot]", 
     SubscriptBox["F", "3"], "\[CenterDot]", "v"}]}], 
   RowBox[{
    RowBox[{"v", "\[CenterDot]", 
     SubscriptBox["p", "1"]}], " ", 
    RowBox[{"(", 
     RowBox[{
      RowBox[{"v", "\[CenterDot]", 
       SubscriptBox["p", "1"]}], "+", 
      RowBox[{"v", "\[CenterDot]", 
       SubscriptBox["p", "2"]}]}], ")"}]}]], "+", 
  FractionBox[
   RowBox[{
    SubscriptBox["p", "1"], "\[CenterDot]", "S", "\[CenterDot]", 
    SubscriptBox["F", "1"], "\[CenterDot]", 
    SubscriptBox["F", "2"], "\[CenterDot]", 
    SubscriptBox["F", "3"], "\[CenterDot]", "v"}], 
   RowBox[{"v", "\[CenterDot]", 
    SubscriptBox["p", "1"]}]], "-", 
  FractionBox[
   RowBox[{
    SubscriptBox["p", "1"], "\[CenterDot]", "S", "\[CenterDot]", 
    SubscriptBox["F", "2"], "\[CenterDot]", 
    SubscriptBox["F", "1"], "\[CenterDot]", 
    SubscriptBox["F", "3"], "\[CenterDot]", "v"}], 
   RowBox[{"v", "\[CenterDot]", 
    SubscriptBox["p", "1"]}]], "-", 
  FractionBox[
   RowBox[{
    SubscriptBox["p", "1"], "\[CenterDot]", "S", "\[CenterDot]", 
    SubscriptBox["F", "3"], "\[CenterDot]", 
    SubscriptBox["F", "1"], "\[CenterDot]", 
    SubscriptBox["F", "2"], "\[CenterDot]", "v"}], 
   RowBox[{"v", "\[CenterDot]", 
    SubscriptBox["p", "1"]}]], "+", 
  FractionBox[
   RowBox[{
    SubscriptBox["p", "1"], "\[CenterDot]", 
    SubscriptBox["F", "2"], "\[CenterDot]", "S", "\[CenterDot]", 
    SubscriptBox["F", "1"], "\[CenterDot]", 
    SubscriptBox["F", "3"], "\[CenterDot]", "v"}], 
   RowBox[{"v", "\[CenterDot]", 
    SubscriptBox["p", "1"]}]], "+", 
  FractionBox[
   RowBox[{
    SubscriptBox["p", "1"], "\[CenterDot]", 
    SubscriptBox["F", "3"], "\[CenterDot]", "S", "\[CenterDot]", 
    SubscriptBox["F", "1"], "\[CenterDot]", 
    SubscriptBox["F", "2"], "\[CenterDot]", "v"}], 
   RowBox[{"v", "\[CenterDot]", 
    SubscriptBox["p", "1"]}]], "+", 
  FractionBox[
   RowBox[{
    SubscriptBox["p", "2"], "\[CenterDot]", "S", "\[CenterDot]", 
    SubscriptBox["F", "1"], "\[CenterDot]", 
    SubscriptBox["F", "2"], "\[CenterDot]", 
    SubscriptBox["F", "3"], "\[CenterDot]", "v"}], 
   RowBox[{"v", "\[CenterDot]", 
    SubscriptBox["p", "1"]}]], "-", 
  FractionBox[
   RowBox[{
    RowBox[{"v", "\[CenterDot]", 
     SubscriptBox["p", "2"]}], " ", 
    RowBox[{
     SubscriptBox["p", "2"], "\[CenterDot]", "S", "\[CenterDot]", 
     SubscriptBox["F", "1"], "\[CenterDot]", 
     SubscriptBox["F", "2"], "\[CenterDot]", 
     SubscriptBox["F", "3"], "\[CenterDot]", "v"}]}], 
   RowBox[{
    RowBox[{"v", "\[CenterDot]", 
     SubscriptBox["p", "1"]}], " ", 
    RowBox[{"(", 
     RowBox[{
      RowBox[{"v", "\[CenterDot]", 
       SubscriptBox["p", "1"]}], "+", 
      RowBox[{"v", "\[CenterDot]", 
       SubscriptBox["p", "2"]}]}], ")"}]}]], "-", 
  FractionBox[
   RowBox[{
    SubscriptBox["p", "2"], "\[CenterDot]", "S", "\[CenterDot]", 
    SubscriptBox["F", "2"], "\[CenterDot]", 
    SubscriptBox["F", "1"], "\[CenterDot]", 
    SubscriptBox["F", "3"], "\[CenterDot]", "v"}], 
   RowBox[{"v", "\[CenterDot]", 
    SubscriptBox["p", "1"]}]], "+", 
  FractionBox[
   RowBox[{
    RowBox[{"v", "\[CenterDot]", 
     SubscriptBox["p", "2"]}], " ", 
    RowBox[{
     SubscriptBox["p", "2"], "\[CenterDot]", "S", "\[CenterDot]", 
     SubscriptBox["F", "2"], "\[CenterDot]", 
     SubscriptBox["F", "1"], "\[CenterDot]", 
     SubscriptBox["F", "3"], "\[CenterDot]", "v"}]}], 
   RowBox[{
    RowBox[{"v", "\[CenterDot]", 
     SubscriptBox["p", "1"]}], " ", 
    RowBox[{"(", 
     RowBox[{
      RowBox[{"v", "\[CenterDot]", 
       SubscriptBox["p", "1"]}], "+", 
      RowBox[{"v", "\[CenterDot]", 
       SubscriptBox["p", "2"]}]}], ")"}]}]], "-", 
  FractionBox[
   RowBox[{
    SubscriptBox["p", "2"], "\[CenterDot]", "S", "\[CenterDot]", 
    SubscriptBox["F", "3"], "\[CenterDot]", 
    SubscriptBox["F", "1"], "\[CenterDot]", 
    SubscriptBox["F", "2"], "\[CenterDot]", "v"}], 
   RowBox[{"v", "\[CenterDot]", 
    SubscriptBox["p", "1"]}]], "-", 
  FractionBox[
   RowBox[{
    SubscriptBox["p", "2"], "\[CenterDot]", "S", "\[CenterDot]", 
    SubscriptBox["F", "3"], "\[CenterDot]", 
    SubscriptBox["F", "2"], "\[CenterDot]", 
    SubscriptBox["F", "1"], "\[CenterDot]", "v"}], 
   RowBox[{"v", "\[CenterDot]", 
    SubscriptBox["p", "1"]}]], "-", 
  FractionBox[
   RowBox[{
    SubscriptBox["p", "2"], "\[CenterDot]", 
    SubscriptBox["F", "1"], "\[CenterDot]", "S", "\[CenterDot]", 
    SubscriptBox["F", "2"], "\[CenterDot]", 
    SubscriptBox["F", "3"], "\[CenterDot]", "v"}], 
   RowBox[{"v", "\[CenterDot]", 
    SubscriptBox["p", "1"]}]], "+", 
  FractionBox[
   RowBox[{
    RowBox[{"v", "\[CenterDot]", 
     SubscriptBox["p", "2"]}], " ", 
    RowBox[{
     SubscriptBox["p", "2"], "\[CenterDot]", 
     SubscriptBox["F", "1"], "\[CenterDot]", "S", "\[CenterDot]", 
     SubscriptBox["F", "2"], "\[CenterDot]", 
     SubscriptBox["F", "3"], "\[CenterDot]", "v"}]}], 
   RowBox[{
    RowBox[{"v", "\[CenterDot]", 
     SubscriptBox["p", "1"]}], " ", 
    RowBox[{"(", 
     RowBox[{
      RowBox[{"v", "\[CenterDot]", 
       SubscriptBox["p", "1"]}], "+", 
      RowBox[{"v", "\[CenterDot]", 
       SubscriptBox["p", "2"]}]}], ")"}]}]], "+", 
  FractionBox[
   RowBox[{
    SubscriptBox["p", "2"], "\[CenterDot]", 
    SubscriptBox["F", "1"], "\[CenterDot]", "S", "\[CenterDot]", 
    SubscriptBox["F", "3"], "\[CenterDot]", 
    SubscriptBox["F", "2"], "\[CenterDot]", "v"}], 
   RowBox[{"v", "\[CenterDot]", 
    SubscriptBox["p", "1"]}]], "-", 
  FractionBox[
   RowBox[{
    SubscriptBox["p", "2"], "\[CenterDot]", 
    SubscriptBox["F", "1"], "\[CenterDot]", 
    SubscriptBox["F", "3"], "\[CenterDot]", "S", "\[CenterDot]", 
    SubscriptBox["F", "2"], "\[CenterDot]", "v"}], 
   RowBox[{"v", "\[CenterDot]", 
    SubscriptBox["p", "1"]}]], "+", 
  FractionBox[
   RowBox[{
    SubscriptBox["p", "2"], "\[CenterDot]", 
    SubscriptBox["F", "3"], "\[CenterDot]", "S", "\[CenterDot]", 
    SubscriptBox["F", "1"], "\[CenterDot]", 
    SubscriptBox["F", "2"], "\[CenterDot]", "v"}], 
   RowBox[{"v", "\[CenterDot]", 
    SubscriptBox["p", "1"]}]], "+", 
  FractionBox[
   RowBox[{
    SubscriptBox["p", "2"], "\[CenterDot]", 
    SubscriptBox["F", "3"], "\[CenterDot]", "S", "\[CenterDot]", 
    SubscriptBox["F", "2"], "\[CenterDot]", 
    SubscriptBox["F", "1"], "\[CenterDot]", "v"}], 
   RowBox[{"v", "\[CenterDot]", 
    SubscriptBox["p", "1"]}]], "+", 
  FractionBox[
   RowBox[{
    SubscriptBox["p", "3"], "\[CenterDot]", "S", "\[CenterDot]", 
    SubscriptBox["F", "1"], "\[CenterDot]", 
    SubscriptBox["F", "2"], "\[CenterDot]", 
    SubscriptBox["F", "3"], "\[CenterDot]", "v"}], 
   RowBox[{"v", "\[CenterDot]", 
    SubscriptBox["p", "1"]}]], "-", 
  FractionBox[
   RowBox[{
    SubscriptBox["p", "3"], "\[CenterDot]", "S", "\[CenterDot]", 
    SubscriptBox["F", "2"], "\[CenterDot]", 
    SubscriptBox["F", "1"], "\[CenterDot]", 
    SubscriptBox["F", "3"], "\[CenterDot]", "v"}], 
   RowBox[{"v", "\[CenterDot]", 
    SubscriptBox["p", "1"]}]], "-", 
  FractionBox[
   RowBox[{
    SubscriptBox["p", "3"], "\[CenterDot]", "S", "\[CenterDot]", 
    SubscriptBox["F", "3"], "\[CenterDot]", 
    SubscriptBox["F", "1"], "\[CenterDot]", 
    SubscriptBox["F", "2"], "\[CenterDot]", "v"}], 
   RowBox[{"v", "\[CenterDot]", 
    SubscriptBox["p", "1"]}]], "+", 
  FractionBox[
   RowBox[{
    RowBox[{"v", "\[CenterDot]", 
     SubscriptBox["p", "3"]}], " ", 
    RowBox[{
     SubscriptBox["p", "3"], "\[CenterDot]", "S", "\[CenterDot]", 
     SubscriptBox["F", "3"], "\[CenterDot]", 
     SubscriptBox["F", "1"], "\[CenterDot]", 
     SubscriptBox["F", "2"], "\[CenterDot]", "v"}]}], 
   RowBox[{
    RowBox[{"v", "\[CenterDot]", 
     SubscriptBox["p", "1"]}], " ", 
    RowBox[{"(", 
     RowBox[{
      RowBox[{"v", "\[CenterDot]", 
       SubscriptBox["p", "1"]}], "+", 
      RowBox[{"v", "\[CenterDot]", 
       SubscriptBox["p", "3"]}]}], ")"}]}]], "-", 
  FractionBox[
   RowBox[{
    SubscriptBox["p", "3"], "\[CenterDot]", "S", "\[CenterDot]", 
    SubscriptBox["F", "3"], "\[CenterDot]", 
    SubscriptBox["F", "2"], "\[CenterDot]", 
    SubscriptBox["F", "1"], "\[CenterDot]", "v"}], 
   RowBox[{"v", "\[CenterDot]", 
    SubscriptBox["p", "1"]}]], "-", 
  FractionBox[
   RowBox[{
    SubscriptBox["p", "3"], "\[CenterDot]", 
    SubscriptBox["F", "1"], "\[CenterDot]", 
    SubscriptBox["F", "2"], "\[CenterDot]", "S", "\[CenterDot]", 
    SubscriptBox["F", "3"], "\[CenterDot]", "v"}], 
   RowBox[{"v", "\[CenterDot]", 
    SubscriptBox["p", "1"]}]], "+", 
  FractionBox[
   RowBox[{
    SubscriptBox["p", "3"], "\[CenterDot]", 
    SubscriptBox["F", "2"], "\[CenterDot]", 
    SubscriptBox["F", "1"], "\[CenterDot]", "S", "\[CenterDot]", 
    SubscriptBox["F", "3"], "\[CenterDot]", "v"}], 
   RowBox[{"v", "\[CenterDot]", 
    SubscriptBox["p", "1"]}]]}]], "Output",
 CellChangeTimes->{{3.878096994542691*^9, 3.878097026032852*^9}, {
  3.8780978736826763`*^9, 3.878097896716341*^9}},
 CellLabel->
  "Out[1576]=",ExpressionUUID->"1ed87c8d-a7f8-4bc2-bb56-1878d86c7b33"]
}, Open  ]]
}, Open  ]]
}, Closed]],

Cell[CellGroupData[{

Cell["Example S Five point Fewer Parameter", "Section",
 CellChangeTimes->{{3.877008171032135*^9, 3.877008177039516*^9}, {
  3.8773818494951763`*^9, 3.877381857475391*^9}, {3.878020608795433*^9, 
  3.87802061200184*^9}, {3.878106086500737*^9, 
  3.878106090914515*^9}},ExpressionUUID->"59b54bc3-97df-45d6-bc28-\
81e428b29101"],

Cell[CellGroupData[{

Cell["Setup ansatz", "Subsection",
 CellChangeTimes->{{3.877386203620414*^9, 
  3.877386209613765*^9}},ExpressionUUID->"46d3ea8b-05f7-4416-b0bc-\
fd29a7778142"],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{
  RowBox[{"n", "=", "5"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"vponshell", "=", 
   RowBox[{
    RowBox[{"vonshell", "[", 
     RowBox[{
      RowBox[{"n", "-", "1"}], ",", "1"}], "]"}], "/.", 
    RowBox[{"v", "->", 
     RowBox[{"v", "[", "1", "]"}]}]}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{"gponshell", "=", 
  RowBox[{
   RowBox[{"onshell", "[", 
    RowBox[{"n", "-", "1"}], "]"}], "/.", 
   RowBox[{
    RowBox[{"s", "[", 
     RowBox[{"i_", ",", "j_"}], "]"}], ":>", 
    RowBox[{"dot", "[", 
     RowBox[{
      RowBox[{"p", "[", "i", "]"}], ",", 
      RowBox[{"p", "[", "j", "]"}]}], "]"}]}]}]}]}], "Input",
 CellChangeTimes->{{3.878020618673658*^9, 3.878020625406555*^9}, {
   3.878020685245474*^9, 3.8780206881234617`*^9}, 3.878021076476811*^9, {
   3.878022447789905*^9, 3.8780224652203074`*^9}, {3.878024579094555*^9, 
   3.87802460824821*^9}},
 CellLabel->
  "In[1888]:=",ExpressionUUID->"63883844-e4d0-4419-995f-f86af78cb92b"],

Cell[BoxData[
 RowBox[{
  RowBox[{"dot", "[", 
   RowBox[{
    RowBox[{"p", "[", "2", "]"}], ",", 
    RowBox[{"p", "[", "3", "]"}]}], "]"}], "\[Rule]", 
  RowBox[{
   RowBox[{"-", 
    RowBox[{"dot", "[", 
     RowBox[{
      RowBox[{"p", "[", "1", "]"}], ",", 
      RowBox[{"p", "[", "2", "]"}]}], "]"}]}], "-", 
   RowBox[{"dot", "[", 
    RowBox[{
     RowBox[{"p", "[", "1", "]"}], ",", 
     RowBox[{"p", "[", "3", "]"}]}], "]"}]}]}]], "Output",
 CellChangeTimes->{{3.878024603364303*^9, 3.8780246086311693`*^9}, 
   3.8780958347602053`*^9, 3.8781061044812183`*^9, 3.8781115859252377`*^9},
 CellLabel->
  "Out[1890]=",ExpressionUUID->"83aac5e4-b6c9-40d2-8198-3e2d8667c23b"]
}, Open  ]],

Cell[BoxData[{
 RowBox[{
  RowBox[{"denOrder", "=", "1"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"monofs1", "=", 
   RowBox[{"monoFS", "[", 
    RowBox[{"denOrder", ",", 
     RowBox[{"n", "-", "2"}]}], "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"denOrder", "=", "2"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"monofs2", "=", 
   RowBox[{"monoFS", "[", 
    RowBox[{"denOrder", ",", 
     RowBox[{"n", "-", "2"}]}], "]"}]}], ";"}]}], "Input",
 CellChangeTimes->{{3.877381049405899*^9, 3.877381116483204*^9}, {
  3.877381244223319*^9, 3.877381284761427*^9}, {3.877381353256666*^9, 
  3.877381353488029*^9}, {3.87738186344316*^9, 3.877381863777376*^9}, {
  3.8773822047453117`*^9, 3.877382204987795*^9}, {3.8773825485753727`*^9, 
  3.877382548830839*^9}, {3.877382654557598*^9, 3.877382674685717*^9}, {
  3.878016251644945*^9, 3.87801627282722*^9}, {3.878018811842737*^9, 
  3.878018821618462*^9}, {3.878019111987747*^9, 3.8780191881088953`*^9}, {
  3.8780192243067636`*^9, 3.878019263820836*^9}, {3.8780196953188877`*^9, 
  3.8780197336534443`*^9}, {3.878028860196001*^9, 3.878028905573225*^9}},
 CellLabel->
  "In[1891]:=",ExpressionUUID->"76d539e4-604c-4249-bad1-2503c5290e11"],

Cell[BoxData[{
 RowBox[{
  RowBox[{"monofs1", "=", 
   RowBox[{
    RowBox[{
     RowBox[{"(", 
      RowBox[{"List", "@@", 
       RowBox[{"(", 
        RowBox[{
         RowBox[{
          RowBox[{"monofs1", "/.", "vponshell"}], "//", "Total"}], "//", 
         "Expand"}], ")"}]}], ")"}], "/.", 
     RowBox[{
      RowBox[{"a_", " ", "b_"}], ":>", " ", 
      RowBox[{"b", "/;", 
       RowBox[{"NumberQ", "[", "a", "]"}]}]}]}], "//", "Union"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"monofs2", "=", 
   RowBox[{
    RowBox[{
     RowBox[{"(", 
      RowBox[{"List", "@@", 
       RowBox[{"(", 
        RowBox[{
         RowBox[{
          RowBox[{"monofs2", "/.", "vponshell"}], "//", "Total"}], "//", 
         "Expand"}], ")"}]}], ")"}], "/.", 
     RowBox[{
      RowBox[{"a_", " ", "b_"}], ":>", " ", 
      RowBox[{"b", "/;", 
       RowBox[{"NumberQ", "[", "a", "]"}]}]}]}], "//", "Union"}]}], 
  ";"}]}], "Input",
 CellChangeTimes->{{3.878106131993834*^9, 3.8781061481204767`*^9}},
 CellLabel->
  "In[1895]:=",ExpressionUUID->"d762502d-750c-4a1a-a501-5e02e614f8af"],

Cell[BoxData[
 RowBox[{
  RowBox[{"numAnsatz", "=", 
   RowBox[{
    RowBox[{"(", 
     RowBox[{
      FractionBox[
       RowBox[{
        RowBox[{
         RowBox[{"(", 
          RowBox[{"c", "/@", 
           RowBox[{"Range", "[", 
            RowBox[{"Length", "@", "monofs2"}], "]"}]}], ")"}], ".", 
         "monofs2"}], "/.", 
        RowBox[{
         RowBox[{"c", "[", "i_", "]"}], ":>", 
         RowBox[{"c", "[", 
          RowBox[{"1", ",", "i"}], "]"}]}]}], 
       RowBox[{
        RowBox[{"dot", "[", 
         RowBox[{
          RowBox[{"v", "[", "1", "]"}], ",", 
          RowBox[{"p", "[", "1", "]"}]}], "]"}], 
        RowBox[{"dot", "[", 
         RowBox[{
          RowBox[{"v", "[", "1", "]"}], ",", 
          RowBox[{
           RowBox[{"p", "[", "1", "]"}], "+", 
           RowBox[{"p", "[", "2", "]"}]}]}], "]"}]}]], "+", 
      FractionBox[
       RowBox[{
        RowBox[{
         RowBox[{"(", 
          RowBox[{"c", "/@", 
           RowBox[{"Range", "[", 
            RowBox[{"Length", "@", "monofs2"}], "]"}]}], ")"}], ".", 
         "monofs2"}], "/.", 
        RowBox[{
         RowBox[{"c", "[", "i_", "]"}], ":>", 
         RowBox[{"c", "[", 
          RowBox[{"2", ",", "i"}], "]"}]}]}], 
       RowBox[{
        RowBox[{"dot", "[", 
         RowBox[{
          RowBox[{"v", "[", "1", "]"}], ",", 
          RowBox[{"p", "[", "1", "]"}]}], "]"}], 
        RowBox[{"dot", "[", 
         RowBox[{
          RowBox[{"v", "[", "1", "]"}], ",", 
          RowBox[{
           RowBox[{"p", "[", "1", "]"}], "+", 
           RowBox[{"p", "[", "3", "]"}]}]}], "]"}]}]], "+", 
      FractionBox[
       RowBox[{
        RowBox[{
         RowBox[{"(", 
          RowBox[{"c", "/@", 
           RowBox[{"Range", "[", 
            RowBox[{"Length", "@", "monofs1"}], "]"}]}], ")"}], ".", 
         "monofs1"}], "/.", 
        RowBox[{
         RowBox[{"c", "[", "i_", "]"}], ":>", 
         RowBox[{"c", "[", 
          RowBox[{"3", ",", "i"}], "]"}]}]}], 
       RowBox[{"dot", "[", 
        RowBox[{
         RowBox[{"v", "[", "1", "]"}], ",", 
         RowBox[{"p", "[", "1", "]"}]}], "]"}]]}], ")"}], "//", "Expand"}]}], 
  ";"}]], "Input",
 CellChangeTimes->{{3.878019818828724*^9, 3.8780199018739433`*^9}, {
  3.878019938561898*^9, 3.878020036527034*^9}, {3.8780201912905703`*^9, 
  3.878020210990015*^9}, {3.87802091215549*^9, 3.8780209153502007`*^9}, {
  3.8780300130461073`*^9, 3.8780300429155807`*^9}, {3.8780319820804033`*^9, 
  3.87803198404319*^9}, {3.878032548017993*^9, 3.87803254970131*^9}, {
  3.8780755773066597`*^9, 3.878075579486418*^9}, {3.87808020451082*^9, 
  3.878080207422474*^9}, {3.8780802418491573`*^9, 3.878080244847021*^9}, {
  3.878080502097672*^9, 3.878080502683258*^9}},
 CellLabel->
  "In[1897]:=",ExpressionUUID->"b85bd2bb-430b-432d-85db-d49e5ba6ae04"]
}, Open  ]],

Cell[CellGroupData[{

Cell["Cut condition Massless", "Subsection",
 CellChangeTimes->{{3.878076730024465*^9, 
  3.8780767381983347`*^9}},ExpressionUUID->"27e8c3a2-ef85-4301-a1da-\
32f85207ffba"],

Cell[BoxData[
 RowBox[{
  RowBox[{"nod", "=", 
   RowBox[{
    RowBox[{
     RowBox[{
      RowBox[{
       RowBox[{"(", 
        RowBox[{"numAnsatz", "//", "expandFS"}], ")"}], "//.", "dotRules"}], "/.",
       "vponshell"}], "/.", 
     RowBox[{
      RowBox[{"\[Epsilon]", "[", "i_", "]"}], ":>", 
      RowBox[{"\[Epsilon]", "[", 
       RowBox[{"p", "[", "i", "]"}], "]"}]}]}], "//", "Expand"}]}], 
  ";"}]], "Input",
 CellChangeTimes->{{3.8780203515119047`*^9, 3.878020399229755*^9}, {
   3.878020431526237*^9, 3.8780204339818277`*^9}, {3.8780205335571136`*^9, 
   3.878020540776443*^9}, 3.8780206405534067`*^9, {3.878020888923959*^9, 
   3.878020889972404*^9}, 3.878021112062257*^9, {3.878022714056156*^9, 
   3.878022715411971*^9}, {3.8780319378374166`*^9, 3.878031956823164*^9}, 
   3.878110574998744*^9, 3.8781115550732813`*^9},
 CellLabel->
  "In[1898]:=",ExpressionUUID->"585e517d-3efd-42fb-8d2b-6ff81dcee3a7"],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{"bpeff2", "=", 
  RowBox[{"BinaryProduct", "[", 
   RowBox[{"Range", "[", 
    RowBox[{"n", "-", "2"}], "]"}], "]"}]}], "\n", 
 RowBox[{
  RowBox[{"numList", "=", 
   RowBox[{
    RowBox[{
     RowBox[{"ExpandNCM", "/@", 
      RowBox[{"(", 
       RowBox[{"bpeff2", "/.", 
        RowBox[{"X", "\[Rule]", " ", "NC"}]}], ")"}]}], "/.", 
     RowBox[{"NonCommutativeMultiply", "\[Rule]", " ", "T"}]}], "/.", 
    RowBox[{
     RowBox[{"T", "[", 
      RowBox[{"i1_", ",", "f___"}], "]"}], ":>", " ", 
     RowBox[{"0", "/;", 
      RowBox[{"i1", "\[NotEqual]", "1"}]}]}]}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"numListL", "=", 
   RowBox[{"numList", "/.", 
    RowBox[{
     RowBox[{"T", "[", "f___", "]"}], "\[RuleDelayed]", " ", 
     RowBox[{"(", 
      RowBox[{"nod", "/.", 
       RowBox[{"replace", "[", 
        RowBox[{
         RowBox[{"p", "/@", 
          RowBox[{"{", "f", "}"}]}], ",", 
         RowBox[{"n", "-", "1"}]}], "]"}]}], ")"}]}]}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"numListL", "=", 
   RowBox[{
    RowBox[{"(", 
     RowBox[{"numListL", "/.", 
      RowBox[{
       RowBox[{"F", "[", 
        RowBox[{"p", "[", "i_", "]"}], "]"}], ":>", " ", 
       RowBox[{"F", "[", "i", "]"}]}]}], ")"}], "//", "Expand"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"ppListD", "=", 
   RowBox[{"(", 
    RowBox[{"X2Prop", "/@", "bpeff2"}], ")"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"ppListD", "=", 
   RowBox[{
    RowBox[{"ppListD", "/.", 
     RowBox[{
      RowBox[{"p", "[", "f__", "]"}], "\[RuleDelayed]", 
      RowBox[{"Total", "[", 
       RowBox[{"p", "/@", 
        RowBox[{"{", "f", "}"}]}], "]"}]}]}], "/.", 
    RowBox[{
     RowBox[{"dot", "[", 
      RowBox[{
       RowBox[{"p", "[", "i_", "]"}], ",", 
       RowBox[{"p", "[", "i_", "]"}]}], "]"}], ":>", " ", "0"}]}]}], 
  ";"}], "\n", 
 RowBox[{
  RowBox[{"denAll", "=", 
   RowBox[{"Table", "[", 
    RowBox[{
     RowBox[{"ppListD", "[", 
      RowBox[{"[", "ii", "]"}], "]"}], ",", 
     RowBox[{"{", 
      RowBox[{"ii", ",", 
       RowBox[{"Length", "@", "ppListD"}]}], "}"}]}], "]"}]}], ";"}], "\n", 
 RowBox[{
  RowBox[{"amp5", "=", 
   RowBox[{
    RowBox[{
     RowBox[{"Sum", "[", 
      RowBox[{
       FractionBox[
        RowBox[{"numListL", "[", 
         RowBox[{"[", "ii", "]"}], "]"}], 
        RowBox[{"denAll", "[", 
         RowBox[{"[", "ii", "]"}], "]"}]], ",", 
       RowBox[{"{", 
        RowBox[{"ii", ",", 
         RowBox[{"Length", "@", "ppListD"}]}], "}"}]}], "]"}], "/.", 
     RowBox[{
      RowBox[{"\[Epsilon]", "[", 
       RowBox[{"p", "[", "i_", "]"}], "]"}], ":>", 
      RowBox[{"\[Epsilon]", "[", "i", "]"}]}]}], "//", "Expand"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"amp5", "=", 
   RowBox[{
    RowBox[{
     RowBox[{
      RowBox[{"amp5", "/.", "dotRules"}], "/.", "vponshell"}], "/.", 
     "gponshell"}], "//", "Expand"}]}], ";"}]}], "Input",
 CellChangeTimes->{{3.878022027028722*^9, 3.878022028483653*^9}, {
  3.8780224366059227`*^9, 3.878022442198484*^9}, {3.878022763644738*^9, 
  3.878022823789957*^9}, {3.878022855805319*^9, 3.8780228836038427`*^9}, {
  3.878022958964085*^9, 3.8780229728251*^9}, {3.878025964817404*^9, 
  3.878025974154643*^9}, {3.878032030200883*^9, 3.878032043291239*^9}, {
  3.87807694175404*^9, 3.878076942268965*^9}},
 CellLabel->
  "In[1899]:=",ExpressionUUID->"64955980-6552-4fbe-8bd8-2006ec4384c6"],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
   RowBox[{"X", "[", 
    RowBox[{"1", ",", 
     RowBox[{"X", "[", 
      RowBox[{"2", ",", "3"}], "]"}]}], "]"}], ",", 
   RowBox[{"X", "[", 
    RowBox[{
     RowBox[{"X", "[", 
      RowBox[{"1", ",", "2"}], "]"}], ",", "3"}], "]"}]}], "}"}]], "Output",
 CellChangeTimes->{
  3.8780227866981993`*^9, 3.8780228244290047`*^9, {3.878022856995924*^9, 
   3.878022886712186*^9}, {3.878022959975482*^9, 3.8780229734233837`*^9}, 
   3.878025942910557*^9, 3.878025974822631*^9, 3.87802604880019*^9, 
   3.87802893737528*^9, 3.8780300797739983`*^9, 3.87803201555766*^9, 
   3.878032046557034*^9, 3.8780325721214447`*^9, 3.878075893987146*^9, 
   3.8780808478320103`*^9, 3.878093449603753*^9, 3.878095848723765*^9, 
   3.878097128656351*^9, 3.878106459324299*^9, 3.8781105832067327`*^9, 
   3.8781116321074057`*^9},
 CellLabel->
  "Out[1899]=",ExpressionUUID->"2fc06291-e137-4074-9bbc-42b76ffe37ff"]
}, Open  ]],

Cell[BoxData[{
 RowBox[{
  RowBox[{"num", "=", 
   RowBox[{"\[FivePointedStar]", "[", 
    RowBox[{
     RowBox[{"T", "[", 
      RowBox[{"{", "1", "}"}], "]"}], ",", 
     RowBox[{"T", "[", 
      RowBox[{"{", "2", "}"}], "]"}], ",", 
     RowBox[{"T", "[", 
      RowBox[{"{", "3", "}"}], "]"}]}], "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"nod", "=", 
   RowBox[{
    RowBox[{
     RowBox[{"(", 
      RowBox[{
       RowBox[{
        RowBox[{"num", "/.", 
         RowBox[{"T", "->", "T2F"}]}], "/.", "rmzero"}], "/.", 
       RowBox[{"v", "->", " ", 
        RowBox[{"v", "[", "1", "]"}]}]}], ")"}], "/.", 
     RowBox[{
      RowBox[{"F", "[", "i_", "]"}], ":>", " ", 
      RowBox[{"F", "[", 
       RowBox[{"p", "[", "i", "]"}], "]"}]}]}], "/.", 
    RowBox[{
     RowBox[{"p", "[", 
      RowBox[{"f1_", ",", "g__"}], "]"}], ":>", 
     RowBox[{"P", "[", " ", 
      RowBox[{"Total", "[", 
       RowBox[{"p", "/@", 
        RowBox[{"{", 
         RowBox[{"f1", ",", "g"}], "}"}]}], "]"}], "]"}]}]}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"bpeff2", "=", 
   RowBox[{"BinaryProduct", "[", 
    RowBox[{"Range", "[", 
     RowBox[{"n", "-", "2"}], "]"}], "]"}]}], ";"}], "\n", 
 RowBox[{
  RowBox[{"numList", "=", 
   RowBox[{
    RowBox[{
     RowBox[{"ExpandNCM", "/@", 
      RowBox[{"(", 
       RowBox[{"bpeff2", "/.", 
        RowBox[{"X", "\[Rule]", " ", "NC"}]}], ")"}]}], "/.", 
     RowBox[{"NonCommutativeMultiply", "\[Rule]", " ", "T"}]}], "/.", 
    RowBox[{
     RowBox[{"T", "[", 
      RowBox[{"i1_", ",", "f___"}], "]"}], ":>", " ", 
     RowBox[{"0", "/;", 
      RowBox[{"i1", "\[NotEqual]", "1"}]}]}]}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"numListL", "=", 
   RowBox[{"numList", "/.", 
    RowBox[{
     RowBox[{"T", "[", "f___", "]"}], "\[RuleDelayed]", " ", 
     RowBox[{"(", 
      RowBox[{"nod", "/.", 
       RowBox[{"replace", "[", 
        RowBox[{
         RowBox[{"p", "/@", 
          RowBox[{"{", "f", "}"}]}], ",", 
         RowBox[{"n", "-", "1"}]}], "]"}]}], ")"}]}]}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"numListL", "=", 
   RowBox[{
    RowBox[{"(", 
     RowBox[{"numListL", "/.", 
      RowBox[{
       RowBox[{"F", "[", 
        RowBox[{"p", "[", "i_", "]"}], "]"}], ":>", " ", 
       RowBox[{"F", "[", "i", "]"}]}]}], ")"}], "//", "Expand"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"ppListD", "=", 
   RowBox[{"(", 
    RowBox[{"X2Prop", "/@", "bpeff2"}], ")"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"ppListD", "=", 
   RowBox[{
    RowBox[{"ppListD", "/.", 
     RowBox[{
      RowBox[{"p", "[", "f__", "]"}], "\[RuleDelayed]", 
      RowBox[{"Total", "[", 
       RowBox[{"p", "/@", 
        RowBox[{"{", "f", "}"}]}], "]"}]}]}], "/.", 
    RowBox[{
     RowBox[{"dot", "[", 
      RowBox[{
       RowBox[{"p", "[", "i_", "]"}], ",", 
       RowBox[{"p", "[", "i_", "]"}]}], "]"}], ":>", " ", "0"}]}]}], 
  ";"}], "\n", 
 RowBox[{
  RowBox[{"denAll", "=", 
   RowBox[{"Table", "[", 
    RowBox[{
     RowBox[{"ppListD", "[", 
      RowBox[{"[", "ii", "]"}], "]"}], ",", 
     RowBox[{"{", 
      RowBox[{"ii", ",", 
       RowBox[{"Length", "@", "ppListD"}]}], "}"}]}], "]"}]}], ";"}], "\n", 
 RowBox[{
  RowBox[{"ampYM", "=", 
   RowBox[{
    RowBox[{
     RowBox[{"Sum", "[", 
      RowBox[{
       FractionBox[
        RowBox[{"numListL", "[", 
         RowBox[{"[", "ii", "]"}], "]"}], 
        RowBox[{"denAll", "[", 
         RowBox[{"[", "ii", "]"}], "]"}]], ",", 
       RowBox[{"{", 
        RowBox[{"ii", ",", 
         RowBox[{"Length", "@", "ppListD"}]}], "}"}]}], "]"}], "/.", 
     RowBox[{
      RowBox[{"P", "[", "f_", "]"}], ":>", "f"}]}], "//", "Expand"}]}], 
  ";"}]}], "Input",
 CellChangeTimes->{{3.878023857740679*^9, 3.878023860158512*^9}, {
   3.87802396296658*^9, 3.878024017862441*^9}, {3.878024052254986*^9, 
   3.878024058839876*^9}, {3.8780241059261007`*^9, 3.8780241103419027`*^9}, {
   3.878024288644836*^9, 3.8780243205537767`*^9}, 3.878076927512285*^9},
 CellLabel->
  "In[1908]:=",ExpressionUUID->"73d361bc-fb21-4cc6-b858-1081cb7d7c28"],

Cell[BoxData[{
 RowBox[{
  RowBox[{"ampYM", "=", 
   RowBox[{
    RowBox[{"(", 
     RowBox[{
      RowBox[{
       RowBox[{
        RowBox[{
         RowBox[{"(", 
          RowBox[{"ampYM", "//", "expandFS"}], ")"}], "/.", "dotRules"}], "/.",
         "vponshell"}], "/.", "gponshell"}], "//", "Expand"}], ")"}], "//", 
    "MultivariateApart"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"ampYMGlueNum3", "=", 
   RowBox[{
    RowBox[{
     RowBox[{
      RowBox[{
       RowBox[{"ampYM", "/.", 
        RowBox[{"{", 
         RowBox[{
          RowBox[{
           RowBox[{"dot", "[", 
            RowBox[{
             RowBox[{"v", "[", "1", "]"}], ",", "f_"}], "]"}], ":>", 
           RowBox[{"dot", "[", 
            RowBox[{
             RowBox[{
              RowBox[{"p", "[", "1", "]"}], "+", 
              RowBox[{"p", "[", "2", "]"}], "+", 
              RowBox[{"p", "[", "3", "]"}]}], ",", 
             RowBox[{"S", "[", "0", "]"}], ",", "f"}], "]"}]}], ",", 
          RowBox[{
           RowBox[{"dot", "[", 
            RowBox[{"f_", ",", 
             RowBox[{"v", "[", "1", "]"}]}], "]"}], ":>", 
           RowBox[{"dot", "[", 
            RowBox[{
             RowBox[{
              RowBox[{"p", "[", "1", "]"}], "+", 
              RowBox[{"p", "[", "2", "]"}], "+", 
              RowBox[{"p", "[", "3", "]"}]}], ",", 
             RowBox[{"S", "[", "0", "]"}], ",", "f"}], "]"}]}]}], "}"}]}], "/.",
        "dotRules"}], "/.", "vponshell"}], "/.", "gponshell"}], "//", 
    "Expand"}]}], ";"}]}], "Input",
 CellChangeTimes->{{3.878024069941125*^9, 3.87802415205725*^9}, {
   3.878024331157475*^9, 3.878024340048336*^9}, {3.8780243883823147`*^9, 
   3.87802443440853*^9}, {3.878024623562881*^9, 3.878024662661223*^9}, {
   3.878024820522764*^9, 3.878024839044957*^9}, {3.878025373216962*^9, 
   3.878025408461379*^9}, {3.878025474618256*^9, 3.878025484493874*^9}, 
   3.878025529761257*^9, {3.8780757748389797`*^9, 3.878075783185919*^9}, 
   3.878075831065405*^9},
 CellLabel->
  "In[1918]:=",ExpressionUUID->"f0029f32-d8bd-46d4-b155-35b3b8e77226"],

Cell[BoxData[
 RowBox[{
  RowBox[{"comp", "=", 
   RowBox[{
    RowBox[{"amp5", "-", "ampYMGlueNum3"}], "//", "Expand"}]}], 
  ";"}]], "Input",
 CellLabel->
  "In[1920]:=",ExpressionUUID->"fa9a6a87-0b37-407a-9714-0c09c4d26928"],

Cell[BoxData[
 RowBox[{
  RowBox[{"cvars", "=", 
   RowBox[{
    RowBox[{"Cases", "[", 
     RowBox[{"comp", ",", 
      RowBox[{"c", "[", "__", "]"}], ",", 
      RowBox[{"{", 
       RowBox[{"0", ",", "\[Infinity]"}], "}"}]}], "]"}], "//", "Union"}]}], 
  ";"}]], "Input",
 CellChangeTimes->{{3.8780251119523973`*^9, 3.87802515275441*^9}, {
  3.878033238685581*^9, 3.8780332388754597`*^9}, {3.87807596060207*^9, 
  3.878075960778406*^9}},
 CellLabel->
  "In[1921]:=",ExpressionUUID->"2f8618e3-2ecf-46ed-86be-a8da3f993eb9"],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"cvars", "//", "Length"}]], "Input",
 CellChangeTimes->{{3.878025163562392*^9, 3.878025164327901*^9}},
 CellLabel->
  "In[1922]:=",ExpressionUUID->"80c636eb-b91d-4e62-8904-ae38cfaf70be"],

Cell[BoxData["450"], "Output",
 CellChangeTimes->{3.87802516477238*^9, 3.878026076988738*^9, 
  3.878028973567272*^9, 3.8780301059729843`*^9, 3.87803208614393*^9, 
  3.878033255460141*^9, 3.878075964691884*^9, 3.878080856512931*^9, 
  3.878093458365816*^9, 3.878095857461788*^9, 3.878097147230905*^9, 
  3.878106478590885*^9, 3.878110601198616*^9, 3.878111637934287*^9},
 CellLabel->
  "Out[1922]=",ExpressionUUID->"9af28cb3-19ba-4d93-9fbb-547e1e11b9a9"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{
  RowBox[{"vardot", "=", 
   RowBox[{"comp", "//", "Casesdot"}]}], ";"}], "\n", 
 RowBox[{
  RowBox[{"dot2num", ":=", 
   RowBox[{"Table", "[", 
    RowBox[{
     RowBox[{"Rule", "[", 
      RowBox[{
       RowBox[{"vardot", "[", 
        RowBox[{"[", "ii", "]"}], "]"}], ",", 
       RowBox[{"RandomInteger", "[", 
        RowBox[{"{", 
         RowBox[{"10", ",", "100"}], "}"}], "]"}]}], "]"}], ",", 
     RowBox[{"{", 
      RowBox[{"ii", ",", 
       RowBox[{"Length", "[", "vardot", "]"}]}], "}"}]}], "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{"Monitor", "[", 
  RowBox[{
   RowBox[{
    RowBox[{"eqDep", "=", 
     RowBox[{"Table", "[", 
      RowBox[{
       RowBox[{
        RowBox[{"comp", "\[Equal]", "0"}], "/.", "dot2num"}], ",", 
       RowBox[{"{", 
        RowBox[{"ii", ",", 
         RowBox[{"10", "+", 
          RowBox[{"Length", "[", "cvars", "]"}]}]}], "}"}]}], "]"}]}], ";"}], 
   ",", "ii"}], "]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"sols", "=", 
   RowBox[{
    RowBox[{"Solve", "[", 
     RowBox[{"eqDep", ",", "cvars"}], "]"}], "[", 
    RowBox[{"[", "1", "]"}], "]"}]}], ";"}]}], "Input",
 CellChangeTimes->{{3.878025083563089*^9, 3.878025098342598*^9}, {
  3.87802516936078*^9, 3.878025185960835*^9}, {3.878033243467019*^9, 
  3.8780332467055893`*^9}, {3.8780759694484453`*^9, 3.878075974363841*^9}},
 CellLabel->
  "In[1923]:=",ExpressionUUID->"cd0f0334-06ee-4f03-ad4a-dccea1959155"],

Cell[BoxData[
 TemplateBox[{
  "Solve", "svars", 
   "\"Equations may not give solutions for all \\\"solve\\\" variables.\"", 2,
    1926, 88, 28410112452836994704, "Local"},
  "MessageTemplate"]], "Message", "MSG",
 CellChangeTimes->{3.87802613489694*^9, 3.878029156688776*^9, 
  3.8780303199023113`*^9, 3.8780322863051863`*^9, 3.878032831294737*^9, 
  3.878033318277973*^9, 3.878076165657085*^9, 3.8780810434805603`*^9, 
  3.878093646396821*^9, 3.878096045334003*^9, 3.878097342954261*^9, 
  3.878106566447481*^9, 3.878110634586054*^9, 3.878111723288245*^9},
 CellLabel->
  "During evaluation of \
In[1923]:=",ExpressionUUID->"d4f00f4a-1355-4181-96b7-6a3f656d925c"]
}, Open  ]]
}, Closed]],

Cell[CellGroupData[{

Cell["Factorisation condition v.p1", "Subsection",
 CellChangeTimes->{{3.878076748965989*^9, 3.878076767862722*^9}, {
  3.87809373543461*^9, 
  3.8780937386875668`*^9}},ExpressionUUID->"e55fa114-6f3f-4e57-9042-\
2adbdd39a286"],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{
  RowBox[{"numAnsatz2", "=", 
   RowBox[{
    RowBox[{
     RowBox[{
      RowBox[{
       RowBox[{"(", 
        RowBox[{"ansatzIdp", "//", "expandFS"}], ")"}], "//.", "dotRules"}], "/.", 
      RowBox[{"(", 
       RowBox[{
        RowBox[{"vonshell", "[", 
         RowBox[{
          RowBox[{"n", "-", "1"}], ",", "3"}], "]"}], "/.", 
        RowBox[{"v", "->", 
         RowBox[{"v", "[", "1", "]"}]}]}], ")"}]}], "/.", "sols"}], "//", 
    "Expand"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{"%", "//", "Length"}]}], "Input",
 CellChangeTimes->{{3.878076776346158*^9, 3.878076791822427*^9}, {
   3.878076863747164*^9, 3.8780768651784353`*^9}, {3.878077446334421*^9, 
   3.878077450450157*^9}, 3.878080568874198*^9, 3.878080843522138*^9, {
   3.878084931218405*^9, 3.8780849369136047`*^9}, {3.878085107286035*^9, 
   3.878085112014679*^9}, {3.8780852927862673`*^9, 3.878085294285921*^9}, 
   3.878110691065761*^9},
 CellLabel->
  "In[1927]:=",ExpressionUUID->"e81780ce-5cdc-4297-b96c-d10168de938e"],

Cell[BoxData["2236"], "Output",
 CellChangeTimes->{{3.87807677960294*^9, 3.878076792387086*^9}, 
   3.878076869394702*^9, 3.878077463656658*^9, 3.878080582971023*^9, 
   3.878081061748372*^9, 3.878084951014349*^9, 3.878085126532173*^9, 
   3.878085312641127*^9, 3.878093665706396*^9, 3.87809605896621*^9, 
   3.878106580691216*^9, 3.8781106485337143`*^9, 3.878110695981309*^9, 
   3.878111727924831*^9},
 CellLabel->
  "Out[1928]=",ExpressionUUID->"b629d2e4-6c0e-439e-bab6-f6de1db14116"]
}, Open  ]],

Cell[BoxData[
 RowBox[{
  RowBox[{"numAnsatzvp1", "=", 
   RowBox[{
    RowBox[{
     RowBox[{
      RowBox[{"(", 
       RowBox[{
        RowBox[{
         RowBox[{"(", 
          RowBox[{"numAnsatz2", "//", 
           RowBox[{"Cases", "[", 
            RowBox[{"Times", "[", 
             RowBox[{"f___", ",", 
              RowBox[{"Power", "[", 
               RowBox[{
                RowBox[{"dot", "[", 
                 RowBox[{
                  RowBox[{"p", "[", "1", "]"}], ",", 
                  RowBox[{"v", "[", "1", "]"}]}], "]"}], ",", 
                RowBox[{"-", "1"}]}], "]"}], ",", "g___"}], "]"}], "]"}]}], 
          ")"}], "/.", 
         RowBox[{
          RowBox[{"Power", "[", 
           RowBox[{
            RowBox[{"dot", "[", 
             RowBox[{
              RowBox[{"p", "[", "1", "]"}], ",", 
              RowBox[{"v", "[", "1", "]"}]}], "]"}], ",", 
            RowBox[{"-", "1"}]}], "]"}], "->", "1"}]}], "//", "Total"}], 
       ")"}], "//.", "dotRules"}], "/.", "vponshell"}], "/.", 
    RowBox[{"{", 
     RowBox[{
      RowBox[{
       RowBox[{"dot", "[", 
        RowBox[{
         RowBox[{"p", "[", "1", "]"}], ",", 
         RowBox[{"v", "[", "1", "]"}]}], "]"}], "->", "0"}], ",", 
      RowBox[{
       RowBox[{"dot", "[", 
        RowBox[{
         RowBox[{"p", "[", "2", "]"}], ",", 
         RowBox[{"v", "[", "1", "]"}]}], "]"}], "->", 
       RowBox[{"-", 
        RowBox[{"dot", "[", 
         RowBox[{
          RowBox[{"p", "[", "3", "]"}], ",", 
          RowBox[{"v", "[", "1", "]"}]}], "]"}]}]}]}], "}"}]}]}], 
  ";"}]], "Input",
 CellChangeTimes->{{3.878077052129978*^9, 3.878077125591745*^9}, {
   3.878077237157652*^9, 3.878077281353335*^9}, {3.8780773702267103`*^9, 
   3.8780774435353603`*^9}, {3.8780774739935207`*^9, 3.8780775017717133`*^9}, 
   3.878079930873101*^9, 3.878079973240665*^9, {3.878085415182927*^9, 
   3.8780854153236303`*^9}, 3.878085446328352*^9},
 CellLabel->
  "In[1929]:=",ExpressionUUID->"a2717930-937a-4c21-aa88-03ba76c7d98d"],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"numAnsatzvp1", "//", "Length"}]], "Input",
 CellChangeTimes->{{3.878085457345728*^9, 3.878085458484248*^9}},
 CellLabel->
  "In[1930]:=",ExpressionUUID->"d6d6b0b1-34aa-474e-b397-fdc6b3f8d865"],

Cell[BoxData["1284"], "Output",
 CellChangeTimes->{{3.878085424115284*^9, 3.8780854589677*^9}, 
   3.878093671135722*^9, 3.878096059862764*^9, 3.878106585270012*^9, 
   3.87811065554213*^9, 3.878110701360381*^9, 3.878111728327223*^9},
 CellLabel->
  "Out[1930]=",ExpressionUUID->"d0f5fa43-f012-468f-8500-5967ecbe822f"]
}, Open  ]],

Cell[BoxData[{
 RowBox[{
  RowBox[{"num1", "=", 
   RowBox[{
    RowBox[{
     RowBox[{"T", "[", 
      RowBox[{"{", "1", "}"}], "]"}], "/.", 
     RowBox[{"T", "->", "T2F"}]}], "/.", 
    RowBox[{"v", "->", 
     RowBox[{"v", "[", "1", "]"}]}]}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"num2", "=", 
   RowBox[{"(", 
    RowBox[{
     FractionBox[
      RowBox[{"dot", "[", 
       RowBox[{
        RowBox[{"p", "[", "2", "]"}], ",", 
        RowBox[{"S", "[", "0", "]"}], ",", 
        RowBox[{"F", "[", "2", "]"}], ",", 
        RowBox[{"F", "[", "3", "]"}], ",", 
        RowBox[{"v", "[", "1", "]"}]}], "]"}], 
      RowBox[{"dot", "[", 
       RowBox[{
        RowBox[{"p", "[", "2", "]"}], ",", 
        RowBox[{"v", "[", "1", "]"}]}], "]"}]], "+", 
     FractionBox[
      RowBox[{"dot", "[", 
       RowBox[{
        RowBox[{"p", "[", "2", "]"}], ",", 
        RowBox[{"S", "[", "0", "]"}], ",", 
        RowBox[{"F", "[", "3", "]"}], ",", 
        RowBox[{"F", "[", "2", "]"}], ",", 
        RowBox[{"v", "[", "1", "]"}]}], "]"}], 
      RowBox[{"dot", "[", 
       RowBox[{
        RowBox[{"p", "[", "2", "]"}], ",", 
        RowBox[{"v", "[", "1", "]"}]}], "]"}]], "-", 
     FractionBox[
      RowBox[{"dot", "[", 
       RowBox[{
        RowBox[{"p", "[", "2", "]"}], ",", 
        RowBox[{"F", "[", "3", "]"}], ",", 
        RowBox[{"S", "[", "0", "]"}], ",", 
        RowBox[{"F", "[", "2", "]"}], ",", 
        RowBox[{"v", "[", "1", "]"}]}], "]"}], 
      RowBox[{"dot", "[", 
       RowBox[{
        RowBox[{"p", "[", "2", "]"}], ",", 
        RowBox[{"v", "[", "1", "]"}]}], "]"}]], "+", 
     FractionBox[
      RowBox[{"dot", "[", 
       RowBox[{
        RowBox[{"p", "[", "3", "]"}], ",", 
        RowBox[{"S", "[", "0", "]"}], ",", 
        RowBox[{"F", "[", "3", "]"}], ",", 
        RowBox[{"F", "[", "2", "]"}], ",", 
        RowBox[{"v", "[", "1", "]"}]}], "]"}], 
      RowBox[{"dot", "[", 
       RowBox[{
        RowBox[{"p", "[", "2", "]"}], ",", 
        RowBox[{"v", "[", "1", "]"}]}], "]"}]]}], ")"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"numvp1", "=", 
   RowBox[{
    RowBox[{
     RowBox[{
      RowBox[{
       RowBox[{"dot", "[", 
        RowBox[{
         RowBox[{"p", "[", "1", "]"}], ",", 
         RowBox[{"p", "[", "2", "]"}]}], "]"}], 
       RowBox[{"(", 
        RowBox[{
         RowBox[{
          RowBox[{"-", "num1"}], "*", "num2"}], "-", 
         RowBox[{
          FractionBox["1", 
           RowBox[{"dot", "[", 
            RowBox[{
             RowBox[{"p", "[", "2", "]"}], ",", 
             RowBox[{"v", "[", "1", "]"}]}], "]"}]], 
          RowBox[{"dot", "[", 
           RowBox[{
            RowBox[{"p", "[", "1", "]"}], ",", 
            RowBox[{"S", "[", "0", "]"}], ",", 
            RowBox[{"\[Epsilon]", "[", "1", "]"}]}], "]"}], "*", 
          RowBox[{"dot", "[", 
           RowBox[{
            RowBox[{"v", "[", "1", "]"}], ",", 
            RowBox[{"F", "[", "2", "]"}], ",", 
            RowBox[{"F", "[", "3", "]"}], ",", 
            RowBox[{"v", "[", "1", "]"}]}], "]"}]}]}], ")"}]}], "//.", 
      "dotRules"}], "//", "expandFS"}], "//", "Expand"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"numvp1", "=", 
   RowBox[{
    RowBox[{
     RowBox[{"numvp1", "//.", "dotRules"}], "/.", "vponshell"}], "/.", 
    RowBox[{"{", 
     RowBox[{
      RowBox[{
       RowBox[{"dot", "[", 
        RowBox[{
         RowBox[{"p", "[", "1", "]"}], ",", 
         RowBox[{"v", "[", "1", "]"}]}], "]"}], "->", "0"}], ",", 
      RowBox[{
       RowBox[{"dot", "[", 
        RowBox[{
         RowBox[{"p", "[", "2", "]"}], ",", 
         RowBox[{"v", "[", "1", "]"}]}], "]"}], "->", 
       RowBox[{"-", 
        RowBox[{"dot", "[", 
         RowBox[{
          RowBox[{"p", "[", "3", "]"}], ",", 
          RowBox[{"v", "[", "1", "]"}]}], "]"}]}]}]}], "}"}]}]}], 
  ";"}]}], "Input",
 CellChangeTimes->{{3.878077591985273*^9, 3.8780776461342783`*^9}, {
   3.878077953502172*^9, 3.878077980733405*^9}, {3.878078491930747*^9, 
   3.878078549563458*^9}, {3.878078580745262*^9, 3.87807865251903*^9}, 
   3.878078684800146*^9, {3.878079206140265*^9, 3.878079212664543*^9}, {
   3.878079938416065*^9, 3.8780799390210323`*^9}, {3.878079982854789*^9, 
   3.878079996138009*^9}, 3.878080718496252*^9, 3.878080776110016*^9, {
   3.878081116226698*^9, 3.8780811179219093`*^9}, {3.878081897887516*^9, 
   3.878081929737031*^9}, {3.8780819770250673`*^9, 3.8780819885274878`*^9}, 
   3.8780820357161922`*^9, {3.878082093586617*^9, 3.878082094494379*^9}, 
   3.878082200584118*^9, 3.8780823524734297`*^9, 3.8780843780876017`*^9, {
   3.87808451838385*^9, 3.878084553403726*^9}, {3.878084767872551*^9, 
   3.878084809993238*^9}, {3.878093413770879*^9, 3.878093418381057*^9}, {
   3.878106594481743*^9, 3.878106602977435*^9}},
 CellLabel->
  "In[1931]:=",ExpressionUUID->"ad67a268-49c9-4fc2-a2e7-1202cf0c7c53"],

Cell[BoxData[
 RowBox[{
  RowBox[{"compvp1", "=", 
   RowBox[{"numAnsatzvp1", "-", "numvp1"}]}], ";"}]], "Input",
 CellChangeTimes->{{3.8780781147500143`*^9, 3.878078179889933*^9}, {
   3.878078714167301*^9, 3.878078719908218*^9}, {3.878078864983605*^9, 
   3.8780788894932623`*^9}, 3.878079927920136*^9, 3.87808000213634*^9},
 CellLabel->
  "In[1935]:=",ExpressionUUID->"72f44ea0-a346-4471-b32e-dfefbb0d6428"],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  RowBox[{"4", " ", 
   RowBox[{
    SubscriptBox["p", "1"], "\[CenterDot]", "S", "\[CenterDot]", 
    SubscriptBox["F", "1"], "\[CenterDot]", 
    SubscriptBox["F", "2"], "\[CenterDot]", "v"}]}], "+", 
  RowBox[{"4", 
   RowBox[{
    SubscriptBox["p", "1"], "\[CenterDot]", "S", "\[CenterDot]", 
    SubscriptBox["F", "2"], "\[CenterDot]", 
    SubscriptBox["F", "1"], "\[CenterDot]", "v"}]}], "-", 
  RowBox[{"4", " ", 
   RowBox[{
    SubscriptBox["p", "1"], "\[CenterDot]", 
    SubscriptBox["F", "2"], "\[CenterDot]", "S", "\[CenterDot]", 
    SubscriptBox["F", "1"], "\[CenterDot]", "v"}]}], "+", 
  RowBox[{"4", " ", 
   RowBox[{
    SubscriptBox["p", "2"], "\[CenterDot]", "S", "\[CenterDot]", 
    SubscriptBox["F", "2"], "\[CenterDot]", 
    SubscriptBox["F", "1"], "\[CenterDot]", "v"}]}]}]], "Input",
 CellChangeTimes->{{3.878078468972107*^9, 3.8780784821254663`*^9}},
 CellLabel->
  "In[1936]:=",ExpressionUUID->"815cf49c-0a7b-4689-98f1-ef3527fcb2f8"],

Cell[BoxData[
 RowBox[{
  RowBox[{"4", " ", 
   RowBox[{
    SubscriptBox["p", "1"], "\[CenterDot]", "S", "\[CenterDot]", 
    SubscriptBox["F", "1"], "\[CenterDot]", 
    SubscriptBox["F", "2"], "\[CenterDot]", "v"}]}], "+", 
  RowBox[{"4", " ", 
   RowBox[{
    SubscriptBox["p", "1"], "\[CenterDot]", "S", "\[CenterDot]", 
    SubscriptBox["F", "2"], "\[CenterDot]", 
    SubscriptBox["F", "1"], "\[CenterDot]", "v"}]}], "-", 
  RowBox[{"4", " ", 
   RowBox[{
    SubscriptBox["p", "1"], "\[CenterDot]", 
    SubscriptBox["F", "2"], "\[CenterDot]", "S", "\[CenterDot]", 
    SubscriptBox["F", "1"], "\[CenterDot]", "v"}]}], "+", 
  RowBox[{"4", " ", 
   RowBox[{
    SubscriptBox["p", "2"], "\[CenterDot]", "S", "\[CenterDot]", 
    SubscriptBox["F", "2"], "\[CenterDot]", 
    SubscriptBox["F", "1"], "\[CenterDot]", "v"}]}]}]], "Output",
 CellChangeTimes->{3.878096059926221*^9, 3.878111728391625*^9},
 CellLabel->
  "Out[1936]=",ExpressionUUID->"becd841a-d5dc-44e2-b991-a5fc942855dd"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"compvp1", "//", "Casesdot"}]], "Input",
 CellChangeTimes->{{3.8780788203554583`*^9, 3.878078825352446*^9}},
 CellLabel->
  "In[1937]:=",ExpressionUUID->"a0181419-1fa1-46e1-92f1-89bc97129c7a"],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
   RowBox[{"dot", "[", 
    RowBox[{
     RowBox[{"p", "[", "1", "]"}], ",", 
     RowBox[{"p", "[", "2", "]"}]}], "]"}], ",", 
   RowBox[{"dot", "[", 
    RowBox[{
     RowBox[{"p", "[", "1", "]"}], ",", 
     RowBox[{"p", "[", "3", "]"}]}], "]"}], ",", 
   RowBox[{"dot", "[", 
    RowBox[{
     RowBox[{"p", "[", "1", "]"}], ",", 
     RowBox[{"\[Epsilon]", "[", "2", "]"}]}], "]"}], ",", 
   RowBox[{"dot", "[", 
    RowBox[{
     RowBox[{"p", "[", "1", "]"}], ",", 
     RowBox[{"\[Epsilon]", "[", "3", "]"}]}], "]"}], ",", 
   RowBox[{"dot", "[", 
    RowBox[{
     RowBox[{"p", "[", "2", "]"}], ",", 
     RowBox[{"p", "[", "3", "]"}]}], "]"}], ",", 
   RowBox[{"dot", "[", 
    RowBox[{
     RowBox[{"p", "[", "2", "]"}], ",", 
     RowBox[{"\[Epsilon]", "[", "1", "]"}]}], "]"}], ",", 
   RowBox[{"dot", "[", 
    RowBox[{
     RowBox[{"p", "[", "2", "]"}], ",", 
     RowBox[{"\[Epsilon]", "[", "3", "]"}]}], "]"}], ",", 
   RowBox[{"dot", "[", 
    RowBox[{
     RowBox[{"p", "[", "3", "]"}], ",", 
     RowBox[{"v", "[", "1", "]"}]}], "]"}], ",", 
   RowBox[{"dot", "[", 
    RowBox[{
     RowBox[{"p", "[", "3", "]"}], ",", 
     RowBox[{"\[Epsilon]", "[", "1", "]"}]}], "]"}], ",", 
   RowBox[{"dot", "[", 
    RowBox[{
     RowBox[{"p", "[", "3", "]"}], ",", 
     RowBox[{"\[Epsilon]", "[", "2", "]"}]}], "]"}], ",", 
   RowBox[{"dot", "[", 
    RowBox[{
     RowBox[{"v", "[", "1", "]"}], ",", 
     RowBox[{"\[Epsilon]", "[", "1", "]"}]}], "]"}], ",", 
   RowBox[{"dot", "[", 
    RowBox[{
     RowBox[{"v", "[", "1", "]"}], ",", 
     RowBox[{"\[Epsilon]", "[", "2", "]"}]}], "]"}], ",", 
   RowBox[{"dot", "[", 
    RowBox[{
     RowBox[{"v", "[", "1", "]"}], ",", 
     RowBox[{"\[Epsilon]", "[", "3", "]"}]}], "]"}], ",", 
   RowBox[{"dot", "[", 
    RowBox[{
     RowBox[{"\[Epsilon]", "[", "1", "]"}], ",", 
     RowBox[{"\[Epsilon]", "[", "2", "]"}]}], "]"}], ",", 
   RowBox[{"dot", "[", 
    RowBox[{
     RowBox[{"\[Epsilon]", "[", "1", "]"}], ",", 
     RowBox[{"\[Epsilon]", "[", "3", "]"}]}], "]"}], ",", 
   RowBox[{"dot", "[", 
    RowBox[{
     RowBox[{"\[Epsilon]", "[", "2", "]"}], ",", 
     RowBox[{"\[Epsilon]", "[", "3", "]"}]}], "]"}], ",", 
   RowBox[{"dot", "[", 
    RowBox[{
     RowBox[{"p", "[", "1", "]"}], ",", 
     RowBox[{"S", "[", "0", "]"}], ",", 
     RowBox[{"p", "[", "2", "]"}]}], "]"}], ",", 
   RowBox[{"dot", "[", 
    RowBox[{
     RowBox[{"p", "[", "1", "]"}], ",", 
     RowBox[{"S", "[", "0", "]"}], ",", 
     RowBox[{"p", "[", "3", "]"}]}], "]"}], ",", 
   RowBox[{"dot", "[", 
    RowBox[{
     RowBox[{"p", "[", "1", "]"}], ",", 
     RowBox[{"S", "[", "0", "]"}], ",", 
     RowBox[{"\[Epsilon]", "[", "1", "]"}]}], "]"}], ",", 
   RowBox[{"dot", "[", 
    RowBox[{
     RowBox[{"p", "[", "1", "]"}], ",", 
     RowBox[{"S", "[", "0", "]"}], ",", 
     RowBox[{"\[Epsilon]", "[", "2", "]"}]}], "]"}], ",", 
   RowBox[{"dot", "[", 
    RowBox[{
     RowBox[{"p", "[", "1", "]"}], ",", 
     RowBox[{"S", "[", "0", "]"}], ",", 
     RowBox[{"\[Epsilon]", "[", "3", "]"}]}], "]"}], ",", 
   RowBox[{"dot", "[", 
    RowBox[{
     RowBox[{"p", "[", "2", "]"}], ",", 
     RowBox[{"S", "[", "0", "]"}], ",", 
     RowBox[{"p", "[", "3", "]"}]}], "]"}], ",", 
   RowBox[{"dot", "[", 
    RowBox[{
     RowBox[{"p", "[", "2", "]"}], ",", 
     RowBox[{"S", "[", "0", "]"}], ",", 
     RowBox[{"\[Epsilon]", "[", "1", "]"}]}], "]"}], ",", 
   RowBox[{"dot", "[", 
    RowBox[{
     RowBox[{"p", "[", "2", "]"}], ",", 
     RowBox[{"S", "[", "0", "]"}], ",", 
     RowBox[{"\[Epsilon]", "[", "2", "]"}]}], "]"}], ",", 
   RowBox[{"dot", "[", 
    RowBox[{
     RowBox[{"p", "[", "2", "]"}], ",", 
     RowBox[{"S", "[", "0", "]"}], ",", 
     RowBox[{"\[Epsilon]", "[", "3", "]"}]}], "]"}], ",", 
   RowBox[{"dot", "[", 
    RowBox[{
     RowBox[{"p", "[", "3", "]"}], ",", 
     RowBox[{"S", "[", "0", "]"}], ",", 
     RowBox[{"\[Epsilon]", "[", "1", "]"}]}], "]"}], ",", 
   RowBox[{"dot", "[", 
    RowBox[{
     RowBox[{"p", "[", "3", "]"}], ",", 
     RowBox[{"S", "[", "0", "]"}], ",", 
     RowBox[{"\[Epsilon]", "[", "2", "]"}]}], "]"}], ",", 
   RowBox[{"dot", "[", 
    RowBox[{
     RowBox[{"p", "[", "3", "]"}], ",", 
     RowBox[{"S", "[", "0", "]"}], ",", 
     RowBox[{"\[Epsilon]", "[", "3", "]"}]}], "]"}], ",", 
   RowBox[{"dot", "[", 
    RowBox[{
     RowBox[{"\[Epsilon]", "[", "1", "]"}], ",", 
     RowBox[{"S", "[", "0", "]"}], ",", 
     RowBox[{"\[Epsilon]", "[", "2", "]"}]}], "]"}], ",", 
   RowBox[{"dot", "[", 
    RowBox[{
     RowBox[{"\[Epsilon]", "[", "1", "]"}], ",", 
     RowBox[{"S", "[", "0", "]"}], ",", 
     RowBox[{"\[Epsilon]", "[", "3", "]"}]}], "]"}], ",", 
   RowBox[{"dot", "[", 
    RowBox[{
     RowBox[{"\[Epsilon]", "[", "2", "]"}], ",", 
     RowBox[{"S", "[", "0", "]"}], ",", 
     RowBox[{"\[Epsilon]", "[", "3", "]"}]}], "]"}]}], "}"}]], "Output",
 CellChangeTimes->{3.8780787909855328`*^9, 3.878078825754147*^9, 
  3.8780789139500523`*^9, 3.878079583885482*^9, 3.8780807366766977`*^9, 
  3.87808078442798*^9, 3.878096059944249*^9, 3.878111728404121*^9},
 CellLabel->
  "Out[1937]=",ExpressionUUID->"886008dd-cbb6-414c-8cf3-147d49ab8223"]
}, Open  ]],

Cell[BoxData[{
 RowBox[{
  RowBox[{"cvars", "=", 
   RowBox[{
    RowBox[{"Cases", "[", 
     RowBox[{"compvp1", ",", 
      RowBox[{"c", "[", "__", "]"}], ",", 
      RowBox[{"{", 
       RowBox[{"0", ",", "\[Infinity]"}], "}"}]}], "]"}], "//", "Union"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"vardot", "=", 
   RowBox[{"compvp1", "//", "Casesdot"}]}], ";"}]}], "Input",
 CellChangeTimes->{{3.878078218083035*^9, 3.878078227195683*^9}},
 CellLabel->
  "In[1938]:=",ExpressionUUID->"1e88fb7c-d5f5-4931-a279-7e05550291fd"],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"cvars", "//", "Length"}]], "Input",
 CellChangeTimes->{{3.878078250405406*^9, 3.8780782515980988`*^9}, 
   3.8780793030421352`*^9, {3.878080618122617*^9, 3.878080619511405*^9}},
 CellLabel->
  "In[1940]:=",ExpressionUUID->"a79df089-ed2d-4ded-a266-1b17d479c9a2"],

Cell[BoxData["263"], "Output",
 CellChangeTimes->{
  3.878078252063862*^9, 3.878078732430634*^9, {3.8780792683050127`*^9, 
   3.878079303531766*^9}, {3.8780806116761723`*^9, 3.878080620497012*^9}, 
   3.878080793272333*^9, 3.8780810935750732`*^9, 3.8780811318686132`*^9, 
   3.878081941084124*^9, 3.8780820011325197`*^9, 3.878082120982493*^9, 
   3.878084828486793*^9, 3.878085517830093*^9, 3.878093680935251*^9, 
   3.878096059965028*^9, 3.878106611890305*^9, 3.8781106661833277`*^9, 
   3.878110711119144*^9, 3.878111728424964*^9},
 CellLabel->
  "Out[1940]=",ExpressionUUID->"faf0c90a-3fc2-4a97-8e32-f7765ef2590d"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{
  RowBox[{"dot2num", ":=", 
   RowBox[{"Table", "[", 
    RowBox[{
     RowBox[{"Rule", "[", 
      RowBox[{
       RowBox[{"vardot", "[", 
        RowBox[{"[", "ii", "]"}], "]"}], ",", 
       RowBox[{"RandomInteger", "[", 
        RowBox[{"{", 
         RowBox[{"10", ",", "100"}], "}"}], "]"}]}], "]"}], ",", 
     RowBox[{"{", 
      RowBox[{"ii", ",", 
       RowBox[{"Length", "[", "vardot", "]"}]}], "}"}]}], "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{"Monitor", "[", 
  RowBox[{
   RowBox[{
    RowBox[{"eqDep", "=", 
     RowBox[{"Table", "[", 
      RowBox[{
       RowBox[{
        RowBox[{"compvp1", "\[Equal]", "0"}], "/.", "dot2num"}], ",", 
       RowBox[{"{", 
        RowBox[{"ii", ",", 
         RowBox[{"10", "+", 
          RowBox[{"Length", "[", "cvars", "]"}]}]}], "}"}]}], "]"}]}], ";"}], 
   ",", "ii"}], "]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"solsvp1", "=", 
   RowBox[{
    RowBox[{"Solve", "[", 
     RowBox[{"eqDep", ",", "cvars"}], "]"}], "[", 
    RowBox[{"[", "1", "]"}], "]"}]}], ";"}]}], "Input",
 CellChangeTimes->{{3.878078221639757*^9, 3.878078240954069*^9}, {
  3.878081064658252*^9, 3.8780810690042477`*^9}},
 CellLabel->
  "In[1941]:=",ExpressionUUID->"1f712311-4975-4ed6-a7d3-09ae1c6a31d7"],

Cell[BoxData[
 TemplateBox[{
  "Solve", "svars", 
   "\"Equations may not give solutions for all \\\"solve\\\" variables.\"", 2,
    1943, 89, 28410112452836994704, "Local"},
  "MessageTemplate"]], "Message", "MSG",
 CellChangeTimes->{3.878078269494465*^9, 3.878078742583606*^9, 
  3.878078899618535*^9, 3.878079253865985*^9, 3.878079430819562*^9, 
  3.878080637128373*^9, 3.8780808095370073`*^9, 3.878081098149448*^9, 
  3.878081136137045*^9, 3.8780819450782824`*^9, 3.8780820048796787`*^9, 
  3.878082047763628*^9, 3.878082109462324*^9, 3.878082376640708*^9, 
  3.878084831921735*^9, 3.878085522082589*^9, 3.878093683954672*^9, 
  3.878096061390531*^9, 3.8781066143839417`*^9, 3.878110713398693*^9, 
  3.878111731516018*^9},
 CellLabel->
  "During evaluation of \
In[1941]:=",ExpressionUUID->"097a0603-b66f-40a8-82c4-fe632f9bcae0"]
}, Open  ]]
}, Closed]],

Cell[CellGroupData[{

Cell["Factorisation condition v.p2", "Subsection",
 CellChangeTimes->{{3.878076748965989*^9, 3.878076767862722*^9}, {
  3.878093747799068*^9, 
  3.8780937495889473`*^9}},ExpressionUUID->"093da948-de7f-454f-8d79-\
9cf7d35422c3"],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{
  RowBox[{"numAnsatz3", "=", 
   RowBox[{
    RowBox[{
     RowBox[{
      RowBox[{
       RowBox[{"(", "numAnsatz2", ")"}], "//.", "dotRules"}], "/.", 
      RowBox[{"(", 
       RowBox[{
        RowBox[{"vonshell", "[", 
         RowBox[{
          RowBox[{"n", "-", "1"}], ",", "3"}], "]"}], "/.", 
        RowBox[{"v", "->", 
         RowBox[{"v", "[", "1", "]"}]}]}], ")"}]}], "/.", "solsvp1"}], "//", 
    "Expand"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{"%", "//", "Length"}]}], "Input",
 CellChangeTimes->{{3.878076776346158*^9, 3.878076791822427*^9}, {
   3.878076863747164*^9, 3.8780768651784353`*^9}, {3.878077446334421*^9, 
   3.878077450450157*^9}, 3.878080568874198*^9, 3.878080843522138*^9, {
   3.878084931218405*^9, 3.8780849369136047`*^9}, {3.878085107286035*^9, 
   3.878085112014679*^9}, {3.8780852927862673`*^9, 3.878085294285921*^9}, {
   3.8780937634764643`*^9, 3.8780937712084923`*^9}, {3.878094578752013*^9, 
   3.87809458003332*^9}},
 CellLabel->
  "In[1944]:=",ExpressionUUID->"6a1ca1dd-0cf5-4aa0-9478-36bb48adb0e4"],

Cell[BoxData["2386"], "Output",
 CellChangeTimes->{{3.87807677960294*^9, 3.878076792387086*^9}, 
   3.878076869394702*^9, 3.878077463656658*^9, 3.878080582971023*^9, 
   3.878081061748372*^9, 3.878084951014349*^9, 3.878085126532173*^9, 
   3.878085312641127*^9, 3.878093665706396*^9, 3.878094602309922*^9, 
   3.8780960624008083`*^9, 3.878106626228441*^9, 3.878110729159609*^9, 
   3.8781117318408327`*^9},
 CellLabel->
  "Out[1945]=",ExpressionUUID->"0745b7e9-915a-4c41-b8bd-dc5f11e5b85a"]
}, Open  ]],

Cell[BoxData[
 RowBox[{
  RowBox[{"numAnsatzvp1", "=", 
   RowBox[{
    RowBox[{
     RowBox[{
      RowBox[{"(", 
       RowBox[{
        RowBox[{
         RowBox[{"(", 
          RowBox[{"numAnsatz3", "//", 
           RowBox[{"Cases", "[", 
            RowBox[{"Times", "[", 
             RowBox[{"f___", ",", 
              RowBox[{"Power", "[", 
               RowBox[{
                RowBox[{"dot", "[", 
                 RowBox[{
                  RowBox[{"p", "[", "2", "]"}], ",", 
                  RowBox[{"v", "[", "1", "]"}]}], "]"}], ",", 
                RowBox[{"-", "1"}]}], "]"}], ",", "g___"}], "]"}], "]"}]}], 
          ")"}], "/.", 
         RowBox[{
          RowBox[{"Power", "[", 
           RowBox[{
            RowBox[{"dot", "[", 
             RowBox[{
              RowBox[{"p", "[", "2", "]"}], ",", 
              RowBox[{"v", "[", "1", "]"}]}], "]"}], ",", 
            RowBox[{"-", "1"}]}], "]"}], "->", "1"}]}], "//", "Total"}], 
       ")"}], "//.", "dotRules"}], "/.", "vponshell"}], "/.", 
    RowBox[{"{", 
     RowBox[{
      RowBox[{
       RowBox[{"dot", "[", 
        RowBox[{
         RowBox[{"p", "[", "2", "]"}], ",", 
         RowBox[{"v", "[", "1", "]"}]}], "]"}], "->", "0"}], ",", 
      RowBox[{
       RowBox[{"dot", "[", 
        RowBox[{
         RowBox[{"p", "[", "3", "]"}], ",", 
         RowBox[{"v", "[", "1", "]"}]}], "]"}], "->", 
       RowBox[{"-", 
        RowBox[{"dot", "[", 
         RowBox[{
          RowBox[{"p", "[", "1", "]"}], ",", 
          RowBox[{"v", "[", "1", "]"}]}], "]"}]}]}]}], "}"}]}]}], 
  ";"}]], "Input",
 CellChangeTimes->{{3.878077052129978*^9, 3.878077125591745*^9}, {
   3.878077237157652*^9, 3.878077281353335*^9}, {3.8780773702267103`*^9, 
   3.8780774435353603`*^9}, {3.8780774739935207`*^9, 3.8780775017717133`*^9}, 
   3.878079930873101*^9, 3.878079973240665*^9, {3.878085415182927*^9, 
   3.8780854153236303`*^9}, 3.878085446328352*^9, {3.878094648731681*^9, 
   3.878094651846068*^9}, {3.878094696417069*^9, 3.878094712612356*^9}},
 CellLabel->
  "In[1946]:=",ExpressionUUID->"dd475017-77a1-49c6-b689-cb657cf98d66"],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"numAnsatzvp1", "//", "Length"}]], "Input",
 CellChangeTimes->{{3.878085457345728*^9, 3.878085458484248*^9}},
 CellLabel->
  "In[1947]:=",ExpressionUUID->"9593486d-7e53-4ab1-9a84-acce95ba243f"],

Cell[BoxData["862"], "Output",
 CellChangeTimes->{{3.878085424115284*^9, 3.8780854589677*^9}, 
   3.878093671135722*^9, 3.878094722221806*^9, 3.878096062738055*^9, 
   3.878106638620821*^9, 3.878110733692247*^9, 3.878111732113031*^9},
 CellLabel->
  "Out[1947]=",ExpressionUUID->"93565269-2889-4533-a72c-b8de0a8e3c7b"]
}, Open  ]],

Cell[BoxData[{
 RowBox[{
  RowBox[{"num1", "=", 
   RowBox[{
    RowBox[{
     RowBox[{"T", "[", 
      RowBox[{"{", "2", "}"}], "]"}], "/.", 
     RowBox[{"T", "->", "T2F"}]}], "/.", 
    RowBox[{"v", "->", 
     RowBox[{"v", "[", "1", "]"}]}]}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"num2", "=", 
   RowBox[{"(", 
    RowBox[{
     FractionBox[
      RowBox[{"dot", "[", 
       RowBox[{
        RowBox[{"p", "[", "1", "]"}], ",", 
        RowBox[{"S", "[", "0", "]"}], ",", 
        RowBox[{"F", "[", "1", "]"}], ",", 
        RowBox[{"F", "[", "3", "]"}], ",", 
        RowBox[{"v", "[", "1", "]"}]}], "]"}], 
      RowBox[{"dot", "[", 
       RowBox[{
        RowBox[{"p", "[", "1", "]"}], ",", 
        RowBox[{"v", "[", "1", "]"}]}], "]"}]], "+", 
     FractionBox[
      RowBox[{"dot", "[", 
       RowBox[{
        RowBox[{"p", "[", "1", "]"}], ",", 
        RowBox[{"S", "[", "0", "]"}], ",", 
        RowBox[{"F", "[", "3", "]"}], ",", 
        RowBox[{"F", "[", "1", "]"}], ",", 
        RowBox[{"v", "[", "1", "]"}]}], "]"}], 
      RowBox[{"dot", "[", 
       RowBox[{
        RowBox[{"p", "[", "1", "]"}], ",", 
        RowBox[{"v", "[", "1", "]"}]}], "]"}]], "-", 
     FractionBox[
      RowBox[{"dot", "[", 
       RowBox[{
        RowBox[{"p", "[", "1", "]"}], ",", 
        RowBox[{"F", "[", "3", "]"}], ",", 
        RowBox[{"S", "[", "0", "]"}], ",", 
        RowBox[{"F", "[", "1", "]"}], ",", 
        RowBox[{"v", "[", "1", "]"}]}], "]"}], 
      RowBox[{"dot", "[", 
       RowBox[{
        RowBox[{"p", "[", "1", "]"}], ",", 
        RowBox[{"v", "[", "1", "]"}]}], "]"}]], "+", 
     FractionBox[
      RowBox[{"dot", "[", 
       RowBox[{
        RowBox[{"p", "[", "3", "]"}], ",", 
        RowBox[{"S", "[", "0", "]"}], ",", 
        RowBox[{"F", "[", "3", "]"}], ",", 
        RowBox[{"F", "[", "1", "]"}], ",", 
        RowBox[{"v", "[", "1", "]"}]}], "]"}], 
      RowBox[{"dot", "[", 
       RowBox[{
        RowBox[{"p", "[", "1", "]"}], ",", 
        RowBox[{"v", "[", "1", "]"}]}], "]"}]]}], ")"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"numvp1", "=", 
   RowBox[{
    RowBox[{
     RowBox[{
      RowBox[{
       RowBox[{"dot", "[", 
        RowBox[{
         RowBox[{"p", "[", "1", "]"}], ",", 
         RowBox[{"p", "[", "2", "]"}]}], "]"}], 
       RowBox[{"(", 
        RowBox[{
         RowBox[{"num1", "*", "num2"}], "+", 
         RowBox[{
          FractionBox["1", 
           RowBox[{"dot", "[", 
            RowBox[{
             RowBox[{"p", "[", "1", "]"}], ",", 
             RowBox[{"v", "[", "1", "]"}]}], "]"}]], 
          RowBox[{"dot", "[", 
           RowBox[{
            RowBox[{"p", "[", "2", "]"}], ",", 
            RowBox[{"S", "[", "0", "]"}], ",", 
            RowBox[{"\[Epsilon]", "[", "2", "]"}]}], "]"}], "*", 
          RowBox[{"dot", "[", 
           RowBox[{
            RowBox[{"v", "[", "1", "]"}], ",", 
            RowBox[{"F", "[", "1", "]"}], ",", 
            RowBox[{"F", "[", "3", "]"}], ",", 
            RowBox[{"v", "[", "1", "]"}]}], "]"}]}]}], ")"}]}], "//.", 
      "dotRules"}], "//", "expandFS"}], "//", "Expand"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"numvp1", "=", 
   RowBox[{
    RowBox[{
     RowBox[{"numvp1", "//.", "dotRules"}], "/.", "vponshell"}], "/.", 
    RowBox[{"{", 
     RowBox[{
      RowBox[{
       RowBox[{"dot", "[", 
        RowBox[{
         RowBox[{"p", "[", "2", "]"}], ",", 
         RowBox[{"v", "[", "1", "]"}]}], "]"}], "->", "0"}], ",", 
      RowBox[{
       RowBox[{"dot", "[", 
        RowBox[{
         RowBox[{"p", "[", "3", "]"}], ",", 
         RowBox[{"v", "[", "1", "]"}]}], "]"}], "->", 
       RowBox[{"-", 
        RowBox[{"dot", "[", 
         RowBox[{
          RowBox[{"p", "[", "1", "]"}], ",", 
          RowBox[{"v", "[", "1", "]"}]}], "]"}]}]}]}], "}"}]}]}], 
  ";"}]}], "Input",
 CellChangeTimes->{{3.878077591985273*^9, 3.8780776461342783`*^9}, {
   3.878077953502172*^9, 3.878077980733405*^9}, {3.878078491930747*^9, 
   3.878078549563458*^9}, {3.878078580745262*^9, 3.87807865251903*^9}, 
   3.878078684800146*^9, {3.878079206140265*^9, 3.878079212664543*^9}, {
   3.878079938416065*^9, 3.8780799390210323`*^9}, {3.878079982854789*^9, 
   3.878079996138009*^9}, 3.878080718496252*^9, 3.878080776110016*^9, {
   3.878081116226698*^9, 3.8780811179219093`*^9}, {3.878081897887516*^9, 
   3.878081929737031*^9}, {3.8780819770250673`*^9, 3.8780819885274878`*^9}, 
   3.8780820357161922`*^9, {3.878082093586617*^9, 3.878082094494379*^9}, 
   3.878082200584118*^9, 3.8780823524734297`*^9, 3.8780843780876017`*^9, {
   3.87808451838385*^9, 3.878084553403726*^9}, {3.878084767872551*^9, 
   3.878084809993238*^9}, {3.878093413770879*^9, 3.878093418381057*^9}, 
   3.878094731163116*^9, {3.878094787760552*^9, 3.878094870939351*^9}, {
   3.878094944453622*^9, 3.878094946794712*^9}, {3.878106643713951*^9, 
   3.878106646634589*^9}},
 CellLabel->
  "In[1948]:=",ExpressionUUID->"2b829d84-3c43-404b-ac21-445a8f6759c1"],

Cell[BoxData[
 RowBox[{
  RowBox[{"compvp1", "=", 
   RowBox[{"numAnsatzvp1", "-", "numvp1"}]}], ";"}]], "Input",
 CellChangeTimes->{{3.8780781147500143`*^9, 3.878078179889933*^9}, {
   3.878078714167301*^9, 3.878078719908218*^9}, {3.878078864983605*^9, 
   3.8780788894932623`*^9}, 3.878079927920136*^9, 3.87808000213634*^9},
 CellLabel->
  "In[1952]:=",ExpressionUUID->"341b9159-8e46-48e9-83cc-e872910e762c"],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  RowBox[{"4", " ", 
   RowBox[{
    SubscriptBox["p", "1"], "\[CenterDot]", "S", "\[CenterDot]", 
    SubscriptBox["F", "1"], "\[CenterDot]", 
    SubscriptBox["F", "2"], "\[CenterDot]", "v"}]}], "+", 
  RowBox[{"4", 
   RowBox[{
    SubscriptBox["p", "1"], "\[CenterDot]", "S", "\[CenterDot]", 
    SubscriptBox["F", "2"], "\[CenterDot]", 
    SubscriptBox["F", "1"], "\[CenterDot]", "v"}]}], "-", 
  RowBox[{"4", " ", 
   RowBox[{
    SubscriptBox["p", "1"], "\[CenterDot]", 
    SubscriptBox["F", "2"], "\[CenterDot]", "S", "\[CenterDot]", 
    SubscriptBox["F", "1"], "\[CenterDot]", "v"}]}], "+", 
  RowBox[{"4", " ", 
   RowBox[{
    SubscriptBox["p", "2"], "\[CenterDot]", "S", "\[CenterDot]", 
    SubscriptBox["F", "2"], "\[CenterDot]", 
    SubscriptBox["F", "1"], "\[CenterDot]", "v"}]}]}]], "Input",
 CellChangeTimes->{{3.878078468972107*^9, 3.8780784821254663`*^9}},
 CellLabel->
  "In[1953]:=",ExpressionUUID->"f0dacc84-a419-4e44-8cfa-8a2f7fcc98c7"],

Cell[BoxData[
 RowBox[{
  RowBox[{"4", " ", 
   RowBox[{
    SubscriptBox["p", "1"], "\[CenterDot]", "S", "\[CenterDot]", 
    SubscriptBox["F", "1"], "\[CenterDot]", 
    SubscriptBox["F", "2"], "\[CenterDot]", "v"}]}], "+", 
  RowBox[{"4", " ", 
   RowBox[{
    SubscriptBox["p", "1"], "\[CenterDot]", "S", "\[CenterDot]", 
    SubscriptBox["F", "2"], "\[CenterDot]", 
    SubscriptBox["F", "1"], "\[CenterDot]", "v"}]}], "-", 
  RowBox[{"4", " ", 
   RowBox[{
    SubscriptBox["p", "1"], "\[CenterDot]", 
    SubscriptBox["F", "2"], "\[CenterDot]", "S", "\[CenterDot]", 
    SubscriptBox["F", "1"], "\[CenterDot]", "v"}]}], "+", 
  RowBox[{"4", " ", 
   RowBox[{
    SubscriptBox["p", "2"], "\[CenterDot]", "S", "\[CenterDot]", 
    SubscriptBox["F", "2"], "\[CenterDot]", 
    SubscriptBox["F", "1"], "\[CenterDot]", "v"}]}]}]], "Output",
 CellChangeTimes->{3.8780960628033333`*^9, 3.878111732179213*^9},
 CellLabel->
  "Out[1953]=",ExpressionUUID->"730aa383-f58a-4e02-aeeb-460444c706e9"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"compvp1", "//", "Casesdot"}]], "Input",
 CellChangeTimes->{{3.8780788203554583`*^9, 3.878078825352446*^9}},
 CellLabel->
  "In[1954]:=",ExpressionUUID->"4180baca-9159-435e-9c2b-6677e160589e"],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
   RowBox[{"dot", "[", 
    RowBox[{
     RowBox[{"p", "[", "1", "]"}], ",", 
     RowBox[{"p", "[", "2", "]"}]}], "]"}], ",", 
   RowBox[{"dot", "[", 
    RowBox[{
     RowBox[{"p", "[", "1", "]"}], ",", 
     RowBox[{"p", "[", "3", "]"}]}], "]"}], ",", 
   RowBox[{"dot", "[", 
    RowBox[{
     RowBox[{"p", "[", "1", "]"}], ",", 
     RowBox[{"v", "[", "1", "]"}]}], "]"}], ",", 
   RowBox[{"dot", "[", 
    RowBox[{
     RowBox[{"p", "[", "1", "]"}], ",", 
     RowBox[{"\[Epsilon]", "[", "2", "]"}]}], "]"}], ",", 
   RowBox[{"dot", "[", 
    RowBox[{
     RowBox[{"p", "[", "1", "]"}], ",", 
     RowBox[{"\[Epsilon]", "[", "3", "]"}]}], "]"}], ",", 
   RowBox[{"dot", "[", 
    RowBox[{
     RowBox[{"p", "[", "2", "]"}], ",", 
     RowBox[{"p", "[", "3", "]"}]}], "]"}], ",", 
   RowBox[{"dot", "[", 
    RowBox[{
     RowBox[{"p", "[", "2", "]"}], ",", 
     RowBox[{"\[Epsilon]", "[", "1", "]"}]}], "]"}], ",", 
   RowBox[{"dot", "[", 
    RowBox[{
     RowBox[{"p", "[", "2", "]"}], ",", 
     RowBox[{"\[Epsilon]", "[", "3", "]"}]}], "]"}], ",", 
   RowBox[{"dot", "[", 
    RowBox[{
     RowBox[{"p", "[", "3", "]"}], ",", 
     RowBox[{"\[Epsilon]", "[", "1", "]"}]}], "]"}], ",", 
   RowBox[{"dot", "[", 
    RowBox[{
     RowBox[{"p", "[", "3", "]"}], ",", 
     RowBox[{"\[Epsilon]", "[", "2", "]"}]}], "]"}], ",", 
   RowBox[{"dot", "[", 
    RowBox[{
     RowBox[{"v", "[", "1", "]"}], ",", 
     RowBox[{"\[Epsilon]", "[", "1", "]"}]}], "]"}], ",", 
   RowBox[{"dot", "[", 
    RowBox[{
     RowBox[{"v", "[", "1", "]"}], ",", 
     RowBox[{"\[Epsilon]", "[", "2", "]"}]}], "]"}], ",", 
   RowBox[{"dot", "[", 
    RowBox[{
     RowBox[{"v", "[", "1", "]"}], ",", 
     RowBox[{"\[Epsilon]", "[", "3", "]"}]}], "]"}], ",", 
   RowBox[{"dot", "[", 
    RowBox[{
     RowBox[{"\[Epsilon]", "[", "1", "]"}], ",", 
     RowBox[{"\[Epsilon]", "[", "2", "]"}]}], "]"}], ",", 
   RowBox[{"dot", "[", 
    RowBox[{
     RowBox[{"\[Epsilon]", "[", "1", "]"}], ",", 
     RowBox[{"\[Epsilon]", "[", "3", "]"}]}], "]"}], ",", 
   RowBox[{"dot", "[", 
    RowBox[{
     RowBox[{"\[Epsilon]", "[", "2", "]"}], ",", 
     RowBox[{"\[Epsilon]", "[", "3", "]"}]}], "]"}], ",", 
   RowBox[{"dot", "[", 
    RowBox[{
     RowBox[{"p", "[", "1", "]"}], ",", 
     RowBox[{"S", "[", "0", "]"}], ",", 
     RowBox[{"p", "[", "2", "]"}]}], "]"}], ",", 
   RowBox[{"dot", "[", 
    RowBox[{
     RowBox[{"p", "[", "1", "]"}], ",", 
     RowBox[{"S", "[", "0", "]"}], ",", 
     RowBox[{"p", "[", "3", "]"}]}], "]"}], ",", 
   RowBox[{"dot", "[", 
    RowBox[{
     RowBox[{"p", "[", "1", "]"}], ",", 
     RowBox[{"S", "[", "0", "]"}], ",", 
     RowBox[{"\[Epsilon]", "[", "1", "]"}]}], "]"}], ",", 
   RowBox[{"dot", "[", 
    RowBox[{
     RowBox[{"p", "[", "1", "]"}], ",", 
     RowBox[{"S", "[", "0", "]"}], ",", 
     RowBox[{"\[Epsilon]", "[", "2", "]"}]}], "]"}], ",", 
   RowBox[{"dot", "[", 
    RowBox[{
     RowBox[{"p", "[", "1", "]"}], ",", 
     RowBox[{"S", "[", "0", "]"}], ",", 
     RowBox[{"\[Epsilon]", "[", "3", "]"}]}], "]"}], ",", 
   RowBox[{"dot", "[", 
    RowBox[{
     RowBox[{"p", "[", "2", "]"}], ",", 
     RowBox[{"S", "[", "0", "]"}], ",", 
     RowBox[{"p", "[", "3", "]"}]}], "]"}], ",", 
   RowBox[{"dot", "[", 
    RowBox[{
     RowBox[{"p", "[", "2", "]"}], ",", 
     RowBox[{"S", "[", "0", "]"}], ",", 
     RowBox[{"\[Epsilon]", "[", "1", "]"}]}], "]"}], ",", 
   RowBox[{"dot", "[", 
    RowBox[{
     RowBox[{"p", "[", "2", "]"}], ",", 
     RowBox[{"S", "[", "0", "]"}], ",", 
     RowBox[{"\[Epsilon]", "[", "2", "]"}]}], "]"}], ",", 
   RowBox[{"dot", "[", 
    RowBox[{
     RowBox[{"p", "[", "2", "]"}], ",", 
     RowBox[{"S", "[", "0", "]"}], ",", 
     RowBox[{"\[Epsilon]", "[", "3", "]"}]}], "]"}], ",", 
   RowBox[{"dot", "[", 
    RowBox[{
     RowBox[{"p", "[", "3", "]"}], ",", 
     RowBox[{"S", "[", "0", "]"}], ",", 
     RowBox[{"\[Epsilon]", "[", "1", "]"}]}], "]"}], ",", 
   RowBox[{"dot", "[", 
    RowBox[{
     RowBox[{"p", "[", "3", "]"}], ",", 
     RowBox[{"S", "[", "0", "]"}], ",", 
     RowBox[{"\[Epsilon]", "[", "2", "]"}]}], "]"}], ",", 
   RowBox[{"dot", "[", 
    RowBox[{
     RowBox[{"p", "[", "3", "]"}], ",", 
     RowBox[{"S", "[", "0", "]"}], ",", 
     RowBox[{"\[Epsilon]", "[", "3", "]"}]}], "]"}], ",", 
   RowBox[{"dot", "[", 
    RowBox[{
     RowBox[{"\[Epsilon]", "[", "1", "]"}], ",", 
     RowBox[{"S", "[", "0", "]"}], ",", 
     RowBox[{"\[Epsilon]", "[", "2", "]"}]}], "]"}], ",", 
   RowBox[{"dot", "[", 
    RowBox[{
     RowBox[{"\[Epsilon]", "[", "1", "]"}], ",", 
     RowBox[{"S", "[", "0", "]"}], ",", 
     RowBox[{"\[Epsilon]", "[", "3", "]"}]}], "]"}], ",", 
   RowBox[{"dot", "[", 
    RowBox[{
     RowBox[{"\[Epsilon]", "[", "2", "]"}], ",", 
     RowBox[{"S", "[", "0", "]"}], ",", 
     RowBox[{"\[Epsilon]", "[", "3", "]"}]}], "]"}]}], "}"}]], "Output",
 CellChangeTimes->{3.8780787909855328`*^9, 3.878078825754147*^9, 
  3.8780789139500523`*^9, 3.878079583885482*^9, 3.8780807366766977`*^9, 
  3.87808078442798*^9, 3.878095061451518*^9, 3.87809606280996*^9, 
  3.878111732196608*^9},
 CellLabel->
  "Out[1954]=",ExpressionUUID->"67cd9f80-bd7c-4f99-af53-75f11381d60f"]
}, Open  ]],

Cell[BoxData[{
 RowBox[{
  RowBox[{"cvars", "=", 
   RowBox[{
    RowBox[{"Cases", "[", 
     RowBox[{"compvp1", ",", 
      RowBox[{"c", "[", "__", "]"}], ",", 
      RowBox[{"{", 
       RowBox[{"0", ",", "\[Infinity]"}], "}"}]}], "]"}], "//", "Union"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"vardot", "=", 
   RowBox[{"compvp1", "//", "Casesdot"}]}], ";"}]}], "Input",
 CellChangeTimes->{{3.878078218083035*^9, 3.878078227195683*^9}},
 CellLabel->
  "In[1955]:=",ExpressionUUID->"de73dfa1-ae0b-4862-a7ac-49bb0c00b87e"],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"cvars", "//", "Length"}]], "Input",
 CellChangeTimes->{{3.878078250405406*^9, 3.8780782515980988`*^9}, 
   3.8780793030421352`*^9, {3.878080618122617*^9, 3.878080619511405*^9}},
 CellLabel->
  "In[1957]:=",ExpressionUUID->"bda0c3b7-0b8c-47f3-a81a-619774f37614"],

Cell[BoxData["146"], "Output",
 CellChangeTimes->{
  3.878078252063862*^9, 3.878078732430634*^9, {3.8780792683050127`*^9, 
   3.878079303531766*^9}, {3.8780806116761723`*^9, 3.878080620497012*^9}, 
   3.878080793272333*^9, 3.8780810935750732`*^9, 3.8780811318686132`*^9, 
   3.878081941084124*^9, 3.8780820011325197`*^9, 3.878082120982493*^9, 
   3.878084828486793*^9, 3.878085517830093*^9, 3.878093680935251*^9, 
   3.878095084936636*^9, 3.878096062833789*^9, 3.878106656683487*^9, 
   3.878110745065216*^9, 3.878111732223112*^9},
 CellLabel->
  "Out[1957]=",ExpressionUUID->"4460e8bc-53a6-4bcf-9fe8-baf5a12999a1"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{
  RowBox[{"dot2num", ":=", 
   RowBox[{"Table", "[", 
    RowBox[{
     RowBox[{"Rule", "[", 
      RowBox[{
       RowBox[{"vardot", "[", 
        RowBox[{"[", "ii", "]"}], "]"}], ",", 
       RowBox[{"RandomInteger", "[", 
        RowBox[{"{", 
         RowBox[{"10", ",", "100"}], "}"}], "]"}]}], "]"}], ",", 
     RowBox[{"{", 
      RowBox[{"ii", ",", 
       RowBox[{"Length", "[", "vardot", "]"}]}], "}"}]}], "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{"Monitor", "[", 
  RowBox[{
   RowBox[{
    RowBox[{"eqDep", "=", 
     RowBox[{"Table", "[", 
      RowBox[{
       RowBox[{
        RowBox[{"compvp1", "\[Equal]", "0"}], "/.", "dot2num"}], ",", 
       RowBox[{"{", 
        RowBox[{"ii", ",", 
         RowBox[{"10", "+", 
          RowBox[{"Length", "[", "cvars", "]"}]}]}], "}"}]}], "]"}]}], ";"}], 
   ",", "ii"}], "]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"solsvp2", "=", 
   RowBox[{
    RowBox[{"Solve", "[", 
     RowBox[{"eqDep", ",", "cvars"}], "]"}], "[", 
    RowBox[{"[", "1", "]"}], "]"}]}], ";"}]}], "Input",
 CellChangeTimes->{{3.878078221639757*^9, 3.878078240954069*^9}, {
  3.878081064658252*^9, 3.8780810690042477`*^9}, {3.878095748981908*^9, 
  3.878095749098365*^9}},
 CellLabel->
  "In[1958]:=",ExpressionUUID->"8b94d3f8-f020-428b-9825-ea39ae125616"],

Cell[BoxData[
 TemplateBox[{
  "Solve", "svars", 
   "\"Equations may not give solutions for all \\\"solve\\\" variables.\"", 2,
    1960, 90, 28410112452836994704, "Local"},
  "MessageTemplate"]], "Message", "MSG",
 CellChangeTimes->{3.8781117333994837`*^9},
 CellLabel->
  "During evaluation of \
In[1958]:=",ExpressionUUID->"7eef4795-883a-4af8-925f-427c61013555"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData["solsvp2"], "Input",
 CellLabel->
  "In[1961]:=",ExpressionUUID->"5bdfdf31-0c8e-40be-ac02-abcbec459edb"],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
   RowBox[{
    RowBox[{"c", "[", "2", "]"}], "\[Rule]", "0"}], ",", 
   RowBox[{
    RowBox[{"c", "[", "4", "]"}], "\[Rule]", "0"}], ",", 
   RowBox[{
    RowBox[{"c", "[", "6", "]"}], "\[Rule]", "0"}], ",", 
   RowBox[{
    RowBox[{"c", "[", "8", "]"}], "\[Rule]", "0"}], ",", 
   RowBox[{
    RowBox[{"c", "[", "10", "]"}], "\[Rule]", "0"}], ",", 
   RowBox[{
    RowBox[{"c", "[", "13", "]"}], "\[Rule]", "0"}], ",", 
   RowBox[{
    RowBox[{"c", "[", "17", "]"}], "\[Rule]", "0"}], ",", 
   RowBox[{
    RowBox[{"c", "[", "19", "]"}], "\[Rule]", "0"}], ",", 
   RowBox[{
    RowBox[{"c", "[", "21", "]"}], "\[Rule]", 
    RowBox[{"c", "[", "20", "]"}]}], ",", 
   RowBox[{
    RowBox[{"c", "[", "27", "]"}], "\[Rule]", 
    RowBox[{"c", "[", "26", "]"}]}], ",", 
   RowBox[{
    RowBox[{"c", "[", "29", "]"}], "\[Rule]", "0"}], ",", 
   RowBox[{
    RowBox[{"c", "[", "31", "]"}], "\[Rule]", "0"}], ",", 
   RowBox[{
    RowBox[{"c", "[", "38", "]"}], "\[Rule]", "0"}], ",", 
   RowBox[{
    RowBox[{"c", "[", "39", "]"}], "\[Rule]", "0"}], ",", 
   RowBox[{
    RowBox[{"c", "[", "40", "]"}], "\[Rule]", "0"}], ",", 
   RowBox[{
    RowBox[{"c", "[", "41", "]"}], "\[Rule]", "0"}], ",", 
   RowBox[{
    RowBox[{"c", "[", "43", "]"}], "\[Rule]", 
    RowBox[{"-", 
     RowBox[{"c", "[", "37", "]"}]}]}], ",", 
   RowBox[{
    RowBox[{"c", "[", "44", "]"}], "\[Rule]", "0"}], ",", 
   RowBox[{
    RowBox[{"c", "[", "46", "]"}], "\[Rule]", "0"}], ",", 
   RowBox[{
    RowBox[{"c", "[", "48", "]"}], "\[Rule]", 
    RowBox[{"c", "[", "47", "]"}]}], ",", 
   RowBox[{
    RowBox[{"c", "[", "51", "]"}], "\[Rule]", "0"}], ",", 
   RowBox[{
    RowBox[{"c", "[", "52", "]"}], "\[Rule]", 
    RowBox[{"-", 
     RowBox[{"c", "[", "33", "]"}]}]}], ",", 
   RowBox[{
    RowBox[{"c", "[", "55", "]"}], "\[Rule]", 
    RowBox[{"c", "[", "54", "]"}]}], ",", 
   RowBox[{
    RowBox[{"c", "[", "58", "]"}], "\[Rule]", "0"}], ",", 
   RowBox[{
    RowBox[{"c", "[", "60", "]"}], "\[Rule]", "1"}], ",", 
   RowBox[{
    RowBox[{"c", "[", "63", "]"}], "\[Rule]", "0"}], ",", 
   RowBox[{
    RowBox[{"c", "[", "65", "]"}], "\[Rule]", "0"}], ",", 
   RowBox[{
    RowBox[{"c", "[", "69", "]"}], "\[Rule]", "1"}], ",", 
   RowBox[{
    RowBox[{"c", "[", "74", "]"}], "\[Rule]", 
    RowBox[{"c", "[", "62", "]"}]}], ",", 
   RowBox[{
    RowBox[{"c", "[", "77", "]"}], "\[Rule]", "0"}], ",", 
   RowBox[{
    RowBox[{"c", "[", "78", "]"}], "\[Rule]", "1"}], ",", 
   RowBox[{
    RowBox[{"c", "[", "79", "]"}], "\[Rule]", "1"}], ",", 
   RowBox[{
    RowBox[{"c", "[", "81", "]"}], "\[Rule]", "0"}], ",", 
   RowBox[{
    RowBox[{"c", "[", "83", "]"}], "\[Rule]", "0"}], ",", 
   RowBox[{
    RowBox[{"c", "[", "84", "]"}], "\[Rule]", "0"}], ",", 
   RowBox[{
    RowBox[{"c", "[", "86", "]"}], "\[Rule]", "0"}], ",", 
   RowBox[{
    RowBox[{"c", "[", "88", "]"}], "\[Rule]", "1"}], ",", 
   RowBox[{
    RowBox[{"c", "[", "90", "]"}], "\[Rule]", "0"}], ",", 
   RowBox[{
    RowBox[{"c", "[", "92", "]"}], "\[Rule]", "0"}], ",", 
   RowBox[{
    RowBox[{"c", "[", "98", "]"}], "\[Rule]", "0"}], ",", 
   RowBox[{
    RowBox[{"c", "[", "101", "]"}], "\[Rule]", "0"}], ",", 
   RowBox[{
    RowBox[{"c", "[", "103", "]"}], "\[Rule]", "0"}], ",", 
   RowBox[{
    RowBox[{"c", "[", "104", "]"}], "\[Rule]", "0"}], ",", 
   RowBox[{
    RowBox[{"c", "[", "106", "]"}], "\[Rule]", 
    RowBox[{"c", "[", "80", "]"}]}], ",", 
   RowBox[{
    RowBox[{"c", "[", "107", "]"}], "\[Rule]", "0"}], ",", 
   RowBox[{
    RowBox[{"c", "[", "109", "]"}], "\[Rule]", "1"}], ",", 
   RowBox[{
    RowBox[{"c", "[", "111", "]"}], "\[Rule]", "0"}], ",", 
   RowBox[{
    RowBox[{"c", "[", "113", "]"}], "\[Rule]", 
    RowBox[{
     RowBox[{"-", 
      RowBox[{"c", "[", "33", "]"}]}], "+", 
     RowBox[{"c", "[", "67", "]"}]}]}], ",", 
   RowBox[{
    RowBox[{"c", "[", "114", "]"}], "\[Rule]", "0"}], ",", 
   RowBox[{
    RowBox[{"c", "[", "116", "]"}], "\[Rule]", 
    RowBox[{"-", "1"}]}], ",", 
   RowBox[{
    RowBox[{"c", "[", "120", "]"}], "\[Rule]", 
    RowBox[{
     RowBox[{"c", "[", "76", "]"}], "-", 
     RowBox[{"c", "[", "100", "]"}]}]}], ",", 
   RowBox[{
    RowBox[{"c", "[", "122", "]"}], "\[Rule]", 
    RowBox[{
     RowBox[{"-", 
      RowBox[{"c", "[", "16", "]"}]}], "-", 
     RowBox[{"c", "[", "102", "]"}]}]}], ",", 
   RowBox[{
    RowBox[{"c", "[", "124", "]"}], "\[Rule]", 
    RowBox[{"c", "[", "16", "]"}]}], ",", 
   RowBox[{
    RowBox[{"c", "[", "127", "]"}], "\[Rule]", "0"}], ",", 
   RowBox[{
    RowBox[{"c", "[", "128", "]"}], "\[Rule]", 
    RowBox[{
     RowBox[{"c", "[", "64", "]"}], "-", 
     RowBox[{"c", "[", "108", "]"}]}]}], ",", 
   RowBox[{
    RowBox[{"c", "[", "130", "]"}], "\[Rule]", 
    RowBox[{
     RowBox[{"-", 
      RowBox[{"c", "[", "45", "]"}]}], "-", 
     RowBox[{"c", "[", "110", "]"}]}]}], ",", 
   RowBox[{
    RowBox[{"c", "[", "133", "]"}], "\[Rule]", 
    RowBox[{
     RowBox[{"c", "[", "71", "]"}], "+", 
     RowBox[{"c", "[", "94", "]"}]}]}], ",", 
   RowBox[{
    RowBox[{"c", "[", "134", "]"}], "\[Rule]", 
    RowBox[{"c", "[", "45", "]"}]}], ",", 
   RowBox[{
    RowBox[{"c", "[", "136", "]"}], "\[Rule]", "0"}], ",", 
   RowBox[{
    RowBox[{"c", "[", "139", "]"}], "\[Rule]", "0"}], ",", 
   RowBox[{
    RowBox[{"c", "[", "141", "]"}], "\[Rule]", 
    RowBox[{"c", "[", "94", "]"}]}], ",", 
   RowBox[{
    RowBox[{"c", "[", "143", "]"}], "\[Rule]", 
    RowBox[{
     RowBox[{"-", 
      RowBox[{"c", "[", "37", "]"}]}], "+", 
     RowBox[{"c", "[", "70", "]"}], "-", 
     RowBox[{"c", "[", "71", "]"}], "-", 
     RowBox[{"c", "[", "94", "]"}]}]}], ",", 
   RowBox[{
    RowBox[{"c", "[", "144", "]"}], "\[Rule]", 
    RowBox[{"-", 
     RowBox[{"c", "[", "94", "]"}]}]}], ",", 
   RowBox[{
    RowBox[{"c", "[", "145", "]"}], "\[Rule]", "0"}], ",", 
   RowBox[{
    RowBox[{"c", "[", "148", "]"}], "\[Rule]", 
    RowBox[{
     RowBox[{"-", "1"}], "+", 
     RowBox[{"c", "[", "147", "]"}]}]}], ",", 
   RowBox[{
    RowBox[{"c", "[", "150", "]"}], "\[Rule]", 
    RowBox[{"c", "[", "149", "]"}]}], ",", 
   RowBox[{
    RowBox[{"c", "[", "156", "]"}], "\[Rule]", 
    RowBox[{"-", "1"}]}], ",", 
   RowBox[{
    RowBox[{"c", "[", "159", "]"}], "\[Rule]", 
    RowBox[{
     RowBox[{"c", "[", "33", "]"}], "+", 
     RowBox[{"c", "[", "66", "]"}], "-", 
     RowBox[{"c", "[", "67", "]"}], "+", 
     RowBox[{"c", "[", "80", "]"}]}]}], ",", 
   RowBox[{
    RowBox[{"c", "[", "160", "]"}], "\[Rule]", 
    RowBox[{"c", "[", "33", "]"}]}], ",", 
   RowBox[{
    RowBox[{"c", "[", "161", "]"}], "\[Rule]", 
    RowBox[{"c", "[", "54", "]"}]}], ",", 
   RowBox[{
    RowBox[{"c", "[", "163", "]"}], "\[Rule]", 
    RowBox[{
     RowBox[{"c", "[", "72", "]"}], "-", 
     RowBox[{"c", "[", "147", "]"}]}]}], ",", 
   RowBox[{
    RowBox[{"c", "[", "165", "]"}], "\[Rule]", 
    RowBox[{
     RowBox[{"-", 
      RowBox[{"c", "[", "54", "]"}]}], "-", 
     RowBox[{"c", "[", "149", "]"}]}]}], ",", 
   RowBox[{
    RowBox[{"c", "[", "167", "]"}], "\[Rule]", "0"}], ",", 
   RowBox[{
    RowBox[{"c", "[", "169", "]"}], "\[Rule]", 
    RowBox[{"c", "[", "96", "]"}]}], ",", 
   RowBox[{
    RowBox[{"c", "[", "171", "]"}], "\[Rule]", "0"}], ",", 
   RowBox[{
    RowBox[{"c", "[", "174", "]"}], "\[Rule]", 
    RowBox[{
     RowBox[{"c", "[", "82", "]"}], "-", 
     RowBox[{"c", "[", "126", "]"}]}]}], ",", 
   RowBox[{
    RowBox[{"c", "[", "175", "]"}], "\[Rule]", "0"}], ",", 
   RowBox[{
    RowBox[{"c", "[", "176", "]"}], "\[Rule]", "0"}], ",", 
   RowBox[{
    RowBox[{"c", "[", "178", "]"}], "\[Rule]", "0"}], ",", 
   RowBox[{
    RowBox[{"c", "[", "190", "]"}], "\[Rule]", "0"}], ",", 
   RowBox[{
    RowBox[{"c", "[", "199", "]"}], "\[Rule]", "0"}], ",", 
   RowBox[{
    RowBox[{"c", "[", "201", "]"}], "\[Rule]", "0"}], ",", 
   RowBox[{
    RowBox[{"c", "[", "203", "]"}], "\[Rule]", "0"}], ",", 
   RowBox[{
    RowBox[{"c", "[", "205", "]"}], "\[Rule]", "0"}], ",", 
   RowBox[{
    RowBox[{"c", "[", "207", "]"}], "\[Rule]", "0"}], ",", 
   RowBox[{
    RowBox[{"c", "[", "209", "]"}], "\[Rule]", "0"}], ",", 
   RowBox[{
    RowBox[{"c", "[", "211", "]"}], "\[Rule]", "0"}], ",", 
   RowBox[{
    RowBox[{"c", "[", "213", "]"}], "\[Rule]", "0"}], ",", 
   RowBox[{
    RowBox[{"c", "[", "215", "]"}], "\[Rule]", "0"}], ",", 
   RowBox[{
    RowBox[{"c", "[", "217", "]"}], "\[Rule]", "0"}], ",", 
   RowBox[{
    RowBox[{"c", "[", "219", "]"}], "\[Rule]", "0"}], ",", 
   RowBox[{
    RowBox[{"c", "[", "221", "]"}], "\[Rule]", "0"}], ",", 
   RowBox[{
    RowBox[{"c", "[", "223", "]"}], "\[Rule]", "0"}], ",", 
   RowBox[{
    RowBox[{"c", "[", "225", "]"}], "\[Rule]", "0"}], ",", 
   RowBox[{
    RowBox[{"c", "[", "227", "]"}], "\[Rule]", "0"}], ",", 
   RowBox[{
    RowBox[{"c", "[", "229", "]"}], "\[Rule]", "0"}], ",", 
   RowBox[{
    RowBox[{"c", "[", "231", "]"}], "\[Rule]", "0"}], ",", 
   RowBox[{
    RowBox[{"c", "[", "233", "]"}], "\[Rule]", "0"}], ",", 
   RowBox[{
    RowBox[{"c", "[", "235", "]"}], "\[Rule]", "0"}], ",", 
   RowBox[{
    RowBox[{"c", "[", "237", "]"}], "\[Rule]", "0"}], ",", 
   RowBox[{
    RowBox[{"c", "[", "239", "]"}], "\[Rule]", "0"}], ",", 
   RowBox[{
    RowBox[{"c", "[", "241", "]"}], "\[Rule]", "0"}], ",", 
   RowBox[{
    RowBox[{"c", "[", "243", "]"}], "\[Rule]", "0"}], ",", 
   RowBox[{
    RowBox[{"c", "[", "245", "]"}], "\[Rule]", "0"}], ",", 
   RowBox[{
    RowBox[{"c", "[", "247", "]"}], "\[Rule]", "0"}], ",", 
   RowBox[{
    RowBox[{"c", "[", "249", "]"}], "\[Rule]", "0"}], ",", 
   RowBox[{
    RowBox[{"c", "[", "251", "]"}], "\[Rule]", "0"}], ",", 
   RowBox[{
    RowBox[{"c", "[", "253", "]"}], "\[Rule]", "0"}], ",", 
   RowBox[{
    RowBox[{"c", "[", "255", "]"}], "\[Rule]", "0"}], ",", 
   RowBox[{
    RowBox[{"c", "[", "257", "]"}], "\[Rule]", "0"}], ",", 
   RowBox[{
    RowBox[{"c", "[", "259", "]"}], "\[Rule]", "0"}], ",", 
   RowBox[{
    RowBox[{"c", "[", "261", "]"}], "\[Rule]", "0"}], ",", 
   RowBox[{
    RowBox[{"c", "[", "264", "]"}], "\[Rule]", "0"}], ",", 
   RowBox[{
    RowBox[{"c", "[", "266", "]"}], "\[Rule]", "0"}], ",", 
   RowBox[{
    RowBox[{"c", "[", "269", "]"}], "\[Rule]", "0"}], ",", 
   RowBox[{
    RowBox[{"c", "[", "271", "]"}], "\[Rule]", "0"}], ",", 
   RowBox[{
    RowBox[{"c", "[", "273", "]"}], "\[Rule]", "0"}], ",", 
   RowBox[{
    RowBox[{"c", "[", "275", "]"}], "\[Rule]", "0"}], ",", 
   RowBox[{
    RowBox[{"c", "[", "277", "]"}], "\[Rule]", "0"}]}], "}"}]], "Output",
 CellChangeTimes->{3.878105405899537*^9, 3.878106662223672*^9, 
  3.8781107493123293`*^9, 3.878111733424849*^9},
 CellLabel->
  "Out[1961]=",ExpressionUUID->"ffcc6bdb-6787-4c7c-839e-d821f5d76e7b"]
}, Open  ]]
}, Closed]],

Cell[CellGroupData[{

Cell["Factorisation condition v.p3", "Subsection",
 CellChangeTimes->{{3.878076748965989*^9, 3.878076767862722*^9}, {
  3.878093747799068*^9, 3.8780937495889473`*^9}, {3.878095192789927*^9, 
  3.8780951929813747`*^9}},ExpressionUUID->"83c61381-cf0f-42d4-9208-\
7077932484a5"],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{
  RowBox[{"numAnsatz4", "=", 
   RowBox[{
    RowBox[{
     RowBox[{
      RowBox[{
       RowBox[{"(", "numAnsatz3", ")"}], "//.", "dotRules"}], "/.", 
      RowBox[{"(", 
       RowBox[{
        RowBox[{"vonshell", "[", 
         RowBox[{
          RowBox[{"n", "-", "1"}], ",", "2"}], "]"}], "/.", 
        RowBox[{"v", "->", 
         RowBox[{"v", "[", "1", "]"}]}]}], ")"}]}], "/.", "solsvp2"}], "//", 
    "Expand"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{"%", "//", "Length"}]}], "Input",
 CellChangeTimes->{{3.878076776346158*^9, 3.878076791822427*^9}, {
   3.878076863747164*^9, 3.8780768651784353`*^9}, {3.878077446334421*^9, 
   3.878077450450157*^9}, 3.878080568874198*^9, 3.878080843522138*^9, {
   3.878084931218405*^9, 3.8780849369136047`*^9}, {3.878085107286035*^9, 
   3.878085112014679*^9}, {3.8780852927862673`*^9, 3.878085294285921*^9}, {
   3.8780937634764643`*^9, 3.8780937712084923`*^9}, {3.878094578752013*^9, 
   3.87809458003332*^9}, {3.8780951988903418`*^9, 3.8780952057126427`*^9}, {
   3.8780957389282017`*^9, 3.878095739594145*^9}},
 CellLabel->
  "In[1962]:=",ExpressionUUID->"9f254a5e-e840-46a3-8ea6-624833a130d2"],

Cell[BoxData["419"], "Output",
 CellChangeTimes->{{3.87807677960294*^9, 3.878076792387086*^9}, 
   3.878076869394702*^9, 3.878077463656658*^9, 3.878080582971023*^9, 
   3.878081061748372*^9, 3.878084951014349*^9, 3.878085126532173*^9, 
   3.878085312641127*^9, 3.878093665706396*^9, 3.878094602309922*^9, 
   3.878095215999476*^9, 3.878096067273143*^9, 3.878106671780857*^9, 
   3.878110759023982*^9, 3.878111734770612*^9},
 CellLabel->
  "Out[1963]=",ExpressionUUID->"46b4cffd-aaf7-49c7-955f-68a919af06e0"]
}, Open  ]],

Cell[BoxData[
 RowBox[{
  RowBox[{"numAnsatzvp1", "=", 
   RowBox[{
    RowBox[{
     RowBox[{
      RowBox[{"(", 
       RowBox[{
        RowBox[{
         RowBox[{"(", 
          RowBox[{"numAnsatz4", "//", 
           RowBox[{"Cases", "[", 
            RowBox[{"Times", "[", 
             RowBox[{"f___", ",", 
              RowBox[{"Power", "[", 
               RowBox[{
                RowBox[{"dot", "[", 
                 RowBox[{
                  RowBox[{"p", "[", "3", "]"}], ",", 
                  RowBox[{"v", "[", "1", "]"}]}], "]"}], ",", 
                RowBox[{"-", "1"}]}], "]"}], ",", "g___"}], "]"}], "]"}]}], 
          ")"}], "/.", 
         RowBox[{
          RowBox[{"Power", "[", 
           RowBox[{
            RowBox[{"dot", "[", 
             RowBox[{
              RowBox[{"p", "[", "3", "]"}], ",", 
              RowBox[{"v", "[", "1", "]"}]}], "]"}], ",", 
            RowBox[{"-", "1"}]}], "]"}], "->", "1"}]}], "//", "Total"}], 
       ")"}], "//.", "dotRules"}], "/.", "vponshell"}], "/.", 
    RowBox[{"{", 
     RowBox[{
      RowBox[{
       RowBox[{"dot", "[", 
        RowBox[{
         RowBox[{"p", "[", "3", "]"}], ",", 
         RowBox[{"v", "[", "1", "]"}]}], "]"}], "->", "0"}], ",", 
      RowBox[{
       RowBox[{"dot", "[", 
        RowBox[{
         RowBox[{"p", "[", "2", "]"}], ",", 
         RowBox[{"v", "[", "1", "]"}]}], "]"}], "->", 
       RowBox[{"-", 
        RowBox[{"dot", "[", 
         RowBox[{
          RowBox[{"p", "[", "1", "]"}], ",", 
          RowBox[{"v", "[", "1", "]"}]}], "]"}]}]}]}], "}"}]}]}], 
  ";"}]], "Input",
 CellChangeTimes->{{3.878077052129978*^9, 3.878077125591745*^9}, {
   3.878077237157652*^9, 3.878077281353335*^9}, {3.8780773702267103`*^9, 
   3.8780774435353603`*^9}, {3.8780774739935207`*^9, 3.8780775017717133`*^9}, 
   3.878079930873101*^9, 3.878079973240665*^9, {3.878085415182927*^9, 
   3.8780854153236303`*^9}, 3.878085446328352*^9, {3.878094648731681*^9, 
   3.878094651846068*^9}, {3.878094696417069*^9, 3.878094712612356*^9}, 
   3.8780952799470053`*^9, {3.878095329611971*^9, 3.878095354825946*^9}},
 CellLabel->
  "In[1964]:=",ExpressionUUID->"cf70a313-2714-4caa-b2a7-be91a17d9612"],

Cell[BoxData[{
 RowBox[{
  RowBox[{"num1", "=", 
   RowBox[{
    RowBox[{
     RowBox[{"T", "[", 
      RowBox[{"{", "3", "}"}], "]"}], "/.", 
     RowBox[{"T", "->", "T2F"}]}], "/.", 
    RowBox[{"v", "->", 
     RowBox[{"v", "[", "1", "]"}]}]}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"num2", "=", 
   RowBox[{"(", 
    RowBox[{
     FractionBox[
      RowBox[{"dot", "[", 
       RowBox[{
        RowBox[{"p", "[", "1", "]"}], ",", 
        RowBox[{"S", "[", "0", "]"}], ",", 
        RowBox[{"F", "[", "1", "]"}], ",", 
        RowBox[{"F", "[", "2", "]"}], ",", 
        RowBox[{"v", "[", "1", "]"}]}], "]"}], 
      RowBox[{"dot", "[", 
       RowBox[{
        RowBox[{"p", "[", "1", "]"}], ",", 
        RowBox[{"v", "[", "1", "]"}]}], "]"}]], "+", 
     FractionBox[
      RowBox[{"dot", "[", 
       RowBox[{
        RowBox[{"p", "[", "1", "]"}], ",", 
        RowBox[{"S", "[", "0", "]"}], ",", 
        RowBox[{"F", "[", "2", "]"}], ",", 
        RowBox[{"F", "[", "1", "]"}], ",", 
        RowBox[{"v", "[", "1", "]"}]}], "]"}], 
      RowBox[{"dot", "[", 
       RowBox[{
        RowBox[{"p", "[", "1", "]"}], ",", 
        RowBox[{"v", "[", "1", "]"}]}], "]"}]], "-", 
     FractionBox[
      RowBox[{"dot", "[", 
       RowBox[{
        RowBox[{"p", "[", "1", "]"}], ",", 
        RowBox[{"F", "[", "2", "]"}], ",", 
        RowBox[{"S", "[", "0", "]"}], ",", 
        RowBox[{"F", "[", "1", "]"}], ",", 
        RowBox[{"v", "[", "1", "]"}]}], "]"}], 
      RowBox[{"dot", "[", 
       RowBox[{
        RowBox[{"p", "[", "1", "]"}], ",", 
        RowBox[{"v", "[", "1", "]"}]}], "]"}]], "+", 
     FractionBox[
      RowBox[{"dot", "[", 
       RowBox[{
        RowBox[{"p", "[", "2", "]"}], ",", 
        RowBox[{"S", "[", "0", "]"}], ",", 
        RowBox[{"F", "[", "2", "]"}], ",", 
        RowBox[{"F", "[", "1", "]"}], ",", 
        RowBox[{"v", "[", "1", "]"}]}], "]"}], 
      RowBox[{"dot", "[", 
       RowBox[{
        RowBox[{"p", "[", "1", "]"}], ",", 
        RowBox[{"v", "[", "1", "]"}]}], "]"}]]}], ")"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"numvp1", "=", 
   RowBox[{
    RowBox[{
     RowBox[{
      RowBox[{
       RowBox[{"dot", "[", 
        RowBox[{
         RowBox[{
          RowBox[{"p", "[", "1", "]"}], "+", 
          RowBox[{"p", "[", "2", "]"}]}], ",", 
         RowBox[{"p", "[", "3", "]"}]}], "]"}], 
       RowBox[{"(", 
        RowBox[{
         RowBox[{
          RowBox[{"c", "[", "3", "]"}], "num1", "*", "num2"}], "+", 
         RowBox[{
          FractionBox["1", 
           RowBox[{"dot", "[", 
            RowBox[{
             RowBox[{"p", "[", "1", "]"}], ",", 
             RowBox[{"v", "[", "1", "]"}]}], "]"}]], 
          RowBox[{"c", "[", "4", "]"}], 
          RowBox[{"dot", "[", 
           RowBox[{
            RowBox[{"p", "[", "3", "]"}], ",", 
            RowBox[{"S", "[", "0", "]"}], ",", 
            RowBox[{"\[Epsilon]", "[", "3", "]"}]}], "]"}], "*", 
          RowBox[{"dot", "[", 
           RowBox[{
            RowBox[{"v", "[", "1", "]"}], ",", 
            RowBox[{"F", "[", "1", "]"}], ",", 
            RowBox[{"F", "[", "2", "]"}], ",", 
            RowBox[{"v", "[", "1", "]"}]}], "]"}]}]}], ")"}]}], "//.", 
      "dotRules"}], "//", "expandFS"}], "//", "Expand"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"numvp1", "=", 
   RowBox[{
    RowBox[{
     RowBox[{"numvp1", "//.", "dotRules"}], "/.", "vponshell"}], "/.", 
    RowBox[{"{", 
     RowBox[{
      RowBox[{
       RowBox[{"dot", "[", 
        RowBox[{
         RowBox[{"p", "[", "3", "]"}], ",", 
         RowBox[{"v", "[", "1", "]"}]}], "]"}], "->", "0"}], ",", 
      RowBox[{
       RowBox[{"dot", "[", 
        RowBox[{
         RowBox[{"p", "[", "2", "]"}], ",", 
         RowBox[{"v", "[", "1", "]"}]}], "]"}], "->", 
       RowBox[{"-", 
        RowBox[{"dot", "[", 
         RowBox[{
          RowBox[{"p", "[", "1", "]"}], ",", 
          RowBox[{"v", "[", "1", "]"}]}], "]"}]}]}]}], "}"}]}]}], 
  ";"}]}], "Input",
 CellChangeTimes->{{3.878077591985273*^9, 3.8780776461342783`*^9}, {
   3.878077953502172*^9, 3.878077980733405*^9}, {3.878078491930747*^9, 
   3.878078549563458*^9}, {3.878078580745262*^9, 3.87807865251903*^9}, 
   3.878078684800146*^9, {3.878079206140265*^9, 3.878079212664543*^9}, {
   3.878079938416065*^9, 3.8780799390210323`*^9}, {3.878079982854789*^9, 
   3.878079996138009*^9}, 3.878080718496252*^9, 3.878080776110016*^9, {
   3.878081116226698*^9, 3.8780811179219093`*^9}, {3.878081897887516*^9, 
   3.878081929737031*^9}, {3.8780819770250673`*^9, 3.8780819885274878`*^9}, 
   3.8780820357161922`*^9, {3.878082093586617*^9, 3.878082094494379*^9}, 
   3.878082200584118*^9, 3.8780823524734297`*^9, 3.8780843780876017`*^9, {
   3.87808451838385*^9, 3.878084553403726*^9}, {3.878084767872551*^9, 
   3.878084809993238*^9}, {3.878093413770879*^9, 3.878093418381057*^9}, 
   3.878094731163116*^9, {3.878094787760552*^9, 3.878094870939351*^9}, {
   3.878094944453622*^9, 3.878094946794712*^9}, {3.878095374742682*^9, 
   3.878095391986203*^9}, {3.8780954563856373`*^9, 3.878095483306056*^9}, {
   3.878095605265438*^9, 3.878095616154799*^9}, {3.878095684075735*^9, 
   3.878095688268168*^9}},
 CellLabel->
  "In[1965]:=",ExpressionUUID->"2944e463-041a-4acb-b4e9-cb5e2bc0dad0"],

Cell[BoxData[
 RowBox[{
  RowBox[{"compvp1", "=", 
   RowBox[{"numAnsatzvp1", "-", "numvp1"}]}], ";"}]], "Input",
 CellChangeTimes->{{3.8780781147500143`*^9, 3.878078179889933*^9}, {
   3.878078714167301*^9, 3.878078719908218*^9}, {3.878078864983605*^9, 
   3.8780788894932623`*^9}, 3.878079927920136*^9, 3.87808000213634*^9},
 CellLabel->
  "In[1969]:=",ExpressionUUID->"ceb566d5-292a-4b84-806d-0202035da45c"],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"compvp1", "/.", 
  RowBox[{"{", 
   RowBox[{
    RowBox[{
     RowBox[{"c", "[", "3", "]"}], "->", "1"}], ",", 
    RowBox[{
     RowBox[{"c", "[", "4", "]"}], "->", "1"}]}], "}"}]}]], "Input",
 CellChangeTimes->{{3.878095527643024*^9, 3.878095578279685*^9}, {
  3.878095625110869*^9, 3.878095641471002*^9}},
 CellLabel->
  "In[1970]:=",ExpressionUUID->"4e582181-64d9-48f1-8e0b-68bb2f74a942"],

Cell[BoxData[
 InterpretationBox[
  TagBox[
   FrameBox[GridBox[{
      {
       ItemBox[
        TagBox[
         RowBox[{
          TemplateBox[{"411"},
           "OutputSizeLimit`Skeleton"], "+", 
          RowBox[{
           RowBox[{"c", "[", "147", "]"}], " ", 
           TemplateBox[{"3"},
            "OutputSizeLimit`Skeleton"], " ", 
           RowBox[{"dot", "[", 
            RowBox[{
             RowBox[{"\[Epsilon]", "[", "2", "]"}], ",", 
             RowBox[{"S", "[", "0", "]"}], ",", 
             RowBox[{"\[Epsilon]", "[", "3", "]"}]}], "]"}]}], "+", 
          RowBox[{
           RowBox[{"c", "[", "149", "]"}], " ", 
           RowBox[{"dot", "[", 
            RowBox[{
             RowBox[{"p", "[", "1", "]"}], ",", 
             RowBox[{"p", "[", "3", "]"}]}], "]"}], " ", 
           RowBox[{"dot", "[", 
            RowBox[{
             RowBox[{"p", "[", "2", "]"}], ",", 
             RowBox[{"p", "[", "3", "]"}]}], "]"}], " ", 
           RowBox[{"dot", "[", 
            RowBox[{
             RowBox[{"v", "[", "1", "]"}], ",", 
             RowBox[{"\[Epsilon]", "[", "1", "]"}]}], "]"}], " ", 
           RowBox[{"dot", "[", 
            RowBox[{
             RowBox[{"\[Epsilon]", "[", "2", "]"}], ",", 
             RowBox[{"S", "[", "0", "]"}], ",", 
             RowBox[{"\[Epsilon]", "[", "3", "]"}]}], "]"}]}]}],
         Short[#, 5]& ],
        BaseStyle->{Deployed -> False},
        StripOnInput->False]},
      {GridBox[{
         {
          PaneBox[
           TagBox[
            TooltipBox[
             StyleBox[
              StyleBox[
               DynamicBox[ToBoxes[
                 FEPrivate`FrontEndResource[
                 "FEStrings", "sizeBriefExplanation"], StandardForm],
                ImageSizeCache->{70., {3., 10.}}],
               StripOnInput->False,
               DynamicUpdating->True,
               LineSpacing->{1, 2},
               LineIndent->0,
               LinebreakAdjustments->{1., 100, 0, 0, 0}], "OSLText",
              StripOnInput->False],
             StyleBox[
              DynamicBox[
               ToBoxes[
                FEPrivate`FrontEndResource["FEStrings", "sizeExplanation"], 
                StandardForm]], DynamicUpdating -> True, LineIndent -> 0, 
              LinebreakAdjustments -> {1., 100, 0, 0, 0}, 
              LineSpacing -> {1, 2}, StripOnInput -> False]],
            Annotation[#, 
             Style[
              Dynamic[
               FEPrivate`FrontEndResource["FEStrings", "sizeExplanation"]], 
              DynamicUpdating -> True, LineIndent -> 0, 
              LinebreakAdjustments -> {1., 100, 0, 0, 0}, 
              LineSpacing -> {1, 2}], "Tooltip"]& ],
           Alignment->Center,
           BaselinePosition->Baseline,
           ImageSize->{Automatic, {25, Full}}], 
          ButtonBox[
           PaneSelectorBox[{False->
            StyleBox[
             StyleBox[
              DynamicBox[ToBoxes[
                FEPrivate`FrontEndResource["FEStrings", "sizeShowLess"], 
                StandardForm],
               ImageSizeCache->{61., {0., 10.}}],
              StripOnInput->False,
              DynamicUpdating->True,
              LineSpacing->{1, 2},
              LineIndent->0,
              LinebreakAdjustments->{1., 100, 0, 0, 0}], "OSLControl",
             StripOnInput->False], True->
            StyleBox[
             StyleBox[
              DynamicBox[ToBoxes[
                FEPrivate`FrontEndResource["FEStrings", "sizeShowLess"], 
                StandardForm]],
              StripOnInput->False,
              DynamicUpdating->True,
              LineSpacing->{1, 2},
              LineIndent->0,
              LinebreakAdjustments->{1., 100, 0, 0, 0}], "OSLControlActive",
             StripOnInput->False]}, Dynamic[
             CurrentValue["MouseOver"]],
            Alignment->Center,
            FrameMargins->0,
            ImageSize->{Automatic, {25, Full}}],
           Appearance->None,
           BaselinePosition->Baseline,
           
           ButtonFunction:>OutputSizeLimit`ButtonFunction[
            OutputSizeLimit`Defer, 1970, 28410112452836994704, 5/2],
           Enabled->True,
           Evaluator->Automatic,
           Method->"Queued"], 
          ButtonBox[
           PaneSelectorBox[{False->
            StyleBox[
             StyleBox[
              DynamicBox[ToBoxes[
                FEPrivate`FrontEndResource["FEStrings", "sizeShowMore"], 
                StandardForm],
               ImageSizeCache->{68., {0., 10.}}],
              StripOnInput->False,
              DynamicUpdating->True,
              LineSpacing->{1, 2},
              LineIndent->0,
              LinebreakAdjustments->{1., 100, 0, 0, 0}], "OSLControl",
             StripOnInput->False], True->
            StyleBox[
             StyleBox[
              DynamicBox[ToBoxes[
                FEPrivate`FrontEndResource["FEStrings", "sizeShowMore"], 
                StandardForm]],
              StripOnInput->False,
              DynamicUpdating->True,
              LineSpacing->{1, 2},
              LineIndent->0,
              LinebreakAdjustments->{1., 100, 0, 0, 0}], "OSLControlActive",
             StripOnInput->False]}, Dynamic[
             CurrentValue["MouseOver"]],
            Alignment->Center,
            FrameMargins->0,
            ImageSize->{Automatic, {25, Full}}],
           Appearance->None,
           BaselinePosition->Baseline,
           
           ButtonFunction:>OutputSizeLimit`ButtonFunction[
            OutputSizeLimit`Defer, 1970, 28410112452836994704, 5 2],
           Enabled->True,
           Evaluator->Automatic,
           Method->"Queued"], 
          ButtonBox[
           PaneSelectorBox[{False->
            StyleBox[
             StyleBox[
              DynamicBox[ToBoxes[
                FEPrivate`FrontEndResource["FEStrings", "sizeShowAll"], 
                StandardForm],
               ImageSizeCache->{51., {0., 10.}}],
              StripOnInput->False,
              DynamicUpdating->True,
              LineSpacing->{1, 2},
              LineIndent->0,
              LinebreakAdjustments->{1., 100, 0, 0, 0}], "OSLControl",
             StripOnInput->False], True->
            StyleBox[
             StyleBox[
              DynamicBox[ToBoxes[
                FEPrivate`FrontEndResource["FEStrings", "sizeShowAll"], 
                StandardForm]],
              StripOnInput->False,
              DynamicUpdating->True,
              LineSpacing->{1, 2},
              LineIndent->0,
              LinebreakAdjustments->{1., 100, 0, 0, 0}], "OSLControlActive",
             StripOnInput->False]}, Dynamic[
             CurrentValue["MouseOver"]],
            Alignment->Center,
            FrameMargins->0,
            ImageSize->{Automatic, {25, Full}}],
           Appearance->None,
           BaselinePosition->Baseline,
           
           ButtonFunction:>OutputSizeLimit`ButtonFunction[
            OutputSizeLimit`Defer, 1970, 28410112452836994704, Infinity],
           Enabled->True,
           Evaluator->Automatic,
           Method->"Queued"], 
          ButtonBox[
           PaneSelectorBox[{False->
            StyleBox[
             StyleBox[
              DynamicBox[ToBoxes[
                FEPrivate`FrontEndResource["FEStrings", "sizeChangeLimit"], 
                StandardForm],
               ImageSizeCache->{91., {1., 10.}}],
              StripOnInput->False,
              DynamicUpdating->True,
              LineSpacing->{1, 2},
              LineIndent->0,
              LinebreakAdjustments->{1., 100, 0, 0, 0}], "OSLControl",
             StripOnInput->False], True->
            StyleBox[
             StyleBox[
              DynamicBox[ToBoxes[
                FEPrivate`FrontEndResource["FEStrings", "sizeChangeLimit"], 
                StandardForm]],
              StripOnInput->False,
              DynamicUpdating->True,
              LineSpacing->{1, 2},
              LineIndent->0,
              LinebreakAdjustments->{1., 100, 0, 0, 0}], "OSLControlActive",
             StripOnInput->False]}, Dynamic[
             CurrentValue["MouseOver"]],
            Alignment->Center,
            FrameMargins->0,
            ImageSize->{Automatic, {25, Full}}],
           Appearance->None,
           BaselinePosition->Baseline,
           ButtonFunction:>FrontEndExecute[{
              FrontEnd`SetOptions[
              FrontEnd`$FrontEnd, 
               FrontEnd`PreferencesSettings -> {"Page" -> "Advanced"}], 
              FrontEnd`FrontEndToken["PreferencesDialog"]}],
           Evaluator->None,
           Method->"Preemptive"]}
        },
        AutoDelete->False,
        FrameStyle->GrayLevel[0.85],
        GridBoxDividers->{"Columns" -> {False, {True}}},
        GridBoxItemSize->{"Columns" -> {{Automatic}}, "Rows" -> {{Automatic}}},
        GridBoxSpacings->{"Columns" -> {{2}}}]}
     },
     DefaultBaseStyle->"Column",
     GridBoxAlignment->{"Columns" -> {{Left}}, "Rows" -> {{Baseline}}},
     GridBoxDividers->{"Columns" -> {{False}}, "Rows" -> {{False}}},
     GridBoxItemSize->{"Columns" -> {{Automatic}}, "Rows" -> {{1.}}},
     GridBoxSpacings->{"Columns" -> {
         Offset[0.27999999999999997`], {
          Offset[0.5599999999999999]}, 
         Offset[0.27999999999999997`]}, "Rows" -> {
         Offset[0.2], 
         Offset[1.2], {
          Offset[0.4]}, 
         Offset[0.2]}}],
    BaseStyle->"OutputSizeLimit",
    FrameMargins->{{12, 12}, {0, 15}},
    FrameStyle->GrayLevel[0.85],
    RoundingRadius->5,
    StripOnInput->False],
   Deploy,
   DefaultBaseStyle->"Deploy"],
  If[28410112452836994704 === $SessionID, 
   Out[1970], Message[
     MessageName[Syntax, "noinfoker"]]; Missing["NotAvailable"]; 
   Null]]], "Output",
 CellChangeTimes->{{3.878095519546192*^9, 3.878095530830967*^9}, {
   3.8780955685470467`*^9, 3.878095578769575*^9}, {3.8780956254979887`*^9, 
   3.87809564203146*^9}, 3.878095695176092*^9, 3.8780960673961983`*^9, 
   3.8781117349284163`*^9},
 CellLabel->
  "Out[1970]=",ExpressionUUID->"dae58a1e-115c-4400-bd31-ea80c13021c1"]
}, Open  ]],

Cell[BoxData[{
 RowBox[{
  RowBox[{"cvars", "=", 
   RowBox[{
    RowBox[{"Cases", "[", 
     RowBox[{"compvp1", ",", 
      RowBox[{"c", "[", "__", "]"}], ",", 
      RowBox[{"{", 
       RowBox[{"0", ",", "\[Infinity]"}], "}"}]}], "]"}], "//", "Union"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"vardot", "=", 
   RowBox[{"compvp1", "//", "Casesdot"}]}], ";"}]}], "Input",
 CellChangeTimes->{{3.878078218083035*^9, 3.878078227195683*^9}},
 CellLabel->
  "In[1971]:=",ExpressionUUID->"578da957-5282-4fd5-9530-ac3721c0f902"],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"cvars", "//", "Length"}]], "Input",
 CellChangeTimes->{{3.878078250405406*^9, 3.8780782515980988`*^9}, 
   3.8780793030421352`*^9, {3.878080618122617*^9, 3.878080619511405*^9}},
 CellLabel->
  "In[1973]:=",ExpressionUUID->"55a88c8e-c935-44b1-abdc-81867df14125"],

Cell[BoxData["42"], "Output",
 CellChangeTimes->{
  3.878078252063862*^9, 3.878078732430634*^9, {3.8780792683050127`*^9, 
   3.878079303531766*^9}, {3.8780806116761723`*^9, 3.878080620497012*^9}, 
   3.878080793272333*^9, 3.8780810935750732`*^9, 3.8780811318686132`*^9, 
   3.878081941084124*^9, 3.8780820011325197`*^9, 3.878082120982493*^9, 
   3.878084828486793*^9, 3.878085517830093*^9, 3.878093680935251*^9, 
   3.878095084936636*^9, 3.878095713545517*^9, 3.878096067412579*^9, 
   3.878111734948662*^9},
 CellLabel->
  "Out[1973]=",ExpressionUUID->"2258df6e-4adf-431b-b2f9-1fbedad4ad0c"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{
  RowBox[{"dot2num", ":=", 
   RowBox[{"Table", "[", 
    RowBox[{
     RowBox[{"Rule", "[", 
      RowBox[{
       RowBox[{"vardot", "[", 
        RowBox[{"[", "ii", "]"}], "]"}], ",", 
       RowBox[{"RandomInteger", "[", 
        RowBox[{"{", 
         RowBox[{"10", ",", "100"}], "}"}], "]"}]}], "]"}], ",", 
     RowBox[{"{", 
      RowBox[{"ii", ",", 
       RowBox[{"Length", "[", "vardot", "]"}]}], "}"}]}], "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{"Monitor", "[", 
  RowBox[{
   RowBox[{
    RowBox[{"eqDep", "=", 
     RowBox[{"Table", "[", 
      RowBox[{
       RowBox[{
        RowBox[{"compvp1", "\[Equal]", "0"}], "/.", "dot2num"}], ",", 
       RowBox[{"{", 
        RowBox[{"ii", ",", 
         RowBox[{"10", "+", 
          RowBox[{"Length", "[", "cvars", "]"}]}]}], "}"}]}], "]"}]}], ";"}], 
   ",", "ii"}], "]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"solsvp3", "=", 
   RowBox[{
    RowBox[{"Solve", "[", 
     RowBox[{"eqDep", ",", "cvars"}], "]"}], "[", 
    RowBox[{"[", "1", "]"}], "]"}]}], ";"}]}], "Input",
 CellChangeTimes->{{3.878078221639757*^9, 3.878078240954069*^9}, {
  3.878081064658252*^9, 3.8780810690042477`*^9}, {3.878095733492796*^9, 
  3.878095733629385*^9}},
 CellLabel->
  "In[1974]:=",ExpressionUUID->"55ed02f0-5029-4486-8aa9-90f743334a2d"],

Cell[BoxData[
 TemplateBox[{
  "Part", "partw", 
   "\"Part \\!\\(\\*RowBox[{\\\"1\\\"}]\\) of \\!\\(\\*RowBox[{\\\"{\\\", \
\\\"}\\\"}]\\) does not exist.\"", 2, 1976, 91, 28410112452836994704, "Local"},
  "MessageTemplate"]], "Message", "MSG",
 CellChangeTimes->{3.878111735040667*^9},
 CellLabel->
  "During evaluation of \
In[1974]:=",ExpressionUUID->"e6101b93-9894-4eb4-955e-5c8c9c584629"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData["solsvp3"], "Input",
 CellChangeTimes->{{3.878096861054673*^9, 3.8780968614695673`*^9}},
 CellLabel->
  "In[1977]:=",ExpressionUUID->"530c074c-4a1f-4e4c-b6fb-3525f3d0619d"],

Cell[BoxData[
 RowBox[{
  RowBox[{"{", "}"}], "\[LeftDoubleBracket]", "1", 
  "\[RightDoubleBracket]"}]], "Output",
 CellChangeTimes->{3.878093691306862*^9, 3.878095112706624*^9, 
  3.878095717543086*^9, 3.878096067453002*^9, 3.878096861847978*^9, 
  3.878106689921917*^9, 3.8781107730356693`*^9, 3.8781117350474157`*^9},
 CellLabel->
  "Out[1977]=",ExpressionUUID->"40b43df2-c262-4804-ae73-203fa1385290"]
}, Open  ]]
}, Closed]],

Cell[CellGroupData[{

Cell["Final Result", "Subsection",
 CellChangeTimes->{{3.878095815607132*^9, 
  3.878095824409616*^9}},ExpressionUUID->"90bcefed-5dc3-4e0f-aad2-\
1b12a6b9f00c"],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{
     RowBox[{
      RowBox[{"numAnsatz", "/.", "sols"}], "/.", "solsvp1"}], "/.", 
     "solsvp2"}], "/.", 
    RowBox[{
     RowBox[{"c", "[", "__", "]"}], ":>", "0"}]}], "/.", "nicevs"}], "//.", 
  "nice"}]], "Input",
 CellChangeTimes->{{3.878096992646886*^9, 3.8780970253597383`*^9}, {
  3.878097865895237*^9, 3.878097895808736*^9}},
 CellLabel->
  "In[1985]:=",ExpressionUUID->"60fe8754-c35b-431a-a109-481025a83ebd"],

Cell[BoxData[
 RowBox[{
  FractionBox[
   RowBox[{
    RowBox[{
     SubscriptBox["p", "1"], "\[CenterDot]", "S", "\[CenterDot]", 
     SubscriptBox["p", "2"]}], " ", 
    RowBox[{"v", "\[CenterDot]", 
     SubscriptBox["F", "2"], "\[CenterDot]", 
     SubscriptBox["F", "1"], "\[CenterDot]", 
     SubscriptBox["F", "3"], "\[CenterDot]", "v"}]}], 
   RowBox[{
    RowBox[{"v", "\[CenterDot]", 
     SubscriptBox["p", "1"]}], " ", 
    RowBox[{"(", 
     RowBox[{
      RowBox[{"v", "\[CenterDot]", 
       SubscriptBox["p", "1"]}], "+", 
      RowBox[{"v", "\[CenterDot]", 
       SubscriptBox["p", "2"]}]}], ")"}]}]], "-", 
  FractionBox[
   RowBox[{
    RowBox[{
     SubscriptBox["p", "2"], "\[CenterDot]", 
     SubscriptBox["F", "3"], "\[CenterDot]", "v"}], " ", 
    RowBox[{
     SubscriptBox["p", "1"], "\[CenterDot]", "S", "\[CenterDot]", 
     SubscriptBox["F", "1"], "\[CenterDot]", 
     SubscriptBox["F", "2"], "\[CenterDot]", "v"}]}], 
   RowBox[{
    RowBox[{"v", "\[CenterDot]", 
     SubscriptBox["p", "1"]}], " ", 
    RowBox[{"(", 
     RowBox[{
      RowBox[{"v", "\[CenterDot]", 
       SubscriptBox["p", "1"]}], "+", 
      RowBox[{"v", "\[CenterDot]", 
       SubscriptBox["p", "2"]}]}], ")"}]}]], "-", 
  FractionBox[
   RowBox[{
    RowBox[{
     SubscriptBox["p", "1"], "\[CenterDot]", 
     SubscriptBox["F", "2"], "\[CenterDot]", "v"}], " ", 
    RowBox[{
     SubscriptBox["p", "1"], "\[CenterDot]", "S", "\[CenterDot]", 
     SubscriptBox["F", "1"], "\[CenterDot]", 
     SubscriptBox["F", "3"], "\[CenterDot]", "v"}]}], 
   RowBox[{
    RowBox[{"v", "\[CenterDot]", 
     SubscriptBox["p", "1"]}], " ", 
    RowBox[{"(", 
     RowBox[{
      RowBox[{"v", "\[CenterDot]", 
       SubscriptBox["p", "1"]}], "+", 
      RowBox[{"v", "\[CenterDot]", 
       SubscriptBox["p", "2"]}]}], ")"}]}]], "-", 
  FractionBox[
   RowBox[{
    RowBox[{
     SubscriptBox["p", "1"], "\[CenterDot]", 
     SubscriptBox["F", "2"], "\[CenterDot]", "v"}], " ", 
    RowBox[{
     SubscriptBox["p", "1"], "\[CenterDot]", "S", "\[CenterDot]", 
     SubscriptBox["F", "1"], "\[CenterDot]", 
     SubscriptBox["F", "3"], "\[CenterDot]", "v"}]}], 
   RowBox[{
    RowBox[{"v", "\[CenterDot]", 
     SubscriptBox["p", "1"]}], " ", 
    RowBox[{"(", 
     RowBox[{
      RowBox[{"v", "\[CenterDot]", 
       SubscriptBox["p", "1"]}], "+", 
      RowBox[{"v", "\[CenterDot]", 
       SubscriptBox["p", "3"]}]}], ")"}]}]], "-", 
  FractionBox[
   RowBox[{
    RowBox[{
     SubscriptBox["p", "2"], "\[CenterDot]", 
     SubscriptBox["F", "3"], "\[CenterDot]", "v"}], " ", 
    RowBox[{
     SubscriptBox["p", "2"], "\[CenterDot]", "S", "\[CenterDot]", 
     SubscriptBox["F", "1"], "\[CenterDot]", 
     SubscriptBox["F", "2"], "\[CenterDot]", "v"}]}], 
   RowBox[{
    RowBox[{"v", "\[CenterDot]", 
     SubscriptBox["p", "1"]}], " ", 
    RowBox[{"(", 
     RowBox[{
      RowBox[{"v", "\[CenterDot]", 
       SubscriptBox["p", "1"]}], "+", 
      RowBox[{"v", "\[CenterDot]", 
       SubscriptBox["p", "2"]}]}], ")"}]}]], "-", 
  FractionBox[
   RowBox[{
    RowBox[{
     SubscriptBox["p", "1"], "\[CenterDot]", 
     SubscriptBox["F", "2"], "\[CenterDot]", "v"}], " ", 
    RowBox[{
     SubscriptBox["p", "2"], "\[CenterDot]", "S", "\[CenterDot]", 
     SubscriptBox["F", "1"], "\[CenterDot]", 
     SubscriptBox["F", "3"], "\[CenterDot]", "v"}]}], 
   RowBox[{
    RowBox[{"v", "\[CenterDot]", 
     SubscriptBox["p", "1"]}], " ", 
    RowBox[{"(", 
     RowBox[{
      RowBox[{"v", "\[CenterDot]", 
       SubscriptBox["p", "1"]}], "+", 
      RowBox[{"v", "\[CenterDot]", 
       SubscriptBox["p", "2"]}]}], ")"}]}]], "-", 
  FractionBox[
   RowBox[{
    RowBox[{
     SubscriptBox["p", "1"], "\[CenterDot]", 
     SubscriptBox["F", "3"], "\[CenterDot]", "v"}], " ", 
    RowBox[{
     SubscriptBox["p", "2"], "\[CenterDot]", "S", "\[CenterDot]", 
     SubscriptBox["F", "2"], "\[CenterDot]", 
     SubscriptBox["F", "1"], "\[CenterDot]", "v"}]}], 
   RowBox[{
    RowBox[{"v", "\[CenterDot]", 
     SubscriptBox["p", "1"]}], " ", 
    RowBox[{"(", 
     RowBox[{
      RowBox[{"v", "\[CenterDot]", 
       SubscriptBox["p", "1"]}], "+", 
      RowBox[{"v", "\[CenterDot]", 
       SubscriptBox["p", "2"]}]}], ")"}]}]], "-", 
  FractionBox[
   RowBox[{
    RowBox[{
     SubscriptBox["p", "2"], "\[CenterDot]", 
     SubscriptBox["F", "1"], "\[CenterDot]", "v"}], " ", 
    RowBox[{
     SubscriptBox["p", "2"], "\[CenterDot]", "S", "\[CenterDot]", 
     SubscriptBox["F", "2"], "\[CenterDot]", 
     SubscriptBox["F", "3"], "\[CenterDot]", "v"}]}], 
   RowBox[{
    RowBox[{"v", "\[CenterDot]", 
     SubscriptBox["p", "1"]}], " ", 
    RowBox[{"(", 
     RowBox[{
      RowBox[{"v", "\[CenterDot]", 
       SubscriptBox["p", "1"]}], "+", 
      RowBox[{"v", "\[CenterDot]", 
       SubscriptBox["p", "2"]}]}], ")"}]}]], "+", 
  FractionBox[
   RowBox[{
    RowBox[{
     SubscriptBox["p", "1"], "\[CenterDot]", 
     SubscriptBox["F", "3"], "\[CenterDot]", "v"}], " ", 
    RowBox[{
     SubscriptBox["p", "2"], "\[CenterDot]", 
     SubscriptBox["F", "1"], "\[CenterDot]", "S", "\[CenterDot]", 
     SubscriptBox["F", "2"], "\[CenterDot]", "v"}]}], 
   RowBox[{
    RowBox[{"v", "\[CenterDot]", 
     SubscriptBox["p", "1"]}], " ", 
    RowBox[{"(", 
     RowBox[{
      RowBox[{"v", "\[CenterDot]", 
       SubscriptBox["p", "1"]}], "+", 
      RowBox[{"v", "\[CenterDot]", 
       SubscriptBox["p", "2"]}]}], ")"}]}]], "+", 
  FractionBox[
   RowBox[{
    RowBox[{
     SubscriptBox["p", "2"], "\[CenterDot]", 
     SubscriptBox["F", "3"], "\[CenterDot]", "v"}], " ", 
    RowBox[{
     SubscriptBox["p", "2"], "\[CenterDot]", 
     SubscriptBox["F", "1"], "\[CenterDot]", "S", "\[CenterDot]", 
     SubscriptBox["F", "2"], "\[CenterDot]", "v"}]}], 
   RowBox[{
    RowBox[{"v", "\[CenterDot]", 
     SubscriptBox["p", "1"]}], " ", 
    RowBox[{"(", 
     RowBox[{
      RowBox[{"v", "\[CenterDot]", 
       SubscriptBox["p", "1"]}], "+", 
      RowBox[{"v", "\[CenterDot]", 
       SubscriptBox["p", "2"]}]}], ")"}]}]], "-", 
  FractionBox[
   RowBox[{
    RowBox[{
     SubscriptBox["p", "1"], "\[CenterDot]", 
     SubscriptBox["F", "2"], "\[CenterDot]", "v"}], " ", 
    RowBox[{
     SubscriptBox["p", "3"], "\[CenterDot]", "S", "\[CenterDot]", 
     SubscriptBox["F", "1"], "\[CenterDot]", 
     SubscriptBox["F", "3"], "\[CenterDot]", "v"}]}], 
   RowBox[{
    RowBox[{"v", "\[CenterDot]", 
     SubscriptBox["p", "1"]}], " ", 
    RowBox[{"(", 
     RowBox[{
      RowBox[{"v", "\[CenterDot]", 
       SubscriptBox["p", "1"]}], "+", 
      RowBox[{"v", "\[CenterDot]", 
       SubscriptBox["p", "3"]}]}], ")"}]}]], "-", 
  FractionBox[
   RowBox[{
    RowBox[{
     SubscriptBox["p", "1"], "\[CenterDot]", 
     SubscriptBox["F", "2"], "\[CenterDot]", "v"}], " ", 
    RowBox[{
     SubscriptBox["p", "3"], "\[CenterDot]", "S", "\[CenterDot]", 
     SubscriptBox["F", "3"], "\[CenterDot]", 
     SubscriptBox["F", "1"], "\[CenterDot]", "v"}]}], 
   RowBox[{
    RowBox[{"v", "\[CenterDot]", 
     SubscriptBox["p", "1"]}], " ", 
    RowBox[{"(", 
     RowBox[{
      RowBox[{"v", "\[CenterDot]", 
       SubscriptBox["p", "1"]}], "+", 
      RowBox[{"v", "\[CenterDot]", 
       SubscriptBox["p", "3"]}]}], ")"}]}]], "+", 
  FractionBox[
   RowBox[{
    RowBox[{
     SubscriptBox["p", "1"], "\[CenterDot]", 
     SubscriptBox["F", "2"], "\[CenterDot]", "v"}], " ", 
    RowBox[{
     SubscriptBox["p", "3"], "\[CenterDot]", 
     SubscriptBox["F", "1"], "\[CenterDot]", "S", "\[CenterDot]", 
     SubscriptBox["F", "3"], "\[CenterDot]", "v"}]}], 
   RowBox[{
    RowBox[{"v", "\[CenterDot]", 
     SubscriptBox["p", "1"]}], " ", 
    RowBox[{"(", 
     RowBox[{
      RowBox[{"v", "\[CenterDot]", 
       SubscriptBox["p", "1"]}], "+", 
      RowBox[{"v", "\[CenterDot]", 
       SubscriptBox["p", "3"]}]}], ")"}]}]], "+", 
  FractionBox[
   RowBox[{
    SubscriptBox["p", "1"], "\[CenterDot]", "S", "\[CenterDot]", 
    SubscriptBox["F", "1"], "\[CenterDot]", 
    SubscriptBox["F", "2"], "\[CenterDot]", 
    SubscriptBox["F", "3"], "\[CenterDot]", "v"}], 
   RowBox[{"v", "\[CenterDot]", 
    SubscriptBox["p", "1"]}]], "-", 
  FractionBox[
   RowBox[{
    SubscriptBox["p", "1"], "\[CenterDot]", "S", "\[CenterDot]", 
    SubscriptBox["F", "2"], "\[CenterDot]", 
    SubscriptBox["F", "1"], "\[CenterDot]", 
    SubscriptBox["F", "3"], "\[CenterDot]", "v"}], 
   RowBox[{"v", "\[CenterDot]", 
    SubscriptBox["p", "1"]}]], "-", 
  FractionBox[
   RowBox[{
    SubscriptBox["p", "1"], "\[CenterDot]", "S", "\[CenterDot]", 
    SubscriptBox["F", "3"], "\[CenterDot]", 
    SubscriptBox["F", "1"], "\[CenterDot]", 
    SubscriptBox["F", "2"], "\[CenterDot]", "v"}], 
   RowBox[{"v", "\[CenterDot]", 
    SubscriptBox["p", "1"]}]], "+", 
  FractionBox[
   RowBox[{
    SubscriptBox["p", "1"], "\[CenterDot]", 
    SubscriptBox["F", "2"], "\[CenterDot]", "S", "\[CenterDot]", 
    SubscriptBox["F", "1"], "\[CenterDot]", 
    SubscriptBox["F", "3"], "\[CenterDot]", "v"}], 
   RowBox[{"v", "\[CenterDot]", 
    SubscriptBox["p", "1"]}]], "+", 
  FractionBox[
   RowBox[{
    SubscriptBox["p", "1"], "\[CenterDot]", 
    SubscriptBox["F", "3"], "\[CenterDot]", "S", "\[CenterDot]", 
    SubscriptBox["F", "1"], "\[CenterDot]", 
    SubscriptBox["F", "2"], "\[CenterDot]", "v"}], 
   RowBox[{"v", "\[CenterDot]", 
    SubscriptBox["p", "1"]}]], "+", 
  FractionBox[
   RowBox[{
    SubscriptBox["p", "2"], "\[CenterDot]", "S", "\[CenterDot]", 
    SubscriptBox["F", "1"], "\[CenterDot]", 
    SubscriptBox["F", "2"], "\[CenterDot]", 
    SubscriptBox["F", "3"], "\[CenterDot]", "v"}], 
   RowBox[{"v", "\[CenterDot]", 
    SubscriptBox["p", "1"]}]], "-", 
  FractionBox[
   RowBox[{
    SubscriptBox["p", "2"], "\[CenterDot]", "S", "\[CenterDot]", 
    SubscriptBox["F", "3"], "\[CenterDot]", 
    SubscriptBox["F", "1"], "\[CenterDot]", 
    SubscriptBox["F", "2"], "\[CenterDot]", "v"}], 
   RowBox[{"v", "\[CenterDot]", 
    SubscriptBox["p", "1"]}]], "-", 
  FractionBox[
   RowBox[{
    SubscriptBox["p", "2"], "\[CenterDot]", "S", "\[CenterDot]", 
    SubscriptBox["F", "3"], "\[CenterDot]", 
    SubscriptBox["F", "2"], "\[CenterDot]", 
    SubscriptBox["F", "1"], "\[CenterDot]", "v"}], 
   RowBox[{"v", "\[CenterDot]", 
    SubscriptBox["p", "1"]}]], "-", 
  FractionBox[
   RowBox[{
    SubscriptBox["p", "2"], "\[CenterDot]", 
    SubscriptBox["F", "1"], "\[CenterDot]", "S", "\[CenterDot]", 
    SubscriptBox["F", "2"], "\[CenterDot]", 
    SubscriptBox["F", "3"], "\[CenterDot]", "v"}], 
   RowBox[{"v", "\[CenterDot]", 
    SubscriptBox["p", "1"]}]], "+", 
  FractionBox[
   RowBox[{
    SubscriptBox["p", "2"], "\[CenterDot]", 
    SubscriptBox["F", "1"], "\[CenterDot]", "S", "\[CenterDot]", 
    SubscriptBox["F", "3"], "\[CenterDot]", 
    SubscriptBox["F", "2"], "\[CenterDot]", "v"}], 
   RowBox[{"v", "\[CenterDot]", 
    SubscriptBox["p", "1"]}]], "-", 
  FractionBox[
   RowBox[{
    SubscriptBox["p", "2"], "\[CenterDot]", 
    SubscriptBox["F", "1"], "\[CenterDot]", 
    SubscriptBox["F", "3"], "\[CenterDot]", "S", "\[CenterDot]", 
    SubscriptBox["F", "2"], "\[CenterDot]", "v"}], 
   RowBox[{"v", "\[CenterDot]", 
    SubscriptBox["p", "1"]}]], "+", 
  FractionBox[
   RowBox[{
    SubscriptBox["p", "2"], "\[CenterDot]", 
    SubscriptBox["F", "3"], "\[CenterDot]", "S", "\[CenterDot]", 
    SubscriptBox["F", "1"], "\[CenterDot]", 
    SubscriptBox["F", "2"], "\[CenterDot]", "v"}], 
   RowBox[{"v", "\[CenterDot]", 
    SubscriptBox["p", "1"]}]], "+", 
  FractionBox[
   RowBox[{
    SubscriptBox["p", "2"], "\[CenterDot]", 
    SubscriptBox["F", "3"], "\[CenterDot]", "S", "\[CenterDot]", 
    SubscriptBox["F", "2"], "\[CenterDot]", 
    SubscriptBox["F", "1"], "\[CenterDot]", "v"}], 
   RowBox[{"v", "\[CenterDot]", 
    SubscriptBox["p", "1"]}]], "+", 
  FractionBox[
   RowBox[{
    SubscriptBox["p", "3"], "\[CenterDot]", "S", "\[CenterDot]", 
    SubscriptBox["F", "1"], "\[CenterDot]", 
    SubscriptBox["F", "2"], "\[CenterDot]", 
    SubscriptBox["F", "3"], "\[CenterDot]", "v"}], 
   RowBox[{"v", "\[CenterDot]", 
    SubscriptBox["p", "1"]}]], "-", 
  FractionBox[
   RowBox[{
    SubscriptBox["p", "3"], "\[CenterDot]", "S", "\[CenterDot]", 
    SubscriptBox["F", "2"], "\[CenterDot]", 
    SubscriptBox["F", "1"], "\[CenterDot]", 
    SubscriptBox["F", "3"], "\[CenterDot]", "v"}], 
   RowBox[{"v", "\[CenterDot]", 
    SubscriptBox["p", "1"]}]], "-", 
  FractionBox[
   RowBox[{
    SubscriptBox["p", "3"], "\[CenterDot]", "S", "\[CenterDot]", 
    SubscriptBox["F", "3"], "\[CenterDot]", 
    SubscriptBox["F", "2"], "\[CenterDot]", 
    SubscriptBox["F", "1"], "\[CenterDot]", "v"}], 
   RowBox[{"v", "\[CenterDot]", 
    SubscriptBox["p", "1"]}]], "-", 
  FractionBox[
   RowBox[{
    SubscriptBox["p", "3"], "\[CenterDot]", 
    SubscriptBox["F", "1"], "\[CenterDot]", 
    SubscriptBox["F", "2"], "\[CenterDot]", "S", "\[CenterDot]", 
    SubscriptBox["F", "3"], "\[CenterDot]", "v"}], 
   RowBox[{"v", "\[CenterDot]", 
    SubscriptBox["p", "1"]}]], "+", 
  FractionBox[
   RowBox[{
    SubscriptBox["p", "3"], "\[CenterDot]", 
    SubscriptBox["F", "2"], "\[CenterDot]", 
    SubscriptBox["F", "1"], "\[CenterDot]", "S", "\[CenterDot]", 
    SubscriptBox["F", "3"], "\[CenterDot]", "v"}], 
   RowBox[{"v", "\[CenterDot]", 
    SubscriptBox["p", "1"]}]]}]], "Output",
 CellChangeTimes->{{3.878096994542691*^9, 3.878097026032852*^9}, {
   3.8780978736826763`*^9, 3.878097896716341*^9}, 3.878111735490789*^9, 
   3.878113589747751*^9},
 CellLabel->
  "Out[1985]=",ExpressionUUID->"e70bd20e-4e54-46df-acee-645ae5392333"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"%", "//", "Length"}]], "Input",
 CellChangeTimes->{{3.878113574319078*^9, 3.878113580755939*^9}},
 CellLabel->
  "In[1986]:=",ExpressionUUID->"11e0c9cc-4ab9-4885-9725-e46ef5282ed9"],

Cell[BoxData["31"], "Output",
 CellChangeTimes->{{3.878113581227591*^9, 3.8781135923436413`*^9}},
 CellLabel->
  "Out[1986]=",ExpressionUUID->"80b93f15-3ecd-4391-ba38-b2115dd566bf"]
}, Open  ]]
}, Open  ]]
}, Closed]],

Cell[CellGroupData[{

Cell["Example S Five point Independent ansatz", "Section",
 CellChangeTimes->{{3.877008171032135*^9, 3.877008177039516*^9}, {
  3.8773818494951763`*^9, 3.877381857475391*^9}, {3.878020608795433*^9, 
  3.87802061200184*^9}, {3.878106086500737*^9, 3.878106090914515*^9}, {
  3.878111369500721*^9, 
  3.8781113760129957`*^9}},ExpressionUUID->"69a8eb9f-9bdc-4fc6-90ff-\
d825789bcb7c"],

Cell[CellGroupData[{

Cell["Setup ansatz", "Subsection",
 CellChangeTimes->{{3.877386203620414*^9, 
  3.877386209613765*^9}},ExpressionUUID->"87c7d773-b634-4c06-8e11-\
d3348430a623"],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{
  RowBox[{"n", "=", "5"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"vponshell", "=", 
   RowBox[{
    RowBox[{"vonshell", "[", 
     RowBox[{
      RowBox[{"n", "-", "1"}], ",", "1"}], "]"}], "/.", 
    RowBox[{"v", "->", 
     RowBox[{"v", "[", "1", "]"}]}]}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{"gponshell", "=", 
  RowBox[{
   RowBox[{"onshell", "[", 
    RowBox[{"n", "-", "1"}], "]"}], "/.", 
   RowBox[{
    RowBox[{"s", "[", 
     RowBox[{"i_", ",", "j_"}], "]"}], ":>", 
    RowBox[{"dot", "[", 
     RowBox[{
      RowBox[{"p", "[", "i", "]"}], ",", 
      RowBox[{"p", "[", "j", "]"}]}], "]"}]}]}]}]}], "Input",
 CellChangeTimes->{{3.878020618673658*^9, 3.878020625406555*^9}, {
   3.878020685245474*^9, 3.8780206881234617`*^9}, 3.878021076476811*^9, {
   3.878022447789905*^9, 3.8780224652203074`*^9}, {3.878024579094555*^9, 
   3.87802460824821*^9}},
 CellLabel->
  "In[1594]:=",ExpressionUUID->"ab3b459b-5e90-48ea-bb16-27ca136e9a2f"],

Cell[BoxData[
 RowBox[{
  RowBox[{"dot", "[", 
   RowBox[{
    RowBox[{"p", "[", "2", "]"}], ",", 
    RowBox[{"p", "[", "3", "]"}]}], "]"}], "\[Rule]", 
  RowBox[{
   RowBox[{"-", 
    RowBox[{"dot", "[", 
     RowBox[{
      RowBox[{"p", "[", "1", "]"}], ",", 
      RowBox[{"p", "[", "2", "]"}]}], "]"}]}], "-", 
   RowBox[{"dot", "[", 
    RowBox[{
     RowBox[{"p", "[", "1", "]"}], ",", 
     RowBox[{"p", "[", "3", "]"}]}], "]"}]}]}]], "Output",
 CellChangeTimes->{{3.878024603364303*^9, 3.8780246086311693`*^9}, 
   3.8780958347602053`*^9, 3.8781061044812183`*^9},
 CellLabel->
  "Out[1596]=",ExpressionUUID->"8551b697-7f0b-4afd-9409-9c1a9bf0b94e"]
}, Open  ]],

Cell[BoxData[{
 RowBox[{
  RowBox[{"denOrder", "=", "1"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"monofs1", "=", 
   RowBox[{"monoFS", "[", 
    RowBox[{"denOrder", ",", 
     RowBox[{"n", "-", "2"}]}], "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"denOrder", "=", "2"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"monofs2", "=", 
   RowBox[{"monoFS", "[", 
    RowBox[{"denOrder", ",", 
     RowBox[{"n", "-", "2"}]}], "]"}]}], ";"}]}], "Input",
 CellChangeTimes->{{3.877381049405899*^9, 3.877381116483204*^9}, {
  3.877381244223319*^9, 3.877381284761427*^9}, {3.877381353256666*^9, 
  3.877381353488029*^9}, {3.87738186344316*^9, 3.877381863777376*^9}, {
  3.8773822047453117`*^9, 3.877382204987795*^9}, {3.8773825485753727`*^9, 
  3.877382548830839*^9}, {3.877382654557598*^9, 3.877382674685717*^9}, {
  3.878016251644945*^9, 3.87801627282722*^9}, {3.878018811842737*^9, 
  3.878018821618462*^9}, {3.878019111987747*^9, 3.8780191881088953`*^9}, {
  3.8780192243067636`*^9, 3.878019263820836*^9}, {3.8780196953188877`*^9, 
  3.8780197336534443`*^9}, {3.878028860196001*^9, 3.878028905573225*^9}},
 CellLabel->
  "In[1412]:=",ExpressionUUID->"10268b10-7e12-4f67-ac7e-7834e7d8622f"],

Cell[BoxData[{
 RowBox[{
  RowBox[{"monofs1", "=", 
   RowBox[{
    RowBox[{
     RowBox[{"(", 
      RowBox[{"List", "@@", 
       RowBox[{"(", 
        RowBox[{
         RowBox[{
          RowBox[{"monofs1", "/.", "vponshell"}], "//", "Total"}], "//", 
         "Expand"}], ")"}]}], ")"}], "/.", 
     RowBox[{
      RowBox[{"a_", " ", "b_"}], ":>", " ", 
      RowBox[{"b", "/;", 
       RowBox[{"NumberQ", "[", "a", "]"}]}]}]}], "//", "Union"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"monofs2", "=", 
   RowBox[{
    RowBox[{
     RowBox[{"(", 
      RowBox[{"List", "@@", 
       RowBox[{"(", 
        RowBox[{
         RowBox[{
          RowBox[{"monofs2", "/.", "vponshell"}], "//", "Total"}], "//", 
         "Expand"}], ")"}]}], ")"}], "/.", 
     RowBox[{
      RowBox[{"a_", " ", "b_"}], ":>", " ", 
      RowBox[{"b", "/;", 
       RowBox[{"NumberQ", "[", "a", "]"}]}]}]}], "//", "Union"}]}], 
  ";"}]}], "Input",
 CellChangeTimes->{{3.878106131993834*^9, 3.8781061481204767`*^9}},
 CellLabel->
  "In[1597]:=",ExpressionUUID->"dd6a16d8-db77-40b7-b9a5-a68054310c77"],

Cell[BoxData[
 RowBox[{
  RowBox[{"monofs1", "//", 
   RowBox[{"DeleteCases", "[", 
    RowBox[{"x_", "/;", 
     RowBox[{"(", 
      RowBox[{
       RowBox[{"(", 
        RowBox[{
         RowBox[{
          RowBox[{
           RowBox[{"expandFS", "[", "x", "]"}], "//.", "dotRules"}], "/.", 
          "vponshell"}], "//", "Expand"}], ")"}], "==", "0"}], ")"}]}], 
    "]"}]}], ";"}]], "Input",
 CellChangeTimes->{{3.878108977846291*^9, 3.878109026783236*^9}},
 CellLabel->
  "In[1694]:=",ExpressionUUID->"7273cea8-b47a-42ac-aa64-34bbea20dab4"],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"%", "//", "Length"}]], "Input",
 CellChangeTimes->{{3.87810898918363*^9, 3.8781089910668163`*^9}},
 CellLabel->
  "In[1695]:=",ExpressionUUID->"11885de8-753d-48de-bb3e-7a6788a2e370"],

Cell[BoxData["42"], "Output",
 CellChangeTimes->{{3.8781089915162067`*^9, 3.878109029411523*^9}},
 CellLabel->
  "Out[1695]=",ExpressionUUID->"37af76d3-a6fe-499c-87fa-42fcdb296086"]
}, Open  ]],

Cell[BoxData[
 RowBox[{
  RowBox[{"numAnsatz", "=", 
   RowBox[{
    RowBox[{"(", 
     RowBox[{
      FractionBox[
       RowBox[{
        RowBox[{
         RowBox[{"(", 
          RowBox[{"c", "/@", 
           RowBox[{"Range", "[", 
            RowBox[{"Length", "@", "monofs2"}], "]"}]}], ")"}], ".", 
         "monofs2"}], "/.", 
        RowBox[{
         RowBox[{"c", "[", "i_", "]"}], ":>", 
         RowBox[{"c", "[", 
          RowBox[{"1", ",", "i"}], "]"}]}]}], 
       RowBox[{
        RowBox[{"dot", "[", 
         RowBox[{
          RowBox[{"v", "[", "1", "]"}], ",", 
          RowBox[{"p", "[", "1", "]"}]}], "]"}], 
        RowBox[{"dot", "[", 
         RowBox[{
          RowBox[{"v", "[", "1", "]"}], ",", 
          RowBox[{
           RowBox[{"p", "[", "1", "]"}], "+", 
           RowBox[{"p", "[", "2", "]"}]}]}], "]"}]}]], "+", 
      FractionBox[
       RowBox[{
        RowBox[{
         RowBox[{"(", 
          RowBox[{"c", "/@", 
           RowBox[{"Range", "[", 
            RowBox[{"Length", "@", "monofs2"}], "]"}]}], ")"}], ".", 
         "monofs2"}], "/.", 
        RowBox[{
         RowBox[{"c", "[", "i_", "]"}], ":>", 
         RowBox[{"c", "[", 
          RowBox[{"2", ",", "i"}], "]"}]}]}], 
       RowBox[{
        RowBox[{"dot", "[", 
         RowBox[{
          RowBox[{"v", "[", "1", "]"}], ",", 
          RowBox[{"p", "[", "1", "]"}]}], "]"}], 
        RowBox[{"dot", "[", 
         RowBox[{
          RowBox[{"v", "[", "1", "]"}], ",", 
          RowBox[{
           RowBox[{"p", "[", "1", "]"}], "+", 
           RowBox[{"p", "[", "3", "]"}]}]}], "]"}]}]], "+", 
      FractionBox[
       RowBox[{
        RowBox[{
         RowBox[{"(", 
          RowBox[{"c", "/@", 
           RowBox[{"Range", "[", 
            RowBox[{"Length", "@", "monofs1"}], "]"}]}], ")"}], ".", 
         "monofs1"}], "/.", 
        RowBox[{
         RowBox[{"c", "[", "i_", "]"}], ":>", 
         RowBox[{"c", "[", 
          RowBox[{"3", ",", "i"}], "]"}]}]}], 
       RowBox[{"dot", "[", 
        RowBox[{
         RowBox[{"v", "[", "1", "]"}], ",", 
         RowBox[{"p", "[", "1", "]"}]}], "]"}]]}], ")"}], "//", "Expand"}]}], 
  ";"}]], "Input",
 CellChangeTimes->{{3.878019818828724*^9, 3.8780199018739433`*^9}, {
  3.878019938561898*^9, 3.878020036527034*^9}, {3.8780201912905703`*^9, 
  3.878020210990015*^9}, {3.87802091215549*^9, 3.8780209153502007`*^9}, {
  3.8780300130461073`*^9, 3.8780300429155807`*^9}, {3.8780319820804033`*^9, 
  3.87803198404319*^9}, {3.878032548017993*^9, 3.87803254970131*^9}, {
  3.8780755773066597`*^9, 3.878075579486418*^9}, {3.87808020451082*^9, 
  3.878080207422474*^9}, {3.8780802418491573`*^9, 3.878080244847021*^9}, {
  3.878080502097672*^9, 3.878080502683258*^9}},
 CellLabel->
  "In[1601]:=",ExpressionUUID->"331966e1-7937-4f79-bdf9-84739b0401fc"],

Cell[BoxData[
 RowBox[{
  RowBox[{"cvars", "=", 
   RowBox[{
    RowBox[{"Cases", "[", 
     RowBox[{"numAnsatz", ",", 
      RowBox[{"c", "[", "__", "]"}], ",", 
      RowBox[{"{", 
       RowBox[{"0", ",", "\[Infinity]"}], "}"}]}], "]"}], "//", "Union"}]}], 
  ";"}]], "Input",
 CellChangeTimes->{{3.878109201262475*^9, 3.878109244273675*^9}},
 CellLabel->
  "In[1708]:=",ExpressionUUID->"7db4d02a-5d09-45ac-9d45-e0f0ebe8f8c4"],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"cvars", "//", "Length"}]], "Input",
 CellChangeTimes->{{3.878109248356045*^9, 3.878109249212179*^9}},
 CellLabel->
  "In[1710]:=",ExpressionUUID->"325078f6-200c-4d93-bfbc-13425e865026"],

Cell[BoxData["450"], "Output",
 CellChangeTimes->{{3.8781092272926903`*^9, 3.878109249608304*^9}},
 CellLabel->
  "Out[1710]=",ExpressionUUID->"85c91043-b80c-4fe0-a5fa-54d604cc29c4"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{
  RowBox[{"ansatzExp", "=", 
   RowBox[{
    RowBox[{
     RowBox[{"(", 
      RowBox[{"numAnsatz", "//", "expandFS"}], ")"}], "//.", "dotRules"}], "/.",
     "vponshell"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"vardot", "=", 
   RowBox[{"ansatzExp", "//", "Casesdot"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"monos", "=", 
   RowBox[{
    RowBox[{"(", 
     RowBox[{"List", "@@", "numAnsatz"}], ")"}], "/.", 
    RowBox[{
     RowBox[{"c", "[", "__", "]"}], ":>", "1"}]}]}], ";"}], "\n", 
 RowBox[{
  RowBox[{"dot2num", ":=", 
   RowBox[{"Table", "[", 
    RowBox[{
     RowBox[{"Rule", "[", 
      RowBox[{
       RowBox[{"vardot", "[", 
        RowBox[{"[", "ii", "]"}], "]"}], ",", 
       RowBox[{"RandomInteger", "[", 
        RowBox[{"{", 
         RowBox[{"10", ",", "100"}], "}"}], "]"}]}], "]"}], ",", 
     RowBox[{"{", 
      RowBox[{"ii", ",", 
       RowBox[{"Length", "[", "vardot", "]"}]}], "}"}]}], "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"eqDep", "=", 
   RowBox[{"Table", "[", 
    RowBox[{
     RowBox[{
      RowBox[{"ansatzExp", "\[Equal]", "0"}], "/.", "dot2num"}], ",", 
     RowBox[{"10", "+", 
      RowBox[{"Length", "[", "cvars", "]"}]}]}], "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"sols", "=", 
   RowBox[{
    RowBox[{"Solve", "[", 
     RowBox[{"eqDep", ",", "cvars"}], "]"}], "[", 
    RowBox[{"[", "1", "]"}], "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"Relations", "=", 
   RowBox[{
    RowBox[{"DeleteCases", "[", 
     RowBox[{
      RowBox[{"List", "@@", 
       RowBox[{"(", 
        RowBox[{
         RowBox[{
          RowBox[{
           RowBox[{"c", "[", "0", "]"}], "+", "numAnsatz"}], "/.", "sols"}], "//", 
         RowBox[{
          RowBox[{"Collect", "[", 
           RowBox[{"#", ",", 
            RowBox[{"c", "[", "i__", "]"}]}], "]"}], "&"}]}], ")"}]}], ",", 
      RowBox[{"c", "[", "0", "]"}]}], "]"}], "/.", 
    RowBox[{"{", 
     RowBox[{
      RowBox[{"c", "[", "i__", "]"}], "\[RuleDelayed]", " ", "1"}], "}"}]}]}],
   ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"RelationsList", "=", 
   RowBox[{"List", "@@@", 
    RowBox[{"(", "Relations", ")"}]}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"monos2M", "=", 
   RowBox[{"MapThread", "[", 
    RowBox[{"Rule", ",", 
     RowBox[{"{", 
      RowBox[{"monos", ",", 
       RowBox[{"M", "/@", 
        RowBox[{"Range", "[", 
         RowBox[{"Length", "@", "monos"}], "]"}]}]}], "}"}]}], "]"}]}], 
  ";"}]}], "Input",
 CellChangeTimes->{{3.878109123063219*^9, 3.878109151384389*^9}, 
   3.878109312908162*^9, 3.8781093917941723`*^9, {3.8781095510549507`*^9, 
   3.878109556589096*^9}, 3.8781104001505823`*^9, 3.8781104740195093`*^9},
 CellLabel->
  "In[1998]:=",ExpressionUUID->"b1fbd84f-0433-4910-80e2-5ad8d6dbbddf"],

Cell[BoxData[
 TemplateBox[{
  "Part", "partw", 
   "\"Part \\!\\(\\*RowBox[{\\\"1\\\"}]\\) of \\!\\(\\*RowBox[{\\\"{\\\", \
\\\"}\\\"}]\\) does not exist.\"", 2, 2003, 94, 28410112452836994704, "Local"},
  "MessageTemplate"]], "Message", "MSG",
 CellChangeTimes->{
  3.878109588547061*^9, 3.878110431660038*^9, 3.878110505452949*^9, {
   3.8782731342137003`*^9, 3.878273159215098*^9}},
 CellLabel->
  "During evaluation of \
In[1998]:=",ExpressionUUID->"5ef90909-6d0d-41d3-97f4-dd94d9a1e708"],

Cell[BoxData[
 TemplateBox[{
  "ReplaceAll", "reps", 
   "\"\\!\\(\\*RowBox[{\\\"{\\\", RowBox[{RowBox[{\\\"{\\\", \\\"}\\\"}], \
\\\"\[LeftDoubleBracket]\\\", \\\"1\\\", \\\"\[RightDoubleBracket]\\\"}], \
\\\"}\\\"}]\\) is neither a list of replacement rules nor a valid dispatch \
table, and so cannot be used for replacing.\"", 2, 2004, 95, 
   28410112452836994704, "Local"},
  "MessageTemplate"]], "Message", "MSG",
 CellChangeTimes->{
  3.878109588547061*^9, 3.878110431660038*^9, 3.878110505452949*^9, {
   3.8782731342137003`*^9, 3.878273159220594*^9}},
 CellLabel->
  "During evaluation of \
In[1998]:=",ExpressionUUID->"bfe3993b-0e93-478d-99fd-02c38980d5a0"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"RelationsList", "[", 
  RowBox[{"[", "1", "]"}], "]"}]], "Input",
 CellChangeTimes->{{3.878110448634164*^9, 3.878110471232892*^9}, {
  3.878110513040512*^9, 3.878110513739974*^9}},
 CellLabel->
  "In[1780]:=",ExpressionUUID->"e0810539-063e-4fe3-ac9c-9f1bcde2d45c"],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
   FractionBox[
    RowBox[{
     RowBox[{"dot", "[", 
      RowBox[{
       RowBox[{"p", "[", "1", "]"}], ",", 
       RowBox[{"F", "[", "3", "]"}], ",", 
       RowBox[{"F", "[", "1", "]"}], ",", 
       RowBox[{"v", "[", "1", "]"}]}], "]"}], " ", 
     RowBox[{"dot", "[", 
      RowBox[{
       RowBox[{"p", "[", "2", "]"}], ",", 
       RowBox[{"S", "[", "0", "]"}], ",", 
       RowBox[{"F", "[", "2", "]"}], ",", 
       RowBox[{"v", "[", "1", "]"}]}], "]"}]}], 
    RowBox[{
     RowBox[{"dot", "[", 
      RowBox[{
       RowBox[{"p", "[", "1", "]"}], ",", 
       RowBox[{"v", "[", "1", "]"}]}], "]"}], " ", 
     RowBox[{"(", 
      RowBox[{
       RowBox[{"dot", "[", 
        RowBox[{
         RowBox[{"p", "[", "1", "]"}], ",", 
         RowBox[{"v", "[", "1", "]"}]}], "]"}], "+", 
       RowBox[{"dot", "[", 
        RowBox[{
         RowBox[{"p", "[", "3", "]"}], ",", 
         RowBox[{"v", "[", "1", "]"}]}], "]"}]}], ")"}]}]], ",", 
   FractionBox[
    RowBox[{
     RowBox[{"dot", "[", 
      RowBox[{
       RowBox[{"p", "[", "2", "]"}], ",", 
       RowBox[{"S", "[", "0", "]"}], ",", 
       RowBox[{"F", "[", "2", "]"}], ",", 
       RowBox[{"v", "[", "1", "]"}]}], "]"}], " ", 
     RowBox[{"dot", "[", 
      RowBox[{
       RowBox[{"p", "[", "3", "]"}], ",", 
       RowBox[{"F", "[", "1", "]"}], ",", 
       RowBox[{"F", "[", "3", "]"}], ",", 
       RowBox[{"v", "[", "1", "]"}]}], "]"}]}], 
    RowBox[{
     RowBox[{"dot", "[", 
      RowBox[{
       RowBox[{"p", "[", "1", "]"}], ",", 
       RowBox[{"v", "[", "1", "]"}]}], "]"}], " ", 
     RowBox[{"(", 
      RowBox[{
       RowBox[{"dot", "[", 
        RowBox[{
         RowBox[{"p", "[", "1", "]"}], ",", 
         RowBox[{"v", "[", "1", "]"}]}], "]"}], "+", 
       RowBox[{"dot", "[", 
        RowBox[{
         RowBox[{"p", "[", "2", "]"}], ",", 
         RowBox[{"v", "[", "1", "]"}]}], "]"}]}], ")"}]}]], ",", 
   FractionBox[
    RowBox[{
     RowBox[{"dot", "[", 
      RowBox[{
       RowBox[{"p", "[", "2", "]"}], ",", 
       RowBox[{"S", "[", "0", "]"}], ",", 
       RowBox[{"F", "[", "2", "]"}], ",", 
       RowBox[{"v", "[", "1", "]"}]}], "]"}], " ", 
     RowBox[{"dot", "[", 
      RowBox[{
       RowBox[{"p", "[", "3", "]"}], ",", 
       RowBox[{"F", "[", "1", "]"}], ",", 
       RowBox[{"F", "[", "3", "]"}], ",", 
       RowBox[{"v", "[", "1", "]"}]}], "]"}]}], 
    RowBox[{
     RowBox[{"dot", "[", 
      RowBox[{
       RowBox[{"p", "[", "1", "]"}], ",", 
       RowBox[{"v", "[", "1", "]"}]}], "]"}], " ", 
     RowBox[{"(", 
      RowBox[{
       RowBox[{"dot", "[", 
        RowBox[{
         RowBox[{"p", "[", "1", "]"}], ",", 
         RowBox[{"v", "[", "1", "]"}]}], "]"}], "+", 
       RowBox[{"dot", "[", 
        RowBox[{
         RowBox[{"p", "[", "3", "]"}], ",", 
         RowBox[{"v", "[", "1", "]"}]}], "]"}]}], ")"}]}]]}], "}"}]], "Output",\

 CellChangeTimes->{{3.878110443592762*^9, 3.878110449578101*^9}, {
  3.8781105101039743`*^9, 3.8781105141585693`*^9}},
 CellLabel->
  "Out[1780]=",ExpressionUUID->"e7e58bb2-c537-48bb-ab8a-5d074bc4615c"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"Coefficient", "[", 
  RowBox[{"ansatzExp", ",", 
   RowBox[{"c", "[", 
    RowBox[{"1", ",", "2"}], "]"}]}], "]"}]], "Input",
 CellChangeTimes->{{3.878110136351522*^9, 3.878110155870221*^9}, 
   3.878110203692092*^9},
 CellLabel->
  "In[1756]:=",ExpressionUUID->"93bd6c08-6f70-4322-a32c-8e633e25114d"],

Cell[BoxData[
 RowBox[{
  FractionBox["1", 
   RowBox[{"dot", "[", 
    RowBox[{
     RowBox[{"p", "[", "3", "]"}], ",", 
     RowBox[{"v", "[", "1", "]"}]}], "]"}]], 
  RowBox[{
   RowBox[{"(", 
    RowBox[{
     RowBox[{
      RowBox[{"-", 
       RowBox[{"dot", "[", 
        RowBox[{
         RowBox[{"p", "[", "1", "]"}], ",", 
         RowBox[{"\[Epsilon]", "[", "3", "]"}]}], "]"}]}], " ", 
      RowBox[{"(", 
       RowBox[{
        RowBox[{
         RowBox[{"-", 
          RowBox[{"dot", "[", 
           RowBox[{
            RowBox[{"p", "[", "2", "]"}], ",", 
            RowBox[{"v", "[", "1", "]"}]}], "]"}]}], " ", 
         RowBox[{"dot", "[", 
          RowBox[{
           RowBox[{"p", "[", "3", "]"}], ",", 
           RowBox[{"\[Epsilon]", "[", "2", "]"}]}], "]"}]}], "+", 
        RowBox[{
         RowBox[{"dot", "[", 
          RowBox[{
           RowBox[{"p", "[", "2", "]"}], ",", 
           RowBox[{"p", "[", "3", "]"}]}], "]"}], " ", 
         RowBox[{"dot", "[", 
          RowBox[{
           RowBox[{"v", "[", "1", "]"}], ",", 
           RowBox[{"\[Epsilon]", "[", "2", "]"}]}], "]"}]}]}], ")"}]}], "+", 
     RowBox[{
      RowBox[{"dot", "[", 
       RowBox[{
        RowBox[{"p", "[", "1", "]"}], ",", 
        RowBox[{"p", "[", "3", "]"}]}], "]"}], " ", 
      RowBox[{"(", 
       RowBox[{
        RowBox[{
         RowBox[{"dot", "[", 
          RowBox[{
           RowBox[{"p", "[", "2", "]"}], ",", 
           RowBox[{"\[Epsilon]", "[", "3", "]"}]}], "]"}], " ", 
         RowBox[{"dot", "[", 
          RowBox[{
           RowBox[{"v", "[", "1", "]"}], ",", 
           RowBox[{"\[Epsilon]", "[", "2", "]"}]}], "]"}]}], "-", 
        RowBox[{
         RowBox[{"dot", "[", 
          RowBox[{
           RowBox[{"p", "[", "2", "]"}], ",", 
           RowBox[{"v", "[", "1", "]"}]}], "]"}], " ", 
         RowBox[{"dot", "[", 
          RowBox[{
           RowBox[{"\[Epsilon]", "[", "2", "]"}], ",", 
           RowBox[{"\[Epsilon]", "[", "3", "]"}]}], "]"}]}]}], ")"}]}]}], 
    ")"}], " ", 
   RowBox[{"dot", "[", 
    RowBox[{
     RowBox[{"p", "[", "1", "]"}], ",", 
     RowBox[{"S", "[", "0", "]"}], ",", 
     RowBox[{"\[Epsilon]", "[", "1", "]"}]}], "]"}]}]}]], "Output",
 CellChangeTimes->{
  3.878109916109236*^9, {3.878110137200882*^9, 3.878110156401186*^9}, 
   3.8781102039821*^9},
 CellLabel->
  "Out[1756]=",ExpressionUUID->"6999f32e-a823-43e1-b9d7-0d68bbd1c026"]
}, Open  ]],

Cell[BoxData[{
 RowBox[{
  RowBox[{"solM", "=", 
   RowBox[{
    RowBox[{"Solve", "[", 
     RowBox[{
      RowBox[{"(", 
       RowBox[{
        RowBox[{"Total", "/@", "RelationsList"}], "/.", "monos2M"}], ")"}], 
      "\[Equal]", "0"}], "]"}], "[", 
    RowBox[{"[", "1", "]"}], "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"eliminate", ":=", 
   RowBox[{"Module", "[", 
    RowBox[{
     RowBox[{"{", "repeated", "}"}], ",", 
     RowBox[{
      RowBox[{"repeated", "=", 
       RowBox[{"{", "}"}]}], ";", 
      RowBox[{"Do", "[", 
       RowBox[{
        RowBox[{"AppendTo", "[", 
         RowBox[{"repeated", ",", 
          RowBox[{"solM", "[", 
           RowBox[{"[", 
            RowBox[{"i", ",", "1"}], "]"}], "]"}]}], "]"}], ",", 
        RowBox[{"{", 
         RowBox[{"i", ",", 
          RowBox[{"Length", "[", "solM", "]"}]}], "}"}]}], "]"}], ";", 
      RowBox[{"Return", "[", "repeated", "]"}]}]}], "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"takeOut", "=", 
   RowBox[{"eliminate", "/.", 
    RowBox[{"{", 
     RowBox[{
      RowBox[{"M", "[", "i_", "]"}], "\[RuleDelayed]", " ", 
      RowBox[{"{", "i", "}"}]}], "}"}]}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"monosIdp", "=", 
   RowBox[{"Delete", "[", 
    RowBox[{"monos", ",", "takeOut"}], "]"}]}], ";"}]}], "Input",
 CellLabel->
  "In[1781]:=",ExpressionUUID->"64a868eb-e2d4-4e94-82e1-1bde57c0837c"],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"monos", "//", "Length"}]], "Input",
 CellChangeTimes->{{3.87811053179887*^9, 3.8781105326476603`*^9}},
 CellLabel->
  "In[1786]:=",ExpressionUUID->"20be0346-15d6-48da-b01c-8b29af978d5d"],

Cell[BoxData["450"], "Output",
 CellChangeTimes->{3.878110533131216*^9},
 CellLabel->
  "Out[1786]=",ExpressionUUID->"dbec521e-69e2-49ee-ac09-7ddae2c9391c"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"monosIdp", "//", "Length"}]], "Input",
 CellChangeTimes->{{3.87811052374531*^9, 3.8781105245452013`*^9}},
 CellLabel->
  "In[1785]:=",ExpressionUUID->"380a5a51-bf8b-47e0-a5fe-fd158c775d2b"],

Cell[BoxData["282"], "Output",
 CellChangeTimes->{3.8781105249604273`*^9},
 CellLabel->
  "Out[1785]=",ExpressionUUID->"737c14d4-ba79-41a1-80b4-5b85eb5f1579"]
}, Open  ]],

Cell[BoxData[{
 RowBox[{
  RowBox[{"cvars", "=", 
   RowBox[{"c", "/@", 
    RowBox[{"Range", "[", 
     RowBox[{"Length", "[", "monosIdp", "]"}], "]"}]}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"ansatzIdp", "=", 
   RowBox[{"(", 
    RowBox[{"monosIdp", ".", "cvars"}], ")"}]}], ";"}]}], "Input",
 CellChangeTimes->{{3.8781105587229347`*^9, 3.878110567515765*^9}},
 CellLabel->
  "In[1788]:=",ExpressionUUID->"d82dd100-bacf-4021-8f4d-a291f2a6fe47"]
}, Open  ]],

Cell[CellGroupData[{

Cell["Cut condition Massless", "Subsection",
 CellChangeTimes->{{3.878076730024465*^9, 
  3.8780767381983347`*^9}},ExpressionUUID->"718be8c1-6ad8-4039-8b3e-\
3fd03b15fa11"],

Cell[BoxData[
 RowBox[{
  RowBox[{"nod", "=", 
   RowBox[{
    RowBox[{
     RowBox[{
      RowBox[{
       RowBox[{"(", 
        RowBox[{"ansatzIdp", "//", "expandFS"}], ")"}], "//.", "dotRules"}], "/.",
       "vponshell"}], "/.", 
     RowBox[{
      RowBox[{"\[Epsilon]", "[", "i_", "]"}], ":>", 
      RowBox[{"\[Epsilon]", "[", 
       RowBox[{"p", "[", "i", "]"}], "]"}]}]}], "//", "Expand"}]}], 
  ";"}]], "Input",
 CellChangeTimes->{{3.8780203515119047`*^9, 3.878020399229755*^9}, {
   3.878020431526237*^9, 3.8780204339818277`*^9}, {3.8780205335571136`*^9, 
   3.878020540776443*^9}, 3.8780206405534067`*^9, {3.878020888923959*^9, 
   3.878020889972404*^9}, 3.878021112062257*^9, {3.878022714056156*^9, 
   3.878022715411971*^9}, {3.8780319378374166`*^9, 3.878031956823164*^9}, 
   3.878110574998744*^9},
 CellLabel->
  "In[1790]:=",ExpressionUUID->"4012c174-e483-4432-b176-bce09d101456"],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{"bpeff2", "=", 
  RowBox[{"BinaryProduct", "[", 
   RowBox[{"Range", "[", 
    RowBox[{"n", "-", "2"}], "]"}], "]"}]}], "\n", 
 RowBox[{
  RowBox[{"numList", "=", 
   RowBox[{
    RowBox[{
     RowBox[{"ExpandNCM", "/@", 
      RowBox[{"(", 
       RowBox[{"bpeff2", "/.", 
        RowBox[{"X", "\[Rule]", " ", "NC"}]}], ")"}]}], "/.", 
     RowBox[{"NonCommutativeMultiply", "\[Rule]", " ", "T"}]}], "/.", 
    RowBox[{
     RowBox[{"T", "[", 
      RowBox[{"i1_", ",", "f___"}], "]"}], ":>", " ", 
     RowBox[{"0", "/;", 
      RowBox[{"i1", "\[NotEqual]", "1"}]}]}]}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"numListL", "=", 
   RowBox[{"numList", "/.", 
    RowBox[{
     RowBox[{"T", "[", "f___", "]"}], "\[RuleDelayed]", " ", 
     RowBox[{"(", 
      RowBox[{"nod", "/.", 
       RowBox[{"replace", "[", 
        RowBox[{
         RowBox[{"p", "/@", 
          RowBox[{"{", "f", "}"}]}], ",", 
         RowBox[{"n", "-", "1"}]}], "]"}]}], ")"}]}]}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"numListL", "=", 
   RowBox[{
    RowBox[{"(", 
     RowBox[{"numListL", "/.", 
      RowBox[{
       RowBox[{"F", "[", 
        RowBox[{"p", "[", "i_", "]"}], "]"}], ":>", " ", 
       RowBox[{"F", "[", "i", "]"}]}]}], ")"}], "//", "Expand"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"ppListD", "=", 
   RowBox[{"(", 
    RowBox[{"X2Prop", "/@", "bpeff2"}], ")"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"ppListD", "=", 
   RowBox[{
    RowBox[{"ppListD", "/.", 
     RowBox[{
      RowBox[{"p", "[", "f__", "]"}], "\[RuleDelayed]", 
      RowBox[{"Total", "[", 
       RowBox[{"p", "/@", 
        RowBox[{"{", "f", "}"}]}], "]"}]}]}], "/.", 
    RowBox[{
     RowBox[{"dot", "[", 
      RowBox[{
       RowBox[{"p", "[", "i_", "]"}], ",", 
       RowBox[{"p", "[", "i_", "]"}]}], "]"}], ":>", " ", "0"}]}]}], 
  ";"}], "\n", 
 RowBox[{
  RowBox[{"denAll", "=", 
   RowBox[{"Table", "[", 
    RowBox[{
     RowBox[{"ppListD", "[", 
      RowBox[{"[", "ii", "]"}], "]"}], ",", 
     RowBox[{"{", 
      RowBox[{"ii", ",", 
       RowBox[{"Length", "@", "ppListD"}]}], "}"}]}], "]"}]}], ";"}], "\n", 
 RowBox[{
  RowBox[{"amp5", "=", 
   RowBox[{
    RowBox[{
     RowBox[{"Sum", "[", 
      RowBox[{
       FractionBox[
        RowBox[{"numListL", "[", 
         RowBox[{"[", "ii", "]"}], "]"}], 
        RowBox[{"denAll", "[", 
         RowBox[{"[", "ii", "]"}], "]"}]], ",", 
       RowBox[{"{", 
        RowBox[{"ii", ",", 
         RowBox[{"Length", "@", "ppListD"}]}], "}"}]}], "]"}], "/.", 
     RowBox[{
      RowBox[{"\[Epsilon]", "[", 
       RowBox[{"p", "[", "i_", "]"}], "]"}], ":>", 
      RowBox[{"\[Epsilon]", "[", "i", "]"}]}]}], "//", "Expand"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"amp5", "=", 
   RowBox[{
    RowBox[{
     RowBox[{
      RowBox[{"amp5", "/.", "dotRules"}], "/.", "vponshell"}], "/.", 
     "gponshell"}], "//", "Expand"}]}], ";"}]}], "Input",
 CellChangeTimes->{{3.878022027028722*^9, 3.878022028483653*^9}, {
  3.8780224366059227`*^9, 3.878022442198484*^9}, {3.878022763644738*^9, 
  3.878022823789957*^9}, {3.878022855805319*^9, 3.8780228836038427`*^9}, {
  3.878022958964085*^9, 3.8780229728251*^9}, {3.878025964817404*^9, 
  3.878025974154643*^9}, {3.878032030200883*^9, 3.878032043291239*^9}, {
  3.87807694175404*^9, 3.878076942268965*^9}},
 CellLabel->
  "In[1791]:=",ExpressionUUID->"bf3f4366-0313-4b02-89ff-01738506712d"],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
   RowBox[{"X", "[", 
    RowBox[{"1", ",", 
     RowBox[{"X", "[", 
      RowBox[{"2", ",", "3"}], "]"}]}], "]"}], ",", 
   RowBox[{"X", "[", 
    RowBox[{
     RowBox[{"X", "[", 
      RowBox[{"1", ",", "2"}], "]"}], ",", "3"}], "]"}]}], "}"}]], "Output",
 CellChangeTimes->{
  3.8780227866981993`*^9, 3.8780228244290047`*^9, {3.878022856995924*^9, 
   3.878022886712186*^9}, {3.878022959975482*^9, 3.8780229734233837`*^9}, 
   3.878025942910557*^9, 3.878025974822631*^9, 3.87802604880019*^9, 
   3.87802893737528*^9, 3.8780300797739983`*^9, 3.87803201555766*^9, 
   3.878032046557034*^9, 3.8780325721214447`*^9, 3.878075893987146*^9, 
   3.8780808478320103`*^9, 3.878093449603753*^9, 3.878095848723765*^9, 
   3.878097128656351*^9, 3.878106459324299*^9, 3.8781105832067327`*^9},
 CellLabel->
  "Out[1791]=",ExpressionUUID->"4e368c35-91cb-4162-a9c5-ebf61cc71aea"]
}, Open  ]],

Cell[BoxData[{
 RowBox[{
  RowBox[{"num", "=", 
   RowBox[{"\[FivePointedStar]", "[", 
    RowBox[{
     RowBox[{"T", "[", 
      RowBox[{"{", "1", "}"}], "]"}], ",", 
     RowBox[{"T", "[", 
      RowBox[{"{", "2", "}"}], "]"}], ",", 
     RowBox[{"T", "[", 
      RowBox[{"{", "3", "}"}], "]"}]}], "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"nod", "=", 
   RowBox[{
    RowBox[{
     RowBox[{"(", 
      RowBox[{
       RowBox[{
        RowBox[{"num", "/.", 
         RowBox[{"T", "->", "T2F"}]}], "/.", "rmzero"}], "/.", 
       RowBox[{"v", "->", " ", 
        RowBox[{"v", "[", "1", "]"}]}]}], ")"}], "/.", 
     RowBox[{
      RowBox[{"F", "[", "i_", "]"}], ":>", " ", 
      RowBox[{"F", "[", 
       RowBox[{"p", "[", "i", "]"}], "]"}]}]}], "/.", 
    RowBox[{
     RowBox[{"p", "[", 
      RowBox[{"f1_", ",", "g__"}], "]"}], ":>", 
     RowBox[{"P", "[", " ", 
      RowBox[{"Total", "[", 
       RowBox[{"p", "/@", 
        RowBox[{"{", 
         RowBox[{"f1", ",", "g"}], "}"}]}], "]"}], "]"}]}]}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"bpeff2", "=", 
   RowBox[{"BinaryProduct", "[", 
    RowBox[{"Range", "[", 
     RowBox[{"n", "-", "2"}], "]"}], "]"}]}], ";"}], "\n", 
 RowBox[{
  RowBox[{"numList", "=", 
   RowBox[{
    RowBox[{
     RowBox[{"ExpandNCM", "/@", 
      RowBox[{"(", 
       RowBox[{"bpeff2", "/.", 
        RowBox[{"X", "\[Rule]", " ", "NC"}]}], ")"}]}], "/.", 
     RowBox[{"NonCommutativeMultiply", "\[Rule]", " ", "T"}]}], "/.", 
    RowBox[{
     RowBox[{"T", "[", 
      RowBox[{"i1_", ",", "f___"}], "]"}], ":>", " ", 
     RowBox[{"0", "/;", 
      RowBox[{"i1", "\[NotEqual]", "1"}]}]}]}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"numListL", "=", 
   RowBox[{"numList", "/.", 
    RowBox[{
     RowBox[{"T", "[", "f___", "]"}], "\[RuleDelayed]", " ", 
     RowBox[{"(", 
      RowBox[{"nod", "/.", 
       RowBox[{"replace", "[", 
        RowBox[{
         RowBox[{"p", "/@", 
          RowBox[{"{", "f", "}"}]}], ",", 
         RowBox[{"n", "-", "1"}]}], "]"}]}], ")"}]}]}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"numListL", "=", 
   RowBox[{
    RowBox[{"(", 
     RowBox[{"numListL", "/.", 
      RowBox[{
       RowBox[{"F", "[", 
        RowBox[{"p", "[", "i_", "]"}], "]"}], ":>", " ", 
       RowBox[{"F", "[", "i", "]"}]}]}], ")"}], "//", "Expand"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"ppListD", "=", 
   RowBox[{"(", 
    RowBox[{"X2Prop", "/@", "bpeff2"}], ")"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"ppListD", "=", 
   RowBox[{
    RowBox[{"ppListD", "/.", 
     RowBox[{
      RowBox[{"p", "[", "f__", "]"}], "\[RuleDelayed]", 
      RowBox[{"Total", "[", 
       RowBox[{"p", "/@", 
        RowBox[{"{", "f", "}"}]}], "]"}]}]}], "/.", 
    RowBox[{
     RowBox[{"dot", "[", 
      RowBox[{
       RowBox[{"p", "[", "i_", "]"}], ",", 
       RowBox[{"p", "[", "i_", "]"}]}], "]"}], ":>", " ", "0"}]}]}], 
  ";"}], "\n", 
 RowBox[{
  RowBox[{"denAll", "=", 
   RowBox[{"Table", "[", 
    RowBox[{
     RowBox[{"ppListD", "[", 
      RowBox[{"[", "ii", "]"}], "]"}], ",", 
     RowBox[{"{", 
      RowBox[{"ii", ",", 
       RowBox[{"Length", "@", "ppListD"}]}], "}"}]}], "]"}]}], ";"}], "\n", 
 RowBox[{
  RowBox[{"ampYM", "=", 
   RowBox[{
    RowBox[{
     RowBox[{"Sum", "[", 
      RowBox[{
       FractionBox[
        RowBox[{"numListL", "[", 
         RowBox[{"[", "ii", "]"}], "]"}], 
        RowBox[{"denAll", "[", 
         RowBox[{"[", "ii", "]"}], "]"}]], ",", 
       RowBox[{"{", 
        RowBox[{"ii", ",", 
         RowBox[{"Length", "@", "ppListD"}]}], "}"}]}], "]"}], "/.", 
     RowBox[{
      RowBox[{"P", "[", "f_", "]"}], ":>", "f"}]}], "//", "Expand"}]}], 
  ";"}]}], "Input",
 CellChangeTimes->{{3.878023857740679*^9, 3.878023860158512*^9}, {
   3.87802396296658*^9, 3.878024017862441*^9}, {3.878024052254986*^9, 
   3.878024058839876*^9}, {3.8780241059261007`*^9, 3.8780241103419027`*^9}, {
   3.878024288644836*^9, 3.8780243205537767`*^9}, 3.878076927512285*^9},
 CellLabel->
  "In[1800]:=",ExpressionUUID->"dbd45628-aed1-4c61-837a-c31fb11c0eb8"],

Cell[BoxData[{
 RowBox[{
  RowBox[{"ampYM", "=", 
   RowBox[{
    RowBox[{"(", 
     RowBox[{
      RowBox[{
       RowBox[{
        RowBox[{
         RowBox[{"(", 
          RowBox[{"ampYM", "//", "expandFS"}], ")"}], "/.", "dotRules"}], "/.",
         "vponshell"}], "/.", "gponshell"}], "//", "Expand"}], ")"}], "//", 
    "MultivariateApart"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"ampYMGlueNum3", "=", 
   RowBox[{
    RowBox[{
     RowBox[{
      RowBox[{
       RowBox[{"ampYM", "/.", 
        RowBox[{"{", 
         RowBox[{
          RowBox[{
           RowBox[{"dot", "[", 
            RowBox[{
             RowBox[{"v", "[", "1", "]"}], ",", "f_"}], "]"}], ":>", 
           RowBox[{"dot", "[", 
            RowBox[{
             RowBox[{
              RowBox[{"p", "[", "1", "]"}], "+", 
              RowBox[{"p", "[", "2", "]"}], "+", 
              RowBox[{"p", "[", "3", "]"}]}], ",", 
             RowBox[{"S", "[", "0", "]"}], ",", "f"}], "]"}]}], ",", 
          RowBox[{
           RowBox[{"dot", "[", 
            RowBox[{"f_", ",", 
             RowBox[{"v", "[", "1", "]"}]}], "]"}], ":>", 
           RowBox[{"dot", "[", 
            RowBox[{
             RowBox[{
              RowBox[{"p", "[", "1", "]"}], "+", 
              RowBox[{"p", "[", "2", "]"}], "+", 
              RowBox[{"p", "[", "3", "]"}]}], ",", 
             RowBox[{"S", "[", "0", "]"}], ",", "f"}], "]"}]}]}], "}"}]}], "/.",
        "dotRules"}], "/.", "vponshell"}], "/.", "gponshell"}], "//", 
    "Expand"}]}], ";"}]}], "Input",
 CellChangeTimes->{{3.878024069941125*^9, 3.87802415205725*^9}, {
   3.878024331157475*^9, 3.878024340048336*^9}, {3.8780243883823147`*^9, 
   3.87802443440853*^9}, {3.878024623562881*^9, 3.878024662661223*^9}, {
   3.878024820522764*^9, 3.878024839044957*^9}, {3.878025373216962*^9, 
   3.878025408461379*^9}, {3.878025474618256*^9, 3.878025484493874*^9}, 
   3.878025529761257*^9, {3.8780757748389797`*^9, 3.878075783185919*^9}, 
   3.878075831065405*^9},
 CellLabel->
  "In[1810]:=",ExpressionUUID->"56d665ab-7daf-4738-8cd3-8c9668245f3a"],

Cell[BoxData[
 RowBox[{
  RowBox[{"comp", "=", 
   RowBox[{
    RowBox[{"amp5", "-", "ampYMGlueNum3"}], "//", "Expand"}]}], 
  ";"}]], "Input",
 CellLabel->
  "In[1812]:=",ExpressionUUID->"61339348-3ff7-4021-aec5-bcd88ec61e4f"],

Cell[BoxData[
 RowBox[{
  RowBox[{"cvars", "=", 
   RowBox[{
    RowBox[{"Cases", "[", 
     RowBox[{"comp", ",", 
      RowBox[{"c", "[", "__", "]"}], ",", 
      RowBox[{"{", 
       RowBox[{"0", ",", "\[Infinity]"}], "}"}]}], "]"}], "//", "Union"}]}], 
  ";"}]], "Input",
 CellChangeTimes->{{3.8780251119523973`*^9, 3.87802515275441*^9}, {
  3.878033238685581*^9, 3.8780332388754597`*^9}, {3.87807596060207*^9, 
  3.878075960778406*^9}},
 CellLabel->
  "In[1813]:=",ExpressionUUID->"db91009e-5f25-458b-9204-da34e407ea01"],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"cvars", "//", "Length"}]], "Input",
 CellChangeTimes->{{3.878025163562392*^9, 3.878025164327901*^9}},
 CellLabel->
  "In[1814]:=",ExpressionUUID->"4a26b15b-0fec-4d84-8631-679e3b200441"],

Cell[BoxData["282"], "Output",
 CellChangeTimes->{3.87802516477238*^9, 3.878026076988738*^9, 
  3.878028973567272*^9, 3.8780301059729843`*^9, 3.87803208614393*^9, 
  3.878033255460141*^9, 3.878075964691884*^9, 3.878080856512931*^9, 
  3.878093458365816*^9, 3.878095857461788*^9, 3.878097147230905*^9, 
  3.878106478590885*^9, 3.878110601198616*^9},
 CellLabel->
  "Out[1814]=",ExpressionUUID->"f712c525-e7d8-42bd-a71d-bccbf243db54"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{
  RowBox[{"vardot", "=", 
   RowBox[{"comp", "//", "Casesdot"}]}], ";"}], "\n", 
 RowBox[{
  RowBox[{"dot2num", ":=", 
   RowBox[{"Table", "[", 
    RowBox[{
     RowBox[{"Rule", "[", 
      RowBox[{
       RowBox[{"vardot", "[", 
        RowBox[{"[", "ii", "]"}], "]"}], ",", 
       RowBox[{"RandomInteger", "[", 
        RowBox[{"{", 
         RowBox[{"10", ",", "100"}], "}"}], "]"}]}], "]"}], ",", 
     RowBox[{"{", 
      RowBox[{"ii", ",", 
       RowBox[{"Length", "[", "vardot", "]"}]}], "}"}]}], "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{"Monitor", "[", 
  RowBox[{
   RowBox[{
    RowBox[{"eqDep", "=", 
     RowBox[{"Table", "[", 
      RowBox[{
       RowBox[{
        RowBox[{"comp", "\[Equal]", "0"}], "/.", "dot2num"}], ",", 
       RowBox[{"{", 
        RowBox[{"ii", ",", 
         RowBox[{"10", "+", 
          RowBox[{"Length", "[", "cvars", "]"}]}]}], "}"}]}], "]"}]}], ";"}], 
   ",", "ii"}], "]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"sols", "=", 
   RowBox[{
    RowBox[{"Solve", "[", 
     RowBox[{"eqDep", ",", "cvars"}], "]"}], "[", 
    RowBox[{"[", "1", "]"}], "]"}]}], ";"}]}], "Input",
 CellChangeTimes->{{3.878025083563089*^9, 3.878025098342598*^9}, {
  3.87802516936078*^9, 3.878025185960835*^9}, {3.878033243467019*^9, 
  3.8780332467055893`*^9}, {3.8780759694484453`*^9, 3.878075974363841*^9}},
 CellLabel->
  "In[1815]:=",ExpressionUUID->"ee9f6abd-631a-4655-adb3-6a58107d0062"],

Cell[BoxData[
 TemplateBox[{
  "Solve", "svars", 
   "\"Equations may not give solutions for all \\\"solve\\\" variables.\"", 2,
    1818, 86, 28410112452836994704, "Local"},
  "MessageTemplate"]], "Message", "MSG",
 CellChangeTimes->{3.87802613489694*^9, 3.878029156688776*^9, 
  3.8780303199023113`*^9, 3.8780322863051863`*^9, 3.878032831294737*^9, 
  3.878033318277973*^9, 3.878076165657085*^9, 3.8780810434805603`*^9, 
  3.878093646396821*^9, 3.878096045334003*^9, 3.878097342954261*^9, 
  3.878106566447481*^9, 3.878110634586054*^9},
 CellLabel->
  "During evaluation of \
In[1815]:=",ExpressionUUID->"7a2db3c5-462e-4d1e-823d-736ee1744f95"]
}, Open  ]]
}, Open  ]],

Cell[CellGroupData[{

Cell["Factorisation condition v.p1", "Subsection",
 CellChangeTimes->{{3.878076748965989*^9, 3.878076767862722*^9}, {
  3.87809373543461*^9, 
  3.8780937386875668`*^9}},ExpressionUUID->"8aabd125-c494-4187-89e7-\
b929b0764b68"],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{
  RowBox[{"numAnsatz2", "=", 
   RowBox[{
    RowBox[{
     RowBox[{
      RowBox[{
       RowBox[{"(", 
        RowBox[{"ansatzIdp", "//", "expandFS"}], ")"}], "//.", "dotRules"}], "/.", 
      RowBox[{"(", 
       RowBox[{
        RowBox[{"vonshell", "[", 
         RowBox[{
          RowBox[{"n", "-", "1"}], ",", "3"}], "]"}], "/.", 
        RowBox[{"v", "->", 
         RowBox[{"v", "[", "1", "]"}]}]}], ")"}]}], "/.", "sols"}], "//", 
    "Expand"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{"%", "//", "Length"}]}], "Input",
 CellChangeTimes->{{3.878076776346158*^9, 3.878076791822427*^9}, {
   3.878076863747164*^9, 3.8780768651784353`*^9}, {3.878077446334421*^9, 
   3.878077450450157*^9}, 3.878080568874198*^9, 3.878080843522138*^9, {
   3.878084931218405*^9, 3.8780849369136047`*^9}, {3.878085107286035*^9, 
   3.878085112014679*^9}, {3.8780852927862673`*^9, 3.878085294285921*^9}, 
   3.878110691065761*^9},
 CellLabel->
  "In[1831]:=",ExpressionUUID->"b884c4a7-6e73-486a-b319-956d9247baeb"],

Cell[BoxData["1363"], "Output",
 CellChangeTimes->{{3.87807677960294*^9, 3.878076792387086*^9}, 
   3.878076869394702*^9, 3.878077463656658*^9, 3.878080582971023*^9, 
   3.878081061748372*^9, 3.878084951014349*^9, 3.878085126532173*^9, 
   3.878085312641127*^9, 3.878093665706396*^9, 3.87809605896621*^9, 
   3.878106580691216*^9, 3.8781106485337143`*^9, 3.878110695981309*^9},
 CellLabel->
  "Out[1832]=",ExpressionUUID->"ac3d262e-5431-4ba9-9826-1cef0b10ff15"]
}, Open  ]],

Cell[BoxData[
 RowBox[{
  RowBox[{"numAnsatzvp1", "=", 
   RowBox[{
    RowBox[{
     RowBox[{
      RowBox[{"(", 
       RowBox[{
        RowBox[{
         RowBox[{"(", 
          RowBox[{"numAnsatz2", "//", 
           RowBox[{"Cases", "[", 
            RowBox[{"Times", "[", 
             RowBox[{"f___", ",", 
              RowBox[{"Power", "[", 
               RowBox[{
                RowBox[{"dot", "[", 
                 RowBox[{
                  RowBox[{"p", "[", "1", "]"}], ",", 
                  RowBox[{"v", "[", "1", "]"}]}], "]"}], ",", 
                RowBox[{"-", "1"}]}], "]"}], ",", "g___"}], "]"}], "]"}]}], 
          ")"}], "/.", 
         RowBox[{
          RowBox[{"Power", "[", 
           RowBox[{
            RowBox[{"dot", "[", 
             RowBox[{
              RowBox[{"p", "[", "1", "]"}], ",", 
              RowBox[{"v", "[", "1", "]"}]}], "]"}], ",", 
            RowBox[{"-", "1"}]}], "]"}], "->", "1"}]}], "//", "Total"}], 
       ")"}], "//.", "dotRules"}], "/.", "vponshell"}], "/.", 
    RowBox[{"{", 
     RowBox[{
      RowBox[{
       RowBox[{"dot", "[", 
        RowBox[{
         RowBox[{"p", "[", "1", "]"}], ",", 
         RowBox[{"v", "[", "1", "]"}]}], "]"}], "->", "0"}], ",", 
      RowBox[{
       RowBox[{"dot", "[", 
        RowBox[{
         RowBox[{"p", "[", "2", "]"}], ",", 
         RowBox[{"v", "[", "1", "]"}]}], "]"}], "->", 
       RowBox[{"-", 
        RowBox[{"dot", "[", 
         RowBox[{
          RowBox[{"p", "[", "3", "]"}], ",", 
          RowBox[{"v", "[", "1", "]"}]}], "]"}]}]}]}], "}"}]}]}], 
  ";"}]], "Input",
 CellChangeTimes->{{3.878077052129978*^9, 3.878077125591745*^9}, {
   3.878077237157652*^9, 3.878077281353335*^9}, {3.8780773702267103`*^9, 
   3.8780774435353603`*^9}, {3.8780774739935207`*^9, 3.8780775017717133`*^9}, 
   3.878079930873101*^9, 3.878079973240665*^9, {3.878085415182927*^9, 
   3.8780854153236303`*^9}, 3.878085446328352*^9},
 CellLabel->
  "In[1833]:=",ExpressionUUID->"2e9d51cb-1250-4b8c-84b7-585d3444bb73"],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"numAnsatzvp1", "//", "Length"}]], "Input",
 CellChangeTimes->{{3.878085457345728*^9, 3.878085458484248*^9}},
 CellLabel->
  "In[1834]:=",ExpressionUUID->"446ce663-7eb7-4144-b404-73bdfda3b484"],

Cell[BoxData["558"], "Output",
 CellChangeTimes->{{3.878085424115284*^9, 3.8780854589677*^9}, 
   3.878093671135722*^9, 3.878096059862764*^9, 3.878106585270012*^9, 
   3.87811065554213*^9, 3.878110701360381*^9},
 CellLabel->
  "Out[1834]=",ExpressionUUID->"8531d5ab-11cf-4a67-b011-01dd05d07c51"]
}, Open  ]],

Cell[BoxData[{
 RowBox[{
  RowBox[{"num1", "=", 
   RowBox[{
    RowBox[{
     RowBox[{"T", "[", 
      RowBox[{"{", "1", "}"}], "]"}], "/.", 
     RowBox[{"T", "->", "T2F"}]}], "/.", 
    RowBox[{"v", "->", 
     RowBox[{"v", "[", "1", "]"}]}]}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"num2", "=", 
   RowBox[{"(", 
    RowBox[{
     FractionBox[
      RowBox[{"dot", "[", 
       RowBox[{
        RowBox[{"p", "[", "2", "]"}], ",", 
        RowBox[{"S", "[", "0", "]"}], ",", 
        RowBox[{"F", "[", "2", "]"}], ",", 
        RowBox[{"F", "[", "3", "]"}], ",", 
        RowBox[{"v", "[", "1", "]"}]}], "]"}], 
      RowBox[{"dot", "[", 
       RowBox[{
        RowBox[{"p", "[", "2", "]"}], ",", 
        RowBox[{"v", "[", "1", "]"}]}], "]"}]], "+", 
     FractionBox[
      RowBox[{"dot", "[", 
       RowBox[{
        RowBox[{"p", "[", "2", "]"}], ",", 
        RowBox[{"S", "[", "0", "]"}], ",", 
        RowBox[{"F", "[", "3", "]"}], ",", 
        RowBox[{"F", "[", "2", "]"}], ",", 
        RowBox[{"v", "[", "1", "]"}]}], "]"}], 
      RowBox[{"dot", "[", 
       RowBox[{
        RowBox[{"p", "[", "2", "]"}], ",", 
        RowBox[{"v", "[", "1", "]"}]}], "]"}]], "-", 
     FractionBox[
      RowBox[{"dot", "[", 
       RowBox[{
        RowBox[{"p", "[", "2", "]"}], ",", 
        RowBox[{"F", "[", "3", "]"}], ",", 
        RowBox[{"S", "[", "0", "]"}], ",", 
        RowBox[{"F", "[", "2", "]"}], ",", 
        RowBox[{"v", "[", "1", "]"}]}], "]"}], 
      RowBox[{"dot", "[", 
       RowBox[{
        RowBox[{"p", "[", "2", "]"}], ",", 
        RowBox[{"v", "[", "1", "]"}]}], "]"}]], "+", 
     FractionBox[
      RowBox[{"dot", "[", 
       RowBox[{
        RowBox[{"p", "[", "3", "]"}], ",", 
        RowBox[{"S", "[", "0", "]"}], ",", 
        RowBox[{"F", "[", "3", "]"}], ",", 
        RowBox[{"F", "[", "2", "]"}], ",", 
        RowBox[{"v", "[", "1", "]"}]}], "]"}], 
      RowBox[{"dot", "[", 
       RowBox[{
        RowBox[{"p", "[", "2", "]"}], ",", 
        RowBox[{"v", "[", "1", "]"}]}], "]"}]]}], ")"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"numvp1", "=", 
   RowBox[{
    RowBox[{
     RowBox[{
      RowBox[{
       RowBox[{"dot", "[", 
        RowBox[{
         RowBox[{"p", "[", "1", "]"}], ",", 
         RowBox[{"p", "[", "2", "]"}]}], "]"}], 
       RowBox[{"(", 
        RowBox[{
         RowBox[{
          RowBox[{"-", "num1"}], "*", "num2"}], "-", 
         RowBox[{
          FractionBox["1", 
           RowBox[{"dot", "[", 
            RowBox[{
             RowBox[{"p", "[", "2", "]"}], ",", 
             RowBox[{"v", "[", "1", "]"}]}], "]"}]], 
          RowBox[{"dot", "[", 
           RowBox[{
            RowBox[{"p", "[", "1", "]"}], ",", 
            RowBox[{"S", "[", "0", "]"}], ",", 
            RowBox[{"\[Epsilon]", "[", "1", "]"}]}], "]"}], "*", 
          RowBox[{"dot", "[", 
           RowBox[{
            RowBox[{"v", "[", "1", "]"}], ",", 
            RowBox[{"F", "[", "2", "]"}], ",", 
            RowBox[{"F", "[", "3", "]"}], ",", 
            RowBox[{"v", "[", "1", "]"}]}], "]"}]}]}], ")"}]}], "//.", 
      "dotRules"}], "//", "expandFS"}], "//", "Expand"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"numvp1", "=", 
   RowBox[{
    RowBox[{
     RowBox[{"numvp1", "//.", "dotRules"}], "/.", "vponshell"}], "/.", 
    RowBox[{"{", 
     RowBox[{
      RowBox[{
       RowBox[{"dot", "[", 
        RowBox[{
         RowBox[{"p", "[", "1", "]"}], ",", 
         RowBox[{"v", "[", "1", "]"}]}], "]"}], "->", "0"}], ",", 
      RowBox[{
       RowBox[{"dot", "[", 
        RowBox[{
         RowBox[{"p", "[", "2", "]"}], ",", 
         RowBox[{"v", "[", "1", "]"}]}], "]"}], "->", 
       RowBox[{"-", 
        RowBox[{"dot", "[", 
         RowBox[{
          RowBox[{"p", "[", "3", "]"}], ",", 
          RowBox[{"v", "[", "1", "]"}]}], "]"}]}]}]}], "}"}]}]}], 
  ";"}]}], "Input",
 CellChangeTimes->{{3.878077591985273*^9, 3.8780776461342783`*^9}, {
   3.878077953502172*^9, 3.878077980733405*^9}, {3.878078491930747*^9, 
   3.878078549563458*^9}, {3.878078580745262*^9, 3.87807865251903*^9}, 
   3.878078684800146*^9, {3.878079206140265*^9, 3.878079212664543*^9}, {
   3.878079938416065*^9, 3.8780799390210323`*^9}, {3.878079982854789*^9, 
   3.878079996138009*^9}, 3.878080718496252*^9, 3.878080776110016*^9, {
   3.878081116226698*^9, 3.8780811179219093`*^9}, {3.878081897887516*^9, 
   3.878081929737031*^9}, {3.8780819770250673`*^9, 3.8780819885274878`*^9}, 
   3.8780820357161922`*^9, {3.878082093586617*^9, 3.878082094494379*^9}, 
   3.878082200584118*^9, 3.8780823524734297`*^9, 3.8780843780876017`*^9, {
   3.87808451838385*^9, 3.878084553403726*^9}, {3.878084767872551*^9, 
   3.878084809993238*^9}, {3.878093413770879*^9, 3.878093418381057*^9}, {
   3.878106594481743*^9, 3.878106602977435*^9}},
 CellLabel->
  "In[1835]:=",ExpressionUUID->"fa6f5646-12d0-402f-8458-b680cfe7e8ed"],

Cell[BoxData[
 RowBox[{
  RowBox[{"compvp1", "=", 
   RowBox[{"numAnsatzvp1", "-", "numvp1"}]}], ";"}]], "Input",
 CellChangeTimes->{{3.8780781147500143`*^9, 3.878078179889933*^9}, {
   3.878078714167301*^9, 3.878078719908218*^9}, {3.878078864983605*^9, 
   3.8780788894932623`*^9}, 3.878079927920136*^9, 3.87808000213634*^9},
 CellLabel->
  "In[1839]:=",ExpressionUUID->"c5fd8865-8f25-482c-b488-016315b8aee7"],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  RowBox[{"4", " ", 
   RowBox[{
    SubscriptBox["p", "1"], "\[CenterDot]", "S", "\[CenterDot]", 
    SubscriptBox["F", "1"], "\[CenterDot]", 
    SubscriptBox["F", "2"], "\[CenterDot]", "v"}]}], "+", 
  RowBox[{"4", 
   RowBox[{
    SubscriptBox["p", "1"], "\[CenterDot]", "S", "\[CenterDot]", 
    SubscriptBox["F", "2"], "\[CenterDot]", 
    SubscriptBox["F", "1"], "\[CenterDot]", "v"}]}], "-", 
  RowBox[{"4", " ", 
   RowBox[{
    SubscriptBox["p", "1"], "\[CenterDot]", 
    SubscriptBox["F", "2"], "\[CenterDot]", "S", "\[CenterDot]", 
    SubscriptBox["F", "1"], "\[CenterDot]", "v"}]}], "+", 
  RowBox[{"4", " ", 
   RowBox[{
    SubscriptBox["p", "2"], "\[CenterDot]", "S", "\[CenterDot]", 
    SubscriptBox["F", "2"], "\[CenterDot]", 
    SubscriptBox["F", "1"], "\[CenterDot]", "v"}]}]}]], "Input",
 CellChangeTimes->{{3.878078468972107*^9, 3.8780784821254663`*^9}},
 CellLabel->
  "In[1458]:=",ExpressionUUID->"af8747a8-4f93-4c5b-bff5-b8372ec86d40"],

Cell[BoxData[
 RowBox[{
  RowBox[{"4", " ", 
   RowBox[{
    SubscriptBox["p", "1"], "\[CenterDot]", "S", "\[CenterDot]", 
    SubscriptBox["F", "1"], "\[CenterDot]", 
    SubscriptBox["F", "2"], "\[CenterDot]", "v"}]}], "+", 
  RowBox[{"4", " ", 
   RowBox[{
    SubscriptBox["p", "1"], "\[CenterDot]", "S", "\[CenterDot]", 
    SubscriptBox["F", "2"], "\[CenterDot]", 
    SubscriptBox["F", "1"], "\[CenterDot]", "v"}]}], "-", 
  RowBox[{"4", " ", 
   RowBox[{
    SubscriptBox["p", "1"], "\[CenterDot]", 
    SubscriptBox["F", "2"], "\[CenterDot]", "S", "\[CenterDot]", 
    SubscriptBox["F", "1"], "\[CenterDot]", "v"}]}], "+", 
  RowBox[{"4", " ", 
   RowBox[{
    SubscriptBox["p", "2"], "\[CenterDot]", "S", "\[CenterDot]", 
    SubscriptBox["F", "2"], "\[CenterDot]", 
    SubscriptBox["F", "1"], "\[CenterDot]", "v"}]}]}]], "Output",
 CellChangeTimes->{3.878096059926221*^9},
 CellLabel->
  "Out[1458]=",ExpressionUUID->"969f371c-d92f-478c-84c6-c59357adffa5"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"compvp1", "//", "Casesdot"}]], "Input",
 CellChangeTimes->{{3.8780788203554583`*^9, 3.878078825352446*^9}},
 CellLabel->
  "In[1459]:=",ExpressionUUID->"1e93fbae-0b67-433c-9ea8-fa1a9151ea73"],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
   RowBox[{"dot", "[", 
    RowBox[{
     RowBox[{"p", "[", "1", "]"}], ",", 
     RowBox[{"p", "[", "2", "]"}]}], "]"}], ",", 
   RowBox[{"dot", "[", 
    RowBox[{
     RowBox[{"p", "[", "1", "]"}], ",", 
     RowBox[{"p", "[", "3", "]"}]}], "]"}], ",", 
   RowBox[{"dot", "[", 
    RowBox[{
     RowBox[{"p", "[", "1", "]"}], ",", 
     RowBox[{"\[Epsilon]", "[", "2", "]"}]}], "]"}], ",", 
   RowBox[{"dot", "[", 
    RowBox[{
     RowBox[{"p", "[", "1", "]"}], ",", 
     RowBox[{"\[Epsilon]", "[", "3", "]"}]}], "]"}], ",", 
   RowBox[{"dot", "[", 
    RowBox[{
     RowBox[{"p", "[", "2", "]"}], ",", 
     RowBox[{"p", "[", "3", "]"}]}], "]"}], ",", 
   RowBox[{"dot", "[", 
    RowBox[{
     RowBox[{"p", "[", "2", "]"}], ",", 
     RowBox[{"\[Epsilon]", "[", "1", "]"}]}], "]"}], ",", 
   RowBox[{"dot", "[", 
    RowBox[{
     RowBox[{"p", "[", "2", "]"}], ",", 
     RowBox[{"\[Epsilon]", "[", "3", "]"}]}], "]"}], ",", 
   RowBox[{"dot", "[", 
    RowBox[{
     RowBox[{"p", "[", "3", "]"}], ",", 
     RowBox[{"v", "[", "1", "]"}]}], "]"}], ",", 
   RowBox[{"dot", "[", 
    RowBox[{
     RowBox[{"p", "[", "3", "]"}], ",", 
     RowBox[{"\[Epsilon]", "[", "1", "]"}]}], "]"}], ",", 
   RowBox[{"dot", "[", 
    RowBox[{
     RowBox[{"p", "[", "3", "]"}], ",", 
     RowBox[{"\[Epsilon]", "[", "2", "]"}]}], "]"}], ",", 
   RowBox[{"dot", "[", 
    RowBox[{
     RowBox[{"v", "[", "1", "]"}], ",", 
     RowBox[{"\[Epsilon]", "[", "1", "]"}]}], "]"}], ",", 
   RowBox[{"dot", "[", 
    RowBox[{
     RowBox[{"v", "[", "1", "]"}], ",", 
     RowBox[{"\[Epsilon]", "[", "2", "]"}]}], "]"}], ",", 
   RowBox[{"dot", "[", 
    RowBox[{
     RowBox[{"v", "[", "1", "]"}], ",", 
     RowBox[{"\[Epsilon]", "[", "3", "]"}]}], "]"}], ",", 
   RowBox[{"dot", "[", 
    RowBox[{
     RowBox[{"\[Epsilon]", "[", "1", "]"}], ",", 
     RowBox[{"\[Epsilon]", "[", "2", "]"}]}], "]"}], ",", 
   RowBox[{"dot", "[", 
    RowBox[{
     RowBox[{"\[Epsilon]", "[", "1", "]"}], ",", 
     RowBox[{"\[Epsilon]", "[", "3", "]"}]}], "]"}], ",", 
   RowBox[{"dot", "[", 
    RowBox[{
     RowBox[{"\[Epsilon]", "[", "2", "]"}], ",", 
     RowBox[{"\[Epsilon]", "[", "3", "]"}]}], "]"}], ",", 
   RowBox[{"dot", "[", 
    RowBox[{
     RowBox[{"p", "[", "1", "]"}], ",", 
     RowBox[{"S", "[", "0", "]"}], ",", 
     RowBox[{"p", "[", "2", "]"}]}], "]"}], ",", 
   RowBox[{"dot", "[", 
    RowBox[{
     RowBox[{"p", "[", "1", "]"}], ",", 
     RowBox[{"S", "[", "0", "]"}], ",", 
     RowBox[{"p", "[", "3", "]"}]}], "]"}], ",", 
   RowBox[{"dot", "[", 
    RowBox[{
     RowBox[{"p", "[", "1", "]"}], ",", 
     RowBox[{"S", "[", "0", "]"}], ",", 
     RowBox[{"\[Epsilon]", "[", "1", "]"}]}], "]"}], ",", 
   RowBox[{"dot", "[", 
    RowBox[{
     RowBox[{"p", "[", "1", "]"}], ",", 
     RowBox[{"S", "[", "0", "]"}], ",", 
     RowBox[{"\[Epsilon]", "[", "2", "]"}]}], "]"}], ",", 
   RowBox[{"dot", "[", 
    RowBox[{
     RowBox[{"p", "[", "1", "]"}], ",", 
     RowBox[{"S", "[", "0", "]"}], ",", 
     RowBox[{"\[Epsilon]", "[", "3", "]"}]}], "]"}], ",", 
   RowBox[{"dot", "[", 
    RowBox[{
     RowBox[{"p", "[", "2", "]"}], ",", 
     RowBox[{"S", "[", "0", "]"}], ",", 
     RowBox[{"p", "[", "3", "]"}]}], "]"}], ",", 
   RowBox[{"dot", "[", 
    RowBox[{
     RowBox[{"p", "[", "2", "]"}], ",", 
     RowBox[{"S", "[", "0", "]"}], ",", 
     RowBox[{"\[Epsilon]", "[", "1", "]"}]}], "]"}], ",", 
   RowBox[{"dot", "[", 
    RowBox[{
     RowBox[{"p", "[", "2", "]"}], ",", 
     RowBox[{"S", "[", "0", "]"}], ",", 
     RowBox[{"\[Epsilon]", "[", "2", "]"}]}], "]"}], ",", 
   RowBox[{"dot", "[", 
    RowBox[{
     RowBox[{"p", "[", "2", "]"}], ",", 
     RowBox[{"S", "[", "0", "]"}], ",", 
     RowBox[{"\[Epsilon]", "[", "3", "]"}]}], "]"}], ",", 
   RowBox[{"dot", "[", 
    RowBox[{
     RowBox[{"p", "[", "3", "]"}], ",", 
     RowBox[{"S", "[", "0", "]"}], ",", 
     RowBox[{"\[Epsilon]", "[", "1", "]"}]}], "]"}], ",", 
   RowBox[{"dot", "[", 
    RowBox[{
     RowBox[{"p", "[", "3", "]"}], ",", 
     RowBox[{"S", "[", "0", "]"}], ",", 
     RowBox[{"\[Epsilon]", "[", "2", "]"}]}], "]"}], ",", 
   RowBox[{"dot", "[", 
    RowBox[{
     RowBox[{"p", "[", "3", "]"}], ",", 
     RowBox[{"S", "[", "0", "]"}], ",", 
     RowBox[{"\[Epsilon]", "[", "3", "]"}]}], "]"}], ",", 
   RowBox[{"dot", "[", 
    RowBox[{
     RowBox[{"\[Epsilon]", "[", "1", "]"}], ",", 
     RowBox[{"S", "[", "0", "]"}], ",", 
     RowBox[{"\[Epsilon]", "[", "2", "]"}]}], "]"}], ",", 
   RowBox[{"dot", "[", 
    RowBox[{
     RowBox[{"\[Epsilon]", "[", "1", "]"}], ",", 
     RowBox[{"S", "[", "0", "]"}], ",", 
     RowBox[{"\[Epsilon]", "[", "3", "]"}]}], "]"}], ",", 
   RowBox[{"dot", "[", 
    RowBox[{
     RowBox[{"\[Epsilon]", "[", "2", "]"}], ",", 
     RowBox[{"S", "[", "0", "]"}], ",", 
     RowBox[{"\[Epsilon]", "[", "3", "]"}]}], "]"}]}], "}"}]], "Output",
 CellChangeTimes->{3.8780787909855328`*^9, 3.878078825754147*^9, 
  3.8780789139500523`*^9, 3.878079583885482*^9, 3.8780807366766977`*^9, 
  3.87808078442798*^9, 3.878096059944249*^9},
 CellLabel->
  "Out[1459]=",ExpressionUUID->"664c8bf9-e7af-4855-8d25-97fd7c5cd002"]
}, Open  ]],

Cell[BoxData[{
 RowBox[{
  RowBox[{"cvars", "=", 
   RowBox[{
    RowBox[{"Cases", "[", 
     RowBox[{"compvp1", ",", 
      RowBox[{"c", "[", "__", "]"}], ",", 
      RowBox[{"{", 
       RowBox[{"0", ",", "\[Infinity]"}], "}"}]}], "]"}], "//", "Union"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"vardot", "=", 
   RowBox[{"compvp1", "//", "Casesdot"}]}], ";"}]}], "Input",
 CellChangeTimes->{{3.878078218083035*^9, 3.878078227195683*^9}},
 CellLabel->
  "In[1840]:=",ExpressionUUID->"574cf71c-f09c-4a42-a9eb-61ed6802e293"],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"cvars", "//", "Length"}]], "Input",
 CellChangeTimes->{{3.878078250405406*^9, 3.8780782515980988`*^9}, 
   3.8780793030421352`*^9, {3.878080618122617*^9, 3.878080619511405*^9}},
 CellLabel->
  "In[1842]:=",ExpressionUUID->"bc0a4d97-ba05-449b-a2c0-70b1f979a85f"],

Cell[BoxData["33"], "Output",
 CellChangeTimes->{
  3.878078252063862*^9, 3.878078732430634*^9, {3.8780792683050127`*^9, 
   3.878079303531766*^9}, {3.8780806116761723`*^9, 3.878080620497012*^9}, 
   3.878080793272333*^9, 3.8780810935750732`*^9, 3.8780811318686132`*^9, 
   3.878081941084124*^9, 3.8780820011325197`*^9, 3.878082120982493*^9, 
   3.878084828486793*^9, 3.878085517830093*^9, 3.878093680935251*^9, 
   3.878096059965028*^9, 3.878106611890305*^9, 3.8781106661833277`*^9, 
   3.878110711119144*^9},
 CellLabel->
  "Out[1842]=",ExpressionUUID->"a9420db9-8785-4c35-b2a8-363053cce88a"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{
  RowBox[{"dot2num", ":=", 
   RowBox[{"Table", "[", 
    RowBox[{
     RowBox[{"Rule", "[", 
      RowBox[{
       RowBox[{"vardot", "[", 
        RowBox[{"[", "ii", "]"}], "]"}], ",", 
       RowBox[{"RandomInteger", "[", 
        RowBox[{"{", 
         RowBox[{"10", ",", "100"}], "}"}], "]"}]}], "]"}], ",", 
     RowBox[{"{", 
      RowBox[{"ii", ",", 
       RowBox[{"Length", "[", "vardot", "]"}]}], "}"}]}], "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{"Monitor", "[", 
  RowBox[{
   RowBox[{
    RowBox[{"eqDep", "=", 
     RowBox[{"Table", "[", 
      RowBox[{
       RowBox[{
        RowBox[{"compvp1", "\[Equal]", "0"}], "/.", "dot2num"}], ",", 
       RowBox[{"{", 
        RowBox[{"ii", ",", 
         RowBox[{"10", "+", 
          RowBox[{"Length", "[", "cvars", "]"}]}]}], "}"}]}], "]"}]}], ";"}], 
   ",", "ii"}], "]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"solsvp1", "=", 
   RowBox[{
    RowBox[{"Solve", "[", 
     RowBox[{"eqDep", ",", "cvars"}], "]"}], "[", 
    RowBox[{"[", "1", "]"}], "]"}]}], ";"}]}], "Input",
 CellChangeTimes->{{3.878078221639757*^9, 3.878078240954069*^9}, {
  3.878081064658252*^9, 3.8780810690042477`*^9}},
 CellLabel->
  "In[1843]:=",ExpressionUUID->"a7e2e9ee-021c-49cb-84b5-bf401a4f7bc9"],

Cell[BoxData[
 TemplateBox[{
  "Solve", "svars", 
   "\"Equations may not give solutions for all \\\"solve\\\" variables.\"", 2,
    1845, 87, 28410112452836994704, "Local"},
  "MessageTemplate"]], "Message", "MSG",
 CellChangeTimes->{3.878078269494465*^9, 3.878078742583606*^9, 
  3.878078899618535*^9, 3.878079253865985*^9, 3.878079430819562*^9, 
  3.878080637128373*^9, 3.8780808095370073`*^9, 3.878081098149448*^9, 
  3.878081136137045*^9, 3.8780819450782824`*^9, 3.8780820048796787`*^9, 
  3.878082047763628*^9, 3.878082109462324*^9, 3.878082376640708*^9, 
  3.878084831921735*^9, 3.878085522082589*^9, 3.878093683954672*^9, 
  3.878096061390531*^9, 3.8781066143839417`*^9, 3.878110713398693*^9},
 CellLabel->
  "During evaluation of \
In[1843]:=",ExpressionUUID->"3cfc95f1-96f4-4768-abcd-d97fff36da43"]
}, Open  ]]
}, Open  ]],

Cell[CellGroupData[{

Cell["Factorisation condition v.p2", "Subsection",
 CellChangeTimes->{{3.878076748965989*^9, 3.878076767862722*^9}, {
  3.878093747799068*^9, 
  3.8780937495889473`*^9}},ExpressionUUID->"379cc9e9-cc4e-41ce-a1f5-\
2a4837d5b90f"],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{
  RowBox[{"numAnsatz3", "=", 
   RowBox[{
    RowBox[{
     RowBox[{
      RowBox[{
       RowBox[{"(", "numAnsatz2", ")"}], "//.", "dotRules"}], "/.", 
      RowBox[{"(", 
       RowBox[{
        RowBox[{"vonshell", "[", 
         RowBox[{
          RowBox[{"n", "-", "1"}], ",", "3"}], "]"}], "/.", 
        RowBox[{"v", "->", 
         RowBox[{"v", "[", "1", "]"}]}]}], ")"}]}], "/.", "solsvp1"}], "//", 
    "Expand"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{"%", "//", "Length"}]}], "Input",
 CellChangeTimes->{{3.878076776346158*^9, 3.878076791822427*^9}, {
   3.878076863747164*^9, 3.8780768651784353`*^9}, {3.878077446334421*^9, 
   3.878077450450157*^9}, 3.878080568874198*^9, 3.878080843522138*^9, {
   3.878084931218405*^9, 3.8780849369136047`*^9}, {3.878085107286035*^9, 
   3.878085112014679*^9}, {3.8780852927862673`*^9, 3.878085294285921*^9}, {
   3.8780937634764643`*^9, 3.8780937712084923`*^9}, {3.878094578752013*^9, 
   3.87809458003332*^9}},
 CellLabel->
  "In[1846]:=",ExpressionUUID->"67810cac-ef26-414e-973b-982b6d3c9be5"],

Cell[BoxData["1181"], "Output",
 CellChangeTimes->{{3.87807677960294*^9, 3.878076792387086*^9}, 
   3.878076869394702*^9, 3.878077463656658*^9, 3.878080582971023*^9, 
   3.878081061748372*^9, 3.878084951014349*^9, 3.878085126532173*^9, 
   3.878085312641127*^9, 3.878093665706396*^9, 3.878094602309922*^9, 
   3.8780960624008083`*^9, 3.878106626228441*^9, 3.878110729159609*^9},
 CellLabel->
  "Out[1847]=",ExpressionUUID->"6a5735f8-197f-4ac0-bb40-6ef3a2cbc7f4"]
}, Open  ]],

Cell[BoxData[
 RowBox[{
  RowBox[{"numAnsatzvp1", "=", 
   RowBox[{
    RowBox[{
     RowBox[{
      RowBox[{"(", 
       RowBox[{
        RowBox[{
         RowBox[{"(", 
          RowBox[{"numAnsatz3", "//", 
           RowBox[{"Cases", "[", 
            RowBox[{"Times", "[", 
             RowBox[{"f___", ",", 
              RowBox[{"Power", "[", 
               RowBox[{
                RowBox[{"dot", "[", 
                 RowBox[{
                  RowBox[{"p", "[", "2", "]"}], ",", 
                  RowBox[{"v", "[", "1", "]"}]}], "]"}], ",", 
                RowBox[{"-", "1"}]}], "]"}], ",", "g___"}], "]"}], "]"}]}], 
          ")"}], "/.", 
         RowBox[{
          RowBox[{"Power", "[", 
           RowBox[{
            RowBox[{"dot", "[", 
             RowBox[{
              RowBox[{"p", "[", "2", "]"}], ",", 
              RowBox[{"v", "[", "1", "]"}]}], "]"}], ",", 
            RowBox[{"-", "1"}]}], "]"}], "->", "1"}]}], "//", "Total"}], 
       ")"}], "//.", "dotRules"}], "/.", "vponshell"}], "/.", 
    RowBox[{"{", 
     RowBox[{
      RowBox[{
       RowBox[{"dot", "[", 
        RowBox[{
         RowBox[{"p", "[", "2", "]"}], ",", 
         RowBox[{"v", "[", "1", "]"}]}], "]"}], "->", "0"}], ",", 
      RowBox[{
       RowBox[{"dot", "[", 
        RowBox[{
         RowBox[{"p", "[", "3", "]"}], ",", 
         RowBox[{"v", "[", "1", "]"}]}], "]"}], "->", 
       RowBox[{"-", 
        RowBox[{"dot", "[", 
         RowBox[{
          RowBox[{"p", "[", "1", "]"}], ",", 
          RowBox[{"v", "[", "1", "]"}]}], "]"}]}]}]}], "}"}]}]}], 
  ";"}]], "Input",
 CellChangeTimes->{{3.878077052129978*^9, 3.878077125591745*^9}, {
   3.878077237157652*^9, 3.878077281353335*^9}, {3.8780773702267103`*^9, 
   3.8780774435353603`*^9}, {3.8780774739935207`*^9, 3.8780775017717133`*^9}, 
   3.878079930873101*^9, 3.878079973240665*^9, {3.878085415182927*^9, 
   3.8780854153236303`*^9}, 3.878085446328352*^9, {3.878094648731681*^9, 
   3.878094651846068*^9}, {3.878094696417069*^9, 3.878094712612356*^9}},
 CellLabel->
  "In[1848]:=",ExpressionUUID->"5ea2d570-323a-4077-9b1e-f425158719cb"],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"numAnsatzvp1", "//", "Length"}]], "Input",
 CellChangeTimes->{{3.878085457345728*^9, 3.878085458484248*^9}},
 CellLabel->
  "In[1849]:=",ExpressionUUID->"735a6f30-189f-4e68-8b54-0ff365476c17"],

Cell[BoxData["256"], "Output",
 CellChangeTimes->{{3.878085424115284*^9, 3.8780854589677*^9}, 
   3.878093671135722*^9, 3.878094722221806*^9, 3.878096062738055*^9, 
   3.878106638620821*^9, 3.878110733692247*^9},
 CellLabel->
  "Out[1849]=",ExpressionUUID->"6a001f81-8ccb-4132-a374-5ee6a52de13a"]
}, Open  ]],

Cell[BoxData[{
 RowBox[{
  RowBox[{"num1", "=", 
   RowBox[{
    RowBox[{
     RowBox[{"T", "[", 
      RowBox[{"{", "2", "}"}], "]"}], "/.", 
     RowBox[{"T", "->", "T2F"}]}], "/.", 
    RowBox[{"v", "->", 
     RowBox[{"v", "[", "1", "]"}]}]}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"num2", "=", 
   RowBox[{"(", 
    RowBox[{
     FractionBox[
      RowBox[{"dot", "[", 
       RowBox[{
        RowBox[{"p", "[", "1", "]"}], ",", 
        RowBox[{"S", "[", "0", "]"}], ",", 
        RowBox[{"F", "[", "1", "]"}], ",", 
        RowBox[{"F", "[", "3", "]"}], ",", 
        RowBox[{"v", "[", "1", "]"}]}], "]"}], 
      RowBox[{"dot", "[", 
       RowBox[{
        RowBox[{"p", "[", "1", "]"}], ",", 
        RowBox[{"v", "[", "1", "]"}]}], "]"}]], "+", 
     FractionBox[
      RowBox[{"dot", "[", 
       RowBox[{
        RowBox[{"p", "[", "1", "]"}], ",", 
        RowBox[{"S", "[", "0", "]"}], ",", 
        RowBox[{"F", "[", "3", "]"}], ",", 
        RowBox[{"F", "[", "1", "]"}], ",", 
        RowBox[{"v", "[", "1", "]"}]}], "]"}], 
      RowBox[{"dot", "[", 
       RowBox[{
        RowBox[{"p", "[", "1", "]"}], ",", 
        RowBox[{"v", "[", "1", "]"}]}], "]"}]], "-", 
     FractionBox[
      RowBox[{"dot", "[", 
       RowBox[{
        RowBox[{"p", "[", "1", "]"}], ",", 
        RowBox[{"F", "[", "3", "]"}], ",", 
        RowBox[{"S", "[", "0", "]"}], ",", 
        RowBox[{"F", "[", "1", "]"}], ",", 
        RowBox[{"v", "[", "1", "]"}]}], "]"}], 
      RowBox[{"dot", "[", 
       RowBox[{
        RowBox[{"p", "[", "1", "]"}], ",", 
        RowBox[{"v", "[", "1", "]"}]}], "]"}]], "+", 
     FractionBox[
      RowBox[{"dot", "[", 
       RowBox[{
        RowBox[{"p", "[", "3", "]"}], ",", 
        RowBox[{"S", "[", "0", "]"}], ",", 
        RowBox[{"F", "[", "3", "]"}], ",", 
        RowBox[{"F", "[", "1", "]"}], ",", 
        RowBox[{"v", "[", "1", "]"}]}], "]"}], 
      RowBox[{"dot", "[", 
       RowBox[{
        RowBox[{"p", "[", "1", "]"}], ",", 
        RowBox[{"v", "[", "1", "]"}]}], "]"}]]}], ")"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"numvp1", "=", 
   RowBox[{
    RowBox[{
     RowBox[{
      RowBox[{
       RowBox[{"dot", "[", 
        RowBox[{
         RowBox[{"p", "[", "1", "]"}], ",", 
         RowBox[{"p", "[", "2", "]"}]}], "]"}], 
       RowBox[{"(", 
        RowBox[{
         RowBox[{"num1", "*", "num2"}], "+", 
         RowBox[{
          FractionBox["1", 
           RowBox[{"dot", "[", 
            RowBox[{
             RowBox[{"p", "[", "1", "]"}], ",", 
             RowBox[{"v", "[", "1", "]"}]}], "]"}]], 
          RowBox[{"dot", "[", 
           RowBox[{
            RowBox[{"p", "[", "2", "]"}], ",", 
            RowBox[{"S", "[", "0", "]"}], ",", 
            RowBox[{"\[Epsilon]", "[", "2", "]"}]}], "]"}], "*", 
          RowBox[{"dot", "[", 
           RowBox[{
            RowBox[{"v", "[", "1", "]"}], ",", 
            RowBox[{"F", "[", "1", "]"}], ",", 
            RowBox[{"F", "[", "3", "]"}], ",", 
            RowBox[{"v", "[", "1", "]"}]}], "]"}]}]}], ")"}]}], "//.", 
      "dotRules"}], "//", "expandFS"}], "//", "Expand"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"numvp1", "=", 
   RowBox[{
    RowBox[{
     RowBox[{"numvp1", "//.", "dotRules"}], "/.", "vponshell"}], "/.", 
    RowBox[{"{", 
     RowBox[{
      RowBox[{
       RowBox[{"dot", "[", 
        RowBox[{
         RowBox[{"p", "[", "2", "]"}], ",", 
         RowBox[{"v", "[", "1", "]"}]}], "]"}], "->", "0"}], ",", 
      RowBox[{
       RowBox[{"dot", "[", 
        RowBox[{
         RowBox[{"p", "[", "3", "]"}], ",", 
         RowBox[{"v", "[", "1", "]"}]}], "]"}], "->", 
       RowBox[{"-", 
        RowBox[{"dot", "[", 
         RowBox[{
          RowBox[{"p", "[", "1", "]"}], ",", 
          RowBox[{"v", "[", "1", "]"}]}], "]"}]}]}]}], "}"}]}]}], 
  ";"}]}], "Input",
 CellChangeTimes->{{3.878077591985273*^9, 3.8780776461342783`*^9}, {
   3.878077953502172*^9, 3.878077980733405*^9}, {3.878078491930747*^9, 
   3.878078549563458*^9}, {3.878078580745262*^9, 3.87807865251903*^9}, 
   3.878078684800146*^9, {3.878079206140265*^9, 3.878079212664543*^9}, {
   3.878079938416065*^9, 3.8780799390210323`*^9}, {3.878079982854789*^9, 
   3.878079996138009*^9}, 3.878080718496252*^9, 3.878080776110016*^9, {
   3.878081116226698*^9, 3.8780811179219093`*^9}, {3.878081897887516*^9, 
   3.878081929737031*^9}, {3.8780819770250673`*^9, 3.8780819885274878`*^9}, 
   3.8780820357161922`*^9, {3.878082093586617*^9, 3.878082094494379*^9}, 
   3.878082200584118*^9, 3.8780823524734297`*^9, 3.8780843780876017`*^9, {
   3.87808451838385*^9, 3.878084553403726*^9}, {3.878084767872551*^9, 
   3.878084809993238*^9}, {3.878093413770879*^9, 3.878093418381057*^9}, 
   3.878094731163116*^9, {3.878094787760552*^9, 3.878094870939351*^9}, {
   3.878094944453622*^9, 3.878094946794712*^9}, {3.878106643713951*^9, 
   3.878106646634589*^9}},
 CellLabel->
  "In[1850]:=",ExpressionUUID->"c46833fe-bb42-4236-919e-d699cdceb78a"],

Cell[BoxData[
 RowBox[{
  RowBox[{"compvp1", "=", 
   RowBox[{"numAnsatzvp1", "-", "numvp1"}]}], ";"}]], "Input",
 CellChangeTimes->{{3.8780781147500143`*^9, 3.878078179889933*^9}, {
   3.878078714167301*^9, 3.878078719908218*^9}, {3.878078864983605*^9, 
   3.8780788894932623`*^9}, 3.878079927920136*^9, 3.87808000213634*^9},
 CellLabel->
  "In[1854]:=",ExpressionUUID->"900df586-c439-4fc2-abfa-205e6cfc5ed5"],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  RowBox[{"4", " ", 
   RowBox[{
    SubscriptBox["p", "1"], "\[CenterDot]", "S", "\[CenterDot]", 
    SubscriptBox["F", "1"], "\[CenterDot]", 
    SubscriptBox["F", "2"], "\[CenterDot]", "v"}]}], "+", 
  RowBox[{"4", 
   RowBox[{
    SubscriptBox["p", "1"], "\[CenterDot]", "S", "\[CenterDot]", 
    SubscriptBox["F", "2"], "\[CenterDot]", 
    SubscriptBox["F", "1"], "\[CenterDot]", "v"}]}], "-", 
  RowBox[{"4", " ", 
   RowBox[{
    SubscriptBox["p", "1"], "\[CenterDot]", 
    SubscriptBox["F", "2"], "\[CenterDot]", "S", "\[CenterDot]", 
    SubscriptBox["F", "1"], "\[CenterDot]", "v"}]}], "+", 
  RowBox[{"4", " ", 
   RowBox[{
    SubscriptBox["p", "2"], "\[CenterDot]", "S", "\[CenterDot]", 
    SubscriptBox["F", "2"], "\[CenterDot]", 
    SubscriptBox["F", "1"], "\[CenterDot]", "v"}]}]}]], "Input",
 CellChangeTimes->{{3.878078468972107*^9, 3.8780784821254663`*^9}},
 CellLabel->
  "In[1500]:=",ExpressionUUID->"dafc7ee9-8920-4c80-9acb-e14a7ab6d011"],

Cell[BoxData[
 RowBox[{
  RowBox[{"4", " ", 
   RowBox[{
    SubscriptBox["p", "1"], "\[CenterDot]", "S", "\[CenterDot]", 
    SubscriptBox["F", "1"], "\[CenterDot]", 
    SubscriptBox["F", "2"], "\[CenterDot]", "v"}]}], "+", 
  RowBox[{"4", " ", 
   RowBox[{
    SubscriptBox["p", "1"], "\[CenterDot]", "S", "\[CenterDot]", 
    SubscriptBox["F", "2"], "\[CenterDot]", 
    SubscriptBox["F", "1"], "\[CenterDot]", "v"}]}], "-", 
  RowBox[{"4", " ", 
   RowBox[{
    SubscriptBox["p", "1"], "\[CenterDot]", 
    SubscriptBox["F", "2"], "\[CenterDot]", "S", "\[CenterDot]", 
    SubscriptBox["F", "1"], "\[CenterDot]", "v"}]}], "+", 
  RowBox[{"4", " ", 
   RowBox[{
    SubscriptBox["p", "2"], "\[CenterDot]", "S", "\[CenterDot]", 
    SubscriptBox["F", "2"], "\[CenterDot]", 
    SubscriptBox["F", "1"], "\[CenterDot]", "v"}]}]}]], "Output",
 CellChangeTimes->{3.8780960628033333`*^9},
 CellLabel->
  "Out[1500]=",ExpressionUUID->"ef885fec-ff54-4e30-8b96-c4ae47c59f57"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"compvp1", "//", "Casesdot"}]], "Input",
 CellChangeTimes->{{3.8780788203554583`*^9, 3.878078825352446*^9}},
 CellLabel->
  "In[1501]:=",ExpressionUUID->"0376c9af-430a-4eb1-8140-fece7a045657"],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
   RowBox[{"dot", "[", 
    RowBox[{
     RowBox[{"p", "[", "1", "]"}], ",", 
     RowBox[{"p", "[", "2", "]"}]}], "]"}], ",", 
   RowBox[{"dot", "[", 
    RowBox[{
     RowBox[{"p", "[", "1", "]"}], ",", 
     RowBox[{"p", "[", "3", "]"}]}], "]"}], ",", 
   RowBox[{"dot", "[", 
    RowBox[{
     RowBox[{"p", "[", "1", "]"}], ",", 
     RowBox[{"v", "[", "1", "]"}]}], "]"}], ",", 
   RowBox[{"dot", "[", 
    RowBox[{
     RowBox[{"p", "[", "1", "]"}], ",", 
     RowBox[{"\[Epsilon]", "[", "2", "]"}]}], "]"}], ",", 
   RowBox[{"dot", "[", 
    RowBox[{
     RowBox[{"p", "[", "1", "]"}], ",", 
     RowBox[{"\[Epsilon]", "[", "3", "]"}]}], "]"}], ",", 
   RowBox[{"dot", "[", 
    RowBox[{
     RowBox[{"p", "[", "2", "]"}], ",", 
     RowBox[{"p", "[", "3", "]"}]}], "]"}], ",", 
   RowBox[{"dot", "[", 
    RowBox[{
     RowBox[{"p", "[", "2", "]"}], ",", 
     RowBox[{"\[Epsilon]", "[", "1", "]"}]}], "]"}], ",", 
   RowBox[{"dot", "[", 
    RowBox[{
     RowBox[{"p", "[", "2", "]"}], ",", 
     RowBox[{"\[Epsilon]", "[", "3", "]"}]}], "]"}], ",", 
   RowBox[{"dot", "[", 
    RowBox[{
     RowBox[{"p", "[", "3", "]"}], ",", 
     RowBox[{"\[Epsilon]", "[", "1", "]"}]}], "]"}], ",", 
   RowBox[{"dot", "[", 
    RowBox[{
     RowBox[{"p", "[", "3", "]"}], ",", 
     RowBox[{"\[Epsilon]", "[", "2", "]"}]}], "]"}], ",", 
   RowBox[{"dot", "[", 
    RowBox[{
     RowBox[{"v", "[", "1", "]"}], ",", 
     RowBox[{"\[Epsilon]", "[", "1", "]"}]}], "]"}], ",", 
   RowBox[{"dot", "[", 
    RowBox[{
     RowBox[{"v", "[", "1", "]"}], ",", 
     RowBox[{"\[Epsilon]", "[", "2", "]"}]}], "]"}], ",", 
   RowBox[{"dot", "[", 
    RowBox[{
     RowBox[{"v", "[", "1", "]"}], ",", 
     RowBox[{"\[Epsilon]", "[", "3", "]"}]}], "]"}], ",", 
   RowBox[{"dot", "[", 
    RowBox[{
     RowBox[{"\[Epsilon]", "[", "1", "]"}], ",", 
     RowBox[{"\[Epsilon]", "[", "2", "]"}]}], "]"}], ",", 
   RowBox[{"dot", "[", 
    RowBox[{
     RowBox[{"\[Epsilon]", "[", "1", "]"}], ",", 
     RowBox[{"\[Epsilon]", "[", "3", "]"}]}], "]"}], ",", 
   RowBox[{"dot", "[", 
    RowBox[{
     RowBox[{"\[Epsilon]", "[", "2", "]"}], ",", 
     RowBox[{"\[Epsilon]", "[", "3", "]"}]}], "]"}], ",", 
   RowBox[{"dot", "[", 
    RowBox[{
     RowBox[{"p", "[", "1", "]"}], ",", 
     RowBox[{"S", "[", "0", "]"}], ",", 
     RowBox[{"p", "[", "2", "]"}]}], "]"}], ",", 
   RowBox[{"dot", "[", 
    RowBox[{
     RowBox[{"p", "[", "1", "]"}], ",", 
     RowBox[{"S", "[", "0", "]"}], ",", 
     RowBox[{"p", "[", "3", "]"}]}], "]"}], ",", 
   RowBox[{"dot", "[", 
    RowBox[{
     RowBox[{"p", "[", "1", "]"}], ",", 
     RowBox[{"S", "[", "0", "]"}], ",", 
     RowBox[{"\[Epsilon]", "[", "1", "]"}]}], "]"}], ",", 
   RowBox[{"dot", "[", 
    RowBox[{
     RowBox[{"p", "[", "1", "]"}], ",", 
     RowBox[{"S", "[", "0", "]"}], ",", 
     RowBox[{"\[Epsilon]", "[", "2", "]"}]}], "]"}], ",", 
   RowBox[{"dot", "[", 
    RowBox[{
     RowBox[{"p", "[", "1", "]"}], ",", 
     RowBox[{"S", "[", "0", "]"}], ",", 
     RowBox[{"\[Epsilon]", "[", "3", "]"}]}], "]"}], ",", 
   RowBox[{"dot", "[", 
    RowBox[{
     RowBox[{"p", "[", "2", "]"}], ",", 
     RowBox[{"S", "[", "0", "]"}], ",", 
     RowBox[{"p", "[", "3", "]"}]}], "]"}], ",", 
   RowBox[{"dot", "[", 
    RowBox[{
     RowBox[{"p", "[", "2", "]"}], ",", 
     RowBox[{"S", "[", "0", "]"}], ",", 
     RowBox[{"\[Epsilon]", "[", "1", "]"}]}], "]"}], ",", 
   RowBox[{"dot", "[", 
    RowBox[{
     RowBox[{"p", "[", "2", "]"}], ",", 
     RowBox[{"S", "[", "0", "]"}], ",", 
     RowBox[{"\[Epsilon]", "[", "2", "]"}]}], "]"}], ",", 
   RowBox[{"dot", "[", 
    RowBox[{
     RowBox[{"p", "[", "2", "]"}], ",", 
     RowBox[{"S", "[", "0", "]"}], ",", 
     RowBox[{"\[Epsilon]", "[", "3", "]"}]}], "]"}], ",", 
   RowBox[{"dot", "[", 
    RowBox[{
     RowBox[{"p", "[", "3", "]"}], ",", 
     RowBox[{"S", "[", "0", "]"}], ",", 
     RowBox[{"\[Epsilon]", "[", "1", "]"}]}], "]"}], ",", 
   RowBox[{"dot", "[", 
    RowBox[{
     RowBox[{"p", "[", "3", "]"}], ",", 
     RowBox[{"S", "[", "0", "]"}], ",", 
     RowBox[{"\[Epsilon]", "[", "2", "]"}]}], "]"}], ",", 
   RowBox[{"dot", "[", 
    RowBox[{
     RowBox[{"p", "[", "3", "]"}], ",", 
     RowBox[{"S", "[", "0", "]"}], ",", 
     RowBox[{"\[Epsilon]", "[", "3", "]"}]}], "]"}], ",", 
   RowBox[{"dot", "[", 
    RowBox[{
     RowBox[{"\[Epsilon]", "[", "1", "]"}], ",", 
     RowBox[{"S", "[", "0", "]"}], ",", 
     RowBox[{"\[Epsilon]", "[", "2", "]"}]}], "]"}], ",", 
   RowBox[{"dot", "[", 
    RowBox[{
     RowBox[{"\[Epsilon]", "[", "1", "]"}], ",", 
     RowBox[{"S", "[", "0", "]"}], ",", 
     RowBox[{"\[Epsilon]", "[", "3", "]"}]}], "]"}], ",", 
   RowBox[{"dot", "[", 
    RowBox[{
     RowBox[{"\[Epsilon]", "[", "2", "]"}], ",", 
     RowBox[{"S", "[", "0", "]"}], ",", 
     RowBox[{"\[Epsilon]", "[", "3", "]"}]}], "]"}]}], "}"}]], "Output",
 CellChangeTimes->{3.8780787909855328`*^9, 3.878078825754147*^9, 
  3.8780789139500523`*^9, 3.878079583885482*^9, 3.8780807366766977`*^9, 
  3.87808078442798*^9, 3.878095061451518*^9, 3.87809606280996*^9},
 CellLabel->
  "Out[1501]=",ExpressionUUID->"1834c089-1a6c-4354-a614-c6b152afc21a"]
}, Open  ]],

Cell[BoxData[{
 RowBox[{
  RowBox[{"cvars", "=", 
   RowBox[{
    RowBox[{"Cases", "[", 
     RowBox[{"compvp1", ",", 
      RowBox[{"c", "[", "__", "]"}], ",", 
      RowBox[{"{", 
       RowBox[{"0", ",", "\[Infinity]"}], "}"}]}], "]"}], "//", "Union"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"vardot", "=", 
   RowBox[{"compvp1", "//", "Casesdot"}]}], ";"}]}], "Input",
 CellChangeTimes->{{3.878078218083035*^9, 3.878078227195683*^9}},
 CellLabel->
  "In[1855]:=",ExpressionUUID->"e343c648-ccd2-43a2-b8ef-f0409eb9b4c9"],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"cvars", "//", "Length"}]], "Input",
 CellChangeTimes->{{3.878078250405406*^9, 3.8780782515980988`*^9}, 
   3.8780793030421352`*^9, {3.878080618122617*^9, 3.878080619511405*^9}},
 CellLabel->
  "In[1857]:=",ExpressionUUID->"7e06ccd0-81fc-4e62-96de-03e3e0b3c199"],

Cell[BoxData["15"], "Output",
 CellChangeTimes->{
  3.878078252063862*^9, 3.878078732430634*^9, {3.8780792683050127`*^9, 
   3.878079303531766*^9}, {3.8780806116761723`*^9, 3.878080620497012*^9}, 
   3.878080793272333*^9, 3.8780810935750732`*^9, 3.8780811318686132`*^9, 
   3.878081941084124*^9, 3.8780820011325197`*^9, 3.878082120982493*^9, 
   3.878084828486793*^9, 3.878085517830093*^9, 3.878093680935251*^9, 
   3.878095084936636*^9, 3.878096062833789*^9, 3.878106656683487*^9, 
   3.878110745065216*^9},
 CellLabel->
  "Out[1857]=",ExpressionUUID->"d0b9b8b7-102f-4f9d-904a-84839df0c6c1"]
}, Open  ]],

Cell[BoxData[{
 RowBox[{
  RowBox[{"dot2num", ":=", 
   RowBox[{"Table", "[", 
    RowBox[{
     RowBox[{"Rule", "[", 
      RowBox[{
       RowBox[{"vardot", "[", 
        RowBox[{"[", "ii", "]"}], "]"}], ",", 
       RowBox[{"RandomInteger", "[", 
        RowBox[{"{", 
         RowBox[{"10", ",", "100"}], "}"}], "]"}]}], "]"}], ",", 
     RowBox[{"{", 
      RowBox[{"ii", ",", 
       RowBox[{"Length", "[", "vardot", "]"}]}], "}"}]}], "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{"Monitor", "[", 
  RowBox[{
   RowBox[{
    RowBox[{"eqDep", "=", 
     RowBox[{"Table", "[", 
      RowBox[{
       RowBox[{
        RowBox[{"compvp1", "\[Equal]", "0"}], "/.", "dot2num"}], ",", 
       RowBox[{"{", 
        RowBox[{"ii", ",", 
         RowBox[{"10", "+", 
          RowBox[{"Length", "[", "cvars", "]"}]}]}], "}"}]}], "]"}]}], ";"}], 
   ",", "ii"}], "]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"solsvp2", "=", 
   RowBox[{
    RowBox[{"Solve", "[", 
     RowBox[{"eqDep", ",", "cvars"}], "]"}], "[", 
    RowBox[{"[", "1", "]"}], "]"}]}], ";"}]}], "Input",
 CellChangeTimes->{{3.878078221639757*^9, 3.878078240954069*^9}, {
  3.878081064658252*^9, 3.8780810690042477`*^9}, {3.878095748981908*^9, 
  3.878095749098365*^9}},
 CellLabel->
  "In[1858]:=",ExpressionUUID->"d28fb5a0-ab74-4036-b2d8-e383e656fb96"],

Cell[CellGroupData[{

Cell[BoxData["solsvp2"], "Input",
 CellLabel->
  "In[1861]:=",ExpressionUUID->"6d35c829-fa10-466b-a59d-1d59b549e23a"],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
   RowBox[{
    RowBox[{"c", "[", "6", "]"}], "\[Rule]", "0"}], ",", 
   RowBox[{
    RowBox[{"c", "[", "7", "]"}], "\[Rule]", "0"}], ",", 
   RowBox[{
    RowBox[{"c", "[", "10", "]"}], "\[Rule]", "0"}], ",", 
   RowBox[{
    RowBox[{"c", "[", "16", "]"}], "\[Rule]", "0"}], ",", 
   RowBox[{
    RowBox[{"c", "[", "21", "]"}], "\[Rule]", "0"}], ",", 
   RowBox[{
    RowBox[{"c", "[", "28", "]"}], "\[Rule]", "0"}], ",", 
   RowBox[{
    RowBox[{"c", "[", "33", "]"}], "\[Rule]", "0"}], ",", 
   RowBox[{
    RowBox[{"c", "[", "45", "]"}], "\[Rule]", "0"}], ",", 
   RowBox[{
    RowBox[{"c", "[", "50", "]"}], "\[Rule]", "0"}], ",", 
   RowBox[{
    RowBox[{"c", "[", "68", "]"}], "\[Rule]", "1"}], ",", 
   RowBox[{
    RowBox[{"c", "[", "201", "]"}], "\[Rule]", "0"}], ",", 
   RowBox[{
    RowBox[{"c", "[", "203", "]"}], "\[Rule]", "0"}], ",", 
   RowBox[{
    RowBox[{"c", "[", "205", "]"}], "\[Rule]", "0"}], ",", 
   RowBox[{
    RowBox[{"c", "[", "209", "]"}], "\[Rule]", "0"}], ",", 
   RowBox[{
    RowBox[{"c", "[", "227", "]"}], "\[Rule]", "0"}]}], "}"}]], "Output",
 CellChangeTimes->{3.878105405899537*^9, 3.878106662223672*^9, 
  3.8781107493123293`*^9},
 CellLabel->
  "Out[1861]=",ExpressionUUID->"7dca5ed4-9fe2-4457-a34e-8af5ac245d9c"]
}, Open  ]]
}, Open  ]],

Cell[CellGroupData[{

Cell["Factorisation condition v.p3", "Subsection",
 CellChangeTimes->{{3.878076748965989*^9, 3.878076767862722*^9}, {
  3.878093747799068*^9, 3.8780937495889473`*^9}, {3.878095192789927*^9, 
  3.8780951929813747`*^9}},ExpressionUUID->"c0254820-aca8-4b81-aa66-\
6d34b6c862ff"],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{
  RowBox[{"numAnsatz4", "=", 
   RowBox[{
    RowBox[{
     RowBox[{
      RowBox[{
       RowBox[{"(", "numAnsatz3", ")"}], "//.", "dotRules"}], "/.", 
      RowBox[{"(", 
       RowBox[{
        RowBox[{"vonshell", "[", 
         RowBox[{
          RowBox[{"n", "-", "1"}], ",", "2"}], "]"}], "/.", 
        RowBox[{"v", "->", 
         RowBox[{"v", "[", "1", "]"}]}]}], ")"}]}], "/.", "solsvp2"}], "//", 
    "Expand"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{"%", "//", "Length"}]}], "Input",
 CellChangeTimes->{{3.878076776346158*^9, 3.878076791822427*^9}, {
   3.878076863747164*^9, 3.8780768651784353`*^9}, {3.878077446334421*^9, 
   3.878077450450157*^9}, 3.878080568874198*^9, 3.878080843522138*^9, {
   3.878084931218405*^9, 3.8780849369136047`*^9}, {3.878085107286035*^9, 
   3.878085112014679*^9}, {3.8780852927862673`*^9, 3.878085294285921*^9}, {
   3.8780937634764643`*^9, 3.8780937712084923`*^9}, {3.878094578752013*^9, 
   3.87809458003332*^9}, {3.8780951988903418`*^9, 3.8780952057126427`*^9}, {
   3.8780957389282017`*^9, 3.878095739594145*^9}},
 CellLabel->
  "In[1862]:=",ExpressionUUID->"f44f5ba3-2a89-47dd-9ccf-21fb467a01a7"],

Cell[BoxData["85"], "Output",
 CellChangeTimes->{{3.87807677960294*^9, 3.878076792387086*^9}, 
   3.878076869394702*^9, 3.878077463656658*^9, 3.878080582971023*^9, 
   3.878081061748372*^9, 3.878084951014349*^9, 3.878085126532173*^9, 
   3.878085312641127*^9, 3.878093665706396*^9, 3.878094602309922*^9, 
   3.878095215999476*^9, 3.878096067273143*^9, 3.878106671780857*^9, 
   3.878110759023982*^9},
 CellLabel->
  "Out[1863]=",ExpressionUUID->"d462e5de-2f47-427a-a7fa-5e7b78e0cb22"]
}, Open  ]],

Cell[BoxData[
 RowBox[{
  RowBox[{"numAnsatzvp1", "=", 
   RowBox[{
    RowBox[{
     RowBox[{
      RowBox[{"(", 
       RowBox[{
        RowBox[{
         RowBox[{"(", 
          RowBox[{"numAnsatz4", "//", 
           RowBox[{"Cases", "[", 
            RowBox[{"Times", "[", 
             RowBox[{"f___", ",", 
              RowBox[{"Power", "[", 
               RowBox[{
                RowBox[{"dot", "[", 
                 RowBox[{
                  RowBox[{"p", "[", "3", "]"}], ",", 
                  RowBox[{"v", "[", "1", "]"}]}], "]"}], ",", 
                RowBox[{"-", "1"}]}], "]"}], ",", "g___"}], "]"}], "]"}]}], 
          ")"}], "/.", 
         RowBox[{
          RowBox[{"Power", "[", 
           RowBox[{
            RowBox[{"dot", "[", 
             RowBox[{
              RowBox[{"p", "[", "3", "]"}], ",", 
              RowBox[{"v", "[", "1", "]"}]}], "]"}], ",", 
            RowBox[{"-", "1"}]}], "]"}], "->", "1"}]}], "//", "Total"}], 
       ")"}], "//.", "dotRules"}], "/.", "vponshell"}], "/.", 
    RowBox[{"{", 
     RowBox[{
      RowBox[{
       RowBox[{"dot", "[", 
        RowBox[{
         RowBox[{"p", "[", "3", "]"}], ",", 
         RowBox[{"v", "[", "1", "]"}]}], "]"}], "->", "0"}], ",", 
      RowBox[{
       RowBox[{"dot", "[", 
        RowBox[{
         RowBox[{"p", "[", "2", "]"}], ",", 
         RowBox[{"v", "[", "1", "]"}]}], "]"}], "->", 
       RowBox[{"-", 
        RowBox[{"dot", "[", 
         RowBox[{
          RowBox[{"p", "[", "1", "]"}], ",", 
          RowBox[{"v", "[", "1", "]"}]}], "]"}]}]}]}], "}"}]}]}], 
  ";"}]], "Input",
 CellChangeTimes->{{3.878077052129978*^9, 3.878077125591745*^9}, {
   3.878077237157652*^9, 3.878077281353335*^9}, {3.8780773702267103`*^9, 
   3.8780774435353603`*^9}, {3.8780774739935207`*^9, 3.8780775017717133`*^9}, 
   3.878079930873101*^9, 3.878079973240665*^9, {3.878085415182927*^9, 
   3.8780854153236303`*^9}, 3.878085446328352*^9, {3.878094648731681*^9, 
   3.878094651846068*^9}, {3.878094696417069*^9, 3.878094712612356*^9}, 
   3.8780952799470053`*^9, {3.878095329611971*^9, 3.878095354825946*^9}},
 CellLabel->
  "In[1864]:=",ExpressionUUID->"d12fd0ee-7560-4079-8d93-ae508a9a0722"],

Cell[BoxData[{
 RowBox[{
  RowBox[{"num1", "=", 
   RowBox[{
    RowBox[{
     RowBox[{"T", "[", 
      RowBox[{"{", "3", "}"}], "]"}], "/.", 
     RowBox[{"T", "->", "T2F"}]}], "/.", 
    RowBox[{"v", "->", 
     RowBox[{"v", "[", "1", "]"}]}]}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"num2", "=", 
   RowBox[{"(", 
    RowBox[{
     FractionBox[
      RowBox[{"dot", "[", 
       RowBox[{
        RowBox[{"p", "[", "1", "]"}], ",", 
        RowBox[{"S", "[", "0", "]"}], ",", 
        RowBox[{"F", "[", "1", "]"}], ",", 
        RowBox[{"F", "[", "2", "]"}], ",", 
        RowBox[{"v", "[", "1", "]"}]}], "]"}], 
      RowBox[{"dot", "[", 
       RowBox[{
        RowBox[{"p", "[", "1", "]"}], ",", 
        RowBox[{"v", "[", "1", "]"}]}], "]"}]], "+", 
     FractionBox[
      RowBox[{"dot", "[", 
       RowBox[{
        RowBox[{"p", "[", "1", "]"}], ",", 
        RowBox[{"S", "[", "0", "]"}], ",", 
        RowBox[{"F", "[", "2", "]"}], ",", 
        RowBox[{"F", "[", "1", "]"}], ",", 
        RowBox[{"v", "[", "1", "]"}]}], "]"}], 
      RowBox[{"dot", "[", 
       RowBox[{
        RowBox[{"p", "[", "1", "]"}], ",", 
        RowBox[{"v", "[", "1", "]"}]}], "]"}]], "-", 
     FractionBox[
      RowBox[{"dot", "[", 
       RowBox[{
        RowBox[{"p", "[", "1", "]"}], ",", 
        RowBox[{"F", "[", "2", "]"}], ",", 
        RowBox[{"S", "[", "0", "]"}], ",", 
        RowBox[{"F", "[", "1", "]"}], ",", 
        RowBox[{"v", "[", "1", "]"}]}], "]"}], 
      RowBox[{"dot", "[", 
       RowBox[{
        RowBox[{"p", "[", "1", "]"}], ",", 
        RowBox[{"v", "[", "1", "]"}]}], "]"}]], "+", 
     FractionBox[
      RowBox[{"dot", "[", 
       RowBox[{
        RowBox[{"p", "[", "2", "]"}], ",", 
        RowBox[{"S", "[", "0", "]"}], ",", 
        RowBox[{"F", "[", "2", "]"}], ",", 
        RowBox[{"F", "[", "1", "]"}], ",", 
        RowBox[{"v", "[", "1", "]"}]}], "]"}], 
      RowBox[{"dot", "[", 
       RowBox[{
        RowBox[{"p", "[", "1", "]"}], ",", 
        RowBox[{"v", "[", "1", "]"}]}], "]"}]]}], ")"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"numvp1", "=", 
   RowBox[{
    RowBox[{
     RowBox[{
      RowBox[{
       RowBox[{"dot", "[", 
        RowBox[{
         RowBox[{
          RowBox[{"p", "[", "1", "]"}], "+", 
          RowBox[{"p", "[", "2", "]"}]}], ",", 
         RowBox[{"p", "[", "3", "]"}]}], "]"}], 
       RowBox[{"(", 
        RowBox[{
         RowBox[{
          RowBox[{"c", "[", "3", "]"}], "num1", "*", "num2"}], "+", 
         RowBox[{
          FractionBox["1", 
           RowBox[{"dot", "[", 
            RowBox[{
             RowBox[{"p", "[", "1", "]"}], ",", 
             RowBox[{"v", "[", "1", "]"}]}], "]"}]], 
          RowBox[{"c", "[", "4", "]"}], 
          RowBox[{"dot", "[", 
           RowBox[{
            RowBox[{"p", "[", "3", "]"}], ",", 
            RowBox[{"S", "[", "0", "]"}], ",", 
            RowBox[{"\[Epsilon]", "[", "3", "]"}]}], "]"}], "*", 
          RowBox[{"dot", "[", 
           RowBox[{
            RowBox[{"v", "[", "1", "]"}], ",", 
            RowBox[{"F", "[", "1", "]"}], ",", 
            RowBox[{"F", "[", "2", "]"}], ",", 
            RowBox[{"v", "[", "1", "]"}]}], "]"}]}]}], ")"}]}], "//.", 
      "dotRules"}], "//", "expandFS"}], "//", "Expand"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"numvp1", "=", 
   RowBox[{
    RowBox[{
     RowBox[{"numvp1", "//.", "dotRules"}], "/.", "vponshell"}], "/.", 
    RowBox[{"{", 
     RowBox[{
      RowBox[{
       RowBox[{"dot", "[", 
        RowBox[{
         RowBox[{"p", "[", "3", "]"}], ",", 
         RowBox[{"v", "[", "1", "]"}]}], "]"}], "->", "0"}], ",", 
      RowBox[{
       RowBox[{"dot", "[", 
        RowBox[{
         RowBox[{"p", "[", "2", "]"}], ",", 
         RowBox[{"v", "[", "1", "]"}]}], "]"}], "->", 
       RowBox[{"-", 
        RowBox[{"dot", "[", 
         RowBox[{
          RowBox[{"p", "[", "1", "]"}], ",", 
          RowBox[{"v", "[", "1", "]"}]}], "]"}]}]}]}], "}"}]}]}], 
  ";"}]}], "Input",
 CellChangeTimes->{{3.878077591985273*^9, 3.8780776461342783`*^9}, {
   3.878077953502172*^9, 3.878077980733405*^9}, {3.878078491930747*^9, 
   3.878078549563458*^9}, {3.878078580745262*^9, 3.87807865251903*^9}, 
   3.878078684800146*^9, {3.878079206140265*^9, 3.878079212664543*^9}, {
   3.878079938416065*^9, 3.8780799390210323`*^9}, {3.878079982854789*^9, 
   3.878079996138009*^9}, 3.878080718496252*^9, 3.878080776110016*^9, {
   3.878081116226698*^9, 3.8780811179219093`*^9}, {3.878081897887516*^9, 
   3.878081929737031*^9}, {3.8780819770250673`*^9, 3.8780819885274878`*^9}, 
   3.8780820357161922`*^9, {3.878082093586617*^9, 3.878082094494379*^9}, 
   3.878082200584118*^9, 3.8780823524734297`*^9, 3.8780843780876017`*^9, {
   3.87808451838385*^9, 3.878084553403726*^9}, {3.878084767872551*^9, 
   3.878084809993238*^9}, {3.878093413770879*^9, 3.878093418381057*^9}, 
   3.878094731163116*^9, {3.878094787760552*^9, 3.878094870939351*^9}, {
   3.878094944453622*^9, 3.878094946794712*^9}, {3.878095374742682*^9, 
   3.878095391986203*^9}, {3.8780954563856373`*^9, 3.878095483306056*^9}, {
   3.878095605265438*^9, 3.878095616154799*^9}, {3.878095684075735*^9, 
   3.878095688268168*^9}},
 CellLabel->
  "In[1865]:=",ExpressionUUID->"3ca9767b-e9d3-4bb0-9e75-152b76f7ad91"],

Cell[BoxData[
 RowBox[{
  RowBox[{"compvp1", "=", 
   RowBox[{"numAnsatzvp1", "-", "numvp1"}]}], ";"}]], "Input",
 CellChangeTimes->{{3.8780781147500143`*^9, 3.878078179889933*^9}, {
   3.878078714167301*^9, 3.878078719908218*^9}, {3.878078864983605*^9, 
   3.8780788894932623`*^9}, 3.878079927920136*^9, 3.87808000213634*^9},
 CellLabel->
  "In[1869]:=",ExpressionUUID->"2d03fca1-afb7-4b7b-84dd-e804fcd254d7"],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"compvp1", "/.", 
  RowBox[{"{", 
   RowBox[{
    RowBox[{
     RowBox[{"c", "[", "3", "]"}], "->", "1"}], ",", 
    RowBox[{
     RowBox[{"c", "[", "4", "]"}], "->", "1"}]}], "}"}]}]], "Input",
 CellChangeTimes->{{3.878095527643024*^9, 3.878095578279685*^9}, {
  3.878095625110869*^9, 3.878095641471002*^9}},
 CellLabel->
  "In[1518]:=",ExpressionUUID->"6618b060-3530-4f7b-95f7-2e6fb07f110d"],

Cell[BoxData["0"], "Output",
 CellChangeTimes->{{3.878095519546192*^9, 3.878095530830967*^9}, {
   3.8780955685470467`*^9, 3.878095578769575*^9}, {3.8780956254979887`*^9, 
   3.87809564203146*^9}, 3.878095695176092*^9, 3.8780960673961983`*^9},
 CellLabel->
  "Out[1518]=",ExpressionUUID->"1d5c78f0-4832-4327-85a9-51b09a95654c"]
}, Open  ]],

Cell[BoxData[{
 RowBox[{
  RowBox[{"cvars", "=", 
   RowBox[{
    RowBox[{"Cases", "[", 
     RowBox[{"compvp1", ",", 
      RowBox[{"c", "[", "__", "]"}], ",", 
      RowBox[{"{", 
       RowBox[{"0", ",", "\[Infinity]"}], "}"}]}], "]"}], "//", "Union"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"vardot", "=", 
   RowBox[{"compvp1", "//", "Casesdot"}]}], ";"}]}], "Input",
 CellChangeTimes->{{3.878078218083035*^9, 3.878078227195683*^9}},
 CellLabel->
  "In[1870]:=",ExpressionUUID->"c65e1169-cdad-4cd2-9c97-8dc323839e66"],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"cvars", "//", "Length"}]], "Input",
 CellChangeTimes->{{3.878078250405406*^9, 3.8780782515980988`*^9}, 
   3.8780793030421352`*^9, {3.878080618122617*^9, 3.878080619511405*^9}},
 CellLabel->
  "In[1521]:=",ExpressionUUID->"2beff2b6-538d-4be5-a333-fc1b0eaa1683"],

Cell[BoxData["2"], "Output",
 CellChangeTimes->{
  3.878078252063862*^9, 3.878078732430634*^9, {3.8780792683050127`*^9, 
   3.878079303531766*^9}, {3.8780806116761723`*^9, 3.878080620497012*^9}, 
   3.878080793272333*^9, 3.8780810935750732`*^9, 3.8780811318686132`*^9, 
   3.878081941084124*^9, 3.8780820011325197`*^9, 3.878082120982493*^9, 
   3.878084828486793*^9, 3.878085517830093*^9, 3.878093680935251*^9, 
   3.878095084936636*^9, 3.878095713545517*^9, 3.878096067412579*^9},
 CellLabel->
  "Out[1521]=",ExpressionUUID->"d942df95-1459-4c4a-acb3-8332859df397"]
}, Open  ]],

Cell[BoxData[{
 RowBox[{
  RowBox[{"dot2num", ":=", 
   RowBox[{"Table", "[", 
    RowBox[{
     RowBox[{"Rule", "[", 
      RowBox[{
       RowBox[{"vardot", "[", 
        RowBox[{"[", "ii", "]"}], "]"}], ",", 
       RowBox[{"RandomInteger", "[", 
        RowBox[{"{", 
         RowBox[{"10", ",", "100"}], "}"}], "]"}]}], "]"}], ",", 
     RowBox[{"{", 
      RowBox[{"ii", ",", 
       RowBox[{"Length", "[", "vardot", "]"}]}], "}"}]}], "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{"Monitor", "[", 
  RowBox[{
   RowBox[{
    RowBox[{"eqDep", "=", 
     RowBox[{"Table", "[", 
      RowBox[{
       RowBox[{
        RowBox[{"compvp1", "\[Equal]", "0"}], "/.", "dot2num"}], ",", 
       RowBox[{"{", 
        RowBox[{"ii", ",", 
         RowBox[{"10", "+", 
          RowBox[{"Length", "[", "cvars", "]"}]}]}], "}"}]}], "]"}]}], ";"}], 
   ",", "ii"}], "]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"solsvp3", "=", 
   RowBox[{
    RowBox[{"Solve", "[", 
     RowBox[{"eqDep", ",", "cvars"}], "]"}], "[", 
    RowBox[{"[", "1", "]"}], "]"}]}], ";"}]}], "Input",
 CellChangeTimes->{{3.878078221639757*^9, 3.878078240954069*^9}, {
  3.878081064658252*^9, 3.8780810690042477`*^9}, {3.878095733492796*^9, 
  3.878095733629385*^9}},
 CellLabel->
  "In[1872]:=",ExpressionUUID->"ebacb69c-e1e6-4f28-8079-82399b128b1f"],

Cell[CellGroupData[{

Cell[BoxData["solsvp3"], "Input",
 CellChangeTimes->{{3.878096861054673*^9, 3.8780968614695673`*^9}},
 CellLabel->
  "In[1875]:=",ExpressionUUID->"a0138ef6-8b8f-40a7-b906-46fcd545dcc3"],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
   RowBox[{
    RowBox[{"c", "[", "3", "]"}], "\[Rule]", "1"}], ",", 
   RowBox[{
    RowBox[{"c", "[", "4", "]"}], "\[Rule]", "1"}]}], "}"}]], "Output",
 CellChangeTimes->{3.878093691306862*^9, 3.878095112706624*^9, 
  3.878095717543086*^9, 3.878096067453002*^9, 3.878096861847978*^9, 
  3.878106689921917*^9, 3.8781107730356693`*^9},
 CellLabel->
  "Out[1875]=",ExpressionUUID->"896c75a6-13d7-48da-bddf-8f1bc7f04283"]
}, Open  ]]
}, Open  ]],

Cell[CellGroupData[{

Cell["Final Result", "Subsection",
 CellChangeTimes->{{3.878095815607132*^9, 
  3.878095824409616*^9}},ExpressionUUID->"235c536f-16df-4021-9cdf-\
dadca244d542"],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"ansatzIdp", "/.", "sols"}], "/.", "solsvp1"}], "/.", "solsvp2"}],
   ";"}], "\[IndentingNewLine]", 
 RowBox[{"%", "//.", "nice"}]}], "Input",
 CellChangeTimes->{{3.8780958303263483`*^9, 3.878095831726018*^9}, {
   3.878096867922544*^9, 3.878096935558015*^9}, {3.878097392092999*^9, 
   3.878097396030863*^9}, 3.878110801162511*^9, 3.878111220809681*^9},
 CellLabel->
  "In[1886]:=",ExpressionUUID->"33810c38-01c9-446b-9c80-6c7678d2a202"],

Cell[BoxData[
 RowBox[{
  FractionBox[
   RowBox[{
    RowBox[{
     SubscriptBox["p", "1"], "\[CenterDot]", 
     SubscriptBox["F", "2"], "\[CenterDot]", 
     SubscriptBox["F", "3"], "\[CenterDot]", 
     SubscriptBox["v", "1"]}], " ", 
    RowBox[{
     SubscriptBox["p", "1"], "\[CenterDot]", 
     SubscriptBox["S", "0"], "\[CenterDot]", 
     SubscriptBox["F", "1"], "\[CenterDot]", 
     SubscriptBox["v", "1"]}]}], 
   RowBox[{
    RowBox[{
     SubscriptBox["p", "1"], "\[CenterDot]", 
     SubscriptBox["v", "1"]}], " ", 
    RowBox[{"(", 
     RowBox[{
      RowBox[{
       SubscriptBox["p", "1"], "\[CenterDot]", 
       SubscriptBox["v", "1"]}], "+", 
      RowBox[{
       SubscriptBox["p", "2"], "\[CenterDot]", 
       SubscriptBox["v", "1"]}]}], ")"}]}]], "+", 
  FractionBox[
   RowBox[{
    RowBox[{
     SubscriptBox["p", "2"], "\[CenterDot]", 
     SubscriptBox["F", "1"], "\[CenterDot]", 
     SubscriptBox["F", "3"], "\[CenterDot]", 
     SubscriptBox["v", "1"]}], " ", 
    RowBox[{
     SubscriptBox["p", "2"], "\[CenterDot]", 
     SubscriptBox["S", "0"], "\[CenterDot]", 
     SubscriptBox["F", "2"], "\[CenterDot]", 
     SubscriptBox["v", "1"]}]}], 
   RowBox[{
    RowBox[{
     SubscriptBox["p", "1"], "\[CenterDot]", 
     SubscriptBox["v", "1"]}], " ", 
    RowBox[{"(", 
     RowBox[{
      RowBox[{
       SubscriptBox["p", "1"], "\[CenterDot]", 
       SubscriptBox["v", "1"]}], "+", 
      RowBox[{
       SubscriptBox["p", "2"], "\[CenterDot]", 
       SubscriptBox["v", "1"]}]}], ")"}]}]], "+", 
  FractionBox[
   RowBox[{
    RowBox[{
     SubscriptBox["p", "2"], "\[CenterDot]", 
     SubscriptBox["F", "1"], "\[CenterDot]", 
     SubscriptBox["F", "3"], "\[CenterDot]", 
     SubscriptBox["v", "1"]}], " ", 
    RowBox[{
     SubscriptBox["p", "2"], "\[CenterDot]", 
     SubscriptBox["S", "0"], "\[CenterDot]", 
     SubscriptBox["F", "2"], "\[CenterDot]", 
     SubscriptBox["v", "1"]}]}], 
   RowBox[{
    RowBox[{
     SubscriptBox["p", "1"], "\[CenterDot]", 
     SubscriptBox["v", "1"]}], " ", 
    RowBox[{"(", 
     RowBox[{
      RowBox[{
       SubscriptBox["p", "1"], "\[CenterDot]", 
       SubscriptBox["v", "1"]}], "+", 
      RowBox[{
       SubscriptBox["p", "3"], "\[CenterDot]", 
       SubscriptBox["v", "1"]}]}], ")"}]}]], "+", 
  FractionBox[
   RowBox[{
    RowBox[{
     SubscriptBox["p", "3"], "\[CenterDot]", 
     SubscriptBox["F", "1"], "\[CenterDot]", 
     SubscriptBox["F", "2"], "\[CenterDot]", 
     SubscriptBox["v", "1"]}], " ", 
    RowBox[{
     SubscriptBox["p", "3"], "\[CenterDot]", 
     SubscriptBox["S", "0"], "\[CenterDot]", 
     SubscriptBox["F", "3"], "\[CenterDot]", 
     SubscriptBox["v", "1"]}]}], 
   RowBox[{
    RowBox[{
     SubscriptBox["p", "1"], "\[CenterDot]", 
     SubscriptBox["v", "1"]}], " ", 
    RowBox[{"(", 
     RowBox[{
      RowBox[{
       SubscriptBox["p", "1"], "\[CenterDot]", 
       SubscriptBox["v", "1"]}], "+", 
      RowBox[{
       SubscriptBox["p", "2"], "\[CenterDot]", 
       SubscriptBox["v", "1"]}]}], ")"}]}]], "+", 
  FractionBox[
   RowBox[{
    RowBox[{
     SubscriptBox["p", "3"], "\[CenterDot]", 
     SubscriptBox["F", "1"], "\[CenterDot]", 
     SubscriptBox["F", "2"], "\[CenterDot]", 
     SubscriptBox["v", "1"]}], " ", 
    RowBox[{
     SubscriptBox["p", "3"], "\[CenterDot]", 
     SubscriptBox["S", "0"], "\[CenterDot]", 
     SubscriptBox["F", "3"], "\[CenterDot]", 
     SubscriptBox["v", "1"]}]}], 
   RowBox[{
    RowBox[{
     SubscriptBox["p", "1"], "\[CenterDot]", 
     SubscriptBox["v", "1"]}], " ", 
    RowBox[{"(", 
     RowBox[{
      RowBox[{
       SubscriptBox["p", "1"], "\[CenterDot]", 
       SubscriptBox["v", "1"]}], "+", 
      RowBox[{
       SubscriptBox["p", "3"], "\[CenterDot]", 
       SubscriptBox["v", "1"]}]}], ")"}]}]], "+", 
  FractionBox[
   RowBox[{
    RowBox[{
     SubscriptBox["p", "3"], "\[CenterDot]", 
     SubscriptBox["F", "2"], "\[CenterDot]", 
     SubscriptBox["F", "1"], "\[CenterDot]", 
     SubscriptBox["v", "1"]}], " ", 
    RowBox[{
     SubscriptBox["p", "3"], "\[CenterDot]", 
     SubscriptBox["S", "0"], "\[CenterDot]", 
     SubscriptBox["F", "3"], "\[CenterDot]", 
     SubscriptBox["v", "1"]}]}], 
   RowBox[{
    RowBox[{
     SubscriptBox["p", "1"], "\[CenterDot]", 
     SubscriptBox["v", "1"]}], " ", 
    RowBox[{"(", 
     RowBox[{
      RowBox[{
       SubscriptBox["p", "1"], "\[CenterDot]", 
       SubscriptBox["v", "1"]}], "+", 
      RowBox[{
       SubscriptBox["p", "2"], "\[CenterDot]", 
       SubscriptBox["v", "1"]}]}], ")"}]}]], "-", 
  FractionBox[
   RowBox[{
    RowBox[{
     SubscriptBox["p", "1"], "\[CenterDot]", 
     SubscriptBox["F", "3"], "\[CenterDot]", 
     SubscriptBox["S", "0"], "\[CenterDot]", 
     SubscriptBox["p", "2"]}], " ", 
    RowBox[{
     SubscriptBox["v", "1"], "\[CenterDot]", 
     SubscriptBox["F", "1"], "\[CenterDot]", 
     SubscriptBox["F", "2"], "\[CenterDot]", 
     SubscriptBox["v", "1"]}]}], 
   RowBox[{
    RowBox[{
     SubscriptBox["p", "1"], "\[CenterDot]", 
     SubscriptBox["v", "1"]}], " ", 
    RowBox[{"(", 
     RowBox[{
      RowBox[{
       SubscriptBox["p", "1"], "\[CenterDot]", 
       SubscriptBox["v", "1"]}], "+", 
      RowBox[{
       SubscriptBox["p", "3"], "\[CenterDot]", 
       SubscriptBox["v", "1"]}]}], ")"}]}]], "+", 
  FractionBox[
   RowBox[{
    RowBox[{
     SubscriptBox["p", "1"], "\[CenterDot]", 
     SubscriptBox["F", "3"], "\[CenterDot]", 
     SubscriptBox["S", "0"], "\[CenterDot]", 
     SubscriptBox["p", "3"]}], " ", 
    RowBox[{
     SubscriptBox["v", "1"], "\[CenterDot]", 
     SubscriptBox["F", "1"], "\[CenterDot]", 
     SubscriptBox["F", "2"], "\[CenterDot]", 
     SubscriptBox["v", "1"]}]}], 
   RowBox[{
    RowBox[{
     SubscriptBox["p", "1"], "\[CenterDot]", 
     SubscriptBox["v", "1"]}], " ", 
    RowBox[{"(", 
     RowBox[{
      RowBox[{
       SubscriptBox["p", "1"], "\[CenterDot]", 
       SubscriptBox["v", "1"]}], "+", 
      RowBox[{
       SubscriptBox["p", "2"], "\[CenterDot]", 
       SubscriptBox["v", "1"]}]}], ")"}]}]], "+", 
  FractionBox[
   RowBox[{
    RowBox[{
     SubscriptBox["p", "1"], "\[CenterDot]", 
     SubscriptBox["F", "3"], "\[CenterDot]", 
     SubscriptBox["S", "0"], "\[CenterDot]", 
     SubscriptBox["p", "3"]}], " ", 
    RowBox[{
     SubscriptBox["v", "1"], "\[CenterDot]", 
     SubscriptBox["F", "1"], "\[CenterDot]", 
     SubscriptBox["F", "2"], "\[CenterDot]", 
     SubscriptBox["v", "1"]}]}], 
   RowBox[{
    RowBox[{
     SubscriptBox["p", "1"], "\[CenterDot]", 
     SubscriptBox["v", "1"]}], " ", 
    RowBox[{"(", 
     RowBox[{
      RowBox[{
       SubscriptBox["p", "1"], "\[CenterDot]", 
       SubscriptBox["v", "1"]}], "+", 
      RowBox[{
       SubscriptBox["p", "3"], "\[CenterDot]", 
       SubscriptBox["v", "1"]}]}], ")"}]}]], "+", 
  FractionBox[
   RowBox[{
    RowBox[{
     SubscriptBox["p", "1"], "\[CenterDot]", 
     SubscriptBox["S", "0"], "\[CenterDot]", 
     SubscriptBox["F", "3"], "\[CenterDot]", 
     SubscriptBox["p", "2"]}], " ", 
    RowBox[{
     SubscriptBox["v", "1"], "\[CenterDot]", 
     SubscriptBox["F", "1"], "\[CenterDot]", 
     SubscriptBox["F", "2"], "\[CenterDot]", 
     SubscriptBox["v", "1"]}]}], 
   RowBox[{
    RowBox[{
     SubscriptBox["p", "1"], "\[CenterDot]", 
     SubscriptBox["v", "1"]}], " ", 
    RowBox[{"(", 
     RowBox[{
      RowBox[{
       SubscriptBox["p", "1"], "\[CenterDot]", 
       SubscriptBox["v", "1"]}], "+", 
      RowBox[{
       SubscriptBox["p", "3"], "\[CenterDot]", 
       SubscriptBox["v", "1"]}]}], ")"}]}]], "+", 
  FractionBox[
   RowBox[{
    RowBox[{
     SubscriptBox["p", "2"], "\[CenterDot]", 
     SubscriptBox["F", "3"], "\[CenterDot]", 
     SubscriptBox["S", "0"], "\[CenterDot]", 
     SubscriptBox["p", "3"]}], " ", 
    RowBox[{
     SubscriptBox["v", "1"], "\[CenterDot]", 
     SubscriptBox["F", "1"], "\[CenterDot]", 
     SubscriptBox["F", "2"], "\[CenterDot]", 
     SubscriptBox["v", "1"]}]}], 
   RowBox[{
    RowBox[{
     SubscriptBox["p", "1"], "\[CenterDot]", 
     SubscriptBox["v", "1"]}], " ", 
    RowBox[{"(", 
     RowBox[{
      RowBox[{
       SubscriptBox["p", "1"], "\[CenterDot]", 
       SubscriptBox["v", "1"]}], "+", 
      RowBox[{
       SubscriptBox["p", "2"], "\[CenterDot]", 
       SubscriptBox["v", "1"]}]}], ")"}]}]], "+", 
  FractionBox[
   RowBox[{
    RowBox[{
     SubscriptBox["p", "1"], "\[CenterDot]", 
     SubscriptBox["F", "2"], "\[CenterDot]", 
     SubscriptBox["S", "0"], "\[CenterDot]", 
     SubscriptBox["p", "2"]}], " ", 
    RowBox[{
     SubscriptBox["v", "1"], "\[CenterDot]", 
     SubscriptBox["F", "1"], "\[CenterDot]", 
     SubscriptBox["F", "3"], "\[CenterDot]", 
     SubscriptBox["v", "1"]}]}], 
   RowBox[{
    RowBox[{
     SubscriptBox["p", "1"], "\[CenterDot]", 
     SubscriptBox["v", "1"]}], " ", 
    RowBox[{"(", 
     RowBox[{
      RowBox[{
       SubscriptBox["p", "1"], "\[CenterDot]", 
       SubscriptBox["v", "1"]}], "+", 
      RowBox[{
       SubscriptBox["p", "2"], "\[CenterDot]", 
       SubscriptBox["v", "1"]}]}], ")"}]}]], "+", 
  FractionBox[
   RowBox[{
    RowBox[{
     SubscriptBox["p", "1"], "\[CenterDot]", 
     SubscriptBox["F", "2"], "\[CenterDot]", 
     SubscriptBox["S", "0"], "\[CenterDot]", 
     SubscriptBox["p", "2"]}], " ", 
    RowBox[{
     SubscriptBox["v", "1"], "\[CenterDot]", 
     SubscriptBox["F", "1"], "\[CenterDot]", 
     SubscriptBox["F", "3"], "\[CenterDot]", 
     SubscriptBox["v", "1"]}]}], 
   RowBox[{
    RowBox[{
     SubscriptBox["p", "1"], "\[CenterDot]", 
     SubscriptBox["v", "1"]}], " ", 
    RowBox[{"(", 
     RowBox[{
      RowBox[{
       SubscriptBox["p", "1"], "\[CenterDot]", 
       SubscriptBox["v", "1"]}], "+", 
      RowBox[{
       SubscriptBox["p", "3"], "\[CenterDot]", 
       SubscriptBox["v", "1"]}]}], ")"}]}]], "-", 
  FractionBox[
   RowBox[{
    RowBox[{
     SubscriptBox["p", "1"], "\[CenterDot]", 
     SubscriptBox["F", "2"], "\[CenterDot]", 
     SubscriptBox["S", "0"], "\[CenterDot]", 
     SubscriptBox["p", "3"]}], " ", 
    RowBox[{
     SubscriptBox["v", "1"], "\[CenterDot]", 
     SubscriptBox["F", "1"], "\[CenterDot]", 
     SubscriptBox["F", "3"], "\[CenterDot]", 
     SubscriptBox["v", "1"]}]}], 
   RowBox[{
    RowBox[{
     SubscriptBox["p", "1"], "\[CenterDot]", 
     SubscriptBox["v", "1"]}], " ", 
    RowBox[{"(", 
     RowBox[{
      RowBox[{
       SubscriptBox["p", "1"], "\[CenterDot]", 
       SubscriptBox["v", "1"]}], "+", 
      RowBox[{
       SubscriptBox["p", "2"], "\[CenterDot]", 
       SubscriptBox["v", "1"]}]}], ")"}]}]], "+", 
  FractionBox[
   RowBox[{
    RowBox[{
     SubscriptBox["p", "1"], "\[CenterDot]", 
     SubscriptBox["S", "0"], "\[CenterDot]", 
     SubscriptBox["F", "1"], "\[CenterDot]", 
     SubscriptBox["p", "2"]}], " ", 
    RowBox[{
     SubscriptBox["v", "1"], "\[CenterDot]", 
     SubscriptBox["F", "2"], "\[CenterDot]", 
     SubscriptBox["F", "3"], "\[CenterDot]", 
     SubscriptBox["v", "1"]}]}], 
   RowBox[{
    RowBox[{
     SubscriptBox["p", "1"], "\[CenterDot]", 
     SubscriptBox["v", "1"]}], " ", 
    RowBox[{"(", 
     RowBox[{
      RowBox[{
       SubscriptBox["p", "1"], "\[CenterDot]", 
       SubscriptBox["v", "1"]}], "+", 
      RowBox[{
       SubscriptBox["p", "2"], "\[CenterDot]", 
       SubscriptBox["v", "1"]}]}], ")"}]}]], "-", 
  FractionBox[
   RowBox[{
    RowBox[{
     SubscriptBox["p", "2"], "\[CenterDot]", 
     SubscriptBox["F", "1"], "\[CenterDot]", 
     SubscriptBox["S", "0"], "\[CenterDot]", 
     SubscriptBox["p", "3"]}], " ", 
    RowBox[{
     SubscriptBox["v", "1"], "\[CenterDot]", 
     SubscriptBox["F", "2"], "\[CenterDot]", 
     SubscriptBox["F", "3"], "\[CenterDot]", 
     SubscriptBox["v", "1"]}]}], 
   RowBox[{
    RowBox[{
     SubscriptBox["p", "1"], "\[CenterDot]", 
     SubscriptBox["v", "1"]}], " ", 
    RowBox[{"(", 
     RowBox[{
      RowBox[{
       SubscriptBox["p", "1"], "\[CenterDot]", 
       SubscriptBox["v", "1"]}], "+", 
      RowBox[{
       SubscriptBox["p", "2"], "\[CenterDot]", 
       SubscriptBox["v", "1"]}]}], ")"}]}]], "-", 
  FractionBox[
   RowBox[{
    RowBox[{
     SubscriptBox["p", "2"], "\[CenterDot]", 
     SubscriptBox["F", "1"], "\[CenterDot]", 
     SubscriptBox["S", "0"], "\[CenterDot]", 
     SubscriptBox["p", "3"]}], " ", 
    RowBox[{
     SubscriptBox["v", "1"], "\[CenterDot]", 
     SubscriptBox["F", "2"], "\[CenterDot]", 
     SubscriptBox["F", "3"], "\[CenterDot]", 
     SubscriptBox["v", "1"]}]}], 
   RowBox[{
    RowBox[{
     SubscriptBox["p", "1"], "\[CenterDot]", 
     SubscriptBox["v", "1"]}], " ", 
    RowBox[{"(", 
     RowBox[{
      RowBox[{
       SubscriptBox["p", "1"], "\[CenterDot]", 
       SubscriptBox["v", "1"]}], "+", 
      RowBox[{
       SubscriptBox["p", "3"], "\[CenterDot]", 
       SubscriptBox["v", "1"]}]}], ")"}]}]], "+", 
  FractionBox[
   RowBox[{
    RowBox[{
     SubscriptBox["p", "1"], "\[CenterDot]", 
     SubscriptBox["F", "3"], "\[CenterDot]", 
     SubscriptBox["v", "1"]}], " ", 
    RowBox[{
     SubscriptBox["p", "1"], "\[CenterDot]", 
     SubscriptBox["F", "2"], "\[CenterDot]", 
     SubscriptBox["S", "0"], "\[CenterDot]", 
     SubscriptBox["F", "1"], "\[CenterDot]", 
     SubscriptBox["v", "1"]}]}], 
   RowBox[{
    RowBox[{
     SubscriptBox["p", "1"], "\[CenterDot]", 
     SubscriptBox["v", "1"]}], " ", 
    RowBox[{"(", 
     RowBox[{
      RowBox[{
       SubscriptBox["p", "1"], "\[CenterDot]", 
       SubscriptBox["v", "1"]}], "+", 
      RowBox[{
       SubscriptBox["p", "2"], "\[CenterDot]", 
       SubscriptBox["v", "1"]}]}], ")"}]}]], "+", 
  FractionBox[
   RowBox[{
    RowBox[{
     SubscriptBox["p", "2"], "\[CenterDot]", 
     SubscriptBox["F", "3"], "\[CenterDot]", 
     SubscriptBox["v", "1"]}], " ", 
    RowBox[{
     SubscriptBox["p", "1"], "\[CenterDot]", 
     SubscriptBox["F", "2"], "\[CenterDot]", 
     SubscriptBox["S", "0"], "\[CenterDot]", 
     SubscriptBox["F", "1"], "\[CenterDot]", 
     SubscriptBox["v", "1"]}]}], 
   RowBox[{
    RowBox[{
     SubscriptBox["p", "1"], "\[CenterDot]", 
     SubscriptBox["v", "1"]}], " ", 
    RowBox[{"(", 
     RowBox[{
      RowBox[{
       SubscriptBox["p", "1"], "\[CenterDot]", 
       SubscriptBox["v", "1"]}], "+", 
      RowBox[{
       SubscriptBox["p", "2"], "\[CenterDot]", 
       SubscriptBox["v", "1"]}]}], ")"}]}]], "-", 
  FractionBox[
   RowBox[{
    RowBox[{
     SubscriptBox["p", "3"], "\[CenterDot]", 
     SubscriptBox["F", "1"], "\[CenterDot]", 
     SubscriptBox["v", "1"]}], " ", 
    RowBox[{
     SubscriptBox["p", "1"], "\[CenterDot]", 
     SubscriptBox["F", "2"], "\[CenterDot]", 
     SubscriptBox["S", "0"], "\[CenterDot]", 
     SubscriptBox["F", "3"], "\[CenterDot]", 
     SubscriptBox["v", "1"]}]}], 
   RowBox[{
    RowBox[{
     SubscriptBox["p", "1"], "\[CenterDot]", 
     SubscriptBox["v", "1"]}], " ", 
    RowBox[{"(", 
     RowBox[{
      RowBox[{
       SubscriptBox["p", "1"], "\[CenterDot]", 
       SubscriptBox["v", "1"]}], "+", 
      RowBox[{
       SubscriptBox["p", "2"], "\[CenterDot]", 
       SubscriptBox["v", "1"]}]}], ")"}]}]], "+", 
  FractionBox[
   RowBox[{
    RowBox[{
     SubscriptBox["p", "1"], "\[CenterDot]", 
     SubscriptBox["F", "2"], "\[CenterDot]", 
     SubscriptBox["v", "1"]}], " ", 
    RowBox[{
     SubscriptBox["p", "1"], "\[CenterDot]", 
     SubscriptBox["F", "3"], "\[CenterDot]", 
     SubscriptBox["S", "0"], "\[CenterDot]", 
     SubscriptBox["F", "1"], "\[CenterDot]", 
     SubscriptBox["v", "1"]}]}], 
   RowBox[{
    RowBox[{
     SubscriptBox["p", "1"], "\[CenterDot]", 
     SubscriptBox["v", "1"]}], " ", 
    RowBox[{"(", 
     RowBox[{
      RowBox[{
       SubscriptBox["p", "1"], "\[CenterDot]", 
       SubscriptBox["v", "1"]}], "+", 
      RowBox[{
       SubscriptBox["p", "3"], "\[CenterDot]", 
       SubscriptBox["v", "1"]}]}], ")"}]}]], "-", 
  FractionBox[
   RowBox[{
    RowBox[{
     SubscriptBox["p", "2"], "\[CenterDot]", 
     SubscriptBox["F", "1"], "\[CenterDot]", 
     SubscriptBox["v", "1"]}], " ", 
    RowBox[{
     SubscriptBox["p", "1"], "\[CenterDot]", 
     SubscriptBox["F", "3"], "\[CenterDot]", 
     SubscriptBox["S", "0"], "\[CenterDot]", 
     SubscriptBox["F", "2"], "\[CenterDot]", 
     SubscriptBox["v", "1"]}]}], 
   RowBox[{
    RowBox[{
     SubscriptBox["p", "1"], "\[CenterDot]", 
     SubscriptBox["v", "1"]}], " ", 
    RowBox[{"(", 
     RowBox[{
      RowBox[{
       SubscriptBox["p", "1"], "\[CenterDot]", 
       SubscriptBox["v", "1"]}], "+", 
      RowBox[{
       SubscriptBox["p", "3"], "\[CenterDot]", 
       SubscriptBox["v", "1"]}]}], ")"}]}]], "-", 
  FractionBox[
   RowBox[{
    RowBox[{
     SubscriptBox["p", "1"], "\[CenterDot]", 
     SubscriptBox["F", "3"], "\[CenterDot]", 
     SubscriptBox["v", "1"]}], " ", 
    RowBox[{
     SubscriptBox["p", "1"], "\[CenterDot]", 
     SubscriptBox["S", "0"], "\[CenterDot]", 
     SubscriptBox["F", "1"], "\[CenterDot]", 
     SubscriptBox["F", "2"], "\[CenterDot]", 
     SubscriptBox["v", "1"]}]}], 
   RowBox[{
    RowBox[{
     SubscriptBox["p", "1"], "\[CenterDot]", 
     SubscriptBox["v", "1"]}], " ", 
    RowBox[{"(", 
     RowBox[{
      RowBox[{
       SubscriptBox["p", "1"], "\[CenterDot]", 
       SubscriptBox["v", "1"]}], "+", 
      RowBox[{
       SubscriptBox["p", "2"], "\[CenterDot]", 
       SubscriptBox["v", "1"]}]}], ")"}]}]], "-", 
  FractionBox[
   RowBox[{
    RowBox[{
     SubscriptBox["p", "1"], "\[CenterDot]", 
     SubscriptBox["F", "3"], "\[CenterDot]", 
     SubscriptBox["v", "1"]}], " ", 
    RowBox[{
     SubscriptBox["p", "1"], "\[CenterDot]", 
     SubscriptBox["S", "0"], "\[CenterDot]", 
     SubscriptBox["F", "1"], "\[CenterDot]", 
     SubscriptBox["F", "2"], "\[CenterDot]", 
     SubscriptBox["v", "1"]}]}], 
   RowBox[{
    RowBox[{
     SubscriptBox["p", "1"], "\[CenterDot]", 
     SubscriptBox["v", "1"]}], " ", 
    RowBox[{"(", 
     RowBox[{
      RowBox[{
       SubscriptBox["p", "1"], "\[CenterDot]", 
       SubscriptBox["v", "1"]}], "+", 
      RowBox[{
       SubscriptBox["p", "3"], "\[CenterDot]", 
       SubscriptBox["v", "1"]}]}], ")"}]}]], "-", 
  FractionBox[
   RowBox[{
    RowBox[{
     SubscriptBox["p", "1"], "\[CenterDot]", 
     SubscriptBox["F", "3"], "\[CenterDot]", 
     SubscriptBox["v", "1"]}], " ", 
    RowBox[{
     SubscriptBox["p", "1"], "\[CenterDot]", 
     SubscriptBox["S", "0"], "\[CenterDot]", 
     SubscriptBox["F", "2"], "\[CenterDot]", 
     SubscriptBox["F", "1"], "\[CenterDot]", 
     SubscriptBox["v", "1"]}]}], 
   RowBox[{
    RowBox[{
     SubscriptBox["p", "1"], "\[CenterDot]", 
     SubscriptBox["v", "1"]}], " ", 
    RowBox[{"(", 
     RowBox[{
      RowBox[{
       SubscriptBox["p", "1"], "\[CenterDot]", 
       SubscriptBox["v", "1"]}], "+", 
      RowBox[{
       SubscriptBox["p", "2"], "\[CenterDot]", 
       SubscriptBox["v", "1"]}]}], ")"}]}]], "-", 
  FractionBox[
   RowBox[{
    RowBox[{
     SubscriptBox["p", "2"], "\[CenterDot]", 
     SubscriptBox["F", "3"], "\[CenterDot]", 
     SubscriptBox["v", "1"]}], " ", 
    RowBox[{
     SubscriptBox["p", "1"], "\[CenterDot]", 
     SubscriptBox["S", "0"], "\[CenterDot]", 
     SubscriptBox["F", "2"], "\[CenterDot]", 
     SubscriptBox["F", "1"], "\[CenterDot]", 
     SubscriptBox["v", "1"]}]}], 
   RowBox[{
    RowBox[{
     SubscriptBox["p", "1"], "\[CenterDot]", 
     SubscriptBox["v", "1"]}], " ", 
    RowBox[{"(", 
     RowBox[{
      RowBox[{
       SubscriptBox["p", "1"], "\[CenterDot]", 
       SubscriptBox["v", "1"]}], "+", 
      RowBox[{
       SubscriptBox["p", "2"], "\[CenterDot]", 
       SubscriptBox["v", "1"]}]}], ")"}]}]], "-", 
  FractionBox[
   RowBox[{
    RowBox[{
     SubscriptBox["p", "1"], "\[CenterDot]", 
     SubscriptBox["F", "2"], "\[CenterDot]", 
     SubscriptBox["v", "1"]}], " ", 
    RowBox[{
     SubscriptBox["p", "1"], "\[CenterDot]", 
     SubscriptBox["S", "0"], "\[CenterDot]", 
     SubscriptBox["F", "3"], "\[CenterDot]", 
     SubscriptBox["F", "1"], "\[CenterDot]", 
     SubscriptBox["v", "1"]}]}], 
   RowBox[{
    RowBox[{
     SubscriptBox["p", "1"], "\[CenterDot]", 
     SubscriptBox["v", "1"]}], " ", 
    RowBox[{"(", 
     RowBox[{
      RowBox[{
       SubscriptBox["p", "1"], "\[CenterDot]", 
       SubscriptBox["v", "1"]}], "+", 
      RowBox[{
       SubscriptBox["p", "3"], "\[CenterDot]", 
       SubscriptBox["v", "1"]}]}], ")"}]}]], "-", 
  FractionBox[
   RowBox[{
    RowBox[{
     SubscriptBox["p", "3"], "\[CenterDot]", 
     SubscriptBox["F", "2"], "\[CenterDot]", 
     SubscriptBox["v", "1"]}], " ", 
    RowBox[{
     SubscriptBox["p", "2"], "\[CenterDot]", 
     SubscriptBox["F", "1"], "\[CenterDot]", 
     SubscriptBox["S", "0"], "\[CenterDot]", 
     SubscriptBox["F", "3"], "\[CenterDot]", 
     SubscriptBox["v", "1"]}]}], 
   RowBox[{
    RowBox[{
     SubscriptBox["p", "1"], "\[CenterDot]", 
     SubscriptBox["v", "1"]}], " ", 
    RowBox[{"(", 
     RowBox[{
      RowBox[{
       SubscriptBox["p", "1"], "\[CenterDot]", 
       SubscriptBox["v", "1"]}], "+", 
      RowBox[{
       SubscriptBox["p", "2"], "\[CenterDot]", 
       SubscriptBox["v", "1"]}]}], ")"}]}]], "-", 
  FractionBox[
   RowBox[{
    RowBox[{
     SubscriptBox["p", "3"], "\[CenterDot]", 
     SubscriptBox["F", "2"], "\[CenterDot]", 
     SubscriptBox["v", "1"]}], " ", 
    RowBox[{
     SubscriptBox["p", "2"], "\[CenterDot]", 
     SubscriptBox["F", "1"], "\[CenterDot]", 
     SubscriptBox["S", "0"], "\[CenterDot]", 
     SubscriptBox["F", "3"], "\[CenterDot]", 
     SubscriptBox["v", "1"]}]}], 
   RowBox[{
    RowBox[{
     SubscriptBox["p", "1"], "\[CenterDot]", 
     SubscriptBox["v", "1"]}], " ", 
    RowBox[{"(", 
     RowBox[{
      RowBox[{
       SubscriptBox["p", "1"], "\[CenterDot]", 
       SubscriptBox["v", "1"]}], "+", 
      RowBox[{
       SubscriptBox["p", "3"], "\[CenterDot]", 
       SubscriptBox["v", "1"]}]}], ")"}]}]], "+", 
  FractionBox[
   RowBox[{
    RowBox[{
     SubscriptBox["p", "1"], "\[CenterDot]", 
     SubscriptBox["F", "2"], "\[CenterDot]", 
     SubscriptBox["v", "1"]}], " ", 
    RowBox[{
     SubscriptBox["p", "2"], "\[CenterDot]", 
     SubscriptBox["F", "3"], "\[CenterDot]", 
     SubscriptBox["S", "0"], "\[CenterDot]", 
     SubscriptBox["F", "1"], "\[CenterDot]", 
     SubscriptBox["v", "1"]}]}], 
   RowBox[{
    RowBox[{
     SubscriptBox["p", "1"], "\[CenterDot]", 
     SubscriptBox["v", "1"]}], " ", 
    RowBox[{"(", 
     RowBox[{
      RowBox[{
       SubscriptBox["p", "1"], "\[CenterDot]", 
       SubscriptBox["v", "1"]}], "+", 
      RowBox[{
       SubscriptBox["p", "3"], "\[CenterDot]", 
       SubscriptBox["v", "1"]}]}], ")"}]}]], "-", 
  FractionBox[
   RowBox[{
    RowBox[{
     SubscriptBox["p", "2"], "\[CenterDot]", 
     SubscriptBox["F", "1"], "\[CenterDot]", 
     SubscriptBox["v", "1"]}], " ", 
    RowBox[{
     SubscriptBox["p", "2"], "\[CenterDot]", 
     SubscriptBox["F", "3"], "\[CenterDot]", 
     SubscriptBox["S", "0"], "\[CenterDot]", 
     SubscriptBox["F", "2"], "\[CenterDot]", 
     SubscriptBox["v", "1"]}]}], 
   RowBox[{
    RowBox[{
     SubscriptBox["p", "1"], "\[CenterDot]", 
     SubscriptBox["v", "1"]}], " ", 
    RowBox[{"(", 
     RowBox[{
      RowBox[{
       SubscriptBox["p", "1"], "\[CenterDot]", 
       SubscriptBox["v", "1"]}], "+", 
      RowBox[{
       SubscriptBox["p", "3"], "\[CenterDot]", 
       SubscriptBox["v", "1"]}]}], ")"}]}]], "-", 
  FractionBox[
   RowBox[{
    RowBox[{
     SubscriptBox["p", "2"], "\[CenterDot]", 
     SubscriptBox["F", "3"], "\[CenterDot]", 
     SubscriptBox["v", "1"]}], " ", 
    RowBox[{
     SubscriptBox["p", "2"], "\[CenterDot]", 
     SubscriptBox["S", "0"], "\[CenterDot]", 
     SubscriptBox["F", "2"], "\[CenterDot]", 
     SubscriptBox["F", "1"], "\[CenterDot]", 
     SubscriptBox["v", "1"]}]}], 
   RowBox[{
    RowBox[{
     SubscriptBox["p", "1"], "\[CenterDot]", 
     SubscriptBox["v", "1"]}], " ", 
    RowBox[{"(", 
     RowBox[{
      RowBox[{
       SubscriptBox["p", "1"], "\[CenterDot]", 
       SubscriptBox["v", "1"]}], "+", 
      RowBox[{
       SubscriptBox["p", "2"], "\[CenterDot]", 
       SubscriptBox["v", "1"]}]}], ")"}]}]], "+", 
  FractionBox[
   RowBox[{
    RowBox[{
     SubscriptBox["p", "2"], "\[CenterDot]", 
     SubscriptBox["F", "1"], "\[CenterDot]", 
     SubscriptBox["v", "1"]}], " ", 
    RowBox[{
     SubscriptBox["p", "2"], "\[CenterDot]", 
     SubscriptBox["S", "0"], "\[CenterDot]", 
     SubscriptBox["F", "3"], "\[CenterDot]", 
     SubscriptBox["F", "2"], "\[CenterDot]", 
     SubscriptBox["v", "1"]}]}], 
   RowBox[{
    RowBox[{
     SubscriptBox["p", "1"], "\[CenterDot]", 
     SubscriptBox["v", "1"]}], " ", 
    RowBox[{"(", 
     RowBox[{
      RowBox[{
       SubscriptBox["p", "1"], "\[CenterDot]", 
       SubscriptBox["v", "1"]}], "+", 
      RowBox[{
       SubscriptBox["p", "3"], "\[CenterDot]", 
       SubscriptBox["v", "1"]}]}], ")"}]}]]}]], "Output",
 CellChangeTimes->{
  3.878096067467098*^9, {3.878096905251871*^9, 3.8780969362442007`*^9}, {
   3.878097382044546*^9, 3.878097396682747*^9}, 3.878106693169626*^9, 
   3.878106740910451*^9, {3.8781107757401876`*^9, 3.878110801826302*^9}, 
   3.8781112215541353`*^9},
 CellLabel->
  "Out[1887]=",ExpressionUUID->"59158364-85a5-45ed-ac3a-29466140d077"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"%", "//", "Length"}]], "Input",
 CellChangeTimes->{{3.878106750660317*^9, 3.8781067521687117`*^9}},
 CellLabel->
  "In[1687]:=",ExpressionUUID->"8082d519-25b1-4d3a-a963-ae219534db5e"],

Cell[BoxData["34"], "Output",
 CellChangeTimes->{3.878106752572728*^9},
 CellLabel->
  "Out[1687]=",ExpressionUUID->"e59832b0-530f-4138-b62f-603475a7907f"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{
     RowBox[{"ansatzIdp", "/.", "sols"}], "/.", "solsvp1"}], "/.", 
    "solsvp2"}], "//", 
   RowBox[{
    RowBox[{"Cases", "[", 
     RowBox[{"#", ",", 
      RowBox[{"c", "[", "__", "]"}], ",", 
      RowBox[{"{", 
       RowBox[{"0", ",", "\[Infinity]"}], "}"}]}], "]"}], "&"}]}], "//", 
  "Union"}], "\[IndentingNewLine]", 
 RowBox[{"%", "//", "Length"}]}], "Input",
 CellChangeTimes->{{3.878097740252308*^9, 3.8780977941772013`*^9}, 
   3.878110841816125*^9, 3.8781112094287033`*^9},
 CellLabel->
  "In[1884]:=",ExpressionUUID->"30557a72-199e-4bb7-9d19-d769f8477edf"],

Cell[BoxData[
 RowBox[{"{", "}"}]], "Output",
 CellChangeTimes->{
  3.87809706529457*^9, {3.878097742428525*^9, 3.878097794716721*^9}, 
   3.8781067030156937`*^9, {3.878110832558032*^9, 3.878110842386078*^9}, 
   3.878111209983122*^9},
 CellLabel->
  "Out[1884]=",ExpressionUUID->"414c7349-4c42-4123-8b73-5d6c8b593f9e"],

Cell[BoxData["0"], "Output",
 CellChangeTimes->{
  3.87809706529457*^9, {3.878097742428525*^9, 3.878097794716721*^9}, 
   3.8781067030156937`*^9, {3.878110832558032*^9, 3.878110842386078*^9}, 
   3.878111209986083*^9},
 CellLabel->
  "Out[1885]=",ExpressionUUID->"e538ff4d-9e27-443d-b0c4-2ed588f3df47"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{
     RowBox[{
      RowBox[{"numAnsatz", "/.", "sols"}], "/.", "solsvp1"}], "/.", 
     "solsvp2"}], "/.", 
    RowBox[{
     RowBox[{"c", "[", "__", "]"}], ":>", "0"}]}], "/.", "nicevs"}], "//.", 
  "nice"}]], "Input",
 CellChangeTimes->{{3.878096992646886*^9, 3.8780970253597383`*^9}, {
  3.878097865895237*^9, 3.878097895808736*^9}},
 CellLabel->
  "In[1576]:=",ExpressionUUID->"4f3f7d32-e04d-4c99-9f63-a96e14c7272f"],

Cell[BoxData[
 RowBox[{
  FractionBox[
   RowBox[{
    RowBox[{"v", "\[CenterDot]", 
     SubscriptBox["F", "1"], "\[CenterDot]", 
     SubscriptBox["F", "3"], "\[CenterDot]", "v"}], " ", 
    RowBox[{
     SubscriptBox["p", "1"], "\[CenterDot]", 
     SubscriptBox["F", "2"], "\[CenterDot]", "S", "\[CenterDot]", 
     SubscriptBox["p", "2"]}]}], 
   RowBox[{
    RowBox[{"v", "\[CenterDot]", 
     SubscriptBox["p", "1"]}], " ", 
    RowBox[{"(", 
     RowBox[{
      RowBox[{"v", "\[CenterDot]", 
       SubscriptBox["p", "1"]}], "+", 
      RowBox[{"v", "\[CenterDot]", 
       SubscriptBox["p", "2"]}]}], ")"}]}]], "+", 
  FractionBox[
   RowBox[{
    RowBox[{"v", "\[CenterDot]", 
     SubscriptBox["F", "1"], "\[CenterDot]", 
     SubscriptBox["F", "3"], "\[CenterDot]", "v"}], " ", 
    RowBox[{
     SubscriptBox["p", "1"], "\[CenterDot]", 
     SubscriptBox["F", "2"], "\[CenterDot]", "S", "\[CenterDot]", 
     SubscriptBox["p", "2"]}]}], 
   RowBox[{
    RowBox[{"v", "\[CenterDot]", 
     SubscriptBox["p", "1"]}], " ", 
    RowBox[{"(", 
     RowBox[{
      RowBox[{"v", "\[CenterDot]", 
       SubscriptBox["p", "1"]}], "+", 
      RowBox[{"v", "\[CenterDot]", 
       SubscriptBox["p", "3"]}]}], ")"}]}]], "+", 
  FractionBox[
   RowBox[{
    RowBox[{"v", "\[CenterDot]", 
     SubscriptBox["F", "1"], "\[CenterDot]", 
     SubscriptBox["F", "2"], "\[CenterDot]", "v"}], " ", 
    RowBox[{
     SubscriptBox["p", "1"], "\[CenterDot]", 
     SubscriptBox["F", "3"], "\[CenterDot]", "S", "\[CenterDot]", 
     SubscriptBox["p", "3"]}]}], 
   RowBox[{
    RowBox[{"v", "\[CenterDot]", 
     SubscriptBox["p", "1"]}], " ", 
    RowBox[{"(", 
     RowBox[{
      RowBox[{"v", "\[CenterDot]", 
       SubscriptBox["p", "1"]}], "+", 
      RowBox[{"v", "\[CenterDot]", 
       SubscriptBox["p", "2"]}]}], ")"}]}]], "+", 
  FractionBox[
   RowBox[{
    RowBox[{"v", "\[CenterDot]", 
     SubscriptBox["F", "1"], "\[CenterDot]", 
     SubscriptBox["F", "2"], "\[CenterDot]", "v"}], " ", 
    RowBox[{
     SubscriptBox["p", "1"], "\[CenterDot]", 
     SubscriptBox["F", "3"], "\[CenterDot]", "S", "\[CenterDot]", 
     SubscriptBox["p", "3"]}]}], 
   RowBox[{
    RowBox[{"v", "\[CenterDot]", 
     SubscriptBox["p", "1"]}], " ", 
    RowBox[{"(", 
     RowBox[{
      RowBox[{"v", "\[CenterDot]", 
       SubscriptBox["p", "1"]}], "+", 
      RowBox[{"v", "\[CenterDot]", 
       SubscriptBox["p", "3"]}]}], ")"}]}]], "+", 
  FractionBox[
   RowBox[{
    RowBox[{
     SubscriptBox["p", "1"], "\[CenterDot]", "S", "\[CenterDot]", 
     SubscriptBox["F", "2"], "\[CenterDot]", "v"}], " ", 
    RowBox[{
     SubscriptBox["p", "2"], "\[CenterDot]", 
     SubscriptBox["F", "1"], "\[CenterDot]", 
     SubscriptBox["F", "3"], "\[CenterDot]", "v"}]}], 
   RowBox[{
    RowBox[{"v", "\[CenterDot]", 
     SubscriptBox["p", "1"]}], " ", 
    RowBox[{"(", 
     RowBox[{
      RowBox[{"v", "\[CenterDot]", 
       SubscriptBox["p", "1"]}], "+", 
      RowBox[{"v", "\[CenterDot]", 
       SubscriptBox["p", "2"]}]}], ")"}]}]], "+", 
  FractionBox[
   RowBox[{
    RowBox[{"v", "\[CenterDot]", 
     SubscriptBox["F", "1"], "\[CenterDot]", 
     SubscriptBox["F", "2"], "\[CenterDot]", "v"}], " ", 
    RowBox[{
     SubscriptBox["p", "2"], "\[CenterDot]", 
     SubscriptBox["F", "3"], "\[CenterDot]", "S", "\[CenterDot]", 
     SubscriptBox["p", "3"]}]}], 
   RowBox[{
    RowBox[{"v", "\[CenterDot]", 
     SubscriptBox["p", "1"]}], " ", 
    RowBox[{"(", 
     RowBox[{
      RowBox[{"v", "\[CenterDot]", 
       SubscriptBox["p", "1"]}], "+", 
      RowBox[{"v", "\[CenterDot]", 
       SubscriptBox["p", "2"]}]}], ")"}]}]], "-", 
  FractionBox[
   RowBox[{
    RowBox[{
     SubscriptBox["p", "1"], "\[CenterDot]", "S", "\[CenterDot]", 
     SubscriptBox["p", "3"]}], " ", 
    RowBox[{"v", "\[CenterDot]", 
     SubscriptBox["F", "2"], "\[CenterDot]", 
     SubscriptBox["F", "1"], "\[CenterDot]", 
     SubscriptBox["F", "3"], "\[CenterDot]", "v"}]}], 
   RowBox[{
    RowBox[{"v", "\[CenterDot]", 
     SubscriptBox["p", "1"]}], " ", 
    RowBox[{"(", 
     RowBox[{
      RowBox[{"v", "\[CenterDot]", 
       SubscriptBox["p", "1"]}], "+", 
      RowBox[{"v", "\[CenterDot]", 
       SubscriptBox["p", "3"]}]}], ")"}]}]], "-", 
  FractionBox[
   RowBox[{
    RowBox[{
     SubscriptBox["p", "1"], "\[CenterDot]", 
     SubscriptBox["F", "3"], "\[CenterDot]", "v"}], " ", 
    RowBox[{
     SubscriptBox["p", "1"], "\[CenterDot]", "S", "\[CenterDot]", 
     SubscriptBox["F", "1"], "\[CenterDot]", 
     SubscriptBox["F", "2"], "\[CenterDot]", "v"}]}], 
   RowBox[{
    RowBox[{"v", "\[CenterDot]", 
     SubscriptBox["p", "1"]}], " ", 
    RowBox[{"(", 
     RowBox[{
      RowBox[{"v", "\[CenterDot]", 
       SubscriptBox["p", "1"]}], "+", 
      RowBox[{"v", "\[CenterDot]", 
       SubscriptBox["p", "2"]}]}], ")"}]}]], "-", 
  FractionBox[
   RowBox[{
    RowBox[{
     SubscriptBox["p", "1"], "\[CenterDot]", 
     SubscriptBox["F", "3"], "\[CenterDot]", "v"}], " ", 
    RowBox[{
     SubscriptBox["p", "1"], "\[CenterDot]", "S", "\[CenterDot]", 
     SubscriptBox["F", "1"], "\[CenterDot]", 
     SubscriptBox["F", "2"], "\[CenterDot]", "v"}]}], 
   RowBox[{
    RowBox[{"v", "\[CenterDot]", 
     SubscriptBox["p", "1"]}], " ", 
    RowBox[{"(", 
     RowBox[{
      RowBox[{"v", "\[CenterDot]", 
       SubscriptBox["p", "1"]}], "+", 
      RowBox[{"v", "\[CenterDot]", 
       SubscriptBox["p", "3"]}]}], ")"}]}]], "-", 
  FractionBox[
   RowBox[{
    RowBox[{
     SubscriptBox["p", "2"], "\[CenterDot]", 
     SubscriptBox["F", "3"], "\[CenterDot]", "v"}], " ", 
    RowBox[{
     SubscriptBox["p", "1"], "\[CenterDot]", "S", "\[CenterDot]", 
     SubscriptBox["F", "1"], "\[CenterDot]", 
     SubscriptBox["F", "2"], "\[CenterDot]", "v"}]}], 
   RowBox[{
    RowBox[{"v", "\[CenterDot]", 
     SubscriptBox["p", "1"]}], " ", 
    RowBox[{"(", 
     RowBox[{
      RowBox[{"v", "\[CenterDot]", 
       SubscriptBox["p", "1"]}], "+", 
      RowBox[{"v", "\[CenterDot]", 
       SubscriptBox["p", "2"]}]}], ")"}]}]], "-", 
  FractionBox[
   RowBox[{
    RowBox[{
     SubscriptBox["p", "1"], "\[CenterDot]", 
     SubscriptBox["F", "3"], "\[CenterDot]", "v"}], " ", 
    RowBox[{
     SubscriptBox["p", "2"], "\[CenterDot]", "S", "\[CenterDot]", 
     SubscriptBox["F", "1"], "\[CenterDot]", 
     SubscriptBox["F", "2"], "\[CenterDot]", "v"}]}], 
   RowBox[{
    RowBox[{"v", "\[CenterDot]", 
     SubscriptBox["p", "1"]}], " ", 
    RowBox[{"(", 
     RowBox[{
      RowBox[{"v", "\[CenterDot]", 
       SubscriptBox["p", "1"]}], "+", 
      RowBox[{"v", "\[CenterDot]", 
       SubscriptBox["p", "2"]}]}], ")"}]}]], "-", 
  FractionBox[
   RowBox[{
    RowBox[{
     SubscriptBox["p", "2"], "\[CenterDot]", 
     SubscriptBox["F", "3"], "\[CenterDot]", "v"}], " ", 
    RowBox[{
     SubscriptBox["p", "2"], "\[CenterDot]", "S", "\[CenterDot]", 
     SubscriptBox["F", "2"], "\[CenterDot]", 
     SubscriptBox["F", "1"], "\[CenterDot]", "v"}]}], 
   RowBox[{
    RowBox[{"v", "\[CenterDot]", 
     SubscriptBox["p", "1"]}], " ", 
    RowBox[{"(", 
     RowBox[{
      RowBox[{"v", "\[CenterDot]", 
       SubscriptBox["p", "1"]}], "+", 
      RowBox[{"v", "\[CenterDot]", 
       SubscriptBox["p", "2"]}]}], ")"}]}]], "-", 
  FractionBox[
   RowBox[{
    RowBox[{
     SubscriptBox["p", "1"], "\[CenterDot]", 
     SubscriptBox["F", "3"], "\[CenterDot]", "v"}], " ", 
    RowBox[{
     SubscriptBox["p", "3"], "\[CenterDot]", "S", "\[CenterDot]", 
     SubscriptBox["F", "1"], "\[CenterDot]", 
     SubscriptBox["F", "2"], "\[CenterDot]", "v"}]}], 
   RowBox[{
    RowBox[{"v", "\[CenterDot]", 
     SubscriptBox["p", "1"]}], " ", 
    RowBox[{"(", 
     RowBox[{
      RowBox[{"v", "\[CenterDot]", 
       SubscriptBox["p", "1"]}], "+", 
      RowBox[{"v", "\[CenterDot]", 
       SubscriptBox["p", "3"]}]}], ")"}]}]], "+", 
  FractionBox[
   RowBox[{
    RowBox[{
     SubscriptBox["p", "1"], "\[CenterDot]", 
     SubscriptBox["F", "2"], "\[CenterDot]", "v"}], " ", 
    RowBox[{
     SubscriptBox["p", "3"], "\[CenterDot]", 
     SubscriptBox["F", "1"], "\[CenterDot]", "S", "\[CenterDot]", 
     SubscriptBox["F", "3"], "\[CenterDot]", "v"}]}], 
   RowBox[{
    RowBox[{"v", "\[CenterDot]", 
     SubscriptBox["p", "1"]}], " ", 
    RowBox[{"(", 
     RowBox[{
      RowBox[{"v", "\[CenterDot]", 
       SubscriptBox["p", "1"]}], "+", 
      RowBox[{"v", "\[CenterDot]", 
       SubscriptBox["p", "3"]}]}], ")"}]}]], "-", 
  FractionBox[
   RowBox[{
    RowBox[{
     SubscriptBox["p", "1"], "\[CenterDot]", 
     SubscriptBox["p", "2"]}], " ", 
    RowBox[{"v", "\[CenterDot]", 
     SubscriptBox["F", "2"], "\[CenterDot]", "S", "\[CenterDot]", 
     SubscriptBox["F", "1"], "\[CenterDot]", 
     SubscriptBox["F", "3"], "\[CenterDot]", "v"}]}], 
   RowBox[{
    RowBox[{"v", "\[CenterDot]", 
     SubscriptBox["p", "1"]}], " ", 
    RowBox[{"(", 
     RowBox[{
      RowBox[{"v", "\[CenterDot]", 
       SubscriptBox["p", "1"]}], "+", 
      RowBox[{"v", "\[CenterDot]", 
       SubscriptBox["p", "2"]}]}], ")"}]}]], "+", 
  FractionBox[
   RowBox[{
    SubscriptBox["p", "1"], "\[CenterDot]", "S", "\[CenterDot]", 
    SubscriptBox["F", "1"], "\[CenterDot]", 
    SubscriptBox["F", "2"], "\[CenterDot]", 
    SubscriptBox["F", "3"], "\[CenterDot]", "v"}], 
   RowBox[{"v", "\[CenterDot]", 
    SubscriptBox["p", "1"]}]], "-", 
  FractionBox[
   RowBox[{
    SubscriptBox["p", "1"], "\[CenterDot]", "S", "\[CenterDot]", 
    SubscriptBox["F", "2"], "\[CenterDot]", 
    SubscriptBox["F", "1"], "\[CenterDot]", 
    SubscriptBox["F", "3"], "\[CenterDot]", "v"}], 
   RowBox[{"v", "\[CenterDot]", 
    SubscriptBox["p", "1"]}]], "-", 
  FractionBox[
   RowBox[{
    SubscriptBox["p", "1"], "\[CenterDot]", "S", "\[CenterDot]", 
    SubscriptBox["F", "3"], "\[CenterDot]", 
    SubscriptBox["F", "1"], "\[CenterDot]", 
    SubscriptBox["F", "2"], "\[CenterDot]", "v"}], 
   RowBox[{"v", "\[CenterDot]", 
    SubscriptBox["p", "1"]}]], "+", 
  FractionBox[
   RowBox[{
    SubscriptBox["p", "1"], "\[CenterDot]", 
    SubscriptBox["F", "2"], "\[CenterDot]", "S", "\[CenterDot]", 
    SubscriptBox["F", "1"], "\[CenterDot]", 
    SubscriptBox["F", "3"], "\[CenterDot]", "v"}], 
   RowBox[{"v", "\[CenterDot]", 
    SubscriptBox["p", "1"]}]], "+", 
  FractionBox[
   RowBox[{
    SubscriptBox["p", "1"], "\[CenterDot]", 
    SubscriptBox["F", "3"], "\[CenterDot]", "S", "\[CenterDot]", 
    SubscriptBox["F", "1"], "\[CenterDot]", 
    SubscriptBox["F", "2"], "\[CenterDot]", "v"}], 
   RowBox[{"v", "\[CenterDot]", 
    SubscriptBox["p", "1"]}]], "+", 
  FractionBox[
   RowBox[{
    SubscriptBox["p", "2"], "\[CenterDot]", "S", "\[CenterDot]", 
    SubscriptBox["F", "1"], "\[CenterDot]", 
    SubscriptBox["F", "2"], "\[CenterDot]", 
    SubscriptBox["F", "3"], "\[CenterDot]", "v"}], 
   RowBox[{"v", "\[CenterDot]", 
    SubscriptBox["p", "1"]}]], "-", 
  FractionBox[
   RowBox[{
    RowBox[{"v", "\[CenterDot]", 
     SubscriptBox["p", "2"]}], " ", 
    RowBox[{
     SubscriptBox["p", "2"], "\[CenterDot]", "S", "\[CenterDot]", 
     SubscriptBox["F", "1"], "\[CenterDot]", 
     SubscriptBox["F", "2"], "\[CenterDot]", 
     SubscriptBox["F", "3"], "\[CenterDot]", "v"}]}], 
   RowBox[{
    RowBox[{"v", "\[CenterDot]", 
     SubscriptBox["p", "1"]}], " ", 
    RowBox[{"(", 
     RowBox[{
      RowBox[{"v", "\[CenterDot]", 
       SubscriptBox["p", "1"]}], "+", 
      RowBox[{"v", "\[CenterDot]", 
       SubscriptBox["p", "2"]}]}], ")"}]}]], "-", 
  FractionBox[
   RowBox[{
    SubscriptBox["p", "2"], "\[CenterDot]", "S", "\[CenterDot]", 
    SubscriptBox["F", "2"], "\[CenterDot]", 
    SubscriptBox["F", "1"], "\[CenterDot]", 
    SubscriptBox["F", "3"], "\[CenterDot]", "v"}], 
   RowBox[{"v", "\[CenterDot]", 
    SubscriptBox["p", "1"]}]], "+", 
  FractionBox[
   RowBox[{
    RowBox[{"v", "\[CenterDot]", 
     SubscriptBox["p", "2"]}], " ", 
    RowBox[{
     SubscriptBox["p", "2"], "\[CenterDot]", "S", "\[CenterDot]", 
     SubscriptBox["F", "2"], "\[CenterDot]", 
     SubscriptBox["F", "1"], "\[CenterDot]", 
     SubscriptBox["F", "3"], "\[CenterDot]", "v"}]}], 
   RowBox[{
    RowBox[{"v", "\[CenterDot]", 
     SubscriptBox["p", "1"]}], " ", 
    RowBox[{"(", 
     RowBox[{
      RowBox[{"v", "\[CenterDot]", 
       SubscriptBox["p", "1"]}], "+", 
      RowBox[{"v", "\[CenterDot]", 
       SubscriptBox["p", "2"]}]}], ")"}]}]], "-", 
  FractionBox[
   RowBox[{
    SubscriptBox["p", "2"], "\[CenterDot]", "S", "\[CenterDot]", 
    SubscriptBox["F", "3"], "\[CenterDot]", 
    SubscriptBox["F", "1"], "\[CenterDot]", 
    SubscriptBox["F", "2"], "\[CenterDot]", "v"}], 
   RowBox[{"v", "\[CenterDot]", 
    SubscriptBox["p", "1"]}]], "-", 
  FractionBox[
   RowBox[{
    SubscriptBox["p", "2"], "\[CenterDot]", "S", "\[CenterDot]", 
    SubscriptBox["F", "3"], "\[CenterDot]", 
    SubscriptBox["F", "2"], "\[CenterDot]", 
    SubscriptBox["F", "1"], "\[CenterDot]", "v"}], 
   RowBox[{"v", "\[CenterDot]", 
    SubscriptBox["p", "1"]}]], "-", 
  FractionBox[
   RowBox[{
    SubscriptBox["p", "2"], "\[CenterDot]", 
    SubscriptBox["F", "1"], "\[CenterDot]", "S", "\[CenterDot]", 
    SubscriptBox["F", "2"], "\[CenterDot]", 
    SubscriptBox["F", "3"], "\[CenterDot]", "v"}], 
   RowBox[{"v", "\[CenterDot]", 
    SubscriptBox["p", "1"]}]], "+", 
  FractionBox[
   RowBox[{
    RowBox[{"v", "\[CenterDot]", 
     SubscriptBox["p", "2"]}], " ", 
    RowBox[{
     SubscriptBox["p", "2"], "\[CenterDot]", 
     SubscriptBox["F", "1"], "\[CenterDot]", "S", "\[CenterDot]", 
     SubscriptBox["F", "2"], "\[CenterDot]", 
     SubscriptBox["F", "3"], "\[CenterDot]", "v"}]}], 
   RowBox[{
    RowBox[{"v", "\[CenterDot]", 
     SubscriptBox["p", "1"]}], " ", 
    RowBox[{"(", 
     RowBox[{
      RowBox[{"v", "\[CenterDot]", 
       SubscriptBox["p", "1"]}], "+", 
      RowBox[{"v", "\[CenterDot]", 
       SubscriptBox["p", "2"]}]}], ")"}]}]], "+", 
  FractionBox[
   RowBox[{
    SubscriptBox["p", "2"], "\[CenterDot]", 
    SubscriptBox["F", "1"], "\[CenterDot]", "S", "\[CenterDot]", 
    SubscriptBox["F", "3"], "\[CenterDot]", 
    SubscriptBox["F", "2"], "\[CenterDot]", "v"}], 
   RowBox[{"v", "\[CenterDot]", 
    SubscriptBox["p", "1"]}]], "-", 
  FractionBox[
   RowBox[{
    SubscriptBox["p", "2"], "\[CenterDot]", 
    SubscriptBox["F", "1"], "\[CenterDot]", 
    SubscriptBox["F", "3"], "\[CenterDot]", "S", "\[CenterDot]", 
    SubscriptBox["F", "2"], "\[CenterDot]", "v"}], 
   RowBox[{"v", "\[CenterDot]", 
    SubscriptBox["p", "1"]}]], "+", 
  FractionBox[
   RowBox[{
    SubscriptBox["p", "2"], "\[CenterDot]", 
    SubscriptBox["F", "3"], "\[CenterDot]", "S", "\[CenterDot]", 
    SubscriptBox["F", "1"], "\[CenterDot]", 
    SubscriptBox["F", "2"], "\[CenterDot]", "v"}], 
   RowBox[{"v", "\[CenterDot]", 
    SubscriptBox["p", "1"]}]], "+", 
  FractionBox[
   RowBox[{
    SubscriptBox["p", "2"], "\[CenterDot]", 
    SubscriptBox["F", "3"], "\[CenterDot]", "S", "\[CenterDot]", 
    SubscriptBox["F", "2"], "\[CenterDot]", 
    SubscriptBox["F", "1"], "\[CenterDot]", "v"}], 
   RowBox[{"v", "\[CenterDot]", 
    SubscriptBox["p", "1"]}]], "+", 
  FractionBox[
   RowBox[{
    SubscriptBox["p", "3"], "\[CenterDot]", "S", "\[CenterDot]", 
    SubscriptBox["F", "1"], "\[CenterDot]", 
    SubscriptBox["F", "2"], "\[CenterDot]", 
    SubscriptBox["F", "3"], "\[CenterDot]", "v"}], 
   RowBox[{"v", "\[CenterDot]", 
    SubscriptBox["p", "1"]}]], "-", 
  FractionBox[
   RowBox[{
    SubscriptBox["p", "3"], "\[CenterDot]", "S", "\[CenterDot]", 
    SubscriptBox["F", "2"], "\[CenterDot]", 
    SubscriptBox["F", "1"], "\[CenterDot]", 
    SubscriptBox["F", "3"], "\[CenterDot]", "v"}], 
   RowBox[{"v", "\[CenterDot]", 
    SubscriptBox["p", "1"]}]], "-", 
  FractionBox[
   RowBox[{
    SubscriptBox["p", "3"], "\[CenterDot]", "S", "\[CenterDot]", 
    SubscriptBox["F", "3"], "\[CenterDot]", 
    SubscriptBox["F", "1"], "\[CenterDot]", 
    SubscriptBox["F", "2"], "\[CenterDot]", "v"}], 
   RowBox[{"v", "\[CenterDot]", 
    SubscriptBox["p", "1"]}]], "+", 
  FractionBox[
   RowBox[{
    RowBox[{"v", "\[CenterDot]", 
     SubscriptBox["p", "3"]}], " ", 
    RowBox[{
     SubscriptBox["p", "3"], "\[CenterDot]", "S", "\[CenterDot]", 
     SubscriptBox["F", "3"], "\[CenterDot]", 
     SubscriptBox["F", "1"], "\[CenterDot]", 
     SubscriptBox["F", "2"], "\[CenterDot]", "v"}]}], 
   RowBox[{
    RowBox[{"v", "\[CenterDot]", 
     SubscriptBox["p", "1"]}], " ", 
    RowBox[{"(", 
     RowBox[{
      RowBox[{"v", "\[CenterDot]", 
       SubscriptBox["p", "1"]}], "+", 
      RowBox[{"v", "\[CenterDot]", 
       SubscriptBox["p", "3"]}]}], ")"}]}]], "-", 
  FractionBox[
   RowBox[{
    SubscriptBox["p", "3"], "\[CenterDot]", "S", "\[CenterDot]", 
    SubscriptBox["F", "3"], "\[CenterDot]", 
    SubscriptBox["F", "2"], "\[CenterDot]", 
    SubscriptBox["F", "1"], "\[CenterDot]", "v"}], 
   RowBox[{"v", "\[CenterDot]", 
    SubscriptBox["p", "1"]}]], "-", 
  FractionBox[
   RowBox[{
    SubscriptBox["p", "3"], "\[CenterDot]", 
    SubscriptBox["F", "1"], "\[CenterDot]", 
    SubscriptBox["F", "2"], "\[CenterDot]", "S", "\[CenterDot]", 
    SubscriptBox["F", "3"], "\[CenterDot]", "v"}], 
   RowBox[{"v", "\[CenterDot]", 
    SubscriptBox["p", "1"]}]], "+", 
  FractionBox[
   RowBox[{
    SubscriptBox["p", "3"], "\[CenterDot]", 
    SubscriptBox["F", "2"], "\[CenterDot]", 
    SubscriptBox["F", "1"], "\[CenterDot]", "S", "\[CenterDot]", 
    SubscriptBox["F", "3"], "\[CenterDot]", "v"}], 
   RowBox[{"v", "\[CenterDot]", 
    SubscriptBox["p", "1"]}]]}]], "Output",
 CellChangeTimes->{{3.878096994542691*^9, 3.878097026032852*^9}, {
  3.8780978736826763`*^9, 3.878097896716341*^9}},
 CellLabel->
  "Out[1576]=",ExpressionUUID->"1b500b31-934b-413d-921d-a723231a646a"]
}, Open  ]]
}, Open  ]]
}, Closed]],

Cell[CellGroupData[{

Cell["Example S \[Infinity] Five point Ansatz", "Section",
 CellChangeTimes->{{3.8783576503446693`*^9, 
  3.878357668080792*^9}},ExpressionUUID->"8953edf9-c418-417c-99bf-\
30c222761e4f"],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{
     RowBox[{"dot", "[", 
      RowBox[{
       RowBox[{"v", "[", "1", "]"}], ",", 
       RowBox[{"F", "[", "1", "]"}], ",", 
       RowBox[{"F", "[", "2", "]"}], ",", 
       RowBox[{"as", "[", "0", "]"}]}], "]"}], " ", 
     RowBox[{"dot", "[", 
      RowBox[{
       RowBox[{"p", "[", "1", "]"}], ",", 
       RowBox[{"as", "[", "0", "]"}]}], "]"}]}], " ", "+", 
    RowBox[{
     RowBox[{"dot", "[", 
      RowBox[{
       RowBox[{"v", "[", "1", "]"}], ",", 
       RowBox[{"F", "[", "2", "]"}], ",", 
       RowBox[{"as", "[", "0", "]"}]}], "]"}], " ", 
     RowBox[{"dot", "[", 
      RowBox[{
       RowBox[{"p", "[", "2", "]"}], ",", 
       RowBox[{"F", "[", "1", "]"}], ",", 
       RowBox[{"as", "[", "0", "]"}]}], "]"}]}]}], " ", "//", "expandFS"}], "//",
   "Simplify"}]], "Input",
 CellChangeTimes->{{3.8783576784371567`*^9, 3.878357754358671*^9}, {
  3.878357793005797*^9, 3.878357799163643*^9}, {3.878357940712699*^9, 
  3.878357959667639*^9}},
 CellLabel->
  "In[200]:=",ExpressionUUID->"23ce62ce-f395-4ae6-b3c2-19f13f4f2093"],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"(", 
    RowBox[{
     RowBox[{
      RowBox[{"dot", "[", 
       RowBox[{
        RowBox[{"as", "[", "0", "]"}], ",", 
        RowBox[{"\[Epsilon]", "[", "1", "]"}]}], "]"}], " ", 
      RowBox[{"dot", "[", 
       RowBox[{
        RowBox[{"p", "[", "1", "]"}], ",", 
        RowBox[{"p", "[", "2", "]"}]}], "]"}]}], "-", 
     RowBox[{
      RowBox[{"dot", "[", 
       RowBox[{
        RowBox[{"as", "[", "0", "]"}], ",", 
        RowBox[{"p", "[", "1", "]"}]}], "]"}], " ", 
      RowBox[{"dot", "[", 
       RowBox[{
        RowBox[{"p", "[", "2", "]"}], ",", 
        RowBox[{"\[Epsilon]", "[", "1", "]"}]}], "]"}]}]}], ")"}], " ", 
   RowBox[{"(", 
    RowBox[{
     RowBox[{
      RowBox[{"dot", "[", 
       RowBox[{
        RowBox[{"as", "[", "0", "]"}], ",", 
        RowBox[{"\[Epsilon]", "[", "2", "]"}]}], "]"}], " ", 
      RowBox[{"dot", "[", 
       RowBox[{
        RowBox[{"p", "[", "2", "]"}], ",", 
        RowBox[{"v", "[", "1", "]"}]}], "]"}]}], "-", 
     RowBox[{
      RowBox[{"dot", "[", 
       RowBox[{
        RowBox[{"as", "[", "0", "]"}], ",", 
        RowBox[{"p", "[", "2", "]"}]}], "]"}], " ", 
      RowBox[{"dot", "[", 
       RowBox[{
        RowBox[{"v", "[", "1", "]"}], ",", 
        RowBox[{"\[Epsilon]", "[", "2", "]"}]}], "]"}]}]}], ")"}]}], "+", 
  RowBox[{
   RowBox[{"dot", "[", 
    RowBox[{
     RowBox[{"as", "[", "0", "]"}], ",", 
     RowBox[{"p", "[", "1", "]"}]}], "]"}], " ", 
   RowBox[{"(", 
    RowBox[{
     RowBox[{
      RowBox[{"dot", "[", 
       RowBox[{
        RowBox[{"as", "[", "0", "]"}], ",", 
        RowBox[{"\[Epsilon]", "[", "2", "]"}]}], "]"}], " ", 
      RowBox[{"(", 
       RowBox[{
        RowBox[{
         RowBox[{"dot", "[", 
          RowBox[{
           RowBox[{"p", "[", "1", "]"}], ",", 
           RowBox[{"v", "[", "1", "]"}]}], "]"}], " ", 
         RowBox[{"dot", "[", 
          RowBox[{
           RowBox[{"p", "[", "2", "]"}], ",", 
           RowBox[{"\[Epsilon]", "[", "1", "]"}]}], "]"}]}], "-", 
        RowBox[{
         RowBox[{"dot", "[", 
          RowBox[{
           RowBox[{"p", "[", "1", "]"}], ",", 
           RowBox[{"p", "[", "2", "]"}]}], "]"}], " ", 
         RowBox[{"dot", "[", 
          RowBox[{
           RowBox[{"v", "[", "1", "]"}], ",", 
           RowBox[{"\[Epsilon]", "[", "1", "]"}]}], "]"}]}]}], ")"}]}], "+", 
     RowBox[{
      RowBox[{"dot", "[", 
       RowBox[{
        RowBox[{"as", "[", "0", "]"}], ",", 
        RowBox[{"p", "[", "2", "]"}]}], "]"}], " ", 
      RowBox[{"(", 
       RowBox[{
        RowBox[{
         RowBox[{"dot", "[", 
          RowBox[{
           RowBox[{"p", "[", "1", "]"}], ",", 
           RowBox[{"\[Epsilon]", "[", "2", "]"}]}], "]"}], " ", 
         RowBox[{"dot", "[", 
          RowBox[{
           RowBox[{"v", "[", "1", "]"}], ",", 
           RowBox[{"\[Epsilon]", "[", "1", "]"}]}], "]"}]}], "-", 
        RowBox[{
         RowBox[{"dot", "[", 
          RowBox[{
           RowBox[{"p", "[", "1", "]"}], ",", 
           RowBox[{"v", "[", "1", "]"}]}], "]"}], " ", 
         RowBox[{"dot", "[", 
          RowBox[{
           RowBox[{"\[Epsilon]", "[", "1", "]"}], ",", 
           RowBox[{"\[Epsilon]", "[", "2", "]"}]}], "]"}]}]}], ")"}]}]}], 
    ")"}]}]}]], "Output",
 CellChangeTimes->{
  3.878357751134429*^9, {3.8783577935389357`*^9, 3.8783577997098637`*^9}, {
   3.878357953520162*^9, 3.878357960107031*^9}},
 CellLabel->
  "Out[200]=",ExpressionUUID->"66d42665-e0c0-44c5-8ce3-4895ff5bc1cf"]
}, Open  ]]
}, Open  ]]
},
WindowSize->{1103, 795},
WindowMargins->{{Automatic, 153}, {Automatic, 0}},
PrivateNotebookOptions->{"VersionedStylesheet"->{"Default.nb"[8.] -> False}},
TaggingRules->Association["TryRealOnly" -> False],
Magnification:>1.25 Inherited,
FrontEndVersion->"12.3 for Mac OS X x86 (64-bit) (June 19, 2021)",
StyleDefinitions->FrontEnd`FileName[{"Report"}, "StandardReport.nb", 
  CharacterEncoding -> "UTF-8"],
ExpressionUUID->"b8b22cab-2f3f-4c50-b7dc-f4a33feecd7e"
]
(* End of Notebook Content *)

(* Internal cache information *)
(*CellTagsOutline
CellTagsIndex->{}
*)
(*CellTagsIndex
CellTagsIndex->{}
*)
(*NotebookFileOutline
Notebook[{
Cell[CellGroupData[{
Cell[580, 22, 161, 3, 87, "Section",ExpressionUUID->"0441e687-3271-491a-8955-dd8d0f7cb479"],
Cell[CellGroupData[{
Cell[766, 29, 209, 4, 51, "Input",ExpressionUUID->"e15a1c17-2cfb-46a2-8aa9-607b0a62e713"],
Cell[978, 35, 484, 7, 51, "Output",ExpressionUUID->"b0170e05-585c-41aa-82a9-0f68e8713514"]
}, Open  ]],
Cell[CellGroupData[{
Cell[1499, 47, 342, 6, 51, "Input",ExpressionUUID->"9e588303-12c7-48e0-b8a5-8c3c446f4c9f"],
Cell[1844, 55, 758, 16, 159, "Print",ExpressionUUID->"45d594d9-699a-4eec-a71c-17f4cbac052a"]
}, Open  ]],
Cell[CellGroupData[{
Cell[2639, 76, 161, 2, 51, "Input",ExpressionUUID->"ffda9edb-2059-4574-84d1-b1affec10b4c"],
Cell[2803, 80, 443, 10, 52, "Print",ExpressionUUID->"351d33eb-53f9-4db4-9a57-a3c5ee12c118"]
}, Open  ]],
Cell[CellGroupData[{
Cell[3283, 95, 1332, 32, 156, "Input",ExpressionUUID->"6e78fb49-dd55-4145-92f6-d81f0c875850"],
Cell[CellGroupData[{
Cell[4640, 131, 486, 8, 29, "Print",ExpressionUUID->"248b3abd-9d8b-471e-99f5-97b984ec91b0"],
Cell[5129, 141, 485, 8, 29, "Print",ExpressionUUID->"47c5ca75-1d5f-4872-801c-8666232cb148"],
Cell[5617, 151, 488, 8, 29, "Print",ExpressionUUID->"1a95d653-8044-4976-aa96-4b84628e9350"],
Cell[6108, 161, 499, 9, 29, "Print",ExpressionUUID->"6fbbe2d2-4c3b-4b9b-abce-46cc7dc00b5f"],
Cell[6610, 172, 486, 8, 29, "Print",ExpressionUUID->"802887a2-b5ab-4287-b0eb-4e59f8eff216"],
Cell[7099, 182, 488, 8, 29, "Print",ExpressionUUID->"4f6caa58-7bc6-4a52-8244-0b636a786050"],
Cell[7590, 192, 491, 9, 29, "Print",ExpressionUUID->"3cf1b7d1-a145-4a2c-b31f-eba853b291ef"],
Cell[8084, 203, 489, 8, 29, "Print",ExpressionUUID->"4bc3c7ff-b640-4d2a-8b86-ad6d69ca059b"],
Cell[8576, 213, 497, 9, 29, "Print",ExpressionUUID->"ac95acb0-e990-42ed-a3e2-ee2ac97478c1"],
Cell[9076, 224, 495, 9, 29, "Print",ExpressionUUID->"4db50724-0b86-4c89-8a30-13c68e3ca7cf"],
Cell[9574, 235, 495, 9, 29, "Print",ExpressionUUID->"943cce8f-6030-4da0-89d8-e4b7757cb2e9"],
Cell[10072, 246, 495, 9, 29, "Print",ExpressionUUID->"e56ff6b1-b254-4372-bcc1-7be2e91527aa"],
Cell[10570, 257, 497, 9, 29, "Print",ExpressionUUID->"3418ae73-4bb1-424e-9331-243d786e86f4"]
}, Open  ]]
}, Open  ]]
}, Open  ]],
Cell[CellGroupData[{
Cell[11128, 273, 157, 3, 87, "Section",ExpressionUUID->"b2a7b427-35e1-4c90-a40a-a7c43f50ca5a"],
Cell[CellGroupData[{
Cell[11310, 280, 169, 3, 42, "Subsection",ExpressionUUID->"b7909353-edfe-4489-b115-b6a172af6d7d"],
Cell[11482, 285, 482, 13, 51, "Input",ExpressionUUID->"aae90991-5bc3-401d-87f3-7f8422f12676"],
Cell[11967, 300, 1582, 47, 234, "Input",ExpressionUUID->"b0fdc6fd-2a5b-4d84-97a3-03bddc4e6893"],
Cell[13552, 349, 700, 17, 104, "Input",ExpressionUUID->"277d5114-6840-4b27-9460-eac0f86cbc2c"],
Cell[14255, 368, 852, 21, 104, "Input",ExpressionUUID->"ff95a306-8b51-46ee-8bc6-3e57f67ea494"],
Cell[15110, 391, 573, 13, 78, "Input",ExpressionUUID->"a76cbf43-accd-494d-bf74-aaf9211a3950"],
Cell[15686, 406, 567, 17, 51, "Input",ExpressionUUID->"2787e42e-631b-4f49-a71c-b7b0e075493a"],
Cell[16256, 425, 1661, 50, 156, "Input",ExpressionUUID->"b4037ea5-93ff-4f7e-a16c-2ab7e7c858e0"],
Cell[17920, 477, 4831, 116, 182, "Input",ExpressionUUID->"6d280527-7a65-48d0-a19d-73ee85d09955"],
Cell[22754, 595, 4528, 135, 390, "Input",ExpressionUUID->"0e2780f7-f3c5-41e4-a82a-2661c1254c1e"],
Cell[27285, 732, 1173, 30, 104, "Input",ExpressionUUID->"c9dd0306-42c7-4192-b891-8337c9f7440c"],
Cell[28461, 764, 2351, 72, 182, "Input",ExpressionUUID->"766abd2e-1994-4be7-9ee6-2a6d0f82c59e"],
Cell[30815, 838, 1197, 35, 156, "Input",ExpressionUUID->"f32e72bc-d9f0-4994-aff5-11032f993f2a"]
}, Open  ]],
Cell[CellGroupData[{
Cell[32049, 878, 164, 3, 42, "Subsection",ExpressionUUID->"19c23075-0448-439e-b990-e9e57cef0c14"],
Cell[32216, 883, 7163, 196, 494, "Input",ExpressionUUID->"41d8c094-84c5-4ee9-aee4-8c40ac1ee5f3"],
Cell[39382, 1081, 1749, 52, 156, "Input",ExpressionUUID->"078d2120-47c9-45fd-a915-fc4e3e8e373e"],
Cell[41134, 1135, 4531, 124, 416, "Input",ExpressionUUID->"a61f9555-0be9-40b9-bdae-1cc5f6ebe29e"],
Cell[45668, 1261, 3427, 92, 312, "Input",ExpressionUUID->"5a749aec-1210-4ad6-84cd-506b5a9ebae9"],
Cell[49098, 1355, 2468, 71, 312, "Input",ExpressionUUID->"2ec6dc3b-1485-4a6a-943c-7859b690610e"],
Cell[51569, 1428, 1537, 43, 182, "Input",ExpressionUUID->"d9319593-268b-4300-9501-a5620af6c839"],
Cell[53109, 1473, 1310, 30, 104, "Input",ExpressionUUID->"c4708be7-ddac-4167-915b-d46842db745f"],
Cell[54422, 1505, 3076, 88, 435, "Input",ExpressionUUID->"da1678c0-82b0-4300-bfbc-d1f6eb039ac5"],
Cell[57501, 1595, 1227, 32, 104, "Input",ExpressionUUID->"bb9d1e39-1bb7-41c6-b251-dcebffea133c"],
Cell[58731, 1629, 611, 16, 78, "Input",ExpressionUUID->"8c7dc4b2-591e-4db4-b91a-1285414fe61d"],
Cell[59345, 1647, 2225, 56, 364, "Input",ExpressionUUID->"571ee68b-1968-468a-8457-68ec7313b97e"],
Cell[61573, 1705, 13005, 339, 728, "Input",ExpressionUUID->"f6470b2b-1430-493f-b954-d80193a6e8b3"],
Cell[74581, 2046, 3197, 86, 299, "Input",ExpressionUUID->"311cb0de-bc70-4e6d-8af5-84e5a3960e94"],
Cell[77781, 2134, 2898, 81, 273, "Input",ExpressionUUID->"9ba83756-e9e0-4b81-b452-76fe18ad8619"],
Cell[80682, 2217, 7461, 145, 351, "Input",ExpressionUUID->"acba7d38-218d-4ab3-8d17-064d5bb3ae6c"]
}, Open  ]],
Cell[CellGroupData[{
Cell[88180, 2367, 170, 3, 42, "Subsection",ExpressionUUID->"ca53f43b-0c6f-4f8f-9ad8-87cfea3279c2"],
Cell[88353, 2372, 2841, 87, 208, "Input",ExpressionUUID->"f8177a59-b548-4f5d-a062-3e46a97c4ed8"],
Cell[91197, 2461, 14241, 396, 1404, "Input",ExpressionUUID->"99fc1734-0a78-4f56-9085-9e1deef01c83"]
}, Closed]],
Cell[CellGroupData[{
Cell[105475, 2862, 173, 3, 41, "Subsection",ExpressionUUID->"a0b21b7b-22d9-43b7-b714-f04ca4b20753"],
Cell[105651, 2867, 2008, 55, 182, "Input",ExpressionUUID->"90a8135e-812a-4d57-9d3d-6bdd9005cd47"],
Cell[107662, 2924, 1341, 35, 182, "Input",ExpressionUUID->"cc21b2cf-79d9-4be8-990b-72e461cf7fe8"]
}, Open  ]]
}, Closed]],
Cell[CellGroupData[{
Cell[109052, 2965, 216, 4, 68, "Section",ExpressionUUID->"920e92b2-f483-4633-8572-95f7ad2029ee"],
Cell[109271, 2971, 6808, 195, 624, "Input",ExpressionUUID->"a59468cd-400d-4953-be9d-1224995358e2"],
Cell[116082, 3168, 1460, 32, 104, "Input",ExpressionUUID->"b391ede9-be00-4b65-b0fd-aa1f912d39f2"],
Cell[117545, 3202, 1266, 37, 156, "Input",ExpressionUUID->"55f9f031-ef59-4843-b717-d41b3d5f725a"],
Cell[118814, 3241, 2943, 67, 234, "Input",ExpressionUUID->"c5bb3695-411a-4d6d-9a74-02514b7878ff"],
Cell[121760, 3310, 1165, 32, 194, "Input",ExpressionUUID->"7e5a8741-43ac-4327-aa5f-6dbd2093223d"],
Cell[122928, 3344, 4895, 132, 461, "Input",ExpressionUUID->"38b08510-db19-43f8-a58a-03d08123cfc5"],
Cell[127826, 3478, 2991, 76, 278, "Input",ExpressionUUID->"9e85ef89-ef79-46cb-be32-c43025585f9e"],
Cell[130820, 3556, 631, 15, 104, "Input",ExpressionUUID->"e6c49810-516a-46b3-91d2-9f6cc77989d2"],
Cell[131454, 3573, 1905, 49, 208, "Input",ExpressionUUID->"acf5035f-ca44-45ac-b48d-85cb79e62689"],
Cell[133362, 3624, 2650, 64, 208, "Input",ExpressionUUID->"f096a91e-a14a-422f-9dad-273215327dad"],
Cell[136015, 3690, 5954, 170, 390, "Input",ExpressionUUID->"26efa189-4ecc-4695-99da-a77c9b57d98f"]
}, Closed]],
Cell[CellGroupData[{
Cell[142006, 3865, 166, 3, 68, "Section",ExpressionUUID->"2facbcdd-6529-421e-b087-7362503df697"],
Cell[142175, 3870, 329, 7, 51, "Input",ExpressionUUID->"1ed94398-ee3d-4f3a-bf90-559c2258774b"],
Cell[142507, 3879, 7678, 217, 442, "Input",ExpressionUUID->"addf7f2a-cd5d-49f7-8f50-dd1ab1616ed6"],
Cell[150188, 4098, 4016, 115, 208, "Input",ExpressionUUID->"093ebe73-7fa6-421a-a7cb-b6566c057327"]
}, Closed]],
Cell[CellGroupData[{
Cell[154241, 4218, 261, 4, 68, "Section",ExpressionUUID->"604156b9-0508-4c7d-9a7a-b99be3f8fadc"],
Cell[CellGroupData[{
Cell[154527, 4226, 160, 3, 42, "Subsection",ExpressionUUID->"1f37adfe-a673-4b37-93f5-fd1884b57adf"],
Cell[CellGroupData[{
Cell[154712, 4233, 989, 27, 104, "Input",ExpressionUUID->"8e07d938-6c93-4c35-b475-53b3cf5a05b4"],
Cell[155704, 4262, 632, 19, 51, "Output",ExpressionUUID->"06db6142-f828-4d52-b9de-b5925cdaafcd"]
}, Open  ]],
Cell[156351, 4284, 1219, 25, 130, "Input",ExpressionUUID->"a92b9c8e-51f8-407e-8224-ece3eaae9f04"],
Cell[157573, 4311, 2816, 78, 211, "Input",ExpressionUUID->"2eb92c90-3759-413d-bc7f-1a09bf3e2c53"],
Cell[CellGroupData[{
Cell[160414, 4393, 663, 20, 78, "Input",ExpressionUUID->"74abc309-0cb3-4d4b-9a63-a72a96bc37ec"],
Cell[161080, 4415, 250, 4, 51, "Output",ExpressionUUID->"f0e1ac81-aa3e-4911-ac6c-6355c77a2708"]
}, Open  ]]
}, Open  ]],
Cell[CellGroupData[{
Cell[161379, 4425, 172, 3, 42, "Subsection",ExpressionUUID->"a99cbca3-c478-412c-a3d7-706d91371810"],
Cell[161554, 4430, 872, 21, 51, "Input",ExpressionUUID->"2f3f69f3-5124-4b81-9552-2cb53ab12d1e"],
Cell[CellGroupData[{
Cell[162451, 4455, 3473, 104, 286, "Input",ExpressionUUID->"f3ddb63b-7d8f-4997-9389-f334fbed6258"],
Cell[165927, 4561, 859, 20, 51, "Output",ExpressionUUID->"40828b73-7477-4712-8bf3-39c2327b3db2"]
}, Open  ]],
Cell[166801, 4584, 4132, 128, 336, "Input",ExpressionUUID->"4ba38add-1e90-4973-a0eb-a9f5230a3a29"],
Cell[170936, 4714, 2087, 54, 156, "Input",ExpressionUUID->"50109fa6-4aef-4b99-98a7-c5ed1149348c"],
Cell[173026, 4770, 227, 7, 51, "Input",ExpressionUUID->"d6b198be-e867-4bbb-b3d5-34b139716bfc"],
Cell[CellGroupData[{
Cell[173278, 4781, 245, 5, 51, "Input",ExpressionUUID->"cb22c795-a365-4f26-a2e3-e6ef2eb88c94"],
Cell[173526, 4788, 4045, 113, 182, "Output",ExpressionUUID->"a9d70966-3ea4-4b2c-8fe0-91e1006c6e28"]
}, Open  ]],
Cell[CellGroupData[{
Cell[177608, 4906, 186, 4, 51, "Input",ExpressionUUID->"61e32d22-3e04-4e8a-b0e1-dc5ba8c54a93"],
Cell[177797, 4912, 5260, 147, 208, "Output",ExpressionUUID->"4562bbeb-45c2-455c-9c05-6c419d329978"]
}, Open  ]],
Cell[183072, 5062, 524, 14, 51, "Input",ExpressionUUID->"9193ff38-c4f5-4984-9621-f6856f883032"],
Cell[CellGroupData[{
Cell[183621, 5080, 209, 4, 51, "Input",ExpressionUUID->"39adadc5-5e48-4120-8f60-48c236838f1e"],
Cell[183833, 5086, 385, 6, 51, "Output",ExpressionUUID->"5e2f3efe-b977-4c5e-92e6-242e39fb4c87"]
}, Open  ]],
Cell[CellGroupData[{
Cell[184255, 5097, 1458, 42, 130, "Input",ExpressionUUID->"fddf6110-1455-45a2-bf6f-04258e5c7966"],
Cell[185716, 5141, 598, 12, 35, "Message",ExpressionUUID->"c5532ae2-0ab9-4043-b427-b979192da345"]
}, Open  ]]
}, Open  ]],
Cell[CellGroupData[{
Cell[186363, 5159, 226, 4, 42, "Subsection",ExpressionUUID->"59008d8c-f1bc-4395-90d7-7585486b8a07"],
Cell[CellGroupData[{
Cell[186614, 5167, 1003, 24, 78, "Input",ExpressionUUID->"dc0dd67c-3dde-4e59-b697-febe97da0a1a"],
Cell[187620, 5193, 389, 6, 51, "Output",ExpressionUUID->"8a76cba9-f261-4be5-b14f-63fa4d5cfc67"]
}, Open  ]],
Cell[188024, 5202, 2017, 55, 130, "Input",ExpressionUUID->"dd10c95d-9715-47e2-bb63-16e790130cca"],
Cell[CellGroupData[{
Cell[190066, 5261, 216, 4, 51, "Input",ExpressionUUID->"41dc9814-153d-4905-baad-0973404bfe2d"],
Cell[190285, 5267, 227, 4, 51, "Output",ExpressionUUID->"3753f080-830a-4d22-9ce1-517e08bb0017"]
}, Open  ]],
Cell[190527, 5274, 4916, 133, 362, "Input",ExpressionUUID->"ca9ad445-a783-4399-bc8f-cb27decc7264"],
Cell[195446, 5409, 410, 8, 51, "Input",ExpressionUUID->"4c9c479b-3f9e-47b7-87cc-4f2aaffc75ff"],
Cell[CellGroupData[{
Cell[195881, 5421, 988, 24, 51, "Input",ExpressionUUID->"7b804a7e-9ab9-4bf6-9230-5156345eb783"],
Cell[196872, 5447, 968, 24, 51, "Output",ExpressionUUID->"8d72b292-802c-43a4-a0ca-d38966e7416c"]
}, Open  ]],
Cell[CellGroupData[{
Cell[197877, 5476, 215, 4, 51, "Input",ExpressionUUID->"062d9e59-9330-4ae3-a27e-eaeb0141a898"],
Cell[198095, 5482, 5175, 146, 208, "Output",ExpressionUUID->"d3da7001-1f97-47df-9928-052b7b263da5"]
}, Open  ]],
Cell[203285, 5631, 540, 15, 78, "Input",ExpressionUUID->"0bebda31-7cb7-4bff-9b51-527173edc4e6"],
Cell[CellGroupData[{
Cell[203850, 5650, 285, 5, 51, "Input",ExpressionUUID->"2d742d42-c9ab-44d1-a0ff-2066ee294ede"],
Cell[204138, 5657, 523, 9, 51, "Output",ExpressionUUID->"9e4d7f82-f9d7-4a6b-ad9b-31923aefe943"]
}, Open  ]],
Cell[CellGroupData[{
Cell[204698, 5671, 1277, 38, 104, "Input",ExpressionUUID->"b8fa77cc-1b35-4922-9129-b08f865e4e9e"],
Cell[205978, 5711, 762, 15, 35, "Message",ExpressionUUID->"8b8d129b-9eed-47e1-830e-fa9283394d46"]
}, Open  ]],
Cell[CellGroupData[{
Cell[206777, 5731, 117, 2, 51, "Input",ExpressionUUID->"c8e08eb4-3b1b-41d6-9bea-cd47cdf8746d"],
Cell[206897, 5735, 10825, 330, 555, "Output",ExpressionUUID->"97ce6a18-e105-47a5-990d-c0a183675f6f"]
}, Open  ]]
}, Open  ]],
Cell[CellGroupData[{
Cell[217771, 6071, 227, 4, 42, "Subsection",ExpressionUUID->"0dc6dbc1-eeb3-4f11-b2bc-668fae0eba77"],
Cell[CellGroupData[{
Cell[218023, 6079, 1073, 25, 78, "Input",ExpressionUUID->"30f56ef6-5b13-4baa-b8bf-15b7090ac3f7"],
Cell[219099, 6106, 418, 7, 51, "Output",ExpressionUUID->"ef10fc4b-b910-45e4-aa69-172c1bd4f155"]
}, Open  ]],
Cell[219532, 6116, 2113, 56, 130, "Input",ExpressionUUID->"7e4c037d-b2c8-4b94-a37c-c87c5346d37a"],
Cell[CellGroupData[{
Cell[221670, 6176, 216, 4, 51, "Input",ExpressionUUID->"59f786bb-5094-42ab-b9d0-362b1e405323"],
Cell[221889, 6182, 249, 4, 51, "Output",ExpressionUUID->"16d96285-ed54-496a-bcae-ade69b7185a2"]
}, Open  ]],
Cell[222153, 6189, 5038, 135, 362, "Input",ExpressionUUID->"015a8192-0e34-496c-b9e8-94d006b23504"],
Cell[227194, 6326, 410, 8, 51, "Input",ExpressionUUID->"a6114a56-cddf-4bbf-96d0-7d324e0ac67b"],
Cell[CellGroupData[{
Cell[227629, 6338, 988, 24, 51, "Input",ExpressionUUID->"7563fbcc-606e-49f5-ba0e-0582f8aa8a63"],
Cell[228620, 6364, 970, 24, 51, "Output",ExpressionUUID->"7b370499-a70f-4080-915f-3674e800bb34"]
}, Open  ]],
Cell[CellGroupData[{
Cell[229627, 6393, 215, 4, 51, "Input",ExpressionUUID->"08cbae83-330d-4c78-afa6-d9025cba7d1c"],
Cell[229845, 6399, 5196, 146, 208, "Output",ExpressionUUID->"07e1a2b6-3037-4ca0-8400-48e99ad86635"]
}, Open  ]],
Cell[235056, 6548, 540, 15, 78, "Input",ExpressionUUID->"3660df7e-5e63-4b2d-a97d-18687b7e7e55"],
Cell[CellGroupData[{
Cell[235621, 6567, 285, 5, 51, "Input",ExpressionUUID->"fa8ba1fd-a186-49cc-9bf9-aa75c0ff688a"],
Cell[235909, 6574, 544, 9, 51, "Output",ExpressionUUID->"25c49caa-8a9e-4265-9d5d-81c8dde158ea"]
}, Open  ]],
Cell[CellGroupData[{
Cell[236490, 6588, 1326, 39, 104, "Input",ExpressionUUID->"05540f17-9558-47af-a39a-04f87039a3ef"],
Cell[237819, 6629, 788, 15, 35, "Message",ExpressionUUID->"baf5d4a3-61a8-4221-bd13-5e44a930ef75"]
}, Open  ]],
Cell[CellGroupData[{
Cell[238644, 6649, 117, 2, 51, "Input",ExpressionUUID->"d5ee2776-4386-4864-a97b-c3438dc9d059"],
Cell[238764, 6653, 5000, 157, 286, "Output",ExpressionUUID->"accb4a05-0f2a-4623-b5e6-282c542e3e1d"]
}, Open  ]]
}, Open  ]],
Cell[CellGroupData[{
Cell[243813, 6816, 275, 4, 42, "Subsection",ExpressionUUID->"13628a4d-25c7-44e5-9dd8-790fd349801b"],
Cell[CellGroupData[{
Cell[244113, 6824, 1175, 26, 78, "Input",ExpressionUUID->"03460e8f-7d6e-4d1f-a8f9-dbc21d11e43f"],
Cell[245291, 6852, 436, 7, 51, "Output",ExpressionUUID->"81a189d5-7804-48f2-a773-178259a5e586"]
}, Open  ]],
Cell[245742, 6862, 2187, 57, 130, "Input",ExpressionUUID->"fde1bdc7-1d3b-4353-b9ad-7ae5dd60398a"],
Cell[247932, 6921, 5303, 140, 362, "Input",ExpressionUUID->"7e25f5e8-947e-4019-bee6-69b028ad1707"],
Cell[253238, 7063, 410, 8, 51, "Input",ExpressionUUID->"852c1b9c-61ce-4cbd-b3ae-6cd8d1457d71"],
Cell[CellGroupData[{
Cell[253673, 7075, 416, 11, 51, "Input",ExpressionUUID->"47ef6b8b-d114-4491-bb3e-09a9342ebb8f"],
Cell[254092, 7088, 327, 5, 51, "Output",ExpressionUUID->"23709299-613b-4db1-aff3-46f53a334542"]
}, Open  ]],
Cell[254434, 7096, 540, 15, 78, "Input",ExpressionUUID->"269e8e9f-94be-45a7-95c8-e950994ff4c7"],
Cell[CellGroupData[{
Cell[254999, 7115, 285, 5, 51, "Input",ExpressionUUID->"1eff3f89-c5c1-4c61-9f1f-4ce2abd924ea"],
Cell[255287, 7122, 565, 9, 51, "Output",ExpressionUUID->"0d450e5b-5041-4237-9d60-5120eac3cc9b"]
}, Open  ]],
Cell[255867, 7134, 1326, 39, 104, "Input",ExpressionUUID->"ff21824b-8ef3-4cd6-9556-da46ed6b1cca"],
Cell[CellGroupData[{
Cell[257218, 7177, 185, 3, 51, "Input",ExpressionUUID->"43a0151e-8ebd-4243-a5e4-1ed70ee22f2f"],
Cell[257406, 7182, 410, 10, 51, "Output",ExpressionUUID->"5d034607-d61e-4893-b8f8-caaf0b40a516"]
}, Open  ]]
}, Open  ]],
Cell[CellGroupData[{
Cell[257865, 7198, 160, 3, 42, "Subsection",ExpressionUUID->"53d2eeec-1112-4cce-b7d4-5104623dfb30"],
Cell[CellGroupData[{
Cell[258050, 7205, 540, 15, 78, "Input",ExpressionUUID->"41b68abb-e62d-4676-bed1-4a7b029d8a85"],
Cell[258593, 7222, 22161, 682, 611, "Output",ExpressionUUID->"99b8b527-2c8f-49ce-a350-6db15fb6ebc8"]
}, Open  ]],
Cell[CellGroupData[{
Cell[280791, 7909, 614, 18, 78, "Input",ExpressionUUID->"b1392e9f-0802-4547-8291-d9d836b6a531"],
Cell[281408, 7929, 204, 4, 51, "Output",ExpressionUUID->"591470bc-bf1a-44f5-900e-5da6e2a4c439"]
}, Open  ]],
Cell[CellGroupData[{
Cell[281649, 7938, 480, 14, 51, "Input",ExpressionUUID->"8e1a2554-41a4-4f32-a8dc-9e90074da6ee"],
Cell[282132, 7954, 17769, 507, 562, "Output",ExpressionUUID->"1ed87c8d-a7f8-4bc2-bb56-1878d86c7b33"]
}, Open  ]]
}, Open  ]]
}, Closed]],
Cell[CellGroupData[{
Cell[299962, 8468, 326, 5, 68, "Section",ExpressionUUID->"59b54bc3-97df-45d6-bc28-81e428b29101"],
Cell[CellGroupData[{
Cell[300313, 8477, 160, 3, 42, "Subsection",ExpressionUUID->"46d3ea8b-05f7-4416-b0bc-fd29a7778142"],
Cell[CellGroupData[{
Cell[300498, 8484, 989, 27, 104, "Input",ExpressionUUID->"63883844-e4d0-4419-995f-f86af78cb92b"],
Cell[301490, 8513, 680, 19, 51, "Output",ExpressionUUID->"83aac5e4-b6c9-40d2-8198-3e2d8667c23b"]
}, Open  ]],
Cell[302185, 8535, 1219, 25, 130, "Input",ExpressionUUID->"76d539e4-604c-4249-bad1-2503c5290e11"],
Cell[303407, 8562, 1095, 35, 78, "Input",ExpressionUUID->"d762502d-750c-4a1a-a501-5e02e614f8af"],
Cell[304505, 8599, 2816, 78, 211, "Input",ExpressionUUID->"b85bd2bb-430b-432d-85db-d49e5ba6ae04"]
}, Open  ]],
Cell[CellGroupData[{
Cell[307358, 8682, 172, 3, 42, "Subsection",ExpressionUUID->"27e8c3a2-ef85-4301-a1da-32f85207ffba"],
Cell[307533, 8687, 922, 22, 51, "Input",ExpressionUUID->"585e517d-3efd-42fb-8d2b-6ff81dcee3a7"],
Cell[CellGroupData[{
Cell[308480, 8713, 3473, 104, 286, "Input",ExpressionUUID->"64955980-6552-4fbe-8bd8-2006ec4384c6"],
Cell[311956, 8819, 933, 21, 70, "Output",ExpressionUUID->"2fc06291-e137-4074-9bbc-42b76ffe37ff"]
}, Open  ]],
Cell[312904, 8843, 4132, 128, 336, "Input",ExpressionUUID->"73d361bc-fb21-4cc6-b858-1081cb7d7c28"],
Cell[317039, 8973, 2087, 54, 156, "Input",ExpressionUUID->"f0029f32-d8bd-46d4-b155-35b3b8e77226"],
Cell[319129, 9029, 227, 7, 51, "Input",ExpressionUUID->"fa9a6a87-0b37-407a-9714-0c09c4d26928"],
Cell[319359, 9038, 524, 14, 51, "Input",ExpressionUUID->"2f8618e3-2ecf-46ed-86be-a8da3f993eb9"],
Cell[CellGroupData[{
Cell[319908, 9056, 209, 4, 51, "Input",ExpressionUUID->"80c636eb-b91d-4e62-8904-ae38cfaf70be"],
Cell[320120, 9062, 454, 7, 70, "Output",ExpressionUUID->"9af28cb3-19ba-4d93-9fbb-547e1e11b9a9"]
}, Open  ]],
Cell[CellGroupData[{
Cell[320611, 9074, 1458, 42, 130, "Input",ExpressionUUID->"cd0f0334-06ee-4f03-ad4a-dccea1959155"],
Cell[322072, 9118, 667, 13, 70, "Message",ExpressionUUID->"d4f00f4a-1355-4181-96b7-6a3f656d925c"]
}, Open  ]]
}, Closed]],
Cell[CellGroupData[{
Cell[322788, 9137, 226, 4, 41, "Subsection",ExpressionUUID->"e55fa114-6f3f-4e57-9042-2adbdd39a286"],
Cell[CellGroupData[{
Cell[323039, 9145, 1029, 25, 78, "Input",ExpressionUUID->"e81780ce-5cdc-4297-b96c-d10168de938e"],
Cell[324071, 9172, 487, 8, 70, "Output",ExpressionUUID->"b629d2e4-6c0e-439e-bab6-f6de1db14116"]
}, Open  ]],
Cell[324573, 9183, 2017, 55, 130, "Input",ExpressionUUID->"a2717930-937a-4c21-aa88-03ba76c7d98d"],
Cell[CellGroupData[{
Cell[326615, 9242, 216, 4, 51, "Input",ExpressionUUID->"d6d6b0b1-34aa-474e-b397-fdc6b3f8d865"],
Cell[326834, 9248, 318, 5, 70, "Output",ExpressionUUID->"d0f5fa43-f012-468f-8500-5967ecbe822f"]
}, Open  ]],
Cell[327167, 9256, 4910, 133, 341, "Input",ExpressionUUID->"ad67a268-49c9-4fc2-a2e7-1202cf0c7c53"],
Cell[332080, 9391, 410, 8, 51, "Input",ExpressionUUID->"72f44ea0-a346-4471-b32e-dfefbb0d6428"],
Cell[CellGroupData[{
Cell[332515, 9403, 988, 24, 51, "Input",ExpressionUUID->"815cf49c-0a7b-4689-98f1-ef3527fcb2f8"],
Cell[333506, 9429, 990, 24, 70, "Output",ExpressionUUID->"becd841a-d5dc-44e2-b991-a5fc942855dd"]
}, Open  ]],
Cell[CellGroupData[{
Cell[334533, 9458, 215, 4, 51, "Input",ExpressionUUID->"a0181419-1fa1-46e1-92f1-89bc97129c7a"],
Cell[334751, 9464, 5197, 146, 70, "Output",ExpressionUUID->"886008dd-cbb6-414c-8cf3-147d49ab8223"]
}, Open  ]],
Cell[339963, 9613, 540, 15, 78, "Input",ExpressionUUID->"1e88fb7c-d5f5-4931-a279-7e05550291fd"],
Cell[CellGroupData[{
Cell[340528, 9632, 285, 5, 51, "Input",ExpressionUUID->"a79df089-ed2d-4ded-a266-1b17d479c9a2"],
Cell[340816, 9639, 617, 10, 70, "Output",ExpressionUUID->"faf0c90a-3fc2-4a97-8e32-f7765ef2590d"]
}, Open  ]],
Cell[CellGroupData[{
Cell[341470, 9654, 1277, 38, 104, "Input",ExpressionUUID->"1f712311-4975-4ed6-a7d3-09ae1c6a31d7"],
Cell[342750, 9694, 833, 16, 70, "Message",ExpressionUUID->"097a0603-b66f-40a8-82c4-fe632f9bcae0"]
}, Open  ]]
}, Closed]],
Cell[CellGroupData[{
Cell[343632, 9716, 227, 4, 41, "Subsection",ExpressionUUID->"093da948-de7f-454f-8d79-9cf7d35422c3"],
Cell[CellGroupData[{
Cell[343884, 9724, 1073, 25, 78, "Input",ExpressionUUID->"6a1ca1dd-0cf5-4aa0-9478-36bb48adb0e4"],
Cell[344960, 9751, 490, 8, 70, "Output",ExpressionUUID->"0745b7e9-915a-4c41-b8bd-dc5f11e5b85a"]
}, Open  ]],
Cell[345465, 9762, 2113, 56, 130, "Input",ExpressionUUID->"dd475017-77a1-49c6-b689-cb657cf98d66"],
Cell[CellGroupData[{
Cell[347603, 9822, 216, 4, 51, "Input",ExpressionUUID->"9593486d-7e53-4ab1-9a84-acce95ba243f"],
Cell[347822, 9828, 318, 5, 70, "Output",ExpressionUUID->"93565269-2889-4533-a72c-b8de0a8e3c7b"]
}, Open  ]],
Cell[348155, 9836, 5006, 134, 341, "Input",ExpressionUUID->"2b829d84-3c43-404b-ac21-445a8f6759c1"],
Cell[353164, 9972, 410, 8, 51, "Input",ExpressionUUID->"341b9159-8e46-48e9-83cc-e872910e762c"],
Cell[CellGroupData[{
Cell[353599, 9984, 988, 24, 51, "Input",ExpressionUUID->"f0dacc84-a419-4e44-8cfa-8a2f7fcc98c7"],
Cell[354590, 10010, 992, 24, 70, "Output",ExpressionUUID->"730aa383-f58a-4e02-aeeb-460444c706e9"]
}, Open  ]],
Cell[CellGroupData[{
Cell[355619, 10039, 215, 4, 51, "Input",ExpressionUUID->"4180baca-9159-435e-9c2b-6677e160589e"],
Cell[355837, 10045, 5221, 147, 70, "Output",ExpressionUUID->"67cd9f80-bd7c-4f99-af53-75f11381d60f"]
}, Open  ]],
Cell[361073, 10195, 540, 15, 78, "Input",ExpressionUUID->"de73dfa1-ae0b-4862-a7ac-49bb0c00b87e"],
Cell[CellGroupData[{
Cell[361638, 10214, 285, 5, 51, "Input",ExpressionUUID->"bda0c3b7-0b8c-47f3-a81a-619774f37614"],
Cell[361926, 10221, 615, 10, 70, "Output",ExpressionUUID->"4460e8bc-53a6-4bcf-9fe8-baf5a12999a1"]
}, Open  ]],
Cell[CellGroupData[{
Cell[362578, 10236, 1326, 39, 104, "Input",ExpressionUUID->"8b94d3f8-f020-428b-9825-ea39ae125616"],
Cell[363907, 10277, 366, 9, 70, "Message",ExpressionUUID->"7eef4795-883a-4af8-925f-427c61013555"]
}, Open  ]],
Cell[CellGroupData[{
Cell[364310, 10291, 117, 2, 51, "Input",ExpressionUUID->"5bdfdf31-0c8e-40be-ac02-abcbec459edb"],
Cell[364430, 10295, 10717, 310, 70, "Output",ExpressionUUID->"ffcc6bdb-6787-4c7c-839e-d821f5d76e7b"]
}, Open  ]]
}, Closed]],
Cell[CellGroupData[{
Cell[375196, 10611, 275, 4, 41, "Subsection",ExpressionUUID->"83c61381-cf0f-42d4-9208-7077932484a5"],
Cell[CellGroupData[{
Cell[375496, 10619, 1175, 26, 78, "Input",ExpressionUUID->"9f254a5e-e840-46a3-8ea6-624833a130d2"],
Cell[376674, 10647, 507, 8, 70, "Output",ExpressionUUID->"46b4cffd-aaf7-49c7-955f-68a919af06e0"]
}, Open  ]],
Cell[377196, 10658, 2187, 57, 130, "Input",ExpressionUUID->"cf70a313-2714-4caa-b2a7-be91a17d9612"],
Cell[379386, 10717, 5303, 140, 362, "Input",ExpressionUUID->"2944e463-041a-4acb-b4e9-cb5e2bc0dad0"],
Cell[384692, 10859, 410, 8, 51, "Input",ExpressionUUID->"ceb566d5-292a-4b84-806d-0202035da45c"],
Cell[CellGroupData[{
Cell[385127, 10871, 416, 11, 51, "Input",ExpressionUUID->"4e582181-64d9-48f1-8e0b-68bb2f74a942"],
Cell[385546, 10884, 10088, 259, 70, "Output",ExpressionUUID->"dae58a1e-115c-4400-bd31-ea80c13021c1"]
}, Open  ]],
Cell[395649, 11146, 540, 15, 78, "Input",ExpressionUUID->"578da957-5282-4fd5-9530-ac3721c0f902"],
Cell[CellGroupData[{
Cell[396214, 11165, 285, 5, 51, "Input",ExpressionUUID->"55a88c8e-c935-44b1-abdc-81867df14125"],
Cell[396502, 11172, 592, 10, 70, "Output",ExpressionUUID->"2258df6e-4adf-431b-b2f9-1fbedad4ad0c"]
}, Open  ]],
Cell[CellGroupData[{
Cell[397131, 11187, 1326, 39, 104, "Input",ExpressionUUID->"55ed02f0-5029-4486-8aa9-90f743334a2d"],
Cell[398460, 11228, 394, 9, 70, "Message",ExpressionUUID->"e6101b93-9894-4eb4-955e-5c8c9c584629"]
}, Open  ]],
Cell[CellGroupData[{
Cell[398891, 11242, 185, 3, 51, "Input",ExpressionUUID->"530c074c-4a1f-4e4c-b6fb-3525f3d0619d"],
Cell[399079, 11247, 405, 8, 70, "Output",ExpressionUUID->"40b43df2-c262-4804-ae73-203fa1385290"]
}, Open  ]]
}, Closed]],
Cell[CellGroupData[{
Cell[399533, 11261, 160, 3, 41, "Subsection",ExpressionUUID->"90bcefed-5dc3-4e0f-aad2-1b12a6b9f00c"],
Cell[CellGroupData[{
Cell[399718, 11268, 480, 14, 51, "Input",ExpressionUUID->"60fe8754-c35b-431a-a109-481025a83ebd"],
Cell[400201, 11284, 13596, 384, 464, "Output",ExpressionUUID->"e70bd20e-4e54-46df-acee-645ae5392333"]
}, Open  ]],
Cell[CellGroupData[{
Cell[413834, 11673, 205, 4, 51, "Input",ExpressionUUID->"11e0c9cc-4ab9-4885-9725-e46ef5282ed9"],
Cell[414042, 11679, 181, 3, 51, "Output",ExpressionUUID->"80b93f15-3ecd-4391-ba38-b2115dd566bf"]
}, Open  ]]
}, Open  ]]
}, Closed]],
Cell[CellGroupData[{
Cell[414284, 11689, 380, 6, 68, "Section",ExpressionUUID->"69a8eb9f-9bdc-4fc6-90ff-d825789bcb7c"],
Cell[CellGroupData[{
Cell[414689, 11699, 160, 3, 42, "Subsection",ExpressionUUID->"87c7d773-b634-4c06-8e11-d3348430a623"],
Cell[CellGroupData[{
Cell[414874, 11706, 989, 27, 104, "Input",ExpressionUUID->"ab3b459b-5e90-48ea-bb16-27ca136e9a2f"],
Cell[415866, 11735, 656, 19, 51, "Output",ExpressionUUID->"8551b697-7f0b-4afd-9409-9c1a9bf0b94e"]
}, Open  ]],
Cell[416537, 11757, 1219, 25, 130, "Input",ExpressionUUID->"10268b10-7e12-4f67-ac7e-7834e7d8622f"],
Cell[417759, 11784, 1095, 35, 78, "Input",ExpressionUUID->"dd6a16d8-db77-40b7-b9a5-a68054310c77"],
Cell[418857, 11821, 546, 16, 51, "Input",ExpressionUUID->"7273cea8-b47a-42ac-aa64-34bbea20dab4"],
Cell[CellGroupData[{
Cell[419428, 11841, 206, 4, 51, "Input",ExpressionUUID->"11885de8-753d-48de-bb3e-7a6788a2e370"],
Cell[419637, 11847, 181, 3, 51, "Output",ExpressionUUID->"37af76d3-a6fe-499c-87fa-42fcdb296086"]
}, Open  ]],
Cell[419833, 11853, 2816, 78, 211, "Input",ExpressionUUID->"331966e1-7937-4f79-bdf9-84739b0401fc"],
Cell[422652, 11933, 429, 12, 51, "Input",ExpressionUUID->"7db4d02a-5d09-45ac-9d45-e0f0ebe8f8c4"],
Cell[CellGroupData[{
Cell[423106, 11949, 209, 4, 51, "Input",ExpressionUUID->"325078f6-200c-4d93-bfbc-13425e865026"],
Cell[423318, 11955, 182, 3, 51, "Output",ExpressionUUID->"85c91043-b80c-4fe0-a5fa-54d604cc29c4"]
}, Open  ]],
Cell[CellGroupData[{
Cell[423537, 11963, 2860, 86, 286, "Input",ExpressionUUID->"b1fbd84f-0433-4910-80e2-5ad8d6dbbddf"],
Cell[426400, 12051, 493, 11, 35, "Message",ExpressionUUID->"5ef90909-6d0d-41d3-97f4-dd94d9a1e708"],
Cell[426896, 12064, 668, 14, 35, "Message",ExpressionUUID->"bfe3993b-0e93-478d-99fd-02c38980d5a0"]
}, Open  ]],
Cell[CellGroupData[{
Cell[427601, 12083, 288, 6, 51, "Input",ExpressionUUID->"e0810539-063e-4fe3-ac9c-9f1bcde2d45c"],
Cell[427892, 12091, 3117, 94, 173, "Output",ExpressionUUID->"e7e58bb2-c537-48bb-ab8a-5d074bc4615c"]
}, Open  ]],
Cell[CellGroupData[{
Cell[431046, 12190, 325, 8, 51, "Input",ExpressionUUID->"93bd6c08-6f70-4322-a32c-8e633e25114d"],
Cell[431374, 12200, 2420, 72, 152, "Output",ExpressionUUID->"6999f32e-a823-43e1-b9d7-0d68bbd1c026"]
}, Open  ]],
Cell[433809, 12275, 1427, 43, 182, "Input",ExpressionUUID->"64a868eb-e2d4-4e94-82e1-1bde57c0837c"],
Cell[CellGroupData[{
Cell[435261, 12322, 210, 4, 51, "Input",ExpressionUUID->"20be0346-15d6-48da-b01c-8b29af978d5d"],
Cell[435474, 12328, 156, 3, 51, "Output",ExpressionUUID->"dbec521e-69e2-49ee-ac09-7ddae2c9391c"]
}, Open  ]],
Cell[CellGroupData[{
Cell[435667, 12336, 213, 4, 51, "Input",ExpressionUUID->"380a5a51-bf8b-47e0-a5fe-fd158c775d2b"],
Cell[435883, 12342, 158, 3, 51, "Output",ExpressionUUID->"737c14d4-ba79-41a1-80b4-5b85eb5f1579"]
}, Open  ]],
Cell[436056, 12348, 466, 13, 78, "Input",ExpressionUUID->"d82dd100-bacf-4021-8f4d-a291f2a6fe47"]
}, Open  ]],
Cell[CellGroupData[{
Cell[436559, 12366, 172, 3, 42, "Subsection",ExpressionUUID->"718be8c1-6ad8-4039-8b3e-3fd03b15fa11"],
Cell[436734, 12371, 898, 22, 51, "Input",ExpressionUUID->"4012c174-e483-4432-b176-bce09d101456"],
Cell[CellGroupData[{
Cell[437657, 12397, 3473, 104, 286, "Input",ExpressionUUID->"bf3f4366-0313-4b02-89ff-01738506712d"],
Cell[441133, 12503, 905, 20, 51, "Output",ExpressionUUID->"4e368c35-91cb-4162-a9c5-ebf61cc71aea"]
}, Open  ]],
Cell[442053, 12526, 4132, 128, 336, "Input",ExpressionUUID->"dbd45628-aed1-4c61-837a-c31fb11c0eb8"],
Cell[446188, 12656, 2087, 54, 156, "Input",ExpressionUUID->"56d665ab-7daf-4738-8cd3-8c9668245f3a"],
Cell[448278, 12712, 227, 7, 51, "Input",ExpressionUUID->"61339348-3ff7-4021-aec5-bcd88ec61e4f"],
Cell[448508, 12721, 524, 14, 51, "Input",ExpressionUUID->"db91009e-5f25-458b-9204-da34e407ea01"],
Cell[CellGroupData[{
Cell[449057, 12739, 209, 4, 51, "Input",ExpressionUUID->"4a26b15b-0fec-4d84-8631-679e3b200441"],
Cell[449269, 12745, 432, 7, 51, "Output",ExpressionUUID->"f712c525-e7d8-42bd-a71d-bccbf243db54"]
}, Open  ]],
Cell[CellGroupData[{
Cell[449738, 12757, 1458, 42, 130, "Input",ExpressionUUID->"ee9f6abd-631a-4655-adb3-6a58107d0062"],
Cell[451199, 12801, 645, 13, 35, "Message",ExpressionUUID->"7a2db3c5-462e-4d1e-823d-736ee1744f95"]
}, Open  ]]
}, Open  ]],
Cell[CellGroupData[{
Cell[451893, 12820, 226, 4, 42, "Subsection",ExpressionUUID->"8aabd125-c494-4187-89e7-b929b0764b68"],
Cell[CellGroupData[{
Cell[452144, 12828, 1029, 25, 78, "Input",ExpressionUUID->"b884c4a7-6e73-486a-b319-956d9247baeb"],
Cell[453176, 12855, 461, 7, 51, "Output",ExpressionUUID->"ac3d262e-5431-4ba9-9826-1cef0b10ff15"]
}, Open  ]],
Cell[453652, 12865, 2017, 55, 130, "Input",ExpressionUUID->"2e9d51cb-1250-4b8c-84b7-585d3444bb73"],
Cell[CellGroupData[{
Cell[455694, 12924, 216, 4, 51, "Input",ExpressionUUID->"446ce663-7eb7-4144-b404-73bdfda3b484"],
Cell[455913, 12930, 295, 5, 51, "Output",ExpressionUUID->"8531d5ab-11cf-4a67-b011-01dd05d07c51"]
}, Open  ]],
Cell[456223, 12938, 4910, 133, 341, "Input",ExpressionUUID->"fa6f5646-12d0-402f-8458-b680cfe7e8ed"],
Cell[461136, 13073, 410, 8, 51, "Input",ExpressionUUID->"c5fd8865-8f25-482c-b488-016315b8aee7"],
Cell[CellGroupData[{
Cell[461571, 13085, 988, 24, 51, "Input",ExpressionUUID->"af8747a8-4f93-4c5b-bff5-b8372ec86d40"],
Cell[462562, 13111, 968, 24, 51, "Output",ExpressionUUID->"969f371c-d92f-478c-84c6-c59357adffa5"]
}, Open  ]],
Cell[CellGroupData[{
Cell[463567, 13140, 215, 4, 51, "Input",ExpressionUUID->"1e93fbae-0b67-433c-9ea8-fa1a9151ea73"],
Cell[463785, 13146, 5175, 146, 208, "Output",ExpressionUUID->"664c8bf9-e7af-4855-8d25-97fd7c5cd002"]
}, Open  ]],
Cell[468975, 13295, 540, 15, 78, "Input",ExpressionUUID->"574cf71c-f09c-4a42-a9eb-61ed6802e293"],
Cell[CellGroupData[{
Cell[469540, 13314, 285, 5, 51, "Input",ExpressionUUID->"bc0a4d97-ba05-449b-a2c0-70b1f979a85f"],
Cell[469828, 13321, 594, 10, 51, "Output",ExpressionUUID->"a9420db9-8785-4c35-b2a8-363053cce88a"]
}, Open  ]],
Cell[CellGroupData[{
Cell[470459, 13336, 1277, 38, 104, "Input",ExpressionUUID->"a7e2e9ee-021c-49cb-84b5-bf401a4f7bc9"],
Cell[471739, 13376, 808, 15, 35, "Message",ExpressionUUID->"3cfc95f1-96f4-4768-abcd-d97fff36da43"]
}, Open  ]]
}, Open  ]],
Cell[CellGroupData[{
Cell[472596, 13397, 227, 4, 42, "Subsection",ExpressionUUID->"379cc9e9-cc4e-41ce-a1f5-2a4837d5b90f"],
Cell[CellGroupData[{
Cell[472848, 13405, 1073, 25, 78, "Input",ExpressionUUID->"67810cac-ef26-414e-973b-982b6d3c9be5"],
Cell[473924, 13432, 462, 7, 51, "Output",ExpressionUUID->"6a5735f8-197f-4ac0-bb40-6ef3a2cbc7f4"]
}, Open  ]],
Cell[474401, 13442, 2113, 56, 130, "Input",ExpressionUUID->"5ea2d570-323a-4077-9b1e-f425158719cb"],
Cell[CellGroupData[{
Cell[476539, 13502, 216, 4, 51, "Input",ExpressionUUID->"735a6f30-189f-4e68-8b54-0ff365476c17"],
Cell[476758, 13508, 296, 5, 51, "Output",ExpressionUUID->"6a001f81-8ccb-4132-a374-5ee6a52de13a"]
}, Open  ]],
Cell[477069, 13516, 5006, 134, 341, "Input",ExpressionUUID->"c46833fe-bb42-4236-919e-d699cdceb78a"],
Cell[482078, 13652, 410, 8, 51, "Input",ExpressionUUID->"900df586-c439-4fc2-abfa-205e6cfc5ed5"],
Cell[CellGroupData[{
Cell[482513, 13664, 988, 24, 51, "Input",ExpressionUUID->"dafc7ee9-8920-4c80-9acb-e14a7ab6d011"],
Cell[483504, 13690, 970, 24, 51, "Output",ExpressionUUID->"ef885fec-ff54-4e30-8b96-c4ae47c59f57"]
}, Open  ]],
Cell[CellGroupData[{
Cell[484511, 13719, 215, 4, 51, "Input",ExpressionUUID->"0376c9af-430a-4eb1-8140-fece7a045657"],
Cell[484729, 13725, 5196, 146, 208, "Output",ExpressionUUID->"1834c089-1a6c-4354-a614-c6b152afc21a"]
}, Open  ]],
Cell[489940, 13874, 540, 15, 78, "Input",ExpressionUUID->"e343c648-ccd2-43a2-b8ef-f0409eb9b4c9"],
Cell[CellGroupData[{
Cell[490505, 13893, 285, 5, 51, "Input",ExpressionUUID->"7e06ccd0-81fc-4e62-96de-03e3e0b3c199"],
Cell[490793, 13900, 592, 10, 51, "Output",ExpressionUUID->"d0b9b8b7-102f-4f9d-904a-84839df0c6c1"]
}, Open  ]],
Cell[491400, 13913, 1326, 39, 104, "Input",ExpressionUUID->"d28fb5a0-ab74-4036-b2d8-e383e656fb96"],
Cell[CellGroupData[{
Cell[492751, 13956, 117, 2, 51, "Input",ExpressionUUID->"6d35c829-fa10-466b-a59d-1d59b549e23a"],
Cell[492871, 13960, 1296, 36, 78, "Output",ExpressionUUID->"7dca5ed4-9fe2-4457-a34e-8af5ac245d9c"]
}, Open  ]]
}, Open  ]],
Cell[CellGroupData[{
Cell[494216, 14002, 275, 4, 42, "Subsection",ExpressionUUID->"c0254820-aca8-4b81-aa66-6d34b6c862ff"],
Cell[CellGroupData[{
Cell[494516, 14010, 1175, 26, 78, "Input",ExpressionUUID->"f44f5ba3-2a89-47dd-9ccf-21fb467a01a7"],
Cell[495694, 14038, 484, 8, 51, "Output",ExpressionUUID->"d462e5de-2f47-427a-a7fa-5e7b78e0cb22"]
}, Open  ]],
Cell[496193, 14049, 2187, 57, 130, "Input",ExpressionUUID->"d12fd0ee-7560-4079-8d93-ae508a9a0722"],
Cell[498383, 14108, 5303, 140, 362, "Input",ExpressionUUID->"3ca9767b-e9d3-4bb0-9e75-152b76f7ad91"],
Cell[503689, 14250, 410, 8, 51, "Input",ExpressionUUID->"2d03fca1-afb7-4b7b-84dd-e804fcd254d7"],
Cell[CellGroupData[{
Cell[504124, 14262, 416, 11, 51, "Input",ExpressionUUID->"6618b060-3530-4f7b-95f7-2e6fb07f110d"],
Cell[504543, 14275, 327, 5, 51, "Output",ExpressionUUID->"1d5c78f0-4832-4327-85a9-51b09a95654c"]
}, Open  ]],
Cell[504885, 14283, 540, 15, 78, "Input",ExpressionUUID->"c65e1169-cdad-4cd2-9c97-8dc323839e66"],
Cell[CellGroupData[{
Cell[505450, 14302, 285, 5, 51, "Input",ExpressionUUID->"2beff2b6-538d-4be5-a333-fc1b0eaa1683"],
Cell[505738, 14309, 565, 9, 51, "Output",ExpressionUUID->"d942df95-1459-4c4a-acb3-8332859df397"]
}, Open  ]],
Cell[506318, 14321, 1326, 39, 104, "Input",ExpressionUUID->"ebacb69c-e1e6-4f28-8079-82399b128b1f"],
Cell[CellGroupData[{
Cell[507669, 14364, 185, 3, 51, "Input",ExpressionUUID->"a0138ef6-8b8f-40a7-b906-46fcd545dcc3"],
Cell[507857, 14369, 459, 11, 51, "Output",ExpressionUUID->"896c75a6-13d7-48da-bddf-8f1bc7f04283"]
}, Open  ]]
}, Open  ]],
Cell[CellGroupData[{
Cell[508365, 14386, 160, 3, 42, "Subsection",ExpressionUUID->"235c536f-16df-4021-9cdf-dadca244d542"],
Cell[CellGroupData[{
Cell[508550, 14393, 498, 11, 78, "Input",ExpressionUUID->"33810c38-01c9-446b-9c80-6c7678d2a202"],
Cell[509051, 14406, 25329, 800, 562, "Output",ExpressionUUID->"59158364-85a5-45ed-ac3a-29466140d077"]
}, Open  ]],
Cell[CellGroupData[{
Cell[534417, 15211, 207, 4, 51, "Input",ExpressionUUID->"8082d519-25b1-4d3a-a963-ae219534db5e"],
Cell[534627, 15217, 155, 3, 51, "Output",ExpressionUUID->"e59832b0-530f-4138-b62f-603475a7907f"]
}, Open  ]],
Cell[CellGroupData[{
Cell[534819, 15225, 634, 18, 78, "Input",ExpressionUUID->"30557a72-199e-4bb7-9d19-d769f8477edf"],
Cell[535456, 15245, 319, 7, 51, "Output",ExpressionUUID->"414c7349-4c42-4123-8b73-5d6c8b593f9e"],
Cell[535778, 15254, 302, 6, 51, "Output",ExpressionUUID->"e538ff4d-9e27-443d-b0c4-2ed588f3df47"]
}, Open  ]],
Cell[CellGroupData[{
Cell[536117, 15265, 480, 14, 51, "Input",ExpressionUUID->"4f3f7d32-e04d-4c99-9f63-a96e14c7272f"],
Cell[536600, 15281, 17769, 507, 562, "Output",ExpressionUUID->"1b500b31-934b-413d-921d-a723231a646a"]
}, Open  ]]
}, Open  ]]
}, Closed]],
Cell[CellGroupData[{
Cell[554430, 15795, 186, 3, 68, "Section",ExpressionUUID->"8953edf9-c418-417c-99bf-30c222761e4f"],
Cell[CellGroupData[{
Cell[554641, 15802, 1104, 31, 78, "Input",ExpressionUUID->"23ce62ce-f395-4ae6-b3c2-19f13f4f2093"],
Cell[555748, 15835, 3518, 105, 130, "Output",ExpressionUUID->"66d42665-e0c0-44c5-8ce3-4895ff5bc1cf"]
}, Open  ]]
}, Open  ]]
}
]
*)

