(* Content-type: application/vnd.wolfram.mathematica *)

(*** Wolfram Notebook File ***)
(* http://www.wolfram.com/nb *)

(* CreatedBy='Mathematica 10.0' *)

(*CacheID: 234*)
(* Internal cache information:
NotebookFileLineBreakTest
NotebookFileLineBreakTest
NotebookDataPosition[       158,          7]
NotebookDataLength[    890401,      24754]
NotebookOptionsPosition[    842334,      24002]
NotebookOutlinePosition[    842959,      24022]
CellTagsIndexPosition[    842916,      24019]
WindowFrame->Normal*)

(* Beginning of Notebook Content *)
Notebook[{

Cell[CellGroupData[{
Cell["Loading Packages", "Section",
 CellChangeTimes->{{3.851831445638886*^9, 
  3.851831451080901*^9}},ExpressionUUID->"0441e687-3271-491a-8955-\
dd8d0f7cb479"],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"SetDirectory", "[", 
  "\"\</Users/gangchen/Documents/GitHub/kinematicHopfAlgebra\>\"", 
  "]"}]], "Input",
 CellLabel->"In[1]:=",ExpressionUUID->"e15a1c17-2cfb-46a2-8aa9-607b0a62e713"],

Cell[BoxData["\<\"/Users/gangchen/Documents/GitHub/kinematicHopfAlgebra\"\>"],\
 "Output",
 CellChangeTimes->{{3.876903361280591*^9, 3.87690337645822*^9}, 
   3.876976886374969*^9, 3.8769769654479218`*^9, 3.8770661363411407`*^9, 
   3.8778209354595747`*^9, 3.8780069182245827`*^9, 3.87801160829534*^9, 
   3.8780156063397217`*^9, 3.8783569533644123`*^9, {3.878357018305354*^9, 
   3.8783570280744457`*^9}, 3.87861617694631*^9, 3.878856934833416*^9},
 CellLabel->"Out[1]=",ExpressionUUID->"db0d487d-d6d9-443a-b19d-813d4dd80874"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"Get", "[", "\"\<KiHA.wl\>\"", "]"}]], "Input",
 CellChangeTimes->{
  3.857017232176591*^9, {3.871280778936686*^9, 3.8712807820748453`*^9}, {
   3.871880936625079*^9, 3.871881000526787*^9}, {3.876804060646309*^9, 
   3.876804061338099*^9}},
 CellLabel->"In[2]:=",ExpressionUUID->"9e588303-12c7-48e0-b8a5-8c3c446f4c9f"],

Cell["\<\
 KiHA(v1.6),Copyright 2022,author Gang Chen. It is licensed under the GNU \
General Public License v3.0.
 KiHA is based on the work of Kinematic Hopf Algebra in CTP of Queen Mary \
University of London.
 It generates the duality all-n numerator for colour-kinematic duality and \
double copy in heavy mass effective 
 theory(HEFT), Yang-Mills/Gravity theory and Yang-Mills-Scalar/Gravity-Scalar. 
 KiHA is built on some basic functions written by Gustav Mogull and Gregor \
Kaelin.
 use ?KiHA`* for help and a series of papers (2111.15649, 2208.05519, \
2208.05886) for more reference.\
\>", "Print",
 CellFrame->0.5,
 CellChangeTimes->{3.878856934983741*^9},
 FontColor->RGBColor[
  0, 0, 1],ExpressionUUID->"7f6ffc92-cff1-4f6d-9aa9-16694e342dce"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"Get", "[", "\"\<MultiVariateApart.wl\>\"", "]"}]], "Input",
 CellLabel->"In[3]:=",ExpressionUUID->"ffda9edb-2059-4574-84d1-b1affec10b4c"],

Cell["\<\
MultivariateApart -- Multivariate partial fractions. By Matthias Heller \
(maheller@students.uni-mainz.de) and Andreas von Manteuffel (vmante@msu.edu). \
Version 2021-01-18. Please see ?MultivariateApart and ?MultivariateApart`* \
for help.\
\>", "Print",
 CellFrame->0.5,
 CellChangeTimes->{3.878856935032364*^9},
 FontColor->RGBColor[
  0.09375, 0.26953125, 
   0.23046875],ExpressionUUID->"cd68d829-7544-48b8-8b9b-05c1e7922ee4"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{
  RowBox[{"Unprotect", "[", 
   RowBox[{"p", ",", "F", ",", "\[Epsilon]"}], "]"}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{"declareVectorHead", "[", 
  RowBox[{"{", 
   RowBox[{
   "p", ",", "q", ",", "l", ",", "\[Epsilon]", ",", "v", ",", "w", ",", 
    "link", ",", "as"}], "}"}], "]"}], "\[IndentingNewLine]", 
 RowBox[{"declareTensorHead", "[", 
  RowBox[{
   RowBox[{"{", 
    RowBox[{"F", ",", "H", ",", "W", ",", "V", ",", "S"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"\"\<rank\>\"", "\[Rule]", " ", "2"}], "}"}]}], 
  "]"}], "\[IndentingNewLine]", 
 RowBox[{"declareAntiTensorHead", "[", 
  RowBox[{"{", 
   RowBox[{"F", ",", "S"}], "}"}], "]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"Protect", "[", 
   RowBox[{"p", ",", "F", ",", "\[Epsilon]"}], "]"}], ";"}]}], "Input",
 CellChangeTimes->CompressedData["
1:eJxTTMoPSmViYGAQBWIQfVK+m4d7/RtHuy05vCA6Qvf3HBB948ul+SD6WBar
Ay+QXt5qDqaX5PtHaAPplk8RYPpNtwST8qY3jhNu+4PpJvWNJ6U2v3H8MO04
mJb8Iug4F0jXBV4C06cK64Wzt7xxVLFaAqbXZJS+LtkKtCdyMpiep6bGMPHq
G0eLH3pgut5v5qVdQLqhdhuYFn0sE7kbSJvYmoDplD3pu02uvXE0cywF0zGG
P26+vA4Uf+p9D0R/yTuo+xZIs3Bv1gfRehu41bIfvXG86SQLpvOT33tOAtJd
l9m8QPTM246fQPSsmt+fQTRbWuHanY/fOAZZMawD0UUv3P8mPH3jOGnSMaZE
IN2bu1IdRLNNltYA0QCmQLSu
  "],
 CellLabel->"In[4]:=",ExpressionUUID->"6e78fb49-dd55-4145-92f6-d81f0c875850"],

Cell[CellGroupData[{

Cell[BoxData["\<\"p declared as a 4-dimensional vector header.\"\>"], "Print",
 CellChangeTimes->{
  3.876903376747521*^9, 3.876976978476327*^9, 3.877066136447813*^9, 
   3.877490032997962*^9, 3.877820935596715*^9, 3.878006918316052*^9, 
   3.878011608364133*^9, 3.878015606541864*^9, {3.878356953462988*^9, 
   3.8783569883214827`*^9}, 3.878357362355804*^9, 3.878357455855433*^9, 
   3.878616183978648*^9, 3.878856935063778*^9},
 CellLabel->
  "During evaluation of \
In[4]:=",ExpressionUUID->"716ef0f6-eb1a-4a5f-8486-24a431120ac9"],

Cell[BoxData["\<\"q declared as a 4-dimensional vector header.\"\>"], "Print",
 CellChangeTimes->{
  3.876903376747521*^9, 3.876976978476327*^9, 3.877066136447813*^9, 
   3.877490032997962*^9, 3.877820935596715*^9, 3.878006918316052*^9, 
   3.878011608364133*^9, 3.878015606541864*^9, {3.878356953462988*^9, 
   3.8783569883214827`*^9}, 3.878357362355804*^9, 3.878357455855433*^9, 
   3.878616183978648*^9, 3.878856935065748*^9},
 CellLabel->
  "During evaluation of \
In[4]:=",ExpressionUUID->"765dbea9-a43c-47b5-bb45-605e57bb0e83"],

Cell[BoxData["\<\"l declared as a 4-dimensional vector header.\"\>"], "Print",
 CellChangeTimes->{
  3.876903376747521*^9, 3.876976978476327*^9, 3.877066136447813*^9, 
   3.877490032997962*^9, 3.877820935596715*^9, 3.878006918316052*^9, 
   3.878011608364133*^9, 3.878015606541864*^9, {3.878356953462988*^9, 
   3.8783569883214827`*^9}, 3.878357362355804*^9, 3.878357455855433*^9, 
   3.878616183978648*^9, 3.878856935067664*^9},
 CellLabel->
  "During evaluation of \
In[4]:=",ExpressionUUID->"1dacef96-4ec0-4bab-b9c1-7da9ef1dc06d"],

Cell[BoxData["\<\"\[Epsilon] declared as a 4-dimensional vector \
header.\"\>"], "Print",
 CellChangeTimes->{
  3.876903376747521*^9, 3.876976978476327*^9, 3.877066136447813*^9, 
   3.877490032997962*^9, 3.877820935596715*^9, 3.878006918316052*^9, 
   3.878011608364133*^9, 3.878015606541864*^9, {3.878356953462988*^9, 
   3.8783569883214827`*^9}, 3.878357362355804*^9, 3.878357455855433*^9, 
   3.878616183978648*^9, 3.878856935068935*^9},
 CellLabel->
  "During evaluation of \
In[4]:=",ExpressionUUID->"1624f703-dd93-484a-afdd-1fee4808092f"],

Cell[BoxData["\<\"v declared as a 4-dimensional vector header.\"\>"], "Print",
 CellChangeTimes->{
  3.876903376747521*^9, 3.876976978476327*^9, 3.877066136447813*^9, 
   3.877490032997962*^9, 3.877820935596715*^9, 3.878006918316052*^9, 
   3.878011608364133*^9, 3.878015606541864*^9, {3.878356953462988*^9, 
   3.8783569883214827`*^9}, 3.878357362355804*^9, 3.878357455855433*^9, 
   3.878616183978648*^9, 3.878856935070199*^9},
 CellLabel->
  "During evaluation of \
In[4]:=",ExpressionUUID->"15a0a61a-9425-4178-b9b0-544cf0689340"],

Cell[BoxData["\<\"w declared as a 4-dimensional vector header.\"\>"], "Print",
 CellChangeTimes->{
  3.876903376747521*^9, 3.876976978476327*^9, 3.877066136447813*^9, 
   3.877490032997962*^9, 3.877820935596715*^9, 3.878006918316052*^9, 
   3.878011608364133*^9, 3.878015606541864*^9, {3.878356953462988*^9, 
   3.8783569883214827`*^9}, 3.878357362355804*^9, 3.878357455855433*^9, 
   3.878616183978648*^9, 3.8788569350715027`*^9},
 CellLabel->
  "During evaluation of \
In[4]:=",ExpressionUUID->"5abefb99-5ff0-4cc3-ad2b-fe03526d4f97"],

Cell[BoxData["\<\"link declared as a 4-dimensional vector header.\"\>"], \
"Print",
 CellChangeTimes->{
  3.876903376747521*^9, 3.876976978476327*^9, 3.877066136447813*^9, 
   3.877490032997962*^9, 3.877820935596715*^9, 3.878006918316052*^9, 
   3.878011608364133*^9, 3.878015606541864*^9, {3.878356953462988*^9, 
   3.8783569883214827`*^9}, 3.878357362355804*^9, 3.878357455855433*^9, 
   3.878616183978648*^9, 3.878856935072904*^9},
 CellLabel->
  "During evaluation of \
In[4]:=",ExpressionUUID->"ee6e238a-a356-4628-b093-70b21860e0d4"],

Cell[BoxData["\<\"as declared as a 4-dimensional vector header.\"\>"], "Print",
 CellChangeTimes->{
  3.876903376747521*^9, 3.876976978476327*^9, 3.877066136447813*^9, 
   3.877490032997962*^9, 3.877820935596715*^9, 3.878006918316052*^9, 
   3.878011608364133*^9, 3.878015606541864*^9, {3.878356953462988*^9, 
   3.8783569883214827`*^9}, 3.878357362355804*^9, 3.878357455855433*^9, 
   3.878616183978648*^9, 3.878856935074198*^9},
 CellLabel->
  "During evaluation of \
In[4]:=",ExpressionUUID->"3b64ed1d-f0a4-48df-9711-5671fb56b34a"],

Cell[BoxData["\<\"F declared as a 4-dimensional rank-2 tensor header.\"\>"], \
"Print",
 CellChangeTimes->{
  3.876903376747521*^9, 3.876976978476327*^9, 3.877066136447813*^9, 
   3.877490032997962*^9, 3.877820935596715*^9, 3.878006918316052*^9, 
   3.878011608364133*^9, 3.878015606541864*^9, {3.878356953462988*^9, 
   3.8783569883214827`*^9}, 3.878357362355804*^9, 3.878357455855433*^9, 
   3.878616183978648*^9, 3.878856935075533*^9},
 CellLabel->
  "During evaluation of \
In[4]:=",ExpressionUUID->"33792671-04a3-4814-94e4-7bcbd278dfc7"],

Cell[BoxData["\<\"H declared as a 4-dimensional rank-2 tensor header.\"\>"], \
"Print",
 CellChangeTimes->{
  3.876903376747521*^9, 3.876976978476327*^9, 3.877066136447813*^9, 
   3.877490032997962*^9, 3.877820935596715*^9, 3.878006918316052*^9, 
   3.878011608364133*^9, 3.878015606541864*^9, {3.878356953462988*^9, 
   3.8783569883214827`*^9}, 3.878357362355804*^9, 3.878357455855433*^9, 
   3.878616183978648*^9, 3.878856935076885*^9},
 CellLabel->
  "During evaluation of \
In[4]:=",ExpressionUUID->"f90d2636-417e-41b2-bd39-7c6a63142241"],

Cell[BoxData["\<\"W declared as a 4-dimensional rank-2 tensor header.\"\>"], \
"Print",
 CellChangeTimes->{
  3.876903376747521*^9, 3.876976978476327*^9, 3.877066136447813*^9, 
   3.877490032997962*^9, 3.877820935596715*^9, 3.878006918316052*^9, 
   3.878011608364133*^9, 3.878015606541864*^9, {3.878356953462988*^9, 
   3.8783569883214827`*^9}, 3.878357362355804*^9, 3.878357455855433*^9, 
   3.878616183978648*^9, 3.8788569350782003`*^9},
 CellLabel->
  "During evaluation of \
In[4]:=",ExpressionUUID->"ddd5c770-6cb5-45b0-9e1c-ee2607b2676a"],

Cell[BoxData["\<\"V declared as a 4-dimensional rank-2 tensor header.\"\>"], \
"Print",
 CellChangeTimes->{
  3.876903376747521*^9, 3.876976978476327*^9, 3.877066136447813*^9, 
   3.877490032997962*^9, 3.877820935596715*^9, 3.878006918316052*^9, 
   3.878011608364133*^9, 3.878015606541864*^9, {3.878356953462988*^9, 
   3.8783569883214827`*^9}, 3.878357362355804*^9, 3.878357455855433*^9, 
   3.878616183978648*^9, 3.878856935079527*^9},
 CellLabel->
  "During evaluation of \
In[4]:=",ExpressionUUID->"a897e7c6-7d83-4245-967e-911b7b328b17"],

Cell[BoxData["\<\"S declared as a 4-dimensional rank-2 tensor header.\"\>"], \
"Print",
 CellChangeTimes->{
  3.876903376747521*^9, 3.876976978476327*^9, 3.877066136447813*^9, 
   3.877490032997962*^9, 3.877820935596715*^9, 3.878006918316052*^9, 
   3.878011608364133*^9, 3.878015606541864*^9, {3.878356953462988*^9, 
   3.8783569883214827`*^9}, 3.878357362355804*^9, 3.878357455855433*^9, 
   3.878616183978648*^9, 3.8788569350808153`*^9},
 CellLabel->
  "During evaluation of \
In[4]:=",ExpressionUUID->"876774a5-3896-4af6-9e3d-204b28e78360"]
}, Open  ]]
}, Open  ]]
}, Closed]],

Cell[CellGroupData[{

Cell["SubFunctions", "Section",
 CellChangeTimes->{{3.810011820953319*^9, 
  3.810011824102497*^9}},ExpressionUUID->"b2a7b427-35e1-4c90-a40a-\
a7c43f50ca5a"],

Cell[CellGroupData[{

Cell["general functions", "Subsection",
 CellChangeTimes->{{3.8717162484953003`*^9, 
  3.8717162609396152`*^9}},ExpressionUUID->"b7909353-edfe-4489-b115-\
b6a172af6d7d"],

Cell[BoxData[
 RowBox[{
  RowBox[{"nicevs", "=", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{
      RowBox[{"v", "[", "i_", "]"}], ":>", "v"}], ",", 
     RowBox[{
      RowBox[{"S", "[", "i_", "]"}], ":>", "S"}], ",", 
     RowBox[{
      RowBox[{"c", "[", "i_", "]"}], ":>", 
      SubscriptBox["c", "i"]}], ",", 
     RowBox[{
      RowBox[{"as", "[", "i_", "]"}], ":>", "a"}]}], "}"}]}], ";"}]], "Input",\

 CellChangeTimes->{{3.877388939506537*^9, 3.877388949032188*^9}, {
  3.8786378572270403`*^9, 3.878637863818118*^9}},
 CellLabel->"In[9]:=",ExpressionUUID->"aae90991-5bc3-401d-87f3-7f8422f12676"],

Cell[BoxData[{
 RowBox[{"ClearAll", "[", 
  RowBox[{"SimplifyMono", ",", "SimplifyMonof"}], 
  "]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"SimplifyMono", "[", "f_", "]"}], ":=", 
  RowBox[{"Module", "[", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{"res", "=", 
      RowBox[{"f", "//", "Expand"}]}], "}"}], ",", 
    RowBox[{
     RowBox[{"If", "[", 
      RowBox[{
       RowBox[{
        RowBox[{"Head", "[", "res", "]"}], "===", "Plus"}], ",", 
       RowBox[{"res", "=", 
        RowBox[{
         RowBox[{
          RowBox[{"(", 
           RowBox[{"List", "@@", "res"}], ")"}], "//", "Simplify"}], "//", 
         "Total"}]}], ",", 
       RowBox[{"res", "=", 
        RowBox[{"Simplify", "[", "res", "]"}]}]}], "]"}], ";", "res"}]}], 
   "]"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"SimplifyMonof", "[", "f_", "]"}], ":=", 
  RowBox[{"Module", "[", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{"res", "=", 
      RowBox[{"f", "//", "Expand"}]}], "}"}], ",", 
    RowBox[{
     RowBox[{"If", "[", 
      RowBox[{
       RowBox[{
        RowBox[{"Head", "[", "res", "]"}], "===", "Plus"}], ",", 
       RowBox[{"res", "=", 
        RowBox[{
         RowBox[{
          RowBox[{"(", 
           RowBox[{"List", "@@", "res"}], ")"}], "//", "Simplify"}], "//", 
         "Total"}]}], ",", 
       RowBox[{"res", "=", 
        RowBox[{"FullSimplify", "[", "res", "]"}]}]}], "]"}], ";", "res"}]}], 
   "]"}]}]}], "Input",
 CellChangeTimes->{{3.871038879132368*^9, 3.871038905309572*^9}},
 CellLabel->"In[10]:=",ExpressionUUID->"b0fdc6fd-2a5b-4d84-97a3-03bddc4e6893"],

Cell[BoxData[{
 RowBox[{"ClearAll", "[", 
  RowBox[{"Collectj", ",", "Collectjf"}], "]"}], "\[IndentingNewLine]", 
 RowBox[{"Collectj", ":=", 
  RowBox[{
   RowBox[{"Collect", "[", 
    RowBox[{"#", ",", 
     RowBox[{"j", "[", "__", "]"}], ",", "Simplify"}], "]"}], 
   "&"}]}], "\[IndentingNewLine]", 
 RowBox[{"Collectjf", ":=", 
  RowBox[{
   RowBox[{"Collect", "[", 
    RowBox[{"#", ",", 
     RowBox[{"j", "[", "__", "]"}], ",", "FullSimplify"}], "]"}], 
   "&"}]}]}], "Input",
 CellChangeTimes->{{3.870563255866166*^9, 3.870563259484146*^9}, {
   3.870655391967127*^9, 3.87065539655599*^9}, 3.870655469270833*^9},
 CellLabel->"In[13]:=",ExpressionUUID->"277d5114-6840-4b27-9460-eac0f86cbc2c"],

Cell[BoxData[{
 RowBox[{"ClearAll", "[", 
  RowBox[{"Collectb", ",", "Collectbf"}], "]"}], "\[IndentingNewLine]", 
 RowBox[{"Collectb", ":=", 
  RowBox[{
   RowBox[{"Collect", "[", 
    RowBox[{"#", ",", 
     RowBox[{"B", "[", "__", "]"}]}], "]"}], "&"}]}], "\[IndentingNewLine]", 
 RowBox[{"Collectbf", ":=", 
  RowBox[{
   RowBox[{"Collect", "[", 
    RowBox[{"#", ",", 
     RowBox[{"B", "[", "__", "]"}], ",", 
     RowBox[{
      RowBox[{"(", 
       RowBox[{
        RowBox[{"Factor", "[", "#1", "]"}], "//", "FullSimplify"}], ")"}], 
      "&"}]}], "]"}], "&"}]}]}], "Input",
 CellChangeTimes->{{3.8705913651404657`*^9, 3.870591383682583*^9}, 
   3.870655472075412*^9, {3.870655517557816*^9, 3.870655550957642*^9}, {
   3.876611424237235*^9, 3.876611424429071*^9}},
 CellLabel->"In[16]:=",ExpressionUUID->"ff95a306-8b51-46ee-8bc6-3e57f67ea494"],

Cell[BoxData[{
 RowBox[{"ClearAll", "[", "Casesdot", "]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"Casesdot", "[", "f_", "]"}], ":=", 
  RowBox[{
   RowBox[{"Cases", "[", 
    RowBox[{"f", ",", 
     RowBox[{"dot", "[", "__", "]"}], ",", 
     RowBox[{"{", 
      RowBox[{"0", ",", "\[Infinity]"}], "}"}]}], "]"}], "//", 
   "Union"}]}]}], "Input",
 CellChangeTimes->{{3.871860800284142*^9, 3.871860849326124*^9}, {
   3.871860880863056*^9, 3.8718609082263327`*^9}, 3.872119829251048*^9},
 CellLabel->"In[19]:=",ExpressionUUID->"a76cbf43-accd-494d-bf74-aaf9211a3950"],

Cell[BoxData[
 RowBox[{"(*", 
  RowBox[{
   RowBox[{"rmzero", "=", 
    RowBox[{"{", 
     RowBox[{
      RowBox[{
       RowBox[{"dot", "[", 
        RowBox[{"v", ",", 
         RowBox[{"F", "[", "i_", "]"}], ",", "v"}], "]"}], ":>", " ", "0"}], 
      ",", 
      RowBox[{
       RowBox[{"dot", "[", 
        RowBox[{
         RowBox[{"p", "[", "]"}], ",", "f__", ",", "v"}], "]"}], ":>", " ", 
       "0"}]}], "}"}]}], ";"}], "*)"}]], "Input",
 CellChangeTimes->{3.871297375601942*^9},
 CellLabel->"In[21]:=",ExpressionUUID->"2787e42e-631b-4f49-a71c-b7b0e075493a"],

Cell[BoxData[{
 RowBox[{
  RowBox[{"ClearAll", "[", 
   RowBox[{"replace", ",", "repg"}], "]"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"replace", "[", 
    RowBox[{"otherDDMOrder_", ",", "n_"}], "]"}], ":=", 
   RowBox[{"Table", "[", 
    RowBox[{
     RowBox[{
      RowBox[{
       RowBox[{"(", 
        RowBox[{"p", "/@", 
         RowBox[{"Range", "[", 
          RowBox[{"n", "-", "1"}], "]"}]}], ")"}], "[", 
       RowBox[{"[", "i", "]"}], "]"}], "\[Rule]", " ", 
      RowBox[{"otherDDMOrder", "[", 
       RowBox[{"[", "i", "]"}], "]"}]}], ",", 
     RowBox[{"{", 
      RowBox[{"i", ",", 
       RowBox[{"n", "-", "1"}]}], "}"}]}], "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"repg", "[", 
   RowBox[{"a_", ",", "otherDDMOrder__"}], "]"}], ":=", 
  RowBox[{"Module", "[", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{"gg", ",", "ggod"}], "}"}], ",", 
    RowBox[{
     RowBox[{"gg", "=", 
      RowBox[{"a", "/@", 
       RowBox[{"{", "otherDDMOrder", "}"}]}]}], ";", 
     RowBox[{"ggod", "=", 
      RowBox[{"Sort", "[", "gg", "]"}]}], ";", 
     RowBox[{"Table", "[", 
      RowBox[{
       RowBox[{
        RowBox[{
         RowBox[{"(", "ggod", ")"}], "[", 
         RowBox[{"[", "i", "]"}], "]"}], "\[Rule]", " ", 
        RowBox[{
         RowBox[{"(", "gg", ")"}], "[", 
         RowBox[{"[", "i", "]"}], "]"}]}], ",", 
       RowBox[{"{", 
        RowBox[{"i", ",", 
         RowBox[{"Length", "@", "gg"}]}], "}"}]}], "]"}]}]}], 
   "]"}]}]}], "Input",
 CellChangeTimes->{{3.853809980519072*^9, 3.8538099861376333`*^9}},
 CellLabel->"In[22]:=",ExpressionUUID->"b4037ea5-93ff-4f7e-a16c-2ab7e7c858e0"],

Cell[BoxData[{
 RowBox[{"ClearAll", "[", 
  RowBox[{"dotOnshell", ",", "vonshell"}], "]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"dotOnshell", "[", "n_", "]"}], ":=", 
  RowBox[{"{", 
   RowBox[{
    RowBox[{
     RowBox[{"dot", "[", 
      RowBox[{
       RowBox[{"p", "[", "n", "]"}], ",", "f_"}], "]"}], "\[RuleDelayed]", 
     " ", 
     RowBox[{"-", 
      RowBox[{"Sum", "[", 
       RowBox[{
        RowBox[{"dot", "[", 
         RowBox[{
          RowBox[{"p", "[", "i", "]"}], ",", "f"}], "]"}], ",", 
        RowBox[{"{", 
         RowBox[{"i", ",", 
          RowBox[{"n", "-", "1"}]}], "}"}]}], "]"}]}]}], ",", 
    RowBox[{
     RowBox[{"dot", "[", 
      RowBox[{"f_", ",", 
       RowBox[{"p", "[", "n", "]"}]}], "]"}], "\[RuleDelayed]", " ", 
     RowBox[{"-", 
      RowBox[{"Sum", "[", 
       RowBox[{
        RowBox[{"dot", "[", 
         RowBox[{
          RowBox[{"p", "[", "i", "]"}], ",", "f"}], "]"}], ",", 
        RowBox[{"{", 
         RowBox[{"i", ",", 
          RowBox[{"n", "-", "1"}]}], "}"}]}], "]"}]}]}], ",", 
    RowBox[{
     RowBox[{"dot", "[", 
      RowBox[{
       RowBox[{"p", "[", "0", "]"}], ",", 
       RowBox[{"\[Epsilon]", "[", 
        RowBox[{"p", "[", "n", "]"}], "]"}]}], "]"}], "\[RuleDelayed]", " ", 
     RowBox[{"-", 
      RowBox[{"Sum", "[", 
       RowBox[{
        RowBox[{"dot", "[", 
         RowBox[{
          RowBox[{"p", "[", "i", "]"}], ",", 
          RowBox[{"\[Epsilon]", "[", 
           RowBox[{"p", "[", "n", "]"}], "]"}]}], "]"}], ",", 
        RowBox[{"{", 
         RowBox[{"i", ",", "1", ",", 
          RowBox[{"n", "-", "1"}]}], "}"}]}], "]"}]}]}], ",", 
    RowBox[{
     RowBox[{"dot", "[", 
      RowBox[{
       RowBox[{"\[Epsilon]", "[", 
        RowBox[{"p", "[", "n", "]"}], "]"}], ",", 
       RowBox[{"p", "[", "0", "]"}]}], "]"}], "\[RuleDelayed]", " ", 
     RowBox[{"-", 
      RowBox[{"Sum", "[", 
       RowBox[{
        RowBox[{"dot", "[", 
         RowBox[{
          RowBox[{"p", "[", "i", "]"}], ",", 
          RowBox[{"\[Epsilon]", "[", 
           RowBox[{"p", "[", "n", "]"}], "]"}]}], "]"}], ",", 
        RowBox[{"{", 
         RowBox[{"i", ",", "1", ",", 
          RowBox[{"n", "-", "1"}]}], "}"}]}], "]"}]}]}]}], 
   "}"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"vonshell", "[", 
   RowBox[{"n_", ",", "i_"}], "]"}], ":=", 
  RowBox[{"{", 
   RowBox[{
    RowBox[{"dot", "[", 
     RowBox[{"v", ",", 
      RowBox[{"p", "[", "i", "]"}]}], "]"}], "\[RuleDelayed]", " ", 
    RowBox[{"(", 
     RowBox[{
      RowBox[{"dot", "[", 
       RowBox[{"v", ",", 
        RowBox[{"p", "[", "i", "]"}]}], "]"}], "-", 
      RowBox[{"Sum", "[", 
       RowBox[{
        RowBox[{"dot", "[", 
         RowBox[{"v", ",", 
          RowBox[{"p", "[", "j", "]"}]}], "]"}], ",", 
        RowBox[{"{", 
         RowBox[{"j", ",", "1", ",", 
          RowBox[{"n", "-", "1"}]}], "}"}]}], "]"}]}], ")"}]}], 
   "}"}]}]}], "Input",
 CellChangeTimes->{{3.727163684521564*^9, 3.727163712580194*^9}, 
   3.728198771127473*^9, {3.7282976424483356`*^9, 3.728297678974709*^9}, {
   3.728297723296649*^9, 3.72829773196879*^9}, {3.7492963246076107`*^9, 
   3.749296346599493*^9}, {3.7492969402526007`*^9, 3.749296945367785*^9}, {
   3.756962173926325*^9, 3.756962173952697*^9}, {3.756962214008494*^9, 
   3.756962214036718*^9}, {3.756962285466909*^9, 3.7569622869241734`*^9}, {
   3.756970904201673*^9, 3.7569709322363663`*^9}, {3.759113304523664*^9, 
   3.759113331527665*^9}, {3.759113382631379*^9, 3.759113498024493*^9}, {
   3.759592650632361*^9, 3.759592657996381*^9}, {3.810004273599478*^9, 
   3.8100042908157053`*^9}, {3.813368130768548*^9, 3.813368161218802*^9}, {
   3.8133682014741793`*^9, 3.813368212397605*^9}, {3.813542982230701*^9, 
   3.813543013179331*^9}, {3.813546153285891*^9, 3.813546158120234*^9}, {
   3.813546308456645*^9, 3.8135463101535473`*^9}, {3.8135464926562147`*^9, 
   3.813546546885747*^9}, 3.813546667616501*^9, {3.813547074493762*^9, 
   3.8135470808592043`*^9}, {3.813547399867567*^9, 3.813547441608583*^9}, {
   3.813559656501801*^9, 3.813559667068569*^9}, {3.8135597068041677`*^9, 
   3.813559710282649*^9}, {3.813559768037219*^9, 3.813559779622561*^9}, {
   3.813560124477251*^9, 3.813560131135003*^9}, {3.813560238138142*^9, 
   3.813560266973859*^9}, {3.813560313088909*^9, 3.81356032625429*^9}, {
   3.8135603625794773`*^9, 3.813560379883116*^9}, {3.813562756751007*^9, 
   3.8135627570797586`*^9}, 3.813587217305232*^9, {3.813631538481387*^9, 
   3.813631541035822*^9}, {3.8136340222518473`*^9, 3.813634050518487*^9}, {
   3.843431280830508*^9, 3.843431302343697*^9}, {3.843553240936262*^9, 
   3.8435532494635687`*^9}, {3.843553679143483*^9, 3.843553679792428*^9}, {
   3.843553831340781*^9, 3.843553834894973*^9}},
 CellLabel->"In[25]:=",ExpressionUUID->"6d280527-7a65-48d0-a19d-73ee85d09955"],

Cell[BoxData[{
 RowBox[{"ClearAll", "[", 
  RowBox[{
  "sortS", ",", "zeroMomentum", ",", "onshell", ",", "onshellQCD", ",", 
   "massless"}], "]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"sortS", "=", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"s", "[", 
      RowBox[{"i_", ",", "j_"}], "]"}], "\[RuleDelayed]", 
     RowBox[{"Sort", "[", 
      RowBox[{"s", "[", 
       RowBox[{"i", ",", "j"}], "]"}], "]"}]}], "}"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"zeroMomentum", "[", "n_", "]"}], ":=", 
  RowBox[{
   RowBox[{"s", "[", 
    RowBox[{"i_", ",", "n"}], "]"}], "\[RuleDelayed]", 
   RowBox[{"-", 
    RowBox[{"Sum", "[", 
     RowBox[{
      RowBox[{"s", "[", 
       RowBox[{"i", ",", "j"}], "]"}], ",", 
      RowBox[{"{", 
       RowBox[{"j", ",", 
        RowBox[{"n", "-", "1"}]}], "}"}]}], 
     "]"}]}]}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"onshell", "[", "n_", "]"}], ":=", 
  RowBox[{
   RowBox[{"s", "[", 
    RowBox[{
     RowBox[{"n", "-", "2"}], ",", 
     RowBox[{"n", "-", "1"}]}], "]"}], "\[Rule]", "  ", 
   RowBox[{
    RowBox[{"-", 
     RowBox[{"Total", "[", 
      RowBox[{
       RowBox[{"Table", "[", 
        RowBox[{
         RowBox[{"Table", "[", 
          RowBox[{
           RowBox[{"s", "[", 
            RowBox[{"i", ",", "j"}], "]"}], ",", 
           RowBox[{"{", 
            RowBox[{"i", ",", 
             RowBox[{"j", "-", "1"}]}], "}"}]}], "]"}], ",", 
         RowBox[{"{", 
          RowBox[{"j", ",", 
           RowBox[{"n", "-", "1"}]}], "}"}]}], "]"}], "//", "Flatten"}], 
      "]"}]}], "+", 
    RowBox[{"s", "[", 
     RowBox[{
      RowBox[{"n", "-", "2"}], ",", 
      RowBox[{"n", "-", "1"}]}], "]"}]}]}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"onshellQCD", "[", "n_", "]"}], ":=", 
  RowBox[{
   RowBox[{"s", "[", 
    RowBox[{
     RowBox[{"n", "-", "2"}], ",", 
     RowBox[{"n", "-", "1"}]}], "]"}], "\[Rule]", "  ", 
   RowBox[{
    RowBox[{"-", 
     RowBox[{"Total", "[", 
      RowBox[{
       RowBox[{"Table", "[", 
        RowBox[{
         RowBox[{"Table", "[", 
          RowBox[{
           RowBox[{"s", "[", 
            RowBox[{"i", ",", "j"}], "]"}], ",", 
           RowBox[{"{", 
            RowBox[{"i", ",", "0", ",", 
             RowBox[{"j", "-", "1"}]}], "}"}]}], "]"}], ",", 
         RowBox[{"{", 
          RowBox[{"j", ",", 
           RowBox[{"n", "-", "1"}]}], "}"}]}], "]"}], "//", "Flatten"}], 
      "]"}]}], "+", 
    RowBox[{"s", "[", 
     RowBox[{
      RowBox[{"n", "-", "2"}], ",", 
      RowBox[{"n", "-", "1"}]}], "]"}]}]}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"massless", "=", 
   RowBox[{
    RowBox[{"s", "[", 
     RowBox[{"i_", ",", "i_"}], "]"}], "\[RuleDelayed]", "0"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{"ClearAll", "[", 
  RowBox[{"sortP", ",", "sortE"}], "]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"sortP", "[", 
   RowBox[{"li_", ",", "lr_"}], "]"}], ":=", 
  RowBox[{"SortBy", "[", 
   RowBox[{"li", ",", " ", 
    RowBox[{
     RowBox[{"Position", "[", 
      RowBox[{"lr", ",", 
       RowBox[{"(", 
        RowBox[{"First", "@", "#"}], ")"}]}], "]"}], "&"}]}], 
   "]"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"sortE", "[", 
   RowBox[{"li_", ",", "lr_"}], "]"}], ":=", 
  RowBox[{"SortBy", "[", 
   RowBox[{"li", ",", " ", 
    RowBox[{
     RowBox[{"Position", "[", 
      RowBox[{"lr", ",", 
       RowBox[{"(", 
        RowBox[{"First", "@@", "#"}], ")"}]}], "]"}], "&"}]}], 
   "]"}]}], "\[IndentingNewLine]", 
 RowBox[{"ClearAll", "[", "repBack", "]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"repBack", "=", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{
      RowBox[{"Subscript", "[", 
       RowBox[{"a_", ",", "i_"}], "]"}], ":>", " ", 
      RowBox[{"a", "[", "i", "]"}]}], ",", 
     RowBox[{"CenterDot", "->", " ", "dot"}]}], "}"}]}], 
  ";"}], "\[IndentingNewLine]"}], "Input",
 CellChangeTimes->{
  3.727163681618944*^9, {3.749179480748872*^9, 3.749179491659102*^9}, {
   3.749296395909049*^9, 3.7492964230074463`*^9}, {3.74929688390792*^9, 
   3.74929689475134*^9}, 3.756962173957769*^9, 3.7569622140447397`*^9, {
   3.756962309850726*^9, 3.7569623219178553`*^9}, {3.75697119019627*^9, 
   3.756971194962592*^9}, {3.810006123538918*^9, 3.810006130187482*^9}, {
   3.813643784231852*^9, 3.813643813331348*^9}, 3.841472859500243*^9, {
   3.851849638478299*^9, 3.851849659664133*^9}, {3.854063182750596*^9, 
   3.854063189346609*^9}},
 CellLabel->"In[28]:=",ExpressionUUID->"0e2780f7-f3c5-41e4-a82a-2661c1254c1e"],

Cell[BoxData[{
 RowBox[{"ClearAll", "[", "V2spBracket", "]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"V2spBracket", "=", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{
      RowBox[{"J", "[", 
       RowBox[{"_", ",", "f_", ",", "m_"}], "]"}], "\[RuleDelayed]", " ", 
      RowBox[{"spBracket", "[", 
       RowBox[{
        RowBox[{"spB", "[", "\[Beta]", "]"}], ",", 
        RowBox[{"f", "/.", 
         RowBox[{
          RowBox[{"CircleTimes", "[", "g___", "]"}], "\[RuleDelayed]", " ", 
          "g"}]}], ",", 
        RowBox[{"spA", "[", "\[Alpha]", "]"}]}], "]"}]}], ",", 
     RowBox[{
      RowBox[{"J", "[", 
       RowBox[{"_", ",", "f_"}], "]"}], "\[RuleDelayed]", " ", 
      RowBox[{"spBracket", "[", 
       RowBox[{
        RowBox[{"spB", "[", "\[Beta]", "]"}], ",", 
        RowBox[{"f", "/.", 
         RowBox[{
          RowBox[{"CircleTimes", "[", "g___", "]"}], "\[RuleDelayed]", " ", 
          "g"}]}], ",", 
        RowBox[{"spA", "[", "\[Alpha]", "]"}]}], "]"}]}]}], "}"}]}], 
  ";"}]}], "Input",
 CellChangeTimes->{{3.849943435749509*^9, 3.8499434443014603`*^9}},
 CellLabel->"In[39]:=",ExpressionUUID->"c9dd0306-42c7-4192-b891-8337c9f7440c"],

Cell[BoxData[{
 RowBox[{"ClearAll", "[", 
  RowBox[{"cyclePermute", ",", "cyclePermuteSum"}], 
  "]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"cyclePermute", "[", "n_", "]"}], ":=", 
  RowBox[{"Module", "[", 
   RowBox[{
    RowBox[{"{", "list", "}"}], ",", 
    RowBox[{
     RowBox[{"list", "=", 
      RowBox[{"Permute", "[", " ", 
       RowBox[{
        RowBox[{"Table", "[", 
         RowBox[{
          RowBox[{"p", "[", "i", "]"}], ",", 
          RowBox[{"{", 
           RowBox[{"i", ",", "n"}], "}"}]}], "]"}], ",", " ", 
        RowBox[{"Cycles", "[", 
         RowBox[{"{", 
          RowBox[{"Table", "[", 
           RowBox[{"i", ",", 
            RowBox[{"{", 
             RowBox[{"i", ",", "n"}], "}"}]}], "]"}], "}"}], "]"}]}], "]"}]}],
      ";", 
     RowBox[{"Table", "[", 
      RowBox[{
       RowBox[{"Rule", "[", 
        RowBox[{
         RowBox[{"p", "[", "i", "]"}], ",", 
         RowBox[{"list", "[", 
          RowBox[{"[", "i", "]"}], "]"}]}], "]"}], ",", 
       RowBox[{"{", 
        RowBox[{"i", ",", "n"}], "}"}]}], "]"}]}]}], 
   "]"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"cyclePermuteSum", "[", 
   RowBox[{"f_", ",", "n_"}], "]"}], ":=", 
  RowBox[{"Module", "[", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{"fsum", ",", 
      RowBox[{"g", "=", 
       RowBox[{"Table", "[", 
        RowBox[{"0", ",", 
         RowBox[{"{", 
          RowBox[{"i", ",", "n"}], "}"}]}], "]"}]}]}], "}"}], ",", 
    RowBox[{
     RowBox[{
      RowBox[{"g", "[", 
       RowBox[{"[", "1", "]"}], "]"}], "=", "f"}], ";", 
     RowBox[{"Do", "[", 
      RowBox[{
       RowBox[{
        RowBox[{"g", "[", 
         RowBox[{"[", 
          RowBox[{"i", "+", "1"}], "]"}], "]"}], "=", 
        RowBox[{
         RowBox[{"g", "[", 
          RowBox[{"[", "i", "]"}], "]"}], "/.", 
         RowBox[{"cyclePermute", "[", "n", "]"}]}]}], ",", 
       RowBox[{"{", 
        RowBox[{"i", ",", 
         RowBox[{"n", "-", "1"}]}], "}"}]}], "]"}], ";", " ", 
     RowBox[{"fsum", "=", 
      RowBox[{"Sum", "[", 
       RowBox[{
        RowBox[{"g", "[", 
         RowBox[{"[", "i", "]"}], "]"}], ",", 
        RowBox[{"{", 
         RowBox[{"i", ",", "n"}], "}"}]}], "]"}]}]}]}], "]"}]}]}], "Input",
 CellChangeTimes->{3.7595925973087378`*^9},
 CellLabel->"In[41]:=",ExpressionUUID->"766abd2e-1994-4be7-9ee6-2a6d0f82c59e"],

Cell[BoxData[{
 RowBox[{"ClearAll", "[", 
  RowBox[{"leadingSeries", ",", "LdTerm"}], "]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"leadingSeries", "[", 
   RowBox[{"expr_", ",", 
    RowBox[{"{", 
     RowBox[{"x_", ",", "x0_"}], "}"}]}], "]"}], ":=", 
  RowBox[{"Normal", "[", 
   RowBox[{
    RowBox[{"expr", "/.", 
     RowBox[{"x", "\[Rule]", 
      RowBox[{"Series", "[", 
       RowBox[{"x", ",", 
        RowBox[{"{", 
         RowBox[{"x", ",", "x0", ",", "1"}], "}"}]}], "]"}]}]}], "/.", 
    RowBox[{
     RowBox[{
      RowBox[{"Verbatim", "[", "SeriesData", "]"}], "[", 
      RowBox[{"a__", ",", 
       RowBox[{"{", 
        RowBox[{"b_", ",", "___"}], "}"}], ",", "c__"}], "]"}], 
     "\[RuleDelayed]", 
     RowBox[{"SeriesData", "[", 
      RowBox[{"a", ",", 
       RowBox[{"{", "b", "}"}], ",", "c"}], "]"}]}]}], "]"}]}], "\n", 
 RowBox[{
  RowBox[{"LdTerm", "[", 
   RowBox[{"f_", ",", "var_"}], "]"}], ":=", 
  RowBox[{
   RowBox[{"leadingSeries", "[", 
    RowBox[{"f", ",", 
     RowBox[{"{", 
      RowBox[{"var", ",", "\[Infinity]"}], "}"}]}], "]"}], "//", 
   "Normal"}]}]}], "Input",
 CellLabel->"In[44]:=",ExpressionUUID->"f32e72bc-d9f0-4994-aff5-11032f993f2a"]
}, Open  ]],

Cell[CellGroupData[{

Cell["Expand Tensors", "Subsection",
 CellChangeTimes->{{3.871715923985506*^9, 
  3.8717159306720257`*^9}},ExpressionUUID->"19c23075-0448-439e-b990-\
e9e57cef0c14"],

Cell[BoxData[{
 RowBox[{"ClearAll", "[", 
  RowBox[{"expandTdot", ",", "expandT"}], "]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"expandTdot", "[", "f_", "]"}], ":=", 
  RowBox[{
   RowBox[{"(", 
    RowBox[{
     RowBox[{
      RowBox[{
       RowBox[{"f", "/.", 
        RowBox[{
         RowBox[{"dot", "[", "g___", "]"}], "\[RuleDelayed]", " ", 
         RowBox[{"expandTensor", "[", 
          RowBox[{"dot", "[", "g", "]"}], "]"}]}]}], "/.", 
       RowBox[{
        RowBox[{
         RowBox[{"F", "[", "i_", "]"}], "[", 
         RowBox[{"a_", ",", "b_"}], "]"}], "\[RuleDelayed]", " ", 
        RowBox[{
         RowBox[{
          RowBox[{
           RowBox[{"p", "[", "i", "]"}], "[", "a", "]"}], 
          RowBox[{
           RowBox[{"\[Epsilon]", "[", "i", "]"}], "[", "b", "]"}]}], "-", 
         RowBox[{
          RowBox[{
           RowBox[{"\[Epsilon]", "[", "i", "]"}], "[", "a", "]"}], 
          RowBox[{
           RowBox[{"p", "[", "i", "]"}], "[", "b", "]"}]}]}]}]}], "/.", 
      RowBox[{
       RowBox[{
        RowBox[{"W", "[", "i_", "]"}], "[", 
        RowBox[{"a_", ",", "b_"}], "]"}], "\[RuleDelayed]", " ", 
       RowBox[{
        RowBox[{
         RowBox[{
          RowBox[{"p", "[", "i", "]"}], "[", "a", "]"}], 
         RowBox[{
          RowBox[{"v", "[", "i", "]"}], "[", "b", "]"}]}], "-", 
        RowBox[{
         RowBox[{
          RowBox[{"v", "[", "i", "]"}], "[", "a", "]"}], 
         RowBox[{
          RowBox[{"p", "[", "i", "]"}], "[", "b", "]"}]}]}]}]}], "/.", 
     RowBox[{
      RowBox[{
       RowBox[{"V", "[", "i___", "]"}], "[", 
       RowBox[{"a_", ",", "b_"}], "]"}], "\[RuleDelayed]", " ", 
      RowBox[{
       RowBox[{
        RowBox[{"v", "[", "0", "]"}], "[", "a", "]"}], 
       RowBox[{
        RowBox[{"p", "[", "i", "]"}], "[", "b", "]"}]}]}]}], ")"}], "//", 
   "contract"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"expandT", "[", "f_", "]"}], ":=", " ", 
  RowBox[{"f", "/.", 
   RowBox[{
    RowBox[{"dot", "[", "g___", "]"}], "\[RuleDelayed]", " ", 
    RowBox[{"expandTdot", "[", 
     RowBox[{"dot", "[", "g", "]"}], "]"}]}]}]}], "\[IndentingNewLine]", 
 RowBox[{"ClearAll", "[", 
  RowBox[{"expandTensorGen", ",", "expandF"}], "]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"expandTensorGen", "[", "f_", "]"}], ":=", 
  RowBox[{"Module", "[", 
   RowBox[{
    RowBox[{"{", "res", "}"}], ",", 
    RowBox[{
     RowBox[{"res", "=", 
      RowBox[{"f", "//.", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{
          RowBox[{"Power", "[", 
           RowBox[{
            RowBox[{"dot", "[", "g__", "]"}], ",", "nn_"}], "]"}], ":>", 
          RowBox[{
           RowBox[{"DC", "@@", 
            RowBox[{"Table", "[", 
             RowBox[{
              RowBox[{"dot", "[", "g", "]"}], ",", 
              RowBox[{"{", 
               RowBox[{"ii", ",", "nn"}], "}"}]}], "]"}]}], "/;", 
           RowBox[{"nn", ">", "0"}]}]}], ",", 
         RowBox[{
          RowBox[{"Times", "[", 
           RowBox[{
            RowBox[{"dot", "[", "g__", "]"}], ",", 
            RowBox[{"dot", "[", "h__", "]"}]}], "]"}], ":>", 
          RowBox[{"DC", "[", 
           RowBox[{
            RowBox[{"dot", "[", "g", "]"}], ",", 
            RowBox[{"dot", "[", "h", "]"}]}], "]"}]}], ",", 
         RowBox[{
          RowBox[{"Times", "[", 
           RowBox[{
            RowBox[{"DC", "[", "g__", "]"}], ",", 
            RowBox[{"dot", "[", "h__", "]"}]}], "]"}], ":>", 
          RowBox[{"DC", "[", 
           RowBox[{"g", ",", 
            RowBox[{"dot", "[", "h", "]"}]}], "]"}]}], ",", 
         RowBox[{
          RowBox[{"Times", "[", 
           RowBox[{
            RowBox[{"dot", "[", "h__", "]"}], ",", 
            RowBox[{"DC", "[", "g__", "]"}]}], "]"}], ":>", 
          RowBox[{"DC", "[", 
           RowBox[{
            RowBox[{"dot", "[", "h", "]"}], ",", "g"}], "]"}]}], ",", 
         RowBox[{
          RowBox[{"Times", "[", 
           RowBox[{
            RowBox[{"DC", "[", "h__", "]"}], ",", 
            RowBox[{"DC", "[", "g__", "]"}]}], "]"}], ":>", 
          RowBox[{"DC", "[", 
           RowBox[{"h", ",", "g"}], "]"}]}]}], "}"}]}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"(*", 
      RowBox[{
       RowBox[{"Print", "[", "res", "]"}], ";"}], "*)"}], 
     "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{
       RowBox[{"res", "/.", 
        RowBox[{
         RowBox[{"dot", "[", "g__", "]"}], ":>", 
         RowBox[{"expandTensor", "[", 
          RowBox[{"dot", "[", "g", "]"}], "]"}]}]}], "/.", 
       RowBox[{
        RowBox[{"DC", "[", "g__", "]"}], ":>", 
        RowBox[{"DC", "@@", 
         RowBox[{"Table", "[", 
          RowBox[{
           RowBox[{
            RowBox[{
             RowBox[{"{", "g", "}"}], "[", 
             RowBox[{"[", "ii", "]"}], "]"}], "/.", 
            RowBox[{
             RowBox[{"lI", "[", "ids__", "]"}], ":>", 
             RowBox[{"lI", "[", 
              RowBox[{"ii", ",", "ids"}], "]"}]}]}], ",", 
           RowBox[{"{", 
            RowBox[{"ii", ",", 
             RowBox[{"Length", "@", 
              RowBox[{"{", "g", "}"}]}]}], "}"}]}], "]"}]}]}]}], "/.", 
      RowBox[{"DC", "->", "Times"}]}]}]}], "\[IndentingNewLine]", 
   "]"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"expandF", "[", 
   RowBox[{"f_", ",", "id_"}], "]"}], ":=", 
  RowBox[{"f", "/.", 
   RowBox[{
    RowBox[{
     RowBox[{"F", "[", "id", "]"}], "[", 
     RowBox[{"a_", ",", "b_"}], "]"}], "\[RuleDelayed]", " ", 
    RowBox[{
     RowBox[{
      RowBox[{
       RowBox[{"p", "[", "id", "]"}], "[", "a", "]"}], 
      RowBox[{
       RowBox[{"\[Epsilon]", "[", "id", "]"}], "[", "b", "]"}]}], "-", 
     RowBox[{
      RowBox[{
       RowBox[{"\[Epsilon]", "[", "id", "]"}], "[", "a", "]"}], 
      RowBox[{
       RowBox[{"p", "[", "id", "]"}], "[", "b", 
       "]"}]}]}]}]}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"expandF", "[", "f_", "]"}], ":=", 
  RowBox[{"f", "/.", 
   RowBox[{
    RowBox[{
     RowBox[{"F", "[", "id_", "]"}], "[", 
     RowBox[{"a_", ",", "b_"}], "]"}], "\[RuleDelayed]", " ", 
    RowBox[{
     RowBox[{
      RowBox[{
       RowBox[{"p", "[", "id", "]"}], "[", "a", "]"}], 
      RowBox[{
       RowBox[{"\[Epsilon]", "[", "id", "]"}], "[", "b", "]"}]}], "-", 
     RowBox[{
      RowBox[{
       RowBox[{"\[Epsilon]", "[", "id", "]"}], "[", "a", "]"}], 
      RowBox[{
       RowBox[{"p", "[", "id", "]"}], "[", "b", "]"}]}]}]}]}]}]}], "Input",
 CellChangeTimes->{{3.8519988490005493`*^9, 3.8519988586312313`*^9}, {
  3.852266080976235*^9, 3.852266083544794*^9}, {3.8522661271732883`*^9, 
  3.8522661315239162`*^9}, {3.8522662312904997`*^9, 3.8522662509717417`*^9}, {
  3.852342321299981*^9, 3.852342321961708*^9}, {3.852342379535592*^9, 
  3.852342380584991*^9}, {3.871691418979636*^9, 3.871691419907322*^9}, {
  3.87169145976577*^9, 3.871691475455221*^9}, {3.871691506816244*^9, 
  3.8716916564787827`*^9}, {3.871691706084654*^9, 3.871691733103662*^9}, {
  3.8717067770260687`*^9, 3.871706787951022*^9}, {3.871706897332698*^9, 
  3.871706919266697*^9}},
 CellLabel->"In[47]:=",ExpressionUUID->"41d8c094-84c5-4ee9-aee4-8c40ac1ee5f3"],

Cell[BoxData[{
 RowBox[{"ClearAll", "[", "expandFDirect", "]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"expandFDirect", "[", 
   RowBox[{"f_", ",", "id_"}], "]"}], ":=", 
  RowBox[{"f", "/.", 
   RowBox[{
    RowBox[{"dot", "[", 
     RowBox[{"a__", ",", 
      RowBox[{"F", "[", "id", "]"}], ",", "b__"}], "]"}], "\[RuleDelayed]", 
    " ", 
    RowBox[{
     RowBox[{
      RowBox[{"dot", "[", 
       RowBox[{"a", ",", 
        RowBox[{"p", "[", "id", "]"}]}], "]"}], 
      RowBox[{"dot", "[", 
       RowBox[{
        RowBox[{"\[Epsilon]", "[", "id", "]"}], ",", "b"}], "]"}]}], "-", " ", 
     RowBox[{
      RowBox[{"dot", "[", 
       RowBox[{"a", ",", 
        RowBox[{"\[Epsilon]", "[", "id", "]"}]}], "]"}], 
      RowBox[{"dot", "[", 
       RowBox[{
        RowBox[{"p", "[", "id", "]"}], ",", "b"}], 
       "]"}]}]}]}]}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"expandFDirect", "[", "f_", "]"}], ":=", 
  RowBox[{"f", "//.", 
   RowBox[{
    RowBox[{"dot", "[", 
     RowBox[{"a__", ",", 
      RowBox[{"F", "[", "id_", "]"}], ",", "b__"}], "]"}], "\[RuleDelayed]", 
    " ", 
    RowBox[{
     RowBox[{
      RowBox[{"dot", "[", 
       RowBox[{"a", ",", 
        RowBox[{"p", "[", "id", "]"}]}], "]"}], 
      RowBox[{"dot", "[", 
       RowBox[{
        RowBox[{"\[Epsilon]", "[", "id", "]"}], ",", "b"}], "]"}]}], "-", " ", 
     RowBox[{
      RowBox[{"dot", "[", 
       RowBox[{"a", ",", 
        RowBox[{"\[Epsilon]", "[", "id", "]"}]}], "]"}], 
      RowBox[{"dot", "[", 
       RowBox[{
        RowBox[{"p", "[", "id", "]"}], ",", "b"}], "]"}]}]}]}]}]}]}], "Input",\

 CellChangeTimes->{{3.876777766242668*^9, 3.87677794338896*^9}},
 CellLabel->"In[54]:=",ExpressionUUID->"078d2120-47c9-45fd-a915-fc4e3e8e373e"],

Cell[BoxData[{
 RowBox[{"ClearAll", "[", "dressdot", "]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"dressdot", "[", "f_", "]"}], ":=", 
  RowBox[{"Module", "[", 
   RowBox[{
    RowBox[{"{", "res", "}"}], ",", 
    RowBox[{"res", "=", 
     RowBox[{
      RowBox[{"f", "/.", 
       RowBox[{
        RowBox[{"dot", "[", 
         RowBox[{"g_", ",", 
          RowBox[{"\[Epsilon]", "[", "id_", "]"}]}], "]"}], ":>", 
        RowBox[{
         RowBox[{"g", "[", 
          RowBox[{"lI", "[", 
           RowBox[{"0", ",", "id"}], "]"}], "]"}], 
         RowBox[{
          RowBox[{"\[Epsilon]", "[", "id", "]"}], "[", 
          RowBox[{"lI", "[", 
           RowBox[{"0", ",", "id"}], "]"}], "]"}]}]}]}], "/.", 
      RowBox[{
       RowBox[{"dot", "[", 
        RowBox[{
         RowBox[{"\[Epsilon]", "[", "id_", "]"}], ",", "g_"}], "]"}], ":>", 
       RowBox[{
        RowBox[{"g", "[", 
         RowBox[{"lI", "[", 
          RowBox[{"0", ",", "id"}], "]"}], "]"}], 
        RowBox[{
         RowBox[{"\[Epsilon]", "[", "id", "]"}], "[", 
         RowBox[{"lI", "[", 
          RowBox[{"0", ",", "id"}], "]"}], "]"}]}]}]}]}]}], 
   "\[IndentingNewLine]", "]"}]}], "\[IndentingNewLine]", 
 RowBox[{"ClearAll", "[", "dressdotGen", "]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"dressdotGen", "[", "f_", "]"}], ":=", 
  RowBox[{"Module", "[", 
   RowBox[{
    RowBox[{"{", "res", "}"}], ",", 
    RowBox[{
     RowBox[{"res", "=", 
      RowBox[{"f", "//", "Expand"}]}], ";", 
     RowBox[{"res", "=", 
      RowBox[{"res", "//.", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{
          RowBox[{"Power", "[", 
           RowBox[{
            RowBox[{"dot", "[", "g__", "]"}], ",", "nn_"}], "]"}], ":>", 
          RowBox[{
           RowBox[{"DC", "@@", 
            RowBox[{"Table", "[", 
             RowBox[{
              RowBox[{"dot", "[", "g", "]"}], ",", 
              RowBox[{"{", 
               RowBox[{"ii", ",", "nn"}], "}"}]}], "]"}]}], "/;", 
           RowBox[{"nn", ">", "0"}]}]}], ",", 
         RowBox[{
          RowBox[{"Times", "[", 
           RowBox[{
            RowBox[{"dot", "[", "g__", "]"}], ",", 
            RowBox[{"dot", "[", "h__", "]"}]}], "]"}], ":>", 
          RowBox[{"DC", "[", 
           RowBox[{
            RowBox[{"dot", "[", "g", "]"}], ",", 
            RowBox[{"dot", "[", "h", "]"}]}], "]"}]}], ",", 
         RowBox[{
          RowBox[{"Times", "[", 
           RowBox[{
            RowBox[{"DC", "[", "g__", "]"}], ",", 
            RowBox[{"dot", "[", "h__", "]"}]}], "]"}], ":>", 
          RowBox[{"DC", "[", 
           RowBox[{"g", ",", 
            RowBox[{"dot", "[", "h", "]"}]}], "]"}]}], ",", 
         RowBox[{
          RowBox[{"Times", "[", 
           RowBox[{
            RowBox[{"dot", "[", "h__", "]"}], ",", 
            RowBox[{"DC", "[", "g__", "]"}]}], "]"}], ":>", 
          RowBox[{"DC", "[", 
           RowBox[{
            RowBox[{"dot", "[", "h", "]"}], ",", "g"}], "]"}]}], ",", 
         RowBox[{
          RowBox[{"Times", "[", 
           RowBox[{
            RowBox[{"DC", "[", "h__", "]"}], ",", 
            RowBox[{"DC", "[", "g__", "]"}]}], "]"}], ":>", 
          RowBox[{"DC", "[", 
           RowBox[{"h", ",", "g"}], "]"}]}]}], "}"}]}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"(*", 
      RowBox[{
       RowBox[{"Print", "[", "res", "]"}], ";"}], "*)"}], 
     "\[IndentingNewLine]", 
     RowBox[{"res", "=", 
      RowBox[{"res", "//", "dressdot"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"res", "/.", 
       RowBox[{
        RowBox[{"DC", "[", "g__", "]"}], ":>", 
        RowBox[{"DC", "@@", 
         RowBox[{"Table", "[", 
          RowBox[{
           RowBox[{
            RowBox[{
             RowBox[{"{", "g", "}"}], "[", 
             RowBox[{"[", "ii", "]"}], "]"}], "/.", 
            RowBox[{
             RowBox[{"lI", "[", "ids__", "]"}], ":>", 
             RowBox[{"lI", "[", 
              RowBox[{"ii", ",", "ids"}], "]"}]}]}], ",", 
           RowBox[{"{", 
            RowBox[{"ii", ",", 
             RowBox[{"Length", "@", 
              RowBox[{"{", "g", "}"}]}]}], "}"}]}], "]"}]}]}]}], "/.", 
      RowBox[{"DC", "->", "Times"}]}]}]}], "\[IndentingNewLine]", 
   "]"}]}]}], "Input",
 CellChangeTimes->{
  3.872034945418346*^9, {3.8720349907917633`*^9, 3.872034993209223*^9}, {
   3.872036261541153*^9, 3.872036291395546*^9}, {3.872036858716271*^9, 
   3.872036870110409*^9}},
 CellLabel->"In[57]:=",ExpressionUUID->"a61f9555-0be9-40b9-bdae-1cc5f6ebe29e"],

Cell[BoxData[{
 RowBox[{"ClearAll", "[", "expandGen", "]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"expandGen", "[", "f_", "]"}], ":=", 
  RowBox[{"Module", "[", 
   RowBox[{
    RowBox[{"{", "res", "}"}], ",", 
    RowBox[{
     RowBox[{"res", "=", 
      RowBox[{"f", "//.", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{
          RowBox[{"Power", "[", 
           RowBox[{
            RowBox[{"dot", "[", "g__", "]"}], ",", "nn_"}], "]"}], ":>", 
          RowBox[{
           RowBox[{"DC", "@@", 
            RowBox[{"Table", "[", 
             RowBox[{
              RowBox[{"dot", "[", "g", "]"}], ",", 
              RowBox[{"{", 
               RowBox[{"ii", ",", "nn"}], "}"}]}], "]"}]}], "/;", 
           RowBox[{"nn", ">", "0"}]}]}], ",", 
         RowBox[{
          RowBox[{"Times", "[", 
           RowBox[{
            RowBox[{"dot", "[", "g__", "]"}], ",", 
            RowBox[{"dot", "[", "h__", "]"}]}], "]"}], ":>", 
          RowBox[{"DC", "[", 
           RowBox[{
            RowBox[{"dot", "[", "g", "]"}], ",", 
            RowBox[{"dot", "[", "h", "]"}]}], "]"}]}], ",", 
         RowBox[{
          RowBox[{"Times", "[", 
           RowBox[{
            RowBox[{"DC", "[", "g__", "]"}], ",", 
            RowBox[{"dot", "[", "h__", "]"}]}], "]"}], ":>", 
          RowBox[{"DC", "[", 
           RowBox[{"g", ",", 
            RowBox[{"dot", "[", "h", "]"}]}], "]"}]}], ",", 
         RowBox[{
          RowBox[{"Times", "[", 
           RowBox[{
            RowBox[{"dot", "[", "h__", "]"}], ",", 
            RowBox[{"DC", "[", "g__", "]"}]}], "]"}], ":>", 
          RowBox[{"DC", "[", 
           RowBox[{
            RowBox[{"dot", "[", "h", "]"}], ",", "g"}], "]"}]}], ",", 
         RowBox[{
          RowBox[{"Times", "[", 
           RowBox[{
            RowBox[{"DC", "[", "h__", "]"}], ",", 
            RowBox[{"DC", "[", "g__", "]"}]}], "]"}], ":>", 
          RowBox[{"DC", "[", 
           RowBox[{"h", ",", "g"}], "]"}]}]}], "}"}]}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"(*", 
      RowBox[{
       RowBox[{"Print", "[", "res", "]"}], ";"}], "*)"}], 
     "\[IndentingNewLine]", 
     RowBox[{"res", "=", 
      RowBox[{"res", "//", "dressdot"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{
       RowBox[{"res", "/.", 
        RowBox[{
         RowBox[{"dot", "[", "g__", "]"}], ":>", 
         RowBox[{"expandTensor", "[", 
          RowBox[{"dot", "[", "g", "]"}], "]"}]}]}], "/.", 
       RowBox[{
        RowBox[{"DC", "[", "g__", "]"}], ":>", 
        RowBox[{"DC", "@@", 
         RowBox[{"Table", "[", 
          RowBox[{
           RowBox[{
            RowBox[{
             RowBox[{"{", "g", "}"}], "[", 
             RowBox[{"[", "ii", "]"}], "]"}], "/.", 
            RowBox[{
             RowBox[{"lI", "[", "ids__", "]"}], ":>", 
             RowBox[{"lI", "[", 
              RowBox[{"ii", ",", "ids"}], "]"}]}]}], ",", 
           RowBox[{"{", 
            RowBox[{"ii", ",", 
             RowBox[{"Length", "@", 
              RowBox[{"{", "g", "}"}]}]}], "}"}]}], "]"}]}]}]}], "/.", 
      RowBox[{"DC", "->", "Times"}]}]}]}], "\[IndentingNewLine]", 
   "]"}]}]}], "Input",
 CellChangeTimes->{{3.872034492365653*^9, 3.872034567286909*^9}, {
  3.8720347035629787`*^9, 3.872034758097516*^9}, {3.8720350050883617`*^9, 
  3.87203501817365*^9}},
 CellLabel->"In[61]:=",ExpressionUUID->"5a749aec-1210-4ad6-84cd-506b5a9ebae9"],

Cell[BoxData[{
 RowBox[{"ClearAll", "[", "FTensorReduce", "]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"FTensorReduce", "[", "f_", "]"}], ":=", 
  RowBox[{"f", "/.", 
   RowBox[{
    RowBox[{"dot", "[", 
     RowBox[{"a__", ",", 
      RowBox[{"F", "[", "i_", "]"}], ",", "b__"}], "]"}], ":>", " ", 
    RowBox[{
     RowBox[{
      FractionBox["1", 
       RowBox[{"dot", "[", 
        RowBox[{
         RowBox[{"v", "[", "2", "]"}], ",", 
         RowBox[{"p", "[", "i", "]"}]}], "]"}]], 
      RowBox[{"(", 
       RowBox[{
        RowBox[{
         RowBox[{"dot", "[", 
          RowBox[{"a", ",", 
           RowBox[{"F", "[", "i", "]"}], ",", 
           RowBox[{"v", "[", "2", "]"}]}], "]"}], 
         RowBox[{"dot", "[", 
          RowBox[{
           RowBox[{"p", "[", "i", "]"}], ",", "b"}], "]"}]}], "+", 
        RowBox[{
         RowBox[{"dot", "[", 
          RowBox[{
           RowBox[{"v", "[", "2", "]"}], ",", 
           RowBox[{"F", "[", "i", "]"}], ",", "b"}], "]"}], 
         RowBox[{"dot", "[", 
          RowBox[{"a", ",", 
           RowBox[{"p", "[", "i", "]"}]}], "]"}]}]}], ")"}]}], "/;", 
     RowBox[{"b", "=!=", 
      RowBox[{"v", "[", "2", "]"}]}]}]}]}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"FTensorReduce", "[", 
   RowBox[{"f_", ",", "v2_"}], "]"}], ":=", 
  RowBox[{"f", "/.", 
   RowBox[{
    RowBox[{"dot", "[", 
     RowBox[{"a__", ",", 
      RowBox[{"F", "[", "i_", "]"}], ",", "b__"}], "]"}], ":>", " ", 
    RowBox[{
     RowBox[{
      FractionBox["1", 
       RowBox[{"dot", "[", 
        RowBox[{"v2", ",", 
         RowBox[{"p", "[", "i", "]"}]}], "]"}]], 
      RowBox[{"(", 
       RowBox[{
        RowBox[{
         RowBox[{"dot", "[", 
          RowBox[{"a", ",", 
           RowBox[{"F", "[", "i", "]"}], ",", "v2"}], "]"}], 
         RowBox[{"dot", "[", 
          RowBox[{
           RowBox[{"p", "[", "i", "]"}], ",", "b"}], "]"}]}], "+", 
        RowBox[{
         RowBox[{"dot", "[", 
          RowBox[{"v2", ",", 
           RowBox[{"F", "[", "i", "]"}], ",", "b"}], "]"}], 
         RowBox[{"dot", "[", 
          RowBox[{"a", ",", 
           RowBox[{"p", "[", "i", "]"}]}], "]"}]}]}], ")"}]}], "/;", 
     RowBox[{"(", 
      RowBox[{
       RowBox[{"b", "=!=", "v2"}], "&&", 
       RowBox[{"a", "=!=", "v2"}]}], ")"}]}]}]}]}]}], "Input",
 CellChangeTimes->{{3.8710113197696133`*^9, 3.8710113205510817`*^9}},
 CellLabel->"In[63]:=",ExpressionUUID->"2ec6dc3b-1485-4a6a-943c-7859b690610e"],

Cell[BoxData[{
 RowBox[{"ClearAll", "[", "FTensorReduceG", "]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"FTensorReduceG", "[", 
   RowBox[{"f_", ",", "i_"}], "]"}], ":=", 
  RowBox[{"f", "/.", 
   RowBox[{
    RowBox[{"dot", "[", 
     RowBox[{"a__", ",", 
      RowBox[{"F", "[", "i", "]"}], ",", "b__"}], "]"}], ":>", " ", 
    RowBox[{
     RowBox[{
      FractionBox["1", 
       RowBox[{"dot", "[", 
        RowBox[{
         RowBox[{"v", "[", "2", "]"}], ",", 
         RowBox[{"p", "[", "i", "]"}]}], "]"}]], 
      RowBox[{"(", 
       RowBox[{
        RowBox[{
         RowBox[{"dot", "[", 
          RowBox[{"a", ",", 
           RowBox[{"F", "[", "i", "]"}], ",", 
           RowBox[{"v", "[", "2", "]"}]}], "]"}], 
         RowBox[{"dot", "[", 
          RowBox[{
           RowBox[{"p", "[", "i", "]"}], ",", "b"}], "]"}]}], "+", 
        RowBox[{
         RowBox[{"dot", "[", 
          RowBox[{
           RowBox[{"v", "[", "2", "]"}], ",", 
           RowBox[{"F", "[", "i", "]"}], ",", "b"}], "]"}], 
         RowBox[{"dot", "[", 
          RowBox[{"a", ",", 
           RowBox[{"p", "[", "i", "]"}]}], "]"}]}]}], ")"}]}], "/;", 
     RowBox[{
      RowBox[{
       RowBox[{"Length", "[", 
        RowBox[{"{", "a", "}"}], "]"}], ">=", "2"}], "&&", 
      RowBox[{
       RowBox[{"Length", "[", 
        RowBox[{"{", "b", "}"}], "]"}], ">=", "2"}]}]}]}]}]}]}], "Input",
 CellChangeTimes->{{3.8766049144819403`*^9, 3.8766049514374*^9}},
 CellLabel->"In[66]:=",ExpressionUUID->"d9319593-268b-4300-9501-a5620af6c839"],

Cell[BoxData[{
 RowBox[{"ClearAll", "[", "expandTr", "]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"expandTr", "[", "f_", "]"}], ":=", 
  RowBox[{
   RowBox[{
    RowBox[{"Module", "[", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{
        RowBox[{"lt", "=", 
         RowBox[{"Length", "[", "f", "]"}]}], ",", "ts"}], "}"}], ",", 
      RowBox[{"ts", "=", 
       RowBox[{"f", "/.", 
        RowBox[{
         RowBox[{"tr", "[", "g___", "]"}], ":>", " ", 
         RowBox[{"dot", "[", 
          RowBox[{
           RowBox[{"lI", "[", 
            RowBox[{"0", ",", "1"}], "]"}], ",", "g", ",", 
           RowBox[{"lI", "[", 
            RowBox[{"0", ",", "1"}], "]"}]}], "]"}]}]}]}]}], "]"}], "//", 
    "expandGen"}], "//", "expandF"}]}]}], "Input",
 CellChangeTimes->{{3.854191039354165*^9, 3.854191039594904*^9}, {
  3.854191096585668*^9, 3.8541911346819267`*^9}, {3.854191258960875*^9, 
  3.8541912891639442`*^9}, {3.854191345530801*^9, 3.8541913487274323`*^9}, {
  3.8541914272027063`*^9, 3.854191501571187*^9}, {3.854191759253392*^9, 
  3.8541917851217737`*^9}, {3.8541918354435787`*^9, 3.854191903651122*^9}, {
  3.8541921068331747`*^9, 3.854192117283308*^9}, {3.8765378395707912`*^9, 
  3.876537841794339*^9}},
 CellLabel->"In[68]:=",ExpressionUUID->"c4708be7-ddac-4167-915b-d46842db745f"],

Cell[BoxData[{
 RowBox[{"ClearAll", "[", "tr2dot", "]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"tr2dot", "[", "f_tr", "]"}], ":=", 
  RowBox[{"Module", "[", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{"last", ",", "vlist", ",", "plast", ",", "v1", ",", "v2"}], 
     "}"}], ",", 
    RowBox[{
     RowBox[{"last", "=", 
      RowBox[{"f", "[", 
       RowBox[{"[", 
        RowBox[{"-", "1"}], "]"}], "]"}]}], ";", 
     RowBox[{"plast", "=", 
      RowBox[{"p", "@@", "last"}]}], ";", 
     RowBox[{"vlist", "=", 
      RowBox[{
       RowBox[{"(", 
        RowBox[{"List", "@@", "f"}], ")"}], "[", 
       RowBox[{"[", 
        RowBox[{"1", ";;", 
         RowBox[{"-", "2"}]}], "]"}], "]"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"v1", "=", 
      RowBox[{"Join", "[", 
       RowBox[{
        RowBox[{"{", "plast", "}"}], ",", "vlist", ",", 
        RowBox[{"{", "last", "}"}], ",", 
        RowBox[{"{", "v", "}"}]}], "]"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"v2", "=", 
      RowBox[{"Join", "[", 
       RowBox[{
        RowBox[{"{", "v", "}"}], ",", 
        RowBox[{"{", "last", "}"}], ",", "vlist", ",", 
        RowBox[{"{", "plast", "}"}]}], "]"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{
      FractionBox[
       RowBox[{"dot", "@@", "v1"}], 
       RowBox[{"dot", "[", 
        RowBox[{"v", ",", "plast"}], "]"}]], "+", 
      FractionBox[
       RowBox[{"dot", "@@", "v2"}], 
       RowBox[{"dot", "[", 
        RowBox[{"v", ",", "plast"}], "]"}]]}]}]}], 
   "]"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"tr2dot", "[", 
   RowBox[{"f_tr", ",", "a_"}], "]"}], ":=", 
  RowBox[{"Module", "[", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{"last", ",", "vlist", ",", "plast", ",", "v1", ",", "v2"}], 
     "}"}], ",", 
    RowBox[{
     RowBox[{"last", "=", 
      RowBox[{"f", "[", 
       RowBox[{"[", 
        RowBox[{"-", "1"}], "]"}], "]"}]}], ";", 
     RowBox[{"plast", "=", 
      RowBox[{"p", "@@", "last"}]}], ";", 
     RowBox[{"vlist", "=", 
      RowBox[{
       RowBox[{"(", 
        RowBox[{"List", "@@", "f"}], ")"}], "[", 
       RowBox[{"[", 
        RowBox[{"1", ";;", 
         RowBox[{"-", "2"}]}], "]"}], "]"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"v1", "=", 
      RowBox[{"Join", "[", 
       RowBox[{
        RowBox[{"{", "plast", "}"}], ",", "vlist", ",", 
        RowBox[{"{", "last", "}"}], ",", 
        RowBox[{"{", "a", "}"}]}], "]"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"v2", "=", 
      RowBox[{"Join", "[", 
       RowBox[{
        RowBox[{"{", "a", "}"}], ",", 
        RowBox[{"{", "last", "}"}], ",", "vlist", ",", 
        RowBox[{"{", "plast", "}"}]}], "]"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{
      FractionBox[
       RowBox[{"dot", "@@", "v1"}], 
       RowBox[{"dot", "[", 
        RowBox[{"a", ",", "plast"}], "]"}]], "+", 
      FractionBox[
       RowBox[{"dot", "@@", "v2"}], 
       RowBox[{"dot", "[", 
        RowBox[{"a", ",", "plast"}], "]"}]]}]}]}], "]"}]}]}], "Input",
 CellLabel->"In[70]:=",ExpressionUUID->"da1678c0-82b0-4300-bfbc-d1f6eb039ac5"],

Cell[BoxData[{
 RowBox[{"ClearAll", "[", "antiSymrep", "]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"antiSymrep", "=", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{
      RowBox[{"dot", "[", 
       RowBox[{"a_", ",", 
        RowBox[{"F", "[", "i_", "]"}], ",", "b_"}], "]"}], ":>", " ", 
      RowBox[{
       RowBox[{"-", 
        RowBox[{"dot", "[", 
         RowBox[{"b", ",", 
          RowBox[{"F", "[", "i", "]"}], ",", "a"}], "]"}]}], "/;", 
       RowBox[{
        RowBox[{"Signature", "[", 
         RowBox[{"{", 
          RowBox[{"a", ",", "b"}], "}"}], "]"}], "<", "0"}]}]}], ",", 
     RowBox[{
      RowBox[{"dot", "[", 
       RowBox[{"a_", ",", 
        RowBox[{"F", "[", "i_", "]"}], ",", 
        RowBox[{"F", "[", "j_", "]"}], ",", "b_"}], "]"}], ":>", " ", 
      RowBox[{
       RowBox[{"dot", "[", 
        RowBox[{"b", ",", 
         RowBox[{"F", "[", "j", "]"}], ",", 
         RowBox[{"F", "[", "i", "]"}], ",", "a"}], "]"}], "/;", 
       RowBox[{"i", ">", "j"}]}]}]}], "}"}]}], ";"}]}], "Input",
 CellChangeTimes->{{3.853462108697447*^9, 3.853462142837044*^9}, {
  3.8534646323189697`*^9, 3.8534646409716263`*^9}},
 CellLabel->"In[73]:=",ExpressionUUID->"bb9d1e39-1bb7-41c6-b251-dcebffea133c"],

Cell[BoxData[{
 RowBox[{"ClearAll", "[", "CombWithRep", "]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"CombWithRep", "[", 
   RowBox[{"ls_", ",", "n_"}], "]"}], ":=", 
  RowBox[{
   RowBox[{"(", 
    RowBox[{"List", "@@", 
     RowBox[{"(", 
      RowBox[{"Diamond", "@@", 
       RowBox[{"Table", "[", 
        RowBox[{
         RowBox[{"Total", "[", "ls", "]"}], ",", 
         RowBox[{"{", 
          RowBox[{"i", ",", "n"}], "}"}]}], "]"}]}], ")"}]}], ")"}], "/.", 
   RowBox[{"Diamond", "->", " ", "List"}]}]}]}], "Input",
 CellLabel->"In[75]:=",ExpressionUUID->"8c7dc4b2-591e-4db4-b91a-1285414fe61d"],

Cell[BoxData[{
 RowBox[{"ClearAll", "[", "minSets", "]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"minSets", "[", "list_List", "]"}], ":=", 
  RowBox[{"Block", "[", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{
      RowBox[{"u", "=", 
       RowBox[{"Union", "@", "list"}]}], ",", "r"}], "}"}], ",", 
    RowBox[{"Pick", "[", 
     RowBox[{"u", ",", 
      RowBox[{"Subtract", "[", 
       RowBox[{
        RowBox[{"BitAnd", "@@@", 
         RowBox[{"Replace", "[", 
          RowBox[{"u", ",", 
           RowBox[{"With", "[", 
            RowBox[{
             RowBox[{"{", 
              RowBox[{"g", "=", 
               RowBox[{"GatherBy", "[", 
                RowBox[{
                 RowBox[{"Transpose", "[", 
                  RowBox[{"{", 
                   RowBox[{
                    RowBox[{"Join", "@@", "u"}], ",", 
                    RowBox[{"Join", "@@", 
                    RowBox[{"MapThread", "[", 
                    RowBox[{"ConstantArray", ",", 
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{"r", "=", 
                    RowBox[{"2", "^", 
                    RowBox[{"Range", "[", 
                    RowBox[{"0", ",", 
                    RowBox[{
                    RowBox[{"Length", "@", "u"}], "-", "1"}]}], "]"}]}]}], 
                    ",", 
                    RowBox[{"Length", "/@", "u"}]}], "}"}]}], "]"}]}]}], 
                   "}"}], "]"}], ",", "First"}], "]"}]}], "}"}], ",", 
             RowBox[{"Dispatch", "@", 
              RowBox[{"Thread", "[", 
               RowBox[{
                RowBox[{"g", "[", 
                 RowBox[{"[", 
                  RowBox[{"All", ",", "1", ",", "1"}], "]"}], "]"}], "->", 
                RowBox[{"Total", "[", 
                 RowBox[{
                  RowBox[{"g", "[", 
                   RowBox[{"[", 
                    RowBox[{"All", ",", "All", ",", "2"}], "]"}], "]"}], ",", 
                  
                  RowBox[{"{", "2", "}"}]}], "]"}]}], "]"}]}]}], "]"}], ",", 
           RowBox[{"{", "2", "}"}]}], "]"}]}], ",", "r"}], "]"}], ",", "0"}], 
     "]"}]}], "]"}]}]}], "Input",
 CellLabel->"In[77]:=",ExpressionUUID->"571ee68b-1968-468a-8457-68ec7313b97e"],

Cell[BoxData[{
 RowBox[{"ClearAll", "[", "expandTensorFi", "]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"expandTensorFi", "[", 
   RowBox[{"f_dot", ",", "id_"}], "]"}], ":=", 
  RowBox[{
   RowBox[{"f", "/.", 
    RowBox[{
     RowBox[{"dot", "[", 
      RowBox[{"a__", ",", 
       RowBox[{"F", "[", "id", "]"}], ",", "g___", ",", 
       RowBox[{"F", "[", "id", "]"}], ",", "b__"}], "]"}], ":>", 
     RowBox[{
      RowBox[{"dot", "[", 
       RowBox[{"a", ",", 
        RowBox[{"lI", "[", 
         RowBox[{"id", ",", "1", ",", "1"}], "]"}]}], "]"}], 
      RowBox[{"dot", "[", 
       RowBox[{
        RowBox[{"lI", "[", 
         RowBox[{"id", ",", "1", ",", "2"}], "]"}], ",", "g", ",", 
        RowBox[{"lI", "[", 
         RowBox[{"id", ",", "2", ",", "1"}], "]"}]}], "]"}], 
      RowBox[{"dot", "[", 
       RowBox[{
        RowBox[{"lI", "[", 
         RowBox[{"id", ",", "2", ",", "2"}], "]"}], ",", "b"}], "]"}], 
      RowBox[{"(", 
       RowBox[{
        RowBox[{
         RowBox[{
          RowBox[{"p", "[", "id", "]"}], "[", 
          RowBox[{"lI", "[", 
           RowBox[{"id", ",", "1", ",", "1"}], "]"}], "]"}], 
         RowBox[{
          RowBox[{"\[Epsilon]", "[", "id", "]"}], "[", 
          RowBox[{"lI", "[", 
           RowBox[{"id", ",", "1", ",", "2"}], "]"}], "]"}]}], "-", 
        RowBox[{
         RowBox[{
          RowBox[{"\[Epsilon]", "[", "id", "]"}], "[", 
          RowBox[{"lI", "[", 
           RowBox[{"id", ",", "1", ",", "1"}], "]"}], "]"}], 
         RowBox[{
          RowBox[{"p", "[", "id", "]"}], "[", 
          RowBox[{"lI", "[", 
           RowBox[{"id", ",", "1", ",", "2"}], "]"}], "]"}]}]}], ")"}], 
      RowBox[{"(", 
       RowBox[{
        RowBox[{
         RowBox[{
          RowBox[{"p", "[", "id", "]"}], "[", 
          RowBox[{"lI", "[", 
           RowBox[{"id", ",", "2", ",", "1"}], "]"}], "]"}], 
         RowBox[{
          RowBox[{"\[Epsilon]", "[", "id", "]"}], "[", 
          RowBox[{"lI", "[", 
           RowBox[{"id", ",", "2", ",", "2"}], "]"}], "]"}]}], "-", 
        RowBox[{
         RowBox[{
          RowBox[{"\[Epsilon]", "[", "id", "]"}], "[", 
          RowBox[{"lI", "[", 
           RowBox[{"id", ",", "2", ",", "1"}], "]"}], "]"}], 
         RowBox[{
          RowBox[{"p", "[", "id", "]"}], "[", 
          RowBox[{"lI", "[", 
           RowBox[{"id", ",", "2", ",", "2"}], "]"}], "]"}]}]}], ")"}]}]}]}], 
   "/.", 
   RowBox[{
    RowBox[{"dot", "[", 
     RowBox[{"a__", ",", 
      RowBox[{"F", "[", "id", "]"}], ",", "b__"}], "]"}], ":>", 
    RowBox[{
     RowBox[{"dot", "[", 
      RowBox[{"a", ",", 
       RowBox[{"lI", "[", 
        RowBox[{"id", ",", "1"}], "]"}]}], "]"}], 
     RowBox[{"dot", "[", 
      RowBox[{
       RowBox[{"lI", "[", 
        RowBox[{"id", ",", "2"}], "]"}], ",", "b"}], "]"}], 
     RowBox[{"(", 
      RowBox[{
       RowBox[{
        RowBox[{
         RowBox[{"p", "[", "id", "]"}], "[", 
         RowBox[{"lI", "[", 
          RowBox[{"id", ",", "1"}], "]"}], "]"}], 
        RowBox[{
         RowBox[{"\[Epsilon]", "[", "id", "]"}], "[", 
         RowBox[{"lI", "[", 
          RowBox[{"id", ",", "2"}], "]"}], "]"}]}], "-", 
       RowBox[{
        RowBox[{
         RowBox[{"\[Epsilon]", "[", "id", "]"}], "[", 
         RowBox[{"lI", "[", 
          RowBox[{"id", ",", "1"}], "]"}], "]"}], 
        RowBox[{
         RowBox[{"p", "[", "id", "]"}], "[", 
         RowBox[{"lI", "[", 
          RowBox[{"id", ",", "2"}], "]"}], "]"}]}]}], 
      ")"}]}]}]}]}], "\[IndentingNewLine]", 
 RowBox[{"ClearAll", "[", "expandTensorFiGen", "]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"expandTensorFiGen", "[", 
   RowBox[{"f_", ",", "id_"}], "]"}], ":=", 
  RowBox[{"Module", "[", 
   RowBox[{
    RowBox[{"{", "res", "}"}], ",", 
    RowBox[{
     RowBox[{"res", "=", 
      RowBox[{"f", "//.", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{
          RowBox[{"Power", "[", 
           RowBox[{
            RowBox[{"dot", "[", 
             RowBox[{"g__", ",", 
              RowBox[{"F", "[", "id", "]"}], ",", "h__"}], "]"}], ",", "2"}], 
           "]"}], ":>", 
          RowBox[{"DC", "@@", 
           RowBox[{"Table", "[", 
            RowBox[{
             RowBox[{"dot", "[", 
              RowBox[{"g", ",", 
               RowBox[{"F", "[", "id", "]"}], ",", "h"}], "]"}], ",", 
             RowBox[{"{", 
              RowBox[{"ii", ",", "2"}], "}"}]}], "]"}]}]}], ",", 
         RowBox[{
          RowBox[{"Times", "[", 
           RowBox[{
            RowBox[{"dot", "[", 
             RowBox[{"g__", ",", 
              RowBox[{"F", "[", "id", "]"}], ",", "h__"}], "]"}], ",", 
            RowBox[{"dot", "[", 
             RowBox[{"g1__", ",", 
              RowBox[{"F", "[", "id", "]"}], ",", "h1__"}], "]"}]}], "]"}], ":>", 
          RowBox[{"DC", "[", 
           RowBox[{
            RowBox[{"dot", "[", 
             RowBox[{"g", ",", 
              RowBox[{"F", "[", "id", "]"}], ",", "h"}], "]"}], ",", 
            RowBox[{"dot", "[", 
             RowBox[{"g1", ",", 
              RowBox[{"F", "[", "id", "]"}], ",", "h1"}], "]"}]}], "]"}]}]}], 
        "}"}]}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"(*", 
      RowBox[{
       RowBox[{"Print", "[", "res", "]"}], ";"}], "*)"}], 
     "\[IndentingNewLine]", 
     RowBox[{"res", "=", 
      RowBox[{"res", "//.", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{
          RowBox[{"Power", "[", 
           RowBox[{
            RowBox[{"dot", "[", 
             RowBox[{"g_", ",", 
              RowBox[{"\[Epsilon]", "[", "id", "]"}]}], "]"}], ",", "2"}], 
           "]"}], ":>", 
          RowBox[{"DC", "@@", 
           RowBox[{"Table", "[", 
            RowBox[{
             RowBox[{"dot", "[", 
              RowBox[{"g", ",", 
               RowBox[{"\[Epsilon]", "[", "id", "]"}]}], "]"}], ",", 
             RowBox[{"{", 
              RowBox[{"ii", ",", "2"}], "}"}]}], "]"}]}]}], ",", 
         RowBox[{
          RowBox[{"Power", "[", 
           RowBox[{
            RowBox[{"dot", "[", 
             RowBox[{
              RowBox[{"\[Epsilon]", "[", "id", "]"}], ",", "g_"}], "]"}], ",",
             "2"}], "]"}], ":>", 
          RowBox[{"DC", "@@", 
           RowBox[{"Table", "[", 
            RowBox[{
             RowBox[{"dot", "[", 
              RowBox[{
               RowBox[{"\[Epsilon]", "[", "id", "]"}], ",", "g"}], "]"}], ",", 
             RowBox[{"{", 
              RowBox[{"ii", ",", "2"}], "}"}]}], "]"}]}]}], ",", 
         RowBox[{
          RowBox[{"Times", "[", 
           RowBox[{
            RowBox[{"dot", "[", 
             RowBox[{"g_", ",", 
              RowBox[{"\[Epsilon]", "[", "id", "]"}]}], "]"}], ",", 
            RowBox[{"dot", "[", 
             RowBox[{"g1_", ",", 
              RowBox[{"\[Epsilon]", "[", "id", "]"}]}], "]"}]}], "]"}], ":>", 
          
          RowBox[{"DC", "[", 
           RowBox[{
            RowBox[{"dot", "[", 
             RowBox[{"g", ",", 
              RowBox[{"\[Epsilon]", "[", "id", "]"}]}], "]"}], ",", 
            RowBox[{"dot", "[", 
             RowBox[{"g1", ",", 
              RowBox[{"\[Epsilon]", "[", "id", "]"}]}], "]"}]}], "]"}]}], ",", 
         RowBox[{
          RowBox[{"Times", "[", 
           RowBox[{
            RowBox[{"dot", "[", 
             RowBox[{
              RowBox[{"\[Epsilon]", "[", "id", "]"}], ",", "g_"}], "]"}], ",", 
            RowBox[{"dot", "[", 
             RowBox[{"g1_", ",", 
              RowBox[{"\[Epsilon]", "[", "id", "]"}]}], "]"}]}], "]"}], ":>", 
          
          RowBox[{"DC", "[", 
           RowBox[{
            RowBox[{"dot", "[", 
             RowBox[{
              RowBox[{"\[Epsilon]", "[", "id", "]"}], ",", "g"}], "]"}], ",", 
            
            RowBox[{"dot", "[", 
             RowBox[{"g1", ",", 
              RowBox[{"\[Epsilon]", "[", "id", "]"}]}], "]"}]}], "]"}]}], ",", 
         RowBox[{
          RowBox[{"Times", "[", 
           RowBox[{
            RowBox[{"dot", "[", 
             RowBox[{"g_", ",", 
              RowBox[{"\[Epsilon]", "[", "id", "]"}]}], "]"}], ",", 
            RowBox[{"dot", "[", 
             RowBox[{
              RowBox[{"\[Epsilon]", "[", "id", "]"}], ",", "g1_"}], "]"}]}], 
           "]"}], ":>", 
          RowBox[{"DC", "[", 
           RowBox[{
            RowBox[{"dot", "[", 
             RowBox[{"g", ",", 
              RowBox[{"\[Epsilon]", "[", "id", "]"}]}], "]"}], ",", 
            RowBox[{"dot", "[", 
             RowBox[{
              RowBox[{"\[Epsilon]", "[", "id", "]"}], ",", "g1"}], "]"}]}], 
           "]"}]}], ",", 
         RowBox[{
          RowBox[{"Times", "[", 
           RowBox[{
            RowBox[{"dot", "[", 
             RowBox[{
              RowBox[{"\[Epsilon]", "[", "id", "]"}], ",", "g_"}], "]"}], ",", 
            RowBox[{"dot", "[", 
             RowBox[{
              RowBox[{"\[Epsilon]", "[", "id", "]"}], ",", "g1_"}], "]"}]}], 
           "]"}], ":>", 
          RowBox[{"DC", "[", 
           RowBox[{
            RowBox[{"dot", "[", 
             RowBox[{
              RowBox[{"\[Epsilon]", "[", "id", "]"}], ",", "g"}], "]"}], ",", 
            
            RowBox[{"dot", "[", 
             RowBox[{
              RowBox[{"\[Epsilon]", "[", "id", "]"}], ",", "g1"}], "]"}]}], 
           "]"}]}]}], "}"}]}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"(*", 
      RowBox[{
       RowBox[{"Print", "[", "res", "]"}], ";"}], "*)"}], 
     "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{
       RowBox[{
        RowBox[{
         RowBox[{"res", "/.", 
          RowBox[{
           RowBox[{"dot", "[", "g__", "]"}], ":>", 
           RowBox[{"expandTensorFi", "[", 
            RowBox[{
             RowBox[{"dot", "[", "g", "]"}], ",", "id"}], "]"}]}]}], "/.", 
         RowBox[{
          RowBox[{"dot", "[", 
           RowBox[{"g_", ",", 
            RowBox[{"\[Epsilon]", "[", "id", "]"}]}], "]"}], ":>", 
          RowBox[{
           RowBox[{"g", "[", 
            RowBox[{"lI", "[", 
             RowBox[{"0", ",", "id"}], "]"}], "]"}], 
           RowBox[{
            RowBox[{"\[Epsilon]", "[", "id", "]"}], "[", 
            RowBox[{"lI", "[", 
             RowBox[{"0", ",", "id"}], "]"}], "]"}]}]}]}], "/.", 
        RowBox[{
         RowBox[{"dot", "[", 
          RowBox[{
           RowBox[{"\[Epsilon]", "[", "id", "]"}], ",", "g_"}], "]"}], ":>", 
         RowBox[{
          RowBox[{"g", "[", 
           RowBox[{"lI", "[", 
            RowBox[{"0", ",", "id"}], "]"}], "]"}], 
          RowBox[{
           RowBox[{"\[Epsilon]", "[", "id", "]"}], "[", 
           RowBox[{"lI", "[", 
            RowBox[{"0", ",", "id"}], "]"}], "]"}]}]}]}], "/.", 
       RowBox[{
        RowBox[{"DC", "[", "g__", "]"}], ":>", 
        RowBox[{"DC", "@@", 
         RowBox[{"Table", "[", 
          RowBox[{
           RowBox[{
            RowBox[{
             RowBox[{"{", "g", "}"}], "[", 
             RowBox[{"[", "ii", "]"}], "]"}], "/.", 
            RowBox[{
             RowBox[{"lI", "[", "ids__", "]"}], ":>", 
             RowBox[{"lI", "[", 
              RowBox[{"ii", ",", "ids"}], "]"}]}]}], ",", 
           RowBox[{"{", 
            RowBox[{"ii", ",", 
             RowBox[{"Length", "@", 
              RowBox[{"{", "g", "}"}]}]}], "}"}]}], "]"}]}]}]}], "/.", 
      RowBox[{"DC", "->", "Times"}]}]}]}], "\[IndentingNewLine]", 
   "]"}]}]}], "Input",
 CellChangeTimes->{{3.8717101857556257`*^9, 3.871710247171233*^9}, {
   3.871710344490424*^9, 3.871710464250885*^9}, {3.871710514216856*^9, 
   3.871710535067227*^9}, {3.871710577772479*^9, 3.871710619653611*^9}, {
   3.87171070099017*^9, 3.871710793817266*^9}, {3.8717110547727757`*^9, 
   3.871711098694851*^9}, {3.871711566802866*^9, 3.8717116001589727`*^9}, {
   3.8717925794231157`*^9, 3.8717926279638968`*^9}, {3.871792658993463*^9, 
   3.871792659631276*^9}, 3.871792836017084*^9, {3.871792881937099*^9, 
   3.871792936440737*^9}, {3.871793027757831*^9, 3.871793027984799*^9}, {
   3.8717930770034943`*^9, 3.8717931563424873`*^9}, {3.871793189683238*^9, 
   3.871793219777211*^9}, {3.871794218005933*^9, 3.8717942969355288`*^9}, {
   3.871794593480941*^9, 3.871794608503077*^9}, {3.871794745604311*^9, 
   3.87179476760977*^9}, {3.871794877507155*^9, 3.871794880713606*^9}, {
   3.871794991131771*^9, 3.87179509392428*^9}, {3.8717951470684958`*^9, 
   3.871795182954617*^9}, {3.8718603028865423`*^9, 3.871860327016007*^9}, {
   3.871860459558563*^9, 3.871860475007077*^9}, {3.871878859716531*^9, 
   3.871878883200115*^9}, {3.871878943674459*^9, 3.8718789878517*^9}, {
   3.871879040687913*^9, 3.871879042718019*^9}, {3.8718797681531343`*^9, 
   3.871879772859611*^9}, {3.8718798541089087`*^9, 3.871880037163097*^9}, {
   3.8765284853468723`*^9, 3.8765285056137733`*^9}, {3.876528614447425*^9, 
   3.8765286203250027`*^9}, {3.876529061202283*^9, 3.876529118675256*^9}, {
   3.876535688731642*^9, 3.876535689308138*^9}},
 CellLabel->"In[79]:=",ExpressionUUID->"f6470b2b-1430-493f-b954-d80193a6e8b3"],

Cell[BoxData[{
 RowBox[{
  RowBox[{"ClearAll", "[", "GlueAmp2", "]"}], " ", 
  RowBox[{"(*", 
   RowBox[{"Slow", " ", "function", " ", "for", " ", "testing"}], 
   "*)"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"GlueAmp2", "[", 
   RowBox[{"f__", ",", "pi_"}], "]"}], ":=", 
  RowBox[{"Module", "[", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{"res", ",", 
      RowBox[{"los", "=", 
       RowBox[{"lo", "@@", "pi"}]}], ",", 
      RowBox[{"lis", "=", "pi"}]}], "}"}], ",", 
    RowBox[{
     RowBox[{"res", "=", 
      RowBox[{
       RowBox[{"Times", "[", "f", "]"}], "/.", 
       RowBox[{
        RowBox[{"A", "[", 
         RowBox[{"g_", ",", "vv_", ",", "ps_"}], "]"}], ":>", 
        RowBox[{"(", 
         RowBox[{
          RowBox[{"g", "/.", 
           RowBox[{"v", "->", "vv"}]}], "/.", 
          RowBox[{"MapThread", "[", 
           RowBox[{"Rule", ",", 
            RowBox[{"{", 
             RowBox[{
              RowBox[{"p", "/@", 
               RowBox[{"Range", "[", 
                RowBox[{"Length", "@", "ps"}], "]"}]}], ",", "ps"}], "}"}]}], 
           "]"}]}], ")"}]}]}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"res", "=", 
      RowBox[{
       RowBox[{
        RowBox[{
         RowBox[{"res", "//", "expandGen"}], "//", 
         RowBox[{
          RowBox[{"expandF", "[", 
           RowBox[{"#", ",", "lis"}], "]"}], "&"}]}], "//", 
        RowBox[{
         RowBox[{"expandF", "[", 
          RowBox[{"#", ",", "los"}], "]"}], "&"}]}], "//", "Expand"}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"res", "=", 
      RowBox[{
       RowBox[{"res", "/.", 
        RowBox[{
         RowBox[{
          RowBox[{
           RowBox[{"\[Epsilon]", "[", "lis", "]"}], "[", "a1_", "]"}], 
          RowBox[{
           RowBox[{"\[Epsilon]", "[", "lis", "]"}], "[", "a2_", "]"}], 
          RowBox[{
           RowBox[{"\[Epsilon]", "[", "los", "]"}], "[", "b1_", "]"}], 
          RowBox[{
           RowBox[{"\[Epsilon]", "[", "los", "]"}], "[", "b2_", "]"}]}], ":>", 
         RowBox[{
          FractionBox["1", "2"], 
          RowBox[{"(", 
           RowBox[{
            RowBox[{
             RowBox[{"eta", "[", 
              RowBox[{"a1", ",", "b1"}], "]"}], 
             RowBox[{"eta", "[", 
              RowBox[{"a2", ",", "b2"}], "]"}]}], "+", 
            RowBox[{
             RowBox[{"eta", "[", 
              RowBox[{"a1", ",", "b2"}], "]"}], 
             RowBox[{"eta", "[", 
              RowBox[{"a2", ",", "b1"}], "]"}]}], "-", 
            RowBox[{
             FractionBox["2", 
              RowBox[{"DD", "-", "2"}]], 
             RowBox[{"eta", "[", 
              RowBox[{"a1", ",", "a2"}], "]"}], 
             RowBox[{"eta", "[", 
              RowBox[{"b1", ",", "b2"}], "]"}]}]}], ")"}]}]}]}], "//", 
       "contractAnti"}]}]}]}], "\[IndentingNewLine]", "]"}]}]}], "Input",
 CellChangeTimes->{{3.871712600587709*^9, 3.871712670352553*^9}, {
  3.871712848705008*^9, 3.8717128512044077`*^9}, {3.8717156142755423`*^9, 
  3.871715631992737*^9}, {3.871945244409588*^9, 3.871945272183694*^9}, {
  3.872034874753574*^9, 3.872034875714731*^9}},
 CellLabel->"In[83]:=",ExpressionUUID->"311cb0de-bc70-4e6d-8af5-84e5a3960e94"],

Cell[BoxData[{
 RowBox[{"ClearAll", "[", "GlueAmp3", "]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"GlueAmp3", "[", 
   RowBox[{"f__", ",", "pi_"}], "]"}], ":=", 
  RowBox[{"Module", "[", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{"res", ",", 
      RowBox[{"los", "=", 
       RowBox[{"lo", "@@", "pi"}]}], ",", 
      RowBox[{"lis", "=", "pi"}]}], "}"}], ",", 
    RowBox[{
     RowBox[{"res", "=", 
      RowBox[{
       RowBox[{"Times", "[", "f", "]"}], "/.", 
       RowBox[{
        RowBox[{"A", "[", 
         RowBox[{"g_", ",", "vv_", ",", "ps_"}], "]"}], ":>", 
        RowBox[{"(", 
         RowBox[{
          RowBox[{"g", "/.", 
           RowBox[{"v", "->", "vv"}]}], "/.", 
          RowBox[{"MapThread", "[", 
           RowBox[{"Rule", ",", 
            RowBox[{"{", 
             RowBox[{
              RowBox[{"p", "/@", 
               RowBox[{"Range", "[", 
                RowBox[{"Length", "@", "ps"}], "]"}]}], ",", "ps"}], "}"}]}], 
           "]"}]}], ")"}]}]}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"res", "=", 
      RowBox[{
       RowBox[{"res", "//", 
        RowBox[{
         RowBox[{"expandTensorFiGen", "[", 
          RowBox[{"#", ",", "lis"}], "]"}], "&"}]}], "//", "Expand"}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"res", "=", 
      RowBox[{
       RowBox[{"res", "//", 
        RowBox[{
         RowBox[{"expandTensorFiGen", "[", 
          RowBox[{"#", ",", "los"}], "]"}], "&"}]}], "//", "Expand"}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"res", "=", 
      RowBox[{"res", "/.", 
       RowBox[{
        RowBox[{
         RowBox[{
          RowBox[{"\[Epsilon]", "[", "lis", "]"}], "[", "a1_", "]"}], 
         RowBox[{
          RowBox[{"\[Epsilon]", "[", "lis", "]"}], "[", "a2_", "]"}], 
         RowBox[{
          RowBox[{"\[Epsilon]", "[", "los", "]"}], "[", "b1_", "]"}], 
         RowBox[{
          RowBox[{"\[Epsilon]", "[", "los", "]"}], "[", "b2_", "]"}]}], ":>", 
        
        RowBox[{
         FractionBox["1", "2"], 
         RowBox[{"(", 
          RowBox[{
           RowBox[{
            RowBox[{"eta", "[", 
             RowBox[{"a1", ",", "b1"}], "]"}], 
            RowBox[{"eta", "[", 
             RowBox[{"a2", ",", "b2"}], "]"}]}], "+", 
           RowBox[{
            RowBox[{"eta", "[", 
             RowBox[{"a1", ",", "b2"}], "]"}], 
            RowBox[{"eta", "[", 
             RowBox[{"a2", ",", "b1"}], "]"}]}], "-", 
           RowBox[{
            FractionBox["2", 
             RowBox[{"DD", "-", "2"}]], 
            RowBox[{"eta", "[", 
             RowBox[{"a1", ",", "a2"}], "]"}], 
            RowBox[{"eta", "[", 
             RowBox[{"b1", ",", "b2"}], "]"}]}]}], ")"}]}]}]}]}]}]}], 
   "\[IndentingNewLine]", "]"}]}]}], "Input",
 CellChangeTimes->{{3.87194534060808*^9, 3.871945346058714*^9}},
 CellLabel->"In[85]:=",ExpressionUUID->"9ba83756-e9e0-4b81-b452-76fe18ad8619"],

Cell[BoxData[{
 RowBox[{"ClearAll", "[", "GlueAmp", "]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"GlueAmp", "[", 
   RowBox[{"f__", ",", "pi_li"}], "]"}], ":=", 
  RowBox[{"Module", "[", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{"res", ",", 
      RowBox[{"los", "=", 
       RowBox[{"lo", "@@", "pi"}]}], ",", 
      RowBox[{"lis", "=", "pi"}]}], "}"}], ",", 
    RowBox[{
     RowBox[{"res", "=", 
      RowBox[{
       RowBox[{
        RowBox[{"Times", "[", "f", "]"}], "/.", 
        RowBox[{
         RowBox[{"A", "[", 
          RowBox[{"g_", ",", "vv_", ",", "ps_"}], "]"}], ":>", 
         RowBox[{"(", 
          RowBox[{
           RowBox[{"g", "/.", 
            RowBox[{"v", "->", "vv"}]}], "/.", 
           RowBox[{"MapThread", "[", 
            RowBox[{"Rule", ",", 
             RowBox[{"{", 
              RowBox[{
               RowBox[{"p", "/@", 
                RowBox[{"Range", "[", 
                 RowBox[{"Length", "@", "ps"}], "]"}]}], ",", "ps"}], "}"}]}],
             "]"}]}], ")"}]}]}], "//", "Expand"}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"res", "=", 
      RowBox[{
       RowBox[{"res", "//", 
        RowBox[{
         RowBox[{"expandTensorFiGen", "[", 
          RowBox[{"#", ",", "lis"}], "]"}], "&"}]}], "//", "Expand"}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"res", "=", 
      RowBox[{
       RowBox[{"res", "//", 
        RowBox[{
         RowBox[{"expandTensorFiGen", "[", 
          RowBox[{"#", ",", "los"}], "]"}], "&"}]}], "//", "Expand"}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"res", "=", 
      RowBox[{
       RowBox[{"res", "/.", 
        RowBox[{
         RowBox[{
          RowBox[{
           RowBox[{"\[Epsilon]", "[", "lis", "]"}], "[", "a1_", "]"}], 
          RowBox[{
           RowBox[{"\[Epsilon]", "[", "lis", "]"}], "[", "a2_", "]"}], 
          RowBox[{
           RowBox[{"\[Epsilon]", "[", "los", "]"}], "[", "b1_", "]"}], 
          RowBox[{
           RowBox[{"\[Epsilon]", "[", "los", "]"}], "[", "b2_", "]"}]}], ":>", 
         RowBox[{
          FractionBox["1", "2"], 
          RowBox[{"(", 
           RowBox[{
            RowBox[{
             RowBox[{"eta", "[", 
              RowBox[{"a1", ",", "b1"}], "]"}], 
             RowBox[{"eta", "[", 
              RowBox[{"a2", ",", "b2"}], "]"}]}], "+", 
            RowBox[{
             RowBox[{"eta", "[", 
              RowBox[{"a1", ",", "b2"}], "]"}], 
             RowBox[{"eta", "[", 
              RowBox[{"a2", ",", "b1"}], "]"}]}], "-", 
            RowBox[{
             FractionBox["2", 
              RowBox[{"DD", "-", "2"}]], 
             RowBox[{"eta", "[", 
              RowBox[{"a1", ",", "a2"}], "]"}], 
             RowBox[{"eta", "[", 
              RowBox[{"b1", ",", "b2"}], "]"}]}]}], ")"}]}]}]}], "//", 
       "contractAnti"}]}]}]}], "\[IndentingNewLine]", "]"}]}]}], "Input",
 CellChangeTimes->{{3.717672845976037*^9, 3.717672889169771*^9}, {
   3.717674925531893*^9, 3.71767495835476*^9}, {3.717675063695549*^9, 
   3.717675066478118*^9}, {3.717675300930599*^9, 3.7176753267138968`*^9}, {
   3.7176753870934343`*^9, 3.717675403057289*^9}, {3.7176754381874647`*^9, 
   3.71767547431498*^9}, 3.717675660783152*^9, {3.717736602639456*^9, 
   3.7177366242846107`*^9}, {3.717737468069676*^9, 3.717737480653091*^9}, {
   3.717750828787468*^9, 3.717750872340436*^9}, {3.718860636025526*^9, 
   3.718860640412352*^9}, {3.7188607903613377`*^9, 3.718860795560849*^9}, 
   3.71886086446344*^9, {3.718860948446919*^9, 3.718860951595491*^9}, 
   3.718860984899868*^9, {3.721238842235695*^9, 3.721238843744174*^9}, {
   3.721410336076936*^9, 3.7214103369702473`*^9}, {3.721412975267428*^9, 
   3.721412988890263*^9}, {3.72141323618769*^9, 3.7214132364838457`*^9}, 
   3.7214147264125347`*^9, {3.722247891811057*^9, 3.722247901391345*^9}, {
   3.727163630705885*^9, 3.727163679035369*^9}, {3.7271813171878366`*^9, 
   3.727181351523305*^9}, {3.727181477010126*^9, 3.727181501954378*^9}, {
   3.7569617666765738`*^9, 3.756961766784175*^9}, {3.756961870648288*^9, 
   3.756961949579342*^9}, {3.756962094598337*^9, 3.7569621098574553`*^9}, {
   3.756962167672611*^9, 3.7569621739207697`*^9}, {3.7569622139938307`*^9, 
   3.7569622426119537`*^9}, 3.756962373458827*^9, {3.809660362743723*^9, 
   3.809660418070587*^9}, {3.8096614085618067`*^9, 3.809661412551626*^9}, {
   3.809662049147789*^9, 3.809662101747892*^9}, {3.8096621462298317`*^9, 
   3.809662152164967*^9}, {3.809695613944919*^9, 3.809695685233942*^9}, 
   3.809695754647512*^9, {3.809695795605771*^9, 3.809695832316655*^9}, {
   3.809695960033867*^9, 3.809696106429303*^9}, {3.809696168645002*^9, 
   3.8096962031609497`*^9}, {3.80969630311021*^9, 3.809696333870982*^9}, {
   3.809696500996005*^9, 3.809696552942379*^9}, {3.8096965843172007`*^9, 
   3.809696642216886*^9}, {3.80969668037805*^9, 3.809696725452177*^9}, {
   3.8096968004483547`*^9, 3.809696937098598*^9}, {3.8096969918981867`*^9, 
   3.8096970974956913`*^9}, {3.809697150172176*^9, 3.809697151784438*^9}, {
   3.809851404069126*^9, 3.8098514312721767`*^9}, {3.8098515608428*^9, 
   3.8098515619391623`*^9}, {3.81000416196408*^9, 3.81000419966461*^9}, {
   3.810004329672138*^9, 3.810004330140016*^9}, {3.810012567227653*^9, 
   3.8100125857543917`*^9}, {3.849077219402678*^9, 3.8490772205862703`*^9}, {
   3.849077274201914*^9, 3.849077275031169*^9}, {3.8499313915236273`*^9, 
   3.84993139457652*^9}, {3.849936499751693*^9, 3.849936522953876*^9}, {
   3.8500933864282*^9, 3.850093395755972*^9}, {3.8500936471419897`*^9, 
   3.85009368571201*^9}, 3.8518569570609493`*^9, 3.853202602524168*^9, 
   3.853215130512108*^9, 3.857451044110569*^9, 3.871297285245735*^9, {
   3.871619444103547*^9, 3.871619451260944*^9}, {3.871619490117971*^9, 
   3.871619521315403*^9}, {3.871619619378182*^9, 3.87161962417244*^9}, {
   3.8716196556270733`*^9, 3.871619681596793*^9}, {3.871619831706586*^9, 
   3.871619864427882*^9}, {3.8716213205601892`*^9, 3.871621333226293*^9}, {
   3.871625017999157*^9, 3.871625241366728*^9}, {3.871625291216332*^9, 
   3.871625359241075*^9}, {3.871625493107828*^9, 3.8716254955113497`*^9}, {
   3.8716255615364437`*^9, 3.871625564022999*^9}, 3.871625841369969*^9, {
   3.87162607082874*^9, 3.871626075743566*^9}, {3.8716899594033813`*^9, 
   3.8716899600539207`*^9}, {3.8716900784125357`*^9, 
   3.8716900789351377`*^9}, {3.871705590182193*^9, 3.871705593089178*^9}, {
   3.871705721469871*^9, 3.871705813886736*^9}, {3.871705853265871*^9, 
   3.8717058662856207`*^9}, {3.8717059035408707`*^9, 3.871706011684908*^9}, 
   3.871706045343543*^9, {3.871706484816691*^9, 3.87170652555105*^9}, 
   3.8717069814938707`*^9, {3.871707150080432*^9, 3.871707168903172*^9}, {
   3.871707495653973*^9, 3.871707602306806*^9}, {3.8717076664684687`*^9, 
   3.871707692027851*^9}, {3.87170782927689*^9, 3.871707831107004*^9}, {
   3.8717078660880747`*^9, 3.871707868174891*^9}, 3.8717079100251617`*^9, 
   3.871708016362279*^9, 3.871708514321631*^9, {3.871709414281816*^9, 
   3.8717094266664257`*^9}, {3.8717108986134253`*^9, 3.871710934064623*^9}, 
   3.871711118911961*^9, 3.8717113235660048`*^9, 3.871711699746305*^9, {
   3.871711841537026*^9, 3.871711852394979*^9}, {3.871711988334196*^9, 
   3.871712020526985*^9}, {3.871715537622472*^9, 3.871715540368991*^9}, {
   3.872118897251507*^9, 3.872118897481187*^9}, {3.876454167099728*^9, 
   3.876454170049754*^9}},
 CellLabel->"In[87]:=",ExpressionUUID->"acba7d38-218d-4ab3-8d17-064d5bb3ae6c"]
}, Open  ]],

Cell[CellGroupData[{

Cell["MonomialTransformation", "Subsection",
 CellChangeTimes->{{3.871716025388597*^9, 
  3.871716031302944*^9}},ExpressionUUID->"ca53f43b-0c6f-4f8f-9ad8-\
87cfea3279c2"],

Cell[BoxData[{
 RowBox[{"ClearAll", "[", 
  RowBox[{"Mono2List", ",", "deg", ",", "degDotp"}], 
  "]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"deg", "[", 
   RowBox[{"f_", ",", "var_List"}], "]"}], ":=", 
  RowBox[{"Module", "[", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{
      RowBox[{"num", "=", 
       RowBox[{"Numerator", "[", "f", "]"}]}], ",", 
      RowBox[{"den", "=", 
       RowBox[{"Denominator", "[", "f", "]"}]}]}], "}"}], ",", 
    RowBox[{
     RowBox[{"(", 
      RowBox[{
       RowBox[{
        RowBox[{"Max", "[", 
         RowBox[{"Plus", "@@@", 
          RowBox[{
           RowBox[{"CoefficientRules", "[", 
            RowBox[{"#", ",", "var"}], "]"}], "[", 
           RowBox[{"[", 
            RowBox[{"All", ",", "1"}], "]"}], "]"}]}], "]"}], "&"}], "@", 
       RowBox[{"(", "num", ")"}]}], ")"}], "-", 
     RowBox[{"(", 
      RowBox[{
       RowBox[{
        RowBox[{"Max", "[", 
         RowBox[{"Plus", "@@@", 
          RowBox[{
           RowBox[{"CoefficientRules", "[", 
            RowBox[{"#", ",", "var"}], "]"}], "[", 
           RowBox[{"[", 
            RowBox[{"All", ",", "1"}], "]"}], "]"}]}], "]"}], "&"}], "@", 
       RowBox[{"(", "den", ")"}]}], ")"}]}]}], "]"}]}], "\n", 
 RowBox[{
  RowBox[{"degDotp", "[", "f_", "]"}], ":=", 
  RowBox[{"Module", "[", 
   RowBox[{
    RowBox[{"{", "x", "}"}], ",", 
    RowBox[{"deg", "[", 
     RowBox[{
      RowBox[{
       RowBox[{"f", "/.", 
        RowBox[{
         RowBox[{"dot", "[", 
          RowBox[{"a_p", ",", "b_p"}], "]"}], ":>", "x"}]}], "/.", 
       RowBox[{
        RowBox[{"dot", "[", "g__", "]"}], ":>", " ", "1"}]}], " ", ",", 
      RowBox[{"{", "x", "}"}]}], "]"}]}], "]"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"Mono2List", "[", 
   RowBox[{"f_", ",", "dimDen_"}], "]"}], ":=", 
  RowBox[{"FF", "[", 
   RowBox[{"1", ",", 
    RowBox[{"-", 
     RowBox[{"Table", "[", 
      RowBox[{
       RowBox[{"deg", "[", 
        RowBox[{"f", ",", 
         RowBox[{"{", 
          RowBox[{"\[ScriptCapitalD]", "[", "ii", "]"}], "}"}]}], "]"}], ",", 
       
       RowBox[{"{", 
        RowBox[{"ii", ",", "dimDen"}], "}"}]}], "]"}]}]}], "]"}]}], "\n", 
 RowBox[{
  RowBox[{"Mono2List", "[", 
   RowBox[{"f_", ",", "dimDen_List"}], "]"}], ":=", 
  RowBox[{"FF", "[", 
   RowBox[{"1", ",", 
    RowBox[{"-", 
     RowBox[{"Table", "[", 
      RowBox[{
       RowBox[{"deg", "[", 
        RowBox[{"f", ",", 
         RowBox[{"{", 
          RowBox[{"dimDen", "[", 
           RowBox[{"[", "ii", "]"}], "]"}], "}"}]}], "]"}], ",", 
       RowBox[{"{", 
        RowBox[{"ii", ",", 
         RowBox[{"Length", "@", "dimDen"}]}], "}"}]}], "]"}]}]}], 
   "]"}]}]}], "Input",
 CellChangeTimes->{{3.871716074820694*^9, 3.8717160840867434`*^9}},
 CellLabel->"In[89]:=",ExpressionUUID->"f8177a59-b548-4f5d-a062-3e46a97c4ed8"],

Cell[BoxData[{
 RowBox[{"ClearAll", "[", "GetDenominatorFun", "]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"GetDenominatorFun", "[", 
   RowBox[{"h_", ",", "vars_"}], "]"}], ":=", 
  RowBox[{"Module", "[", 
   RowBox[{
    RowBox[{"{", "alldeno", "}"}], ",", 
    RowBox[{
     RowBox[{"alldeno", "=", 
      RowBox[{"(", 
       RowBox[{"List", "@@", 
        RowBox[{"(", 
         RowBox[{
          RowBox[{"auxilaryVariables", "*", 
           RowBox[{"Denominator", "[", "h", "]"}]}], "/.", 
          RowBox[{
           RowBox[{"Power", "[", 
            RowBox[{"f_", ",", "n_"}], "]"}], ":>", " ", "f"}]}], ")"}]}], 
       ")"}]}], ";", 
     RowBox[{"Table", "[", 
      RowBox[{
       RowBox[{"If", "[", 
        RowBox[{
         RowBox[{
          RowBox[{"Intersection", "[", 
           RowBox[{
            RowBox[{
             RowBox[{"alldeno", "[", 
              RowBox[{"[", "i", "]"}], "]"}], "//", 
             RowBox[{
              RowBox[{"Cases", "[", 
               RowBox[{"#", ",", 
                RowBox[{"dot", "[", "__", "]"}], ",", 
                RowBox[{"{", 
                 RowBox[{"0", ",", "\[Infinity]"}], "}"}]}], "]"}], "&"}]}], 
            ",", "vars"}], "]"}], "==", 
          RowBox[{"{", "}"}]}], ",", "Nothing", ",", 
         RowBox[{"alldeno", "[", 
          RowBox[{"[", "i", "]"}], "]"}]}], "]"}], ",", 
       RowBox[{"{", 
        RowBox[{"i", ",", 
         RowBox[{"Length", "@", "alldeno"}]}], "}"}]}], "]"}]}]}], 
   "\[IndentingNewLine]", "]"}]}], "\[IndentingNewLine]", 
 RowBox[{"ClearAll", "[", "GenIBPdotList", "]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"GenIBPdotList", "[", 
   RowBox[{"h_", ",", "vars_List", ",", "numeratordots_List"}], "]"}], ":=", 
  RowBox[{"Module", "[", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{"pplist", ",", "he"}], "}"}], ",", 
    RowBox[{
     RowBox[{"he", "=", 
      RowBox[{"h", "//", "Expand"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"pplist", "=", 
      RowBox[{
       RowBox[{
        RowBox[{
         RowBox[{"GetDenominatorFun", "[", 
          RowBox[{"#", ",", "vars"}], "]"}], "&"}], "/@", 
        RowBox[{"(", 
         RowBox[{"List", "@@", "he"}], ")"}]}], "//", "Union"}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"pplist", "=", 
      RowBox[{"minSets", "[", "pplist", "]"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"(*", 
      RowBox[{
       RowBox[{"pplist", "=", 
        RowBox[{
         RowBox[{
          RowBox[{"Intersection", "[", 
           RowBox[{"#", ",", "vars"}], "]"}], "&"}], "/@", "pplist"}]}], 
       ";"}], "*)"}], "\[IndentingNewLine]", 
     RowBox[{"Table", "[", 
      RowBox[{
       RowBox[{
        RowBox[{
         RowBox[{"Join", "[", 
          RowBox[{
           RowBox[{"pplist", "[", 
            RowBox[{"[", "ii", "]"}], "]"}], ",", "numeratordots"}], "]"}], "//",
          "DeleteDuplicates"}], "//", "Union"}], ",", 
       RowBox[{"{", 
        RowBox[{"ii", ",", 
         RowBox[{"Length", "@", "pplist"}]}], "}"}]}], "]"}]}]}], 
   "\[IndentingNewLine]", "]"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"GenIBPdotList", "[", 
   RowBox[{"h_", ",", "vars_List"}], "]"}], ":=", 
  RowBox[{"Module", "[", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{"pplist", ",", "he"}], "}"}], ",", 
    RowBox[{
     RowBox[{"he", "=", 
      RowBox[{"h", "//", "Expand"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"pplist", "=", 
      RowBox[{
       RowBox[{
        RowBox[{
         RowBox[{"GetDenominatorFun", "[", 
          RowBox[{"#", ",", "vars"}], "]"}], "&"}], "/@", 
        RowBox[{"(", 
         RowBox[{"List", "@@", "he"}], ")"}]}], "//", "Union"}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"pplist", "=", 
      RowBox[{"minSets", "[", "pplist", "]"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"Table", "[", 
      RowBox[{
       RowBox[{"Join", "[", 
        RowBox[{
         RowBox[{"pplist", "[", 
          RowBox[{"[", "ii", "]"}], "]"}], ",", 
         RowBox[{"Complement", "[", 
          RowBox[{"vars", ",", 
           RowBox[{
            RowBox[{"pplist", "[", 
             RowBox[{"[", "ii", "]"}], "]"}], "//", 
            RowBox[{
             RowBox[{"Cases", "[", 
              RowBox[{"#", ",", 
               RowBox[{"dot", "[", "__", "]"}], ",", 
               RowBox[{"{", 
                RowBox[{"0", ",", "\[Infinity]"}], "}"}]}], "]"}], "&"}]}]}], 
          "]"}]}], "]"}], ",", 
       RowBox[{"{", 
        RowBox[{"ii", ",", 
         RowBox[{"Length", "@", "pplist"}]}], "}"}]}], "]"}]}]}], 
   "\[IndentingNewLine]", "]"}]}], "\[IndentingNewLine]", 
 RowBox[{"ClearAll", "[", 
  RowBox[{"mono2j", ",", "mono2B"}], "]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"mono2j", "[", 
   RowBox[{"g_", ",", "pplist_", ",", "vars_"}], "]"}], ":=", 
  RowBox[{"Module", "[", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{
     "numt", ",", "pid", ",", "dds", ",", "dot2D", ",", "propgatorlist"}], 
     "}"}], ",", 
    RowBox[{
     RowBox[{"numt", "=", "g"}], ";", "\[IndentingNewLine]", 
     RowBox[{"propgatorlist", "=", 
      RowBox[{"GetDenominatorFun", "[", 
       RowBox[{"numt", ",", "vars"}], "]"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"pid", "=", 
      RowBox[{
       RowBox[{
        RowBox[{"Position", "[", 
         RowBox[{
          RowBox[{
           RowBox[{
            RowBox[{"SubsetQ", "[", 
             RowBox[{"#", ",", "propgatorlist"}], "]"}], "&"}], "/@", 
           "pplist"}], ",", "True"}], "]"}], "//", "Flatten"}], "//", 
       "First"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"dds", "=", 
      RowBox[{"Table", "[", 
       RowBox[{
        RowBox[{"\[ScriptCapitalD]", "[", "ii", "]"}], ",", 
        RowBox[{"{", 
         RowBox[{"ii", ",", 
          RowBox[{"Length", "@", 
           RowBox[{"pplist", "[", 
            RowBox[{"[", "pid", "]"}], "]"}]}]}], "}"}]}], "]"}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"dot2D", "=", 
      RowBox[{
       RowBox[{"Solve", "[", 
        RowBox[{
         RowBox[{
          RowBox[{"pplist", "[", 
           RowBox[{"[", "pid", "]"}], "]"}], "==", "dds"}], ",", "vars"}], 
        "]"}], "[", 
       RowBox[{"[", "1", "]"}], "]"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"numt", "=", 
      RowBox[{
       RowBox[{"numt", "/.", "dot2D"}], "//", "Expand"}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"numt", "=", 
      RowBox[{"If", "[", 
       RowBox[{
        RowBox[{
         RowBox[{"Head", "[", "numt", "]"}], "===", "Plus"}], ",", 
        RowBox[{"List", "@@", "numt"}], ",", 
        RowBox[{"{", "numt", "}"}]}], "]"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"(*", 
      RowBox[{
       RowBox[{"Print", "[", "numt", "]"}], ";"}], "*)"}], 
     "\[IndentingNewLine]", 
     RowBox[{"numt", "=", 
      RowBox[{"Sum", "[", 
       RowBox[{
        RowBox[{
         RowBox[{
          RowBox[{"(", 
           RowBox[{
            RowBox[{"numt", "[", 
             RowBox[{"[", "ii", "]"}], "]"}], "/.", 
            RowBox[{
             RowBox[{"\[ScriptCapitalD]", "[", "i_", "]"}], ":>", " ", 
             "1"}]}], ")"}], 
          RowBox[{"Mono2List", "[", 
           RowBox[{
            RowBox[{"numt", "[", 
             RowBox[{"[", "ii", "]"}], "]"}], ",", "dds"}], "]"}]}], "/.", 
         RowBox[{
          RowBox[{"FF", "[", 
           RowBox[{"1", ",", 
            RowBox[{"{", "f___", "}"}]}], "]"}], ":>", " ", 
          RowBox[{"j", "[", 
           RowBox[{
            RowBox[{"ToExpression", "[", 
             RowBox[{"\"\<gr\>\"", "<>", 
              RowBox[{"ToString", "[", "pid", "]"}]}], "]"}], ",", "f"}], 
           "]"}]}]}], ",", 
        RowBox[{"{", 
         RowBox[{"ii", ",", 
          RowBox[{"Length", "@", "numt"}]}], "}"}]}], "]"}]}]}]}], 
   "\[IndentingNewLine]", "]"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"mono2j", "[", 
   RowBox[{"g_", ",", "pplist_"}], "]"}], ":=", 
  RowBox[{"Module", "[", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{
     "numt", ",", "pid", ",", "dds", ",", "dot2D", ",", "propgatorlist"}], 
     "}"}], ",", 
    RowBox[{
     RowBox[{"numt", "=", "g"}], ";", "\[IndentingNewLine]", 
     RowBox[{"(*", 
      RowBox[{
       RowBox[{"propgatorlist", "=", 
        RowBox[{"GetDenominatorFun", "[", 
         RowBox[{"numt", ",", "vars"}], "]"}]}], ";", "\[IndentingNewLine]", 
       RowBox[{"pid", "=", 
        RowBox[{
         RowBox[{
          RowBox[{"Position", "[", 
           RowBox[{
            RowBox[{
             RowBox[{
              RowBox[{"SubsetQ", "[", 
               RowBox[{"#", ",", "propgatorlist"}], "]"}], "&"}], "/@", 
             "pplist"}], ",", "True"}], "]"}], "//", "Flatten"}], "//", 
         "First"}]}], ";"}], "*)"}], "\[IndentingNewLine]", 
     RowBox[{"dds", "=", 
      RowBox[{"Table", "[", 
       RowBox[{
        RowBox[{"\[ScriptCapitalD]", "[", "ii", "]"}], ",", 
        RowBox[{"{", 
         RowBox[{"ii", ",", 
          RowBox[{"Length", "@", "pplist"}]}], "}"}]}], "]"}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"dot2D", "=", 
      RowBox[{
       RowBox[{"Solve", "[", 
        RowBox[{
         RowBox[{"pplist", "==", "dds"}], ",", "pplist"}], "]"}], "[", 
       RowBox[{"[", "1", "]"}], "]"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"numt", "=", 
      RowBox[{
       RowBox[{"numt", "/.", "dot2D"}], "//", "Expand"}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"numt", "=", 
      RowBox[{"If", "[", 
       RowBox[{
        RowBox[{
         RowBox[{"Head", "[", "numt", "]"}], "===", "Plus"}], ",", 
        RowBox[{"List", "@@", "numt"}], ",", 
        RowBox[{"{", "numt", "}"}]}], "]"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"(*", 
      RowBox[{
       RowBox[{"Print", "[", "numt", "]"}], ";"}], "*)"}], 
     "\[IndentingNewLine]", 
     RowBox[{"numt", "=", 
      RowBox[{"Sum", "[", 
       RowBox[{
        RowBox[{
         RowBox[{
          RowBox[{"(", 
           RowBox[{
            RowBox[{"numt", "[", 
             RowBox[{"[", "ii", "]"}], "]"}], "/.", 
            RowBox[{
             RowBox[{"\[ScriptCapitalD]", "[", "i_", "]"}], ":>", " ", 
             "1"}]}], ")"}], 
          RowBox[{"Mono2List", "[", 
           RowBox[{
            RowBox[{"numt", "[", 
             RowBox[{"[", "ii", "]"}], "]"}], ",", "dds"}], "]"}]}], "/.", 
         RowBox[{
          RowBox[{"FF", "[", 
           RowBox[{"1", ",", 
            RowBox[{"{", "f___", "}"}]}], "]"}], ":>", " ", 
          RowBox[{"B", "@@", 
           RowBox[{"(", 
            RowBox[{"-", 
             RowBox[{"{", "f", "}"}]}], ")"}]}]}]}], ",", 
        RowBox[{"{", 
         RowBox[{"ii", ",", 
          RowBox[{"Length", "@", "numt"}]}], "}"}]}], "]"}]}]}]}], 
   "\[IndentingNewLine]", "]"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"mono2B", "[", 
   RowBox[{"g_", ",", "pplist_"}], "]"}], ":=", 
  RowBox[{"Module", "[", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{
     "numt", ",", "pid", ",", "dds", ",", "dot2D", ",", "propgatorlist"}], 
     "}"}], ",", 
    RowBox[{
     RowBox[{"numt", "=", "g"}], ";", "\[IndentingNewLine]", 
     RowBox[{"(*", 
      RowBox[{
       RowBox[{"propgatorlist", "=", 
        RowBox[{"GetDenominatorFun", "[", 
         RowBox[{"numt", ",", "vars"}], "]"}]}], ";", "\[IndentingNewLine]", 
       RowBox[{"pid", "=", 
        RowBox[{
         RowBox[{
          RowBox[{"Position", "[", 
           RowBox[{
            RowBox[{
             RowBox[{
              RowBox[{"SubsetQ", "[", 
               RowBox[{"#", ",", "propgatorlist"}], "]"}], "&"}], "/@", 
             "pplist"}], ",", "True"}], "]"}], "//", "Flatten"}], "//", 
         "First"}]}], ";"}], "*)"}], "\[IndentingNewLine]", 
     RowBox[{"dds", "=", 
      RowBox[{"Table", "[", 
       RowBox[{
        RowBox[{"\[ScriptCapitalD]", "[", "ii", "]"}], ",", 
        RowBox[{"{", 
         RowBox[{"ii", ",", 
          RowBox[{"Length", "@", "pplist"}]}], "}"}]}], "]"}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"dot2D", "=", 
      RowBox[{"MapThread", "[", 
       RowBox[{"Rule", ",", 
        RowBox[{"{", 
         RowBox[{"pplist", ",", "dds"}], "}"}]}], "]"}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"numt", "=", 
      RowBox[{
       RowBox[{"numt", "/.", "dot2D"}], "//", "Expand"}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"numt", "=", 
      RowBox[{"If", "[", 
       RowBox[{
        RowBox[{
         RowBox[{"Head", "[", "numt", "]"}], "===", "Plus"}], ",", 
        RowBox[{"List", "@@", "numt"}], ",", 
        RowBox[{"{", "numt", "}"}]}], "]"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"(*", 
      RowBox[{
       RowBox[{"Print", "[", "numt", "]"}], ";"}], "*)"}], 
     "\[IndentingNewLine]", 
     RowBox[{"numt", "=", 
      RowBox[{"Sum", "[", 
       RowBox[{
        RowBox[{
         RowBox[{
          RowBox[{"(", 
           RowBox[{
            RowBox[{"numt", "[", 
             RowBox[{"[", "ii", "]"}], "]"}], "/.", 
            RowBox[{
             RowBox[{"\[ScriptCapitalD]", "[", "i_", "]"}], ":>", " ", 
             "1"}]}], ")"}], 
          RowBox[{"Mono2List", "[", 
           RowBox[{
            RowBox[{"numt", "[", 
             RowBox[{"[", "ii", "]"}], "]"}], ",", "dds"}], "]"}]}], "/.", 
         RowBox[{
          RowBox[{"FF", "[", 
           RowBox[{"1", ",", 
            RowBox[{"{", "f___", "}"}]}], "]"}], ":>", " ", 
          RowBox[{"B", "@@", 
           RowBox[{"(", 
            RowBox[{"-", 
             RowBox[{"{", "f", "}"}]}], ")"}]}]}]}], ",", 
        RowBox[{"{", 
         RowBox[{"ii", ",", 
          RowBox[{"Length", "@", "numt"}]}], "}"}]}], "]"}]}]}]}], 
   "\[IndentingNewLine]", "]"}]}]}], "Input",
 CellChangeTimes->{{3.87013929658813*^9, 3.87013929709615*^9}, 
   3.87015456888785*^9, {3.870155204422731*^9, 3.870155217666298*^9}, {
   3.8701553410718737`*^9, 3.87015535134295*^9}, 3.870155401400276*^9, {
   3.8704311873876657`*^9, 3.870431268553248*^9}, {3.8705917169072323`*^9, 
   3.870591717418168*^9}, {3.876610362699594*^9, 3.8766104319483433`*^9}, {
   3.876610942764016*^9, 3.876610989180686*^9}},
 CellLabel->"In[94]:=",ExpressionUUID->"99fc1734-0a78-4f56-9085-9e1deef01c83"]
}, Closed]],

Cell[CellGroupData[{

Cell["Levi-Civita Expansion", "Subsection",
 CellChangeTimes->{{3.8768839877249594`*^9, 
  3.8768840068850174`*^9}},ExpressionUUID->"a0b21b7b-22d9-43b7-b714-\
f04ca4b20753"],

Cell[BoxData[{
 RowBox[{"ClearAll", "[", "etaMatrix", "]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"etaMatrix", "[", 
    RowBox[{
    "x1_", ",", "x2_", ",", "x3_", ",", "x4_", ",", "x5_", ",", "x6_", ",", 
     "x7_", ",", "x8_"}], "]"}], ":=", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{
       RowBox[{"dot", "[", 
        RowBox[{"x1", ",", "x3"}], "]"}], ",", 
       RowBox[{"dot", "[", 
        RowBox[{"x1", ",", "x4"}], "]"}], ",", 
       RowBox[{"dot", "[", 
        RowBox[{"x1", ",", "x7"}], "]"}], ",", 
       RowBox[{"dot", "[", 
        RowBox[{"x1", ",", "x8"}], "]"}]}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"dot", "[", 
        RowBox[{"x2", ",", "x3"}], "]"}], ",", 
       RowBox[{"dot", "[", 
        RowBox[{"x2", ",", "x4"}], "]"}], ",", 
       RowBox[{"dot", "[", 
        RowBox[{"x2", ",", "x7"}], "]"}], ",", 
       RowBox[{"dot", "[", 
        RowBox[{"x2", ",", "x8"}], "]"}]}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"dot", "[", 
        RowBox[{"x5", ",", "x3"}], "]"}], ",", 
       RowBox[{"dot", "[", 
        RowBox[{"x5", ",", "x4"}], "]"}], ",", 
       RowBox[{"dot", "[", 
        RowBox[{"x5", ",", "x7"}], "]"}], ",", 
       RowBox[{"dot", "[", 
        RowBox[{"x5", ",", "x8"}], "]"}]}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"dot", "[", 
        RowBox[{"x6", ",", "x3"}], "]"}], ",", 
       RowBox[{"dot", "[", 
        RowBox[{"x6", ",", "x4"}], "]"}], ",", 
       RowBox[{"dot", "[", 
        RowBox[{"x6", ",", "x7"}], "]"}], ",", 
       RowBox[{"dot", "[", 
        RowBox[{"x6", ",", "x8"}], "]"}]}], "}"}]}], "}"}]}], ";"}]}], "Input",\

 CellChangeTimes->{{3.87742287808566*^9, 3.8774229129952793`*^9}, {
  3.8774230721070642`*^9, 3.8774230801424713`*^9}, {3.877423501400942*^9, 
  3.877423508889386*^9}, {3.877423973554997*^9, 3.8774239752112007`*^9}},
 CellLabel->
  "In[103]:=",ExpressionUUID->"90a8135e-812a-4d57-9d3d-6bdd9005cd47"],

Cell[BoxData[{
 RowBox[{"ClearAll", "[", "expandFS", "]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"expandFS", "[", "f_", "]"}], ":=", 
  RowBox[{
   RowBox[{"(", 
    RowBox[{"f", "//", "expandFDirect"}], ")"}], "/.", 
   RowBox[{
    RowBox[{"dot", "[", "g__", "]"}], ":>", 
    RowBox[{"(", 
     RowBox[{
      RowBox[{
       RowBox[{"(", 
        RowBox[{
         RowBox[{"dot", "[", "g", "]"}], "//", "expandGen"}], ")"}], "/.", 
       RowBox[{
        RowBox[{
         RowBox[{
          RowBox[{"S", "[", "0", "]"}], "[", 
          RowBox[{"a_", ",", "b_"}], "]"}], " ", 
         RowBox[{
          RowBox[{"S", "[", "0", "]"}], "[", 
          RowBox[{"c_", ",", "d_"}], "]"}]}], ":>", 
        RowBox[{"Det", "[", 
         RowBox[{"etaMatrix", "[", 
          RowBox[{"a", ",", "b", ",", "c", ",", "d", ",", 
           RowBox[{"v", "[", "1", "]"}], ",", 
           RowBox[{"as", "[", "1", "]"}], ",", 
           RowBox[{"v", "[", "1", "]"}], ",", 
           RowBox[{"as", "[", "1", "]"}]}], "]"}], "]"}]}]}], "//", 
      "contractAnti"}], ")"}]}]}]}]}], "Input",
 CellChangeTimes->{{3.8774239821267138`*^9, 3.877424021716002*^9}, {
  3.87742429888728*^9, 3.877424396304152*^9}, {3.8774246172079277`*^9, 
  3.8774246345014153`*^9}},
 CellLabel->
  "In[105]:=",ExpressionUUID->"cc21b2cf-79d9-4be8-990b-72e461cf7fe8"]
}, Open  ]]
}, Closed]],

Cell[CellGroupData[{

Cell["SubFunctions Spin Ansatz", "Section",
 CellChangeTimes->{{3.8768042159264*^9, 3.876804221321859*^9}, {
  3.877066238287374*^9, 
  3.877066252520989*^9}},ExpressionUUID->"920e92b2-f483-4633-8572-\
95f7ad2029ee"],

Cell[BoxData[{
 RowBox[{"ClearAll", "[", 
  RowBox[{
  "KSetPartitions", ",", "SetPartitions", ",", "KSetPartitionsEmpty"}], 
  "]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"KSetPartitions", "[", 
   RowBox[{"0", ",", " ", "0"}], "]"}], " ", ":=", " ", 
  RowBox[{"{", 
   RowBox[{"{", "}"}], "}"}]}], "\n", 
 RowBox[{
  RowBox[{"KSetPartitions", "[", 
   RowBox[{
    RowBox[{"{", "}"}], ",", " ", "0"}], "]"}], " ", ":=", " ", 
  RowBox[{"{", 
   RowBox[{"{", "}"}], "}"}]}], "\n", 
 RowBox[{
  RowBox[{"KSetPartitions", "[", 
   RowBox[{"s_List", ",", " ", "0"}], "]"}], " ", ":=", " ", 
  RowBox[{"{", "}"}]}], "\n", 
 RowBox[{
  RowBox[{
   RowBox[{"KSetPartitions", "[", 
    RowBox[{"s_List", ",", " ", "k_Integer"}], "]"}], " ", ":=", " ", 
   RowBox[{
    RowBox[{"{", "}"}], " ", "/;", " ", 
    RowBox[{"k", " ", ">", " ", 
     RowBox[{"Length", "[", "s", "]"}]}]}]}], " "}], "\n", 
 RowBox[{
  RowBox[{"KSetPartitions", "[", 
   RowBox[{"s_List", ",", " ", "k_Integer"}], "]"}], " ", ":=", " ", 
  RowBox[{
   RowBox[{"{", 
    RowBox[{
     RowBox[{"(", 
      RowBox[{
       RowBox[{"{", "#1", "}"}], " ", "&"}], " ", ")"}], " ", "/@", " ", 
     "s"}], "}"}], " ", "/;", " ", 
   RowBox[{"k", " ", "===", " ", 
    RowBox[{"Length", "[", "s", "]"}]}]}]}], "\n", 
 RowBox[{
  RowBox[{"KSetPartitions", "[", 
   RowBox[{"s_List", ",", " ", "k_Integer"}], "]"}], " ", ":=", " ", 
  RowBox[{
   RowBox[{"Block", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{
       RowBox[{"$RecursionLimit", " ", "=", " ", "Infinity"}], ",", " ", 
       "j"}], "}"}], ",", " ", 
     RowBox[{"Join", "[", 
      RowBox[{
       RowBox[{
        RowBox[{"(", 
         RowBox[{
          RowBox[{"Prepend", "[", 
           RowBox[{"#1", ",", " ", 
            RowBox[{"{", 
             RowBox[{"First", "[", "s", "]"}], "}"}]}], "]"}], " ", "&"}], 
         " ", ")"}], " ", "/@", " ", 
        RowBox[{"KSetPartitions", "[", 
         RowBox[{
          RowBox[{"Rest", "[", "s", "]"}], ",", " ", 
          RowBox[{"k", " ", "-", " ", "1"}]}], "]"}]}], ",", " ", 
       RowBox[{"Flatten", "[", 
        RowBox[{
         RowBox[{
          RowBox[{"(", 
           RowBox[{
            RowBox[{"Table", "[", 
             RowBox[{
              RowBox[{"Prepend", "[", 
               RowBox[{
                RowBox[{"Delete", "[", 
                 RowBox[{"#1", ",", " ", "j"}], "]"}], ",", " ", 
                RowBox[{"Prepend", "[", 
                 RowBox[{
                  RowBox[{"#1", "[", 
                   RowBox[{"[", "j", "]"}], "]"}], ",", " ", 
                  RowBox[{"s", "[", 
                   RowBox[{"[", "1", "]"}], "]"}]}], "]"}]}], "]"}], ",", " ", 
              RowBox[{"{", 
               RowBox[{"j", ",", " ", 
                RowBox[{"Length", "[", "#1", "]"}]}], "}"}]}], "]"}], " ", 
            "&"}], " ", ")"}], " ", "/@", " ", 
          RowBox[{"KSetPartitions", "[", 
           RowBox[{
            RowBox[{"Rest", "[", "s", "]"}], ",", " ", "k"}], "]"}]}], ",", 
         " ", "1"}], "]"}]}], "]"}]}], "]"}], " ", "/;", " ", 
   RowBox[{
    RowBox[{"k", " ", ">", " ", "0"}], " ", "&&", " ", 
    RowBox[{"k", " ", "<", " ", 
     RowBox[{"Length", "[", "s", "]"}]}]}]}]}], "\n", 
 RowBox[{
  RowBox[{"KSetPartitions", "[", 
   RowBox[{"0", ",", " ", 
    RowBox[{
     RowBox[{"(", "k_Integer", ")"}], "?", "Positive"}]}], "]"}], " ", ":=", 
  " ", 
  RowBox[{"{", "}"}]}], "\n", 
 RowBox[{
  RowBox[{"KSetPartitions", "[", 
   RowBox[{
    RowBox[{
     RowBox[{"(", "n_Integer", ")"}], "?", "Positive"}], ",", " ", "0"}], 
   "]"}], " ", ":=", " ", 
  RowBox[{"{", "}"}]}], "\n", 
 RowBox[{
  RowBox[{"KSetPartitions", "[", 
   RowBox[{
    RowBox[{
     RowBox[{"(", "n_Integer", ")"}], "?", "Positive"}], ",", " ", 
    RowBox[{
     RowBox[{"(", "k_Integer", ")"}], "?", "Positive"}]}], "]"}], " ", ":=", 
  " ", 
  RowBox[{"KSetPartitions", "[", 
   RowBox[{
    RowBox[{"Range", "[", "n", "]"}], ",", " ", "k"}], 
   "]"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"SetPartitions", "[", "0", "]"}], " ", ":=", " ", 
  RowBox[{"{", 
   RowBox[{"{", "}"}], "}"}]}], "\n", 
 RowBox[{
  RowBox[{"SetPartitions", "[", 
   RowBox[{"{", "}"}], "]"}], " ", ":=", " ", 
  RowBox[{"{", 
   RowBox[{"{", "}"}], "}"}]}], "\n", 
 RowBox[{
  RowBox[{"SetPartitions", "[", "s_List", "]"}], " ", ":=", " ", 
  RowBox[{"Flatten", "[", 
   RowBox[{
    RowBox[{"Table", "[", 
     RowBox[{
      RowBox[{"KSetPartitions", "[", 
       RowBox[{"s", ",", " ", "i"}], "]"}], ",", " ", 
      RowBox[{"{", 
       RowBox[{"i", ",", " ", "2", ",", 
        RowBox[{
         RowBox[{"Length", "[", "s", "]"}], "-", "2"}]}], "}"}]}], "]"}], ",",
     " ", "1"}], "]"}]}], "\n", 
 RowBox[{
  RowBox[{"SetPartitions", "[", 
   RowBox[{
    RowBox[{"(", "n_Integer", ")"}], "?", "Positive"}], "]"}], " ", ":=", " ", 
  RowBox[{"SetPartitions", "[", 
   RowBox[{"Range", "[", "n", "]"}], "]"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"KSetPartitionsEmpty", "[", 
    RowBox[{"s_List", ",", "k_Integer"}], "]"}], ":=", 
   RowBox[{"Module", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"app", ",", "KMod"}], "}"}], ",", 
     RowBox[{
      RowBox[{"app", "=", 
       RowBox[{"KSetPartitions", "[", 
        RowBox[{"s", ",", "k"}], "]"}]}], ";", 
      RowBox[{"Do", "[", 
       RowBox[{
        RowBox[{
         RowBox[{"KMod", "=", 
          RowBox[{"KSetPartitions", "[", 
           RowBox[{"s", ",", "q"}], "]"}]}], ";", 
         RowBox[{"Do", "[", 
          RowBox[{
           RowBox[{
            RowBox[{"Do", "[", 
             RowBox[{
              RowBox[{"AppendTo", "[", 
               RowBox[{
                RowBox[{"KMod", "[", 
                 RowBox[{"[", "i", "]"}], "]"}], ",", 
                RowBox[{"{", "}"}]}], "]"}], ",", 
              RowBox[{"{", 
               RowBox[{"j", ",", "1", ",", 
                RowBox[{"k", "-", "q"}]}], "}"}]}], "]"}], ";", 
            RowBox[{"AppendTo", "[", 
             RowBox[{"app", ",", 
              RowBox[{"KMod", "[", 
               RowBox[{"[", "i", "]"}], "]"}]}], "]"}]}], ",", 
           RowBox[{"{", 
            RowBox[{"i", ",", 
             RowBox[{"Length", "[", 
              RowBox[{"KSetPartitions", "[", 
               RowBox[{"s", ",", "q"}], "]"}], "]"}]}], "}"}]}], "]"}]}], ",", 
        RowBox[{"{", 
         RowBox[{"q", ",", "1", ",", 
          RowBox[{"k", "-", "1"}]}], "}"}]}], "]"}], ";", 
      RowBox[{"Return", "[", "app", "]"}]}]}], "]"}]}], ";"}]}], "Input",
 CellChangeTimes->{{3.876811307266223*^9, 3.876811357406602*^9}, {
  3.876814773296413*^9, 3.876814814709012*^9}, {3.8768150847160673`*^9, 
  3.876815104266962*^9}},
 CellLabel->
  "In[107]:=",ExpressionUUID->"a59468cd-400d-4953-be9d-1224995358e2"],

Cell[BoxData[{
 RowBox[{"ClearAll", "[", "monomialsAnsSingle", 
  "]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"monomialsAnsSingle", "[", 
   RowBox[{"lv_", ",", "od_List", ",", "rv_"}], "]"}], ":=", 
  RowBox[{"Module", "[", 
   RowBox[{
    RowBox[{"{", "pt", "}"}], ",", 
    RowBox[{
     RowBox[{"pt", "=", 
      RowBox[{
       RowBox[{"Permutations", "[", "od", "]"}], "//", "DeleteDuplicates"}]}],
      ";", 
     RowBox[{"(", 
      RowBox[{
       RowBox[{
        RowBox[{"dot", "[", 
         RowBox[{"lv", ",", "##", ",", "rv"}], "]"}], "&"}], "@@@", "pt"}], 
      ")"}]}]}], "]"}]}]}], "Input",
 CellChangeTimes->{{3.876804285141453*^9, 3.876804311219627*^9}, {
   3.876804354297196*^9, 3.876804394553791*^9}, {3.876804547147678*^9, 
   3.876804564077526*^9}, 3.8768046310569696`*^9, {3.8768046788966293`*^9, 
   3.876804767317877*^9}, {3.876804900865148*^9, 3.87680509438022*^9}, {
   3.8768051395051527`*^9, 3.876805155807871*^9}, {3.876805253968152*^9, 
   3.876805264267679*^9}, {3.8768053169740458`*^9, 3.876805320484037*^9}, 
   3.876805351239914*^9, {3.8768054423488283`*^9, 3.8768054713281593`*^9}, {
   3.8768055021330214`*^9, 3.876805503038082*^9}, {3.87680557435063*^9, 
   3.8768056288868513`*^9}, {3.876806417065815*^9, 3.876806469431156*^9}, {
   3.876810617157659*^9, 3.876810647969964*^9}, 3.876810746169541*^9, 
   3.877066211011817*^9},
 CellLabel->
  "In[122]:=",ExpressionUUID->"b391ede9-be00-4b65-b0fd-aa1f912d39f2"],

Cell[BoxData[{
 RowBox[{"ClearAll", "[", "partitions", "]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"partitions", "[", 
   RowBox[{"list_", ",", "l_"}], "]"}], ":=", 
  RowBox[{"Join", "@@", 
   RowBox[{"Table", "[", 
    RowBox[{
     RowBox[{
      RowBox[{
       RowBox[{"{", 
        RowBox[{"x", ",", "##"}], "}"}], "&"}], "@@@", 
      RowBox[{"partitions", "[", 
       RowBox[{
        RowBox[{"list", "~", "Complement", "~", "x"}], ",", "l"}], "]"}]}], 
     ",", 
     RowBox[{"{", 
      RowBox[{"x", ",", 
       RowBox[{"Subsets", "[", 
        RowBox[{"list", ",", 
         RowBox[{"{", "l", "}"}], ",", 
         RowBox[{"Binomial", "[", 
          RowBox[{
           RowBox[{
            RowBox[{"Length", "[", "list", "]"}], "-", "1"}], ",", 
           RowBox[{"l", "-", "1"}]}], "]"}]}], "]"}]}], "}"}]}], 
    "]"}]}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"partitions", "[", 
    RowBox[{"list_", ",", "l_"}], "]"}], "/;", 
   RowBox[{
    RowBox[{"Length", "[", "list", "]"}], "===", "l"}]}], ":=", 
  RowBox[{"{", 
   RowBox[{"{", "list", "}"}], "}"}]}]}], "Input",
 CellChangeTimes->{{3.876813314352524*^9, 3.876813328750271*^9}},
 CellLabel->
  "In[124]:=",ExpressionUUID->"55f9f031-ef59-4843-b717-d41b3d5f725a"],

Cell[BoxData[{
 RowBox[{"ClearAll", "[", "monoAllF", "]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"monoAllF", "[", 
   RowBox[{"ptsets_", ",", "vs_"}], "]"}], ":=", 
  RowBox[{"Module", "[", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{"mono1", ",", "mono2", ",", "monoAll", ",", "a"}], "}"}], ",", 
    RowBox[{
     RowBox[{
      RowBox[{"Table", "[", 
       RowBox[{
        RowBox[{
         RowBox[{"mono1", "=", 
          RowBox[{"Table", "[", 
           RowBox[{
            RowBox[{
             RowBox[{"monomialsAnsSingle", "[", 
              RowBox[{
               RowBox[{"vs", "[", 
                RowBox[{"[", 
                 RowBox[{"jj", ",", "1"}], "]"}], "]"}], ",", 
               RowBox[{"ptsets", "[", 
                RowBox[{"[", 
                 RowBox[{"ii", ",", "jj"}], "]"}], "]"}], ",", 
               RowBox[{"vs", "[", 
                RowBox[{"[", 
                 RowBox[{"jj", ",", "2"}], "]"}], "]"}]}], "]"}], "//", 
             "Total"}], ",", 
            RowBox[{"{", 
             RowBox[{"jj", ",", 
              RowBox[{"Length", "@", 
               RowBox[{"ptsets", "[", 
                RowBox[{"[", "ii", "]"}], "]"}]}]}], "}"}]}], "]"}]}], ";", 
         "\[IndentingNewLine]", 
         RowBox[{"mono2", "=", 
          RowBox[{"(", 
           RowBox[{"Times", "@@", "mono1"}], ")"}]}], ";", 
         "\[IndentingNewLine]", 
         RowBox[{"monoAll", "=", 
          RowBox[{"DeleteCases", "[", 
           RowBox[{
            RowBox[{"List", "@@", 
             RowBox[{"(", 
              RowBox[{
               RowBox[{"a", "+", "mono2"}], "//", "Expand"}], ")"}]}], ",", 
            "a"}], "]"}]}]}], ",", 
        RowBox[{"{", 
         RowBox[{"ii", ",", 
          RowBox[{"Length", "@", "ptsets"}]}], "}"}]}], "]"}], "//", 
      "Flatten"}], "//", "DeleteDuplicates"}]}], "]"}]}]}], "Input",
 CellChangeTimes->{{3.876811369960775*^9, 3.8768113727341633`*^9}, {
   3.876811485009445*^9, 3.876811595092298*^9}, {3.876811639699731*^9, 
   3.876811640893647*^9}, 3.8768116783304043`*^9, {3.876811716061986*^9, 
   3.876811732470446*^9}, {3.876811790156522*^9, 3.876811796540135*^9}, {
   3.8768118801902447`*^9, 3.876811892921207*^9}, {3.876811927282494*^9, 
   3.876812045955064*^9}, {3.876812090166971*^9, 3.876812166246018*^9}, {
   3.876812217543675*^9, 3.8768122751008883`*^9}, {3.876812307151626*^9, 
   3.876812392859235*^9}, 3.876812451314582*^9, 3.8773367732900352`*^9, {
   3.877344524700871*^9, 3.877344554764751*^9}, {3.8773446377947187`*^9, 
   3.877344642934064*^9}, {3.877344709517954*^9, 3.8773447168750067`*^9}, {
   3.877344826511199*^9, 3.877344918321042*^9}, {3.877351477664247*^9, 
   3.8773514780370626`*^9}, {3.877351529018159*^9, 3.877351561254724*^9}, {
   3.877353282330694*^9, 3.877353342917494*^9}, {3.877353392697257*^9, 
   3.8773534009593678`*^9}},
 CellLabel->
  "In[127]:=",ExpressionUUID->"c5bb3695-411a-4d6d-9a74-02514b7878ff"],

Cell[BoxData[{
 RowBox[{"ClearAll", "[", "BoundaryPatitions", "]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"BoundaryPatitions", "[", "ls_List", "]"}], ":=", 
  RowBox[{"Module", "[", 
   RowBox[{
    RowBox[{"{", "L", "}"}], ",", 
    RowBox[{
     RowBox[{"(", 
      RowBox[{
       RowBox[{
        RowBox[{"L", "@@@", 
         RowBox[{"Permutations", "[", "ls", "]"}]}], "/.", 
        RowBox[{
         RowBox[{"L", "[", "f__", "]"}], ":>", 
         RowBox[{"L", "@@", 
          RowBox[{"Sort", "/@", 
           RowBox[{"ArrayReshape", "[", 
            RowBox[{
             RowBox[{"{", "f", "}"}], ",", 
             RowBox[{"{", 
              RowBox[{
               RowBox[{
                FractionBox["1", "2"], 
                RowBox[{"Length", "@", 
                 RowBox[{"{", "f", "}"}]}]}], ",", "2"}], "}"}]}], 
            "]"}]}]}]}]}], "//", "Union"}], ")"}], "/.", 
     RowBox[{
      RowBox[{"L", "[", "g__", "]"}], ":>", 
      RowBox[{"{", "g", "}"}]}]}]}], "]"}]}]}], "Input",
 CellChangeTimes->{{3.87733744584068*^9, 3.877337473186795*^9}},
 CellLabel->
  "In[129]:=",ExpressionUUID->"7e5a8741-43ac-4327-aa5f-6dbd2093223d"],

Cell[BoxData[{
 RowBox[{"ClearAll", "[", "BoundaryVectors", "]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"BoundaryVectors", "[", 
   RowBox[{"spinOrder_", ",", "head_"}], "]"}], ":=", 
  RowBox[{"Module", "[", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{"a", ",", "b", ",", "L", ",", "pv"}], "}"}], ",", 
    RowBox[{
     RowBox[{"If", "[", 
      RowBox[{
       RowBox[{"spinOrder", "==", "0"}], ",", 
       RowBox[{"pv", "=", 
        RowBox[{"{", 
         RowBox[{
          RowBox[{"v", "[", "1", "]"}], ",", 
          RowBox[{"v", "[", "1", "]"}]}], "}"}]}]}], "]"}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"If", "[", 
      RowBox[{
       RowBox[{"spinOrder", "==", "1"}], ",", 
       RowBox[{"pv", "=", 
        RowBox[{"{", 
         RowBox[{
          RowBox[{"{", 
           RowBox[{
            RowBox[{"v", "[", "1", "]"}], ",", 
            RowBox[{"p", "[", "1", "]"}]}], "}"}], ",", 
          RowBox[{"{", 
           RowBox[{
            RowBox[{"v", "[", "1", "]"}], ",", 
            RowBox[{"p", "[", "2", "]"}]}], "}"}]}], "}"}]}]}], "]"}], ";", 
     RowBox[{"If", "[", 
      RowBox[{
       RowBox[{
        RowBox[{"EvenQ", "[", "spinOrder", "]"}], "&&", " ", 
        RowBox[{"spinOrder", ">", "1"}]}], ",", 
       RowBox[{"pv", "=", 
        RowBox[{
         RowBox[{
          RowBox[{"Join", "[", 
           RowBox[{
            RowBox[{"{", 
             RowBox[{
              RowBox[{"v", "[", "1", "]"}], ",", 
              RowBox[{"v", "[", "1", "]"}]}], "}"}], ",", "#"}], "]"}], "&"}],
          "/@", 
         RowBox[{"(", 
          RowBox[{
           RowBox[{
            RowBox[{
             RowBox[{
              RowBox[{
               RowBox[{"List", "@@", 
                RowBox[{"(", 
                 RowBox[{
                  SuperscriptBox[
                   RowBox[{"(", 
                    RowBox[{"a", "+", "b"}], ")"}], "spinOrder"], "//", 
                  "Expand"}], ")"}]}], "/.", 
               RowBox[{
                RowBox[{
                 RowBox[{"a_", " ", "b_"}], "/;", 
                 RowBox[{"NumericQ", "[", "a", "]"}]}], ":>", "b"}]}], "/.", 
              RowBox[{"Times", "->", "L"}]}], "/.", 
             RowBox[{
              RowBox[{"Power", "[", 
               RowBox[{"x_", ",", "n_"}], "]"}], ":>", 
              RowBox[{"ConstantArray", "[", 
               RowBox[{"x", ",", "n"}], "]"}]}]}], "/.", 
            RowBox[{
             RowBox[{"L", "[", "f__", "]"}], ":>", 
             RowBox[{"Flatten", "[", 
              RowBox[{"{", "f", "}"}], "]"}]}]}], "/.", 
           RowBox[{"{", 
            RowBox[{
             RowBox[{"a", "->", 
              RowBox[{"head", "[", "1", "]"}]}], ",", 
             RowBox[{"b", "->", 
              RowBox[{"head", "[", "2", "]"}]}]}], "}"}]}], ")"}]}]}]}], 
      "]"}], ";", "\[IndentingNewLine]", 
     RowBox[{"If", "[", 
      RowBox[{
       RowBox[{
        RowBox[{"OddQ", "[", "spinOrder", "]"}], "&&", " ", 
        RowBox[{"spinOrder", ">", "1"}]}], ",", 
       RowBox[{"pv", "=", 
        RowBox[{
         RowBox[{
          RowBox[{"Join", "[", 
           RowBox[{
            RowBox[{"{", 
             RowBox[{"v", "[", "1", "]"}], "}"}], ",", "#"}], "]"}], "&"}], "/@", 
         RowBox[{"(", 
          RowBox[{
           RowBox[{
            RowBox[{
             RowBox[{
              RowBox[{
               RowBox[{"List", "@@", 
                RowBox[{"(", 
                 RowBox[{
                  SuperscriptBox[
                   RowBox[{"(", 
                    RowBox[{"a", "+", "b"}], ")"}], "spinOrder"], "//", 
                  "Expand"}], ")"}]}], "/.", 
               RowBox[{
                RowBox[{
                 RowBox[{"a_", " ", "b_"}], "/;", 
                 RowBox[{"NumericQ", "[", "a", "]"}]}], ":>", "b"}]}], "/.", 
              RowBox[{"Times", "->", "L"}]}], "/.", 
             RowBox[{
              RowBox[{"Power", "[", 
               RowBox[{"x_", ",", "n_"}], "]"}], ":>", 
              RowBox[{"ConstantArray", "[", 
               RowBox[{"x", ",", "n"}], "]"}]}]}], "/.", 
            RowBox[{
             RowBox[{"L", "[", "f__", "]"}], ":>", 
             RowBox[{"Flatten", "[", 
              RowBox[{"{", "f", "}"}], "]"}]}]}], "/.", 
           RowBox[{"{", 
            RowBox[{
             RowBox[{"a", "->", 
              RowBox[{"head", "[", "1", "]"}]}], ",", 
             RowBox[{"b", "->", 
              RowBox[{"head", "[", "2", "]"}]}]}], "}"}]}], ")"}]}]}]}], 
      "]"}], ";", "\[IndentingNewLine]", "pv"}]}], "]"}]}]}], "Input",
 CellChangeTimes->{{3.8773416566037617`*^9, 3.877341711224474*^9}, {
  3.877341776918145*^9, 3.8773419063009233`*^9}, {3.877341937520246*^9, 
  3.877341952447928*^9}, {3.877342001926*^9, 3.8773420048454742`*^9}},
 CellLabel->
  "In[131]:=",ExpressionUUID->"38b08510-db19-43f8-a58a-03d08123cfc5"],

Cell[BoxData[{
 RowBox[{"ClearAll", "[", "BoundaryVectorsG", "]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"BoundaryVectorsG", "[", 
   RowBox[{"spinOrder_", ",", "head_", ",", "pvars_"}], "]"}], ":=", 
  RowBox[{"Module", "[", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{"a", ",", "b", ",", "L", ",", "pv"}], "}"}], ",", 
    "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"If", "[", 
      RowBox[{
       RowBox[{"spinOrder", "==", "1"}], ",", 
       RowBox[{"pv", "=", 
        RowBox[{"Table", "[", 
         RowBox[{
          RowBox[{"{", 
           RowBox[{
            RowBox[{"v", "[", "1", "]"}], ",", 
            RowBox[{"p", "[", "ii", "]"}]}], "}"}], ",", 
          RowBox[{"{", 
           RowBox[{"ii", ",", "pvars"}], "}"}]}], "]"}]}]}], "]"}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"If", "[", 
      RowBox[{
       RowBox[{"spinOrder", ">", "1"}], ",", 
       RowBox[{"pv", "=", 
        RowBox[{
         RowBox[{
          RowBox[{"Join", "[", 
           RowBox[{
            RowBox[{"Table", "[", 
             RowBox[{
              RowBox[{"v", "[", "1", "]"}], ",", "spinOrder"}], "]"}], ",", 
            "#"}], "]"}], "&"}], "/@", 
         RowBox[{"(", 
          RowBox[{
           RowBox[{
            RowBox[{
             RowBox[{
              RowBox[{
               RowBox[{"List", "@@", 
                RowBox[{"(", 
                 RowBox[{
                  SuperscriptBox[
                   RowBox[{"(", 
                    RowBox[{"Total", "[", 
                    RowBox[{"a", "/@", 
                    RowBox[{"Range", "[", "pvars", "]"}]}], "]"}], ")"}], 
                   "spinOrder"], "//", "Expand"}], ")"}]}], "/.", 
               RowBox[{
                RowBox[{
                 RowBox[{"a_", " ", "b_"}], "/;", 
                 RowBox[{"NumericQ", "[", "a", "]"}]}], ":>", "b"}]}], "/.", 
              RowBox[{"Times", "->", "L"}]}], "/.", 
             RowBox[{
              RowBox[{"Power", "[", 
               RowBox[{"x_", ",", "n_"}], "]"}], ":>", 
              RowBox[{"ConstantArray", "[", 
               RowBox[{"x", ",", "n"}], "]"}]}]}], "/.", 
            RowBox[{
             RowBox[{"L", "[", "f__", "]"}], ":>", 
             RowBox[{"Flatten", "[", 
              RowBox[{"{", "f", "}"}], "]"}]}]}], "/.", 
           RowBox[{"{", 
            RowBox[{
             RowBox[{"a", "[", "i_", "]"}], ":>", 
             RowBox[{"head", "[", "i", "]"}]}], "}"}]}], ")"}]}]}]}], "]"}], 
     ";", "\[IndentingNewLine]", "pv"}]}], "]"}]}]}], "Input",
 CellChangeTimes->{{3.878027626618311*^9, 3.8780276287971983`*^9}, {
  3.8780276749699907`*^9, 3.878027685969224*^9}, {3.87802772683783*^9, 
  3.878027789220231*^9}, {3.878027847412304*^9, 3.878027849386404*^9}, {
  3.87802789491831*^9, 3.8780279030166693`*^9}, {3.878028006175324*^9, 
  3.8780280168002443`*^9}, {3.878028047804*^9, 3.878028104335112*^9}},
 CellLabel->
  "In[133]:=",ExpressionUUID->"9e85ef89-ef79-46cb-be32-c43025585f9e"],

Cell[BoxData[{
 RowBox[{"ClearAll", "[", "BoundaryVectorGa", "]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"BoundaryVectorGa", "[", 
   RowBox[{"paorder_", ",", "head_", ",", "pvars_"}], "]"}], ":=", 
  RowBox[{"Module", "[", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{"a", ",", "b", ",", "L", ",", "pv"}], "}"}], ",", 
    "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"If", "[", 
      RowBox[{
       RowBox[{"paorder", "==", "1"}], ",", 
       RowBox[{"pv", "=", 
        RowBox[{"Table", "[", 
         RowBox[{
          RowBox[{"{", 
           RowBox[{
            RowBox[{"v", "[", "1", "]"}], ",", 
            RowBox[{"as", "[", "0", "]"}], ",", 
            RowBox[{"as", "[", "0", "]"}], ",", 
            RowBox[{"p", "[", "ii", "]"}]}], "}"}], ",", 
          RowBox[{"{", 
           RowBox[{"ii", ",", "pvars"}], "}"}]}], "]"}]}]}], "]"}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"If", "[", 
      RowBox[{
       RowBox[{"paorder", ">", "1"}], ",", 
       RowBox[{
        RowBox[{"pv", "=", 
         RowBox[{
          RowBox[{
           RowBox[{"Join", "[", 
            RowBox[{
             RowBox[{
              RowBox[{"{", 
               RowBox[{
                RowBox[{"v", "[", "1", "]"}], ",", 
                RowBox[{"Table", "[", 
                 RowBox[{"as", ",", 
                  RowBox[{"paorder", "+", "1"}]}], "]"}]}], "}"}], "//", 
              "Flatten"}], ",", "#"}], "]"}], "&"}], "/@", 
          RowBox[{"(", 
           RowBox[{
            RowBox[{
             RowBox[{
              RowBox[{
               RowBox[{
                RowBox[{"List", "@@", 
                 RowBox[{"(", 
                  RowBox[{
                   SuperscriptBox[
                    RowBox[{"(", 
                    RowBox[{"Total", "[", 
                    RowBox[{"a", "/@", 
                    RowBox[{"Range", "[", "pvars", "]"}]}], "]"}], ")"}], 
                    "paorder"], "//", "Expand"}], ")"}]}], "/.", 
                RowBox[{
                 RowBox[{
                  RowBox[{"a_", " ", "b_"}], "/;", 
                  RowBox[{"NumericQ", "[", "a", "]"}]}], ":>", "b"}]}], "/.", 
               
               RowBox[{"Times", "->", "L"}]}], "/.", 
              RowBox[{
               RowBox[{"Power", "[", 
                RowBox[{"x_", ",", "n_"}], "]"}], ":>", 
               RowBox[{"ConstantArray", "[", 
                RowBox[{"x", ",", "n"}], "]"}]}]}], "/.", 
             RowBox[{
              RowBox[{"L", "[", "f__", "]"}], ":>", 
              RowBox[{"Flatten", "[", 
               RowBox[{"{", "f", "}"}], "]"}]}]}], "/.", 
            RowBox[{"{", 
             RowBox[{
              RowBox[{"a", "[", "i_", "]"}], ":>", 
              RowBox[{"head", "[", "i", "]"}]}], "}"}]}], ")"}]}]}], ";"}]}], 
      "]"}], ";", "\[IndentingNewLine]", "\[IndentingNewLine]", "pv"}]}], 
   "]"}]}]}], "Input",
 CellChangeTimes->{{3.878796764144265*^9, 3.878796812531869*^9}, {
  3.878796917635353*^9, 3.878797016474463*^9}, {3.878797147649317*^9, 
  3.8787971567821608`*^9}, {3.878797256111465*^9, 3.878797285517797*^9}, {
  3.8787973470859118`*^9, 3.878797351964334*^9}},
 CellLabel->
  "In[135]:=",ExpressionUUID->"850f9e74-d60e-480a-93ae-c2c236ab84b9"],

Cell[BoxData[{
 RowBox[{"ClearAll", "[", "BoundaryPatitionsGaAll", 
  "]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"BoundaryPatitionsGaAll", "[", 
   RowBox[{"spinOrder_", ",", "head_", ",", "glueNumber_"}], "]"}], ":=", 
  RowBox[{
   RowBox[{"Flatten", "[", 
    RowBox[{
     RowBox[{"BoundaryPatitions", "/@", 
      RowBox[{"BoundaryVectorGa", "[", 
       RowBox[{"spinOrder", ",", "head", ",", "glueNumber"}], "]"}]}], ",", 
     "1"}], "]"}], "//", "Union"}]}]}], "Input",
 CellChangeTimes->{{3.878797396983058*^9, 3.878797408695859*^9}},
 CellLabel->
  "In[137]:=",ExpressionUUID->"700a3f7d-cd49-466f-90de-2c822c5c055a"],

Cell[BoxData[{
 RowBox[{"ClearAll", "[", "monoFa", "]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"monoFa", "[", 
   RowBox[{"spinOrder_", ",", "glueNumber_"}], "]"}], ":=", 
  RowBox[{"Module", "[", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{"factorNumber", ",", "allmonos", ",", "ptsets"}], "}"}], ",", 
    "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"ptsets", "=", 
      RowBox[{"KSetPartitionsEmpty", "[", 
       RowBox[{
        RowBox[{"Table", "[", 
         RowBox[{
          RowBox[{"F", "[", "ii", "]"}], ",", 
          RowBox[{"{", 
           RowBox[{"ii", ",", "glueNumber"}], "}"}]}], "]"}], ",", 
        RowBox[{"spinOrder", "+", "1"}]}], "]"}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"allmonos", "=", 
      RowBox[{"DeleteCases", "[", 
       RowBox[{
        RowBox[{
         RowBox[{
          RowBox[{
           RowBox[{
            RowBox[{"(", 
             RowBox[{
              RowBox[{"(", 
               RowBox[{
                RowBox[{
                 RowBox[{"monoAllF", "[", 
                  RowBox[{"ptsets", ",", "#"}], "]"}], "&"}], "/@", 
                RowBox[{"BoundaryPatitionsGaAll", "[", 
                 RowBox[{"spinOrder", ",", "p", ",", "glueNumber"}], "]"}]}], 
               ")"}], "//", "Flatten"}], ")"}], "//.", "dotRules"}], "/.", 
           RowBox[{
            RowBox[{"a_", " ", "b_"}], "\[RuleDelayed]", " ", 
            RowBox[{"b", "/;", 
             RowBox[{"NumericQ", "[", "a", "]"}]}]}]}], "//", "Flatten"}], "//",
          "DeleteDuplicates"}], ",", "0"}], "]"}]}]}]}], "]"}]}]}], "Input",
 CellChangeTimes->{{3.87879748196268*^9, 3.8787974893319798`*^9}, {
  3.8787975228011427`*^9, 3.878797540874333*^9}, {3.8787976271313047`*^9, 
  3.8787976278713512`*^9}},
 CellLabel->
  "In[139]:=",ExpressionUUID->"cb6c5ca4-66d2-4b20-8e3f-ccc5d0908177"],

Cell[BoxData[{
 RowBox[{"ClearAll", "[", "BoundaryPatitionsAll", 
  "]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"BoundaryPatitionsAll", "[", 
   RowBox[{"spinOrder_", ",", "head_", ",", "glueNumber_"}], "]"}], ":=", 
  RowBox[{
   RowBox[{"Flatten", "[", 
    RowBox[{
     RowBox[{"BoundaryPatitions", "/@", 
      RowBox[{"BoundaryVectorsG", "[", 
       RowBox[{"spinOrder", ",", "head", ",", "glueNumber"}], "]"}]}], ",", 
     "1"}], "]"}], "//", "Union"}]}]}], "Input",
 CellChangeTimes->{{3.878028376498678*^9, 3.878028397332559*^9}},
 CellLabel->
  "In[141]:=",ExpressionUUID->"e6c49810-516a-46b3-91d2-9f6cc77989d2"],

Cell[BoxData[{
 RowBox[{"ClearAll", "[", "monoFS", "]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"monoFS", "[", 
   RowBox[{"spinOrder_", ",", "glueNumber_"}], "]"}], ":=", 
  RowBox[{"Module", "[", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{"factorNumber", ",", "allmonos", ",", "ptsets"}], "}"}], ",", 
    "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"ptsets", "=", 
      RowBox[{"KSetPartitionsEmpty", "[", 
       RowBox[{
        RowBox[{"Join", "[", 
         RowBox[{
          RowBox[{"Table", "[", 
           RowBox[{
            RowBox[{"F", "[", "ii", "]"}], ",", 
            RowBox[{"{", 
             RowBox[{"ii", ",", "glueNumber"}], "}"}]}], "]"}], ",", 
          RowBox[{"{", 
           RowBox[{"S", "[", "0", "]"}], "}"}]}], "]"}], ",", "spinOrder"}], 
       "]"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"allmonos", "=", 
      RowBox[{"DeleteCases", "[", 
       RowBox[{
        RowBox[{
         RowBox[{
          RowBox[{
           RowBox[{
            RowBox[{"(", 
             RowBox[{
              RowBox[{"(", 
               RowBox[{
                RowBox[{
                 RowBox[{"monoAllF", "[", 
                  RowBox[{"ptsets", ",", "#"}], "]"}], "&"}], "/@", 
                RowBox[{"BoundaryPatitionsAll", "[", 
                 RowBox[{"spinOrder", ",", "p", ",", "glueNumber"}], "]"}]}], 
               ")"}], "//", "Flatten"}], ")"}], "//.", "dotRules"}], "/.", 
           RowBox[{
            RowBox[{"a_", " ", "b_"}], "\[RuleDelayed]", " ", 
            RowBox[{"b", "/;", 
             RowBox[{"NumericQ", "[", "a", "]"}]}]}]}], "//", "Flatten"}], "//",
          "DeleteDuplicates"}], ",", "0"}], "]"}]}]}]}], "]"}]}]}], "Input",
 CellChangeTimes->{{3.878028273762349*^9, 3.878028351937826*^9}, {
  3.878028412268785*^9, 3.878028416383037*^9}},
 CellLabel->
  "In[143]:=",ExpressionUUID->"acf5035f-ca44-45ac-b48d-85cb79e62689"],

Cell[BoxData[
 RowBox[{"(*", 
  RowBox[{
   RowBox[{
    RowBox[{"ClearAll", "[", "BoundaryVectorsLinSpin", "]"}], 
    "\[IndentingNewLine]", 
    RowBox[{"BoundaryVectorsLinSpin", "[", 
     RowBox[{"denOrder_", ",", "head_", ",", "pvars_"}], "]"}]}], ":=", 
   RowBox[{"Module", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"a", ",", "b", ",", "L", ",", "pv"}], "}"}], ",", 
     "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"pv", "=", 
       RowBox[{"(", 
        RowBox[{
         RowBox[{
          RowBox[{
           RowBox[{
            RowBox[{
             RowBox[{"List", "@@", 
              RowBox[{"(", 
               RowBox[{
                RowBox[{"(", 
                 RowBox[{"NonCommutativeMultiply", "@@", 
                  RowBox[{"Table", "[", 
                   RowBox[{
                    RowBox[{"Total", "[", 
                    RowBox[{"a", "/@", 
                    RowBox[{"Range", "[", "pvars", "]"}]}], "]"}], ",", 
                    RowBox[{"{", "denOrder", "}"}]}], "]"}]}], ")"}], "//", 
                "ExpandNCM"}], ")"}]}], "/.", 
             RowBox[{
              RowBox[{
               RowBox[{"a_", " ", "b_"}], "/;", 
               RowBox[{"NumericQ", "[", "a", "]"}]}], ":>", "b"}]}], "/.", 
            RowBox[{"NonCommutativeMultiply", "->", "L"}]}], "/.", 
           RowBox[{
            RowBox[{"Power", "[", 
             RowBox[{"x_", ",", "n_"}], "]"}], ":>", 
            RowBox[{"ConstantArray", "[", 
             RowBox[{"x", ",", "n"}], "]"}]}]}], "/.", 
          RowBox[{
           RowBox[{"L", "[", "f__", "]"}], ":>", 
           RowBox[{"Flatten", "[", 
            RowBox[{"{", "f", "}"}], "]"}]}]}], "/.", 
         RowBox[{"{", 
          RowBox[{
           RowBox[{"a", "[", "i_", "]"}], ":>", 
           RowBox[{"{", 
            RowBox[{
             RowBox[{"head", "[", "i", "]"}], ",", 
             RowBox[{"v", "[", "1", "]"}]}], "}"}]}], "}"}]}], ")"}]}], ";", 
      "\[IndentingNewLine]", "pv"}]}], "]"}]}], "*)"}]], "Input",
 CellChangeTimes->{{3.878013329545788*^9, 3.878013406973668*^9}, {
   3.878013472617844*^9, 3.8780134992288218`*^9}, {3.878013576985078*^9, 
   3.878013601845764*^9}, {3.878013635900785*^9, 3.878013706366001*^9}, {
   3.878013741332303*^9, 3.878013774072772*^9}, {3.878013850666292*^9, 
   3.878013858431641*^9}, 3.8780140830272913`*^9, {3.878014413650999*^9, 
   3.878014425329073*^9}, {3.878015716730817*^9, 3.878015754155943*^9}, {
   3.878015797018319*^9, 3.878015851887788*^9}, 3.878020114438388*^9, 
   3.8780282223331757`*^9},
 CellLabel->
  "In[145]:=",ExpressionUUID->"f096a91e-a14a-422f-9dad-273215327dad"],

Cell[BoxData[
 RowBox[{
  RowBox[{"dotRules", "=", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{
      RowBox[{"dot", "[", 
       RowBox[{"a_", ",", 
        RowBox[{"S", "[", "i_", "]"}], ",", "a_"}], "]"}], "\[RuleDelayed]", 
      " ", "0"}], ",", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"dot", "[", 
       RowBox[{"a__", ",", 
        RowBox[{"S", "[", "i_", "]"}], ",", "b__"}], "]"}], "\[RuleDelayed]", 
      " ", 
      RowBox[{"0", "/;", 
       RowBox[{
        RowBox[{
         RowBox[{"{", 
          RowBox[{"a", ",", 
           RowBox[{"S", "[", "i", "]"}], ",", "b"}], "}"}], "==", 
         RowBox[{"Reverse", "[", 
          RowBox[{"{", 
           RowBox[{"a", ",", 
            RowBox[{"S", "[", "i", "]"}], ",", "b"}], "}"}], "]"}]}], "&&", 
        RowBox[{
         RowBox[{"Length", "[", 
          RowBox[{"{", "a", "}"}], "]"}], "\[Equal]", 
         RowBox[{"Length", "[", 
          RowBox[{"{", "b", "}"}], "]"}]}]}]}]}], ",", "\[IndentingNewLine]", 
     
     RowBox[{
      RowBox[{"dot", "[", 
       RowBox[{"a__", ",", 
        RowBox[{"F", "[", "i_", "]"}], ",", "b__"}], "]"}], "\[RuleDelayed]", 
      " ", 
      RowBox[{"0", "/;", 
       RowBox[{
        RowBox[{"{", 
         RowBox[{"a", ",", 
          RowBox[{"F", "[", "i", "]"}], ",", "b"}], "}"}], "==", 
        RowBox[{"Reverse", "[", 
         RowBox[{"{", 
          RowBox[{"a", ",", 
           RowBox[{"F", "[", "i", "]"}], ",", "b"}], "}"}], "]"}]}]}]}], ",", 
     "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"dot", "[", 
       RowBox[{"a_", ",", 
        RowBox[{"F", "[", "i_", "]"}], ",", "a_"}], "]"}], "\[RuleDelayed]", 
      " ", "0"}], ",", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"dot", "[", 
       RowBox[{"a_", ",", 
        RowBox[{"S", "[", "i_", "]"}], ",", "b_"}], "]"}], "\[RuleDelayed]", 
      " ", 
      RowBox[{
       RowBox[{"-", 
        RowBox[{"dot", "[", 
         RowBox[{"b", ",", 
          RowBox[{"S", "[", "i", "]"}], ",", "a"}], "]"}]}], "/;", 
       RowBox[{
        RowBox[{"Sort", "[", 
         RowBox[{"{", 
          RowBox[{"a", ",", "b"}], "}"}], "]"}], "\[NotEqual]", 
        RowBox[{"{", 
         RowBox[{"a", ",", "b"}], "}"}]}]}]}], ",", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"dot", "[", 
       RowBox[{"a_", ",", 
        RowBox[{"F", "[", "i_", "]"}], ",", "b_"}], "]"}], "\[RuleDelayed]", 
      " ", 
      RowBox[{
       RowBox[{"-", 
        RowBox[{"dot", "[", 
         RowBox[{"b", ",", 
          RowBox[{"F", "[", "i", "]"}], ",", "a"}], "]"}]}], "/;", 
       RowBox[{
        RowBox[{"Sort", "[", 
         RowBox[{"{", 
          RowBox[{"a", ",", "b"}], "}"}], "]"}], "\[NotEqual]", 
        RowBox[{"{", 
         RowBox[{"a", ",", "b"}], "}"}]}]}]}], ",", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"dot", "[", 
       RowBox[{
        RowBox[{"p", "[", "a_", "]"}], ",", 
        RowBox[{"F", "[", "a_", "]"}], ",", "b__"}], "]"}], "\[RuleDelayed]", 
      " ", "0"}], ",", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"dot", "[", 
       RowBox[{"b__", ",", 
        RowBox[{"F", "[", "a_", "]"}], ",", 
        RowBox[{"p", "[", "a_", "]"}]}], "]"}], "\[RuleDelayed]", " ", "0"}], 
     ",", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"dot", "[", 
       RowBox[{"a__", ",", 
        RowBox[{"S", "[", "i_", "]"}], ",", 
        RowBox[{"v", "[", "1", "]"}]}], "]"}], "\[RuleDelayed]", " ", "0"}], 
     ",", 
     RowBox[{
      RowBox[{"dot", "[", 
       RowBox[{"b__", ",", 
        RowBox[{"S", "[", "i_", "]"}], ",", 
        RowBox[{"as", "[", "1", "]"}]}], "]"}], "\[RuleDelayed]", " ", "0"}], 
     ",", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"dot", "[", 
       RowBox[{
        RowBox[{"v", "[", "1", "]"}], ",", 
        RowBox[{"v", "[", "1", "]"}]}], "]"}], "\[RuleDelayed]", "1"}], ",", 
     "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"dot", "[", 
       RowBox[{
        RowBox[{"v", "[", "1", "]"}], ",", 
        RowBox[{"S", "[", "i_", "]"}], ",", "a__"}], "]"}], "\[RuleDelayed]", 
      " ", "0"}], ",", 
     RowBox[{
      RowBox[{"dot", "[", 
       RowBox[{
        RowBox[{"as", "[", "1", "]"}], ",", 
        RowBox[{"S", "[", "i_", "]"}], ",", "a__"}], "]"}], "\[RuleDelayed]", 
      " ", "0"}], ",", 
     RowBox[{
      RowBox[{"dot", "[", 
       RowBox[{
        RowBox[{"p", "[", "i_", "]"}], ",", 
        RowBox[{"\[Epsilon]", "[", "i_", "]"}]}], "]"}], "\[RuleDelayed]", 
      "0"}], ",", 
     RowBox[{
      RowBox[{"dot", "[", 
       RowBox[{
        RowBox[{"p", "[", "i_", "]"}], ",", 
        RowBox[{"p", "[", "i_", "]"}]}], "]"}], "\[RuleDelayed]", " ", "0"}], 
     " ", ",", 
     RowBox[{
      RowBox[{"dot", "[", 
       RowBox[{
        RowBox[{"\[Epsilon]", "[", "i_", "]"}], ",", 
        RowBox[{"\[Epsilon]", "[", "i_", "]"}]}], "]"}], "\[RuleDelayed]", 
      " ", "0"}], ",", 
     RowBox[{
      RowBox[{"dot", "[", "a__", "]"}], "\[RuleDelayed]", 
      "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{
        RowBox[{
         RowBox[{"(", 
          RowBox[{"-", "1"}], ")"}], "^", 
         RowBox[{"Length", "[", 
          RowBox[{"{", "a", "}"}], "]"}]}], "*", 
        RowBox[{"dot", "@@", 
         RowBox[{"Reverse", "[", 
          RowBox[{"{", "a", "}"}], "]"}]}]}], "/;", 
       RowBox[{
        RowBox[{"OrderedQ", "[", 
         RowBox[{"{", 
          RowBox[{
           RowBox[{
            RowBox[{"{", "a", "}"}], "//", "Reverse"}], ",", 
           RowBox[{"{", "a", "}"}]}], "}"}], "]"}], "&&", 
        RowBox[{
         RowBox[{"{", "a", "}"}], "=!=", 
         RowBox[{"Reverse", "[", 
          RowBox[{"{", "a", "}"}], "]"}]}]}]}]}]}], "}"}]}], ";"}]], "Input",
 CellChangeTimes->{{3.87735352765903*^9, 3.877353575291686*^9}, {
   3.877506147842967*^9, 3.877506190551264*^9}, 3.878020458873892*^9},
 CellLabel->
  "In[146]:=",ExpressionUUID->"26efa189-4ecc-4695-99da-a77c9b57d98f"]
}, Closed]],

Cell[CellGroupData[{

Cell["Cut conditions general", "Section",
 CellChangeTimes->{{3.877407131689956*^9, 
  3.87740713904277*^9}},ExpressionUUID->"2facbcdd-6529-421e-b087-\
7362503df697"],

Cell[BoxData[
 RowBox[{"ClearAll", "[", 
  RowBox[{
  "CutP12", ",", "ThreePtSpin", ",", "ThreePtSpin", ",", "Cutv1", ",", 
   "ConditionP12", ",", "Conditionv1"}], "]"}]], "Input",
 CellChangeTimes->{{3.87740734109801*^9, 3.877407401096468*^9}},
 CellLabel->
  "In[147]:=",ExpressionUUID->"1ed94398-ee3d-4f3a-bf90-559c2258774b"],

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{"CutP12", "[", "n_", "]"}], ":=", 
   RowBox[{
    RowBox[{
     RowBox[{
      RowBox[{"(", 
       RowBox[{"-", "1"}], ")"}], "^", 
      RowBox[{"(", 
       RowBox[{"n", "/", "2"}], ")"}]}], "*", 
     RowBox[{"1", "/", 
      RowBox[{"Factorial", "[", "n", "]"}]}], "*", 
     RowBox[{
      RowBox[{"(", 
       RowBox[{"dot", "[", 
        RowBox[{
         RowBox[{
          RowBox[{"p", "[", "1", "]"}], "+", 
          RowBox[{"p", "[", "2", "]"}]}], ",", 
         RowBox[{"S", "[", "0", "]"}], ",", 
         RowBox[{"S", "[", "0", "]"}], ",", 
         RowBox[{
          RowBox[{"p", "[", "1", "]"}], "+", 
          RowBox[{"p", "[", "2", "]"}]}]}], "]"}], ")"}], "^", 
      RowBox[{"(", 
       RowBox[{"n", "/", "2"}], ")"}]}], 
     RowBox[{"(", 
      RowBox[{
       RowBox[{
        RowBox[{"dot", "[", 
         RowBox[{
          RowBox[{"\[Epsilon]", "[", "2", "]"}], ",", 
          RowBox[{"p", "[", "1", "]"}]}], "]"}], 
        RowBox[{"dot", "[", 
         RowBox[{
          RowBox[{"v", "[", "1", "]"}], ",", 
          RowBox[{"\[Epsilon]", "[", "1", "]"}]}], "]"}]}], "-", 
       RowBox[{
        RowBox[{"dot", "[", 
         RowBox[{
          RowBox[{"\[Epsilon]", "[", "1", "]"}], ",", 
          RowBox[{"p", "[", "2", "]"}]}], "]"}], 
        RowBox[{"dot", "[", 
         RowBox[{
          RowBox[{"v", "[", "1", "]"}], ",", 
          RowBox[{"\[Epsilon]", "[", "2", "]"}]}], "]"}]}], "+", 
       RowBox[{
        RowBox[{"dot", "[", 
         RowBox[{
          RowBox[{"\[Epsilon]", "[", "1", "]"}], ",", 
          RowBox[{"\[Epsilon]", "[", "2", "]"}]}], "]"}], 
        RowBox[{"dot", "[", 
         RowBox[{
          RowBox[{"v", "[", "1", "]"}], ",", 
          RowBox[{"p", "[", "2", "]"}]}], "]"}]}]}], ")"}]}], "/;", 
    RowBox[{"EvenQ", "[", "n", "]"}]}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"CutP12", "[", "n_", "]"}], ":=", 
   RowBox[{
    RowBox[{
     RowBox[{
      RowBox[{"(", 
       RowBox[{"-", "1"}], ")"}], "^", 
      RowBox[{"(", 
       RowBox[{"Ceiling", "[", 
        RowBox[{"n", "/", "2"}], "]"}], ")"}]}], "*", 
     RowBox[{"1", "/", 
      RowBox[{"Factorial", "[", "n", "]"}]}], "*", 
     RowBox[{
      RowBox[{"(", 
       RowBox[{"dot", "[", 
        RowBox[{
         RowBox[{
          RowBox[{"p", "[", "1", "]"}], "+", 
          RowBox[{"p", "[", "2", "]"}]}], ",", 
         RowBox[{"S", "[", "0", "]"}], ",", 
         RowBox[{"S", "[", "0", "]"}], ",", 
         RowBox[{
          RowBox[{"p", "[", "1", "]"}], "+", 
          RowBox[{"p", "[", "2", "]"}]}]}], "]"}], ")"}], "^", 
      RowBox[{"(", 
       RowBox[{"Floor", "[", 
        RowBox[{"n", "/", "2"}], "]"}], ")"}]}], "*", 
     RowBox[{"(", 
      RowBox[{
       RowBox[{
        RowBox[{"dot", "[", 
         RowBox[{
          RowBox[{"\[Epsilon]", "[", "2", "]"}], ",", 
          RowBox[{"p", "[", "1", "]"}]}], "]"}], 
        RowBox[{"dot", "[", 
         RowBox[{
          RowBox[{
           RowBox[{"p", "[", "1", "]"}], "+", 
           RowBox[{"p", "[", "2", "]"}]}], ",", 
          RowBox[{"S", "[", "0", "]"}], ",", 
          RowBox[{"\[Epsilon]", "[", "1", "]"}]}], "]"}]}], "-", 
       RowBox[{
        RowBox[{"dot", "[", 
         RowBox[{
          RowBox[{"\[Epsilon]", "[", "1", "]"}], ",", 
          RowBox[{"p", "[", "2", "]"}]}], "]"}], 
        RowBox[{"dot", "[", 
         RowBox[{
          RowBox[{
           RowBox[{"p", "[", "1", "]"}], "+", 
           RowBox[{"p", "[", "2", "]"}]}], ",", 
          RowBox[{"S", "[", "0", "]"}], ",", 
          RowBox[{"\[Epsilon]", "[", "2", "]"}]}], "]"}]}], "+", 
       RowBox[{
        RowBox[{"dot", "[", 
         RowBox[{
          RowBox[{"\[Epsilon]", "[", "1", "]"}], ",", 
          RowBox[{"\[Epsilon]", "[", "2", "]"}]}], "]"}], 
        RowBox[{"dot", "[", 
         RowBox[{
          RowBox[{"p", "[", "1", "]"}], ",", 
          RowBox[{"S", "[", "0", "]"}], ",", 
          RowBox[{"p", "[", "2", "]"}]}], "]"}]}]}], ")"}]}], "/;", 
    RowBox[{"OddQ", "[", "n", "]"}]}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"ThreePtSpin", "[", 
    RowBox[{"i_", ",", "n_"}], "]"}], ":=", 
   RowBox[{
    RowBox[{
     RowBox[{
      RowBox[{"(", 
       RowBox[{"-", "1"}], ")"}], "^", 
      RowBox[{"(", 
       RowBox[{"n", "/", "2"}], ")"}]}], "*", 
     RowBox[{"1", "/", 
      RowBox[{"Factorial", "[", "n", "]"}]}], "*", 
     RowBox[{"dot", "[", 
      RowBox[{
       RowBox[{"v", "[", "1", "]"}], ",", 
       RowBox[{"\[Epsilon]", "[", "i", "]"}]}], "]"}], "*", 
     RowBox[{
      RowBox[{"(", 
       RowBox[{"dot", "[", 
        RowBox[{
         RowBox[{"p", "[", "i", "]"}], ",", 
         RowBox[{"S", "[", "0", "]"}], ",", 
         RowBox[{"S", "[", "0", "]"}], ",", 
         RowBox[{"p", "[", "i", "]"}]}], "]"}], ")"}], "^", 
      RowBox[{"(", 
       RowBox[{"n", "/", "2"}], ")"}]}]}], "/;", 
    RowBox[{"EvenQ", "[", "n", "]"}]}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"ThreePtSpin", "[", 
    RowBox[{"i_", ",", "n_"}], "]"}], ":=", 
   RowBox[{
    RowBox[{
     RowBox[{
      RowBox[{"(", 
       RowBox[{"-", "1"}], ")"}], "^", 
      RowBox[{"(", 
       RowBox[{"Ceiling", "[", 
        RowBox[{"n", "/", "2"}], "]"}], ")"}]}], "*", 
     RowBox[{"1", "/", 
      RowBox[{"Factorial", "[", "n", "]"}]}], "*", 
     RowBox[{"dot", "[", 
      RowBox[{
       RowBox[{"p", "[", "i", "]"}], ",", 
       RowBox[{"S", "[", "0", "]"}], ",", 
       RowBox[{"\[Epsilon]", "[", "i", "]"}]}], "]"}], "*", 
     RowBox[{
      RowBox[{"(", 
       RowBox[{"dot", "[", 
        RowBox[{
         RowBox[{"p", "[", "i", "]"}], ",", 
         RowBox[{"S", "[", "0", "]"}], ",", 
         RowBox[{"S", "[", "0", "]"}], ",", 
         RowBox[{"p", "[", "i", "]"}]}], "]"}], ")"}], "^", 
      RowBox[{"(", 
       RowBox[{"Floor", "[", 
        RowBox[{"n", "/", "2"}], "]"}], ")"}]}]}], "/;", 
    RowBox[{"OddQ", "[", "n", "]"}]}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"Cutv1", "[", "n_", "]"}], ":=", 
   RowBox[{"Module", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"terms", "=", 
       RowBox[{"{", "}"}]}], "}"}], ",", 
     RowBox[{
      RowBox[{"Do", "[", 
       RowBox[{
        RowBox[{"AppendTo", "[", 
         RowBox[{"terms", ",", 
          RowBox[{
           RowBox[{"ThreePtSpin", "[", 
            RowBox[{"1", ",", "j"}], "]"}], "*", 
           RowBox[{"ThreePtSpin", "[", 
            RowBox[{"2", ",", 
             RowBox[{"n", "-", "j"}]}], "]"}]}]}], "]"}], ",", 
        RowBox[{"{", 
         RowBox[{"j", ",", "0", ",", "n"}], "}"}]}], "]"}], ";", 
      RowBox[{"Return", "[", 
       RowBox[{"Total", "[", "terms", "]"}], "]"}]}]}], "]"}]}], 
  ";"}]}], "Input",
 CellChangeTimes->{{3.8774051676985087`*^9, 3.8774052165574255`*^9}, {
  3.8774052822446847`*^9, 3.8774052878093433`*^9}, {3.877405396564592*^9, 
  3.877405423680915*^9}, {3.8774054558087597`*^9, 3.8774055498464317`*^9}, {
  3.877405587031207*^9, 3.8774056885754414`*^9}, {3.87740575204082*^9, 
  3.877405754912343*^9}, {3.877405808059714*^9, 3.877405991969165*^9}, {
  3.877406069124985*^9, 3.8774062616973658`*^9}, {3.8774063257692013`*^9, 
  3.8774063498654776`*^9}, {3.87740644671277*^9, 3.877406587677663*^9}, {
  3.8774066202826347`*^9, 3.8774066224990144`*^9}, {3.8774066565456324`*^9, 
  3.877406728103804*^9}, {3.87740675908631*^9, 3.877406806027347*^9}, {
  3.8774068389284067`*^9, 3.8774068458261347`*^9}, {3.8774068771038003`*^9, 
  3.8774069023757334`*^9}},
 CellLabel->
  "In[148]:=",ExpressionUUID->"addf7f2a-cd5d-49f7-8f50-dd1ab1616ed6"],

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{"ConditionP12", "[", 
    RowBox[{"Ansatz_", ",", "n_"}], "]"}], ":=", 
   RowBox[{
    RowBox[{"(", 
     RowBox[{
      RowBox[{"(", 
       RowBox[{"Ansatz", "//.", 
        RowBox[{"{", 
         RowBox[{
          RowBox[{
           RowBox[{"dot", "[", 
            RowBox[{"x__", ",", 
             RowBox[{"F", "[", "c_", "]"}], ",", "y__"}], "]"}], 
           "\[RuleDelayed]", 
           RowBox[{
            RowBox[{
             RowBox[{"dot", "[", 
              RowBox[{"x", ",", 
               RowBox[{"p", "[", "c", "]"}]}], "]"}], "*", 
             RowBox[{"dot", "[", 
              RowBox[{
               RowBox[{"\[Epsilon]", "[", "c", "]"}], ",", "y"}], "]"}]}], 
            "-", 
            RowBox[{
             RowBox[{"dot", "[", 
              RowBox[{"x", ",", 
               RowBox[{"\[Epsilon]", "[", "c", "]"}]}], "]"}], "*", 
             RowBox[{"dot", "[", 
              RowBox[{
               RowBox[{"p", "[", "c", "]"}], ",", "y"}], "]"}]}]}]}], " ", 
          ",", 
          RowBox[{
           RowBox[{"dot", "[", 
            RowBox[{
             RowBox[{"p", "[", "1", "]"}], ",", 
             RowBox[{"p", "[", "2", "]"}]}], "]"}], "\[RuleDelayed]", "0"}], 
          ",", 
          RowBox[{
           RowBox[{"dot", "[", 
            RowBox[{
             RowBox[{"v", "[", "1", "]"}], ",", 
             RowBox[{"p", "[", "2", "]"}]}], "]"}], "\[RuleDelayed]", 
           RowBox[{"-", 
            RowBox[{"dot", "[", 
             RowBox[{
              RowBox[{"v", "[", "1", "]"}], ",", 
              RowBox[{"p", "[", "1", "]"}]}], "]"}]}]}]}], "}"}]}], ")"}], 
      "\[Equal]", 
      RowBox[{"4", "*", 
       RowBox[{"dot", "[", 
        RowBox[{
         RowBox[{"v", "[", "1", "]"}], ",", 
         RowBox[{"p", "[", "1", "]"}]}], "]"}], "*", 
       RowBox[{"CutP12", "[", "n", "]"}]}]}], ")"}], "//.", "dotRules"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"Conditionv1", "[", 
    RowBox[{"Ansatz_", ",", "n_"}], "]"}], ":=", 
   RowBox[{
    RowBox[{"(", 
     RowBox[{
      RowBox[{"(", 
       RowBox[{"Ansatz", "//.", 
        RowBox[{"{", 
         RowBox[{
          RowBox[{
           RowBox[{"dot", "[", 
            RowBox[{"x__", ",", 
             RowBox[{"F", "[", "c_", "]"}], ",", "y__"}], "]"}], 
           "\[RuleDelayed]", 
           RowBox[{
            RowBox[{
             RowBox[{"dot", "[", 
              RowBox[{"x", ",", 
               RowBox[{"p", "[", "c", "]"}]}], "]"}], "*", 
             RowBox[{"dot", "[", 
              RowBox[{
               RowBox[{"\[Epsilon]", "[", "c", "]"}], ",", "y"}], "]"}]}], 
            "-", 
            RowBox[{
             RowBox[{"dot", "[", 
              RowBox[{"x", ",", 
               RowBox[{"\[Epsilon]", "[", "c", "]"}]}], "]"}], "*", 
             RowBox[{"dot", "[", 
              RowBox[{
               RowBox[{"p", "[", "c", "]"}], ",", "y"}], "]"}]}]}]}], " ", 
          ",", 
          RowBox[{
           RowBox[{"dot", "[", 
            RowBox[{
             RowBox[{"v", "[", "1", "]"}], ",", 
             RowBox[{"p", "[", "1", "]"}]}], "]"}], "\[RuleDelayed]", "0"}], 
          ",", 
          RowBox[{
           RowBox[{"dot", "[", 
            RowBox[{
             RowBox[{"v", "[", "1", "]"}], ",", 
             RowBox[{"p", "[", "2", "]"}]}], "]"}], "\[RuleDelayed]", "0"}]}],
          "}"}]}], ")"}], "\[Equal]", 
      RowBox[{"4", "*", 
       RowBox[{"dot", "[", 
        RowBox[{
         RowBox[{"p", "[", "1", "]"}], ",", 
         RowBox[{"p", "[", "2", "]"}]}], "]"}], "*", 
       RowBox[{"Cutv1", "[", "n", "]"}]}]}], ")"}], "//.", "dotRules"}]}], 
  ";"}]}], "Input",
 CellChangeTimes->{
  3.87740613733956*^9, {3.8774069094613323`*^9, 3.8774069103410287`*^9}, {
   3.877407016126568*^9, 3.8774071060978546`*^9}, {3.877407273815625*^9, 
   3.8774073354233522`*^9}},
 CellLabel->
  "In[153]:=",ExpressionUUID->"093ebe73-7fa6-421a-a7cb-b6566c057327"]
}, Closed]],

Cell[CellGroupData[{

Cell["Example S Five point", "Section",
 CellChangeTimes->{{3.877008171032135*^9, 3.877008177039516*^9}, {
  3.8773818494951763`*^9, 3.877381857475391*^9}, {3.878020608795433*^9, 
  3.87802061200184*^9}},ExpressionUUID->"604156b9-0508-4c7d-9a7a-\
b99be3f8fadc"],

Cell[CellGroupData[{

Cell["Setup ansatz", "Subsection",
 CellChangeTimes->{{3.877386203620414*^9, 
  3.877386209613765*^9}},ExpressionUUID->"1f37adfe-a673-4b37-93f5-\
fd1884b57adf"],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{
  RowBox[{"n", "=", "5"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"vponshell", "=", 
   RowBox[{
    RowBox[{"vonshell", "[", 
     RowBox[{
      RowBox[{"n", "-", "1"}], ",", "1"}], "]"}], "/.", 
    RowBox[{"v", "->", 
     RowBox[{"v", "[", "1", "]"}]}]}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{"gponshell", "=", 
  RowBox[{
   RowBox[{"onshell", "[", 
    RowBox[{"n", "-", "1"}], "]"}], "/.", 
   RowBox[{
    RowBox[{"s", "[", 
     RowBox[{"i_", ",", "j_"}], "]"}], ":>", 
    RowBox[{"dot", "[", 
     RowBox[{
      RowBox[{"p", "[", "i", "]"}], ",", 
      RowBox[{"p", "[", "j", "]"}]}], "]"}]}]}]}]}], "Input",
 CellChangeTimes->{{3.878020618673658*^9, 3.878020625406555*^9}, {
   3.878020685245474*^9, 3.8780206881234617`*^9}, 3.878021076476811*^9, {
   3.878022447789905*^9, 3.8780224652203074`*^9}, {3.878024579094555*^9, 
   3.87802460824821*^9}},
 CellLabel->
  "In[155]:=",ExpressionUUID->"8e07d938-6c93-4c35-b475-53b3cf5a05b4"],

Cell[BoxData[
 RowBox[{
  RowBox[{"dot", "[", 
   RowBox[{
    RowBox[{"p", "[", "2", "]"}], ",", 
    RowBox[{"p", "[", "3", "]"}]}], "]"}], "\[Rule]", 
  RowBox[{
   RowBox[{"-", 
    RowBox[{"dot", "[", 
     RowBox[{
      RowBox[{"p", "[", "1", "]"}], ",", 
      RowBox[{"p", "[", "2", "]"}]}], "]"}]}], "-", 
   RowBox[{"dot", "[", 
    RowBox[{
     RowBox[{"p", "[", "1", "]"}], ",", 
     RowBox[{"p", "[", "3", "]"}]}], "]"}]}]}]], "Output",
 CellChangeTimes->{{3.878024603364303*^9, 3.8780246086311693`*^9}, 
   3.8780958347602053`*^9, 3.878616193528262*^9, 3.878856950589954*^9},
 CellLabel->
  "Out[157]=",ExpressionUUID->"c431ecfe-7209-47bd-b17f-733172109f69"]
}, Open  ]],

Cell[BoxData[{
 RowBox[{
  RowBox[{"denOrder", "=", "1"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"monofs1", "=", 
   RowBox[{"monoFS", "[", 
    RowBox[{"denOrder", ",", 
     RowBox[{"n", "-", "2"}]}], "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"denOrder", "=", "2"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"monofs2", "=", 
   RowBox[{"monoFS", "[", 
    RowBox[{"denOrder", ",", 
     RowBox[{"n", "-", "2"}]}], "]"}]}], ";"}]}], "Input",
 CellChangeTimes->{{3.877381049405899*^9, 3.877381116483204*^9}, {
  3.877381244223319*^9, 3.877381284761427*^9}, {3.877381353256666*^9, 
  3.877381353488029*^9}, {3.87738186344316*^9, 3.877381863777376*^9}, {
  3.8773822047453117`*^9, 3.877382204987795*^9}, {3.8773825485753727`*^9, 
  3.877382548830839*^9}, {3.877382654557598*^9, 3.877382674685717*^9}, {
  3.878016251644945*^9, 3.87801627282722*^9}, {3.878018811842737*^9, 
  3.878018821618462*^9}, {3.878019111987747*^9, 3.8780191881088953`*^9}, {
  3.8780192243067636`*^9, 3.878019263820836*^9}, {3.8780196953188877`*^9, 
  3.8780197336534443`*^9}, {3.878028860196001*^9, 3.878028905573225*^9}},
 CellLabel->
  "In[158]:=",ExpressionUUID->"a92b9c8e-51f8-407e-8224-ece3eaae9f04"],

Cell[BoxData[
 RowBox[{
  RowBox[{"numAnsatz", "=", 
   RowBox[{
    RowBox[{"(", 
     RowBox[{
      FractionBox[
       RowBox[{
        RowBox[{
         RowBox[{"(", 
          RowBox[{"c", "/@", 
           RowBox[{"Range", "[", 
            RowBox[{"Length", "@", "monofs2"}], "]"}]}], ")"}], ".", 
         "monofs2"}], "/.", 
        RowBox[{
         RowBox[{"c", "[", "i_", "]"}], ":>", 
         RowBox[{"c", "[", 
          RowBox[{"1", ",", "i"}], "]"}]}]}], 
       RowBox[{
        RowBox[{"dot", "[", 
         RowBox[{
          RowBox[{"v", "[", "1", "]"}], ",", 
          RowBox[{"p", "[", "1", "]"}]}], "]"}], 
        RowBox[{"dot", "[", 
         RowBox[{
          RowBox[{"v", "[", "1", "]"}], ",", 
          RowBox[{
           RowBox[{"p", "[", "1", "]"}], "+", 
           RowBox[{"p", "[", "2", "]"}]}]}], "]"}]}]], "+", 
      FractionBox[
       RowBox[{
        RowBox[{
         RowBox[{"(", 
          RowBox[{"c", "/@", 
           RowBox[{"Range", "[", 
            RowBox[{"Length", "@", "monofs2"}], "]"}]}], ")"}], ".", 
         "monofs2"}], "/.", 
        RowBox[{
         RowBox[{"c", "[", "i_", "]"}], ":>", 
         RowBox[{"c", "[", 
          RowBox[{"2", ",", "i"}], "]"}]}]}], 
       RowBox[{
        RowBox[{"dot", "[", 
         RowBox[{
          RowBox[{"v", "[", "1", "]"}], ",", 
          RowBox[{"p", "[", "1", "]"}]}], "]"}], 
        RowBox[{"dot", "[", 
         RowBox[{
          RowBox[{"v", "[", "1", "]"}], ",", 
          RowBox[{
           RowBox[{"p", "[", "1", "]"}], "+", 
           RowBox[{"p", "[", "3", "]"}]}]}], "]"}]}]], "+", 
      FractionBox[
       RowBox[{
        RowBox[{
         RowBox[{"(", 
          RowBox[{"c", "/@", 
           RowBox[{"Range", "[", 
            RowBox[{"Length", "@", "monofs1"}], "]"}]}], ")"}], ".", 
         "monofs1"}], "/.", 
        RowBox[{
         RowBox[{"c", "[", "i_", "]"}], ":>", 
         RowBox[{"c", "[", 
          RowBox[{"3", ",", "i"}], "]"}]}]}], 
       RowBox[{"dot", "[", 
        RowBox[{
         RowBox[{"v", "[", "1", "]"}], ",", 
         RowBox[{"p", "[", "1", "]"}]}], "]"}]]}], ")"}], "//", "Expand"}]}], 
  ";"}]], "Input",
 CellChangeTimes->{{3.878019818828724*^9, 3.8780199018739433`*^9}, {
  3.878019938561898*^9, 3.878020036527034*^9}, {3.8780201912905703`*^9, 
  3.878020210990015*^9}, {3.87802091215549*^9, 3.8780209153502007`*^9}, {
  3.8780300130461073`*^9, 3.8780300429155807`*^9}, {3.8780319820804033`*^9, 
  3.87803198404319*^9}, {3.878032548017993*^9, 3.87803254970131*^9}, {
  3.8780755773066597`*^9, 3.878075579486418*^9}, {3.87808020451082*^9, 
  3.878080207422474*^9}, {3.8780802418491573`*^9, 3.878080244847021*^9}, {
  3.878080502097672*^9, 3.878080502683258*^9}},
 CellLabel->
  "In[162]:=",ExpressionUUID->"2eb92c90-3759-413d-bc7f-1a09bf3e2c53"],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"(", 
     RowBox[{"List", "@@", 
      RowBox[{"(", 
       RowBox[{
        RowBox[{
         RowBox[{"monofs1", "/.", "vponshell"}], "//", "Total"}], "//", 
        "Expand"}], ")"}]}], ")"}], "/.", 
    RowBox[{
     RowBox[{"a_", " ", "b_"}], ":>", " ", 
     RowBox[{"b", "/;", 
      RowBox[{"NumberQ", "[", "a", "]"}]}]}]}], "//", "Union"}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{"%", "//", "Length"}]}], "Input",
 CellChangeTimes->{{3.878098216984212*^9, 3.8780982186909924`*^9}, {
  3.878098255906135*^9, 3.878098397555876*^9}},
 CellLabel->
  "In[163]:=",ExpressionUUID->"74abc309-0cb3-4d4b-9a63-a72a96bc37ec"],

Cell[BoxData["42"], "Output",
 CellChangeTimes->{{3.878098214544024*^9, 3.878098219300254*^9}, 
   3.878098259809623*^9, {3.878098292569996*^9, 3.87809839248168*^9}, 
   3.878616193819244*^9, 3.878856950878747*^9},
 CellLabel->
  "Out[164]=",ExpressionUUID->"41381c4a-1cdd-4484-9172-75ff72bd4568"]
}, Open  ]]
}, Closed]],

Cell[CellGroupData[{

Cell["Cut condition Massless", "Subsection",
 CellChangeTimes->{{3.878076730024465*^9, 
  3.8780767381983347`*^9}},ExpressionUUID->"a99cbca3-c478-412c-a3d7-\
706d91371810"],

Cell[BoxData[
 RowBox[{
  RowBox[{"nod", "=", 
   RowBox[{
    RowBox[{
     RowBox[{
      RowBox[{
       RowBox[{"(", 
        RowBox[{"numAnsatz", "//", "expandFS"}], ")"}], "//.", "dotRules"}], "/.",
       "vponshell"}], "/.", 
     RowBox[{
      RowBox[{"\[Epsilon]", "[", "i_", "]"}], ":>", 
      RowBox[{"\[Epsilon]", "[", 
       RowBox[{"p", "[", "i", "]"}], "]"}]}]}], "//", "Expand"}]}], 
  ";"}]], "Input",
 CellChangeTimes->{{3.8780203515119047`*^9, 3.878020399229755*^9}, {
   3.878020431526237*^9, 3.8780204339818277`*^9}, {3.8780205335571136`*^9, 
   3.878020540776443*^9}, 3.8780206405534067`*^9, {3.878020888923959*^9, 
   3.878020889972404*^9}, 3.878021112062257*^9, {3.878022714056156*^9, 
   3.878022715411971*^9}, {3.8780319378374166`*^9, 3.878031956823164*^9}},
 CellLabel->
  "In[165]:=",ExpressionUUID->"2f3f69f3-5124-4b81-9552-2cb53ab12d1e"],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{"bpeff2", "=", 
  RowBox[{"BinaryProduct", "[", 
   RowBox[{"Range", "[", 
    RowBox[{"n", "-", "2"}], "]"}], "]"}]}], "\n", 
 RowBox[{
  RowBox[{"numList", "=", 
   RowBox[{
    RowBox[{
     RowBox[{"ExpandNCM", "/@", 
      RowBox[{"(", 
       RowBox[{"bpeff2", "/.", 
        RowBox[{"X", "\[Rule]", " ", "NC"}]}], ")"}]}], "/.", 
     RowBox[{"NonCommutativeMultiply", "\[Rule]", " ", "T"}]}], "/.", 
    RowBox[{
     RowBox[{"T", "[", 
      RowBox[{"i1_", ",", "f___"}], "]"}], ":>", " ", 
     RowBox[{"0", "/;", 
      RowBox[{"i1", "\[NotEqual]", "1"}]}]}]}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"numListL", "=", 
   RowBox[{"numList", "/.", 
    RowBox[{
     RowBox[{"T", "[", "f___", "]"}], "\[RuleDelayed]", " ", 
     RowBox[{"(", 
      RowBox[{"nod", "/.", 
       RowBox[{"replace", "[", 
        RowBox[{
         RowBox[{"p", "/@", 
          RowBox[{"{", "f", "}"}]}], ",", 
         RowBox[{"n", "-", "1"}]}], "]"}]}], ")"}]}]}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"numListL", "=", 
   RowBox[{
    RowBox[{"(", 
     RowBox[{"numListL", "/.", 
      RowBox[{
       RowBox[{"F", "[", 
        RowBox[{"p", "[", "i_", "]"}], "]"}], ":>", " ", 
       RowBox[{"F", "[", "i", "]"}]}]}], ")"}], "//", "Expand"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"ppListD", "=", 
   RowBox[{"(", 
    RowBox[{"X2Prop", "/@", "bpeff2"}], ")"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"ppListD", "=", 
   RowBox[{
    RowBox[{"ppListD", "/.", 
     RowBox[{
      RowBox[{"p", "[", "f__", "]"}], "\[RuleDelayed]", 
      RowBox[{"Total", "[", 
       RowBox[{"p", "/@", 
        RowBox[{"{", "f", "}"}]}], "]"}]}]}], "/.", 
    RowBox[{
     RowBox[{"dot", "[", 
      RowBox[{
       RowBox[{"p", "[", "i_", "]"}], ",", 
       RowBox[{"p", "[", "i_", "]"}]}], "]"}], ":>", " ", "0"}]}]}], 
  ";"}], "\n", 
 RowBox[{
  RowBox[{"denAll", "=", 
   RowBox[{"Table", "[", 
    RowBox[{
     RowBox[{"ppListD", "[", 
      RowBox[{"[", "ii", "]"}], "]"}], ",", 
     RowBox[{"{", 
      RowBox[{"ii", ",", 
       RowBox[{"Length", "@", "ppListD"}]}], "}"}]}], "]"}]}], ";"}], "\n", 
 RowBox[{
  RowBox[{"amp5", "=", 
   RowBox[{
    RowBox[{
     RowBox[{"Sum", "[", 
      RowBox[{
       FractionBox[
        RowBox[{"numListL", "[", 
         RowBox[{"[", "ii", "]"}], "]"}], 
        RowBox[{"denAll", "[", 
         RowBox[{"[", "ii", "]"}], "]"}]], ",", 
       RowBox[{"{", 
        RowBox[{"ii", ",", 
         RowBox[{"Length", "@", "ppListD"}]}], "}"}]}], "]"}], "/.", 
     RowBox[{
      RowBox[{"\[Epsilon]", "[", 
       RowBox[{"p", "[", "i_", "]"}], "]"}], ":>", 
      RowBox[{"\[Epsilon]", "[", "i", "]"}]}]}], "//", "Expand"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"amp5", "=", 
   RowBox[{
    RowBox[{
     RowBox[{
      RowBox[{"amp5", "/.", "dotRules"}], "/.", "vponshell"}], "/.", 
     "gponshell"}], "//", "Expand"}]}], ";"}]}], "Input",
 CellChangeTimes->{{3.878022027028722*^9, 3.878022028483653*^9}, {
  3.8780224366059227`*^9, 3.878022442198484*^9}, {3.878022763644738*^9, 
  3.878022823789957*^9}, {3.878022855805319*^9, 3.8780228836038427`*^9}, {
  3.878022958964085*^9, 3.8780229728251*^9}, {3.878025964817404*^9, 
  3.878025974154643*^9}, {3.878032030200883*^9, 3.878032043291239*^9}, {
  3.87807694175404*^9, 3.878076942268965*^9}},
 CellLabel->
  "In[166]:=",ExpressionUUID->"f3ddb63b-7d8f-4997-9389-f334fbed6258"],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
   RowBox[{"X", "[", 
    RowBox[{"1", ",", 
     RowBox[{"X", "[", 
      RowBox[{"2", ",", "3"}], "]"}]}], "]"}], ",", 
   RowBox[{"X", "[", 
    RowBox[{
     RowBox[{"X", "[", 
      RowBox[{"1", ",", "2"}], "]"}], ",", "3"}], "]"}]}], "}"}]], "Output",
 CellChangeTimes->{
  3.8780227866981993`*^9, 3.8780228244290047`*^9, {3.878022856995924*^9, 
   3.878022886712186*^9}, {3.878022959975482*^9, 3.8780229734233837`*^9}, 
   3.878025942910557*^9, 3.878025974822631*^9, 3.87802604880019*^9, 
   3.87802893737528*^9, 3.8780300797739983`*^9, 3.87803201555766*^9, 
   3.878032046557034*^9, 3.8780325721214447`*^9, 3.878075893987146*^9, 
   3.8780808478320103`*^9, 3.878093449603753*^9, 3.878095848723765*^9, 
   3.878097128656351*^9, 3.878616207345304*^9, 3.878856964569396*^9},
 CellLabel->
  "Out[166]=",ExpressionUUID->"19e5a4fd-f352-41f5-b548-d54d4ac7bfdb"]
}, Open  ]],

Cell[BoxData[{
 RowBox[{
  RowBox[{"num", "=", 
   RowBox[{"\[FivePointedStar]", "[", 
    RowBox[{
     RowBox[{"T", "[", 
      RowBox[{"{", "1", "}"}], "]"}], ",", 
     RowBox[{"T", "[", 
      RowBox[{"{", "2", "}"}], "]"}], ",", 
     RowBox[{"T", "[", 
      RowBox[{"{", "3", "}"}], "]"}]}], "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"nod", "=", 
   RowBox[{
    RowBox[{
     RowBox[{"(", 
      RowBox[{
       RowBox[{
        RowBox[{"num", "/.", 
         RowBox[{"T", "->", "T2F"}]}], "/.", "rmzero"}], "/.", 
       RowBox[{"v", "->", " ", 
        RowBox[{"v", "[", "1", "]"}]}]}], ")"}], "/.", 
     RowBox[{
      RowBox[{"F", "[", "i_", "]"}], ":>", " ", 
      RowBox[{"F", "[", 
       RowBox[{"p", "[", "i", "]"}], "]"}]}]}], "/.", 
    RowBox[{
     RowBox[{"p", "[", 
      RowBox[{"f1_", ",", "g__"}], "]"}], ":>", 
     RowBox[{"P", "[", " ", 
      RowBox[{"Total", "[", 
       RowBox[{"p", "/@", 
        RowBox[{"{", 
         RowBox[{"f1", ",", "g"}], "}"}]}], "]"}], "]"}]}]}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"bpeff2", "=", 
   RowBox[{"BinaryProduct", "[", 
    RowBox[{"Range", "[", 
     RowBox[{"n", "-", "2"}], "]"}], "]"}]}], ";"}], "\n", 
 RowBox[{
  RowBox[{"numList", "=", 
   RowBox[{
    RowBox[{
     RowBox[{"ExpandNCM", "/@", 
      RowBox[{"(", 
       RowBox[{"bpeff2", "/.", 
        RowBox[{"X", "\[Rule]", " ", "NC"}]}], ")"}]}], "/.", 
     RowBox[{"NonCommutativeMultiply", "\[Rule]", " ", "T"}]}], "/.", 
    RowBox[{
     RowBox[{"T", "[", 
      RowBox[{"i1_", ",", "f___"}], "]"}], ":>", " ", 
     RowBox[{"0", "/;", 
      RowBox[{"i1", "\[NotEqual]", "1"}]}]}]}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"numListL", "=", 
   RowBox[{"numList", "/.", 
    RowBox[{
     RowBox[{"T", "[", "f___", "]"}], "\[RuleDelayed]", " ", 
     RowBox[{"(", 
      RowBox[{"nod", "/.", 
       RowBox[{"replace", "[", 
        RowBox[{
         RowBox[{"p", "/@", 
          RowBox[{"{", "f", "}"}]}], ",", 
         RowBox[{"n", "-", "1"}]}], "]"}]}], ")"}]}]}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"numListL", "=", 
   RowBox[{
    RowBox[{"(", 
     RowBox[{"numListL", "/.", 
      RowBox[{
       RowBox[{"F", "[", 
        RowBox[{"p", "[", "i_", "]"}], "]"}], ":>", " ", 
       RowBox[{"F", "[", "i", "]"}]}]}], ")"}], "//", "Expand"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"ppListD", "=", 
   RowBox[{"(", 
    RowBox[{"X2Prop", "/@", "bpeff2"}], ")"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"ppListD", "=", 
   RowBox[{
    RowBox[{"ppListD", "/.", 
     RowBox[{
      RowBox[{"p", "[", "f__", "]"}], "\[RuleDelayed]", 
      RowBox[{"Total", "[", 
       RowBox[{"p", "/@", 
        RowBox[{"{", "f", "}"}]}], "]"}]}]}], "/.", 
    RowBox[{
     RowBox[{"dot", "[", 
      RowBox[{
       RowBox[{"p", "[", "i_", "]"}], ",", 
       RowBox[{"p", "[", "i_", "]"}]}], "]"}], ":>", " ", "0"}]}]}], 
  ";"}], "\n", 
 RowBox[{
  RowBox[{"denAll", "=", 
   RowBox[{"Table", "[", 
    RowBox[{
     RowBox[{"ppListD", "[", 
      RowBox[{"[", "ii", "]"}], "]"}], ",", 
     RowBox[{"{", 
      RowBox[{"ii", ",", 
       RowBox[{"Length", "@", "ppListD"}]}], "}"}]}], "]"}]}], ";"}], "\n", 
 RowBox[{
  RowBox[{"ampYM", "=", 
   RowBox[{
    RowBox[{
     RowBox[{"Sum", "[", 
      RowBox[{
       FractionBox[
        RowBox[{"numListL", "[", 
         RowBox[{"[", "ii", "]"}], "]"}], 
        RowBox[{"denAll", "[", 
         RowBox[{"[", "ii", "]"}], "]"}]], ",", 
       RowBox[{"{", 
        RowBox[{"ii", ",", 
         RowBox[{"Length", "@", "ppListD"}]}], "}"}]}], "]"}], "/.", 
     RowBox[{
      RowBox[{"P", "[", "f_", "]"}], ":>", "f"}]}], "//", "Expand"}]}], 
  ";"}]}], "Input",
 CellChangeTimes->{{3.878023857740679*^9, 3.878023860158512*^9}, {
   3.87802396296658*^9, 3.878024017862441*^9}, {3.878024052254986*^9, 
   3.878024058839876*^9}, {3.8780241059261007`*^9, 3.8780241103419027`*^9}, {
   3.878024288644836*^9, 3.8780243205537767`*^9}, 3.878076927512285*^9},
 CellLabel->
  "In[175]:=",ExpressionUUID->"4ba38add-1e90-4973-a0eb-a9f5230a3a29"],

Cell[BoxData[{
 RowBox[{
  RowBox[{"ampYM", "=", 
   RowBox[{
    RowBox[{"(", 
     RowBox[{
      RowBox[{
       RowBox[{
        RowBox[{
         RowBox[{"(", 
          RowBox[{"ampYM", "//", "expandFS"}], ")"}], "/.", "dotRules"}], "/.",
         "vponshell"}], "/.", "gponshell"}], "//", "Expand"}], ")"}], "//", 
    "MultivariateApart"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"ampYMGlueNum3", "=", 
   RowBox[{
    RowBox[{
     RowBox[{
      RowBox[{
       RowBox[{"ampYM", "/.", 
        RowBox[{"{", 
         RowBox[{
          RowBox[{
           RowBox[{"dot", "[", 
            RowBox[{
             RowBox[{"v", "[", "1", "]"}], ",", "f_"}], "]"}], ":>", 
           RowBox[{"dot", "[", 
            RowBox[{
             RowBox[{
              RowBox[{"p", "[", "1", "]"}], "+", 
              RowBox[{"p", "[", "2", "]"}], "+", 
              RowBox[{"p", "[", "3", "]"}]}], ",", 
             RowBox[{"S", "[", "0", "]"}], ",", "f"}], "]"}]}], ",", 
          RowBox[{
           RowBox[{"dot", "[", 
            RowBox[{"f_", ",", 
             RowBox[{"v", "[", "1", "]"}]}], "]"}], ":>", 
           RowBox[{"dot", "[", 
            RowBox[{
             RowBox[{
              RowBox[{"p", "[", "1", "]"}], "+", 
              RowBox[{"p", "[", "2", "]"}], "+", 
              RowBox[{"p", "[", "3", "]"}]}], ",", 
             RowBox[{"S", "[", "0", "]"}], ",", "f"}], "]"}]}]}], "}"}]}], "/.",
        "dotRules"}], "/.", "vponshell"}], "/.", "gponshell"}], "//", 
    "Expand"}]}], ";"}]}], "Input",
 CellChangeTimes->{{3.878024069941125*^9, 3.87802415205725*^9}, {
   3.878024331157475*^9, 3.878024340048336*^9}, {3.8780243883823147`*^9, 
   3.87802443440853*^9}, {3.878024623562881*^9, 3.878024662661223*^9}, {
   3.878024820522764*^9, 3.878024839044957*^9}, {3.878025373216962*^9, 
   3.878025408461379*^9}, {3.878025474618256*^9, 3.878025484493874*^9}, 
   3.878025529761257*^9, {3.8780757748389797`*^9, 3.878075783185919*^9}, 
   3.878075831065405*^9},
 CellLabel->
  "In[185]:=",ExpressionUUID->"50109fa6-4aef-4b99-98a7-c5ed1149348c"],

Cell[BoxData[
 RowBox[{
  RowBox[{"comp", "=", 
   RowBox[{
    RowBox[{"amp5", "-", "ampYMGlueNum3"}], "//", "Expand"}]}], 
  ";"}]], "Input",
 CellLabel->
  "In[187]:=",ExpressionUUID->"d6b198be-e867-4bbb-b3d5-34b139716bfc"],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"ampYMGlueNum3", "//", "Casesdot"}]], "Input",
 CellChangeTimes->{{3.878025359578898*^9, 3.878025361651252*^9}, 
   3.878025545392538*^9},
 CellLabel->
  "In[188]:=",ExpressionUUID->"cb22c795-a365-4f26-a2e3-e6ef2eb88c94"],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
   RowBox[{"dot", "[", 
    RowBox[{
     RowBox[{"p", "[", "1", "]"}], ",", 
     RowBox[{"p", "[", "2", "]"}]}], "]"}], ",", 
   RowBox[{"dot", "[", 
    RowBox[{
     RowBox[{"p", "[", "1", "]"}], ",", 
     RowBox[{"p", "[", "3", "]"}]}], "]"}], ",", 
   RowBox[{"dot", "[", 
    RowBox[{
     RowBox[{"p", "[", "1", "]"}], ",", 
     RowBox[{"\[Epsilon]", "[", "2", "]"}]}], "]"}], ",", 
   RowBox[{"dot", "[", 
    RowBox[{
     RowBox[{"p", "[", "1", "]"}], ",", 
     RowBox[{"\[Epsilon]", "[", "3", "]"}]}], "]"}], ",", 
   RowBox[{"dot", "[", 
    RowBox[{
     RowBox[{"p", "[", "2", "]"}], ",", 
     RowBox[{"\[Epsilon]", "[", "1", "]"}]}], "]"}], ",", 
   RowBox[{"dot", "[", 
    RowBox[{
     RowBox[{"p", "[", "2", "]"}], ",", 
     RowBox[{"\[Epsilon]", "[", "3", "]"}]}], "]"}], ",", 
   RowBox[{"dot", "[", 
    RowBox[{
     RowBox[{"p", "[", "3", "]"}], ",", 
     RowBox[{"\[Epsilon]", "[", "1", "]"}]}], "]"}], ",", 
   RowBox[{"dot", "[", 
    RowBox[{
     RowBox[{"p", "[", "3", "]"}], ",", 
     RowBox[{"\[Epsilon]", "[", "2", "]"}]}], "]"}], ",", 
   RowBox[{"dot", "[", 
    RowBox[{
     RowBox[{"\[Epsilon]", "[", "1", "]"}], ",", 
     RowBox[{"\[Epsilon]", "[", "2", "]"}]}], "]"}], ",", 
   RowBox[{"dot", "[", 
    RowBox[{
     RowBox[{"\[Epsilon]", "[", "1", "]"}], ",", 
     RowBox[{"\[Epsilon]", "[", "3", "]"}]}], "]"}], ",", 
   RowBox[{"dot", "[", 
    RowBox[{
     RowBox[{"\[Epsilon]", "[", "2", "]"}], ",", 
     RowBox[{"\[Epsilon]", "[", "3", "]"}]}], "]"}], ",", 
   RowBox[{"dot", "[", 
    RowBox[{
     RowBox[{"p", "[", "1", "]"}], ",", 
     RowBox[{"S", "[", "0", "]"}], ",", 
     RowBox[{"p", "[", "2", "]"}]}], "]"}], ",", 
   RowBox[{"dot", "[", 
    RowBox[{
     RowBox[{"p", "[", "1", "]"}], ",", 
     RowBox[{"S", "[", "0", "]"}], ",", 
     RowBox[{"p", "[", "3", "]"}]}], "]"}], ",", 
   RowBox[{"dot", "[", 
    RowBox[{
     RowBox[{"p", "[", "1", "]"}], ",", 
     RowBox[{"S", "[", "0", "]"}], ",", 
     RowBox[{"\[Epsilon]", "[", "1", "]"}]}], "]"}], ",", 
   RowBox[{"dot", "[", 
    RowBox[{
     RowBox[{"p", "[", "1", "]"}], ",", 
     RowBox[{"S", "[", "0", "]"}], ",", 
     RowBox[{"\[Epsilon]", "[", "2", "]"}]}], "]"}], ",", 
   RowBox[{"dot", "[", 
    RowBox[{
     RowBox[{"p", "[", "1", "]"}], ",", 
     RowBox[{"S", "[", "0", "]"}], ",", 
     RowBox[{"\[Epsilon]", "[", "3", "]"}]}], "]"}], ",", 
   RowBox[{"dot", "[", 
    RowBox[{
     RowBox[{"p", "[", "2", "]"}], ",", 
     RowBox[{"S", "[", "0", "]"}], ",", 
     RowBox[{"p", "[", "3", "]"}]}], "]"}], ",", 
   RowBox[{"dot", "[", 
    RowBox[{
     RowBox[{"p", "[", "2", "]"}], ",", 
     RowBox[{"S", "[", "0", "]"}], ",", 
     RowBox[{"\[Epsilon]", "[", "1", "]"}]}], "]"}], ",", 
   RowBox[{"dot", "[", 
    RowBox[{
     RowBox[{"p", "[", "2", "]"}], ",", 
     RowBox[{"S", "[", "0", "]"}], ",", 
     RowBox[{"\[Epsilon]", "[", "2", "]"}]}], "]"}], ",", 
   RowBox[{"dot", "[", 
    RowBox[{
     RowBox[{"p", "[", "2", "]"}], ",", 
     RowBox[{"S", "[", "0", "]"}], ",", 
     RowBox[{"\[Epsilon]", "[", "3", "]"}]}], "]"}], ",", 
   RowBox[{"dot", "[", 
    RowBox[{
     RowBox[{"p", "[", "3", "]"}], ",", 
     RowBox[{"S", "[", "0", "]"}], ",", 
     RowBox[{"\[Epsilon]", "[", "1", "]"}]}], "]"}], ",", 
   RowBox[{"dot", "[", 
    RowBox[{
     RowBox[{"p", "[", "3", "]"}], ",", 
     RowBox[{"S", "[", "0", "]"}], ",", 
     RowBox[{"\[Epsilon]", "[", "2", "]"}]}], "]"}], ",", 
   RowBox[{"dot", "[", 
    RowBox[{
     RowBox[{"p", "[", "3", "]"}], ",", 
     RowBox[{"S", "[", "0", "]"}], ",", 
     RowBox[{"\[Epsilon]", "[", "3", "]"}]}], "]"}]}], "}"}]], "Output",
 CellChangeTimes->{
  3.87802536200679*^9, {3.878025540305586*^9, 3.878025545855358*^9}, 
   3.8780300933405113`*^9, 3.878032064069356*^9, 3.878075792934668*^9, 
   3.878075839458539*^9, 3.878075937649824*^9, 3.87808085634507*^9, 
   3.8780934582049007`*^9, 3.8780958573056183`*^9, 3.878616215922042*^9, 
   3.878856973283333*^9},
 CellLabel->
  "Out[188]=",ExpressionUUID->"05f8fdf2-1520-4722-956e-35e8fad20f4e"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"amp5", "//", "Casesdot"}]], "Input",
 CellChangeTimes->{3.878025559520433*^9},
 CellLabel->
  "In[189]:=",ExpressionUUID->"61e32d22-3e04-4e8a-b0e1-dc5ba8c54a93"],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
   RowBox[{"dot", "[", 
    RowBox[{
     RowBox[{"p", "[", "1", "]"}], ",", 
     RowBox[{"p", "[", "2", "]"}]}], "]"}], ",", 
   RowBox[{"dot", "[", 
    RowBox[{
     RowBox[{"p", "[", "1", "]"}], ",", 
     RowBox[{"p", "[", "3", "]"}]}], "]"}], ",", 
   RowBox[{"dot", "[", 
    RowBox[{
     RowBox[{"p", "[", "1", "]"}], ",", 
     RowBox[{"\[Epsilon]", "[", "2", "]"}]}], "]"}], ",", 
   RowBox[{"dot", "[", 
    RowBox[{
     RowBox[{"p", "[", "1", "]"}], ",", 
     RowBox[{"\[Epsilon]", "[", "3", "]"}]}], "]"}], ",", 
   RowBox[{"dot", "[", 
    RowBox[{
     RowBox[{"p", "[", "2", "]"}], ",", 
     RowBox[{"v", "[", "1", "]"}]}], "]"}], ",", 
   RowBox[{"dot", "[", 
    RowBox[{
     RowBox[{"p", "[", "2", "]"}], ",", 
     RowBox[{"\[Epsilon]", "[", "1", "]"}]}], "]"}], ",", 
   RowBox[{"dot", "[", 
    RowBox[{
     RowBox[{"p", "[", "2", "]"}], ",", 
     RowBox[{"\[Epsilon]", "[", "3", "]"}]}], "]"}], ",", 
   RowBox[{"dot", "[", 
    RowBox[{
     RowBox[{"p", "[", "3", "]"}], ",", 
     RowBox[{"v", "[", "1", "]"}]}], "]"}], ",", 
   RowBox[{"dot", "[", 
    RowBox[{
     RowBox[{"p", "[", "3", "]"}], ",", 
     RowBox[{"\[Epsilon]", "[", "1", "]"}]}], "]"}], ",", 
   RowBox[{"dot", "[", 
    RowBox[{
     RowBox[{"p", "[", "3", "]"}], ",", 
     RowBox[{"\[Epsilon]", "[", "2", "]"}]}], "]"}], ",", 
   RowBox[{"dot", "[", 
    RowBox[{
     RowBox[{"v", "[", "1", "]"}], ",", 
     RowBox[{"\[Epsilon]", "[", "1", "]"}]}], "]"}], ",", 
   RowBox[{"dot", "[", 
    RowBox[{
     RowBox[{"v", "[", "1", "]"}], ",", 
     RowBox[{"\[Epsilon]", "[", "2", "]"}]}], "]"}], ",", 
   RowBox[{"dot", "[", 
    RowBox[{
     RowBox[{"v", "[", "1", "]"}], ",", 
     RowBox[{"\[Epsilon]", "[", "3", "]"}]}], "]"}], ",", 
   RowBox[{"dot", "[", 
    RowBox[{
     RowBox[{"\[Epsilon]", "[", "1", "]"}], ",", 
     RowBox[{"\[Epsilon]", "[", "2", "]"}]}], "]"}], ",", 
   RowBox[{"dot", "[", 
    RowBox[{
     RowBox[{"\[Epsilon]", "[", "1", "]"}], ",", 
     RowBox[{"\[Epsilon]", "[", "3", "]"}]}], "]"}], ",", 
   RowBox[{"dot", "[", 
    RowBox[{
     RowBox[{"\[Epsilon]", "[", "2", "]"}], ",", 
     RowBox[{"\[Epsilon]", "[", "3", "]"}]}], "]"}], ",", 
   RowBox[{"dot", "[", 
    RowBox[{
     RowBox[{"p", "[", "1", "]"}], ",", 
     RowBox[{"S", "[", "0", "]"}], ",", 
     RowBox[{"p", "[", "2", "]"}]}], "]"}], ",", 
   RowBox[{"dot", "[", 
    RowBox[{
     RowBox[{"p", "[", "1", "]"}], ",", 
     RowBox[{"S", "[", "0", "]"}], ",", 
     RowBox[{"p", "[", "3", "]"}]}], "]"}], ",", 
   RowBox[{"dot", "[", 
    RowBox[{
     RowBox[{"p", "[", "1", "]"}], ",", 
     RowBox[{"S", "[", "0", "]"}], ",", 
     RowBox[{"\[Epsilon]", "[", "1", "]"}]}], "]"}], ",", 
   RowBox[{"dot", "[", 
    RowBox[{
     RowBox[{"p", "[", "1", "]"}], ",", 
     RowBox[{"S", "[", "0", "]"}], ",", 
     RowBox[{"\[Epsilon]", "[", "2", "]"}]}], "]"}], ",", 
   RowBox[{"dot", "[", 
    RowBox[{
     RowBox[{"p", "[", "1", "]"}], ",", 
     RowBox[{"S", "[", "0", "]"}], ",", 
     RowBox[{"\[Epsilon]", "[", "3", "]"}]}], "]"}], ",", 
   RowBox[{"dot", "[", 
    RowBox[{
     RowBox[{"p", "[", "2", "]"}], ",", 
     RowBox[{"S", "[", "0", "]"}], ",", 
     RowBox[{"p", "[", "3", "]"}]}], "]"}], ",", 
   RowBox[{"dot", "[", 
    RowBox[{
     RowBox[{"p", "[", "2", "]"}], ",", 
     RowBox[{"S", "[", "0", "]"}], ",", 
     RowBox[{"\[Epsilon]", "[", "1", "]"}]}], "]"}], ",", 
   RowBox[{"dot", "[", 
    RowBox[{
     RowBox[{"p", "[", "2", "]"}], ",", 
     RowBox[{"S", "[", "0", "]"}], ",", 
     RowBox[{"\[Epsilon]", "[", "2", "]"}]}], "]"}], ",", 
   RowBox[{"dot", "[", 
    RowBox[{
     RowBox[{"p", "[", "2", "]"}], ",", 
     RowBox[{"S", "[", "0", "]"}], ",", 
     RowBox[{"\[Epsilon]", "[", "3", "]"}]}], "]"}], ",", 
   RowBox[{"dot", "[", 
    RowBox[{
     RowBox[{"p", "[", "3", "]"}], ",", 
     RowBox[{"S", "[", "0", "]"}], ",", 
     RowBox[{"\[Epsilon]", "[", "1", "]"}]}], "]"}], ",", 
   RowBox[{"dot", "[", 
    RowBox[{
     RowBox[{"p", "[", "3", "]"}], ",", 
     RowBox[{"S", "[", "0", "]"}], ",", 
     RowBox[{"\[Epsilon]", "[", "2", "]"}]}], "]"}], ",", 
   RowBox[{"dot", "[", 
    RowBox[{
     RowBox[{"p", "[", "3", "]"}], ",", 
     RowBox[{"S", "[", "0", "]"}], ",", 
     RowBox[{"\[Epsilon]", "[", "3", "]"}]}], "]"}], ",", 
   RowBox[{"dot", "[", 
    RowBox[{
     RowBox[{"\[Epsilon]", "[", "1", "]"}], ",", 
     RowBox[{"S", "[", "0", "]"}], ",", 
     RowBox[{"\[Epsilon]", "[", "2", "]"}]}], "]"}], ",", 
   RowBox[{"dot", "[", 
    RowBox[{
     RowBox[{"\[Epsilon]", "[", "1", "]"}], ",", 
     RowBox[{"S", "[", "0", "]"}], ",", 
     RowBox[{"\[Epsilon]", "[", "3", "]"}]}], "]"}], ",", 
   RowBox[{"dot", "[", 
    RowBox[{
     RowBox[{"\[Epsilon]", "[", "2", "]"}], ",", 
     RowBox[{"S", "[", "0", "]"}], ",", 
     RowBox[{"\[Epsilon]", "[", "3", "]"}]}], "]"}]}], "}"}]], "Output",
 CellChangeTimes->{3.878025560137146*^9, 3.878025704095583*^9, 
  3.87802595149117*^9, 3.878025989628029*^9, 3.878026059569775*^9, 
  3.878030096513131*^9, 3.878032067650799*^9, 3.878075941938496*^9, 
  3.878080856467115*^9, 3.878093458316214*^9, 3.878095857415905*^9, 
  3.878616216032795*^9, 3.8788569734066153`*^9},
 CellLabel->
  "Out[189]=",ExpressionUUID->"c9b70461-3e4a-41fb-b0d0-80871ccb4d6d"]
}, Open  ]],

Cell[BoxData[
 RowBox[{
  RowBox[{"cvars", "=", 
   RowBox[{
    RowBox[{"Cases", "[", 
     RowBox[{"comp", ",", 
      RowBox[{"c", "[", "__", "]"}], ",", 
      RowBox[{"{", 
       RowBox[{"0", ",", "\[Infinity]"}], "}"}]}], "]"}], "//", "Union"}]}], 
  ";"}]], "Input",
 CellChangeTimes->{{3.8780251119523973`*^9, 3.87802515275441*^9}, {
  3.878033238685581*^9, 3.8780332388754597`*^9}, {3.87807596060207*^9, 
  3.878075960778406*^9}},
 CellLabel->
  "In[190]:=",ExpressionUUID->"9193ff38-c4f5-4984-9621-f6856f883032"],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"cvars", "//", "Length"}]], "Input",
 CellChangeTimes->{{3.878025163562392*^9, 3.878025164327901*^9}},
 CellLabel->
  "In[191]:=",ExpressionUUID->"39adadc5-5e48-4120-8f60-48c236838f1e"],

Cell[BoxData["702"], "Output",
 CellChangeTimes->{3.87802516477238*^9, 3.878026076988738*^9, 
  3.878028973567272*^9, 3.8780301059729843`*^9, 3.87803208614393*^9, 
  3.878033255460141*^9, 3.878075964691884*^9, 3.878080856512931*^9, 
  3.878093458365816*^9, 3.878095857461788*^9, 3.878097147230905*^9, 
  3.8786162160784683`*^9, 3.878856973450467*^9},
 CellLabel->
  "Out[191]=",ExpressionUUID->"6c62b545-2cbb-415c-bed2-e1584ea2f12b"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{
  RowBox[{"vardot", "=", 
   RowBox[{"comp", "//", "Casesdot"}]}], ";"}], "\n", 
 RowBox[{
  RowBox[{"dot2num", ":=", 
   RowBox[{"Table", "[", 
    RowBox[{
     RowBox[{"Rule", "[", 
      RowBox[{
       RowBox[{"vardot", "[", 
        RowBox[{"[", "ii", "]"}], "]"}], ",", 
       RowBox[{"RandomInteger", "[", 
        RowBox[{"{", 
         RowBox[{"10", ",", "100"}], "}"}], "]"}]}], "]"}], ",", 
     RowBox[{"{", 
      RowBox[{"ii", ",", 
       RowBox[{"Length", "[", "vardot", "]"}]}], "}"}]}], "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{"Monitor", "[", 
  RowBox[{
   RowBox[{
    RowBox[{"eqDep", "=", 
     RowBox[{"Table", "[", 
      RowBox[{
       RowBox[{
        RowBox[{"comp", "\[Equal]", "0"}], "/.", "dot2num"}], ",", 
       RowBox[{"{", 
        RowBox[{"ii", ",", 
         RowBox[{"10", "+", 
          RowBox[{"Length", "[", "cvars", "]"}]}]}], "}"}]}], "]"}]}], ";"}], 
   ",", "ii"}], "]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"sols", "=", 
   RowBox[{
    RowBox[{"Solve", "[", 
     RowBox[{"eqDep", ",", "cvars"}], "]"}], "[", 
    RowBox[{"[", "1", "]"}], "]"}]}], ";"}]}], "Input",
 CellChangeTimes->{{3.878025083563089*^9, 3.878025098342598*^9}, {
  3.87802516936078*^9, 3.878025185960835*^9}, {3.878033243467019*^9, 
  3.8780332467055893`*^9}, {3.8780759694484453`*^9, 3.878075974363841*^9}},
 CellLabel->
  "In[192]:=",ExpressionUUID->"fddf6110-1455-45a2-bf6f-04258e5c7966"],

Cell[BoxData[
 TemplateBox[{
  "Solve", "svars", 
   "\"Equations may not give solutions for all \\\"solve\\\" variables.\"", 2,
    195, 1, 28415626182954115862, "Local"},
  "MessageTemplate"]], "Message", "MSG",
 CellChangeTimes->{3.87802613489694*^9, 3.878029156688776*^9, 
  3.8780303199023113`*^9, 3.8780322863051863`*^9, 3.878032831294737*^9, 
  3.878033318277973*^9, 3.878076165657085*^9, 3.8780810434805603`*^9, 
  3.878093646396821*^9, 3.878096045334003*^9, 3.878097342954261*^9, 
  3.878616404167441*^9, 3.8788571626661367`*^9},
 CellLabel->
  "During evaluation of \
In[192]:=",ExpressionUUID->"16dbee5b-926e-4dd3-8570-5a07a8c58f47"]
}, Open  ]]
}, Closed]],

Cell[CellGroupData[{

Cell["Factorisation condition v.p1", "Subsection",
 CellChangeTimes->{{3.878076748965989*^9, 3.878076767862722*^9}, {
  3.87809373543461*^9, 
  3.8780937386875668`*^9}},ExpressionUUID->"59008d8c-f1bc-4395-90d7-\
7585486b8a07"],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{
  RowBox[{"numAnsatz2", "=", 
   RowBox[{
    RowBox[{
     RowBox[{
      RowBox[{
       RowBox[{"(", 
        RowBox[{"numAnsatz", "//", "expandFS"}], ")"}], "//.", "dotRules"}], "/.", 
      RowBox[{"(", 
       RowBox[{
        RowBox[{"vonshell", "[", 
         RowBox[{
          RowBox[{"n", "-", "1"}], ",", "3"}], "]"}], "/.", 
        RowBox[{"v", "->", 
         RowBox[{"v", "[", "1", "]"}]}]}], ")"}]}], "/.", "sols"}], "//", 
    "Expand"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{"%", "//", "Length"}]}], "Input",
 CellChangeTimes->{{3.878076776346158*^9, 3.878076791822427*^9}, {
   3.878076863747164*^9, 3.8780768651784353`*^9}, {3.878077446334421*^9, 
   3.878077450450157*^9}, 3.878080568874198*^9, 3.878080843522138*^9, {
   3.878084931218405*^9, 3.8780849369136047`*^9}, {3.878085107286035*^9, 
   3.878085112014679*^9}, {3.8780852927862673`*^9, 3.878085294285921*^9}},
 CellLabel->
  "In[196]:=",ExpressionUUID->"dc0dd67c-3dde-4e59-b697-febe97da0a1a"],

Cell[BoxData["7043"], "Output",
 CellChangeTimes->{{3.87807677960294*^9, 3.878076792387086*^9}, 
   3.878076869394702*^9, 3.878077463656658*^9, 3.878080582971023*^9, 
   3.878081061748372*^9, 3.878084951014349*^9, 3.878085126532173*^9, 
   3.878085312641127*^9, 3.878093665706396*^9, 3.87809605896621*^9, 
   3.878616417798953*^9, 3.878857176355879*^9},
 CellLabel->
  "Out[197]=",ExpressionUUID->"93c605f5-1b1a-4de3-af69-69d9d54a521a"]
}, Open  ]],

Cell[BoxData[
 RowBox[{
  RowBox[{"numAnsatzvp1", "=", 
   RowBox[{
    RowBox[{
     RowBox[{
      RowBox[{"(", 
       RowBox[{
        RowBox[{
         RowBox[{"(", 
          RowBox[{"numAnsatz2", "//", 
           RowBox[{"Cases", "[", 
            RowBox[{"Times", "[", 
             RowBox[{"f___", ",", 
              RowBox[{"Power", "[", 
               RowBox[{
                RowBox[{"dot", "[", 
                 RowBox[{
                  RowBox[{"p", "[", "1", "]"}], ",", 
                  RowBox[{"v", "[", "1", "]"}]}], "]"}], ",", 
                RowBox[{"-", "1"}]}], "]"}], ",", "g___"}], "]"}], "]"}]}], 
          ")"}], "/.", 
         RowBox[{
          RowBox[{"Power", "[", 
           RowBox[{
            RowBox[{"dot", "[", 
             RowBox[{
              RowBox[{"p", "[", "1", "]"}], ",", 
              RowBox[{"v", "[", "1", "]"}]}], "]"}], ",", 
            RowBox[{"-", "1"}]}], "]"}], "->", "1"}]}], "//", "Total"}], 
       ")"}], "//.", "dotRules"}], "/.", "vponshell"}], "/.", 
    RowBox[{"{", 
     RowBox[{
      RowBox[{
       RowBox[{"dot", "[", 
        RowBox[{
         RowBox[{"p", "[", "1", "]"}], ",", 
         RowBox[{"v", "[", "1", "]"}]}], "]"}], "->", "0"}], ",", 
      RowBox[{
       RowBox[{"dot", "[", 
        RowBox[{
         RowBox[{"p", "[", "2", "]"}], ",", 
         RowBox[{"v", "[", "1", "]"}]}], "]"}], "->", 
       RowBox[{"-", 
        RowBox[{"dot", "[", 
         RowBox[{
          RowBox[{"p", "[", "3", "]"}], ",", 
          RowBox[{"v", "[", "1", "]"}]}], "]"}]}]}]}], "}"}]}]}], 
  ";"}]], "Input",
 CellChangeTimes->{{3.878077052129978*^9, 3.878077125591745*^9}, {
   3.878077237157652*^9, 3.878077281353335*^9}, {3.8780773702267103`*^9, 
   3.8780774435353603`*^9}, {3.8780774739935207`*^9, 3.8780775017717133`*^9}, 
   3.878079930873101*^9, 3.878079973240665*^9, {3.878085415182927*^9, 
   3.8780854153236303`*^9}, 3.878085446328352*^9},
 CellLabel->
  "In[198]:=",ExpressionUUID->"dd10c95d-9715-47e2-bb63-16e790130cca"],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"numAnsatzvp1", "//", "Length"}]], "Input",
 CellChangeTimes->{{3.878085457345728*^9, 3.878085458484248*^9}},
 CellLabel->
  "In[199]:=",ExpressionUUID->"41dc9814-153d-4905-baad-0973404bfe2d"],

Cell[BoxData["1830"], "Output",
 CellChangeTimes->{{3.878085424115284*^9, 3.8780854589677*^9}, 
   3.878093671135722*^9, 3.878096059862764*^9, 3.8786164187058687`*^9, 
   3.878857177246789*^9},
 CellLabel->
  "Out[199]=",ExpressionUUID->"64e5025d-74a6-4a13-9e05-450efacdc0a7"]
}, Open  ]],

Cell[BoxData[{
 RowBox[{
  RowBox[{"num1", "=", 
   RowBox[{
    RowBox[{
     RowBox[{"T", "[", 
      RowBox[{"{", "1", "}"}], "]"}], "/.", 
     RowBox[{"T", "->", "T2F"}]}], "/.", 
    RowBox[{"v", "->", 
     RowBox[{"v", "[", "1", "]"}]}]}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"num2", "=", 
   RowBox[{"(", 
    RowBox[{
     FractionBox[
      RowBox[{"dot", "[", 
       RowBox[{
        RowBox[{"p", "[", "2", "]"}], ",", 
        RowBox[{"S", "[", "0", "]"}], ",", 
        RowBox[{"F", "[", "2", "]"}], ",", 
        RowBox[{"F", "[", "3", "]"}], ",", 
        RowBox[{"v", "[", "1", "]"}]}], "]"}], 
      RowBox[{"dot", "[", 
       RowBox[{
        RowBox[{"p", "[", "2", "]"}], ",", 
        RowBox[{"v", "[", "1", "]"}]}], "]"}]], "+", 
     FractionBox[
      RowBox[{"dot", "[", 
       RowBox[{
        RowBox[{"p", "[", "2", "]"}], ",", 
        RowBox[{"S", "[", "0", "]"}], ",", 
        RowBox[{"F", "[", "3", "]"}], ",", 
        RowBox[{"F", "[", "2", "]"}], ",", 
        RowBox[{"v", "[", "1", "]"}]}], "]"}], 
      RowBox[{"dot", "[", 
       RowBox[{
        RowBox[{"p", "[", "2", "]"}], ",", 
        RowBox[{"v", "[", "1", "]"}]}], "]"}]], "-", 
     FractionBox[
      RowBox[{"dot", "[", 
       RowBox[{
        RowBox[{"p", "[", "2", "]"}], ",", 
        RowBox[{"F", "[", "3", "]"}], ",", 
        RowBox[{"S", "[", "0", "]"}], ",", 
        RowBox[{"F", "[", "2", "]"}], ",", 
        RowBox[{"v", "[", "1", "]"}]}], "]"}], 
      RowBox[{"dot", "[", 
       RowBox[{
        RowBox[{"p", "[", "2", "]"}], ",", 
        RowBox[{"v", "[", "1", "]"}]}], "]"}]], "+", 
     FractionBox[
      RowBox[{"dot", "[", 
       RowBox[{
        RowBox[{"p", "[", "3", "]"}], ",", 
        RowBox[{"S", "[", "0", "]"}], ",", 
        RowBox[{"F", "[", "3", "]"}], ",", 
        RowBox[{"F", "[", "2", "]"}], ",", 
        RowBox[{"v", "[", "1", "]"}]}], "]"}], 
      RowBox[{"dot", "[", 
       RowBox[{
        RowBox[{"p", "[", "2", "]"}], ",", 
        RowBox[{"v", "[", "1", "]"}]}], "]"}]]}], ")"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"numvp1", "=", 
   RowBox[{
    RowBox[{
     RowBox[{
      RowBox[{
       RowBox[{"dot", "[", 
        RowBox[{
         RowBox[{"p", "[", "1", "]"}], ",", 
         RowBox[{"p", "[", "2", "]"}]}], "]"}], 
       RowBox[{"(", 
        RowBox[{
         RowBox[{
          RowBox[{"c", "[", "0", "]"}], "num1", "*", "num2"}], "+", 
         RowBox[{
          FractionBox["1", 
           RowBox[{"dot", "[", 
            RowBox[{
             RowBox[{"p", "[", "2", "]"}], ",", 
             RowBox[{"v", "[", "1", "]"}]}], "]"}]], 
          RowBox[{"c", "[", "1", "]"}], 
          RowBox[{"dot", "[", 
           RowBox[{
            RowBox[{"p", "[", "1", "]"}], ",", 
            RowBox[{"S", "[", "0", "]"}], ",", 
            RowBox[{"\[Epsilon]", "[", "1", "]"}]}], "]"}], "*", 
          RowBox[{"dot", "[", 
           RowBox[{
            RowBox[{"v", "[", "1", "]"}], ",", 
            RowBox[{"F", "[", "2", "]"}], ",", 
            RowBox[{"F", "[", "3", "]"}], ",", 
            RowBox[{"v", "[", "1", "]"}]}], "]"}]}]}], ")"}]}], "//.", 
      "dotRules"}], "//", "expandFS"}], "//", "Expand"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"numvp1", "=", 
   RowBox[{
    RowBox[{
     RowBox[{"numvp1", "//.", "dotRules"}], "/.", "vponshell"}], "/.", 
    RowBox[{"{", 
     RowBox[{
      RowBox[{
       RowBox[{"dot", "[", 
        RowBox[{
         RowBox[{"p", "[", "1", "]"}], ",", 
         RowBox[{"v", "[", "1", "]"}]}], "]"}], "->", "0"}], ",", 
      RowBox[{
       RowBox[{"dot", "[", 
        RowBox[{
         RowBox[{"p", "[", "2", "]"}], ",", 
         RowBox[{"v", "[", "1", "]"}]}], "]"}], "->", 
       RowBox[{"-", 
        RowBox[{"dot", "[", 
         RowBox[{
          RowBox[{"p", "[", "3", "]"}], ",", 
          RowBox[{"v", "[", "1", "]"}]}], "]"}]}]}]}], "}"}]}]}], 
  ";"}]}], "Input",
 CellChangeTimes->{{3.878077591985273*^9, 3.8780776461342783`*^9}, {
   3.878077953502172*^9, 3.878077980733405*^9}, {3.878078491930747*^9, 
   3.878078549563458*^9}, {3.878078580745262*^9, 3.87807865251903*^9}, 
   3.878078684800146*^9, {3.878079206140265*^9, 3.878079212664543*^9}, {
   3.878079938416065*^9, 3.8780799390210323`*^9}, {3.878079982854789*^9, 
   3.878079996138009*^9}, 3.878080718496252*^9, 3.878080776110016*^9, {
   3.878081116226698*^9, 3.8780811179219093`*^9}, {3.878081897887516*^9, 
   3.878081929737031*^9}, {3.8780819770250673`*^9, 3.8780819885274878`*^9}, 
   3.8780820357161922`*^9, {3.878082093586617*^9, 3.878082094494379*^9}, 
   3.878082200584118*^9, 3.8780823524734297`*^9, 3.8780843780876017`*^9, {
   3.87808451838385*^9, 3.878084553403726*^9}, {3.878084767872551*^9, 
   3.878084809993238*^9}, {3.878093413770879*^9, 3.878093418381057*^9}},
 CellLabel->
  "In[200]:=",ExpressionUUID->"ca9ad445-a783-4399-bc8f-cb27decc7264"],

Cell[BoxData[
 RowBox[{
  RowBox[{"compvp1", "=", 
   RowBox[{"numAnsatzvp1", "-", "numvp1"}]}], ";"}]], "Input",
 CellChangeTimes->{{3.8780781147500143`*^9, 3.878078179889933*^9}, {
   3.878078714167301*^9, 3.878078719908218*^9}, {3.878078864983605*^9, 
   3.8780788894932623`*^9}, 3.878079927920136*^9, 3.87808000213634*^9},
 CellLabel->
  "In[204]:=",ExpressionUUID->"4c9c479b-3f9e-47b7-87cc-4f2aaffc75ff"],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  RowBox[{"4", " ", 
   RowBox[{
    SubscriptBox["p", "1"], "\[CenterDot]", "S", "\[CenterDot]", 
    SubscriptBox["F", "1"], "\[CenterDot]", 
    SubscriptBox["F", "2"], "\[CenterDot]", "v"}]}], "+", 
  RowBox[{"4", 
   RowBox[{
    SubscriptBox["p", "1"], "\[CenterDot]", "S", "\[CenterDot]", 
    SubscriptBox["F", "2"], "\[CenterDot]", 
    SubscriptBox["F", "1"], "\[CenterDot]", "v"}]}], "-", 
  RowBox[{"4", " ", 
   RowBox[{
    SubscriptBox["p", "1"], "\[CenterDot]", 
    SubscriptBox["F", "2"], "\[CenterDot]", "S", "\[CenterDot]", 
    SubscriptBox["F", "1"], "\[CenterDot]", "v"}]}], "+", 
  RowBox[{"4", " ", 
   RowBox[{
    SubscriptBox["p", "2"], "\[CenterDot]", "S", "\[CenterDot]", 
    SubscriptBox["F", "2"], "\[CenterDot]", 
    SubscriptBox["F", "1"], "\[CenterDot]", "v"}]}]}]], "Input",
 CellChangeTimes->{{3.878078468972107*^9, 3.8780784821254663`*^9}},
 CellLabel->
  "In[205]:=",ExpressionUUID->"7b804a7e-9ab9-4bf6-9230-5156345eb783"],

Cell[BoxData[
 RowBox[{
  RowBox[{"4", " ", 
   RowBox[{
    SubscriptBox["p", "1"], "\[CenterDot]", "S", "\[CenterDot]", 
    SubscriptBox["F", "1"], "\[CenterDot]", 
    SubscriptBox["F", "2"], "\[CenterDot]", "v"}]}], "+", 
  RowBox[{"4", " ", 
   RowBox[{
    SubscriptBox["p", "1"], "\[CenterDot]", "S", "\[CenterDot]", 
    SubscriptBox["F", "2"], "\[CenterDot]", 
    SubscriptBox["F", "1"], "\[CenterDot]", "v"}]}], "-", 
  RowBox[{"4", " ", 
   RowBox[{
    SubscriptBox["p", "1"], "\[CenterDot]", 
    SubscriptBox["F", "2"], "\[CenterDot]", "S", "\[CenterDot]", 
    SubscriptBox["F", "1"], "\[CenterDot]", "v"}]}], "+", 
  RowBox[{"4", " ", 
   RowBox[{
    SubscriptBox["p", "2"], "\[CenterDot]", "S", "\[CenterDot]", 
    SubscriptBox["F", "2"], "\[CenterDot]", 
    SubscriptBox["F", "1"], "\[CenterDot]", "v"}]}]}]], "Output",
 CellChangeTimes->{3.878096059926221*^9, 3.878616418771454*^9, 
  3.878857177311327*^9},
 CellLabel->
  "Out[205]=",ExpressionUUID->"ebf98b12-7aee-446a-b794-0eaad2812c7b"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"compvp1", "//", "Casesdot"}]], "Input",
 CellChangeTimes->{{3.8780788203554583`*^9, 3.878078825352446*^9}},
 CellLabel->
  "In[206]:=",ExpressionUUID->"062d9e59-9330-4ae3-a27e-eaeb0141a898"],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
   RowBox[{"dot", "[", 
    RowBox[{
     RowBox[{"p", "[", "1", "]"}], ",", 
     RowBox[{"p", "[", "2", "]"}]}], "]"}], ",", 
   RowBox[{"dot", "[", 
    RowBox[{
     RowBox[{"p", "[", "1", "]"}], ",", 
     RowBox[{"p", "[", "3", "]"}]}], "]"}], ",", 
   RowBox[{"dot", "[", 
    RowBox[{
     RowBox[{"p", "[", "1", "]"}], ",", 
     RowBox[{"\[Epsilon]", "[", "2", "]"}]}], "]"}], ",", 
   RowBox[{"dot", "[", 
    RowBox[{
     RowBox[{"p", "[", "1", "]"}], ",", 
     RowBox[{"\[Epsilon]", "[", "3", "]"}]}], "]"}], ",", 
   RowBox[{"dot", "[", 
    RowBox[{
     RowBox[{"p", "[", "2", "]"}], ",", 
     RowBox[{"p", "[", "3", "]"}]}], "]"}], ",", 
   RowBox[{"dot", "[", 
    RowBox[{
     RowBox[{"p", "[", "2", "]"}], ",", 
     RowBox[{"\[Epsilon]", "[", "1", "]"}]}], "]"}], ",", 
   RowBox[{"dot", "[", 
    RowBox[{
     RowBox[{"p", "[", "2", "]"}], ",", 
     RowBox[{"\[Epsilon]", "[", "3", "]"}]}], "]"}], ",", 
   RowBox[{"dot", "[", 
    RowBox[{
     RowBox[{"p", "[", "3", "]"}], ",", 
     RowBox[{"v", "[", "1", "]"}]}], "]"}], ",", 
   RowBox[{"dot", "[", 
    RowBox[{
     RowBox[{"p", "[", "3", "]"}], ",", 
     RowBox[{"\[Epsilon]", "[", "1", "]"}]}], "]"}], ",", 
   RowBox[{"dot", "[", 
    RowBox[{
     RowBox[{"p", "[", "3", "]"}], ",", 
     RowBox[{"\[Epsilon]", "[", "2", "]"}]}], "]"}], ",", 
   RowBox[{"dot", "[", 
    RowBox[{
     RowBox[{"v", "[", "1", "]"}], ",", 
     RowBox[{"\[Epsilon]", "[", "1", "]"}]}], "]"}], ",", 
   RowBox[{"dot", "[", 
    RowBox[{
     RowBox[{"v", "[", "1", "]"}], ",", 
     RowBox[{"\[Epsilon]", "[", "2", "]"}]}], "]"}], ",", 
   RowBox[{"dot", "[", 
    RowBox[{
     RowBox[{"v", "[", "1", "]"}], ",", 
     RowBox[{"\[Epsilon]", "[", "3", "]"}]}], "]"}], ",", 
   RowBox[{"dot", "[", 
    RowBox[{
     RowBox[{"\[Epsilon]", "[", "1", "]"}], ",", 
     RowBox[{"\[Epsilon]", "[", "2", "]"}]}], "]"}], ",", 
   RowBox[{"dot", "[", 
    RowBox[{
     RowBox[{"\[Epsilon]", "[", "1", "]"}], ",", 
     RowBox[{"\[Epsilon]", "[", "3", "]"}]}], "]"}], ",", 
   RowBox[{"dot", "[", 
    RowBox[{
     RowBox[{"\[Epsilon]", "[", "2", "]"}], ",", 
     RowBox[{"\[Epsilon]", "[", "3", "]"}]}], "]"}], ",", 
   RowBox[{"dot", "[", 
    RowBox[{
     RowBox[{"p", "[", "1", "]"}], ",", 
     RowBox[{"S", "[", "0", "]"}], ",", 
     RowBox[{"p", "[", "2", "]"}]}], "]"}], ",", 
   RowBox[{"dot", "[", 
    RowBox[{
     RowBox[{"p", "[", "1", "]"}], ",", 
     RowBox[{"S", "[", "0", "]"}], ",", 
     RowBox[{"p", "[", "3", "]"}]}], "]"}], ",", 
   RowBox[{"dot", "[", 
    RowBox[{
     RowBox[{"p", "[", "1", "]"}], ",", 
     RowBox[{"S", "[", "0", "]"}], ",", 
     RowBox[{"\[Epsilon]", "[", "1", "]"}]}], "]"}], ",", 
   RowBox[{"dot", "[", 
    RowBox[{
     RowBox[{"p", "[", "1", "]"}], ",", 
     RowBox[{"S", "[", "0", "]"}], ",", 
     RowBox[{"\[Epsilon]", "[", "2", "]"}]}], "]"}], ",", 
   RowBox[{"dot", "[", 
    RowBox[{
     RowBox[{"p", "[", "1", "]"}], ",", 
     RowBox[{"S", "[", "0", "]"}], ",", 
     RowBox[{"\[Epsilon]", "[", "3", "]"}]}], "]"}], ",", 
   RowBox[{"dot", "[", 
    RowBox[{
     RowBox[{"p", "[", "2", "]"}], ",", 
     RowBox[{"S", "[", "0", "]"}], ",", 
     RowBox[{"p", "[", "3", "]"}]}], "]"}], ",", 
   RowBox[{"dot", "[", 
    RowBox[{
     RowBox[{"p", "[", "2", "]"}], ",", 
     RowBox[{"S", "[", "0", "]"}], ",", 
     RowBox[{"\[Epsilon]", "[", "1", "]"}]}], "]"}], ",", 
   RowBox[{"dot", "[", 
    RowBox[{
     RowBox[{"p", "[", "2", "]"}], ",", 
     RowBox[{"S", "[", "0", "]"}], ",", 
     RowBox[{"\[Epsilon]", "[", "2", "]"}]}], "]"}], ",", 
   RowBox[{"dot", "[", 
    RowBox[{
     RowBox[{"p", "[", "2", "]"}], ",", 
     RowBox[{"S", "[", "0", "]"}], ",", 
     RowBox[{"\[Epsilon]", "[", "3", "]"}]}], "]"}], ",", 
   RowBox[{"dot", "[", 
    RowBox[{
     RowBox[{"p", "[", "3", "]"}], ",", 
     RowBox[{"S", "[", "0", "]"}], ",", 
     RowBox[{"\[Epsilon]", "[", "1", "]"}]}], "]"}], ",", 
   RowBox[{"dot", "[", 
    RowBox[{
     RowBox[{"p", "[", "3", "]"}], ",", 
     RowBox[{"S", "[", "0", "]"}], ",", 
     RowBox[{"\[Epsilon]", "[", "2", "]"}]}], "]"}], ",", 
   RowBox[{"dot", "[", 
    RowBox[{
     RowBox[{"p", "[", "3", "]"}], ",", 
     RowBox[{"S", "[", "0", "]"}], ",", 
     RowBox[{"\[Epsilon]", "[", "3", "]"}]}], "]"}], ",", 
   RowBox[{"dot", "[", 
    RowBox[{
     RowBox[{"\[Epsilon]", "[", "1", "]"}], ",", 
     RowBox[{"S", "[", "0", "]"}], ",", 
     RowBox[{"\[Epsilon]", "[", "2", "]"}]}], "]"}], ",", 
   RowBox[{"dot", "[", 
    RowBox[{
     RowBox[{"\[Epsilon]", "[", "1", "]"}], ",", 
     RowBox[{"S", "[", "0", "]"}], ",", 
     RowBox[{"\[Epsilon]", "[", "3", "]"}]}], "]"}], ",", 
   RowBox[{"dot", "[", 
    RowBox[{
     RowBox[{"\[Epsilon]", "[", "2", "]"}], ",", 
     RowBox[{"S", "[", "0", "]"}], ",", 
     RowBox[{"\[Epsilon]", "[", "3", "]"}]}], "]"}]}], "}"}]], "Output",
 CellChangeTimes->{3.8780787909855328`*^9, 3.878078825754147*^9, 
  3.8780789139500523`*^9, 3.878079583885482*^9, 3.8780807366766977`*^9, 
  3.87808078442798*^9, 3.878096059944249*^9, 3.878616418781658*^9, 
  3.8788571773212433`*^9},
 CellLabel->
  "Out[206]=",ExpressionUUID->"fd2a22fe-18cf-456e-b592-2758860c6ce1"]
}, Open  ]],

Cell[BoxData[{
 RowBox[{
  RowBox[{"cvars", "=", 
   RowBox[{
    RowBox[{"Cases", "[", 
     RowBox[{"compvp1", ",", 
      RowBox[{"c", "[", "__", "]"}], ",", 
      RowBox[{"{", 
       RowBox[{"0", ",", "\[Infinity]"}], "}"}]}], "]"}], "//", "Union"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"vardot", "=", 
   RowBox[{"compvp1", "//", "Casesdot"}]}], ";"}]}], "Input",
 CellChangeTimes->{{3.878078218083035*^9, 3.878078227195683*^9}},
 CellLabel->
  "In[207]:=",ExpressionUUID->"0bebda31-7cb7-4bff-9b51-527173edc4e6"],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"cvars", "//", "Length"}]], "Input",
 CellChangeTimes->{{3.878078250405406*^9, 3.8780782515980988`*^9}, 
   3.8780793030421352`*^9, {3.878080618122617*^9, 3.878080619511405*^9}},
 CellLabel->
  "In[209]:=",ExpressionUUID->"2d742d42-c9ab-44d1-a0ff-2066ee294ede"],

Cell[BoxData["109"], "Output",
 CellChangeTimes->{
  3.878078252063862*^9, 3.878078732430634*^9, {3.8780792683050127`*^9, 
   3.878079303531766*^9}, {3.8780806116761723`*^9, 3.878080620497012*^9}, 
   3.878080793272333*^9, 3.8780810935750732`*^9, 3.8780811318686132`*^9, 
   3.878081941084124*^9, 3.8780820011325197`*^9, 3.878082120982493*^9, 
   3.878084828486793*^9, 3.878085517830093*^9, 3.878093680935251*^9, 
   3.878096059965028*^9, 3.878616418806457*^9, 3.878857177337781*^9},
 CellLabel->
  "Out[209]=",ExpressionUUID->"741eae5f-63e2-4bfd-a6ce-d58935604be5"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{
  RowBox[{"dot2num", ":=", 
   RowBox[{"Table", "[", 
    RowBox[{
     RowBox[{"Rule", "[", 
      RowBox[{
       RowBox[{"vardot", "[", 
        RowBox[{"[", "ii", "]"}], "]"}], ",", 
       RowBox[{"RandomInteger", "[", 
        RowBox[{"{", 
         RowBox[{"10", ",", "100"}], "}"}], "]"}]}], "]"}], ",", 
     RowBox[{"{", 
      RowBox[{"ii", ",", 
       RowBox[{"Length", "[", "vardot", "]"}]}], "}"}]}], "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{"Monitor", "[", 
  RowBox[{
   RowBox[{
    RowBox[{"eqDep", "=", 
     RowBox[{"Table", "[", 
      RowBox[{
       RowBox[{
        RowBox[{"compvp1", "\[Equal]", "0"}], "/.", "dot2num"}], ",", 
       RowBox[{"{", 
        RowBox[{"ii", ",", 
         RowBox[{"10", "+", 
          RowBox[{"Length", "[", "cvars", "]"}]}]}], "}"}]}], "]"}]}], ";"}], 
   ",", "ii"}], "]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"solsvp1", "=", 
   RowBox[{
    RowBox[{"Solve", "[", 
     RowBox[{"eqDep", ",", "cvars"}], "]"}], "[", 
    RowBox[{"[", "1", "]"}], "]"}]}], ";"}]}], "Input",
 CellChangeTimes->{{3.878078221639757*^9, 3.878078240954069*^9}, {
  3.878081064658252*^9, 3.8780810690042477`*^9}},
 CellLabel->
  "In[210]:=",ExpressionUUID->"b8fa77cc-1b35-4922-9129-b08f865e4e9e"],

Cell[BoxData[
 TemplateBox[{
  "Solve", "svars", 
   "\"Equations may not give solutions for all \\\"solve\\\" variables.\"", 2,
    212, 2, 28415626182954115862, "Local"},
  "MessageTemplate"]], "Message", "MSG",
 CellChangeTimes->{3.878078269494465*^9, 3.878078742583606*^9, 
  3.878078899618535*^9, 3.878079253865985*^9, 3.878079430819562*^9, 
  3.878080637128373*^9, 3.8780808095370073`*^9, 3.878081098149448*^9, 
  3.878081136137045*^9, 3.8780819450782824`*^9, 3.8780820048796787`*^9, 
  3.878082047763628*^9, 3.878082109462324*^9, 3.878082376640708*^9, 
  3.878084831921735*^9, 3.878085522082589*^9, 3.878093683954672*^9, 
  3.878096061390531*^9, 3.8786164202462797`*^9, 3.878857178764801*^9},
 CellLabel->
  "During evaluation of \
In[210]:=",ExpressionUUID->"d7a672e6-587f-4dff-8d93-f8c82dee6682"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData["solsvp1"], "Input",
 CellLabel->
  "In[213]:=",ExpressionUUID->"c8e08eb4-3b1b-41d6-9bea-cd47cdf8746d"],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
   RowBox[{
    RowBox[{"c", "[", "0", "]"}], "\[Rule]", 
    RowBox[{"-", "1"}]}], ",", 
   RowBox[{
    RowBox[{"c", "[", 
     RowBox[{"1", ",", "18"}], "]"}], "\[Rule]", "0"}], ",", 
   RowBox[{
    RowBox[{"c", "[", 
     RowBox[{"1", ",", "23"}], "]"}], "\[Rule]", 
    RowBox[{"c", "[", 
     RowBox[{"1", ",", "14"}], "]"}]}], ",", 
   RowBox[{
    RowBox[{"c", "[", 
     RowBox[{"1", ",", "27"}], "]"}], "\[Rule]", 
    RowBox[{
     RowBox[{"c", "[", 
      RowBox[{"1", ",", "13"}], "]"}], "-", 
     RowBox[{"c", "[", 
      RowBox[{"1", ",", "26"}], "]"}]}]}], ",", 
   RowBox[{
    RowBox[{"c", "[", 
     RowBox[{"1", ",", "30"}], "]"}], "\[Rule]", 
    RowBox[{
     RowBox[{"c", "[", 
      RowBox[{"1", ",", "11"}], "]"}], "+", 
     RowBox[{"c", "[", 
      RowBox[{"1", ",", "12"}], "]"}], "+", 
     RowBox[{"c", "[", 
      RowBox[{"1", ",", "16"}], "]"}], "-", 
     RowBox[{"c", "[", 
      RowBox[{"1", ",", "24"}], "]"}], "-", 
     RowBox[{"c", "[", 
      RowBox[{"1", ",", "25"}], "]"}], "-", 
     RowBox[{"c", "[", 
      RowBox[{"1", ",", "29"}], "]"}]}]}], ",", 
   RowBox[{
    RowBox[{"c", "[", 
     RowBox[{"1", ",", "64"}], "]"}], "\[Rule]", 
    RowBox[{
     RowBox[{"-", 
      FractionBox["1", "2"]}], "+", 
     FractionBox[
      RowBox[{"c", "[", "1", "]"}], "2"], "+", 
     RowBox[{"c", "[", 
      RowBox[{"1", ",", "7"}], "]"}]}]}], ",", 
   RowBox[{
    RowBox[{"c", "[", 
     RowBox[{"1", ",", "305"}], "]"}], "\[Rule]", 
    RowBox[{
     RowBox[{"-", 
      RowBox[{"c", "[", 
       RowBox[{"1", ",", "138"}], "]"}]}], "+", 
     RowBox[{"c", "[", 
      RowBox[{"1", ",", "219"}], "]"}], "+", 
     RowBox[{"c", "[", 
      RowBox[{"1", ",", "298"}], "]"}]}]}], ",", 
   RowBox[{
    RowBox[{"c", "[", 
     RowBox[{"1", ",", "313"}], "]"}], "\[Rule]", 
    RowBox[{
     RowBox[{"-", 
      RowBox[{"c", "[", 
       RowBox[{"1", ",", "50"}], "]"}]}], "+", 
     RowBox[{"c", "[", 
      RowBox[{"1", ",", "54"}], "]"}], "+", 
     RowBox[{"c", "[", 
      RowBox[{"1", ",", "70"}], "]"}], "-", 
     RowBox[{"c", "[", 
      RowBox[{"1", ",", "74"}], "]"}], "-", 
     RowBox[{"c", "[", 
      RowBox[{"1", ",", "108"}], "]"}], "-", 
     RowBox[{"c", "[", 
      RowBox[{"1", ",", "125"}], "]"}], "-", 
     RowBox[{"c", "[", 
      RowBox[{"1", ",", "126"}], "]"}], "-", 
     RowBox[{"c", "[", 
      RowBox[{"1", ",", "188"}], "]"}], "+", 
     RowBox[{"c", "[", 
      RowBox[{"1", ",", "212"}], "]"}], "+", 
     RowBox[{"c", "[", 
      RowBox[{"1", ",", "225"}], "]"}], "-", 
     RowBox[{"c", "[", 
      RowBox[{"1", ",", "227"}], "]"}], "+", 
     RowBox[{"c", "[", 
      RowBox[{"1", ",", "237"}], "]"}], "+", 
     RowBox[{"c", "[", 
      RowBox[{"1", ",", "252"}], "]"}], "-", 
     RowBox[{"c", "[", 
      RowBox[{"1", ",", "262"}], "]"}], "+", 
     RowBox[{"c", "[", 
      RowBox[{"1", ",", "299"}], "]"}], "+", 
     RowBox[{"c", "[", 
      RowBox[{"1", ",", "300"}], "]"}], "-", 
     RowBox[{"c", "[", 
      RowBox[{"1", ",", "312"}], "]"}]}]}], ",", 
   RowBox[{
    RowBox[{"c", "[", 
     RowBox[{"1", ",", "315"}], "]"}], "\[Rule]", 
    RowBox[{
     RowBox[{"-", 
      RowBox[{"c", "[", 
       RowBox[{"1", ",", "48"}], "]"}]}], "+", 
     RowBox[{"c", "[", 
      RowBox[{"1", ",", "60"}], "]"}], "-", 
     RowBox[{"c", "[", 
      RowBox[{"1", ",", "63"}], "]"}], "-", 
     RowBox[{"c", "[", 
      RowBox[{"1", ",", "65"}], "]"}], "+", 
     RowBox[{"c", "[", 
      RowBox[{"1", ",", "68"}], "]"}], "-", 
     RowBox[{"c", "[", 
      RowBox[{"1", ",", "80"}], "]"}], "+", 
     RowBox[{"c", "[", 
      RowBox[{"1", ",", "82"}], "]"}], "+", 
     RowBox[{"c", "[", 
      RowBox[{"1", ",", "84"}], "]"}], "+", 
     RowBox[{"c", "[", 
      RowBox[{"1", ",", "110"}], "]"}], "-", 
     RowBox[{"c", "[", 
      RowBox[{"1", ",", "127"}], "]"}], "-", 
     RowBox[{"c", "[", 
      RowBox[{"1", ",", "128"}], "]"}], "-", 
     RowBox[{"c", "[", 
      RowBox[{"1", ",", "185"}], "]"}], "+", 
     RowBox[{"c", "[", 
      RowBox[{"1", ",", "214"}], "]"}], "+", 
     RowBox[{"c", "[", 
      RowBox[{"1", ",", "223"}], "]"}], "-", 
     RowBox[{"c", "[", 
      RowBox[{"1", ",", "229"}], "]"}], "+", 
     RowBox[{"c", "[", 
      RowBox[{"1", ",", "233"}], "]"}], "+", 
     RowBox[{"c", "[", 
      RowBox[{"1", ",", "254"}], "]"}], "-", 
     RowBox[{"c", "[", 
      RowBox[{"1", ",", "258"}], "]"}], "+", 
     RowBox[{"c", "[", 
      RowBox[{"1", ",", "301"}], "]"}], "+", 
     RowBox[{"c", "[", 
      RowBox[{"1", ",", "302"}], "]"}], "-", 
     RowBox[{"c", "[", 
      RowBox[{"1", ",", "314"}], "]"}]}]}], ",", 
   RowBox[{
    RowBox[{"c", "[", 
     RowBox[{"1", ",", "317"}], "]"}], "\[Rule]", 
    RowBox[{"1", "-", 
     RowBox[{"c", "[", 
      RowBox[{"1", ",", "37"}], "]"}], "-", 
     RowBox[{"c", "[", 
      RowBox[{"1", ",", "43"}], "]"}], "-", 
     RowBox[{"c", "[", 
      RowBox[{"1", ",", "47"}], "]"}], "-", 
     RowBox[{"c", "[", 
      RowBox[{"1", ",", "49"}], "]"}], "+", 
     RowBox[{"c", "[", 
      RowBox[{"1", ",", "67"}], "]"}], "+", 
     RowBox[{"c", "[", 
      RowBox[{"1", ",", "69"}], "]"}], "+", 
     RowBox[{"c", "[", 
      RowBox[{"1", ",", "129"}], "]"}], "-", 
     RowBox[{"c", "[", 
      RowBox[{"1", ",", "136"}], "]"}], "+", 
     RowBox[{"c", "[", 
      RowBox[{"1", ",", "217"}], "]"}], "+", 
     RowBox[{"c", "[", 
      RowBox[{"1", ",", "218"}], "]"}], "+", 
     RowBox[{"c", "[", 
      RowBox[{"1", ",", "222"}], "]"}], "+", 
     RowBox[{"c", "[", 
      RowBox[{"1", ",", "224"}], "]"}], "+", 
     RowBox[{"c", "[", 
      RowBox[{"1", ",", "303"}], "]"}], "+", 
     RowBox[{"c", "[", 
      RowBox[{"1", ",", "304"}], "]"}], "-", 
     RowBox[{"c", "[", 
      RowBox[{"1", ",", "316"}], "]"}]}]}], ",", 
   RowBox[{
    RowBox[{"c", "[", 
     RowBox[{"2", ",", "11"}], "]"}], "\[Rule]", 
    RowBox[{"c", "[", 
     RowBox[{"1", ",", "11"}], "]"}]}], ",", 
   RowBox[{
    RowBox[{"c", "[", 
     RowBox[{"2", ",", "13"}], "]"}], "\[Rule]", 
    RowBox[{"c", "[", 
     RowBox[{"1", ",", "13"}], "]"}]}], ",", 
   RowBox[{
    RowBox[{"c", "[", 
     RowBox[{"2", ",", "16"}], "]"}], "\[Rule]", 
    RowBox[{
     RowBox[{"c", "[", 
      RowBox[{"1", ",", "12"}], "]"}], "+", 
     RowBox[{"c", "[", 
      RowBox[{"1", ",", "16"}], "]"}], "-", 
     RowBox[{"c", "[", 
      RowBox[{"2", ",", "12"}], "]"}]}]}], ",", 
   RowBox[{
    RowBox[{"c", "[", 
     RowBox[{"2", ",", "299"}], "]"}], "\[Rule]", 
    RowBox[{
     RowBox[{"-", 
      RowBox[{"c", "[", 
       RowBox[{"1", ",", "125"}], "]"}]}], "+", 
     RowBox[{"c", "[", 
      RowBox[{"1", ",", "299"}], "]"}], "+", 
     RowBox[{"c", "[", 
      RowBox[{"2", ",", "125"}], "]"}]}]}], ",", 
   RowBox[{
    RowBox[{"c", "[", 
     RowBox[{"2", ",", "300"}], "]"}], "\[Rule]", 
    RowBox[{
     RowBox[{"-", 
      RowBox[{"c", "[", 
       RowBox[{"1", ",", "50"}], "]"}]}], "+", 
     RowBox[{"c", "[", 
      RowBox[{"1", ",", "54"}], "]"}], "+", 
     RowBox[{"c", "[", 
      RowBox[{"1", ",", "70"}], "]"}], "-", 
     RowBox[{"c", "[", 
      RowBox[{"1", ",", "74"}], "]"}], "-", 
     RowBox[{"c", "[", 
      RowBox[{"1", ",", "126"}], "]"}], "+", 
     RowBox[{"c", "[", 
      RowBox[{"1", ",", "300"}], "]"}], "-", 
     RowBox[{"c", "[", 
      RowBox[{"2", ",", "108"}], "]"}], "+", 
     RowBox[{"c", "[", 
      RowBox[{"2", ",", "133"}], "]"}], "-", 
     RowBox[{"c", "[", 
      RowBox[{"2", ",", "142"}], "]"}], "+", 
     RowBox[{"c", "[", 
      RowBox[{"2", ",", "153"}], "]"}], "+", 
     RowBox[{"c", "[", 
      RowBox[{"2", ",", "191"}], "]"}], "-", 
     RowBox[{"c", "[", 
      RowBox[{"2", ",", "202"}], "]"}], "-", 
     RowBox[{"c", "[", 
      RowBox[{"2", ",", "244"}], "]"}]}]}], ",", 
   RowBox[{
    RowBox[{"c", "[", 
     RowBox[{"2", ",", "301"}], "]"}], "\[Rule]", 
    RowBox[{
     RowBox[{"-", 
      RowBox[{"c", "[", 
       RowBox[{"1", ",", "63"}], "]"}]}], "-", 
     RowBox[{"c", "[", 
      RowBox[{"1", ",", "65"}], "]"}], "-", 
     RowBox[{"c", "[", 
      RowBox[{"1", ",", "127"}], "]"}], "+", 
     RowBox[{"c", "[", 
      RowBox[{"1", ",", "301"}], "]"}], "+", 
     RowBox[{"c", "[", 
      RowBox[{"2", ",", "63"}], "]"}], "+", 
     RowBox[{"c", "[", 
      RowBox[{"2", ",", "65"}], "]"}], "+", 
     RowBox[{"c", "[", 
      RowBox[{"2", ",", "127"}], "]"}]}]}], ",", 
   RowBox[{
    RowBox[{"c", "[", 
     RowBox[{"2", ",", "302"}], "]"}], "\[Rule]", 
    RowBox[{
     RowBox[{"-", 
      RowBox[{"c", "[", 
       RowBox[{"1", ",", "48"}], "]"}]}], "+", 
     RowBox[{"c", "[", 
      RowBox[{"1", ",", "60"}], "]"}], "+", 
     RowBox[{"c", "[", 
      RowBox[{"1", ",", "68"}], "]"}], "-", 
     RowBox[{"c", "[", 
      RowBox[{"1", ",", "80"}], "]"}], "-", 
     RowBox[{"c", "[", 
      RowBox[{"1", ",", "128"}], "]"}], "+", 
     RowBox[{"c", "[", 
      RowBox[{"1", ",", "302"}], "]"}], "+", 
     RowBox[{"c", "[", 
      RowBox[{"2", ",", "109"}], "]"}], "+", 
     RowBox[{"c", "[", 
      RowBox[{"2", ",", "131"}], "]"}], "-", 
     RowBox[{"c", "[", 
      RowBox[{"2", ",", "144"}], "]"}], "+", 
     RowBox[{"c", "[", 
      RowBox[{"2", ",", "147"}], "]"}], "+", 
     RowBox[{"c", "[", 
      RowBox[{"2", ",", "193"}], "]"}], "-", 
     RowBox[{"c", "[", 
      RowBox[{"2", ",", "196"}], "]"}], "-", 
     RowBox[{"c", "[", 
      RowBox[{"2", ",", "249"}], "]"}]}]}], ",", 
   RowBox[{
    RowBox[{"c", "[", 
     RowBox[{"2", ",", "303"}], "]"}], "\[Rule]", 
    RowBox[{
     RowBox[{"-", 
      RowBox[{"c", "[", 
       RowBox[{"1", ",", "37"}], "]"}]}], "-", 
     RowBox[{"c", "[", 
      RowBox[{"1", ",", "47"}], "]"}], "+", 
     RowBox[{"c", "[", 
      RowBox[{"1", ",", "67"}], "]"}], "+", 
     RowBox[{"c", "[", 
      RowBox[{"1", ",", "129"}], "]"}], "+", 
     RowBox[{"c", "[", 
      RowBox[{"1", ",", "303"}], "]"}], "+", 
     RowBox[{"c", "[", 
      RowBox[{"2", ",", "130"}], "]"}]}]}], ",", 
   RowBox[{
    RowBox[{"c", "[", 
     RowBox[{"2", ",", "304"}], "]"}], "\[Rule]", 
    RowBox[{"1", "-", 
     RowBox[{"c", "[", 
      RowBox[{"1", ",", "43"}], "]"}], "-", 
     RowBox[{"c", "[", 
      RowBox[{"1", ",", "49"}], "]"}], "+", 
     RowBox[{"c", "[", 
      RowBox[{"1", ",", "69"}], "]"}], "-", 
     RowBox[{"c", "[", 
      RowBox[{"1", ",", "136"}], "]"}], "+", 
     RowBox[{"c", "[", 
      RowBox[{"1", ",", "304"}], "]"}], "+", 
     RowBox[{"c", "[", 
      RowBox[{"2", ",", "132"}], "]"}], "+", 
     RowBox[{"c", "[", 
      RowBox[{"2", ",", "136"}], "]"}], "+", 
     RowBox[{"c", "[", 
      RowBox[{"2", ",", "137"}], "]"}]}]}]}], "}"}]], "Output",
 CellChangeTimes->{3.878093691306862*^9, 3.878096061413385*^9, 
  3.8786164202786903`*^9, 3.878857178787333*^9},
 CellLabel->
  "Out[213]=",ExpressionUUID->"4638601d-5ba1-44af-98b7-32c8d3d7ad60"]
}, Open  ]]
}, Open  ]],

Cell[CellGroupData[{

Cell["Factorisation condition v.p2", "Subsection",
 CellChangeTimes->{{3.878076748965989*^9, 3.878076767862722*^9}, {
  3.878093747799068*^9, 
  3.8780937495889473`*^9}},ExpressionUUID->"0dc6dbc1-eeb3-4f11-b2bc-\
668fae0eba77"],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{
  RowBox[{"numAnsatz3", "=", 
   RowBox[{
    RowBox[{
     RowBox[{
      RowBox[{
       RowBox[{"(", "numAnsatz2", ")"}], "//.", "dotRules"}], "/.", 
      RowBox[{"(", 
       RowBox[{
        RowBox[{"vonshell", "[", 
         RowBox[{
          RowBox[{"n", "-", "1"}], ",", "3"}], "]"}], "/.", 
        RowBox[{"v", "->", 
         RowBox[{"v", "[", "1", "]"}]}]}], ")"}]}], "/.", "solsvp1"}], "//", 
    "Expand"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{"%", "//", "Length"}]}], "Input",
 CellChangeTimes->{{3.878076776346158*^9, 3.878076791822427*^9}, {
   3.878076863747164*^9, 3.8780768651784353`*^9}, {3.878077446334421*^9, 
   3.878077450450157*^9}, 3.878080568874198*^9, 3.878080843522138*^9, {
   3.878084931218405*^9, 3.8780849369136047`*^9}, {3.878085107286035*^9, 
   3.878085112014679*^9}, {3.8780852927862673`*^9, 3.878085294285921*^9}, {
   3.8780937634764643`*^9, 3.8780937712084923`*^9}, {3.878094578752013*^9, 
   3.87809458003332*^9}},
 CellLabel->
  "In[214]:=",ExpressionUUID->"30f56ef6-5b13-4baa-b8bf-15b7090ac3f7"],

Cell[BoxData["7321"], "Output",
 CellChangeTimes->{{3.87807677960294*^9, 3.878076792387086*^9}, 
   3.878076869394702*^9, 3.878077463656658*^9, 3.878080582971023*^9, 
   3.878081061748372*^9, 3.878084951014349*^9, 3.878085126532173*^9, 
   3.878085312641127*^9, 3.878093665706396*^9, 3.878094602309922*^9, 
   3.8780960624008083`*^9, 3.878616420791914*^9, 3.8788571792899027`*^9},
 CellLabel->
  "Out[215]=",ExpressionUUID->"bbe98b85-dbc8-4c03-901e-1356d250b7d2"]
}, Open  ]],

Cell[BoxData[
 RowBox[{
  RowBox[{"numAnsatzvp1", "=", 
   RowBox[{
    RowBox[{
     RowBox[{
      RowBox[{"(", 
       RowBox[{
        RowBox[{
         RowBox[{"(", 
          RowBox[{"numAnsatz3", "//", 
           RowBox[{"Cases", "[", 
            RowBox[{"Times", "[", 
             RowBox[{"f___", ",", 
              RowBox[{"Power", "[", 
               RowBox[{
                RowBox[{"dot", "[", 
                 RowBox[{
                  RowBox[{"p", "[", "2", "]"}], ",", 
                  RowBox[{"v", "[", "1", "]"}]}], "]"}], ",", 
                RowBox[{"-", "1"}]}], "]"}], ",", "g___"}], "]"}], "]"}]}], 
          ")"}], "/.", 
         RowBox[{
          RowBox[{"Power", "[", 
           RowBox[{
            RowBox[{"dot", "[", 
             RowBox[{
              RowBox[{"p", "[", "2", "]"}], ",", 
              RowBox[{"v", "[", "1", "]"}]}], "]"}], ",", 
            RowBox[{"-", "1"}]}], "]"}], "->", "1"}]}], "//", "Total"}], 
       ")"}], "//.", "dotRules"}], "/.", "vponshell"}], "/.", 
    RowBox[{"{", 
     RowBox[{
      RowBox[{
       RowBox[{"dot", "[", 
        RowBox[{
         RowBox[{"p", "[", "2", "]"}], ",", 
         RowBox[{"v", "[", "1", "]"}]}], "]"}], "->", "0"}], ",", 
      RowBox[{
       RowBox[{"dot", "[", 
        RowBox[{
         RowBox[{"p", "[", "3", "]"}], ",", 
         RowBox[{"v", "[", "1", "]"}]}], "]"}], "->", 
       RowBox[{"-", 
        RowBox[{"dot", "[", 
         RowBox[{
          RowBox[{"p", "[", "1", "]"}], ",", 
          RowBox[{"v", "[", "1", "]"}]}], "]"}]}]}]}], "}"}]}]}], 
  ";"}]], "Input",
 CellChangeTimes->{{3.878077052129978*^9, 3.878077125591745*^9}, {
   3.878077237157652*^9, 3.878077281353335*^9}, {3.8780773702267103`*^9, 
   3.8780774435353603`*^9}, {3.8780774739935207`*^9, 3.8780775017717133`*^9}, 
   3.878079930873101*^9, 3.878079973240665*^9, {3.878085415182927*^9, 
   3.8780854153236303`*^9}, 3.878085446328352*^9, {3.878094648731681*^9, 
   3.878094651846068*^9}, {3.878094696417069*^9, 3.878094712612356*^9}},
 CellLabel->
  "In[216]:=",ExpressionUUID->"7e4c037d-b2c8-4b94-a37c-c87c5346d37a"],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"numAnsatzvp1", "//", "Length"}]], "Input",
 CellChangeTimes->{{3.878085457345728*^9, 3.878085458484248*^9}},
 CellLabel->
  "In[217]:=",ExpressionUUID->"59f786bb-5094-42ab-b9d0-362b1e405323"],

Cell[BoxData["1048"], "Output",
 CellChangeTimes->{{3.878085424115284*^9, 3.8780854589677*^9}, 
   3.878093671135722*^9, 3.878094722221806*^9, 3.878096062738055*^9, 
   3.878616421119174*^9, 3.878857179614334*^9},
 CellLabel->
  "Out[217]=",ExpressionUUID->"932efddf-6219-48d2-b4a4-20428196c417"]
}, Open  ]],

Cell[BoxData[{
 RowBox[{
  RowBox[{"num1", "=", 
   RowBox[{
    RowBox[{
     RowBox[{"T", "[", 
      RowBox[{"{", "2", "}"}], "]"}], "/.", 
     RowBox[{"T", "->", "T2F"}]}], "/.", 
    RowBox[{"v", "->", 
     RowBox[{"v", "[", "1", "]"}]}]}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"num2", "=", 
   RowBox[{"(", 
    RowBox[{
     FractionBox[
      RowBox[{"dot", "[", 
       RowBox[{
        RowBox[{"p", "[", "1", "]"}], ",", 
        RowBox[{"S", "[", "0", "]"}], ",", 
        RowBox[{"F", "[", "1", "]"}], ",", 
        RowBox[{"F", "[", "3", "]"}], ",", 
        RowBox[{"v", "[", "1", "]"}]}], "]"}], 
      RowBox[{"dot", "[", 
       RowBox[{
        RowBox[{"p", "[", "1", "]"}], ",", 
        RowBox[{"v", "[", "1", "]"}]}], "]"}]], "+", 
     FractionBox[
      RowBox[{"dot", "[", 
       RowBox[{
        RowBox[{"p", "[", "1", "]"}], ",", 
        RowBox[{"S", "[", "0", "]"}], ",", 
        RowBox[{"F", "[", "3", "]"}], ",", 
        RowBox[{"F", "[", "1", "]"}], ",", 
        RowBox[{"v", "[", "1", "]"}]}], "]"}], 
      RowBox[{"dot", "[", 
       RowBox[{
        RowBox[{"p", "[", "1", "]"}], ",", 
        RowBox[{"v", "[", "1", "]"}]}], "]"}]], "-", 
     FractionBox[
      RowBox[{"dot", "[", 
       RowBox[{
        RowBox[{"p", "[", "1", "]"}], ",", 
        RowBox[{"F", "[", "3", "]"}], ",", 
        RowBox[{"S", "[", "0", "]"}], ",", 
        RowBox[{"F", "[", "1", "]"}], ",", 
        RowBox[{"v", "[", "1", "]"}]}], "]"}], 
      RowBox[{"dot", "[", 
       RowBox[{
        RowBox[{"p", "[", "1", "]"}], ",", 
        RowBox[{"v", "[", "1", "]"}]}], "]"}]], "+", 
     FractionBox[
      RowBox[{"dot", "[", 
       RowBox[{
        RowBox[{"p", "[", "3", "]"}], ",", 
        RowBox[{"S", "[", "0", "]"}], ",", 
        RowBox[{"F", "[", "3", "]"}], ",", 
        RowBox[{"F", "[", "1", "]"}], ",", 
        RowBox[{"v", "[", "1", "]"}]}], "]"}], 
      RowBox[{"dot", "[", 
       RowBox[{
        RowBox[{"p", "[", "1", "]"}], ",", 
        RowBox[{"v", "[", "1", "]"}]}], "]"}]]}], ")"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"numvp1", "=", 
   RowBox[{
    RowBox[{
     RowBox[{
      RowBox[{
       RowBox[{"dot", "[", 
        RowBox[{
         RowBox[{"p", "[", "1", "]"}], ",", 
         RowBox[{"p", "[", "2", "]"}]}], "]"}], 
       RowBox[{"(", 
        RowBox[{
         RowBox[{
          RowBox[{"c", "[", "2", "]"}], "num1", "*", "num2"}], "+", 
         RowBox[{
          FractionBox["1", 
           RowBox[{"dot", "[", 
            RowBox[{
             RowBox[{"p", "[", "1", "]"}], ",", 
             RowBox[{"v", "[", "1", "]"}]}], "]"}]], 
          RowBox[{"c", "[", "3", "]"}], 
          RowBox[{"dot", "[", 
           RowBox[{
            RowBox[{"p", "[", "2", "]"}], ",", 
            RowBox[{"S", "[", "0", "]"}], ",", 
            RowBox[{"\[Epsilon]", "[", "2", "]"}]}], "]"}], "*", 
          RowBox[{"dot", "[", 
           RowBox[{
            RowBox[{"v", "[", "1", "]"}], ",", 
            RowBox[{"F", "[", "1", "]"}], ",", 
            RowBox[{"F", "[", "3", "]"}], ",", 
            RowBox[{"v", "[", "1", "]"}]}], "]"}]}]}], ")"}]}], "//.", 
      "dotRules"}], "//", "expandFS"}], "//", "Expand"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"numvp1", "=", 
   RowBox[{
    RowBox[{
     RowBox[{"numvp1", "//.", "dotRules"}], "/.", "vponshell"}], "/.", 
    RowBox[{"{", 
     RowBox[{
      RowBox[{
       RowBox[{"dot", "[", 
        RowBox[{
         RowBox[{"p", "[", "2", "]"}], ",", 
         RowBox[{"v", "[", "1", "]"}]}], "]"}], "->", "0"}], ",", 
      RowBox[{
       RowBox[{"dot", "[", 
        RowBox[{
         RowBox[{"p", "[", "3", "]"}], ",", 
         RowBox[{"v", "[", "1", "]"}]}], "]"}], "->", 
       RowBox[{"-", 
        RowBox[{"dot", "[", 
         RowBox[{
          RowBox[{"p", "[", "1", "]"}], ",", 
          RowBox[{"v", "[", "1", "]"}]}], "]"}]}]}]}], "}"}]}]}], 
  ";"}]}], "Input",
 CellChangeTimes->{{3.878077591985273*^9, 3.8780776461342783`*^9}, {
   3.878077953502172*^9, 3.878077980733405*^9}, {3.878078491930747*^9, 
   3.878078549563458*^9}, {3.878078580745262*^9, 3.87807865251903*^9}, 
   3.878078684800146*^9, {3.878079206140265*^9, 3.878079212664543*^9}, {
   3.878079938416065*^9, 3.8780799390210323`*^9}, {3.878079982854789*^9, 
   3.878079996138009*^9}, 3.878080718496252*^9, 3.878080776110016*^9, {
   3.878081116226698*^9, 3.8780811179219093`*^9}, {3.878081897887516*^9, 
   3.878081929737031*^9}, {3.8780819770250673`*^9, 3.8780819885274878`*^9}, 
   3.8780820357161922`*^9, {3.878082093586617*^9, 3.878082094494379*^9}, 
   3.878082200584118*^9, 3.8780823524734297`*^9, 3.8780843780876017`*^9, {
   3.87808451838385*^9, 3.878084553403726*^9}, {3.878084767872551*^9, 
   3.878084809993238*^9}, {3.878093413770879*^9, 3.878093418381057*^9}, 
   3.878094731163116*^9, {3.878094787760552*^9, 3.878094870939351*^9}, {
   3.878094944453622*^9, 3.878094946794712*^9}},
 CellLabel->
  "In[218]:=",ExpressionUUID->"015a8192-0e34-496c-b9e8-94d006b23504"],

Cell[BoxData[
 RowBox[{
  RowBox[{"compvp1", "=", 
   RowBox[{"numAnsatzvp1", "-", "numvp1"}]}], ";"}]], "Input",
 CellChangeTimes->{{3.8780781147500143`*^9, 3.878078179889933*^9}, {
   3.878078714167301*^9, 3.878078719908218*^9}, {3.878078864983605*^9, 
   3.8780788894932623`*^9}, 3.878079927920136*^9, 3.87808000213634*^9},
 CellLabel->
  "In[222]:=",ExpressionUUID->"a6114a56-cddf-4bbf-96d0-7d324e0ac67b"],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  RowBox[{"4", " ", 
   RowBox[{
    SubscriptBox["p", "1"], "\[CenterDot]", "S", "\[CenterDot]", 
    SubscriptBox["F", "1"], "\[CenterDot]", 
    SubscriptBox["F", "2"], "\[CenterDot]", "v"}]}], "+", 
  RowBox[{"4", 
   RowBox[{
    SubscriptBox["p", "1"], "\[CenterDot]", "S", "\[CenterDot]", 
    SubscriptBox["F", "2"], "\[CenterDot]", 
    SubscriptBox["F", "1"], "\[CenterDot]", "v"}]}], "-", 
  RowBox[{"4", " ", 
   RowBox[{
    SubscriptBox["p", "1"], "\[CenterDot]", 
    SubscriptBox["F", "2"], "\[CenterDot]", "S", "\[CenterDot]", 
    SubscriptBox["F", "1"], "\[CenterDot]", "v"}]}], "+", 
  RowBox[{"4", " ", 
   RowBox[{
    SubscriptBox["p", "2"], "\[CenterDot]", "S", "\[CenterDot]", 
    SubscriptBox["F", "2"], "\[CenterDot]", 
    SubscriptBox["F", "1"], "\[CenterDot]", "v"}]}]}]], "Input",
 CellChangeTimes->{{3.878078468972107*^9, 3.8780784821254663`*^9}},
 CellLabel->
  "In[223]:=",ExpressionUUID->"7563fbcc-606e-49f5-ba0e-0582f8aa8a63"],

Cell[BoxData[
 RowBox[{
  RowBox[{"4", " ", 
   RowBox[{
    SubscriptBox["p", "1"], "\[CenterDot]", "S", "\[CenterDot]", 
    SubscriptBox["F", "1"], "\[CenterDot]", 
    SubscriptBox["F", "2"], "\[CenterDot]", "v"}]}], "+", 
  RowBox[{"4", " ", 
   RowBox[{
    SubscriptBox["p", "1"], "\[CenterDot]", "S", "\[CenterDot]", 
    SubscriptBox["F", "2"], "\[CenterDot]", 
    SubscriptBox["F", "1"], "\[CenterDot]", "v"}]}], "-", 
  RowBox[{"4", " ", 
   RowBox[{
    SubscriptBox["p", "1"], "\[CenterDot]", 
    SubscriptBox["F", "2"], "\[CenterDot]", "S", "\[CenterDot]", 
    SubscriptBox["F", "1"], "\[CenterDot]", "v"}]}], "+", 
  RowBox[{"4", " ", 
   RowBox[{
    SubscriptBox["p", "2"], "\[CenterDot]", "S", "\[CenterDot]", 
    SubscriptBox["F", "2"], "\[CenterDot]", 
    SubscriptBox["F", "1"], "\[CenterDot]", "v"}]}]}]], "Output",
 CellChangeTimes->{3.8780960628033333`*^9, 3.8786164211862707`*^9, 
  3.878857179682714*^9},
 CellLabel->
  "Out[223]=",ExpressionUUID->"8c2c2f8c-08bb-494e-9b2c-3fbbacd9dd59"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"compvp1", "//", "Casesdot"}]], "Input",
 CellChangeTimes->{{3.8780788203554583`*^9, 3.878078825352446*^9}},
 CellLabel->
  "In[224]:=",ExpressionUUID->"08cbae83-330d-4c78-afa6-d9025cba7d1c"],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
   RowBox[{"dot", "[", 
    RowBox[{
     RowBox[{"p", "[", "1", "]"}], ",", 
     RowBox[{"p", "[", "2", "]"}]}], "]"}], ",", 
   RowBox[{"dot", "[", 
    RowBox[{
     RowBox[{"p", "[", "1", "]"}], ",", 
     RowBox[{"p", "[", "3", "]"}]}], "]"}], ",", 
   RowBox[{"dot", "[", 
    RowBox[{
     RowBox[{"p", "[", "1", "]"}], ",", 
     RowBox[{"v", "[", "1", "]"}]}], "]"}], ",", 
   RowBox[{"dot", "[", 
    RowBox[{
     RowBox[{"p", "[", "1", "]"}], ",", 
     RowBox[{"\[Epsilon]", "[", "2", "]"}]}], "]"}], ",", 
   RowBox[{"dot", "[", 
    RowBox[{
     RowBox[{"p", "[", "1", "]"}], ",", 
     RowBox[{"\[Epsilon]", "[", "3", "]"}]}], "]"}], ",", 
   RowBox[{"dot", "[", 
    RowBox[{
     RowBox[{"p", "[", "2", "]"}], ",", 
     RowBox[{"p", "[", "3", "]"}]}], "]"}], ",", 
   RowBox[{"dot", "[", 
    RowBox[{
     RowBox[{"p", "[", "2", "]"}], ",", 
     RowBox[{"\[Epsilon]", "[", "1", "]"}]}], "]"}], ",", 
   RowBox[{"dot", "[", 
    RowBox[{
     RowBox[{"p", "[", "2", "]"}], ",", 
     RowBox[{"\[Epsilon]", "[", "3", "]"}]}], "]"}], ",", 
   RowBox[{"dot", "[", 
    RowBox[{
     RowBox[{"p", "[", "3", "]"}], ",", 
     RowBox[{"\[Epsilon]", "[", "1", "]"}]}], "]"}], ",", 
   RowBox[{"dot", "[", 
    RowBox[{
     RowBox[{"p", "[", "3", "]"}], ",", 
     RowBox[{"\[Epsilon]", "[", "2", "]"}]}], "]"}], ",", 
   RowBox[{"dot", "[", 
    RowBox[{
     RowBox[{"v", "[", "1", "]"}], ",", 
     RowBox[{"\[Epsilon]", "[", "1", "]"}]}], "]"}], ",", 
   RowBox[{"dot", "[", 
    RowBox[{
     RowBox[{"v", "[", "1", "]"}], ",", 
     RowBox[{"\[Epsilon]", "[", "2", "]"}]}], "]"}], ",", 
   RowBox[{"dot", "[", 
    RowBox[{
     RowBox[{"v", "[", "1", "]"}], ",", 
     RowBox[{"\[Epsilon]", "[", "3", "]"}]}], "]"}], ",", 
   RowBox[{"dot", "[", 
    RowBox[{
     RowBox[{"\[Epsilon]", "[", "1", "]"}], ",", 
     RowBox[{"\[Epsilon]", "[", "2", "]"}]}], "]"}], ",", 
   RowBox[{"dot", "[", 
    RowBox[{
     RowBox[{"\[Epsilon]", "[", "1", "]"}], ",", 
     RowBox[{"\[Epsilon]", "[", "3", "]"}]}], "]"}], ",", 
   RowBox[{"dot", "[", 
    RowBox[{
     RowBox[{"\[Epsilon]", "[", "2", "]"}], ",", 
     RowBox[{"\[Epsilon]", "[", "3", "]"}]}], "]"}], ",", 
   RowBox[{"dot", "[", 
    RowBox[{
     RowBox[{"p", "[", "1", "]"}], ",", 
     RowBox[{"S", "[", "0", "]"}], ",", 
     RowBox[{"p", "[", "2", "]"}]}], "]"}], ",", 
   RowBox[{"dot", "[", 
    RowBox[{
     RowBox[{"p", "[", "1", "]"}], ",", 
     RowBox[{"S", "[", "0", "]"}], ",", 
     RowBox[{"p", "[", "3", "]"}]}], "]"}], ",", 
   RowBox[{"dot", "[", 
    RowBox[{
     RowBox[{"p", "[", "1", "]"}], ",", 
     RowBox[{"S", "[", "0", "]"}], ",", 
     RowBox[{"\[Epsilon]", "[", "1", "]"}]}], "]"}], ",", 
   RowBox[{"dot", "[", 
    RowBox[{
     RowBox[{"p", "[", "1", "]"}], ",", 
     RowBox[{"S", "[", "0", "]"}], ",", 
     RowBox[{"\[Epsilon]", "[", "2", "]"}]}], "]"}], ",", 
   RowBox[{"dot", "[", 
    RowBox[{
     RowBox[{"p", "[", "1", "]"}], ",", 
     RowBox[{"S", "[", "0", "]"}], ",", 
     RowBox[{"\[Epsilon]", "[", "3", "]"}]}], "]"}], ",", 
   RowBox[{"dot", "[", 
    RowBox[{
     RowBox[{"p", "[", "2", "]"}], ",", 
     RowBox[{"S", "[", "0", "]"}], ",", 
     RowBox[{"p", "[", "3", "]"}]}], "]"}], ",", 
   RowBox[{"dot", "[", 
    RowBox[{
     RowBox[{"p", "[", "2", "]"}], ",", 
     RowBox[{"S", "[", "0", "]"}], ",", 
     RowBox[{"\[Epsilon]", "[", "1", "]"}]}], "]"}], ",", 
   RowBox[{"dot", "[", 
    RowBox[{
     RowBox[{"p", "[", "2", "]"}], ",", 
     RowBox[{"S", "[", "0", "]"}], ",", 
     RowBox[{"\[Epsilon]", "[", "2", "]"}]}], "]"}], ",", 
   RowBox[{"dot", "[", 
    RowBox[{
     RowBox[{"p", "[", "2", "]"}], ",", 
     RowBox[{"S", "[", "0", "]"}], ",", 
     RowBox[{"\[Epsilon]", "[", "3", "]"}]}], "]"}], ",", 
   RowBox[{"dot", "[", 
    RowBox[{
     RowBox[{"p", "[", "3", "]"}], ",", 
     RowBox[{"S", "[", "0", "]"}], ",", 
     RowBox[{"\[Epsilon]", "[", "1", "]"}]}], "]"}], ",", 
   RowBox[{"dot", "[", 
    RowBox[{
     RowBox[{"p", "[", "3", "]"}], ",", 
     RowBox[{"S", "[", "0", "]"}], ",", 
     RowBox[{"\[Epsilon]", "[", "2", "]"}]}], "]"}], ",", 
   RowBox[{"dot", "[", 
    RowBox[{
     RowBox[{"p", "[", "3", "]"}], ",", 
     RowBox[{"S", "[", "0", "]"}], ",", 
     RowBox[{"\[Epsilon]", "[", "3", "]"}]}], "]"}], ",", 
   RowBox[{"dot", "[", 
    RowBox[{
     RowBox[{"\[Epsilon]", "[", "1", "]"}], ",", 
     RowBox[{"S", "[", "0", "]"}], ",", 
     RowBox[{"\[Epsilon]", "[", "2", "]"}]}], "]"}], ",", 
   RowBox[{"dot", "[", 
    RowBox[{
     RowBox[{"\[Epsilon]", "[", "1", "]"}], ",", 
     RowBox[{"S", "[", "0", "]"}], ",", 
     RowBox[{"\[Epsilon]", "[", "3", "]"}]}], "]"}], ",", 
   RowBox[{"dot", "[", 
    RowBox[{
     RowBox[{"\[Epsilon]", "[", "2", "]"}], ",", 
     RowBox[{"S", "[", "0", "]"}], ",", 
     RowBox[{"\[Epsilon]", "[", "3", "]"}]}], "]"}]}], "}"}]], "Output",
 CellChangeTimes->{3.8780787909855328`*^9, 3.878078825754147*^9, 
  3.8780789139500523`*^9, 3.878079583885482*^9, 3.8780807366766977`*^9, 
  3.87808078442798*^9, 3.878095061451518*^9, 3.87809606280996*^9, 
  3.8786164211937637`*^9, 3.878857179690095*^9},
 CellLabel->
  "Out[224]=",ExpressionUUID->"ab057531-d2cc-4d40-9174-dbfaeddad6e7"]
}, Open  ]],

Cell[BoxData[{
 RowBox[{
  RowBox[{"cvars", "=", 
   RowBox[{
    RowBox[{"Cases", "[", 
     RowBox[{"compvp1", ",", 
      RowBox[{"c", "[", "__", "]"}], ",", 
      RowBox[{"{", 
       RowBox[{"0", ",", "\[Infinity]"}], "}"}]}], "]"}], "//", "Union"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"vardot", "=", 
   RowBox[{"compvp1", "//", "Casesdot"}]}], ";"}]}], "Input",
 CellChangeTimes->{{3.878078218083035*^9, 3.878078227195683*^9}},
 CellLabel->
  "In[225]:=",ExpressionUUID->"3660df7e-5e63-4b2d-a97d-18687b7e7e55"],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"cvars", "//", "Length"}]], "Input",
 CellChangeTimes->{{3.878078250405406*^9, 3.8780782515980988`*^9}, 
   3.8780793030421352`*^9, {3.878080618122617*^9, 3.878080619511405*^9}},
 CellLabel->
  "In[227]:=",ExpressionUUID->"fa8ba1fd-a186-49cc-9bf9-aa75c0ff688a"],

Cell[BoxData["61"], "Output",
 CellChangeTimes->{
  3.878078252063862*^9, 3.878078732430634*^9, {3.8780792683050127`*^9, 
   3.878079303531766*^9}, {3.8780806116761723`*^9, 3.878080620497012*^9}, 
   3.878080793272333*^9, 3.8780810935750732`*^9, 3.8780811318686132`*^9, 
   3.878081941084124*^9, 3.8780820011325197`*^9, 3.878082120982493*^9, 
   3.878084828486793*^9, 3.878085517830093*^9, 3.878093680935251*^9, 
   3.878095084936636*^9, 3.878096062833789*^9, 3.878616421214686*^9, 
   3.878857179707473*^9},
 CellLabel->
  "Out[227]=",ExpressionUUID->"831de0d1-dda7-4ca1-86c6-0c4c057b8e28"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{
  RowBox[{"dot2num", ":=", 
   RowBox[{"Table", "[", 
    RowBox[{
     RowBox[{"Rule", "[", 
      RowBox[{
       RowBox[{"vardot", "[", 
        RowBox[{"[", "ii", "]"}], "]"}], ",", 
       RowBox[{"RandomInteger", "[", 
        RowBox[{"{", 
         RowBox[{"10", ",", "100"}], "}"}], "]"}]}], "]"}], ",", 
     RowBox[{"{", 
      RowBox[{"ii", ",", 
       RowBox[{"Length", "[", "vardot", "]"}]}], "}"}]}], "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{"Monitor", "[", 
  RowBox[{
   RowBox[{
    RowBox[{"eqDep", "=", 
     RowBox[{"Table", "[", 
      RowBox[{
       RowBox[{
        RowBox[{"compvp1", "\[Equal]", "0"}], "/.", "dot2num"}], ",", 
       RowBox[{"{", 
        RowBox[{"ii", ",", 
         RowBox[{"10", "+", 
          RowBox[{"Length", "[", "cvars", "]"}]}]}], "}"}]}], "]"}]}], ";"}], 
   ",", "ii"}], "]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"solsvp2", "=", 
   RowBox[{
    RowBox[{"Solve", "[", 
     RowBox[{"eqDep", ",", "cvars"}], "]"}], "[", 
    RowBox[{"[", "1", "]"}], "]"}]}], ";"}]}], "Input",
 CellChangeTimes->{{3.878078221639757*^9, 3.878078240954069*^9}, {
  3.878081064658252*^9, 3.8780810690042477`*^9}, {3.878095748981908*^9, 
  3.878095749098365*^9}},
 CellLabel->
  "In[228]:=",ExpressionUUID->"05540f17-9558-47af-a39a-04f87039a3ef"],

Cell[BoxData[
 TemplateBox[{
  "Solve", "svars", 
   "\"Equations may not give solutions for all \\\"solve\\\" variables.\"", 2,
    230, 3, 28415626182954115862, "Local"},
  "MessageTemplate"]], "Message", "MSG",
 CellChangeTimes->{3.878078269494465*^9, 3.878078742583606*^9, 
  3.878078899618535*^9, 3.878079253865985*^9, 3.878079430819562*^9, 
  3.878080637128373*^9, 3.8780808095370073`*^9, 3.878081098149448*^9, 
  3.878081136137045*^9, 3.8780819450782824`*^9, 3.8780820048796787`*^9, 
  3.878082047763628*^9, 3.878082109462324*^9, 3.878082376640708*^9, 
  3.878084831921735*^9, 3.878085522082589*^9, 3.878093683954672*^9, 
  3.8780951097061853`*^9, 3.8780960633261843`*^9, 3.878616421715082*^9, 
  3.878857180198904*^9},
 CellLabel->
  "During evaluation of \
In[228]:=",ExpressionUUID->"02857257-587c-4da7-9173-24f0c2559178"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData["solsvp2"], "Input",
 CellLabel->
  "In[231]:=",ExpressionUUID->"d5ee2776-4386-4864-a97b-c3438dc9d059"],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
   RowBox[{
    RowBox[{"c", "[", "1", "]"}], "\[Rule]", 
    RowBox[{"-", "1"}]}], ",", 
   RowBox[{
    RowBox[{"c", "[", "2", "]"}], "\[Rule]", "1"}], ",", 
   RowBox[{
    RowBox[{"c", "[", "3", "]"}], "\[Rule]", "1"}], ",", 
   RowBox[{
    RowBox[{"c", "[", 
     RowBox[{"1", ",", "11"}], "]"}], "\[Rule]", "0"}], ",", 
   RowBox[{
    RowBox[{"c", "[", 
     RowBox[{"1", ",", "13"}], "]"}], "\[Rule]", "0"}], ",", 
   RowBox[{
    RowBox[{"c", "[", 
     RowBox[{"1", ",", "14"}], "]"}], "\[Rule]", "0"}], ",", 
   RowBox[{
    RowBox[{"c", "[", 
     RowBox[{"1", ",", "16"}], "]"}], "\[Rule]", 
    RowBox[{"-", 
     RowBox[{"c", "[", 
      RowBox[{"1", ",", "12"}], "]"}]}]}], ",", 
   RowBox[{
    RowBox[{"c", "[", 
     RowBox[{"1", ",", "29"}], "]"}], "\[Rule]", 
    RowBox[{
     RowBox[{"-", 
      RowBox[{"c", "[", 
       RowBox[{"1", ",", "24"}], "]"}]}], "-", 
     RowBox[{"c", "[", 
      RowBox[{"1", ",", "25"}], "]"}]}]}], ",", 
   RowBox[{
    RowBox[{"c", "[", 
     RowBox[{"1", ",", "298"}], "]"}], "\[Rule]", 
    RowBox[{"1", "+", 
     RowBox[{"c", "[", 
      RowBox[{"1", ",", "138"}], "]"}]}]}], ",", 
   RowBox[{
    RowBox[{"c", "[", 
     RowBox[{"1", ",", "299"}], "]"}], "\[Rule]", 
    RowBox[{"c", "[", 
     RowBox[{"1", ",", "125"}], "]"}]}], ",", 
   RowBox[{
    RowBox[{"c", "[", 
     RowBox[{"1", ",", "300"}], "]"}], "\[Rule]", 
    RowBox[{
     RowBox[{"c", "[", 
      RowBox[{"1", ",", "50"}], "]"}], "-", 
     RowBox[{"c", "[", 
      RowBox[{"1", ",", "54"}], "]"}], "-", 
     RowBox[{"c", "[", 
      RowBox[{"1", ",", "70"}], "]"}], "+", 
     RowBox[{"c", "[", 
      RowBox[{"1", ",", "74"}], "]"}], "+", 
     RowBox[{"c", "[", 
      RowBox[{"1", ",", "126"}], "]"}]}]}], ",", 
   RowBox[{
    RowBox[{"c", "[", 
     RowBox[{"1", ",", "301"}], "]"}], "\[Rule]", 
    RowBox[{
     RowBox[{"c", "[", 
      RowBox[{"1", ",", "63"}], "]"}], "+", 
     RowBox[{"c", "[", 
      RowBox[{"1", ",", "65"}], "]"}], "+", 
     RowBox[{"c", "[", 
      RowBox[{"1", ",", "127"}], "]"}]}]}], ",", 
   RowBox[{
    RowBox[{"c", "[", 
     RowBox[{"1", ",", "302"}], "]"}], "\[Rule]", 
    RowBox[{
     RowBox[{"c", "[", 
      RowBox[{"1", ",", "48"}], "]"}], "-", 
     RowBox[{"c", "[", 
      RowBox[{"1", ",", "60"}], "]"}], "-", 
     RowBox[{"c", "[", 
      RowBox[{"1", ",", "68"}], "]"}], "+", 
     RowBox[{"c", "[", 
      RowBox[{"1", ",", "80"}], "]"}], "+", 
     RowBox[{"c", "[", 
      RowBox[{"1", ",", "128"}], "]"}]}]}], ",", 
   RowBox[{
    RowBox[{"c", "[", 
     RowBox[{"1", ",", "303"}], "]"}], "\[Rule]", 
    RowBox[{
     RowBox[{"c", "[", 
      RowBox[{"1", ",", "37"}], "]"}], "+", 
     RowBox[{"c", "[", 
      RowBox[{"1", ",", "47"}], "]"}], "-", 
     RowBox[{"c", "[", 
      RowBox[{"1", ",", "67"}], "]"}], "-", 
     RowBox[{"c", "[", 
      RowBox[{"1", ",", "129"}], "]"}]}]}], ",", 
   RowBox[{
    RowBox[{"c", "[", 
     RowBox[{"1", ",", "304"}], "]"}], "\[Rule]", 
    RowBox[{
     RowBox[{"-", "1"}], "+", 
     RowBox[{"c", "[", 
      RowBox[{"1", ",", "43"}], "]"}], "+", 
     RowBox[{"c", "[", 
      RowBox[{"1", ",", "49"}], "]"}], "-", 
     RowBox[{"c", "[", 
      RowBox[{"1", ",", "69"}], "]"}], "+", 
     RowBox[{"c", "[", 
      RowBox[{"1", ",", "136"}], "]"}]}]}], ",", 
   RowBox[{
    RowBox[{"c", "[", 
     RowBox[{"1", ",", "312"}], "]"}], "\[Rule]", 
    RowBox[{
     RowBox[{"-", 
      RowBox[{"c", "[", 
       RowBox[{"1", ",", "108"}], "]"}]}], "-", 
     RowBox[{"c", "[", 
      RowBox[{"1", ",", "188"}], "]"}], "+", 
     RowBox[{"c", "[", 
      RowBox[{"1", ",", "225"}], "]"}], "-", 
     RowBox[{"c", "[", 
      RowBox[{"1", ",", "227"}], "]"}], "+", 
     RowBox[{"c", "[", 
      RowBox[{"1", ",", "237"}], "]"}], "+", 
     RowBox[{"c", "[", 
      RowBox[{"1", ",", "252"}], "]"}], "-", 
     RowBox[{"c", "[", 
      RowBox[{"1", ",", "262"}], "]"}]}]}], ",", 
   RowBox[{
    RowBox[{"c", "[", 
     RowBox[{"1", ",", "314"}], "]"}], "\[Rule]", 
    RowBox[{
     RowBox[{"c", "[", 
      RowBox[{"1", ",", "110"}], "]"}], "-", 
     RowBox[{"c", "[", 
      RowBox[{"1", ",", "185"}], "]"}], "+", 
     RowBox[{"c", "[", 
      RowBox[{"1", ",", "223"}], "]"}], "-", 
     RowBox[{"c", "[", 
      RowBox[{"1", ",", "229"}], "]"}], "+", 
     RowBox[{"c", "[", 
      RowBox[{"1", ",", "233"}], "]"}], "+", 
     RowBox[{"c", "[", 
      RowBox[{"1", ",", "254"}], "]"}], "-", 
     RowBox[{"c", "[", 
      RowBox[{"1", ",", "258"}], "]"}]}]}], ",", 
   RowBox[{
    RowBox[{"c", "[", 
     RowBox[{"1", ",", "316"}], "]"}], "\[Rule]", 
    RowBox[{
     RowBox[{"c", "[", 
      RowBox[{"1", ",", "217"}], "]"}], "+", 
     RowBox[{"c", "[", 
      RowBox[{"1", ",", "218"}], "]"}], "+", 
     RowBox[{"c", "[", 
      RowBox[{"1", ",", "224"}], "]"}]}]}]}], "}"}]], "Output",
 CellChangeTimes->{3.878105405899537*^9, 3.878616421743116*^9, 
  3.878857180221602*^9},
 CellLabel->
  "Out[231]=",ExpressionUUID->"e7fd10af-8630-4f13-bb61-fac1e512946e"]
}, Open  ]]
}, Open  ]],

Cell[CellGroupData[{

Cell["Factorisation condition v.p3", "Subsection",
 CellChangeTimes->{{3.878076748965989*^9, 3.878076767862722*^9}, {
  3.878093747799068*^9, 3.8780937495889473`*^9}, {3.878095192789927*^9, 
  3.8780951929813747`*^9}},ExpressionUUID->"13628a4d-25c7-44e5-9dd8-\
790fd349801b"],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{
  RowBox[{"numAnsatz4", "=", 
   RowBox[{
    RowBox[{
     RowBox[{
      RowBox[{
       RowBox[{"(", "numAnsatz3", ")"}], "//.", "dotRules"}], "/.", 
      RowBox[{"(", 
       RowBox[{
        RowBox[{"vonshell", "[", 
         RowBox[{
          RowBox[{"n", "-", "1"}], ",", "2"}], "]"}], "/.", 
        RowBox[{"v", "->", 
         RowBox[{"v", "[", "1", "]"}]}]}], ")"}]}], "/.", "solsvp2"}], "//", 
    "Expand"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{"%", "//", "Length"}]}], "Input",
 CellChangeTimes->{{3.878076776346158*^9, 3.878076791822427*^9}, {
   3.878076863747164*^9, 3.8780768651784353`*^9}, {3.878077446334421*^9, 
   3.878077450450157*^9}, 3.878080568874198*^9, 3.878080843522138*^9, {
   3.878084931218405*^9, 3.8780849369136047`*^9}, {3.878085107286035*^9, 
   3.878085112014679*^9}, {3.8780852927862673`*^9, 3.878085294285921*^9}, {
   3.8780937634764643`*^9, 3.8780937712084923`*^9}, {3.878094578752013*^9, 
   3.87809458003332*^9}, {3.8780951988903418`*^9, 3.8780952057126427`*^9}, {
   3.8780957389282017`*^9, 3.878095739594145*^9}},
 CellLabel->
  "In[232]:=",ExpressionUUID->"03460e8f-7d6e-4d1f-a8f9-dbc21d11e43f"],

Cell[BoxData["85"], "Output",
 CellChangeTimes->{{3.87807677960294*^9, 3.878076792387086*^9}, 
   3.878076869394702*^9, 3.878077463656658*^9, 3.878080582971023*^9, 
   3.878081061748372*^9, 3.878084951014349*^9, 3.878085126532173*^9, 
   3.878085312641127*^9, 3.878093665706396*^9, 3.878094602309922*^9, 
   3.878095215999476*^9, 3.878096067273143*^9, 3.878616425680036*^9, 
   3.8788571841746283`*^9},
 CellLabel->
  "Out[233]=",ExpressionUUID->"0036c7b2-b7af-4d05-a2ba-4391c1fde01d"]
}, Open  ]],

Cell[BoxData[
 RowBox[{
  RowBox[{"numAnsatzvp1", "=", 
   RowBox[{
    RowBox[{
     RowBox[{
      RowBox[{"(", 
       RowBox[{
        RowBox[{
         RowBox[{"(", 
          RowBox[{"numAnsatz4", "//", 
           RowBox[{"Cases", "[", 
            RowBox[{"Times", "[", 
             RowBox[{"f___", ",", 
              RowBox[{"Power", "[", 
               RowBox[{
                RowBox[{"dot", "[", 
                 RowBox[{
                  RowBox[{"p", "[", "3", "]"}], ",", 
                  RowBox[{"v", "[", "1", "]"}]}], "]"}], ",", 
                RowBox[{"-", "1"}]}], "]"}], ",", "g___"}], "]"}], "]"}]}], 
          ")"}], "/.", 
         RowBox[{
          RowBox[{"Power", "[", 
           RowBox[{
            RowBox[{"dot", "[", 
             RowBox[{
              RowBox[{"p", "[", "3", "]"}], ",", 
              RowBox[{"v", "[", "1", "]"}]}], "]"}], ",", 
            RowBox[{"-", "1"}]}], "]"}], "->", "1"}]}], "//", "Total"}], 
       ")"}], "//.", "dotRules"}], "/.", "vponshell"}], "/.", 
    RowBox[{"{", 
     RowBox[{
      RowBox[{
       RowBox[{"dot", "[", 
        RowBox[{
         RowBox[{"p", "[", "3", "]"}], ",", 
         RowBox[{"v", "[", "1", "]"}]}], "]"}], "->", "0"}], ",", 
      RowBox[{
       RowBox[{"dot", "[", 
        RowBox[{
         RowBox[{"p", "[", "2", "]"}], ",", 
         RowBox[{"v", "[", "1", "]"}]}], "]"}], "->", 
       RowBox[{"-", 
        RowBox[{"dot", "[", 
         RowBox[{
          RowBox[{"p", "[", "1", "]"}], ",", 
          RowBox[{"v", "[", "1", "]"}]}], "]"}]}]}]}], "}"}]}]}], 
  ";"}]], "Input",
 CellChangeTimes->{{3.878077052129978*^9, 3.878077125591745*^9}, {
   3.878077237157652*^9, 3.878077281353335*^9}, {3.8780773702267103`*^9, 
   3.8780774435353603`*^9}, {3.8780774739935207`*^9, 3.8780775017717133`*^9}, 
   3.878079930873101*^9, 3.878079973240665*^9, {3.878085415182927*^9, 
   3.8780854153236303`*^9}, 3.878085446328352*^9, {3.878094648731681*^9, 
   3.878094651846068*^9}, {3.878094696417069*^9, 3.878094712612356*^9}, 
   3.8780952799470053`*^9, {3.878095329611971*^9, 3.878095354825946*^9}},
 CellLabel->
  "In[234]:=",ExpressionUUID->"fde1bdc7-1d3b-4353-b9ad-7ae5dd60398a"],

Cell[BoxData[{
 RowBox[{
  RowBox[{"num1", "=", 
   RowBox[{
    RowBox[{
     RowBox[{"T", "[", 
      RowBox[{"{", "3", "}"}], "]"}], "/.", 
     RowBox[{"T", "->", "T2F"}]}], "/.", 
    RowBox[{"v", "->", 
     RowBox[{"v", "[", "1", "]"}]}]}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"num2", "=", 
   RowBox[{"(", 
    RowBox[{
     FractionBox[
      RowBox[{"dot", "[", 
       RowBox[{
        RowBox[{"p", "[", "1", "]"}], ",", 
        RowBox[{"S", "[", "0", "]"}], ",", 
        RowBox[{"F", "[", "1", "]"}], ",", 
        RowBox[{"F", "[", "2", "]"}], ",", 
        RowBox[{"v", "[", "1", "]"}]}], "]"}], 
      RowBox[{"dot", "[", 
       RowBox[{
        RowBox[{"p", "[", "1", "]"}], ",", 
        RowBox[{"v", "[", "1", "]"}]}], "]"}]], "+", 
     FractionBox[
      RowBox[{"dot", "[", 
       RowBox[{
        RowBox[{"p", "[", "1", "]"}], ",", 
        RowBox[{"S", "[", "0", "]"}], ",", 
        RowBox[{"F", "[", "2", "]"}], ",", 
        RowBox[{"F", "[", "1", "]"}], ",", 
        RowBox[{"v", "[", "1", "]"}]}], "]"}], 
      RowBox[{"dot", "[", 
       RowBox[{
        RowBox[{"p", "[", "1", "]"}], ",", 
        RowBox[{"v", "[", "1", "]"}]}], "]"}]], "-", 
     FractionBox[
      RowBox[{"dot", "[", 
       RowBox[{
        RowBox[{"p", "[", "1", "]"}], ",", 
        RowBox[{"F", "[", "2", "]"}], ",", 
        RowBox[{"S", "[", "0", "]"}], ",", 
        RowBox[{"F", "[", "1", "]"}], ",", 
        RowBox[{"v", "[", "1", "]"}]}], "]"}], 
      RowBox[{"dot", "[", 
       RowBox[{
        RowBox[{"p", "[", "1", "]"}], ",", 
        RowBox[{"v", "[", "1", "]"}]}], "]"}]], "+", 
     FractionBox[
      RowBox[{"dot", "[", 
       RowBox[{
        RowBox[{"p", "[", "2", "]"}], ",", 
        RowBox[{"S", "[", "0", "]"}], ",", 
        RowBox[{"F", "[", "2", "]"}], ",", 
        RowBox[{"F", "[", "1", "]"}], ",", 
        RowBox[{"v", "[", "1", "]"}]}], "]"}], 
      RowBox[{"dot", "[", 
       RowBox[{
        RowBox[{"p", "[", "1", "]"}], ",", 
        RowBox[{"v", "[", "1", "]"}]}], "]"}]]}], ")"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"numvp1", "=", 
   RowBox[{
    RowBox[{
     RowBox[{
      RowBox[{
       RowBox[{"dot", "[", 
        RowBox[{
         RowBox[{
          RowBox[{"p", "[", "1", "]"}], "+", 
          RowBox[{"p", "[", "2", "]"}]}], ",", 
         RowBox[{"p", "[", "3", "]"}]}], "]"}], 
       RowBox[{"(", 
        RowBox[{
         RowBox[{
          RowBox[{"c", "[", "3", "]"}], "num1", "*", "num2"}], "+", 
         RowBox[{
          FractionBox["1", 
           RowBox[{"dot", "[", 
            RowBox[{
             RowBox[{"p", "[", "1", "]"}], ",", 
             RowBox[{"v", "[", "1", "]"}]}], "]"}]], 
          RowBox[{"c", "[", "4", "]"}], 
          RowBox[{"dot", "[", 
           RowBox[{
            RowBox[{"p", "[", "3", "]"}], ",", 
            RowBox[{"S", "[", "0", "]"}], ",", 
            RowBox[{"\[Epsilon]", "[", "3", "]"}]}], "]"}], "*", 
          RowBox[{"dot", "[", 
           RowBox[{
            RowBox[{"v", "[", "1", "]"}], ",", 
            RowBox[{"F", "[", "1", "]"}], ",", 
            RowBox[{"F", "[", "2", "]"}], ",", 
            RowBox[{"v", "[", "1", "]"}]}], "]"}]}]}], ")"}]}], "//.", 
      "dotRules"}], "//", "expandFS"}], "//", "Expand"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"numvp1", "=", 
   RowBox[{
    RowBox[{
     RowBox[{"numvp1", "//.", "dotRules"}], "/.", "vponshell"}], "/.", 
    RowBox[{"{", 
     RowBox[{
      RowBox[{
       RowBox[{"dot", "[", 
        RowBox[{
         RowBox[{"p", "[", "3", "]"}], ",", 
         RowBox[{"v", "[", "1", "]"}]}], "]"}], "->", "0"}], ",", 
      RowBox[{
       RowBox[{"dot", "[", 
        RowBox[{
         RowBox[{"p", "[", "2", "]"}], ",", 
         RowBox[{"v", "[", "1", "]"}]}], "]"}], "->", 
       RowBox[{"-", 
        RowBox[{"dot", "[", 
         RowBox[{
          RowBox[{"p", "[", "1", "]"}], ",", 
          RowBox[{"v", "[", "1", "]"}]}], "]"}]}]}]}], "}"}]}]}], 
  ";"}]}], "Input",
 CellChangeTimes->{{3.878077591985273*^9, 3.8780776461342783`*^9}, {
   3.878077953502172*^9, 3.878077980733405*^9}, {3.878078491930747*^9, 
   3.878078549563458*^9}, {3.878078580745262*^9, 3.87807865251903*^9}, 
   3.878078684800146*^9, {3.878079206140265*^9, 3.878079212664543*^9}, {
   3.878079938416065*^9, 3.8780799390210323`*^9}, {3.878079982854789*^9, 
   3.878079996138009*^9}, 3.878080718496252*^9, 3.878080776110016*^9, {
   3.878081116226698*^9, 3.8780811179219093`*^9}, {3.878081897887516*^9, 
   3.878081929737031*^9}, {3.8780819770250673`*^9, 3.8780819885274878`*^9}, 
   3.8780820357161922`*^9, {3.878082093586617*^9, 3.878082094494379*^9}, 
   3.878082200584118*^9, 3.8780823524734297`*^9, 3.8780843780876017`*^9, {
   3.87808451838385*^9, 3.878084553403726*^9}, {3.878084767872551*^9, 
   3.878084809993238*^9}, {3.878093413770879*^9, 3.878093418381057*^9}, 
   3.878094731163116*^9, {3.878094787760552*^9, 3.878094870939351*^9}, {
   3.878094944453622*^9, 3.878094946794712*^9}, {3.878095374742682*^9, 
   3.878095391986203*^9}, {3.8780954563856373`*^9, 3.878095483306056*^9}, {
   3.878095605265438*^9, 3.878095616154799*^9}, {3.878095684075735*^9, 
   3.878095688268168*^9}},
 CellLabel->
  "In[235]:=",ExpressionUUID->"7e25f5e8-947e-4019-bee6-69b028ad1707"],

Cell[BoxData[
 RowBox[{
  RowBox[{"compvp1", "=", 
   RowBox[{"numAnsatzvp1", "-", "numvp1"}]}], ";"}]], "Input",
 CellChangeTimes->{{3.8780781147500143`*^9, 3.878078179889933*^9}, {
   3.878078714167301*^9, 3.878078719908218*^9}, {3.878078864983605*^9, 
   3.8780788894932623`*^9}, 3.878079927920136*^9, 3.87808000213634*^9},
 CellLabel->
  "In[239]:=",ExpressionUUID->"852c1b9c-61ce-4cbd-b3ae-6cd8d1457d71"],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"compvp1", "/.", 
  RowBox[{"{", 
   RowBox[{
    RowBox[{
     RowBox[{"c", "[", "3", "]"}], "->", "1"}], ",", 
    RowBox[{
     RowBox[{"c", "[", "4", "]"}], "->", "1"}]}], "}"}]}]], "Input",
 CellChangeTimes->{{3.878095527643024*^9, 3.878095578279685*^9}, {
  3.878095625110869*^9, 3.878095641471002*^9}},
 CellLabel->
  "In[240]:=",ExpressionUUID->"47ef6b8b-d114-4491-bb3e-09a9342ebb8f"],

Cell[BoxData["0"], "Output",
 CellChangeTimes->{{3.878095519546192*^9, 3.878095530830967*^9}, {
   3.8780955685470467`*^9, 3.878095578769575*^9}, {3.8780956254979887`*^9, 
   3.87809564203146*^9}, 3.878095695176092*^9, 3.8780960673961983`*^9, 
   3.878616425788804*^9, 3.87885718427253*^9},
 CellLabel->
  "Out[240]=",ExpressionUUID->"d9b96e01-8c7e-45bb-8158-e8828cbf645c"]
}, Open  ]],

Cell[BoxData[{
 RowBox[{
  RowBox[{"cvars", "=", 
   RowBox[{
    RowBox[{"Cases", "[", 
     RowBox[{"compvp1", ",", 
      RowBox[{"c", "[", "__", "]"}], ",", 
      RowBox[{"{", 
       RowBox[{"0", ",", "\[Infinity]"}], "}"}]}], "]"}], "//", "Union"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"vardot", "=", 
   RowBox[{"compvp1", "//", "Casesdot"}]}], ";"}]}], "Input",
 CellChangeTimes->{{3.878078218083035*^9, 3.878078227195683*^9}},
 CellLabel->
  "In[241]:=",ExpressionUUID->"269e8e9f-94be-45a7-95c8-e950994ff4c7"],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"cvars", "//", "Length"}]], "Input",
 CellChangeTimes->{{3.878078250405406*^9, 3.8780782515980988`*^9}, 
   3.8780793030421352`*^9, {3.878080618122617*^9, 3.878080619511405*^9}},
 CellLabel->
  "In[243]:=",ExpressionUUID->"1eff3f89-c5c1-4c61-9f1f-4ce2abd924ea"],

Cell[BoxData["2"], "Output",
 CellChangeTimes->{
  3.878078252063862*^9, 3.878078732430634*^9, {3.8780792683050127`*^9, 
   3.878079303531766*^9}, {3.8780806116761723`*^9, 3.878080620497012*^9}, 
   3.878080793272333*^9, 3.8780810935750732`*^9, 3.8780811318686132`*^9, 
   3.878081941084124*^9, 3.8780820011325197`*^9, 3.878082120982493*^9, 
   3.878084828486793*^9, 3.878085517830093*^9, 3.878093680935251*^9, 
   3.878095084936636*^9, 3.878095713545517*^9, 3.878096067412579*^9, 
   3.878616425798328*^9, 3.878857184286684*^9},
 CellLabel->
  "Out[243]=",ExpressionUUID->"b64ea886-8d9a-4baf-a06b-8eec44dfc0dc"]
}, Open  ]],

Cell[BoxData[{
 RowBox[{
  RowBox[{"dot2num", ":=", 
   RowBox[{"Table", "[", 
    RowBox[{
     RowBox[{"Rule", "[", 
      RowBox[{
       RowBox[{"vardot", "[", 
        RowBox[{"[", "ii", "]"}], "]"}], ",", 
       RowBox[{"RandomInteger", "[", 
        RowBox[{"{", 
         RowBox[{"10", ",", "100"}], "}"}], "]"}]}], "]"}], ",", 
     RowBox[{"{", 
      RowBox[{"ii", ",", 
       RowBox[{"Length", "[", "vardot", "]"}]}], "}"}]}], "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{"Monitor", "[", 
  RowBox[{
   RowBox[{
    RowBox[{"eqDep", "=", 
     RowBox[{"Table", "[", 
      RowBox[{
       RowBox[{
        RowBox[{"compvp1", "\[Equal]", "0"}], "/.", "dot2num"}], ",", 
       RowBox[{"{", 
        RowBox[{"ii", ",", 
         RowBox[{"10", "+", 
          RowBox[{"Length", "[", "cvars", "]"}]}]}], "}"}]}], "]"}]}], ";"}], 
   ",", "ii"}], "]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"solsvp3", "=", 
   RowBox[{
    RowBox[{"Solve", "[", 
     RowBox[{"eqDep", ",", "cvars"}], "]"}], "[", 
    RowBox[{"[", "1", "]"}], "]"}]}], ";"}]}], "Input",
 CellChangeTimes->{{3.878078221639757*^9, 3.878078240954069*^9}, {
  3.878081064658252*^9, 3.8780810690042477`*^9}, {3.878095733492796*^9, 
  3.878095733629385*^9}},
 CellLabel->
  "In[244]:=",ExpressionUUID->"ff21824b-8ef3-4cd6-9556-da46ed6b1cca"],

Cell[CellGroupData[{

Cell[BoxData["solsvp3"], "Input",
 CellChangeTimes->{{3.878096861054673*^9, 3.8780968614695673`*^9}},
 CellLabel->
  "In[247]:=",ExpressionUUID->"43a0151e-8ebd-4243-a5e4-1ed70ee22f2f"],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
   RowBox[{
    RowBox[{"c", "[", "3", "]"}], "\[Rule]", "1"}], ",", 
   RowBox[{
    RowBox[{"c", "[", "4", "]"}], "\[Rule]", "1"}]}], "}"}]], "Output",
 CellChangeTimes->{3.878093691306862*^9, 3.878095112706624*^9, 
  3.878095717543086*^9, 3.878096067453002*^9, 3.878096861847978*^9, 
  3.878616425855497*^9, 3.878857184325617*^9},
 CellLabel->
  "Out[247]=",ExpressionUUID->"8786b034-1551-4e44-b4f7-af6a9c39e49a"]
}, Open  ]]
}, Open  ]],

Cell[CellGroupData[{

Cell["Final Result", "Subsection",
 CellChangeTimes->{{3.878095815607132*^9, 
  3.878095824409616*^9}},ExpressionUUID->"53d2eeec-1112-4cce-b7d4-\
5104623dfb30"],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{
     RowBox[{"numAnsatz", "/.", "sols"}], "/.", "solsvp1"}], "/.", 
    "solsvp2"}], "/.", 
   RowBox[{
    RowBox[{"c", "[", "__", "]"}], ":>", "0"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{"%", "//.", "nice"}]}], "Input",
 CellChangeTimes->{{3.8780958303263483`*^9, 3.878095831726018*^9}, {
  3.878096867922544*^9, 3.878096935558015*^9}, {3.878097392092999*^9, 
  3.878097396030863*^9}},
 CellLabel->
  "In[248]:=",ExpressionUUID->"41b68abb-e62d-4676-bed1-4a7b029d8a85"],

Cell[BoxData[
 RowBox[{
  FractionBox[
   RowBox[{
    RowBox[{
     SubscriptBox["p", "1"], "\[CenterDot]", 
     SubscriptBox["S", "0"], "\[CenterDot]", 
     SubscriptBox["F", "2"], "\[CenterDot]", 
     SubscriptBox["v", "1"]}], " ", 
    RowBox[{
     SubscriptBox["p", "2"], "\[CenterDot]", 
     SubscriptBox["F", "1"], "\[CenterDot]", 
     SubscriptBox["F", "3"], "\[CenterDot]", 
     SubscriptBox["v", "1"]}]}], 
   RowBox[{
    RowBox[{
     SubscriptBox["p", "1"], "\[CenterDot]", 
     SubscriptBox["v", "1"]}], " ", 
    RowBox[{"(", 
     RowBox[{
      RowBox[{
       SubscriptBox["p", "1"], "\[CenterDot]", 
       SubscriptBox["v", "1"]}], "+", 
      RowBox[{
       SubscriptBox["p", "2"], "\[CenterDot]", 
       SubscriptBox["v", "1"]}]}], ")"}]}]], "+", 
  FractionBox[
   RowBox[{
    RowBox[{
     SubscriptBox["p", "1"], "\[CenterDot]", 
     SubscriptBox["F", "3"], "\[CenterDot]", 
     SubscriptBox["S", "0"], "\[CenterDot]", 
     SubscriptBox["p", "3"]}], " ", 
    RowBox[{
     SubscriptBox["v", "1"], "\[CenterDot]", 
     SubscriptBox["F", "1"], "\[CenterDot]", 
     SubscriptBox["F", "2"], "\[CenterDot]", 
     SubscriptBox["v", "1"]}]}], 
   RowBox[{
    RowBox[{
     SubscriptBox["p", "1"], "\[CenterDot]", 
     SubscriptBox["v", "1"]}], " ", 
    RowBox[{"(", 
     RowBox[{
      RowBox[{
       SubscriptBox["p", "1"], "\[CenterDot]", 
       SubscriptBox["v", "1"]}], "+", 
      RowBox[{
       SubscriptBox["p", "2"], "\[CenterDot]", 
       SubscriptBox["v", "1"]}]}], ")"}]}]], "+", 
  FractionBox[
   RowBox[{
    RowBox[{
     SubscriptBox["p", "1"], "\[CenterDot]", 
     SubscriptBox["F", "3"], "\[CenterDot]", 
     SubscriptBox["S", "0"], "\[CenterDot]", 
     SubscriptBox["p", "3"]}], " ", 
    RowBox[{
     SubscriptBox["v", "1"], "\[CenterDot]", 
     SubscriptBox["F", "1"], "\[CenterDot]", 
     SubscriptBox["F", "2"], "\[CenterDot]", 
     SubscriptBox["v", "1"]}]}], 
   RowBox[{
    RowBox[{
     SubscriptBox["p", "1"], "\[CenterDot]", 
     SubscriptBox["v", "1"]}], " ", 
    RowBox[{"(", 
     RowBox[{
      RowBox[{
       SubscriptBox["p", "1"], "\[CenterDot]", 
       SubscriptBox["v", "1"]}], "+", 
      RowBox[{
       SubscriptBox["p", "3"], "\[CenterDot]", 
       SubscriptBox["v", "1"]}]}], ")"}]}]], "+", 
  FractionBox[
   RowBox[{
    RowBox[{
     SubscriptBox["p", "2"], "\[CenterDot]", 
     SubscriptBox["F", "3"], "\[CenterDot]", 
     SubscriptBox["S", "0"], "\[CenterDot]", 
     SubscriptBox["p", "3"]}], " ", 
    RowBox[{
     SubscriptBox["v", "1"], "\[CenterDot]", 
     SubscriptBox["F", "1"], "\[CenterDot]", 
     SubscriptBox["F", "2"], "\[CenterDot]", 
     SubscriptBox["v", "1"]}]}], 
   RowBox[{
    RowBox[{
     SubscriptBox["p", "1"], "\[CenterDot]", 
     SubscriptBox["v", "1"]}], " ", 
    RowBox[{"(", 
     RowBox[{
      RowBox[{
       SubscriptBox["p", "1"], "\[CenterDot]", 
       SubscriptBox["v", "1"]}], "+", 
      RowBox[{
       SubscriptBox["p", "2"], "\[CenterDot]", 
       SubscriptBox["v", "1"]}]}], ")"}]}]], "+", 
  FractionBox[
   RowBox[{
    RowBox[{
     SubscriptBox["p", "1"], "\[CenterDot]", 
     SubscriptBox["F", "2"], "\[CenterDot]", 
     SubscriptBox["S", "0"], "\[CenterDot]", 
     SubscriptBox["p", "2"]}], " ", 
    RowBox[{
     SubscriptBox["v", "1"], "\[CenterDot]", 
     SubscriptBox["F", "1"], "\[CenterDot]", 
     SubscriptBox["F", "3"], "\[CenterDot]", 
     SubscriptBox["v", "1"]}]}], 
   RowBox[{
    RowBox[{
     SubscriptBox["p", "1"], "\[CenterDot]", 
     SubscriptBox["v", "1"]}], " ", 
    RowBox[{"(", 
     RowBox[{
      RowBox[{
       SubscriptBox["p", "1"], "\[CenterDot]", 
       SubscriptBox["v", "1"]}], "+", 
      RowBox[{
       SubscriptBox["p", "2"], "\[CenterDot]", 
       SubscriptBox["v", "1"]}]}], ")"}]}]], "+", 
  FractionBox[
   RowBox[{
    RowBox[{
     SubscriptBox["p", "1"], "\[CenterDot]", 
     SubscriptBox["F", "2"], "\[CenterDot]", 
     SubscriptBox["S", "0"], "\[CenterDot]", 
     SubscriptBox["p", "2"]}], " ", 
    RowBox[{
     SubscriptBox["v", "1"], "\[CenterDot]", 
     SubscriptBox["F", "1"], "\[CenterDot]", 
     SubscriptBox["F", "3"], "\[CenterDot]", 
     SubscriptBox["v", "1"]}]}], 
   RowBox[{
    RowBox[{
     SubscriptBox["p", "1"], "\[CenterDot]", 
     SubscriptBox["v", "1"]}], " ", 
    RowBox[{"(", 
     RowBox[{
      RowBox[{
       SubscriptBox["p", "1"], "\[CenterDot]", 
       SubscriptBox["v", "1"]}], "+", 
      RowBox[{
       SubscriptBox["p", "3"], "\[CenterDot]", 
       SubscriptBox["v", "1"]}]}], ")"}]}]], "-", 
  FractionBox[
   RowBox[{
    RowBox[{
     SubscriptBox["p", "1"], "\[CenterDot]", 
     SubscriptBox["F", "3"], "\[CenterDot]", 
     SubscriptBox["v", "1"]}], " ", 
    RowBox[{
     SubscriptBox["p", "1"], "\[CenterDot]", 
     SubscriptBox["S", "0"], "\[CenterDot]", 
     SubscriptBox["F", "1"], "\[CenterDot]", 
     SubscriptBox["F", "2"], "\[CenterDot]", 
     SubscriptBox["v", "1"]}]}], 
   RowBox[{
    RowBox[{
     SubscriptBox["p", "1"], "\[CenterDot]", 
     SubscriptBox["v", "1"]}], " ", 
    RowBox[{"(", 
     RowBox[{
      RowBox[{
       SubscriptBox["p", "1"], "\[CenterDot]", 
       SubscriptBox["v", "1"]}], "+", 
      RowBox[{
       SubscriptBox["p", "2"], "\[CenterDot]", 
       SubscriptBox["v", "1"]}]}], ")"}]}]], "-", 
  FractionBox[
   RowBox[{
    RowBox[{
     SubscriptBox["p", "1"], "\[CenterDot]", 
     SubscriptBox["F", "3"], "\[CenterDot]", 
     SubscriptBox["v", "1"]}], " ", 
    RowBox[{
     SubscriptBox["p", "1"], "\[CenterDot]", 
     SubscriptBox["S", "0"], "\[CenterDot]", 
     SubscriptBox["F", "1"], "\[CenterDot]", 
     SubscriptBox["F", "2"], "\[CenterDot]", 
     SubscriptBox["v", "1"]}]}], 
   RowBox[{
    RowBox[{
     SubscriptBox["p", "1"], "\[CenterDot]", 
     SubscriptBox["v", "1"]}], " ", 
    RowBox[{"(", 
     RowBox[{
      RowBox[{
       SubscriptBox["p", "1"], "\[CenterDot]", 
       SubscriptBox["v", "1"]}], "+", 
      RowBox[{
       SubscriptBox["p", "3"], "\[CenterDot]", 
       SubscriptBox["v", "1"]}]}], ")"}]}]], "-", 
  FractionBox[
   RowBox[{
    RowBox[{
     SubscriptBox["p", "2"], "\[CenterDot]", 
     SubscriptBox["F", "3"], "\[CenterDot]", 
     SubscriptBox["v", "1"]}], " ", 
    RowBox[{
     SubscriptBox["p", "1"], "\[CenterDot]", 
     SubscriptBox["S", "0"], "\[CenterDot]", 
     SubscriptBox["F", "1"], "\[CenterDot]", 
     SubscriptBox["F", "2"], "\[CenterDot]", 
     SubscriptBox["v", "1"]}]}], 
   RowBox[{
    RowBox[{
     SubscriptBox["p", "1"], "\[CenterDot]", 
     SubscriptBox["v", "1"]}], " ", 
    RowBox[{"(", 
     RowBox[{
      RowBox[{
       SubscriptBox["p", "1"], "\[CenterDot]", 
       SubscriptBox["v", "1"]}], "+", 
      RowBox[{
       SubscriptBox["p", "2"], "\[CenterDot]", 
       SubscriptBox["v", "1"]}]}], ")"}]}]], "-", 
  FractionBox[
   RowBox[{
    RowBox[{
     SubscriptBox["p", "1"], "\[CenterDot]", 
     SubscriptBox["F", "3"], "\[CenterDot]", 
     SubscriptBox["v", "1"]}], " ", 
    RowBox[{
     SubscriptBox["p", "2"], "\[CenterDot]", 
     SubscriptBox["S", "0"], "\[CenterDot]", 
     SubscriptBox["F", "1"], "\[CenterDot]", 
     SubscriptBox["F", "2"], "\[CenterDot]", 
     SubscriptBox["v", "1"]}]}], 
   RowBox[{
    RowBox[{
     SubscriptBox["p", "1"], "\[CenterDot]", 
     SubscriptBox["v", "1"]}], " ", 
    RowBox[{"(", 
     RowBox[{
      RowBox[{
       SubscriptBox["p", "1"], "\[CenterDot]", 
       SubscriptBox["v", "1"]}], "+", 
      RowBox[{
       SubscriptBox["p", "2"], "\[CenterDot]", 
       SubscriptBox["v", "1"]}]}], ")"}]}]], "-", 
  FractionBox[
   RowBox[{
    RowBox[{
     SubscriptBox["p", "2"], "\[CenterDot]", 
     SubscriptBox["F", "3"], "\[CenterDot]", 
     SubscriptBox["v", "1"]}], " ", 
    RowBox[{
     SubscriptBox["p", "2"], "\[CenterDot]", 
     SubscriptBox["S", "0"], "\[CenterDot]", 
     SubscriptBox["F", "2"], "\[CenterDot]", 
     SubscriptBox["F", "1"], "\[CenterDot]", 
     SubscriptBox["v", "1"]}]}], 
   RowBox[{
    RowBox[{
     SubscriptBox["p", "1"], "\[CenterDot]", 
     SubscriptBox["v", "1"]}], " ", 
    RowBox[{"(", 
     RowBox[{
      RowBox[{
       SubscriptBox["p", "1"], "\[CenterDot]", 
       SubscriptBox["v", "1"]}], "+", 
      RowBox[{
       SubscriptBox["p", "2"], "\[CenterDot]", 
       SubscriptBox["v", "1"]}]}], ")"}]}]], "+", 
  FractionBox[
   RowBox[{
    RowBox[{
     SubscriptBox["p", "1"], "\[CenterDot]", 
     SubscriptBox["F", "2"], "\[CenterDot]", 
     SubscriptBox["v", "1"]}], " ", 
    RowBox[{
     SubscriptBox["p", "3"], "\[CenterDot]", 
     SubscriptBox["F", "1"], "\[CenterDot]", 
     SubscriptBox["S", "0"], "\[CenterDot]", 
     SubscriptBox["F", "3"], "\[CenterDot]", 
     SubscriptBox["v", "1"]}]}], 
   RowBox[{
    RowBox[{
     SubscriptBox["p", "1"], "\[CenterDot]", 
     SubscriptBox["v", "1"]}], " ", 
    RowBox[{"(", 
     RowBox[{
      RowBox[{
       SubscriptBox["p", "1"], "\[CenterDot]", 
       SubscriptBox["v", "1"]}], "+", 
      RowBox[{
       SubscriptBox["p", "3"], "\[CenterDot]", 
       SubscriptBox["v", "1"]}]}], ")"}]}]], "-", 
  FractionBox[
   RowBox[{
    RowBox[{
     SubscriptBox["p", "1"], "\[CenterDot]", 
     SubscriptBox["F", "3"], "\[CenterDot]", 
     SubscriptBox["v", "1"]}], " ", 
    RowBox[{
     SubscriptBox["p", "3"], "\[CenterDot]", 
     SubscriptBox["S", "0"], "\[CenterDot]", 
     SubscriptBox["F", "1"], "\[CenterDot]", 
     SubscriptBox["F", "2"], "\[CenterDot]", 
     SubscriptBox["v", "1"]}]}], 
   RowBox[{
    RowBox[{
     SubscriptBox["p", "1"], "\[CenterDot]", 
     SubscriptBox["v", "1"]}], " ", 
    RowBox[{"(", 
     RowBox[{
      RowBox[{
       SubscriptBox["p", "1"], "\[CenterDot]", 
       SubscriptBox["v", "1"]}], "+", 
      RowBox[{
       SubscriptBox["p", "3"], "\[CenterDot]", 
       SubscriptBox["v", "1"]}]}], ")"}]}]], "-", 
  FractionBox[
   RowBox[{
    RowBox[{
     SubscriptBox["p", "1"], "\[CenterDot]", 
     SubscriptBox["S", "0"], "\[CenterDot]", 
     SubscriptBox["p", "3"]}], " ", 
    RowBox[{
     SubscriptBox["v", "1"], "\[CenterDot]", 
     SubscriptBox["F", "2"], "\[CenterDot]", 
     SubscriptBox["F", "1"], "\[CenterDot]", 
     SubscriptBox["F", "3"], "\[CenterDot]", 
     SubscriptBox["v", "1"]}]}], 
   RowBox[{
    RowBox[{
     SubscriptBox["p", "1"], "\[CenterDot]", 
     SubscriptBox["v", "1"]}], " ", 
    RowBox[{"(", 
     RowBox[{
      RowBox[{
       SubscriptBox["p", "1"], "\[CenterDot]", 
       SubscriptBox["v", "1"]}], "+", 
      RowBox[{
       SubscriptBox["p", "3"], "\[CenterDot]", 
       SubscriptBox["v", "1"]}]}], ")"}]}]], "+", 
  FractionBox[
   RowBox[{
    SubscriptBox["p", "1"], "\[CenterDot]", 
    SubscriptBox["F", "2"], "\[CenterDot]", 
    SubscriptBox["S", "0"], "\[CenterDot]", 
    SubscriptBox["F", "1"], "\[CenterDot]", 
    SubscriptBox["F", "3"], "\[CenterDot]", 
    SubscriptBox["v", "1"]}], 
   RowBox[{
    SubscriptBox["p", "1"], "\[CenterDot]", 
    SubscriptBox["v", "1"]}]], "+", 
  FractionBox[
   RowBox[{
    SubscriptBox["p", "1"], "\[CenterDot]", 
    SubscriptBox["F", "3"], "\[CenterDot]", 
    SubscriptBox["S", "0"], "\[CenterDot]", 
    SubscriptBox["F", "1"], "\[CenterDot]", 
    SubscriptBox["F", "2"], "\[CenterDot]", 
    SubscriptBox["v", "1"]}], 
   RowBox[{
    SubscriptBox["p", "1"], "\[CenterDot]", 
    SubscriptBox["v", "1"]}]], "+", 
  FractionBox[
   RowBox[{
    SubscriptBox["p", "1"], "\[CenterDot]", 
    SubscriptBox["S", "0"], "\[CenterDot]", 
    SubscriptBox["F", "1"], "\[CenterDot]", 
    SubscriptBox["F", "2"], "\[CenterDot]", 
    SubscriptBox["F", "3"], "\[CenterDot]", 
    SubscriptBox["v", "1"]}], 
   RowBox[{
    SubscriptBox["p", "1"], "\[CenterDot]", 
    SubscriptBox["v", "1"]}]], "-", 
  FractionBox[
   RowBox[{
    SubscriptBox["p", "1"], "\[CenterDot]", 
    SubscriptBox["S", "0"], "\[CenterDot]", 
    SubscriptBox["F", "2"], "\[CenterDot]", 
    SubscriptBox["F", "1"], "\[CenterDot]", 
    SubscriptBox["F", "3"], "\[CenterDot]", 
    SubscriptBox["v", "1"]}], 
   RowBox[{
    SubscriptBox["p", "1"], "\[CenterDot]", 
    SubscriptBox["v", "1"]}]], "-", 
  FractionBox[
   RowBox[{
    SubscriptBox["p", "1"], "\[CenterDot]", 
    SubscriptBox["S", "0"], "\[CenterDot]", 
    SubscriptBox["F", "3"], "\[CenterDot]", 
    SubscriptBox["F", "1"], "\[CenterDot]", 
    SubscriptBox["F", "2"], "\[CenterDot]", 
    SubscriptBox["v", "1"]}], 
   RowBox[{
    SubscriptBox["p", "1"], "\[CenterDot]", 
    SubscriptBox["v", "1"]}]], "-", 
  FractionBox[
   RowBox[{
    SubscriptBox["p", "2"], "\[CenterDot]", 
    SubscriptBox["F", "1"], "\[CenterDot]", 
    SubscriptBox["F", "3"], "\[CenterDot]", 
    SubscriptBox["S", "0"], "\[CenterDot]", 
    SubscriptBox["F", "2"], "\[CenterDot]", 
    SubscriptBox["v", "1"]}], 
   RowBox[{
    SubscriptBox["p", "1"], "\[CenterDot]", 
    SubscriptBox["v", "1"]}]], "-", 
  FractionBox[
   RowBox[{
    SubscriptBox["p", "2"], "\[CenterDot]", 
    SubscriptBox["F", "1"], "\[CenterDot]", 
    SubscriptBox["S", "0"], "\[CenterDot]", 
    SubscriptBox["F", "2"], "\[CenterDot]", 
    SubscriptBox["F", "3"], "\[CenterDot]", 
    SubscriptBox["v", "1"]}], 
   RowBox[{
    SubscriptBox["p", "1"], "\[CenterDot]", 
    SubscriptBox["v", "1"]}]], "+", 
  FractionBox[
   RowBox[{
    RowBox[{
     SubscriptBox["p", "2"], "\[CenterDot]", 
     SubscriptBox["v", "1"]}], " ", 
    RowBox[{
     SubscriptBox["p", "2"], "\[CenterDot]", 
     SubscriptBox["F", "1"], "\[CenterDot]", 
     SubscriptBox["S", "0"], "\[CenterDot]", 
     SubscriptBox["F", "2"], "\[CenterDot]", 
     SubscriptBox["F", "3"], "\[CenterDot]", 
     SubscriptBox["v", "1"]}]}], 
   RowBox[{
    RowBox[{
     SubscriptBox["p", "1"], "\[CenterDot]", 
     SubscriptBox["v", "1"]}], " ", 
    RowBox[{"(", 
     RowBox[{
      RowBox[{
       SubscriptBox["p", "1"], "\[CenterDot]", 
       SubscriptBox["v", "1"]}], "+", 
      RowBox[{
       SubscriptBox["p", "2"], "\[CenterDot]", 
       SubscriptBox["v", "1"]}]}], ")"}]}]], "+", 
  FractionBox[
   RowBox[{
    SubscriptBox["p", "2"], "\[CenterDot]", 
    SubscriptBox["F", "1"], "\[CenterDot]", 
    SubscriptBox["S", "0"], "\[CenterDot]", 
    SubscriptBox["F", "3"], "\[CenterDot]", 
    SubscriptBox["F", "2"], "\[CenterDot]", 
    SubscriptBox["v", "1"]}], 
   RowBox[{
    SubscriptBox["p", "1"], "\[CenterDot]", 
    SubscriptBox["v", "1"]}]], "+", 
  FractionBox[
   RowBox[{
    SubscriptBox["p", "2"], "\[CenterDot]", 
    SubscriptBox["F", "3"], "\[CenterDot]", 
    SubscriptBox["S", "0"], "\[CenterDot]", 
    SubscriptBox["F", "1"], "\[CenterDot]", 
    SubscriptBox["F", "2"], "\[CenterDot]", 
    SubscriptBox["v", "1"]}], 
   RowBox[{
    SubscriptBox["p", "1"], "\[CenterDot]", 
    SubscriptBox["v", "1"]}]], "+", 
  FractionBox[
   RowBox[{
    SubscriptBox["p", "2"], "\[CenterDot]", 
    SubscriptBox["F", "3"], "\[CenterDot]", 
    SubscriptBox["S", "0"], "\[CenterDot]", 
    SubscriptBox["F", "2"], "\[CenterDot]", 
    SubscriptBox["F", "1"], "\[CenterDot]", 
    SubscriptBox["v", "1"]}], 
   RowBox[{
    SubscriptBox["p", "1"], "\[CenterDot]", 
    SubscriptBox["v", "1"]}]], "+", 
  FractionBox[
   RowBox[{
    SubscriptBox["p", "2"], "\[CenterDot]", 
    SubscriptBox["S", "0"], "\[CenterDot]", 
    SubscriptBox["F", "1"], "\[CenterDot]", 
    SubscriptBox["F", "2"], "\[CenterDot]", 
    SubscriptBox["F", "3"], "\[CenterDot]", 
    SubscriptBox["v", "1"]}], 
   RowBox[{
    SubscriptBox["p", "1"], "\[CenterDot]", 
    SubscriptBox["v", "1"]}]], "-", 
  FractionBox[
   RowBox[{
    RowBox[{
     SubscriptBox["p", "2"], "\[CenterDot]", 
     SubscriptBox["v", "1"]}], " ", 
    RowBox[{
     SubscriptBox["p", "2"], "\[CenterDot]", 
     SubscriptBox["S", "0"], "\[CenterDot]", 
     SubscriptBox["F", "1"], "\[CenterDot]", 
     SubscriptBox["F", "2"], "\[CenterDot]", 
     SubscriptBox["F", "3"], "\[CenterDot]", 
     SubscriptBox["v", "1"]}]}], 
   RowBox[{
    RowBox[{
     SubscriptBox["p", "1"], "\[CenterDot]", 
     SubscriptBox["v", "1"]}], " ", 
    RowBox[{"(", 
     RowBox[{
      RowBox[{
       SubscriptBox["p", "1"], "\[CenterDot]", 
       SubscriptBox["v", "1"]}], "+", 
      RowBox[{
       SubscriptBox["p", "2"], "\[CenterDot]", 
       SubscriptBox["v", "1"]}]}], ")"}]}]], "-", 
  FractionBox[
   RowBox[{
    SubscriptBox["p", "2"], "\[CenterDot]", 
    SubscriptBox["S", "0"], "\[CenterDot]", 
    SubscriptBox["F", "2"], "\[CenterDot]", 
    SubscriptBox["F", "1"], "\[CenterDot]", 
    SubscriptBox["F", "3"], "\[CenterDot]", 
    SubscriptBox["v", "1"]}], 
   RowBox[{
    SubscriptBox["p", "1"], "\[CenterDot]", 
    SubscriptBox["v", "1"]}]], "+", 
  FractionBox[
   RowBox[{
    RowBox[{
     SubscriptBox["p", "2"], "\[CenterDot]", 
     SubscriptBox["v", "1"]}], " ", 
    RowBox[{
     SubscriptBox["p", "2"], "\[CenterDot]", 
     SubscriptBox["S", "0"], "\[CenterDot]", 
     SubscriptBox["F", "2"], "\[CenterDot]", 
     SubscriptBox["F", "1"], "\[CenterDot]", 
     SubscriptBox["F", "3"], "\[CenterDot]", 
     SubscriptBox["v", "1"]}]}], 
   RowBox[{
    RowBox[{
     SubscriptBox["p", "1"], "\[CenterDot]", 
     SubscriptBox["v", "1"]}], " ", 
    RowBox[{"(", 
     RowBox[{
      RowBox[{
       SubscriptBox["p", "1"], "\[CenterDot]", 
       SubscriptBox["v", "1"]}], "+", 
      RowBox[{
       SubscriptBox["p", "2"], "\[CenterDot]", 
       SubscriptBox["v", "1"]}]}], ")"}]}]], "-", 
  FractionBox[
   RowBox[{
    SubscriptBox["p", "2"], "\[CenterDot]", 
    SubscriptBox["S", "0"], "\[CenterDot]", 
    SubscriptBox["F", "3"], "\[CenterDot]", 
    SubscriptBox["F", "1"], "\[CenterDot]", 
    SubscriptBox["F", "2"], "\[CenterDot]", 
    SubscriptBox["v", "1"]}], 
   RowBox[{
    SubscriptBox["p", "1"], "\[CenterDot]", 
    SubscriptBox["v", "1"]}]], "-", 
  FractionBox[
   RowBox[{
    SubscriptBox["p", "2"], "\[CenterDot]", 
    SubscriptBox["S", "0"], "\[CenterDot]", 
    SubscriptBox["F", "3"], "\[CenterDot]", 
    SubscriptBox["F", "2"], "\[CenterDot]", 
    SubscriptBox["F", "1"], "\[CenterDot]", 
    SubscriptBox["v", "1"]}], 
   RowBox[{
    SubscriptBox["p", "1"], "\[CenterDot]", 
    SubscriptBox["v", "1"]}]], "-", 
  FractionBox[
   RowBox[{
    SubscriptBox["p", "3"], "\[CenterDot]", 
    SubscriptBox["F", "1"], "\[CenterDot]", 
    SubscriptBox["F", "2"], "\[CenterDot]", 
    SubscriptBox["S", "0"], "\[CenterDot]", 
    SubscriptBox["F", "3"], "\[CenterDot]", 
    SubscriptBox["v", "1"]}], 
   RowBox[{
    SubscriptBox["p", "1"], "\[CenterDot]", 
    SubscriptBox["v", "1"]}]], "+", 
  FractionBox[
   RowBox[{
    SubscriptBox["p", "3"], "\[CenterDot]", 
    SubscriptBox["F", "2"], "\[CenterDot]", 
    SubscriptBox["F", "1"], "\[CenterDot]", 
    SubscriptBox["S", "0"], "\[CenterDot]", 
    SubscriptBox["F", "3"], "\[CenterDot]", 
    SubscriptBox["v", "1"]}], 
   RowBox[{
    SubscriptBox["p", "1"], "\[CenterDot]", 
    SubscriptBox["v", "1"]}]], "+", 
  FractionBox[
   RowBox[{
    SubscriptBox["p", "3"], "\[CenterDot]", 
    SubscriptBox["S", "0"], "\[CenterDot]", 
    SubscriptBox["F", "1"], "\[CenterDot]", 
    SubscriptBox["F", "2"], "\[CenterDot]", 
    SubscriptBox["F", "3"], "\[CenterDot]", 
    SubscriptBox["v", "1"]}], 
   RowBox[{
    SubscriptBox["p", "1"], "\[CenterDot]", 
    SubscriptBox["v", "1"]}]], "-", 
  FractionBox[
   RowBox[{
    SubscriptBox["p", "3"], "\[CenterDot]", 
    SubscriptBox["S", "0"], "\[CenterDot]", 
    SubscriptBox["F", "2"], "\[CenterDot]", 
    SubscriptBox["F", "1"], "\[CenterDot]", 
    SubscriptBox["F", "3"], "\[CenterDot]", 
    SubscriptBox["v", "1"]}], 
   RowBox[{
    SubscriptBox["p", "1"], "\[CenterDot]", 
    SubscriptBox["v", "1"]}]], "-", 
  FractionBox[
   RowBox[{
    SubscriptBox["p", "3"], "\[CenterDot]", 
    SubscriptBox["S", "0"], "\[CenterDot]", 
    SubscriptBox["F", "3"], "\[CenterDot]", 
    SubscriptBox["F", "1"], "\[CenterDot]", 
    SubscriptBox["F", "2"], "\[CenterDot]", 
    SubscriptBox["v", "1"]}], 
   RowBox[{
    SubscriptBox["p", "1"], "\[CenterDot]", 
    SubscriptBox["v", "1"]}]], "+", 
  FractionBox[
   RowBox[{
    RowBox[{
     SubscriptBox["p", "3"], "\[CenterDot]", 
     SubscriptBox["v", "1"]}], " ", 
    RowBox[{
     SubscriptBox["p", "3"], "\[CenterDot]", 
     SubscriptBox["S", "0"], "\[CenterDot]", 
     SubscriptBox["F", "3"], "\[CenterDot]", 
     SubscriptBox["F", "1"], "\[CenterDot]", 
     SubscriptBox["F", "2"], "\[CenterDot]", 
     SubscriptBox["v", "1"]}]}], 
   RowBox[{
    RowBox[{
     SubscriptBox["p", "1"], "\[CenterDot]", 
     SubscriptBox["v", "1"]}], " ", 
    RowBox[{"(", 
     RowBox[{
      RowBox[{
       SubscriptBox["p", "1"], "\[CenterDot]", 
       SubscriptBox["v", "1"]}], "+", 
      RowBox[{
       SubscriptBox["p", "3"], "\[CenterDot]", 
       SubscriptBox["v", "1"]}]}], ")"}]}]], "-", 
  FractionBox[
   RowBox[{
    SubscriptBox["p", "3"], "\[CenterDot]", 
    SubscriptBox["S", "0"], "\[CenterDot]", 
    SubscriptBox["F", "3"], "\[CenterDot]", 
    SubscriptBox["F", "2"], "\[CenterDot]", 
    SubscriptBox["F", "1"], "\[CenterDot]", 
    SubscriptBox["v", "1"]}], 
   RowBox[{
    SubscriptBox["p", "1"], "\[CenterDot]", 
    SubscriptBox["v", "1"]}]], "-", 
  FractionBox[
   RowBox[{
    RowBox[{
     SubscriptBox["p", "1"], "\[CenterDot]", 
     SubscriptBox["p", "2"]}], " ", 
    RowBox[{
     SubscriptBox["v", "1"], "\[CenterDot]", 
     SubscriptBox["F", "2"], "\[CenterDot]", 
     SubscriptBox["S", "0"], "\[CenterDot]", 
     SubscriptBox["F", "1"], "\[CenterDot]", 
     SubscriptBox["F", "3"], "\[CenterDot]", 
     SubscriptBox["v", "1"]}]}], 
   RowBox[{
    RowBox[{
     SubscriptBox["p", "1"], "\[CenterDot]", 
     SubscriptBox["v", "1"]}], " ", 
    RowBox[{"(", 
     RowBox[{
      RowBox[{
       SubscriptBox["p", "1"], "\[CenterDot]", 
       SubscriptBox["v", "1"]}], "+", 
      RowBox[{
       SubscriptBox["p", "2"], "\[CenterDot]", 
       SubscriptBox["v", "1"]}]}], ")"}]}]]}]], "Output",
 CellChangeTimes->{
  3.878096067467098*^9, {3.878096905251871*^9, 3.8780969362442007`*^9}, {
   3.878097382044546*^9, 3.878097396682747*^9}, 3.878616426034965*^9, 
   3.878857184498516*^9},
 CellLabel->
  "Out[249]=",ExpressionUUID->"7775e966-bcf1-4da7-b327-d37aa31a3c38"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{
     RowBox[{
      RowBox[{"numAnsatz", "/.", "sols"}], "/.", "solsvp1"}], "/.", 
     "solsvp2"}], "//", 
    RowBox[{
     RowBox[{"Cases", "[", 
      RowBox[{"#", ",", 
       RowBox[{"c", "[", "__", "]"}], ",", 
       RowBox[{"{", 
        RowBox[{"0", ",", "\[Infinity]"}], "}"}]}], "]"}], "&"}]}], "//", 
   "Union"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{"%", "//", "Length"}]}], "Input",
 CellChangeTimes->{{3.878097740252308*^9, 3.8780977941772013`*^9}},
 CellLabel->
  "In[250]:=",ExpressionUUID->"b1392e9f-0802-4547-8291-d9d836b6a531"],

Cell[BoxData["420"], "Output",
 CellChangeTimes->{
  3.87809706529457*^9, {3.878097742428525*^9, 3.878097794716721*^9}, 
   3.8786164261959343`*^9, 3.8788571846537867`*^9},
 CellLabel->
  "Out[251]=",ExpressionUUID->"1d164981-b2bc-44d5-ab2a-e7ca67d32dd5"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{
     RowBox[{
      RowBox[{"numAnsatz", "/.", "sols"}], "/.", "solsvp1"}], "/.", 
     "solsvp2"}], "/.", 
    RowBox[{
     RowBox[{"c", "[", "__", "]"}], ":>", "0"}]}], "/.", "nicevs"}], "//.", 
  "nice"}]], "Input",
 CellChangeTimes->{{3.878096992646886*^9, 3.8780970253597383`*^9}, {
  3.878097865895237*^9, 3.878097895808736*^9}},
 CellLabel->
  "In[252]:=",ExpressionUUID->"8e1a2554-41a4-4f32-a8dc-9e90074da6ee"],

Cell[BoxData[
 RowBox[{
  FractionBox[
   RowBox[{
    RowBox[{"v", "\[CenterDot]", 
     SubscriptBox["F", "1"], "\[CenterDot]", 
     SubscriptBox["F", "3"], "\[CenterDot]", "v"}], " ", 
    RowBox[{
     SubscriptBox["p", "1"], "\[CenterDot]", 
     SubscriptBox["F", "2"], "\[CenterDot]", "S", "\[CenterDot]", 
     SubscriptBox["p", "2"]}]}], 
   RowBox[{
    RowBox[{"v", "\[CenterDot]", 
     SubscriptBox["p", "1"]}], " ", 
    RowBox[{"(", 
     RowBox[{
      RowBox[{"v", "\[CenterDot]", 
       SubscriptBox["p", "1"]}], "+", 
      RowBox[{"v", "\[CenterDot]", 
       SubscriptBox["p", "2"]}]}], ")"}]}]], "+", 
  FractionBox[
   RowBox[{
    RowBox[{"v", "\[CenterDot]", 
     SubscriptBox["F", "1"], "\[CenterDot]", 
     SubscriptBox["F", "3"], "\[CenterDot]", "v"}], " ", 
    RowBox[{
     SubscriptBox["p", "1"], "\[CenterDot]", 
     SubscriptBox["F", "2"], "\[CenterDot]", "S", "\[CenterDot]", 
     SubscriptBox["p", "2"]}]}], 
   RowBox[{
    RowBox[{"v", "\[CenterDot]", 
     SubscriptBox["p", "1"]}], " ", 
    RowBox[{"(", 
     RowBox[{
      RowBox[{"v", "\[CenterDot]", 
       SubscriptBox["p", "1"]}], "+", 
      RowBox[{"v", "\[CenterDot]", 
       SubscriptBox["p", "3"]}]}], ")"}]}]], "+", 
  FractionBox[
   RowBox[{
    RowBox[{"v", "\[CenterDot]", 
     SubscriptBox["F", "1"], "\[CenterDot]", 
     SubscriptBox["F", "2"], "\[CenterDot]", "v"}], " ", 
    RowBox[{
     SubscriptBox["p", "1"], "\[CenterDot]", 
     SubscriptBox["F", "3"], "\[CenterDot]", "S", "\[CenterDot]", 
     SubscriptBox["p", "3"]}]}], 
   RowBox[{
    RowBox[{"v", "\[CenterDot]", 
     SubscriptBox["p", "1"]}], " ", 
    RowBox[{"(", 
     RowBox[{
      RowBox[{"v", "\[CenterDot]", 
       SubscriptBox["p", "1"]}], "+", 
      RowBox[{"v", "\[CenterDot]", 
       SubscriptBox["p", "2"]}]}], ")"}]}]], "+", 
  FractionBox[
   RowBox[{
    RowBox[{"v", "\[CenterDot]", 
     SubscriptBox["F", "1"], "\[CenterDot]", 
     SubscriptBox["F", "2"], "\[CenterDot]", "v"}], " ", 
    RowBox[{
     SubscriptBox["p", "1"], "\[CenterDot]", 
     SubscriptBox["F", "3"], "\[CenterDot]", "S", "\[CenterDot]", 
     SubscriptBox["p", "3"]}]}], 
   RowBox[{
    RowBox[{"v", "\[CenterDot]", 
     SubscriptBox["p", "1"]}], " ", 
    RowBox[{"(", 
     RowBox[{
      RowBox[{"v", "\[CenterDot]", 
       SubscriptBox["p", "1"]}], "+", 
      RowBox[{"v", "\[CenterDot]", 
       SubscriptBox["p", "3"]}]}], ")"}]}]], "+", 
  FractionBox[
   RowBox[{
    RowBox[{
     SubscriptBox["p", "1"], "\[CenterDot]", "S", "\[CenterDot]", 
     SubscriptBox["F", "2"], "\[CenterDot]", "v"}], " ", 
    RowBox[{
     SubscriptBox["p", "2"], "\[CenterDot]", 
     SubscriptBox["F", "1"], "\[CenterDot]", 
     SubscriptBox["F", "3"], "\[CenterDot]", "v"}]}], 
   RowBox[{
    RowBox[{"v", "\[CenterDot]", 
     SubscriptBox["p", "1"]}], " ", 
    RowBox[{"(", 
     RowBox[{
      RowBox[{"v", "\[CenterDot]", 
       SubscriptBox["p", "1"]}], "+", 
      RowBox[{"v", "\[CenterDot]", 
       SubscriptBox["p", "2"]}]}], ")"}]}]], "+", 
  FractionBox[
   RowBox[{
    RowBox[{"v", "\[CenterDot]", 
     SubscriptBox["F", "1"], "\[CenterDot]", 
     SubscriptBox["F", "2"], "\[CenterDot]", "v"}], " ", 
    RowBox[{
     SubscriptBox["p", "2"], "\[CenterDot]", 
     SubscriptBox["F", "3"], "\[CenterDot]", "S", "\[CenterDot]", 
     SubscriptBox["p", "3"]}]}], 
   RowBox[{
    RowBox[{"v", "\[CenterDot]", 
     SubscriptBox["p", "1"]}], " ", 
    RowBox[{"(", 
     RowBox[{
      RowBox[{"v", "\[CenterDot]", 
       SubscriptBox["p", "1"]}], "+", 
      RowBox[{"v", "\[CenterDot]", 
       SubscriptBox["p", "2"]}]}], ")"}]}]], "-", 
  FractionBox[
   RowBox[{
    RowBox[{
     SubscriptBox["p", "1"], "\[CenterDot]", "S", "\[CenterDot]", 
     SubscriptBox["p", "3"]}], " ", 
    RowBox[{"v", "\[CenterDot]", 
     SubscriptBox["F", "2"], "\[CenterDot]", 
     SubscriptBox["F", "1"], "\[CenterDot]", 
     SubscriptBox["F", "3"], "\[CenterDot]", "v"}]}], 
   RowBox[{
    RowBox[{"v", "\[CenterDot]", 
     SubscriptBox["p", "1"]}], " ", 
    RowBox[{"(", 
     RowBox[{
      RowBox[{"v", "\[CenterDot]", 
       SubscriptBox["p", "1"]}], "+", 
      RowBox[{"v", "\[CenterDot]", 
       SubscriptBox["p", "3"]}]}], ")"}]}]], "-", 
  FractionBox[
   RowBox[{
    RowBox[{
     SubscriptBox["p", "1"], "\[CenterDot]", 
     SubscriptBox["F", "3"], "\[CenterDot]", "v"}], " ", 
    RowBox[{
     SubscriptBox["p", "1"], "\[CenterDot]", "S", "\[CenterDot]", 
     SubscriptBox["F", "1"], "\[CenterDot]", 
     SubscriptBox["F", "2"], "\[CenterDot]", "v"}]}], 
   RowBox[{
    RowBox[{"v", "\[CenterDot]", 
     SubscriptBox["p", "1"]}], " ", 
    RowBox[{"(", 
     RowBox[{
      RowBox[{"v", "\[CenterDot]", 
       SubscriptBox["p", "1"]}], "+", 
      RowBox[{"v", "\[CenterDot]", 
       SubscriptBox["p", "2"]}]}], ")"}]}]], "-", 
  FractionBox[
   RowBox[{
    RowBox[{
     SubscriptBox["p", "1"], "\[CenterDot]", 
     SubscriptBox["F", "3"], "\[CenterDot]", "v"}], " ", 
    RowBox[{
     SubscriptBox["p", "1"], "\[CenterDot]", "S", "\[CenterDot]", 
     SubscriptBox["F", "1"], "\[CenterDot]", 
     SubscriptBox["F", "2"], "\[CenterDot]", "v"}]}], 
   RowBox[{
    RowBox[{"v", "\[CenterDot]", 
     SubscriptBox["p", "1"]}], " ", 
    RowBox[{"(", 
     RowBox[{
      RowBox[{"v", "\[CenterDot]", 
       SubscriptBox["p", "1"]}], "+", 
      RowBox[{"v", "\[CenterDot]", 
       SubscriptBox["p", "3"]}]}], ")"}]}]], "-", 
  FractionBox[
   RowBox[{
    RowBox[{
     SubscriptBox["p", "2"], "\[CenterDot]", 
     SubscriptBox["F", "3"], "\[CenterDot]", "v"}], " ", 
    RowBox[{
     SubscriptBox["p", "1"], "\[CenterDot]", "S", "\[CenterDot]", 
     SubscriptBox["F", "1"], "\[CenterDot]", 
     SubscriptBox["F", "2"], "\[CenterDot]", "v"}]}], 
   RowBox[{
    RowBox[{"v", "\[CenterDot]", 
     SubscriptBox["p", "1"]}], " ", 
    RowBox[{"(", 
     RowBox[{
      RowBox[{"v", "\[CenterDot]", 
       SubscriptBox["p", "1"]}], "+", 
      RowBox[{"v", "\[CenterDot]", 
       SubscriptBox["p", "2"]}]}], ")"}]}]], "-", 
  FractionBox[
   RowBox[{
    RowBox[{
     SubscriptBox["p", "1"], "\[CenterDot]", 
     SubscriptBox["F", "3"], "\[CenterDot]", "v"}], " ", 
    RowBox[{
     SubscriptBox["p", "2"], "\[CenterDot]", "S", "\[CenterDot]", 
     SubscriptBox["F", "1"], "\[CenterDot]", 
     SubscriptBox["F", "2"], "\[CenterDot]", "v"}]}], 
   RowBox[{
    RowBox[{"v", "\[CenterDot]", 
     SubscriptBox["p", "1"]}], " ", 
    RowBox[{"(", 
     RowBox[{
      RowBox[{"v", "\[CenterDot]", 
       SubscriptBox["p", "1"]}], "+", 
      RowBox[{"v", "\[CenterDot]", 
       SubscriptBox["p", "2"]}]}], ")"}]}]], "-", 
  FractionBox[
   RowBox[{
    RowBox[{
     SubscriptBox["p", "2"], "\[CenterDot]", 
     SubscriptBox["F", "3"], "\[CenterDot]", "v"}], " ", 
    RowBox[{
     SubscriptBox["p", "2"], "\[CenterDot]", "S", "\[CenterDot]", 
     SubscriptBox["F", "2"], "\[CenterDot]", 
     SubscriptBox["F", "1"], "\[CenterDot]", "v"}]}], 
   RowBox[{
    RowBox[{"v", "\[CenterDot]", 
     SubscriptBox["p", "1"]}], " ", 
    RowBox[{"(", 
     RowBox[{
      RowBox[{"v", "\[CenterDot]", 
       SubscriptBox["p", "1"]}], "+", 
      RowBox[{"v", "\[CenterDot]", 
       SubscriptBox["p", "2"]}]}], ")"}]}]], "-", 
  FractionBox[
   RowBox[{
    RowBox[{
     SubscriptBox["p", "1"], "\[CenterDot]", 
     SubscriptBox["F", "3"], "\[CenterDot]", "v"}], " ", 
    RowBox[{
     SubscriptBox["p", "3"], "\[CenterDot]", "S", "\[CenterDot]", 
     SubscriptBox["F", "1"], "\[CenterDot]", 
     SubscriptBox["F", "2"], "\[CenterDot]", "v"}]}], 
   RowBox[{
    RowBox[{"v", "\[CenterDot]", 
     SubscriptBox["p", "1"]}], " ", 
    RowBox[{"(", 
     RowBox[{
      RowBox[{"v", "\[CenterDot]", 
       SubscriptBox["p", "1"]}], "+", 
      RowBox[{"v", "\[CenterDot]", 
       SubscriptBox["p", "3"]}]}], ")"}]}]], "+", 
  FractionBox[
   RowBox[{
    RowBox[{
     SubscriptBox["p", "1"], "\[CenterDot]", 
     SubscriptBox["F", "2"], "\[CenterDot]", "v"}], " ", 
    RowBox[{
     SubscriptBox["p", "3"], "\[CenterDot]", 
     SubscriptBox["F", "1"], "\[CenterDot]", "S", "\[CenterDot]", 
     SubscriptBox["F", "3"], "\[CenterDot]", "v"}]}], 
   RowBox[{
    RowBox[{"v", "\[CenterDot]", 
     SubscriptBox["p", "1"]}], " ", 
    RowBox[{"(", 
     RowBox[{
      RowBox[{"v", "\[CenterDot]", 
       SubscriptBox["p", "1"]}], "+", 
      RowBox[{"v", "\[CenterDot]", 
       SubscriptBox["p", "3"]}]}], ")"}]}]], "-", 
  FractionBox[
   RowBox[{
    RowBox[{
     SubscriptBox["p", "1"], "\[CenterDot]", 
     SubscriptBox["p", "2"]}], " ", 
    RowBox[{"v", "\[CenterDot]", 
     SubscriptBox["F", "2"], "\[CenterDot]", "S", "\[CenterDot]", 
     SubscriptBox["F", "1"], "\[CenterDot]", 
     SubscriptBox["F", "3"], "\[CenterDot]", "v"}]}], 
   RowBox[{
    RowBox[{"v", "\[CenterDot]", 
     SubscriptBox["p", "1"]}], " ", 
    RowBox[{"(", 
     RowBox[{
      RowBox[{"v", "\[CenterDot]", 
       SubscriptBox["p", "1"]}], "+", 
      RowBox[{"v", "\[CenterDot]", 
       SubscriptBox["p", "2"]}]}], ")"}]}]], "+", 
  FractionBox[
   RowBox[{
    SubscriptBox["p", "1"], "\[CenterDot]", "S", "\[CenterDot]", 
    SubscriptBox["F", "1"], "\[CenterDot]", 
    SubscriptBox["F", "2"], "\[CenterDot]", 
    SubscriptBox["F", "3"], "\[CenterDot]", "v"}], 
   RowBox[{"v", "\[CenterDot]", 
    SubscriptBox["p", "1"]}]], "-", 
  FractionBox[
   RowBox[{
    SubscriptBox["p", "1"], "\[CenterDot]", "S", "\[CenterDot]", 
    SubscriptBox["F", "2"], "\[CenterDot]", 
    SubscriptBox["F", "1"], "\[CenterDot]", 
    SubscriptBox["F", "3"], "\[CenterDot]", "v"}], 
   RowBox[{"v", "\[CenterDot]", 
    SubscriptBox["p", "1"]}]], "-", 
  FractionBox[
   RowBox[{
    SubscriptBox["p", "1"], "\[CenterDot]", "S", "\[CenterDot]", 
    SubscriptBox["F", "3"], "\[CenterDot]", 
    SubscriptBox["F", "1"], "\[CenterDot]", 
    SubscriptBox["F", "2"], "\[CenterDot]", "v"}], 
   RowBox[{"v", "\[CenterDot]", 
    SubscriptBox["p", "1"]}]], "+", 
  FractionBox[
   RowBox[{
    SubscriptBox["p", "1"], "\[CenterDot]", 
    SubscriptBox["F", "2"], "\[CenterDot]", "S", "\[CenterDot]", 
    SubscriptBox["F", "1"], "\[CenterDot]", 
    SubscriptBox["F", "3"], "\[CenterDot]", "v"}], 
   RowBox[{"v", "\[CenterDot]", 
    SubscriptBox["p", "1"]}]], "+", 
  FractionBox[
   RowBox[{
    SubscriptBox["p", "1"], "\[CenterDot]", 
    SubscriptBox["F", "3"], "\[CenterDot]", "S", "\[CenterDot]", 
    SubscriptBox["F", "1"], "\[CenterDot]", 
    SubscriptBox["F", "2"], "\[CenterDot]", "v"}], 
   RowBox[{"v", "\[CenterDot]", 
    SubscriptBox["p", "1"]}]], "+", 
  FractionBox[
   RowBox[{
    SubscriptBox["p", "2"], "\[CenterDot]", "S", "\[CenterDot]", 
    SubscriptBox["F", "1"], "\[CenterDot]", 
    SubscriptBox["F", "2"], "\[CenterDot]", 
    SubscriptBox["F", "3"], "\[CenterDot]", "v"}], 
   RowBox[{"v", "\[CenterDot]", 
    SubscriptBox["p", "1"]}]], "-", 
  FractionBox[
   RowBox[{
    RowBox[{"v", "\[CenterDot]", 
     SubscriptBox["p", "2"]}], " ", 
    RowBox[{
     SubscriptBox["p", "2"], "\[CenterDot]", "S", "\[CenterDot]", 
     SubscriptBox["F", "1"], "\[CenterDot]", 
     SubscriptBox["F", "2"], "\[CenterDot]", 
     SubscriptBox["F", "3"], "\[CenterDot]", "v"}]}], 
   RowBox[{
    RowBox[{"v", "\[CenterDot]", 
     SubscriptBox["p", "1"]}], " ", 
    RowBox[{"(", 
     RowBox[{
      RowBox[{"v", "\[CenterDot]", 
       SubscriptBox["p", "1"]}], "+", 
      RowBox[{"v", "\[CenterDot]", 
       SubscriptBox["p", "2"]}]}], ")"}]}]], "-", 
  FractionBox[
   RowBox[{
    SubscriptBox["p", "2"], "\[CenterDot]", "S", "\[CenterDot]", 
    SubscriptBox["F", "2"], "\[CenterDot]", 
    SubscriptBox["F", "1"], "\[CenterDot]", 
    SubscriptBox["F", "3"], "\[CenterDot]", "v"}], 
   RowBox[{"v", "\[CenterDot]", 
    SubscriptBox["p", "1"]}]], "+", 
  FractionBox[
   RowBox[{
    RowBox[{"v", "\[CenterDot]", 
     SubscriptBox["p", "2"]}], " ", 
    RowBox[{
     SubscriptBox["p", "2"], "\[CenterDot]", "S", "\[CenterDot]", 
     SubscriptBox["F", "2"], "\[CenterDot]", 
     SubscriptBox["F", "1"], "\[CenterDot]", 
     SubscriptBox["F", "3"], "\[CenterDot]", "v"}]}], 
   RowBox[{
    RowBox[{"v", "\[CenterDot]", 
     SubscriptBox["p", "1"]}], " ", 
    RowBox[{"(", 
     RowBox[{
      RowBox[{"v", "\[CenterDot]", 
       SubscriptBox["p", "1"]}], "+", 
      RowBox[{"v", "\[CenterDot]", 
       SubscriptBox["p", "2"]}]}], ")"}]}]], "-", 
  FractionBox[
   RowBox[{
    SubscriptBox["p", "2"], "\[CenterDot]", "S", "\[CenterDot]", 
    SubscriptBox["F", "3"], "\[CenterDot]", 
    SubscriptBox["F", "1"], "\[CenterDot]", 
    SubscriptBox["F", "2"], "\[CenterDot]", "v"}], 
   RowBox[{"v", "\[CenterDot]", 
    SubscriptBox["p", "1"]}]], "-", 
  FractionBox[
   RowBox[{
    SubscriptBox["p", "2"], "\[CenterDot]", "S", "\[CenterDot]", 
    SubscriptBox["F", "3"], "\[CenterDot]", 
    SubscriptBox["F", "2"], "\[CenterDot]", 
    SubscriptBox["F", "1"], "\[CenterDot]", "v"}], 
   RowBox[{"v", "\[CenterDot]", 
    SubscriptBox["p", "1"]}]], "-", 
  FractionBox[
   RowBox[{
    SubscriptBox["p", "2"], "\[CenterDot]", 
    SubscriptBox["F", "1"], "\[CenterDot]", "S", "\[CenterDot]", 
    SubscriptBox["F", "2"], "\[CenterDot]", 
    SubscriptBox["F", "3"], "\[CenterDot]", "v"}], 
   RowBox[{"v", "\[CenterDot]", 
    SubscriptBox["p", "1"]}]], "+", 
  FractionBox[
   RowBox[{
    RowBox[{"v", "\[CenterDot]", 
     SubscriptBox["p", "2"]}], " ", 
    RowBox[{
     SubscriptBox["p", "2"], "\[CenterDot]", 
     SubscriptBox["F", "1"], "\[CenterDot]", "S", "\[CenterDot]", 
     SubscriptBox["F", "2"], "\[CenterDot]", 
     SubscriptBox["F", "3"], "\[CenterDot]", "v"}]}], 
   RowBox[{
    RowBox[{"v", "\[CenterDot]", 
     SubscriptBox["p", "1"]}], " ", 
    RowBox[{"(", 
     RowBox[{
      RowBox[{"v", "\[CenterDot]", 
       SubscriptBox["p", "1"]}], "+", 
      RowBox[{"v", "\[CenterDot]", 
       SubscriptBox["p", "2"]}]}], ")"}]}]], "+", 
  FractionBox[
   RowBox[{
    SubscriptBox["p", "2"], "\[CenterDot]", 
    SubscriptBox["F", "1"], "\[CenterDot]", "S", "\[CenterDot]", 
    SubscriptBox["F", "3"], "\[CenterDot]", 
    SubscriptBox["F", "2"], "\[CenterDot]", "v"}], 
   RowBox[{"v", "\[CenterDot]", 
    SubscriptBox["p", "1"]}]], "-", 
  FractionBox[
   RowBox[{
    SubscriptBox["p", "2"], "\[CenterDot]", 
    SubscriptBox["F", "1"], "\[CenterDot]", 
    SubscriptBox["F", "3"], "\[CenterDot]", "S", "\[CenterDot]", 
    SubscriptBox["F", "2"], "\[CenterDot]", "v"}], 
   RowBox[{"v", "\[CenterDot]", 
    SubscriptBox["p", "1"]}]], "+", 
  FractionBox[
   RowBox[{
    SubscriptBox["p", "2"], "\[CenterDot]", 
    SubscriptBox["F", "3"], "\[CenterDot]", "S", "\[CenterDot]", 
    SubscriptBox["F", "1"], "\[CenterDot]", 
    SubscriptBox["F", "2"], "\[CenterDot]", "v"}], 
   RowBox[{"v", "\[CenterDot]", 
    SubscriptBox["p", "1"]}]], "+", 
  FractionBox[
   RowBox[{
    SubscriptBox["p", "2"], "\[CenterDot]", 
    SubscriptBox["F", "3"], "\[CenterDot]", "S", "\[CenterDot]", 
    SubscriptBox["F", "2"], "\[CenterDot]", 
    SubscriptBox["F", "1"], "\[CenterDot]", "v"}], 
   RowBox[{"v", "\[CenterDot]", 
    SubscriptBox["p", "1"]}]], "+", 
  FractionBox[
   RowBox[{
    SubscriptBox["p", "3"], "\[CenterDot]", "S", "\[CenterDot]", 
    SubscriptBox["F", "1"], "\[CenterDot]", 
    SubscriptBox["F", "2"], "\[CenterDot]", 
    SubscriptBox["F", "3"], "\[CenterDot]", "v"}], 
   RowBox[{"v", "\[CenterDot]", 
    SubscriptBox["p", "1"]}]], "-", 
  FractionBox[
   RowBox[{
    SubscriptBox["p", "3"], "\[CenterDot]", "S", "\[CenterDot]", 
    SubscriptBox["F", "2"], "\[CenterDot]", 
    SubscriptBox["F", "1"], "\[CenterDot]", 
    SubscriptBox["F", "3"], "\[CenterDot]", "v"}], 
   RowBox[{"v", "\[CenterDot]", 
    SubscriptBox["p", "1"]}]], "-", 
  FractionBox[
   RowBox[{
    SubscriptBox["p", "3"], "\[CenterDot]", "S", "\[CenterDot]", 
    SubscriptBox["F", "3"], "\[CenterDot]", 
    SubscriptBox["F", "1"], "\[CenterDot]", 
    SubscriptBox["F", "2"], "\[CenterDot]", "v"}], 
   RowBox[{"v", "\[CenterDot]", 
    SubscriptBox["p", "1"]}]], "+", 
  FractionBox[
   RowBox[{
    RowBox[{"v", "\[CenterDot]", 
     SubscriptBox["p", "3"]}], " ", 
    RowBox[{
     SubscriptBox["p", "3"], "\[CenterDot]", "S", "\[CenterDot]", 
     SubscriptBox["F", "3"], "\[CenterDot]", 
     SubscriptBox["F", "1"], "\[CenterDot]", 
     SubscriptBox["F", "2"], "\[CenterDot]", "v"}]}], 
   RowBox[{
    RowBox[{"v", "\[CenterDot]", 
     SubscriptBox["p", "1"]}], " ", 
    RowBox[{"(", 
     RowBox[{
      RowBox[{"v", "\[CenterDot]", 
       SubscriptBox["p", "1"]}], "+", 
      RowBox[{"v", "\[CenterDot]", 
       SubscriptBox["p", "3"]}]}], ")"}]}]], "-", 
  FractionBox[
   RowBox[{
    SubscriptBox["p", "3"], "\[CenterDot]", "S", "\[CenterDot]", 
    SubscriptBox["F", "3"], "\[CenterDot]", 
    SubscriptBox["F", "2"], "\[CenterDot]", 
    SubscriptBox["F", "1"], "\[CenterDot]", "v"}], 
   RowBox[{"v", "\[CenterDot]", 
    SubscriptBox["p", "1"]}]], "-", 
  FractionBox[
   RowBox[{
    SubscriptBox["p", "3"], "\[CenterDot]", 
    SubscriptBox["F", "1"], "\[CenterDot]", 
    SubscriptBox["F", "2"], "\[CenterDot]", "S", "\[CenterDot]", 
    SubscriptBox["F", "3"], "\[CenterDot]", "v"}], 
   RowBox[{"v", "\[CenterDot]", 
    SubscriptBox["p", "1"]}]], "+", 
  FractionBox[
   RowBox[{
    SubscriptBox["p", "3"], "\[CenterDot]", 
    SubscriptBox["F", "2"], "\[CenterDot]", 
    SubscriptBox["F", "1"], "\[CenterDot]", "S", "\[CenterDot]", 
    SubscriptBox["F", "3"], "\[CenterDot]", "v"}], 
   RowBox[{"v", "\[CenterDot]", 
    SubscriptBox["p", "1"]}]]}]], "Output",
 CellChangeTimes->{{3.878096994542691*^9, 3.878097026032852*^9}, {
   3.8780978736826763`*^9, 3.878097896716341*^9}, 3.878616426376233*^9, 
   3.878857184829026*^9},
 CellLabel->
  "Out[252]=",ExpressionUUID->"1265f1b1-8f2b-409e-9a8e-f20511a32363"]
}, Open  ]]
}, Open  ]]
}, Closed]],

Cell[CellGroupData[{

Cell["Example S Five point Fewer Parameter", "Section",
 CellChangeTimes->{{3.877008171032135*^9, 3.877008177039516*^9}, {
  3.8773818494951763`*^9, 3.877381857475391*^9}, {3.878020608795433*^9, 
  3.87802061200184*^9}, {3.878106086500737*^9, 
  3.878106090914515*^9}},ExpressionUUID->"59b54bc3-97df-45d6-bc28-\
81e428b29101"],

Cell[CellGroupData[{

Cell["Setup ansatz", "Subsection",
 CellChangeTimes->{{3.877386203620414*^9, 
  3.877386209613765*^9}},ExpressionUUID->"46d3ea8b-05f7-4416-b0bc-\
fd29a7778142"],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{
  RowBox[{"n", "=", "5"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"vponshell", "=", 
   RowBox[{
    RowBox[{"vonshell", "[", 
     RowBox[{
      RowBox[{"n", "-", "1"}], ",", "1"}], "]"}], "/.", 
    RowBox[{"v", "->", 
     RowBox[{"v", "[", "1", "]"}]}]}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{"gponshell", "=", 
  RowBox[{
   RowBox[{"onshell", "[", 
    RowBox[{"n", "-", "1"}], "]"}], "/.", 
   RowBox[{
    RowBox[{"s", "[", 
     RowBox[{"i_", ",", "j_"}], "]"}], ":>", 
    RowBox[{"dot", "[", 
     RowBox[{
      RowBox[{"p", "[", "i", "]"}], ",", 
      RowBox[{"p", "[", "j", "]"}]}], "]"}]}]}]}]}], "Input",
 CellChangeTimes->{{3.878020618673658*^9, 3.878020625406555*^9}, {
   3.878020685245474*^9, 3.8780206881234617`*^9}, 3.878021076476811*^9, {
   3.878022447789905*^9, 3.8780224652203074`*^9}, {3.878024579094555*^9, 
   3.87802460824821*^9}},
 CellLabel->
  "In[253]:=",ExpressionUUID->"63883844-e4d0-4419-995f-f86af78cb92b"],

Cell[BoxData[
 RowBox[{
  RowBox[{"dot", "[", 
   RowBox[{
    RowBox[{"p", "[", "2", "]"}], ",", 
    RowBox[{"p", "[", "3", "]"}]}], "]"}], "\[Rule]", 
  RowBox[{
   RowBox[{"-", 
    RowBox[{"dot", "[", 
     RowBox[{
      RowBox[{"p", "[", "1", "]"}], ",", 
      RowBox[{"p", "[", "2", "]"}]}], "]"}]}], "-", 
   RowBox[{"dot", "[", 
    RowBox[{
     RowBox[{"p", "[", "1", "]"}], ",", 
     RowBox[{"p", "[", "3", "]"}]}], "]"}]}]}]], "Output",
 CellChangeTimes->{{3.878024603364303*^9, 3.8780246086311693`*^9}, 
   3.8780958347602053`*^9, 3.8781061044812183`*^9, 3.8781115859252377`*^9, 
   3.878616426409202*^9, 3.878857184848578*^9},
 CellLabel->
  "Out[255]=",ExpressionUUID->"b2044462-eb78-4775-8fe6-f1e89678524b"]
}, Open  ]],

Cell[BoxData[{
 RowBox[{
  RowBox[{"denOrder", "=", "1"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"monofs1", "=", 
   RowBox[{"monoFS", "[", 
    RowBox[{"denOrder", ",", 
     RowBox[{"n", "-", "2"}]}], "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"denOrder", "=", "2"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"monofs2", "=", 
   RowBox[{"monoFS", "[", 
    RowBox[{"denOrder", ",", 
     RowBox[{"n", "-", "2"}]}], "]"}]}], ";"}]}], "Input",
 CellChangeTimes->{{3.877381049405899*^9, 3.877381116483204*^9}, {
  3.877381244223319*^9, 3.877381284761427*^9}, {3.877381353256666*^9, 
  3.877381353488029*^9}, {3.87738186344316*^9, 3.877381863777376*^9}, {
  3.8773822047453117`*^9, 3.877382204987795*^9}, {3.8773825485753727`*^9, 
  3.877382548830839*^9}, {3.877382654557598*^9, 3.877382674685717*^9}, {
  3.878016251644945*^9, 3.87801627282722*^9}, {3.878018811842737*^9, 
  3.878018821618462*^9}, {3.878019111987747*^9, 3.8780191881088953`*^9}, {
  3.8780192243067636`*^9, 3.878019263820836*^9}, {3.8780196953188877`*^9, 
  3.8780197336534443`*^9}, {3.878028860196001*^9, 3.878028905573225*^9}},
 CellLabel->
  "In[256]:=",ExpressionUUID->"76d539e4-604c-4249-bad1-2503c5290e11"],

Cell[BoxData[{
 RowBox[{
  RowBox[{"monofs1", "=", 
   RowBox[{
    RowBox[{
     RowBox[{"(", 
      RowBox[{"List", "@@", 
       RowBox[{"(", 
        RowBox[{
         RowBox[{
          RowBox[{"monofs1", "/.", "vponshell"}], "//", "Total"}], "//", 
         "Expand"}], ")"}]}], ")"}], "/.", 
     RowBox[{
      RowBox[{"a_", " ", "b_"}], ":>", " ", 
      RowBox[{"b", "/;", 
       RowBox[{"NumberQ", "[", "a", "]"}]}]}]}], "//", "Union"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"monofs2", "=", 
   RowBox[{
    RowBox[{
     RowBox[{"(", 
      RowBox[{"List", "@@", 
       RowBox[{"(", 
        RowBox[{
         RowBox[{
          RowBox[{"monofs2", "/.", "vponshell"}], "//", "Total"}], "//", 
         "Expand"}], ")"}]}], ")"}], "/.", 
     RowBox[{
      RowBox[{"a_", " ", "b_"}], ":>", " ", 
      RowBox[{"b", "/;", 
       RowBox[{"NumberQ", "[", "a", "]"}]}]}]}], "//", "Union"}]}], 
  ";"}]}], "Input",
 CellChangeTimes->{{3.878106131993834*^9, 3.8781061481204767`*^9}},
 CellLabel->
  "In[260]:=",ExpressionUUID->"d762502d-750c-4a1a-a501-5e02e614f8af"],

Cell[BoxData[
 RowBox[{
  RowBox[{"numAnsatz", "=", 
   RowBox[{
    RowBox[{"(", 
     RowBox[{
      FractionBox[
       RowBox[{
        RowBox[{
         RowBox[{"(", 
          RowBox[{"c", "/@", 
           RowBox[{"Range", "[", 
            RowBox[{"Length", "@", "monofs2"}], "]"}]}], ")"}], ".", 
         "monofs2"}], "/.", 
        RowBox[{
         RowBox[{"c", "[", "i_", "]"}], ":>", 
         RowBox[{"c", "[", 
          RowBox[{"1", ",", "i"}], "]"}]}]}], 
       RowBox[{
        RowBox[{"dot", "[", 
         RowBox[{
          RowBox[{"v", "[", "1", "]"}], ",", 
          RowBox[{"p", "[", "1", "]"}]}], "]"}], 
        RowBox[{"dot", "[", 
         RowBox[{
          RowBox[{"v", "[", "1", "]"}], ",", 
          RowBox[{
           RowBox[{"p", "[", "1", "]"}], "+", 
           RowBox[{"p", "[", "2", "]"}]}]}], "]"}]}]], "+", 
      FractionBox[
       RowBox[{
        RowBox[{
         RowBox[{"(", 
          RowBox[{"c", "/@", 
           RowBox[{"Range", "[", 
            RowBox[{"Length", "@", "monofs2"}], "]"}]}], ")"}], ".", 
         "monofs2"}], "/.", 
        RowBox[{
         RowBox[{"c", "[", "i_", "]"}], ":>", 
         RowBox[{"c", "[", 
          RowBox[{"2", ",", "i"}], "]"}]}]}], 
       RowBox[{
        RowBox[{"dot", "[", 
         RowBox[{
          RowBox[{"v", "[", "1", "]"}], ",", 
          RowBox[{"p", "[", "1", "]"}]}], "]"}], 
        RowBox[{"dot", "[", 
         RowBox[{
          RowBox[{"v", "[", "1", "]"}], ",", 
          RowBox[{
           RowBox[{"p", "[", "1", "]"}], "+", 
           RowBox[{"p", "[", "3", "]"}]}]}], "]"}]}]], "+", 
      FractionBox[
       RowBox[{
        RowBox[{
         RowBox[{"(", 
          RowBox[{"c", "/@", 
           RowBox[{"Range", "[", 
            RowBox[{"Length", "@", "monofs1"}], "]"}]}], ")"}], ".", 
         "monofs1"}], "/.", 
        RowBox[{
         RowBox[{"c", "[", "i_", "]"}], ":>", 
         RowBox[{"c", "[", 
          RowBox[{"3", ",", "i"}], "]"}]}]}], 
       RowBox[{"dot", "[", 
        RowBox[{
         RowBox[{"v", "[", "1", "]"}], ",", 
         RowBox[{"p", "[", "1", "]"}]}], "]"}]]}], ")"}], "//", "Expand"}]}], 
  ";"}]], "Input",
 CellChangeTimes->{{3.878019818828724*^9, 3.8780199018739433`*^9}, {
  3.878019938561898*^9, 3.878020036527034*^9}, {3.8780201912905703`*^9, 
  3.878020210990015*^9}, {3.87802091215549*^9, 3.8780209153502007`*^9}, {
  3.8780300130461073`*^9, 3.8780300429155807`*^9}, {3.8780319820804033`*^9, 
  3.87803198404319*^9}, {3.878032548017993*^9, 3.87803254970131*^9}, {
  3.8780755773066597`*^9, 3.878075579486418*^9}, {3.87808020451082*^9, 
  3.878080207422474*^9}, {3.8780802418491573`*^9, 3.878080244847021*^9}, {
  3.878080502097672*^9, 3.878080502683258*^9}},
 CellLabel->
  "In[262]:=",ExpressionUUID->"b85bd2bb-430b-432d-85db-d49e5ba6ae04"]
}, Open  ]],

Cell[CellGroupData[{

Cell["Cut condition Massless", "Subsection",
 CellChangeTimes->{{3.878076730024465*^9, 
  3.8780767381983347`*^9}},ExpressionUUID->"27e8c3a2-ef85-4301-a1da-\
32f85207ffba"],

Cell[BoxData[
 RowBox[{
  RowBox[{"nod", "=", 
   RowBox[{
    RowBox[{
     RowBox[{
      RowBox[{
       RowBox[{"(", 
        RowBox[{"numAnsatz", "//", "expandFS"}], ")"}], "//.", "dotRules"}], "/.",
       "vponshell"}], "/.", 
     RowBox[{
      RowBox[{"\[Epsilon]", "[", "i_", "]"}], ":>", 
      RowBox[{"\[Epsilon]", "[", 
       RowBox[{"p", "[", "i", "]"}], "]"}]}]}], "//", "Expand"}]}], 
  ";"}]], "Input",
 CellChangeTimes->{{3.8780203515119047`*^9, 3.878020399229755*^9}, {
   3.878020431526237*^9, 3.8780204339818277`*^9}, {3.8780205335571136`*^9, 
   3.878020540776443*^9}, 3.8780206405534067`*^9, {3.878020888923959*^9, 
   3.878020889972404*^9}, 3.878021112062257*^9, {3.878022714056156*^9, 
   3.878022715411971*^9}, {3.8780319378374166`*^9, 3.878031956823164*^9}, 
   3.878110574998744*^9, 3.8781115550732813`*^9},
 CellLabel->
  "In[263]:=",ExpressionUUID->"585e517d-3efd-42fb-8d2b-6ff81dcee3a7"],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{"bpeff2", "=", 
  RowBox[{"BinaryProduct", "[", 
   RowBox[{"Range", "[", 
    RowBox[{"n", "-", "2"}], "]"}], "]"}]}], "\n", 
 RowBox[{
  RowBox[{"numList", "=", 
   RowBox[{
    RowBox[{
     RowBox[{"ExpandNCM", "/@", 
      RowBox[{"(", 
       RowBox[{"bpeff2", "/.", 
        RowBox[{"X", "\[Rule]", " ", "NC"}]}], ")"}]}], "/.", 
     RowBox[{"NonCommutativeMultiply", "\[Rule]", " ", "T"}]}], "/.", 
    RowBox[{
     RowBox[{"T", "[", 
      RowBox[{"i1_", ",", "f___"}], "]"}], ":>", " ", 
     RowBox[{"0", "/;", 
      RowBox[{"i1", "\[NotEqual]", "1"}]}]}]}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"numListL", "=", 
   RowBox[{"numList", "/.", 
    RowBox[{
     RowBox[{"T", "[", "f___", "]"}], "\[RuleDelayed]", " ", 
     RowBox[{"(", 
      RowBox[{"nod", "/.", 
       RowBox[{"replace", "[", 
        RowBox[{
         RowBox[{"p", "/@", 
          RowBox[{"{", "f", "}"}]}], ",", 
         RowBox[{"n", "-", "1"}]}], "]"}]}], ")"}]}]}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"numListL", "=", 
   RowBox[{
    RowBox[{"(", 
     RowBox[{"numListL", "/.", 
      RowBox[{
       RowBox[{"F", "[", 
        RowBox[{"p", "[", "i_", "]"}], "]"}], ":>", " ", 
       RowBox[{"F", "[", "i", "]"}]}]}], ")"}], "//", "Expand"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"ppListD", "=", 
   RowBox[{"(", 
    RowBox[{"X2Prop", "/@", "bpeff2"}], ")"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"ppListD", "=", 
   RowBox[{
    RowBox[{"ppListD", "/.", 
     RowBox[{
      RowBox[{"p", "[", "f__", "]"}], "\[RuleDelayed]", 
      RowBox[{"Total", "[", 
       RowBox[{"p", "/@", 
        RowBox[{"{", "f", "}"}]}], "]"}]}]}], "/.", 
    RowBox[{
     RowBox[{"dot", "[", 
      RowBox[{
       RowBox[{"p", "[", "i_", "]"}], ",", 
       RowBox[{"p", "[", "i_", "]"}]}], "]"}], ":>", " ", "0"}]}]}], 
  ";"}], "\n", 
 RowBox[{
  RowBox[{"denAll", "=", 
   RowBox[{"Table", "[", 
    RowBox[{
     RowBox[{"ppListD", "[", 
      RowBox[{"[", "ii", "]"}], "]"}], ",", 
     RowBox[{"{", 
      RowBox[{"ii", ",", 
       RowBox[{"Length", "@", "ppListD"}]}], "}"}]}], "]"}]}], ";"}], "\n", 
 RowBox[{
  RowBox[{"amp5", "=", 
   RowBox[{
    RowBox[{
     RowBox[{"Sum", "[", 
      RowBox[{
       FractionBox[
        RowBox[{"numListL", "[", 
         RowBox[{"[", "ii", "]"}], "]"}], 
        RowBox[{"denAll", "[", 
         RowBox[{"[", "ii", "]"}], "]"}]], ",", 
       RowBox[{"{", 
        RowBox[{"ii", ",", 
         RowBox[{"Length", "@", "ppListD"}]}], "}"}]}], "]"}], "/.", 
     RowBox[{
      RowBox[{"\[Epsilon]", "[", 
       RowBox[{"p", "[", "i_", "]"}], "]"}], ":>", 
      RowBox[{"\[Epsilon]", "[", "i", "]"}]}]}], "//", "Expand"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"amp5", "=", 
   RowBox[{
    RowBox[{
     RowBox[{
      RowBox[{"amp5", "/.", "dotRules"}], "/.", "vponshell"}], "/.", 
     "gponshell"}], "//", "Expand"}]}], ";"}]}], "Input",
 CellChangeTimes->{{3.878022027028722*^9, 3.878022028483653*^9}, {
  3.8780224366059227`*^9, 3.878022442198484*^9}, {3.878022763644738*^9, 
  3.878022823789957*^9}, {3.878022855805319*^9, 3.8780228836038427`*^9}, {
  3.878022958964085*^9, 3.8780229728251*^9}, {3.878025964817404*^9, 
  3.878025974154643*^9}, {3.878032030200883*^9, 3.878032043291239*^9}, {
  3.87807694175404*^9, 3.878076942268965*^9}},
 CellLabel->
  "In[264]:=",ExpressionUUID->"64955980-6552-4fbe-8bd8-2006ec4384c6"],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
   RowBox[{"X", "[", 
    RowBox[{"1", ",", 
     RowBox[{"X", "[", 
      RowBox[{"2", ",", "3"}], "]"}]}], "]"}], ",", 
   RowBox[{"X", "[", 
    RowBox[{
     RowBox[{"X", "[", 
      RowBox[{"1", ",", "2"}], "]"}], ",", "3"}], "]"}]}], "}"}]], "Output",
 CellChangeTimes->{
  3.8780227866981993`*^9, 3.8780228244290047`*^9, {3.878022856995924*^9, 
   3.878022886712186*^9}, {3.878022959975482*^9, 3.8780229734233837`*^9}, 
   3.878025942910557*^9, 3.878025974822631*^9, 3.87802604880019*^9, 
   3.87802893737528*^9, 3.8780300797739983`*^9, 3.87803201555766*^9, 
   3.878032046557034*^9, 3.8780325721214447`*^9, 3.878075893987146*^9, 
   3.8780808478320103`*^9, 3.878093449603753*^9, 3.878095848723765*^9, 
   3.878097128656351*^9, 3.878106459324299*^9, 3.8781105832067327`*^9, 
   3.8781116321074057`*^9, 3.878616434852977*^9, 3.878857193294776*^9},
 CellLabel->
  "Out[264]=",ExpressionUUID->"31e54817-1461-4469-a12f-f747a15c4464"]
}, Open  ]],

Cell[BoxData[{
 RowBox[{
  RowBox[{"num", "=", 
   RowBox[{"\[FivePointedStar]", "[", 
    RowBox[{
     RowBox[{"T", "[", 
      RowBox[{"{", "1", "}"}], "]"}], ",", 
     RowBox[{"T", "[", 
      RowBox[{"{", "2", "}"}], "]"}], ",", 
     RowBox[{"T", "[", 
      RowBox[{"{", "3", "}"}], "]"}]}], "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"nod", "=", 
   RowBox[{
    RowBox[{
     RowBox[{"(", 
      RowBox[{
       RowBox[{
        RowBox[{"num", "/.", 
         RowBox[{"T", "->", "T2F"}]}], "/.", "rmzero"}], "/.", 
       RowBox[{"v", "->", " ", 
        RowBox[{"v", "[", "1", "]"}]}]}], ")"}], "/.", 
     RowBox[{
      RowBox[{"F", "[", "i_", "]"}], ":>", " ", 
      RowBox[{"F", "[", 
       RowBox[{"p", "[", "i", "]"}], "]"}]}]}], "/.", 
    RowBox[{
     RowBox[{"p", "[", 
      RowBox[{"f1_", ",", "g__"}], "]"}], ":>", 
     RowBox[{"P", "[", " ", 
      RowBox[{"Total", "[", 
       RowBox[{"p", "/@", 
        RowBox[{"{", 
         RowBox[{"f1", ",", "g"}], "}"}]}], "]"}], "]"}]}]}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"bpeff2", "=", 
   RowBox[{"BinaryProduct", "[", 
    RowBox[{"Range", "[", 
     RowBox[{"n", "-", "2"}], "]"}], "]"}]}], ";"}], "\n", 
 RowBox[{
  RowBox[{"numList", "=", 
   RowBox[{
    RowBox[{
     RowBox[{"ExpandNCM", "/@", 
      RowBox[{"(", 
       RowBox[{"bpeff2", "/.", 
        RowBox[{"X", "\[Rule]", " ", "NC"}]}], ")"}]}], "/.", 
     RowBox[{"NonCommutativeMultiply", "\[Rule]", " ", "T"}]}], "/.", 
    RowBox[{
     RowBox[{"T", "[", 
      RowBox[{"i1_", ",", "f___"}], "]"}], ":>", " ", 
     RowBox[{"0", "/;", 
      RowBox[{"i1", "\[NotEqual]", "1"}]}]}]}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"numListL", "=", 
   RowBox[{"numList", "/.", 
    RowBox[{
     RowBox[{"T", "[", "f___", "]"}], "\[RuleDelayed]", " ", 
     RowBox[{"(", 
      RowBox[{"nod", "/.", 
       RowBox[{"replace", "[", 
        RowBox[{
         RowBox[{"p", "/@", 
          RowBox[{"{", "f", "}"}]}], ",", 
         RowBox[{"n", "-", "1"}]}], "]"}]}], ")"}]}]}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"numListL", "=", 
   RowBox[{
    RowBox[{"(", 
     RowBox[{"numListL", "/.", 
      RowBox[{
       RowBox[{"F", "[", 
        RowBox[{"p", "[", "i_", "]"}], "]"}], ":>", " ", 
       RowBox[{"F", "[", "i", "]"}]}]}], ")"}], "//", "Expand"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"ppListD", "=", 
   RowBox[{"(", 
    RowBox[{"X2Prop", "/@", "bpeff2"}], ")"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"ppListD", "=", 
   RowBox[{
    RowBox[{"ppListD", "/.", 
     RowBox[{
      RowBox[{"p", "[", "f__", "]"}], "\[RuleDelayed]", 
      RowBox[{"Total", "[", 
       RowBox[{"p", "/@", 
        RowBox[{"{", "f", "}"}]}], "]"}]}]}], "/.", 
    RowBox[{
     RowBox[{"dot", "[", 
      RowBox[{
       RowBox[{"p", "[", "i_", "]"}], ",", 
       RowBox[{"p", "[", "i_", "]"}]}], "]"}], ":>", " ", "0"}]}]}], 
  ";"}], "\n", 
 RowBox[{
  RowBox[{"denAll", "=", 
   RowBox[{"Table", "[", 
    RowBox[{
     RowBox[{"ppListD", "[", 
      RowBox[{"[", "ii", "]"}], "]"}], ",", 
     RowBox[{"{", 
      RowBox[{"ii", ",", 
       RowBox[{"Length", "@", "ppListD"}]}], "}"}]}], "]"}]}], ";"}], "\n", 
 RowBox[{
  RowBox[{"ampYM", "=", 
   RowBox[{
    RowBox[{
     RowBox[{"Sum", "[", 
      RowBox[{
       FractionBox[
        RowBox[{"numListL", "[", 
         RowBox[{"[", "ii", "]"}], "]"}], 
        RowBox[{"denAll", "[", 
         RowBox[{"[", "ii", "]"}], "]"}]], ",", 
       RowBox[{"{", 
        RowBox[{"ii", ",", 
         RowBox[{"Length", "@", "ppListD"}]}], "}"}]}], "]"}], "/.", 
     RowBox[{
      RowBox[{"P", "[", "f_", "]"}], ":>", "f"}]}], "//", "Expand"}]}], 
  ";"}]}], "Input",
 CellChangeTimes->{{3.878023857740679*^9, 3.878023860158512*^9}, {
   3.87802396296658*^9, 3.878024017862441*^9}, {3.878024052254986*^9, 
   3.878024058839876*^9}, {3.8780241059261007`*^9, 3.8780241103419027`*^9}, {
   3.878024288644836*^9, 3.8780243205537767`*^9}, 3.878076927512285*^9},
 CellLabel->
  "In[273]:=",ExpressionUUID->"73d361bc-fb21-4cc6-b858-1081cb7d7c28"],

Cell[BoxData[{
 RowBox[{
  RowBox[{"ampYM", "=", 
   RowBox[{
    RowBox[{"(", 
     RowBox[{
      RowBox[{
       RowBox[{
        RowBox[{
         RowBox[{"(", 
          RowBox[{"ampYM", "//", "expandFS"}], ")"}], "/.", "dotRules"}], "/.",
         "vponshell"}], "/.", "gponshell"}], "//", "Expand"}], ")"}], "//", 
    "MultivariateApart"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"ampYMGlueNum3", "=", 
   RowBox[{
    RowBox[{
     RowBox[{
      RowBox[{
       RowBox[{"ampYM", "/.", 
        RowBox[{"{", 
         RowBox[{
          RowBox[{
           RowBox[{"dot", "[", 
            RowBox[{
             RowBox[{"v", "[", "1", "]"}], ",", "f_"}], "]"}], ":>", 
           RowBox[{"dot", "[", 
            RowBox[{
             RowBox[{
              RowBox[{"p", "[", "1", "]"}], "+", 
              RowBox[{"p", "[", "2", "]"}], "+", 
              RowBox[{"p", "[", "3", "]"}]}], ",", 
             RowBox[{"S", "[", "0", "]"}], ",", "f"}], "]"}]}], ",", 
          RowBox[{
           RowBox[{"dot", "[", 
            RowBox[{"f_", ",", 
             RowBox[{"v", "[", "1", "]"}]}], "]"}], ":>", 
           RowBox[{"dot", "[", 
            RowBox[{
             RowBox[{
              RowBox[{"p", "[", "1", "]"}], "+", 
              RowBox[{"p", "[", "2", "]"}], "+", 
              RowBox[{"p", "[", "3", "]"}]}], ",", 
             RowBox[{"S", "[", "0", "]"}], ",", "f"}], "]"}]}]}], "}"}]}], "/.",
        "dotRules"}], "/.", "vponshell"}], "/.", "gponshell"}], "//", 
    "Expand"}]}], ";"}]}], "Input",
 CellChangeTimes->{{3.878024069941125*^9, 3.87802415205725*^9}, {
   3.878024331157475*^9, 3.878024340048336*^9}, {3.8780243883823147`*^9, 
   3.87802443440853*^9}, {3.878024623562881*^9, 3.878024662661223*^9}, {
   3.878024820522764*^9, 3.878024839044957*^9}, {3.878025373216962*^9, 
   3.878025408461379*^9}, {3.878025474618256*^9, 3.878025484493874*^9}, 
   3.878025529761257*^9, {3.8780757748389797`*^9, 3.878075783185919*^9}, 
   3.878075831065405*^9},
 CellLabel->
  "In[283]:=",ExpressionUUID->"f0029f32-d8bd-46d4-b155-35b3b8e77226"],

Cell[BoxData[
 RowBox[{
  RowBox[{"comp", "=", 
   RowBox[{
    RowBox[{"amp5", "-", "ampYMGlueNum3"}], "//", "Expand"}]}], 
  ";"}]], "Input",
 CellLabel->
  "In[285]:=",ExpressionUUID->"fa9a6a87-0b37-407a-9714-0c09c4d26928"],

Cell[BoxData[
 RowBox[{
  RowBox[{"cvars", "=", 
   RowBox[{
    RowBox[{"Cases", "[", 
     RowBox[{"comp", ",", 
      RowBox[{"c", "[", "__", "]"}], ",", 
      RowBox[{"{", 
       RowBox[{"0", ",", "\[Infinity]"}], "}"}]}], "]"}], "//", "Union"}]}], 
  ";"}]], "Input",
 CellChangeTimes->{{3.8780251119523973`*^9, 3.87802515275441*^9}, {
  3.878033238685581*^9, 3.8780332388754597`*^9}, {3.87807596060207*^9, 
  3.878075960778406*^9}},
 CellLabel->
  "In[286]:=",ExpressionUUID->"2f8618e3-2ecf-46ed-86be-a8da3f993eb9"],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"cvars", "//", "Length"}]], "Input",
 CellChangeTimes->{{3.878025163562392*^9, 3.878025164327901*^9}},
 CellLabel->
  "In[287]:=",ExpressionUUID->"80c636eb-b91d-4e62-8904-ae38cfaf70be"],

Cell[BoxData["450"], "Output",
 CellChangeTimes->{3.87802516477238*^9, 3.878026076988738*^9, 
  3.878028973567272*^9, 3.8780301059729843`*^9, 3.87803208614393*^9, 
  3.878033255460141*^9, 3.878075964691884*^9, 3.878080856512931*^9, 
  3.878093458365816*^9, 3.878095857461788*^9, 3.878097147230905*^9, 
  3.878106478590885*^9, 3.878110601198616*^9, 3.878111637934287*^9, 
  3.87861644072019*^9, 3.8788571991442327`*^9},
 CellLabel->
  "Out[287]=",ExpressionUUID->"02783e32-57b8-443b-a63a-98fb7dedd2e6"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{
  RowBox[{"vardot", "=", 
   RowBox[{"comp", "//", "Casesdot"}]}], ";"}], "\n", 
 RowBox[{
  RowBox[{"dot2num", ":=", 
   RowBox[{"Table", "[", 
    RowBox[{
     RowBox[{"Rule", "[", 
      RowBox[{
       RowBox[{"vardot", "[", 
        RowBox[{"[", "ii", "]"}], "]"}], ",", 
       RowBox[{"RandomInteger", "[", 
        RowBox[{"{", 
         RowBox[{"10", ",", "100"}], "}"}], "]"}]}], "]"}], ",", 
     RowBox[{"{", 
      RowBox[{"ii", ",", 
       RowBox[{"Length", "[", "vardot", "]"}]}], "}"}]}], "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{"Monitor", "[", 
  RowBox[{
   RowBox[{
    RowBox[{"eqDep", "=", 
     RowBox[{"Table", "[", 
      RowBox[{
       RowBox[{
        RowBox[{"comp", "\[Equal]", "0"}], "/.", "dot2num"}], ",", 
       RowBox[{"{", 
        RowBox[{"ii", ",", 
         RowBox[{"10", "+", 
          RowBox[{"Length", "[", "cvars", "]"}]}]}], "}"}]}], "]"}]}], ";"}], 
   ",", "ii"}], "]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"sols", "=", 
   RowBox[{
    RowBox[{"Solve", "[", 
     RowBox[{"eqDep", ",", "cvars"}], "]"}], "[", 
    RowBox[{"[", "1", "]"}], "]"}]}], ";"}]}], "Input",
 CellChangeTimes->{{3.878025083563089*^9, 3.878025098342598*^9}, {
  3.87802516936078*^9, 3.878025185960835*^9}, {3.878033243467019*^9, 
  3.8780332467055893`*^9}, {3.8780759694484453`*^9, 3.878075974363841*^9}},
 CellLabel->
  "In[288]:=",ExpressionUUID->"cd0f0334-06ee-4f03-ad4a-dccea1959155"],

Cell[BoxData[
 TemplateBox[{
  "Solve", "svars", 
   "\"Equations may not give solutions for all \\\"solve\\\" variables.\"", 2,
    291, 4, 28415626182954115862, "Local"},
  "MessageTemplate"]], "Message", "MSG",
 CellChangeTimes->{3.87802613489694*^9, 3.878029156688776*^9, 
  3.8780303199023113`*^9, 3.8780322863051863`*^9, 3.878032831294737*^9, 
  3.878033318277973*^9, 3.878076165657085*^9, 3.8780810434805603`*^9, 
  3.878093646396821*^9, 3.878096045334003*^9, 3.878097342954261*^9, 
  3.878106566447481*^9, 3.878110634586054*^9, 3.878111723288245*^9, 
  3.878616526738253*^9, 3.878857285279348*^9},
 CellLabel->
  "During evaluation of \
In[288]:=",ExpressionUUID->"6d6b122b-b8ad-437d-8497-2f902cf47f4f"]
}, Open  ]]
}, Closed]],

Cell[CellGroupData[{

Cell["Factorisation condition v.p1", "Subsection",
 CellChangeTimes->{{3.878076748965989*^9, 3.878076767862722*^9}, {
  3.87809373543461*^9, 
  3.8780937386875668`*^9}},ExpressionUUID->"e55fa114-6f3f-4e57-9042-\
2adbdd39a286"],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{
  RowBox[{"numAnsatz2", "=", 
   RowBox[{
    RowBox[{
     RowBox[{
      RowBox[{
       RowBox[{"(", 
        RowBox[{"ansatzIdp", "//", "expandFS"}], ")"}], "//.", "dotRules"}], "/.", 
      RowBox[{"(", 
       RowBox[{
        RowBox[{"vonshell", "[", 
         RowBox[{
          RowBox[{"n", "-", "1"}], ",", "3"}], "]"}], "/.", 
        RowBox[{"v", "->", 
         RowBox[{"v", "[", "1", "]"}]}]}], ")"}]}], "/.", "sols"}], "//", 
    "Expand"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{"%", "//", "Length"}]}], "Input",
 CellChangeTimes->{{3.878076776346158*^9, 3.878076791822427*^9}, {
   3.878076863747164*^9, 3.8780768651784353`*^9}, {3.878077446334421*^9, 
   3.878077450450157*^9}, 3.878080568874198*^9, 3.878080843522138*^9, {
   3.878084931218405*^9, 3.8780849369136047`*^9}, {3.878085107286035*^9, 
   3.878085112014679*^9}, {3.8780852927862673`*^9, 3.878085294285921*^9}, 
   3.878110691065761*^9},
 CellLabel->
  "In[292]:=",ExpressionUUID->"e81780ce-5cdc-4297-b96c-d10168de938e"],

Cell[BoxData["0"], "Output",
 CellChangeTimes->{{3.87807677960294*^9, 3.878076792387086*^9}, 
   3.878076869394702*^9, 3.878077463656658*^9, 3.878080582971023*^9, 
   3.878081061748372*^9, 3.878084951014349*^9, 3.878085126532173*^9, 
   3.878085312641127*^9, 3.878093665706396*^9, 3.87809605896621*^9, 
   3.878106580691216*^9, 3.8781106485337143`*^9, 3.878110695981309*^9, 
   3.878111727924831*^9, 3.878616526776392*^9, 3.878857285298705*^9},
 CellLabel->
  "Out[293]=",ExpressionUUID->"469d8760-3fc8-4437-8b57-83e3d78d9965"]
}, Open  ]],

Cell[BoxData[
 RowBox[{
  RowBox[{"numAnsatzvp1", "=", 
   RowBox[{
    RowBox[{
     RowBox[{
      RowBox[{"(", 
       RowBox[{
        RowBox[{
         RowBox[{"(", 
          RowBox[{"numAnsatz2", "//", 
           RowBox[{"Cases", "[", 
            RowBox[{"Times", "[", 
             RowBox[{"f___", ",", 
              RowBox[{"Power", "[", 
               RowBox[{
                RowBox[{"dot", "[", 
                 RowBox[{
                  RowBox[{"p", "[", "1", "]"}], ",", 
                  RowBox[{"v", "[", "1", "]"}]}], "]"}], ",", 
                RowBox[{"-", "1"}]}], "]"}], ",", "g___"}], "]"}], "]"}]}], 
          ")"}], "/.", 
         RowBox[{
          RowBox[{"Power", "[", 
           RowBox[{
            RowBox[{"dot", "[", 
             RowBox[{
              RowBox[{"p", "[", "1", "]"}], ",", 
              RowBox[{"v", "[", "1", "]"}]}], "]"}], ",", 
            RowBox[{"-", "1"}]}], "]"}], "->", "1"}]}], "//", "Total"}], 
       ")"}], "//.", "dotRules"}], "/.", "vponshell"}], "/.", 
    RowBox[{"{", 
     RowBox[{
      RowBox[{
       RowBox[{"dot", "[", 
        RowBox[{
         RowBox[{"p", "[", "1", "]"}], ",", 
         RowBox[{"v", "[", "1", "]"}]}], "]"}], "->", "0"}], ",", 
      RowBox[{
       RowBox[{"dot", "[", 
        RowBox[{
         RowBox[{"p", "[", "2", "]"}], ",", 
         RowBox[{"v", "[", "1", "]"}]}], "]"}], "->", 
       RowBox[{"-", 
        RowBox[{"dot", "[", 
         RowBox[{
          RowBox[{"p", "[", "3", "]"}], ",", 
          RowBox[{"v", "[", "1", "]"}]}], "]"}]}]}]}], "}"}]}]}], 
  ";"}]], "Input",
 CellChangeTimes->{{3.878077052129978*^9, 3.878077125591745*^9}, {
   3.878077237157652*^9, 3.878077281353335*^9}, {3.8780773702267103`*^9, 
   3.8780774435353603`*^9}, {3.8780774739935207`*^9, 3.8780775017717133`*^9}, 
   3.878079930873101*^9, 3.878079973240665*^9, {3.878085415182927*^9, 
   3.8780854153236303`*^9}, 3.878085446328352*^9},
 CellLabel->
  "In[294]:=",ExpressionUUID->"a2717930-937a-4c21-aa88-03ba76c7d98d"],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"numAnsatzvp1", "//", "Length"}]], "Input",
 CellChangeTimes->{{3.878085457345728*^9, 3.878085458484248*^9}},
 CellLabel->
  "In[295]:=",ExpressionUUID->"d6d6b0b1-34aa-474e-b397-fdc6b3f8d865"],

Cell[BoxData["0"], "Output",
 CellChangeTimes->{{3.878085424115284*^9, 3.8780854589677*^9}, 
   3.878093671135722*^9, 3.878096059862764*^9, 3.878106585270012*^9, 
   3.87811065554213*^9, 3.878110701360381*^9, 3.878111728327223*^9, 
   3.8786165268071327`*^9, 3.878857285317751*^9},
 CellLabel->
  "Out[295]=",ExpressionUUID->"29eded26-abc0-45e4-9bc2-f30ae9c0152e"]
}, Open  ]],

Cell[BoxData[{
 RowBox[{
  RowBox[{"num1", "=", 
   RowBox[{
    RowBox[{
     RowBox[{"T", "[", 
      RowBox[{"{", "1", "}"}], "]"}], "/.", 
     RowBox[{"T", "->", "T2F"}]}], "/.", 
    RowBox[{"v", "->", 
     RowBox[{"v", "[", "1", "]"}]}]}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"num2", "=", 
   RowBox[{"(", 
    RowBox[{
     FractionBox[
      RowBox[{"dot", "[", 
       RowBox[{
        RowBox[{"p", "[", "2", "]"}], ",", 
        RowBox[{"S", "[", "0", "]"}], ",", 
        RowBox[{"F", "[", "2", "]"}], ",", 
        RowBox[{"F", "[", "3", "]"}], ",", 
        RowBox[{"v", "[", "1", "]"}]}], "]"}], 
      RowBox[{"dot", "[", 
       RowBox[{
        RowBox[{"p", "[", "2", "]"}], ",", 
        RowBox[{"v", "[", "1", "]"}]}], "]"}]], "+", 
     FractionBox[
      RowBox[{"dot", "[", 
       RowBox[{
        RowBox[{"p", "[", "2", "]"}], ",", 
        RowBox[{"S", "[", "0", "]"}], ",", 
        RowBox[{"F", "[", "3", "]"}], ",", 
        RowBox[{"F", "[", "2", "]"}], ",", 
        RowBox[{"v", "[", "1", "]"}]}], "]"}], 
      RowBox[{"dot", "[", 
       RowBox[{
        RowBox[{"p", "[", "2", "]"}], ",", 
        RowBox[{"v", "[", "1", "]"}]}], "]"}]], "-", 
     FractionBox[
      RowBox[{"dot", "[", 
       RowBox[{
        RowBox[{"p", "[", "2", "]"}], ",", 
        RowBox[{"F", "[", "3", "]"}], ",", 
        RowBox[{"S", "[", "0", "]"}], ",", 
        RowBox[{"F", "[", "2", "]"}], ",", 
        RowBox[{"v", "[", "1", "]"}]}], "]"}], 
      RowBox[{"dot", "[", 
       RowBox[{
        RowBox[{"p", "[", "2", "]"}], ",", 
        RowBox[{"v", "[", "1", "]"}]}], "]"}]], "+", 
     FractionBox[
      RowBox[{"dot", "[", 
       RowBox[{
        RowBox[{"p", "[", "3", "]"}], ",", 
        RowBox[{"S", "[", "0", "]"}], ",", 
        RowBox[{"F", "[", "3", "]"}], ",", 
        RowBox[{"F", "[", "2", "]"}], ",", 
        RowBox[{"v", "[", "1", "]"}]}], "]"}], 
      RowBox[{"dot", "[", 
       RowBox[{
        RowBox[{"p", "[", "2", "]"}], ",", 
        RowBox[{"v", "[", "1", "]"}]}], "]"}]]}], ")"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"numvp1", "=", 
   RowBox[{
    RowBox[{
     RowBox[{
      RowBox[{
       RowBox[{"dot", "[", 
        RowBox[{
         RowBox[{"p", "[", "1", "]"}], ",", 
         RowBox[{"p", "[", "2", "]"}]}], "]"}], 
       RowBox[{"(", 
        RowBox[{
         RowBox[{
          RowBox[{"-", "num1"}], "*", "num2"}], "-", 
         RowBox[{
          FractionBox["1", 
           RowBox[{"dot", "[", 
            RowBox[{
             RowBox[{"p", "[", "2", "]"}], ",", 
             RowBox[{"v", "[", "1", "]"}]}], "]"}]], 
          RowBox[{"dot", "[", 
           RowBox[{
            RowBox[{"p", "[", "1", "]"}], ",", 
            RowBox[{"S", "[", "0", "]"}], ",", 
            RowBox[{"\[Epsilon]", "[", "1", "]"}]}], "]"}], "*", 
          RowBox[{"dot", "[", 
           RowBox[{
            RowBox[{"v", "[", "1", "]"}], ",", 
            RowBox[{"F", "[", "2", "]"}], ",", 
            RowBox[{"F", "[", "3", "]"}], ",", 
            RowBox[{"v", "[", "1", "]"}]}], "]"}]}]}], ")"}]}], "//.", 
      "dotRules"}], "//", "expandFS"}], "//", "Expand"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"numvp1", "=", 
   RowBox[{
    RowBox[{
     RowBox[{"numvp1", "//.", "dotRules"}], "/.", "vponshell"}], "/.", 
    RowBox[{"{", 
     RowBox[{
      RowBox[{
       RowBox[{"dot", "[", 
        RowBox[{
         RowBox[{"p", "[", "1", "]"}], ",", 
         RowBox[{"v", "[", "1", "]"}]}], "]"}], "->", "0"}], ",", 
      RowBox[{
       RowBox[{"dot", "[", 
        RowBox[{
         RowBox[{"p", "[", "2", "]"}], ",", 
         RowBox[{"v", "[", "1", "]"}]}], "]"}], "->", 
       RowBox[{"-", 
        RowBox[{"dot", "[", 
         RowBox[{
          RowBox[{"p", "[", "3", "]"}], ",", 
          RowBox[{"v", "[", "1", "]"}]}], "]"}]}]}]}], "}"}]}]}], 
  ";"}]}], "Input",
 CellChangeTimes->{{3.878077591985273*^9, 3.8780776461342783`*^9}, {
   3.878077953502172*^9, 3.878077980733405*^9}, {3.878078491930747*^9, 
   3.878078549563458*^9}, {3.878078580745262*^9, 3.87807865251903*^9}, 
   3.878078684800146*^9, {3.878079206140265*^9, 3.878079212664543*^9}, {
   3.878079938416065*^9, 3.8780799390210323`*^9}, {3.878079982854789*^9, 
   3.878079996138009*^9}, 3.878080718496252*^9, 3.878080776110016*^9, {
   3.878081116226698*^9, 3.8780811179219093`*^9}, {3.878081897887516*^9, 
   3.878081929737031*^9}, {3.8780819770250673`*^9, 3.8780819885274878`*^9}, 
   3.8780820357161922`*^9, {3.878082093586617*^9, 3.878082094494379*^9}, 
   3.878082200584118*^9, 3.8780823524734297`*^9, 3.8780843780876017`*^9, {
   3.87808451838385*^9, 3.878084553403726*^9}, {3.878084767872551*^9, 
   3.878084809993238*^9}, {3.878093413770879*^9, 3.878093418381057*^9}, {
   3.878106594481743*^9, 3.878106602977435*^9}},
 CellLabel->
  "In[296]:=",ExpressionUUID->"ad67a268-49c9-4fc2-a2e7-1202cf0c7c53"],

Cell[BoxData[
 RowBox[{
  RowBox[{"compvp1", "=", 
   RowBox[{"numAnsatzvp1", "-", "numvp1"}]}], ";"}]], "Input",
 CellChangeTimes->{{3.8780781147500143`*^9, 3.878078179889933*^9}, {
   3.878078714167301*^9, 3.878078719908218*^9}, {3.878078864983605*^9, 
   3.8780788894932623`*^9}, 3.878079927920136*^9, 3.87808000213634*^9},
 CellLabel->
  "In[300]:=",ExpressionUUID->"72f44ea0-a346-4471-b32e-dfefbb0d6428"],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  RowBox[{"4", " ", 
   RowBox[{
    SubscriptBox["p", "1"], "\[CenterDot]", "S", "\[CenterDot]", 
    SubscriptBox["F", "1"], "\[CenterDot]", 
    SubscriptBox["F", "2"], "\[CenterDot]", "v"}]}], "+", 
  RowBox[{"4", 
   RowBox[{
    SubscriptBox["p", "1"], "\[CenterDot]", "S", "\[CenterDot]", 
    SubscriptBox["F", "2"], "\[CenterDot]", 
    SubscriptBox["F", "1"], "\[CenterDot]", "v"}]}], "-", 
  RowBox[{"4", " ", 
   RowBox[{
    SubscriptBox["p", "1"], "\[CenterDot]", 
    SubscriptBox["F", "2"], "\[CenterDot]", "S", "\[CenterDot]", 
    SubscriptBox["F", "1"], "\[CenterDot]", "v"}]}], "+", 
  RowBox[{"4", " ", 
   RowBox[{
    SubscriptBox["p", "2"], "\[CenterDot]", "S", "\[CenterDot]", 
    SubscriptBox["F", "2"], "\[CenterDot]", 
    SubscriptBox["F", "1"], "\[CenterDot]", "v"}]}]}]], "Input",
 CellChangeTimes->{{3.878078468972107*^9, 3.8780784821254663`*^9}},
 CellLabel->
  "In[301]:=",ExpressionUUID->"815cf49c-0a7b-4689-98f1-ef3527fcb2f8"],

Cell[BoxData[
 RowBox[{
  RowBox[{"4", " ", 
   RowBox[{
    SubscriptBox["p", "1"], "\[CenterDot]", "S", "\[CenterDot]", 
    SubscriptBox["F", "1"], "\[CenterDot]", 
    SubscriptBox["F", "2"], "\[CenterDot]", "v"}]}], "+", 
  RowBox[{"4", " ", 
   RowBox[{
    SubscriptBox["p", "1"], "\[CenterDot]", "S", "\[CenterDot]", 
    SubscriptBox["F", "2"], "\[CenterDot]", 
    SubscriptBox["F", "1"], "\[CenterDot]", "v"}]}], "-", 
  RowBox[{"4", " ", 
   RowBox[{
    SubscriptBox["p", "1"], "\[CenterDot]", 
    SubscriptBox["F", "2"], "\[CenterDot]", "S", "\[CenterDot]", 
    SubscriptBox["F", "1"], "\[CenterDot]", "v"}]}], "+", 
  RowBox[{"4", " ", 
   RowBox[{
    SubscriptBox["p", "2"], "\[CenterDot]", "S", "\[CenterDot]", 
    SubscriptBox["F", "2"], "\[CenterDot]", 
    SubscriptBox["F", "1"], "\[CenterDot]", "v"}]}]}]], "Output",
 CellChangeTimes->{3.878096059926221*^9, 3.878111728391625*^9, 
  3.878616526875004*^9, 3.878857285383501*^9},
 CellLabel->
  "Out[301]=",ExpressionUUID->"c5e1a02d-f1ff-4bba-a7c6-8f46a84c2bcf"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"compvp1", "//", "Casesdot"}]], "Input",
 CellChangeTimes->{{3.8780788203554583`*^9, 3.878078825352446*^9}},
 CellLabel->
  "In[302]:=",ExpressionUUID->"a0181419-1fa1-46e1-92f1-89bc97129c7a"],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
   RowBox[{"dot", "[", 
    RowBox[{
     RowBox[{"p", "[", "1", "]"}], ",", 
     RowBox[{"p", "[", "2", "]"}]}], "]"}], ",", 
   RowBox[{"dot", "[", 
    RowBox[{
     RowBox[{"p", "[", "2", "]"}], ",", 
     RowBox[{"p", "[", "3", "]"}]}], "]"}], ",", 
   RowBox[{"dot", "[", 
    RowBox[{
     RowBox[{"p", "[", "2", "]"}], ",", 
     RowBox[{"\[Epsilon]", "[", "3", "]"}]}], "]"}], ",", 
   RowBox[{"dot", "[", 
    RowBox[{
     RowBox[{"p", "[", "3", "]"}], ",", 
     RowBox[{"v", "[", "1", "]"}]}], "]"}], ",", 
   RowBox[{"dot", "[", 
    RowBox[{
     RowBox[{"p", "[", "3", "]"}], ",", 
     RowBox[{"\[Epsilon]", "[", "2", "]"}]}], "]"}], ",", 
   RowBox[{"dot", "[", 
    RowBox[{
     RowBox[{"v", "[", "1", "]"}], ",", 
     RowBox[{"\[Epsilon]", "[", "1", "]"}]}], "]"}], ",", 
   RowBox[{"dot", "[", 
    RowBox[{
     RowBox[{"v", "[", "1", "]"}], ",", 
     RowBox[{"\[Epsilon]", "[", "2", "]"}]}], "]"}], ",", 
   RowBox[{"dot", "[", 
    RowBox[{
     RowBox[{"v", "[", "1", "]"}], ",", 
     RowBox[{"\[Epsilon]", "[", "3", "]"}]}], "]"}], ",", 
   RowBox[{"dot", "[", 
    RowBox[{
     RowBox[{"\[Epsilon]", "[", "2", "]"}], ",", 
     RowBox[{"\[Epsilon]", "[", "3", "]"}]}], "]"}], ",", 
   RowBox[{"dot", "[", 
    RowBox[{
     RowBox[{"p", "[", "1", "]"}], ",", 
     RowBox[{"S", "[", "0", "]"}], ",", 
     RowBox[{"\[Epsilon]", "[", "1", "]"}]}], "]"}], ",", 
   RowBox[{"dot", "[", 
    RowBox[{
     RowBox[{"p", "[", "2", "]"}], ",", 
     RowBox[{"S", "[", "0", "]"}], ",", 
     RowBox[{"p", "[", "3", "]"}]}], "]"}], ",", 
   RowBox[{"dot", "[", 
    RowBox[{
     RowBox[{"p", "[", "2", "]"}], ",", 
     RowBox[{"S", "[", "0", "]"}], ",", 
     RowBox[{"\[Epsilon]", "[", "2", "]"}]}], "]"}], ",", 
   RowBox[{"dot", "[", 
    RowBox[{
     RowBox[{"p", "[", "2", "]"}], ",", 
     RowBox[{"S", "[", "0", "]"}], ",", 
     RowBox[{"\[Epsilon]", "[", "3", "]"}]}], "]"}], ",", 
   RowBox[{"dot", "[", 
    RowBox[{
     RowBox[{"p", "[", "3", "]"}], ",", 
     RowBox[{"S", "[", "0", "]"}], ",", 
     RowBox[{"\[Epsilon]", "[", "2", "]"}]}], "]"}], ",", 
   RowBox[{"dot", "[", 
    RowBox[{
     RowBox[{"p", "[", "3", "]"}], ",", 
     RowBox[{"S", "[", "0", "]"}], ",", 
     RowBox[{"\[Epsilon]", "[", "3", "]"}]}], "]"}], ",", 
   RowBox[{"dot", "[", 
    RowBox[{
     RowBox[{"\[Epsilon]", "[", "2", "]"}], ",", 
     RowBox[{"S", "[", "0", "]"}], ",", 
     RowBox[{"\[Epsilon]", "[", "3", "]"}]}], "]"}]}], "}"}]], "Output",
 CellChangeTimes->{3.8780787909855328`*^9, 3.878078825754147*^9, 
  3.8780789139500523`*^9, 3.878079583885482*^9, 3.8780807366766977`*^9, 
  3.87808078442798*^9, 3.878096059944249*^9, 3.878111728404121*^9, 
  3.8786165268819323`*^9, 3.878857285389884*^9},
 CellLabel->
  "Out[302]=",ExpressionUUID->"ab4e7aef-0ed0-4600-afc8-cdd6ac0cd157"]
}, Open  ]],

Cell[BoxData[{
 RowBox[{
  RowBox[{"cvars", "=", 
   RowBox[{
    RowBox[{"Cases", "[", 
     RowBox[{"compvp1", ",", 
      RowBox[{"c", "[", "__", "]"}], ",", 
      RowBox[{"{", 
       RowBox[{"0", ",", "\[Infinity]"}], "}"}]}], "]"}], "//", "Union"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"vardot", "=", 
   RowBox[{"compvp1", "//", "Casesdot"}]}], ";"}]}], "Input",
 CellChangeTimes->{{3.878078218083035*^9, 3.878078227195683*^9}},
 CellLabel->
  "In[303]:=",ExpressionUUID->"1e88fb7c-d5f5-4931-a279-7e05550291fd"],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"cvars", "//", "Length"}]], "Input",
 CellChangeTimes->{{3.878078250405406*^9, 3.8780782515980988`*^9}, 
   3.8780793030421352`*^9, {3.878080618122617*^9, 3.878080619511405*^9}},
 CellLabel->
  "In[305]:=",ExpressionUUID->"a79df089-ed2d-4ded-a266-1b17d479c9a2"],

Cell[BoxData["0"], "Output",
 CellChangeTimes->{
  3.878078252063862*^9, 3.878078732430634*^9, {3.8780792683050127`*^9, 
   3.878079303531766*^9}, {3.8780806116761723`*^9, 3.878080620497012*^9}, 
   3.878080793272333*^9, 3.8780810935750732`*^9, 3.8780811318686132`*^9, 
   3.878081941084124*^9, 3.8780820011325197`*^9, 3.878082120982493*^9, 
   3.878084828486793*^9, 3.878085517830093*^9, 3.878093680935251*^9, 
   3.878096059965028*^9, 3.878106611890305*^9, 3.8781106661833277`*^9, 
   3.878110711119144*^9, 3.878111728424964*^9, 3.8786165269045362`*^9, 
   3.8788572854061403`*^9},
 CellLabel->
  "Out[305]=",ExpressionUUID->"a5da0062-447b-4144-a442-48f76cf4b6c1"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{
  RowBox[{"dot2num", ":=", 
   RowBox[{"Table", "[", 
    RowBox[{
     RowBox[{"Rule", "[", 
      RowBox[{
       RowBox[{"vardot", "[", 
        RowBox[{"[", "ii", "]"}], "]"}], ",", 
       RowBox[{"RandomInteger", "[", 
        RowBox[{"{", 
         RowBox[{"10", ",", "100"}], "}"}], "]"}]}], "]"}], ",", 
     RowBox[{"{", 
      RowBox[{"ii", ",", 
       RowBox[{"Length", "[", "vardot", "]"}]}], "}"}]}], "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{"Monitor", "[", 
  RowBox[{
   RowBox[{
    RowBox[{"eqDep", "=", 
     RowBox[{"Table", "[", 
      RowBox[{
       RowBox[{
        RowBox[{"compvp1", "\[Equal]", "0"}], "/.", "dot2num"}], ",", 
       RowBox[{"{", 
        RowBox[{"ii", ",", 
         RowBox[{"10", "+", 
          RowBox[{"Length", "[", "cvars", "]"}]}]}], "}"}]}], "]"}]}], ";"}], 
   ",", "ii"}], "]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"solsvp1", "=", 
   RowBox[{
    RowBox[{"Solve", "[", 
     RowBox[{"eqDep", ",", "cvars"}], "]"}], "[", 
    RowBox[{"[", "1", "]"}], "]"}]}], ";"}]}], "Input",
 CellChangeTimes->{{3.878078221639757*^9, 3.878078240954069*^9}, {
  3.878081064658252*^9, 3.8780810690042477`*^9}},
 CellLabel->
  "In[306]:=",ExpressionUUID->"1f712311-4975-4ed6-a7d3-09ae1c6a31d7"],

Cell[BoxData[
 TemplateBox[{
  "Part", "partw", 
   "\"Part \\!\\(\\*RowBox[{\\\"1\\\"}]\\) of \\!\\(\\*RowBox[{\\\"{\\\", \
\\\"}\\\"}]\\) does not exist.\"", 2, 308, 5, 28415626182954115862, "Local"},
  "MessageTemplate"]], "Message", "MSG",
 CellChangeTimes->{3.878078269494465*^9, 3.878078742583606*^9, 
  3.878078899618535*^9, 3.878079253865985*^9, 3.878079430819562*^9, 
  3.878080637128373*^9, 3.8780808095370073`*^9, 3.878081098149448*^9, 
  3.878081136137045*^9, 3.8780819450782824`*^9, 3.8780820048796787`*^9, 
  3.878082047763628*^9, 3.878082109462324*^9, 3.878082376640708*^9, 
  3.878084831921735*^9, 3.878085522082589*^9, 3.878093683954672*^9, 
  3.878096061390531*^9, 3.8781066143839417`*^9, 3.878110713398693*^9, 
  3.878111731516018*^9, 3.878616526952442*^9, 3.8788572854436007`*^9},
 CellLabel->
  "During evaluation of \
In[306]:=",ExpressionUUID->"3ae39d67-c7d1-46eb-b755-f0e604991e98"]
}, Open  ]]
}, Closed]],

Cell[CellGroupData[{

Cell["Factorisation condition v.p2", "Subsection",
 CellChangeTimes->{{3.878076748965989*^9, 3.878076767862722*^9}, {
  3.878093747799068*^9, 
  3.8780937495889473`*^9}},ExpressionUUID->"093da948-de7f-454f-8d79-\
9cf7d35422c3"],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{
  RowBox[{"numAnsatz3", "=", 
   RowBox[{
    RowBox[{
     RowBox[{
      RowBox[{
       RowBox[{"(", "numAnsatz2", ")"}], "//.", "dotRules"}], "/.", 
      RowBox[{"(", 
       RowBox[{
        RowBox[{"vonshell", "[", 
         RowBox[{
          RowBox[{"n", "-", "1"}], ",", "3"}], "]"}], "/.", 
        RowBox[{"v", "->", 
         RowBox[{"v", "[", "1", "]"}]}]}], ")"}]}], "/.", "solsvp1"}], "//", 
    "Expand"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{"%", "//", "Length"}]}], "Input",
 CellChangeTimes->{{3.878076776346158*^9, 3.878076791822427*^9}, {
   3.878076863747164*^9, 3.8780768651784353`*^9}, {3.878077446334421*^9, 
   3.878077450450157*^9}, 3.878080568874198*^9, 3.878080843522138*^9, {
   3.878084931218405*^9, 3.8780849369136047`*^9}, {3.878085107286035*^9, 
   3.878085112014679*^9}, {3.8780852927862673`*^9, 3.878085294285921*^9}, {
   3.8780937634764643`*^9, 3.8780937712084923`*^9}, {3.878094578752013*^9, 
   3.87809458003332*^9}},
 CellLabel->
  "In[309]:=",ExpressionUUID->"6a1ca1dd-0cf5-4aa0-9478-36bb48adb0e4"],

Cell[BoxData[
 TemplateBox[{
  "ReplaceAll", "reps", 
   "\"\\!\\(\\*RowBox[{\\\"{\\\", RowBox[{RowBox[{\\\"{\\\", \\\"}\\\"}], \
\\\"\[LeftDoubleBracket]\\\", \\\"1\\\", \\\"\[RightDoubleBracket]\\\"}], \
\\\"}\\\"}]\\) is neither a list of replacement rules nor a valid dispatch \
table, and so cannot be used for replacing.\"", 2, 309, 6, 
   28415626182954115862, "Local"},
  "MessageTemplate"]], "Message", "MSG",
 CellChangeTimes->{3.878616526993696*^9, 3.8788572854838667`*^9},
 CellLabel->
  "During evaluation of \
In[309]:=",ExpressionUUID->"1fb5bc26-105e-4f13-8488-db9dfd69846c"],

Cell[BoxData["2"], "Output",
 CellChangeTimes->{{3.87807677960294*^9, 3.878076792387086*^9}, 
   3.878076869394702*^9, 3.878077463656658*^9, 3.878080582971023*^9, 
   3.878081061748372*^9, 3.878084951014349*^9, 3.878085126532173*^9, 
   3.878085312641127*^9, 3.878093665706396*^9, 3.878094602309922*^9, 
   3.8780960624008083`*^9, 3.878106626228441*^9, 3.878110729159609*^9, 
   3.8781117318408327`*^9, 3.878616526994541*^9, 3.878857285484717*^9},
 CellLabel->
  "Out[310]=",ExpressionUUID->"6b9c4b87-312b-40b1-83ab-792f319a4e51"]
}, Open  ]],

Cell[BoxData[
 RowBox[{
  RowBox[{"numAnsatzvp1", "=", 
   RowBox[{
    RowBox[{
     RowBox[{
      RowBox[{"(", 
       RowBox[{
        RowBox[{
         RowBox[{"(", 
          RowBox[{"numAnsatz3", "//", 
           RowBox[{"Cases", "[", 
            RowBox[{"Times", "[", 
             RowBox[{"f___", ",", 
              RowBox[{"Power", "[", 
               RowBox[{
                RowBox[{"dot", "[", 
                 RowBox[{
                  RowBox[{"p", "[", "2", "]"}], ",", 
                  RowBox[{"v", "[", "1", "]"}]}], "]"}], ",", 
                RowBox[{"-", "1"}]}], "]"}], ",", "g___"}], "]"}], "]"}]}], 
          ")"}], "/.", 
         RowBox[{
          RowBox[{"Power", "[", 
           RowBox[{
            RowBox[{"dot", "[", 
             RowBox[{
              RowBox[{"p", "[", "2", "]"}], ",", 
              RowBox[{"v", "[", "1", "]"}]}], "]"}], ",", 
            RowBox[{"-", "1"}]}], "]"}], "->", "1"}]}], "//", "Total"}], 
       ")"}], "//.", "dotRules"}], "/.", "vponshell"}], "/.", 
    RowBox[{"{", 
     RowBox[{
      RowBox[{
       RowBox[{"dot", "[", 
        RowBox[{
         RowBox[{"p", "[", "2", "]"}], ",", 
         RowBox[{"v", "[", "1", "]"}]}], "]"}], "->", "0"}], ",", 
      RowBox[{
       RowBox[{"dot", "[", 
        RowBox[{
         RowBox[{"p", "[", "3", "]"}], ",", 
         RowBox[{"v", "[", "1", "]"}]}], "]"}], "->", 
       RowBox[{"-", 
        RowBox[{"dot", "[", 
         RowBox[{
          RowBox[{"p", "[", "1", "]"}], ",", 
          RowBox[{"v", "[", "1", "]"}]}], "]"}]}]}]}], "}"}]}]}], 
  ";"}]], "Input",
 CellChangeTimes->{{3.878077052129978*^9, 3.878077125591745*^9}, {
   3.878077237157652*^9, 3.878077281353335*^9}, {3.8780773702267103`*^9, 
   3.8780774435353603`*^9}, {3.8780774739935207`*^9, 3.8780775017717133`*^9}, 
   3.878079930873101*^9, 3.878079973240665*^9, {3.878085415182927*^9, 
   3.8780854153236303`*^9}, 3.878085446328352*^9, {3.878094648731681*^9, 
   3.878094651846068*^9}, {3.878094696417069*^9, 3.878094712612356*^9}},
 CellLabel->
  "In[311]:=",ExpressionUUID->"dd475017-77a1-49c6-b689-cb657cf98d66"],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"numAnsatzvp1", "//", "Length"}]], "Input",
 CellChangeTimes->{{3.878085457345728*^9, 3.878085458484248*^9}},
 CellLabel->
  "In[312]:=",ExpressionUUID->"9593486d-7e53-4ab1-9a84-acce95ba243f"],

Cell[BoxData["0"], "Output",
 CellChangeTimes->{{3.878085424115284*^9, 3.8780854589677*^9}, 
   3.878093671135722*^9, 3.878094722221806*^9, 3.878096062738055*^9, 
   3.878106638620821*^9, 3.878110733692247*^9, 3.878111732113031*^9, 
   3.8786165270184193`*^9, 3.8788572855011377`*^9},
 CellLabel->
  "Out[312]=",ExpressionUUID->"f3c9a1b2-3b47-4c8f-bad9-0f431de1abaf"]
}, Open  ]],

Cell[BoxData[{
 RowBox[{
  RowBox[{"num1", "=", 
   RowBox[{
    RowBox[{
     RowBox[{"T", "[", 
      RowBox[{"{", "2", "}"}], "]"}], "/.", 
     RowBox[{"T", "->", "T2F"}]}], "/.", 
    RowBox[{"v", "->", 
     RowBox[{"v", "[", "1", "]"}]}]}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"num2", "=", 
   RowBox[{"(", 
    RowBox[{
     FractionBox[
      RowBox[{"dot", "[", 
       RowBox[{
        RowBox[{"p", "[", "1", "]"}], ",", 
        RowBox[{"S", "[", "0", "]"}], ",", 
        RowBox[{"F", "[", "1", "]"}], ",", 
        RowBox[{"F", "[", "3", "]"}], ",", 
        RowBox[{"v", "[", "1", "]"}]}], "]"}], 
      RowBox[{"dot", "[", 
       RowBox[{
        RowBox[{"p", "[", "1", "]"}], ",", 
        RowBox[{"v", "[", "1", "]"}]}], "]"}]], "+", 
     FractionBox[
      RowBox[{"dot", "[", 
       RowBox[{
        RowBox[{"p", "[", "1", "]"}], ",", 
        RowBox[{"S", "[", "0", "]"}], ",", 
        RowBox[{"F", "[", "3", "]"}], ",", 
        RowBox[{"F", "[", "1", "]"}], ",", 
        RowBox[{"v", "[", "1", "]"}]}], "]"}], 
      RowBox[{"dot", "[", 
       RowBox[{
        RowBox[{"p", "[", "1", "]"}], ",", 
        RowBox[{"v", "[", "1", "]"}]}], "]"}]], "-", 
     FractionBox[
      RowBox[{"dot", "[", 
       RowBox[{
        RowBox[{"p", "[", "1", "]"}], ",", 
        RowBox[{"F", "[", "3", "]"}], ",", 
        RowBox[{"S", "[", "0", "]"}], ",", 
        RowBox[{"F", "[", "1", "]"}], ",", 
        RowBox[{"v", "[", "1", "]"}]}], "]"}], 
      RowBox[{"dot", "[", 
       RowBox[{
        RowBox[{"p", "[", "1", "]"}], ",", 
        RowBox[{"v", "[", "1", "]"}]}], "]"}]], "+", 
     FractionBox[
      RowBox[{"dot", "[", 
       RowBox[{
        RowBox[{"p", "[", "3", "]"}], ",", 
        RowBox[{"S", "[", "0", "]"}], ",", 
        RowBox[{"F", "[", "3", "]"}], ",", 
        RowBox[{"F", "[", "1", "]"}], ",", 
        RowBox[{"v", "[", "1", "]"}]}], "]"}], 
      RowBox[{"dot", "[", 
       RowBox[{
        RowBox[{"p", "[", "1", "]"}], ",", 
        RowBox[{"v", "[", "1", "]"}]}], "]"}]]}], ")"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"numvp1", "=", 
   RowBox[{
    RowBox[{
     RowBox[{
      RowBox[{
       RowBox[{"dot", "[", 
        RowBox[{
         RowBox[{"p", "[", "1", "]"}], ",", 
         RowBox[{"p", "[", "2", "]"}]}], "]"}], 
       RowBox[{"(", 
        RowBox[{
         RowBox[{"num1", "*", "num2"}], "+", 
         RowBox[{
          FractionBox["1", 
           RowBox[{"dot", "[", 
            RowBox[{
             RowBox[{"p", "[", "1", "]"}], ",", 
             RowBox[{"v", "[", "1", "]"}]}], "]"}]], 
          RowBox[{"dot", "[", 
           RowBox[{
            RowBox[{"p", "[", "2", "]"}], ",", 
            RowBox[{"S", "[", "0", "]"}], ",", 
            RowBox[{"\[Epsilon]", "[", "2", "]"}]}], "]"}], "*", 
          RowBox[{"dot", "[", 
           RowBox[{
            RowBox[{"v", "[", "1", "]"}], ",", 
            RowBox[{"F", "[", "1", "]"}], ",", 
            RowBox[{"F", "[", "3", "]"}], ",", 
            RowBox[{"v", "[", "1", "]"}]}], "]"}]}]}], ")"}]}], "//.", 
      "dotRules"}], "//", "expandFS"}], "//", "Expand"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"numvp1", "=", 
   RowBox[{
    RowBox[{
     RowBox[{"numvp1", "//.", "dotRules"}], "/.", "vponshell"}], "/.", 
    RowBox[{"{", 
     RowBox[{
      RowBox[{
       RowBox[{"dot", "[", 
        RowBox[{
         RowBox[{"p", "[", "2", "]"}], ",", 
         RowBox[{"v", "[", "1", "]"}]}], "]"}], "->", "0"}], ",", 
      RowBox[{
       RowBox[{"dot", "[", 
        RowBox[{
         RowBox[{"p", "[", "3", "]"}], ",", 
         RowBox[{"v", "[", "1", "]"}]}], "]"}], "->", 
       RowBox[{"-", 
        RowBox[{"dot", "[", 
         RowBox[{
          RowBox[{"p", "[", "1", "]"}], ",", 
          RowBox[{"v", "[", "1", "]"}]}], "]"}]}]}]}], "}"}]}]}], 
  ";"}]}], "Input",
 CellChangeTimes->{{3.878077591985273*^9, 3.8780776461342783`*^9}, {
   3.878077953502172*^9, 3.878077980733405*^9}, {3.878078491930747*^9, 
   3.878078549563458*^9}, {3.878078580745262*^9, 3.87807865251903*^9}, 
   3.878078684800146*^9, {3.878079206140265*^9, 3.878079212664543*^9}, {
   3.878079938416065*^9, 3.8780799390210323`*^9}, {3.878079982854789*^9, 
   3.878079996138009*^9}, 3.878080718496252*^9, 3.878080776110016*^9, {
   3.878081116226698*^9, 3.8780811179219093`*^9}, {3.878081897887516*^9, 
   3.878081929737031*^9}, {3.8780819770250673`*^9, 3.8780819885274878`*^9}, 
   3.8780820357161922`*^9, {3.878082093586617*^9, 3.878082094494379*^9}, 
   3.878082200584118*^9, 3.8780823524734297`*^9, 3.8780843780876017`*^9, {
   3.87808451838385*^9, 3.878084553403726*^9}, {3.878084767872551*^9, 
   3.878084809993238*^9}, {3.878093413770879*^9, 3.878093418381057*^9}, 
   3.878094731163116*^9, {3.878094787760552*^9, 3.878094870939351*^9}, {
   3.878094944453622*^9, 3.878094946794712*^9}, {3.878106643713951*^9, 
   3.878106646634589*^9}},
 CellLabel->
  "In[313]:=",ExpressionUUID->"2b829d84-3c43-404b-ac21-445a8f6759c1"],

Cell[BoxData[
 RowBox[{
  RowBox[{"compvp1", "=", 
   RowBox[{"numAnsatzvp1", "-", "numvp1"}]}], ";"}]], "Input",
 CellChangeTimes->{{3.8780781147500143`*^9, 3.878078179889933*^9}, {
   3.878078714167301*^9, 3.878078719908218*^9}, {3.878078864983605*^9, 
   3.8780788894932623`*^9}, 3.878079927920136*^9, 3.87808000213634*^9},
 CellLabel->
  "In[317]:=",ExpressionUUID->"341b9159-8e46-48e9-83cc-e872910e762c"],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  RowBox[{"4", " ", 
   RowBox[{
    SubscriptBox["p", "1"], "\[CenterDot]", "S", "\[CenterDot]", 
    SubscriptBox["F", "1"], "\[CenterDot]", 
    SubscriptBox["F", "2"], "\[CenterDot]", "v"}]}], "+", 
  RowBox[{"4", 
   RowBox[{
    SubscriptBox["p", "1"], "\[CenterDot]", "S", "\[CenterDot]", 
    SubscriptBox["F", "2"], "\[CenterDot]", 
    SubscriptBox["F", "1"], "\[CenterDot]", "v"}]}], "-", 
  RowBox[{"4", " ", 
   RowBox[{
    SubscriptBox["p", "1"], "\[CenterDot]", 
    SubscriptBox["F", "2"], "\[CenterDot]", "S", "\[CenterDot]", 
    SubscriptBox["F", "1"], "\[CenterDot]", "v"}]}], "+", 
  RowBox[{"4", " ", 
   RowBox[{
    SubscriptBox["p", "2"], "\[CenterDot]", "S", "\[CenterDot]", 
    SubscriptBox["F", "2"], "\[CenterDot]", 
    SubscriptBox["F", "1"], "\[CenterDot]", "v"}]}]}]], "Input",
 CellChangeTimes->{{3.878078468972107*^9, 3.8780784821254663`*^9}},
 CellLabel->
  "In[318]:=",ExpressionUUID->"f0dacc84-a419-4e44-8cfa-8a2f7fcc98c7"],

Cell[BoxData[
 RowBox[{
  RowBox[{"4", " ", 
   RowBox[{
    SubscriptBox["p", "1"], "\[CenterDot]", "S", "\[CenterDot]", 
    SubscriptBox["F", "1"], "\[CenterDot]", 
    SubscriptBox["F", "2"], "\[CenterDot]", "v"}]}], "+", 
  RowBox[{"4", " ", 
   RowBox[{
    SubscriptBox["p", "1"], "\[CenterDot]", "S", "\[CenterDot]", 
    SubscriptBox["F", "2"], "\[CenterDot]", 
    SubscriptBox["F", "1"], "\[CenterDot]", "v"}]}], "-", 
  RowBox[{"4", " ", 
   RowBox[{
    SubscriptBox["p", "1"], "\[CenterDot]", 
    SubscriptBox["F", "2"], "\[CenterDot]", "S", "\[CenterDot]", 
    SubscriptBox["F", "1"], "\[CenterDot]", "v"}]}], "+", 
  RowBox[{"4", " ", 
   RowBox[{
    SubscriptBox["p", "2"], "\[CenterDot]", "S", "\[CenterDot]", 
    SubscriptBox["F", "2"], "\[CenterDot]", 
    SubscriptBox["F", "1"], "\[CenterDot]", "v"}]}]}]], "Output",
 CellChangeTimes->{3.8780960628033333`*^9, 3.878111732179213*^9, 
  3.87861652708952*^9, 3.878857285568474*^9},
 CellLabel->
  "Out[318]=",ExpressionUUID->"63a995bd-707b-44f1-b245-4913f0c26360"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"compvp1", "//", "Casesdot"}]], "Input",
 CellChangeTimes->{{3.8780788203554583`*^9, 3.878078825352446*^9}},
 CellLabel->
  "In[319]:=",ExpressionUUID->"4180baca-9159-435e-9c2b-6677e160589e"],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
   RowBox[{"dot", "[", 
    RowBox[{
     RowBox[{"p", "[", "1", "]"}], ",", 
     RowBox[{"p", "[", "2", "]"}]}], "]"}], ",", 
   RowBox[{"dot", "[", 
    RowBox[{
     RowBox[{"p", "[", "1", "]"}], ",", 
     RowBox[{"p", "[", "3", "]"}]}], "]"}], ",", 
   RowBox[{"dot", "[", 
    RowBox[{
     RowBox[{"p", "[", "1", "]"}], ",", 
     RowBox[{"v", "[", "1", "]"}]}], "]"}], ",", 
   RowBox[{"dot", "[", 
    RowBox[{
     RowBox[{"p", "[", "1", "]"}], ",", 
     RowBox[{"\[Epsilon]", "[", "3", "]"}]}], "]"}], ",", 
   RowBox[{"dot", "[", 
    RowBox[{
     RowBox[{"p", "[", "3", "]"}], ",", 
     RowBox[{"\[Epsilon]", "[", "1", "]"}]}], "]"}], ",", 
   RowBox[{"dot", "[", 
    RowBox[{
     RowBox[{"v", "[", "1", "]"}], ",", 
     RowBox[{"\[Epsilon]", "[", "1", "]"}]}], "]"}], ",", 
   RowBox[{"dot", "[", 
    RowBox[{
     RowBox[{"v", "[", "1", "]"}], ",", 
     RowBox[{"\[Epsilon]", "[", "2", "]"}]}], "]"}], ",", 
   RowBox[{"dot", "[", 
    RowBox[{
     RowBox[{"v", "[", "1", "]"}], ",", 
     RowBox[{"\[Epsilon]", "[", "3", "]"}]}], "]"}], ",", 
   RowBox[{"dot", "[", 
    RowBox[{
     RowBox[{"\[Epsilon]", "[", "1", "]"}], ",", 
     RowBox[{"\[Epsilon]", "[", "3", "]"}]}], "]"}], ",", 
   RowBox[{"dot", "[", 
    RowBox[{
     RowBox[{"p", "[", "1", "]"}], ",", 
     RowBox[{"S", "[", "0", "]"}], ",", 
     RowBox[{"p", "[", "3", "]"}]}], "]"}], ",", 
   RowBox[{"dot", "[", 
    RowBox[{
     RowBox[{"p", "[", "1", "]"}], ",", 
     RowBox[{"S", "[", "0", "]"}], ",", 
     RowBox[{"\[Epsilon]", "[", "1", "]"}]}], "]"}], ",", 
   RowBox[{"dot", "[", 
    RowBox[{
     RowBox[{"p", "[", "1", "]"}], ",", 
     RowBox[{"S", "[", "0", "]"}], ",", 
     RowBox[{"\[Epsilon]", "[", "3", "]"}]}], "]"}], ",", 
   RowBox[{"dot", "[", 
    RowBox[{
     RowBox[{"p", "[", "2", "]"}], ",", 
     RowBox[{"S", "[", "0", "]"}], ",", 
     RowBox[{"\[Epsilon]", "[", "2", "]"}]}], "]"}], ",", 
   RowBox[{"dot", "[", 
    RowBox[{
     RowBox[{"p", "[", "3", "]"}], ",", 
     RowBox[{"S", "[", "0", "]"}], ",", 
     RowBox[{"\[Epsilon]", "[", "1", "]"}]}], "]"}], ",", 
   RowBox[{"dot", "[", 
    RowBox[{
     RowBox[{"p", "[", "3", "]"}], ",", 
     RowBox[{"S", "[", "0", "]"}], ",", 
     RowBox[{"\[Epsilon]", "[", "3", "]"}]}], "]"}], ",", 
   RowBox[{"dot", "[", 
    RowBox[{
     RowBox[{"\[Epsilon]", "[", "1", "]"}], ",", 
     RowBox[{"S", "[", "0", "]"}], ",", 
     RowBox[{"\[Epsilon]", "[", "3", "]"}]}], "]"}]}], "}"}]], "Output",
 CellChangeTimes->{3.8780787909855328`*^9, 3.878078825754147*^9, 
  3.8780789139500523`*^9, 3.878079583885482*^9, 3.8780807366766977`*^9, 
  3.87808078442798*^9, 3.878095061451518*^9, 3.87809606280996*^9, 
  3.878111732196608*^9, 3.878616527096223*^9, 3.878857285575058*^9},
 CellLabel->
  "Out[319]=",ExpressionUUID->"64ee6e8c-c220-4e47-b33c-04d7881f51df"]
}, Open  ]],

Cell[BoxData[{
 RowBox[{
  RowBox[{"cvars", "=", 
   RowBox[{
    RowBox[{"Cases", "[", 
     RowBox[{"compvp1", ",", 
      RowBox[{"c", "[", "__", "]"}], ",", 
      RowBox[{"{", 
       RowBox[{"0", ",", "\[Infinity]"}], "}"}]}], "]"}], "//", "Union"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"vardot", "=", 
   RowBox[{"compvp1", "//", "Casesdot"}]}], ";"}]}], "Input",
 CellChangeTimes->{{3.878078218083035*^9, 3.878078227195683*^9}},
 CellLabel->
  "In[320]:=",ExpressionUUID->"de73dfa1-ae0b-4862-a7ac-49bb0c00b87e"],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"cvars", "//", "Length"}]], "Input",
 CellChangeTimes->{{3.878078250405406*^9, 3.8780782515980988`*^9}, 
   3.8780793030421352`*^9, {3.878080618122617*^9, 3.878080619511405*^9}},
 CellLabel->
  "In[322]:=",ExpressionUUID->"bda0c3b7-0b8c-47f3-a81a-619774f37614"],

Cell[BoxData["0"], "Output",
 CellChangeTimes->{
  3.878078252063862*^9, 3.878078732430634*^9, {3.8780792683050127`*^9, 
   3.878079303531766*^9}, {3.8780806116761723`*^9, 3.878080620497012*^9}, 
   3.878080793272333*^9, 3.8780810935750732`*^9, 3.8780811318686132`*^9, 
   3.878081941084124*^9, 3.8780820011325197`*^9, 3.878082120982493*^9, 
   3.878084828486793*^9, 3.878085517830093*^9, 3.878093680935251*^9, 
   3.878095084936636*^9, 3.878096062833789*^9, 3.878106656683487*^9, 
   3.878110745065216*^9, 3.878111732223112*^9, 3.8786165271213827`*^9, 
   3.8788572855908823`*^9},
 CellLabel->
  "Out[322]=",ExpressionUUID->"c9b912fa-1019-4d0e-bb2a-a825eefc9ecb"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{
  RowBox[{"dot2num", ":=", 
   RowBox[{"Table", "[", 
    RowBox[{
     RowBox[{"Rule", "[", 
      RowBox[{
       RowBox[{"vardot", "[", 
        RowBox[{"[", "ii", "]"}], "]"}], ",", 
       RowBox[{"RandomInteger", "[", 
        RowBox[{"{", 
         RowBox[{"10", ",", "100"}], "}"}], "]"}]}], "]"}], ",", 
     RowBox[{"{", 
      RowBox[{"ii", ",", 
       RowBox[{"Length", "[", "vardot", "]"}]}], "}"}]}], "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{"Monitor", "[", 
  RowBox[{
   RowBox[{
    RowBox[{"eqDep", "=", 
     RowBox[{"Table", "[", 
      RowBox[{
       RowBox[{
        RowBox[{"compvp1", "\[Equal]", "0"}], "/.", "dot2num"}], ",", 
       RowBox[{"{", 
        RowBox[{"ii", ",", 
         RowBox[{"10", "+", 
          RowBox[{"Length", "[", "cvars", "]"}]}]}], "}"}]}], "]"}]}], ";"}], 
   ",", "ii"}], "]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"solsvp2", "=", 
   RowBox[{
    RowBox[{"Solve", "[", 
     RowBox[{"eqDep", ",", "cvars"}], "]"}], "[", 
    RowBox[{"[", "1", "]"}], "]"}]}], ";"}]}], "Input",
 CellChangeTimes->{{3.878078221639757*^9, 3.878078240954069*^9}, {
  3.878081064658252*^9, 3.8780810690042477`*^9}, {3.878095748981908*^9, 
  3.878095749098365*^9}},
 CellLabel->
  "In[323]:=",ExpressionUUID->"8b94d3f8-f020-428b-9825-ea39ae125616"],

Cell[BoxData[
 TemplateBox[{
  "Part", "partw", 
   "\"Part \\!\\(\\*RowBox[{\\\"1\\\"}]\\) of \\!\\(\\*RowBox[{\\\"{\\\", \
\\\"}\\\"}]\\) does not exist.\"", 2, 325, 7, 28415626182954115862, "Local"},
  "MessageTemplate"]], "Message", "MSG",
 CellChangeTimes->{3.8781117333994837`*^9, 3.878616527148739*^9, 
  3.8788572856176443`*^9},
 CellLabel->
  "During evaluation of \
In[323]:=",ExpressionUUID->"2a60b4ff-df2c-452d-8a97-24ba6e0be1e0"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData["solsvp2"], "Input",
 CellLabel->
  "In[326]:=",ExpressionUUID->"5bdfdf31-0c8e-40be-ac02-abcbec459edb"],

Cell[BoxData[
 RowBox[{
  RowBox[{"{", "}"}], "\[LeftDoubleBracket]", "1", 
  "\[RightDoubleBracket]"}]], "Output",
 CellChangeTimes->{3.878105405899537*^9, 3.878106662223672*^9, 
  3.8781107493123293`*^9, 3.878111733424849*^9, 3.878616527169042*^9, 
  3.878857285623983*^9},
 CellLabel->
  "Out[326]=",ExpressionUUID->"63cb5054-f716-43e9-8d5a-219236a82737"]
}, Open  ]]
}, Closed]],

Cell[CellGroupData[{

Cell["Factorisation condition v.p3", "Subsection",
 CellChangeTimes->{{3.878076748965989*^9, 3.878076767862722*^9}, {
  3.878093747799068*^9, 3.8780937495889473`*^9}, {3.878095192789927*^9, 
  3.8780951929813747`*^9}},ExpressionUUID->"83c61381-cf0f-42d4-9208-\
7077932484a5"],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{
  RowBox[{"numAnsatz4", "=", 
   RowBox[{
    RowBox[{
     RowBox[{
      RowBox[{
       RowBox[{"(", "numAnsatz3", ")"}], "//.", "dotRules"}], "/.", 
      RowBox[{"(", 
       RowBox[{
        RowBox[{"vonshell", "[", 
         RowBox[{
          RowBox[{"n", "-", "1"}], ",", "2"}], "]"}], "/.", 
        RowBox[{"v", "->", 
         RowBox[{"v", "[", "1", "]"}]}]}], ")"}]}], "/.", "solsvp2"}], "//", 
    "Expand"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{"%", "//", "Length"}]}], "Input",
 CellChangeTimes->{{3.878076776346158*^9, 3.878076791822427*^9}, {
   3.878076863747164*^9, 3.8780768651784353`*^9}, {3.878077446334421*^9, 
   3.878077450450157*^9}, 3.878080568874198*^9, 3.878080843522138*^9, {
   3.878084931218405*^9, 3.8780849369136047`*^9}, {3.878085107286035*^9, 
   3.878085112014679*^9}, {3.8780852927862673`*^9, 3.878085294285921*^9}, {
   3.8780937634764643`*^9, 3.8780937712084923`*^9}, {3.878094578752013*^9, 
   3.87809458003332*^9}, {3.8780951988903418`*^9, 3.8780952057126427`*^9}, {
   3.8780957389282017`*^9, 3.878095739594145*^9}},
 CellLabel->
  "In[327]:=",ExpressionUUID->"9f254a5e-e840-46a3-8ea6-624833a130d2"],

Cell[BoxData[
 TemplateBox[{
  "ReplaceAll", "reps", 
   "\"\\!\\(\\*RowBox[{\\\"{\\\", RowBox[{RowBox[{\\\"{\\\", \\\"}\\\"}], \
\\\"\[LeftDoubleBracket]\\\", \\\"1\\\", \\\"\[RightDoubleBracket]\\\"}], \
\\\"}\\\"}]\\) is neither a list of replacement rules nor a valid dispatch \
table, and so cannot be used for replacing.\"", 2, 327, 8, 
   28415626182954115862, "Local"},
  "MessageTemplate"]], "Message", "MSG",
 CellChangeTimes->{3.878616527175908*^9, 3.878857285636313*^9},
 CellLabel->
  "During evaluation of \
In[327]:=",ExpressionUUID->"7fa0d170-7fb9-49b9-bb8e-590dbe538887"],

Cell[BoxData["2"], "Output",
 CellChangeTimes->{{3.87807677960294*^9, 3.878076792387086*^9}, 
   3.878076869394702*^9, 3.878077463656658*^9, 3.878080582971023*^9, 
   3.878081061748372*^9, 3.878084951014349*^9, 3.878085126532173*^9, 
   3.878085312641127*^9, 3.878093665706396*^9, 3.878094602309922*^9, 
   3.878095215999476*^9, 3.878096067273143*^9, 3.878106671780857*^9, 
   3.878110759023982*^9, 3.878111734770612*^9, 3.878616527176614*^9, 
   3.878857285637163*^9},
 CellLabel->
  "Out[328]=",ExpressionUUID->"4e39cfb3-ff31-4490-b56d-ab3ef233cd71"]
}, Open  ]],

Cell[BoxData[
 RowBox[{
  RowBox[{"numAnsatzvp1", "=", 
   RowBox[{
    RowBox[{
     RowBox[{
      RowBox[{"(", 
       RowBox[{
        RowBox[{
         RowBox[{"(", 
          RowBox[{"numAnsatz4", "//", 
           RowBox[{"Cases", "[", 
            RowBox[{"Times", "[", 
             RowBox[{"f___", ",", 
              RowBox[{"Power", "[", 
               RowBox[{
                RowBox[{"dot", "[", 
                 RowBox[{
                  RowBox[{"p", "[", "3", "]"}], ",", 
                  RowBox[{"v", "[", "1", "]"}]}], "]"}], ",", 
                RowBox[{"-", "1"}]}], "]"}], ",", "g___"}], "]"}], "]"}]}], 
          ")"}], "/.", 
         RowBox[{
          RowBox[{"Power", "[", 
           RowBox[{
            RowBox[{"dot", "[", 
             RowBox[{
              RowBox[{"p", "[", "3", "]"}], ",", 
              RowBox[{"v", "[", "1", "]"}]}], "]"}], ",", 
            RowBox[{"-", "1"}]}], "]"}], "->", "1"}]}], "//", "Total"}], 
       ")"}], "//.", "dotRules"}], "/.", "vponshell"}], "/.", 
    RowBox[{"{", 
     RowBox[{
      RowBox[{
       RowBox[{"dot", "[", 
        RowBox[{
         RowBox[{"p", "[", "3", "]"}], ",", 
         RowBox[{"v", "[", "1", "]"}]}], "]"}], "->", "0"}], ",", 
      RowBox[{
       RowBox[{"dot", "[", 
        RowBox[{
         RowBox[{"p", "[", "2", "]"}], ",", 
         RowBox[{"v", "[", "1", "]"}]}], "]"}], "->", 
       RowBox[{"-", 
        RowBox[{"dot", "[", 
         RowBox[{
          RowBox[{"p", "[", "1", "]"}], ",", 
          RowBox[{"v", "[", "1", "]"}]}], "]"}]}]}]}], "}"}]}]}], 
  ";"}]], "Input",
 CellChangeTimes->{{3.878077052129978*^9, 3.878077125591745*^9}, {
   3.878077237157652*^9, 3.878077281353335*^9}, {3.8780773702267103`*^9, 
   3.8780774435353603`*^9}, {3.8780774739935207`*^9, 3.8780775017717133`*^9}, 
   3.878079930873101*^9, 3.878079973240665*^9, {3.878085415182927*^9, 
   3.8780854153236303`*^9}, 3.878085446328352*^9, {3.878094648731681*^9, 
   3.878094651846068*^9}, {3.878094696417069*^9, 3.878094712612356*^9}, 
   3.8780952799470053`*^9, {3.878095329611971*^9, 3.878095354825946*^9}},
 CellLabel->
  "In[329]:=",ExpressionUUID->"cf70a313-2714-4caa-b2a7-be91a17d9612"],

Cell[BoxData[{
 RowBox[{
  RowBox[{"num1", "=", 
   RowBox[{
    RowBox[{
     RowBox[{"T", "[", 
      RowBox[{"{", "3", "}"}], "]"}], "/.", 
     RowBox[{"T", "->", "T2F"}]}], "/.", 
    RowBox[{"v", "->", 
     RowBox[{"v", "[", "1", "]"}]}]}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"num2", "=", 
   RowBox[{"(", 
    RowBox[{
     FractionBox[
      RowBox[{"dot", "[", 
       RowBox[{
        RowBox[{"p", "[", "1", "]"}], ",", 
        RowBox[{"S", "[", "0", "]"}], ",", 
        RowBox[{"F", "[", "1", "]"}], ",", 
        RowBox[{"F", "[", "2", "]"}], ",", 
        RowBox[{"v", "[", "1", "]"}]}], "]"}], 
      RowBox[{"dot", "[", 
       RowBox[{
        RowBox[{"p", "[", "1", "]"}], ",", 
        RowBox[{"v", "[", "1", "]"}]}], "]"}]], "+", 
     FractionBox[
      RowBox[{"dot", "[", 
       RowBox[{
        RowBox[{"p", "[", "1", "]"}], ",", 
        RowBox[{"S", "[", "0", "]"}], ",", 
        RowBox[{"F", "[", "2", "]"}], ",", 
        RowBox[{"F", "[", "1", "]"}], ",", 
        RowBox[{"v", "[", "1", "]"}]}], "]"}], 
      RowBox[{"dot", "[", 
       RowBox[{
        RowBox[{"p", "[", "1", "]"}], ",", 
        RowBox[{"v", "[", "1", "]"}]}], "]"}]], "-", 
     FractionBox[
      RowBox[{"dot", "[", 
       RowBox[{
        RowBox[{"p", "[", "1", "]"}], ",", 
        RowBox[{"F", "[", "2", "]"}], ",", 
        RowBox[{"S", "[", "0", "]"}], ",", 
        RowBox[{"F", "[", "1", "]"}], ",", 
        RowBox[{"v", "[", "1", "]"}]}], "]"}], 
      RowBox[{"dot", "[", 
       RowBox[{
        RowBox[{"p", "[", "1", "]"}], ",", 
        RowBox[{"v", "[", "1", "]"}]}], "]"}]], "+", 
     FractionBox[
      RowBox[{"dot", "[", 
       RowBox[{
        RowBox[{"p", "[", "2", "]"}], ",", 
        RowBox[{"S", "[", "0", "]"}], ",", 
        RowBox[{"F", "[", "2", "]"}], ",", 
        RowBox[{"F", "[", "1", "]"}], ",", 
        RowBox[{"v", "[", "1", "]"}]}], "]"}], 
      RowBox[{"dot", "[", 
       RowBox[{
        RowBox[{"p", "[", "1", "]"}], ",", 
        RowBox[{"v", "[", "1", "]"}]}], "]"}]]}], ")"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"numvp1", "=", 
   RowBox[{
    RowBox[{
     RowBox[{
      RowBox[{
       RowBox[{"dot", "[", 
        RowBox[{
         RowBox[{
          RowBox[{"p", "[", "1", "]"}], "+", 
          RowBox[{"p", "[", "2", "]"}]}], ",", 
         RowBox[{"p", "[", "3", "]"}]}], "]"}], 
       RowBox[{"(", 
        RowBox[{
         RowBox[{
          RowBox[{"c", "[", "3", "]"}], "num1", "*", "num2"}], "+", 
         RowBox[{
          FractionBox["1", 
           RowBox[{"dot", "[", 
            RowBox[{
             RowBox[{"p", "[", "1", "]"}], ",", 
             RowBox[{"v", "[", "1", "]"}]}], "]"}]], 
          RowBox[{"c", "[", "4", "]"}], 
          RowBox[{"dot", "[", 
           RowBox[{
            RowBox[{"p", "[", "3", "]"}], ",", 
            RowBox[{"S", "[", "0", "]"}], ",", 
            RowBox[{"\[Epsilon]", "[", "3", "]"}]}], "]"}], "*", 
          RowBox[{"dot", "[", 
           RowBox[{
            RowBox[{"v", "[", "1", "]"}], ",", 
            RowBox[{"F", "[", "1", "]"}], ",", 
            RowBox[{"F", "[", "2", "]"}], ",", 
            RowBox[{"v", "[", "1", "]"}]}], "]"}]}]}], ")"}]}], "//.", 
      "dotRules"}], "//", "expandFS"}], "//", "Expand"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"numvp1", "=", 
   RowBox[{
    RowBox[{
     RowBox[{"numvp1", "//.", "dotRules"}], "/.", "vponshell"}], "/.", 
    RowBox[{"{", 
     RowBox[{
      RowBox[{
       RowBox[{"dot", "[", 
        RowBox[{
         RowBox[{"p", "[", "3", "]"}], ",", 
         RowBox[{"v", "[", "1", "]"}]}], "]"}], "->", "0"}], ",", 
      RowBox[{
       RowBox[{"dot", "[", 
        RowBox[{
         RowBox[{"p", "[", "2", "]"}], ",", 
         RowBox[{"v", "[", "1", "]"}]}], "]"}], "->", 
       RowBox[{"-", 
        RowBox[{"dot", "[", 
         RowBox[{
          RowBox[{"p", "[", "1", "]"}], ",", 
          RowBox[{"v", "[", "1", "]"}]}], "]"}]}]}]}], "}"}]}]}], 
  ";"}]}], "Input",
 CellChangeTimes->{{3.878077591985273*^9, 3.8780776461342783`*^9}, {
   3.878077953502172*^9, 3.878077980733405*^9}, {3.878078491930747*^9, 
   3.878078549563458*^9}, {3.878078580745262*^9, 3.87807865251903*^9}, 
   3.878078684800146*^9, {3.878079206140265*^9, 3.878079212664543*^9}, {
   3.878079938416065*^9, 3.8780799390210323`*^9}, {3.878079982854789*^9, 
   3.878079996138009*^9}, 3.878080718496252*^9, 3.878080776110016*^9, {
   3.878081116226698*^9, 3.8780811179219093`*^9}, {3.878081897887516*^9, 
   3.878081929737031*^9}, {3.8780819770250673`*^9, 3.8780819885274878`*^9}, 
   3.8780820357161922`*^9, {3.878082093586617*^9, 3.878082094494379*^9}, 
   3.878082200584118*^9, 3.8780823524734297`*^9, 3.8780843780876017`*^9, {
   3.87808451838385*^9, 3.878084553403726*^9}, {3.878084767872551*^9, 
   3.878084809993238*^9}, {3.878093413770879*^9, 3.878093418381057*^9}, 
   3.878094731163116*^9, {3.878094787760552*^9, 3.878094870939351*^9}, {
   3.878094944453622*^9, 3.878094946794712*^9}, {3.878095374742682*^9, 
   3.878095391986203*^9}, {3.8780954563856373`*^9, 3.878095483306056*^9}, {
   3.878095605265438*^9, 3.878095616154799*^9}, {3.878095684075735*^9, 
   3.878095688268168*^9}},
 CellLabel->
  "In[330]:=",ExpressionUUID->"2944e463-041a-4acb-b4e9-cb5e2bc0dad0"],

Cell[BoxData[
 RowBox[{
  RowBox[{"compvp1", "=", 
   RowBox[{"numAnsatzvp1", "-", "numvp1"}]}], ";"}]], "Input",
 CellChangeTimes->{{3.8780781147500143`*^9, 3.878078179889933*^9}, {
   3.878078714167301*^9, 3.878078719908218*^9}, {3.878078864983605*^9, 
   3.8780788894932623`*^9}, 3.878079927920136*^9, 3.87808000213634*^9},
 CellLabel->
  "In[334]:=",ExpressionUUID->"ceb566d5-292a-4b84-806d-0202035da45c"],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"compvp1", "/.", 
  RowBox[{"{", 
   RowBox[{
    RowBox[{
     RowBox[{"c", "[", "3", "]"}], "->", "1"}], ",", 
    RowBox[{
     RowBox[{"c", "[", "4", "]"}], "->", "1"}]}], "}"}]}]], "Input",
 CellChangeTimes->{{3.878095527643024*^9, 3.878095578279685*^9}, {
  3.878095625110869*^9, 3.878095641471002*^9}},
 CellLabel->
  "In[335]:=",ExpressionUUID->"4e582181-64d9-48f1-8e0b-68bb2f74a942"],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"dot", "[", 
    RowBox[{
     RowBox[{"p", "[", "1", "]"}], ",", 
     RowBox[{"p", "[", "3", "]"}]}], "]"}], " ", 
   RowBox[{"dot", "[", 
    RowBox[{
     RowBox[{"v", "[", "1", "]"}], ",", 
     RowBox[{"\[Epsilon]", "[", "3", "]"}]}], "]"}], " ", 
   RowBox[{"dot", "[", 
    RowBox[{
     RowBox[{"\[Epsilon]", "[", "1", "]"}], ",", 
     RowBox[{"\[Epsilon]", "[", "2", "]"}]}], "]"}], " ", 
   RowBox[{"dot", "[", 
    RowBox[{
     RowBox[{"p", "[", "1", "]"}], ",", 
     RowBox[{"S", "[", "0", "]"}], ",", 
     RowBox[{"p", "[", "2", "]"}]}], "]"}]}], "+", 
  RowBox[{
   RowBox[{"dot", "[", 
    RowBox[{
     RowBox[{"p", "[", "2", "]"}], ",", 
     RowBox[{"p", "[", "3", "]"}]}], "]"}], " ", 
   RowBox[{"dot", "[", 
    RowBox[{
     RowBox[{"v", "[", "1", "]"}], ",", 
     RowBox[{"\[Epsilon]", "[", "3", "]"}]}], "]"}], " ", 
   RowBox[{"dot", "[", 
    RowBox[{
     RowBox[{"\[Epsilon]", "[", "1", "]"}], ",", 
     RowBox[{"\[Epsilon]", "[", "2", "]"}]}], "]"}], " ", 
   RowBox[{"dot", "[", 
    RowBox[{
     RowBox[{"p", "[", "1", "]"}], ",", 
     RowBox[{"S", "[", "0", "]"}], ",", 
     RowBox[{"p", "[", "2", "]"}]}], "]"}]}], "+", 
  RowBox[{
   RowBox[{"dot", "[", 
    RowBox[{
     RowBox[{"p", "[", "1", "]"}], ",", 
     RowBox[{"p", "[", "3", "]"}]}], "]"}], " ", 
   RowBox[{"dot", "[", 
    RowBox[{
     RowBox[{"p", "[", "1", "]"}], ",", 
     RowBox[{"\[Epsilon]", "[", "2", "]"}]}], "]"}], " ", 
   RowBox[{"dot", "[", 
    RowBox[{
     RowBox[{"v", "[", "1", "]"}], ",", 
     RowBox[{"\[Epsilon]", "[", "3", "]"}]}], "]"}], " ", 
   RowBox[{"dot", "[", 
    RowBox[{
     RowBox[{"p", "[", "1", "]"}], ",", 
     RowBox[{"S", "[", "0", "]"}], ",", 
     RowBox[{"\[Epsilon]", "[", "1", "]"}]}], "]"}]}], "+", 
  RowBox[{
   RowBox[{"dot", "[", 
    RowBox[{
     RowBox[{"p", "[", "1", "]"}], ",", 
     RowBox[{"\[Epsilon]", "[", "2", "]"}]}], "]"}], " ", 
   RowBox[{"dot", "[", 
    RowBox[{
     RowBox[{"p", "[", "2", "]"}], ",", 
     RowBox[{"p", "[", "3", "]"}]}], "]"}], " ", 
   RowBox[{"dot", "[", 
    RowBox[{
     RowBox[{"v", "[", "1", "]"}], ",", 
     RowBox[{"\[Epsilon]", "[", "3", "]"}]}], "]"}], " ", 
   RowBox[{"dot", "[", 
    RowBox[{
     RowBox[{"p", "[", "1", "]"}], ",", 
     RowBox[{"S", "[", "0", "]"}], ",", 
     RowBox[{"\[Epsilon]", "[", "1", "]"}]}], "]"}]}], "+", 
  FractionBox[
   RowBox[{
    RowBox[{"dot", "[", 
     RowBox[{
      RowBox[{"p", "[", "1", "]"}], ",", 
      RowBox[{"p", "[", "2", "]"}]}], "]"}], " ", 
    RowBox[{"dot", "[", 
     RowBox[{
      RowBox[{"p", "[", "1", "]"}], ",", 
      RowBox[{"p", "[", "3", "]"}]}], "]"}], " ", 
    RowBox[{"dot", "[", 
     RowBox[{
      RowBox[{"v", "[", "1", "]"}], ",", 
      RowBox[{"\[Epsilon]", "[", "2", "]"}]}], "]"}], " ", 
    RowBox[{"dot", "[", 
     RowBox[{
      RowBox[{"v", "[", "1", "]"}], ",", 
      RowBox[{"\[Epsilon]", "[", "3", "]"}]}], "]"}], " ", 
    RowBox[{"dot", "[", 
     RowBox[{
      RowBox[{"p", "[", "1", "]"}], ",", 
      RowBox[{"S", "[", "0", "]"}], ",", 
      RowBox[{"\[Epsilon]", "[", "1", "]"}]}], "]"}]}], 
   RowBox[{"dot", "[", 
    RowBox[{
     RowBox[{"p", "[", "1", "]"}], ",", 
     RowBox[{"v", "[", "1", "]"}]}], "]"}]], "+", 
  FractionBox[
   RowBox[{
    RowBox[{"dot", "[", 
     RowBox[{
      RowBox[{"p", "[", "1", "]"}], ",", 
      RowBox[{"p", "[", "2", "]"}]}], "]"}], " ", 
    RowBox[{"dot", "[", 
     RowBox[{
      RowBox[{"p", "[", "2", "]"}], ",", 
      RowBox[{"p", "[", "3", "]"}]}], "]"}], " ", 
    RowBox[{"dot", "[", 
     RowBox[{
      RowBox[{"v", "[", "1", "]"}], ",", 
      RowBox[{"\[Epsilon]", "[", "2", "]"}]}], "]"}], " ", 
    RowBox[{"dot", "[", 
     RowBox[{
      RowBox[{"v", "[", "1", "]"}], ",", 
      RowBox[{"\[Epsilon]", "[", "3", "]"}]}], "]"}], " ", 
    RowBox[{"dot", "[", 
     RowBox[{
      RowBox[{"p", "[", "1", "]"}], ",", 
      RowBox[{"S", "[", "0", "]"}], ",", 
      RowBox[{"\[Epsilon]", "[", "1", "]"}]}], "]"}]}], 
   RowBox[{"dot", "[", 
    RowBox[{
     RowBox[{"p", "[", "1", "]"}], ",", 
     RowBox[{"v", "[", "1", "]"}]}], "]"}]], "-", 
  RowBox[{
   RowBox[{"dot", "[", 
    RowBox[{
     RowBox[{"p", "[", "1", "]"}], ",", 
     RowBox[{"p", "[", "3", "]"}]}], "]"}], " ", 
   RowBox[{"dot", "[", 
    RowBox[{
     RowBox[{"p", "[", "2", "]"}], ",", 
     RowBox[{"\[Epsilon]", "[", "1", "]"}]}], "]"}], " ", 
   RowBox[{"dot", "[", 
    RowBox[{
     RowBox[{"v", "[", "1", "]"}], ",", 
     RowBox[{"\[Epsilon]", "[", "3", "]"}]}], "]"}], " ", 
   RowBox[{"dot", "[", 
    RowBox[{
     RowBox[{"p", "[", "1", "]"}], ",", 
     RowBox[{"S", "[", "0", "]"}], ",", 
     RowBox[{"\[Epsilon]", "[", "2", "]"}]}], "]"}]}], "-", 
  RowBox[{
   RowBox[{"dot", "[", 
    RowBox[{
     RowBox[{"p", "[", "2", "]"}], ",", 
     RowBox[{"p", "[", "3", "]"}]}], "]"}], " ", 
   RowBox[{"dot", "[", 
    RowBox[{
     RowBox[{"p", "[", "2", "]"}], ",", 
     RowBox[{"\[Epsilon]", "[", "1", "]"}]}], "]"}], " ", 
   RowBox[{"dot", "[", 
    RowBox[{
     RowBox[{"v", "[", "1", "]"}], ",", 
     RowBox[{"\[Epsilon]", "[", "3", "]"}]}], "]"}], " ", 
   RowBox[{"dot", "[", 
    RowBox[{
     RowBox[{"p", "[", "1", "]"}], ",", 
     RowBox[{"S", "[", "0", "]"}], ",", 
     RowBox[{"\[Epsilon]", "[", "2", "]"}]}], "]"}]}], "+", 
  RowBox[{
   RowBox[{"dot", "[", 
    RowBox[{
     RowBox[{"p", "[", "1", "]"}], ",", 
     RowBox[{"p", "[", "3", "]"}]}], "]"}], " ", 
   RowBox[{"dot", "[", 
    RowBox[{
     RowBox[{"p", "[", "1", "]"}], ",", 
     RowBox[{"\[Epsilon]", "[", "2", "]"}]}], "]"}], " ", 
   RowBox[{"dot", "[", 
    RowBox[{
     RowBox[{"v", "[", "1", "]"}], ",", 
     RowBox[{"\[Epsilon]", "[", "3", "]"}]}], "]"}], " ", 
   RowBox[{"dot", "[", 
    RowBox[{
     RowBox[{"p", "[", "2", "]"}], ",", 
     RowBox[{"S", "[", "0", "]"}], ",", 
     RowBox[{"\[Epsilon]", "[", "1", "]"}]}], "]"}]}], "+", 
  RowBox[{
   RowBox[{"dot", "[", 
    RowBox[{
     RowBox[{"p", "[", "1", "]"}], ",", 
     RowBox[{"\[Epsilon]", "[", "2", "]"}]}], "]"}], " ", 
   RowBox[{"dot", "[", 
    RowBox[{
     RowBox[{"p", "[", "2", "]"}], ",", 
     RowBox[{"p", "[", "3", "]"}]}], "]"}], " ", 
   RowBox[{"dot", "[", 
    RowBox[{
     RowBox[{"v", "[", "1", "]"}], ",", 
     RowBox[{"\[Epsilon]", "[", "3", "]"}]}], "]"}], " ", 
   RowBox[{"dot", "[", 
    RowBox[{
     RowBox[{"p", "[", "2", "]"}], ",", 
     RowBox[{"S", "[", "0", "]"}], ",", 
     RowBox[{"\[Epsilon]", "[", "1", "]"}]}], "]"}]}], "-", 
  RowBox[{
   RowBox[{"dot", "[", 
    RowBox[{
     RowBox[{"p", "[", "1", "]"}], ",", 
     RowBox[{"p", "[", "3", "]"}]}], "]"}], " ", 
   RowBox[{"dot", "[", 
    RowBox[{
     RowBox[{"p", "[", "2", "]"}], ",", 
     RowBox[{"\[Epsilon]", "[", "1", "]"}]}], "]"}], " ", 
   RowBox[{"dot", "[", 
    RowBox[{
     RowBox[{"v", "[", "1", "]"}], ",", 
     RowBox[{"\[Epsilon]", "[", "3", "]"}]}], "]"}], " ", 
   RowBox[{"dot", "[", 
    RowBox[{
     RowBox[{"p", "[", "2", "]"}], ",", 
     RowBox[{"S", "[", "0", "]"}], ",", 
     RowBox[{"\[Epsilon]", "[", "2", "]"}]}], "]"}]}], "-", 
  RowBox[{
   RowBox[{"dot", "[", 
    RowBox[{
     RowBox[{"p", "[", "2", "]"}], ",", 
     RowBox[{"p", "[", "3", "]"}]}], "]"}], " ", 
   RowBox[{"dot", "[", 
    RowBox[{
     RowBox[{"p", "[", "2", "]"}], ",", 
     RowBox[{"\[Epsilon]", "[", "1", "]"}]}], "]"}], " ", 
   RowBox[{"dot", "[", 
    RowBox[{
     RowBox[{"v", "[", "1", "]"}], ",", 
     RowBox[{"\[Epsilon]", "[", "3", "]"}]}], "]"}], " ", 
   RowBox[{"dot", "[", 
    RowBox[{
     RowBox[{"p", "[", "2", "]"}], ",", 
     RowBox[{"S", "[", "0", "]"}], ",", 
     RowBox[{"\[Epsilon]", "[", "2", "]"}]}], "]"}]}], "+", 
  FractionBox[
   RowBox[{
    RowBox[{"dot", "[", 
     RowBox[{
      RowBox[{"p", "[", "1", "]"}], ",", 
      RowBox[{"p", "[", "2", "]"}]}], "]"}], " ", 
    RowBox[{"dot", "[", 
     RowBox[{
      RowBox[{"p", "[", "1", "]"}], ",", 
      RowBox[{"p", "[", "3", "]"}]}], "]"}], " ", 
    RowBox[{"dot", "[", 
     RowBox[{
      RowBox[{"v", "[", "1", "]"}], ",", 
      RowBox[{"\[Epsilon]", "[", "1", "]"}]}], "]"}], " ", 
    RowBox[{"dot", "[", 
     RowBox[{
      RowBox[{"v", "[", "1", "]"}], ",", 
      RowBox[{"\[Epsilon]", "[", "3", "]"}]}], "]"}], " ", 
    RowBox[{"dot", "[", 
     RowBox[{
      RowBox[{"p", "[", "2", "]"}], ",", 
      RowBox[{"S", "[", "0", "]"}], ",", 
      RowBox[{"\[Epsilon]", "[", "2", "]"}]}], "]"}]}], 
   RowBox[{"dot", "[", 
    RowBox[{
     RowBox[{"p", "[", "1", "]"}], ",", 
     RowBox[{"v", "[", "1", "]"}]}], "]"}]], "+", 
  FractionBox[
   RowBox[{
    RowBox[{"dot", "[", 
     RowBox[{
      RowBox[{"p", "[", "1", "]"}], ",", 
      RowBox[{"p", "[", "2", "]"}]}], "]"}], " ", 
    RowBox[{"dot", "[", 
     RowBox[{
      RowBox[{"p", "[", "2", "]"}], ",", 
      RowBox[{"p", "[", "3", "]"}]}], "]"}], " ", 
    RowBox[{"dot", "[", 
     RowBox[{
      RowBox[{"v", "[", "1", "]"}], ",", 
      RowBox[{"\[Epsilon]", "[", "1", "]"}]}], "]"}], " ", 
    RowBox[{"dot", "[", 
     RowBox[{
      RowBox[{"v", "[", "1", "]"}], ",", 
      RowBox[{"\[Epsilon]", "[", "3", "]"}]}], "]"}], " ", 
    RowBox[{"dot", "[", 
     RowBox[{
      RowBox[{"p", "[", "2", "]"}], ",", 
      RowBox[{"S", "[", "0", "]"}], ",", 
      RowBox[{"\[Epsilon]", "[", "2", "]"}]}], "]"}]}], 
   RowBox[{"dot", "[", 
    RowBox[{
     RowBox[{"p", "[", "1", "]"}], ",", 
     RowBox[{"v", "[", "1", "]"}]}], "]"}]], "+", 
  RowBox[{
   RowBox[{"dot", "[", 
    RowBox[{
     RowBox[{"p", "[", "1", "]"}], ",", 
     RowBox[{"p", "[", "3", "]"}]}], "]"}], " ", 
   RowBox[{"dot", "[", 
    RowBox[{
     RowBox[{"p", "[", "1", "]"}], ",", 
     RowBox[{"\[Epsilon]", "[", "2", "]"}]}], "]"}], " ", 
   RowBox[{"dot", "[", 
    RowBox[{
     RowBox[{"v", "[", "1", "]"}], ",", 
     RowBox[{"\[Epsilon]", "[", "1", "]"}]}], "]"}], " ", 
   RowBox[{"dot", "[", 
    RowBox[{
     RowBox[{"p", "[", "3", "]"}], ",", 
     RowBox[{"S", "[", "0", "]"}], ",", 
     RowBox[{"\[Epsilon]", "[", "3", "]"}]}], "]"}]}], "+", 
  RowBox[{
   RowBox[{"dot", "[", 
    RowBox[{
     RowBox[{"p", "[", "1", "]"}], ",", 
     RowBox[{"\[Epsilon]", "[", "2", "]"}]}], "]"}], " ", 
   RowBox[{"dot", "[", 
    RowBox[{
     RowBox[{"p", "[", "2", "]"}], ",", 
     RowBox[{"p", "[", "3", "]"}]}], "]"}], " ", 
   RowBox[{"dot", "[", 
    RowBox[{
     RowBox[{"v", "[", "1", "]"}], ",", 
     RowBox[{"\[Epsilon]", "[", "1", "]"}]}], "]"}], " ", 
   RowBox[{"dot", "[", 
    RowBox[{
     RowBox[{"p", "[", "3", "]"}], ",", 
     RowBox[{"S", "[", "0", "]"}], ",", 
     RowBox[{"\[Epsilon]", "[", "3", "]"}]}], "]"}]}], "-", 
  RowBox[{
   RowBox[{"dot", "[", 
    RowBox[{
     RowBox[{"p", "[", "1", "]"}], ",", 
     RowBox[{"p", "[", "3", "]"}]}], "]"}], " ", 
   RowBox[{"dot", "[", 
    RowBox[{
     RowBox[{"p", "[", "2", "]"}], ",", 
     RowBox[{"\[Epsilon]", "[", "1", "]"}]}], "]"}], " ", 
   RowBox[{"dot", "[", 
    RowBox[{
     RowBox[{"v", "[", "1", "]"}], ",", 
     RowBox[{"\[Epsilon]", "[", "2", "]"}]}], "]"}], " ", 
   RowBox[{"dot", "[", 
    RowBox[{
     RowBox[{"p", "[", "3", "]"}], ",", 
     RowBox[{"S", "[", "0", "]"}], ",", 
     RowBox[{"\[Epsilon]", "[", "3", "]"}]}], "]"}]}], "-", 
  RowBox[{
   RowBox[{"dot", "[", 
    RowBox[{
     RowBox[{"p", "[", "2", "]"}], ",", 
     RowBox[{"p", "[", "3", "]"}]}], "]"}], " ", 
   RowBox[{"dot", "[", 
    RowBox[{
     RowBox[{"p", "[", "2", "]"}], ",", 
     RowBox[{"\[Epsilon]", "[", "1", "]"}]}], "]"}], " ", 
   RowBox[{"dot", "[", 
    RowBox[{
     RowBox[{"v", "[", "1", "]"}], ",", 
     RowBox[{"\[Epsilon]", "[", "2", "]"}]}], "]"}], " ", 
   RowBox[{"dot", "[", 
    RowBox[{
     RowBox[{"p", "[", "3", "]"}], ",", 
     RowBox[{"S", "[", "0", "]"}], ",", 
     RowBox[{"\[Epsilon]", "[", "3", "]"}]}], "]"}]}], "+", 
  FractionBox[
   RowBox[{
    RowBox[{"dot", "[", 
     RowBox[{
      RowBox[{"p", "[", "1", "]"}], ",", 
      RowBox[{"p", "[", "2", "]"}]}], "]"}], " ", 
    RowBox[{"dot", "[", 
     RowBox[{
      RowBox[{"p", "[", "1", "]"}], ",", 
      RowBox[{"p", "[", "3", "]"}]}], "]"}], " ", 
    RowBox[{"dot", "[", 
     RowBox[{
      RowBox[{"v", "[", "1", "]"}], ",", 
      RowBox[{"\[Epsilon]", "[", "1", "]"}]}], "]"}], " ", 
    RowBox[{"dot", "[", 
     RowBox[{
      RowBox[{"v", "[", "1", "]"}], ",", 
      RowBox[{"\[Epsilon]", "[", "2", "]"}]}], "]"}], " ", 
    RowBox[{"dot", "[", 
     RowBox[{
      RowBox[{"p", "[", "3", "]"}], ",", 
      RowBox[{"S", "[", "0", "]"}], ",", 
      RowBox[{"\[Epsilon]", "[", "3", "]"}]}], "]"}]}], 
   RowBox[{"dot", "[", 
    RowBox[{
     RowBox[{"p", "[", "1", "]"}], ",", 
     RowBox[{"v", "[", "1", "]"}]}], "]"}]], "+", 
  FractionBox[
   RowBox[{
    RowBox[{"dot", "[", 
     RowBox[{
      RowBox[{"p", "[", "1", "]"}], ",", 
      RowBox[{"p", "[", "2", "]"}]}], "]"}], " ", 
    RowBox[{"dot", "[", 
     RowBox[{
      RowBox[{"p", "[", "2", "]"}], ",", 
      RowBox[{"p", "[", "3", "]"}]}], "]"}], " ", 
    RowBox[{"dot", "[", 
     RowBox[{
      RowBox[{"v", "[", "1", "]"}], ",", 
      RowBox[{"\[Epsilon]", "[", "1", "]"}]}], "]"}], " ", 
    RowBox[{"dot", "[", 
     RowBox[{
      RowBox[{"v", "[", "1", "]"}], ",", 
      RowBox[{"\[Epsilon]", "[", "2", "]"}]}], "]"}], " ", 
    RowBox[{"dot", "[", 
     RowBox[{
      RowBox[{"p", "[", "3", "]"}], ",", 
      RowBox[{"S", "[", "0", "]"}], ",", 
      RowBox[{"\[Epsilon]", "[", "3", "]"}]}], "]"}]}], 
   RowBox[{"dot", "[", 
    RowBox[{
     RowBox[{"p", "[", "1", "]"}], ",", 
     RowBox[{"v", "[", "1", "]"}]}], "]"}]], "-", 
  RowBox[{
   RowBox[{"dot", "[", 
    RowBox[{
     RowBox[{"p", "[", "1", "]"}], ",", 
     RowBox[{"p", "[", "3", "]"}]}], "]"}], " ", 
   RowBox[{"dot", "[", 
    RowBox[{
     RowBox[{"p", "[", "1", "]"}], ",", 
     RowBox[{"v", "[", "1", "]"}]}], "]"}], " ", 
   RowBox[{"dot", "[", 
    RowBox[{
     RowBox[{"\[Epsilon]", "[", "1", "]"}], ",", 
     RowBox[{"\[Epsilon]", "[", "2", "]"}]}], "]"}], " ", 
   RowBox[{"dot", "[", 
    RowBox[{
     RowBox[{"p", "[", "3", "]"}], ",", 
     RowBox[{"S", "[", "0", "]"}], ",", 
     RowBox[{"\[Epsilon]", "[", "3", "]"}]}], "]"}]}], "-", 
  RowBox[{
   RowBox[{"dot", "[", 
    RowBox[{
     RowBox[{"p", "[", "1", "]"}], ",", 
     RowBox[{"v", "[", "1", "]"}]}], "]"}], " ", 
   RowBox[{"dot", "[", 
    RowBox[{
     RowBox[{"p", "[", "2", "]"}], ",", 
     RowBox[{"p", "[", "3", "]"}]}], "]"}], " ", 
   RowBox[{"dot", "[", 
    RowBox[{
     RowBox[{"\[Epsilon]", "[", "1", "]"}], ",", 
     RowBox[{"\[Epsilon]", "[", "2", "]"}]}], "]"}], " ", 
   RowBox[{"dot", "[", 
    RowBox[{
     RowBox[{"p", "[", "3", "]"}], ",", 
     RowBox[{"S", "[", "0", "]"}], ",", 
     RowBox[{"\[Epsilon]", "[", "3", "]"}]}], "]"}]}], "+", 
  RowBox[{
   RowBox[{"dot", "[", 
    RowBox[{
     RowBox[{"p", "[", "1", "]"}], ",", 
     RowBox[{"p", "[", "2", "]"}]}], "]"}], " ", 
   RowBox[{"dot", "[", 
    RowBox[{
     RowBox[{"p", "[", "1", "]"}], ",", 
     RowBox[{"p", "[", "3", "]"}]}], "]"}], " ", 
   RowBox[{"dot", "[", 
    RowBox[{
     RowBox[{"v", "[", "1", "]"}], ",", 
     RowBox[{"\[Epsilon]", "[", "3", "]"}]}], "]"}], " ", 
   RowBox[{"dot", "[", 
    RowBox[{
     RowBox[{"\[Epsilon]", "[", "1", "]"}], ",", 
     RowBox[{"S", "[", "0", "]"}], ",", 
     RowBox[{"\[Epsilon]", "[", "2", "]"}]}], "]"}]}], "+", 
  RowBox[{
   RowBox[{"dot", "[", 
    RowBox[{
     RowBox[{"p", "[", "1", "]"}], ",", 
     RowBox[{"p", "[", "2", "]"}]}], "]"}], " ", 
   RowBox[{"dot", "[", 
    RowBox[{
     RowBox[{"p", "[", "2", "]"}], ",", 
     RowBox[{"p", "[", "3", "]"}]}], "]"}], " ", 
   RowBox[{"dot", "[", 
    RowBox[{
     RowBox[{"v", "[", "1", "]"}], ",", 
     RowBox[{"\[Epsilon]", "[", "3", "]"}]}], "]"}], " ", 
   RowBox[{"dot", "[", 
    RowBox[{
     RowBox[{"\[Epsilon]", "[", "1", "]"}], ",", 
     RowBox[{"S", "[", "0", "]"}], ",", 
     RowBox[{"\[Epsilon]", "[", "2", "]"}]}], "]"}]}]}]], "Output",
 CellChangeTimes->{{3.878095519546192*^9, 3.878095530830967*^9}, {
   3.8780955685470467`*^9, 3.878095578769575*^9}, {3.8780956254979887`*^9, 
   3.87809564203146*^9}, 3.878095695176092*^9, 3.8780960673961983`*^9, 
   3.8781117349284163`*^9, 3.878616527269444*^9, 3.8788572857210712`*^9},
 CellLabel->
  "Out[335]=",ExpressionUUID->"dbb4ea29-902c-4dcf-9a7e-9ea72c34d02f"]
}, Open  ]],

Cell[BoxData[{
 RowBox[{
  RowBox[{"cvars", "=", 
   RowBox[{
    RowBox[{"Cases", "[", 
     RowBox[{"compvp1", ",", 
      RowBox[{"c", "[", "__", "]"}], ",", 
      RowBox[{"{", 
       RowBox[{"0", ",", "\[Infinity]"}], "}"}]}], "]"}], "//", "Union"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"vardot", "=", 
   RowBox[{"compvp1", "//", "Casesdot"}]}], ";"}]}], "Input",
 CellChangeTimes->{{3.878078218083035*^9, 3.878078227195683*^9}},
 CellLabel->
  "In[336]:=",ExpressionUUID->"578da957-5282-4fd5-9530-ac3721c0f902"],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"cvars", "//", "Length"}]], "Input",
 CellChangeTimes->{{3.878078250405406*^9, 3.8780782515980988`*^9}, 
   3.8780793030421352`*^9, {3.878080618122617*^9, 3.878080619511405*^9}},
 CellLabel->
  "In[338]:=",ExpressionUUID->"55a88c8e-c935-44b1-abdc-81867df14125"],

Cell[BoxData["2"], "Output",
 CellChangeTimes->{
  3.878078252063862*^9, 3.878078732430634*^9, {3.8780792683050127`*^9, 
   3.878079303531766*^9}, {3.8780806116761723`*^9, 3.878080620497012*^9}, 
   3.878080793272333*^9, 3.8780810935750732`*^9, 3.8780811318686132`*^9, 
   3.878081941084124*^9, 3.8780820011325197`*^9, 3.878082120982493*^9, 
   3.878084828486793*^9, 3.878085517830093*^9, 3.878093680935251*^9, 
   3.878095084936636*^9, 3.878095713545517*^9, 3.878096067412579*^9, 
   3.878111734948662*^9, 3.878616527291059*^9, 3.87885728573694*^9},
 CellLabel->
  "Out[338]=",ExpressionUUID->"b6bdaf39-4570-4fe2-85ee-60e6c3c98d7a"]
}, Open  ]],

Cell[BoxData[{
 RowBox[{
  RowBox[{"dot2num", ":=", 
   RowBox[{"Table", "[", 
    RowBox[{
     RowBox[{"Rule", "[", 
      RowBox[{
       RowBox[{"vardot", "[", 
        RowBox[{"[", "ii", "]"}], "]"}], ",", 
       RowBox[{"RandomInteger", "[", 
        RowBox[{"{", 
         RowBox[{"10", ",", "100"}], "}"}], "]"}]}], "]"}], ",", 
     RowBox[{"{", 
      RowBox[{"ii", ",", 
       RowBox[{"Length", "[", "vardot", "]"}]}], "}"}]}], "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{"Monitor", "[", 
  RowBox[{
   RowBox[{
    RowBox[{"eqDep", "=", 
     RowBox[{"Table", "[", 
      RowBox[{
       RowBox[{
        RowBox[{"compvp1", "\[Equal]", "0"}], "/.", "dot2num"}], ",", 
       RowBox[{"{", 
        RowBox[{"ii", ",", 
         RowBox[{"10", "+", 
          RowBox[{"Length", "[", "cvars", "]"}]}]}], "}"}]}], "]"}]}], ";"}], 
   ",", "ii"}], "]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"solsvp3", "=", 
   RowBox[{
    RowBox[{"Solve", "[", 
     RowBox[{"eqDep", ",", "cvars"}], "]"}], "[", 
    RowBox[{"[", "1", "]"}], "]"}]}], ";"}]}], "Input",
 CellChangeTimes->{{3.878078221639757*^9, 3.878078240954069*^9}, {
  3.878081064658252*^9, 3.8780810690042477`*^9}, {3.878095733492796*^9, 
  3.878095733629385*^9}},
 CellLabel->
  "In[339]:=",ExpressionUUID->"55ed02f0-5029-4486-8aa9-90f743334a2d"],

Cell[CellGroupData[{

Cell[BoxData["solsvp3"], "Input",
 CellChangeTimes->{{3.878096861054673*^9, 3.8780968614695673`*^9}},
 CellLabel->
  "In[342]:=",ExpressionUUID->"530c074c-4a1f-4e4c-b6fb-3525f3d0619d"],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
   RowBox[{
    RowBox[{"c", "[", "3", "]"}], "\[Rule]", "0"}], ",", 
   RowBox[{
    RowBox[{"c", "[", "4", "]"}], "\[Rule]", "0"}]}], "}"}]], "Output",
 CellChangeTimes->{3.878093691306862*^9, 3.878095112706624*^9, 
  3.878095717543086*^9, 3.878096067453002*^9, 3.878096861847978*^9, 
  3.878106689921917*^9, 3.8781107730356693`*^9, 3.8781117350474157`*^9, 
  3.87861652733291*^9, 3.878857285774596*^9},
 CellLabel->
  "Out[342]=",ExpressionUUID->"cd2cd212-3293-4555-ba1b-7d4854487e3f"]
}, Open  ]]
}, Closed]],

Cell[CellGroupData[{

Cell["Final Result", "Subsection",
 CellChangeTimes->{{3.878095815607132*^9, 
  3.878095824409616*^9}},ExpressionUUID->"90bcefed-5dc3-4e0f-aad2-\
1b12a6b9f00c"],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{
     RowBox[{
      RowBox[{"numAnsatz", "/.", "sols"}], "/.", "solsvp1"}], "/.", 
     "solsvp2"}], "/.", 
    RowBox[{
     RowBox[{"c", "[", "__", "]"}], ":>", "0"}]}], "/.", "nicevs"}], "//.", 
  "nice"}]], "Input",
 CellChangeTimes->{{3.878096992646886*^9, 3.8780970253597383`*^9}, {
  3.878097865895237*^9, 3.878097895808736*^9}},
 CellLabel->
  "In[343]:=",ExpressionUUID->"60fe8754-c35b-431a-a109-481025a83ebd"],

Cell[BoxData[
 TemplateBox[{
  "ReplaceAll", "reps", 
   "\"\\!\\(\\*RowBox[{\\\"{\\\", RowBox[{RowBox[{\\\"{\\\", \\\"}\\\"}], \
\\\"\[LeftDoubleBracket]\\\", \\\"1\\\", \\\"\[RightDoubleBracket]\\\"}], \
\\\"}\\\"}]\\) is neither a list of replacement rules nor a valid dispatch \
table, and so cannot be used for replacing.\"", 2, 343, 9, 
   28415626182954115862, "Local"},
  "MessageTemplate"]], "Message", "MSG",
 CellChangeTimes->{3.8786165274411287`*^9, 3.878857285883094*^9},
 CellLabel->
  "During evaluation of \
In[343]:=",ExpressionUUID->"2fee735f-6b62-4a73-a1d4-a9613e811482"],

Cell[BoxData[
 TemplateBox[{
  "ReplaceAll", "reps", 
   "\"\\!\\(\\*RowBox[{\\\"{\\\", RowBox[{RowBox[{\\\"{\\\", \\\"}\\\"}], \
\\\"\[LeftDoubleBracket]\\\", \\\"1\\\", \\\"\[RightDoubleBracket]\\\"}], \
\\\"}\\\"}]\\) is neither a list of replacement rules nor a valid dispatch \
table, and so cannot be used for replacing.\"", 2, 343, 10, 
   28415626182954115862, "Local"},
  "MessageTemplate"]], "Message", "MSG",
 CellChangeTimes->{3.8786165274411287`*^9, 3.878857285884182*^9},
 CellLabel->
  "During evaluation of \
In[343]:=",ExpressionUUID->"a36ae5f0-2665-41a4-b7a7-b7bf511dac5a"],

Cell[BoxData[
 TemplateBox[{
  "ReplaceAll", "reps", 
   "\"\\!\\(\\*RowBox[{\\\"{\\\", RowBox[{RowBox[{\\\"{\\\", \\\"}\\\"}], \
\\\"\[LeftDoubleBracket]\\\", \\\"1\\\", \\\"\[RightDoubleBracket]\\\"}], \
\\\"}\\\"}]\\) is neither a list of replacement rules nor a valid dispatch \
table, and so cannot be used for replacing.\"", 2, 343, 11, 
   28415626182954115862, "Local"},
  "MessageTemplate"]], "Message", "MSG",
 CellChangeTimes->{3.8786165274411287`*^9, 3.878857285889477*^9},
 CellLabel->
  "During evaluation of \
In[343]:=",ExpressionUUID->"150b6577-c645-4ed1-9dec-fc214c3c883e"],

Cell[BoxData[
 TemplateBox[{
  "General", "stop", 
   "\"Further output of \\!\\(\\*StyleBox[RowBox[{\\\"ReplaceAll\\\", \
\\\"::\\\", \\\"reps\\\"}], \\\"MessageName\\\"]\\) will be suppressed during \
this calculation.\"", 2, 343, 12, 28415626182954115862, "Local"},
  "MessageTemplate"]], "Message", "MSG",
 CellChangeTimes->{3.8786165274411287`*^9, 3.878857285893388*^9},
 CellLabel->
  "During evaluation of \
In[343]:=",ExpressionUUID->"464ad036-7647-418b-8834-ebbb692ff577"],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{
    FractionBox[
     RowBox[{
      RowBox[{
       SubscriptBox["p", "1"], "\[CenterDot]", "S", "\[CenterDot]", 
       SubscriptBox["p", "2"]}], " ", 
      RowBox[{"v", "\[CenterDot]", 
       SubscriptBox["F", "2"], "\[CenterDot]", 
       SubscriptBox["F", "1"], "\[CenterDot]", 
       SubscriptBox["F", "3"], "\[CenterDot]", "v"}]}], 
     RowBox[{
      RowBox[{"v", "\[CenterDot]", 
       SubscriptBox["p", "1"]}], " ", 
      RowBox[{"(", 
       RowBox[{
        RowBox[{"v", "\[CenterDot]", 
         SubscriptBox["p", "1"]}], "+", 
        RowBox[{"v", "\[CenterDot]", 
         SubscriptBox["p", "2"]}]}], ")"}]}]], "-", 
    FractionBox[
     RowBox[{
      RowBox[{
       SubscriptBox["p", "2"], "\[CenterDot]", 
       SubscriptBox["F", "3"], "\[CenterDot]", "v"}], " ", 
      RowBox[{
       SubscriptBox["p", "1"], "\[CenterDot]", "S", "\[CenterDot]", 
       SubscriptBox["F", "1"], "\[CenterDot]", 
       SubscriptBox["F", "2"], "\[CenterDot]", "v"}]}], 
     RowBox[{
      RowBox[{"v", "\[CenterDot]", 
       SubscriptBox["p", "1"]}], " ", 
      RowBox[{"(", 
       RowBox[{
        RowBox[{"v", "\[CenterDot]", 
         SubscriptBox["p", "1"]}], "+", 
        RowBox[{"v", "\[CenterDot]", 
         SubscriptBox["p", "2"]}]}], ")"}]}]], "-", 
    FractionBox[
     RowBox[{
      RowBox[{
       SubscriptBox["p", "1"], "\[CenterDot]", 
       SubscriptBox["F", "2"], "\[CenterDot]", "v"}], " ", 
      RowBox[{
       SubscriptBox["p", "1"], "\[CenterDot]", "S", "\[CenterDot]", 
       SubscriptBox["F", "1"], "\[CenterDot]", 
       SubscriptBox["F", "3"], "\[CenterDot]", "v"}]}], 
     RowBox[{
      RowBox[{"v", "\[CenterDot]", 
       SubscriptBox["p", "1"]}], " ", 
      RowBox[{"(", 
       RowBox[{
        RowBox[{"v", "\[CenterDot]", 
         SubscriptBox["p", "1"]}], "+", 
        RowBox[{"v", "\[CenterDot]", 
         SubscriptBox["p", "2"]}]}], ")"}]}]], "-", 
    FractionBox[
     RowBox[{
      RowBox[{
       SubscriptBox["p", "1"], "\[CenterDot]", 
       SubscriptBox["F", "2"], "\[CenterDot]", "v"}], " ", 
      RowBox[{
       SubscriptBox["p", "1"], "\[CenterDot]", "S", "\[CenterDot]", 
       SubscriptBox["F", "1"], "\[CenterDot]", 
       SubscriptBox["F", "3"], "\[CenterDot]", "v"}]}], 
     RowBox[{
      RowBox[{"v", "\[CenterDot]", 
       SubscriptBox["p", "1"]}], " ", 
      RowBox[{"(", 
       RowBox[{
        RowBox[{"v", "\[CenterDot]", 
         SubscriptBox["p", "1"]}], "+", 
        RowBox[{"v", "\[CenterDot]", 
         SubscriptBox["p", "3"]}]}], ")"}]}]], "-", 
    FractionBox[
     RowBox[{
      RowBox[{
       SubscriptBox["p", "2"], "\[CenterDot]", 
       SubscriptBox["F", "3"], "\[CenterDot]", "v"}], " ", 
      RowBox[{
       SubscriptBox["p", "2"], "\[CenterDot]", "S", "\[CenterDot]", 
       SubscriptBox["F", "1"], "\[CenterDot]", 
       SubscriptBox["F", "2"], "\[CenterDot]", "v"}]}], 
     RowBox[{
      RowBox[{"v", "\[CenterDot]", 
       SubscriptBox["p", "1"]}], " ", 
      RowBox[{"(", 
       RowBox[{
        RowBox[{"v", "\[CenterDot]", 
         SubscriptBox["p", "1"]}], "+", 
        RowBox[{"v", "\[CenterDot]", 
         SubscriptBox["p", "2"]}]}], ")"}]}]], "-", 
    FractionBox[
     RowBox[{
      RowBox[{
       SubscriptBox["p", "1"], "\[CenterDot]", 
       SubscriptBox["F", "2"], "\[CenterDot]", "v"}], " ", 
      RowBox[{
       SubscriptBox["p", "2"], "\[CenterDot]", "S", "\[CenterDot]", 
       SubscriptBox["F", "1"], "\[CenterDot]", 
       SubscriptBox["F", "3"], "\[CenterDot]", "v"}]}], 
     RowBox[{
      RowBox[{"v", "\[CenterDot]", 
       SubscriptBox["p", "1"]}], " ", 
      RowBox[{"(", 
       RowBox[{
        RowBox[{"v", "\[CenterDot]", 
         SubscriptBox["p", "1"]}], "+", 
        RowBox[{"v", "\[CenterDot]", 
         SubscriptBox["p", "2"]}]}], ")"}]}]], "-", 
    FractionBox[
     RowBox[{
      RowBox[{
       SubscriptBox["p", "1"], "\[CenterDot]", 
       SubscriptBox["F", "3"], "\[CenterDot]", "v"}], " ", 
      RowBox[{
       SubscriptBox["p", "2"], "\[CenterDot]", "S", "\[CenterDot]", 
       SubscriptBox["F", "2"], "\[CenterDot]", 
       SubscriptBox["F", "1"], "\[CenterDot]", "v"}]}], 
     RowBox[{
      RowBox[{"v", "\[CenterDot]", 
       SubscriptBox["p", "1"]}], " ", 
      RowBox[{"(", 
       RowBox[{
        RowBox[{"v", "\[CenterDot]", 
         SubscriptBox["p", "1"]}], "+", 
        RowBox[{"v", "\[CenterDot]", 
         SubscriptBox["p", "2"]}]}], ")"}]}]], "-", 
    FractionBox[
     RowBox[{
      RowBox[{
       SubscriptBox["p", "2"], "\[CenterDot]", 
       SubscriptBox["F", "1"], "\[CenterDot]", "v"}], " ", 
      RowBox[{
       SubscriptBox["p", "2"], "\[CenterDot]", "S", "\[CenterDot]", 
       SubscriptBox["F", "2"], "\[CenterDot]", 
       SubscriptBox["F", "3"], "\[CenterDot]", "v"}]}], 
     RowBox[{
      RowBox[{"v", "\[CenterDot]", 
       SubscriptBox["p", "1"]}], " ", 
      RowBox[{"(", 
       RowBox[{
        RowBox[{"v", "\[CenterDot]", 
         SubscriptBox["p", "1"]}], "+", 
        RowBox[{"v", "\[CenterDot]", 
         SubscriptBox["p", "2"]}]}], ")"}]}]], "+", 
    FractionBox[
     RowBox[{
      RowBox[{
       SubscriptBox["p", "1"], "\[CenterDot]", 
       SubscriptBox["F", "3"], "\[CenterDot]", "v"}], " ", 
      RowBox[{
       SubscriptBox["p", "2"], "\[CenterDot]", 
       SubscriptBox["F", "1"], "\[CenterDot]", "S", "\[CenterDot]", 
       SubscriptBox["F", "2"], "\[CenterDot]", "v"}]}], 
     RowBox[{
      RowBox[{"v", "\[CenterDot]", 
       SubscriptBox["p", "1"]}], " ", 
      RowBox[{"(", 
       RowBox[{
        RowBox[{"v", "\[CenterDot]", 
         SubscriptBox["p", "1"]}], "+", 
        RowBox[{"v", "\[CenterDot]", 
         SubscriptBox["p", "2"]}]}], ")"}]}]], "+", 
    FractionBox[
     RowBox[{
      RowBox[{
       SubscriptBox["p", "2"], "\[CenterDot]", 
       SubscriptBox["F", "3"], "\[CenterDot]", "v"}], " ", 
      RowBox[{
       SubscriptBox["p", "2"], "\[CenterDot]", 
       SubscriptBox["F", "1"], "\[CenterDot]", "S", "\[CenterDot]", 
       SubscriptBox["F", "2"], "\[CenterDot]", "v"}]}], 
     RowBox[{
      RowBox[{"v", "\[CenterDot]", 
       SubscriptBox["p", "1"]}], " ", 
      RowBox[{"(", 
       RowBox[{
        RowBox[{"v", "\[CenterDot]", 
         SubscriptBox["p", "1"]}], "+", 
        RowBox[{"v", "\[CenterDot]", 
         SubscriptBox["p", "2"]}]}], ")"}]}]], "-", 
    FractionBox[
     RowBox[{
      RowBox[{
       SubscriptBox["p", "1"], "\[CenterDot]", 
       SubscriptBox["F", "2"], "\[CenterDot]", "v"}], " ", 
      RowBox[{
       SubscriptBox["p", "3"], "\[CenterDot]", "S", "\[CenterDot]", 
       SubscriptBox["F", "1"], "\[CenterDot]", 
       SubscriptBox["F", "3"], "\[CenterDot]", "v"}]}], 
     RowBox[{
      RowBox[{"v", "\[CenterDot]", 
       SubscriptBox["p", "1"]}], " ", 
      RowBox[{"(", 
       RowBox[{
        RowBox[{"v", "\[CenterDot]", 
         SubscriptBox["p", "1"]}], "+", 
        RowBox[{"v", "\[CenterDot]", 
         SubscriptBox["p", "3"]}]}], ")"}]}]], "-", 
    FractionBox[
     RowBox[{
      RowBox[{
       SubscriptBox["p", "1"], "\[CenterDot]", 
       SubscriptBox["F", "2"], "\[CenterDot]", "v"}], " ", 
      RowBox[{
       SubscriptBox["p", "3"], "\[CenterDot]", "S", "\[CenterDot]", 
       SubscriptBox["F", "3"], "\[CenterDot]", 
       SubscriptBox["F", "1"], "\[CenterDot]", "v"}]}], 
     RowBox[{
      RowBox[{"v", "\[CenterDot]", 
       SubscriptBox["p", "1"]}], " ", 
      RowBox[{"(", 
       RowBox[{
        RowBox[{"v", "\[CenterDot]", 
         SubscriptBox["p", "1"]}], "+", 
        RowBox[{"v", "\[CenterDot]", 
         SubscriptBox["p", "3"]}]}], ")"}]}]], "+", 
    FractionBox[
     RowBox[{
      RowBox[{
       SubscriptBox["p", "1"], "\[CenterDot]", 
       SubscriptBox["F", "2"], "\[CenterDot]", "v"}], " ", 
      RowBox[{
       SubscriptBox["p", "3"], "\[CenterDot]", 
       SubscriptBox["F", "1"], "\[CenterDot]", "S", "\[CenterDot]", 
       SubscriptBox["F", "3"], "\[CenterDot]", "v"}]}], 
     RowBox[{
      RowBox[{"v", "\[CenterDot]", 
       SubscriptBox["p", "1"]}], " ", 
      RowBox[{"(", 
       RowBox[{
        RowBox[{"v", "\[CenterDot]", 
         SubscriptBox["p", "1"]}], "+", 
        RowBox[{"v", "\[CenterDot]", 
         SubscriptBox["p", "3"]}]}], ")"}]}]], "+", 
    FractionBox[
     RowBox[{
      SubscriptBox["p", "1"], "\[CenterDot]", "S", "\[CenterDot]", 
      SubscriptBox["F", "1"], "\[CenterDot]", 
      SubscriptBox["F", "2"], "\[CenterDot]", 
      SubscriptBox["F", "3"], "\[CenterDot]", "v"}], 
     RowBox[{"v", "\[CenterDot]", 
      SubscriptBox["p", "1"]}]], "-", 
    FractionBox[
     RowBox[{
      SubscriptBox["p", "1"], "\[CenterDot]", "S", "\[CenterDot]", 
      SubscriptBox["F", "2"], "\[CenterDot]", 
      SubscriptBox["F", "1"], "\[CenterDot]", 
      SubscriptBox["F", "3"], "\[CenterDot]", "v"}], 
     RowBox[{"v", "\[CenterDot]", 
      SubscriptBox["p", "1"]}]], "-", 
    FractionBox[
     RowBox[{
      SubscriptBox["p", "1"], "\[CenterDot]", "S", "\[CenterDot]", 
      SubscriptBox["F", "3"], "\[CenterDot]", 
      SubscriptBox["F", "1"], "\[CenterDot]", 
      SubscriptBox["F", "2"], "\[CenterDot]", "v"}], 
     RowBox[{"v", "\[CenterDot]", 
      SubscriptBox["p", "1"]}]], "+", 
    FractionBox[
     RowBox[{
      SubscriptBox["p", "1"], "\[CenterDot]", 
      SubscriptBox["F", "2"], "\[CenterDot]", "S", "\[CenterDot]", 
      SubscriptBox["F", "1"], "\[CenterDot]", 
      SubscriptBox["F", "3"], "\[CenterDot]", "v"}], 
     RowBox[{"v", "\[CenterDot]", 
      SubscriptBox["p", "1"]}]], "+", 
    FractionBox[
     RowBox[{
      SubscriptBox["p", "1"], "\[CenterDot]", 
      SubscriptBox["F", "3"], "\[CenterDot]", "S", "\[CenterDot]", 
      SubscriptBox["F", "1"], "\[CenterDot]", 
      SubscriptBox["F", "2"], "\[CenterDot]", "v"}], 
     RowBox[{"v", "\[CenterDot]", 
      SubscriptBox["p", "1"]}]], "+", 
    FractionBox[
     RowBox[{
      SubscriptBox["p", "2"], "\[CenterDot]", "S", "\[CenterDot]", 
      SubscriptBox["F", "1"], "\[CenterDot]", 
      SubscriptBox["F", "2"], "\[CenterDot]", 
      SubscriptBox["F", "3"], "\[CenterDot]", "v"}], 
     RowBox[{"v", "\[CenterDot]", 
      SubscriptBox["p", "1"]}]], "-", 
    FractionBox[
     RowBox[{
      SubscriptBox["p", "2"], "\[CenterDot]", "S", "\[CenterDot]", 
      SubscriptBox["F", "3"], "\[CenterDot]", 
      SubscriptBox["F", "1"], "\[CenterDot]", 
      SubscriptBox["F", "2"], "\[CenterDot]", "v"}], 
     RowBox[{"v", "\[CenterDot]", 
      SubscriptBox["p", "1"]}]], "-", 
    FractionBox[
     RowBox[{
      SubscriptBox["p", "2"], "\[CenterDot]", "S", "\[CenterDot]", 
      SubscriptBox["F", "3"], "\[CenterDot]", 
      SubscriptBox["F", "2"], "\[CenterDot]", 
      SubscriptBox["F", "1"], "\[CenterDot]", "v"}], 
     RowBox[{"v", "\[CenterDot]", 
      SubscriptBox["p", "1"]}]], "-", 
    FractionBox[
     RowBox[{
      SubscriptBox["p", "2"], "\[CenterDot]", 
      SubscriptBox["F", "1"], "\[CenterDot]", "S", "\[CenterDot]", 
      SubscriptBox["F", "2"], "\[CenterDot]", 
      SubscriptBox["F", "3"], "\[CenterDot]", "v"}], 
     RowBox[{"v", "\[CenterDot]", 
      SubscriptBox["p", "1"]}]], "+", 
    FractionBox[
     RowBox[{
      SubscriptBox["p", "2"], "\[CenterDot]", 
      SubscriptBox["F", "1"], "\[CenterDot]", "S", "\[CenterDot]", 
      SubscriptBox["F", "3"], "\[CenterDot]", 
      SubscriptBox["F", "2"], "\[CenterDot]", "v"}], 
     RowBox[{"v", "\[CenterDot]", 
      SubscriptBox["p", "1"]}]], "-", 
    FractionBox[
     RowBox[{
      SubscriptBox["p", "2"], "\[CenterDot]", 
      SubscriptBox["F", "1"], "\[CenterDot]", 
      SubscriptBox["F", "3"], "\[CenterDot]", "S", "\[CenterDot]", 
      SubscriptBox["F", "2"], "\[CenterDot]", "v"}], 
     RowBox[{"v", "\[CenterDot]", 
      SubscriptBox["p", "1"]}]], "+", 
    FractionBox[
     RowBox[{
      SubscriptBox["p", "2"], "\[CenterDot]", 
      SubscriptBox["F", "3"], "\[CenterDot]", "S", "\[CenterDot]", 
      SubscriptBox["F", "1"], "\[CenterDot]", 
      SubscriptBox["F", "2"], "\[CenterDot]", "v"}], 
     RowBox[{"v", "\[CenterDot]", 
      SubscriptBox["p", "1"]}]], "+", 
    FractionBox[
     RowBox[{
      SubscriptBox["p", "2"], "\[CenterDot]", 
      SubscriptBox["F", "3"], "\[CenterDot]", "S", "\[CenterDot]", 
      SubscriptBox["F", "2"], "\[CenterDot]", 
      SubscriptBox["F", "1"], "\[CenterDot]", "v"}], 
     RowBox[{"v", "\[CenterDot]", 
      SubscriptBox["p", "1"]}]], "+", 
    FractionBox[
     RowBox[{
      SubscriptBox["p", "3"], "\[CenterDot]", "S", "\[CenterDot]", 
      SubscriptBox["F", "1"], "\[CenterDot]", 
      SubscriptBox["F", "2"], "\[CenterDot]", 
      SubscriptBox["F", "3"], "\[CenterDot]", "v"}], 
     RowBox[{"v", "\[CenterDot]", 
      SubscriptBox["p", "1"]}]], "-", 
    FractionBox[
     RowBox[{
      SubscriptBox["p", "3"], "\[CenterDot]", "S", "\[CenterDot]", 
      SubscriptBox["F", "2"], "\[CenterDot]", 
      SubscriptBox["F", "1"], "\[CenterDot]", 
      SubscriptBox["F", "3"], "\[CenterDot]", "v"}], 
     RowBox[{"v", "\[CenterDot]", 
      SubscriptBox["p", "1"]}]], "-", 
    FractionBox[
     RowBox[{
      SubscriptBox["p", "3"], "\[CenterDot]", "S", "\[CenterDot]", 
      SubscriptBox["F", "3"], "\[CenterDot]", 
      SubscriptBox["F", "2"], "\[CenterDot]", 
      SubscriptBox["F", "1"], "\[CenterDot]", "v"}], 
     RowBox[{"v", "\[CenterDot]", 
      SubscriptBox["p", "1"]}]], "-", 
    FractionBox[
     RowBox[{
      SubscriptBox["p", "3"], "\[CenterDot]", 
      SubscriptBox["F", "1"], "\[CenterDot]", 
      SubscriptBox["F", "2"], "\[CenterDot]", "S", "\[CenterDot]", 
      SubscriptBox["F", "3"], "\[CenterDot]", "v"}], 
     RowBox[{"v", "\[CenterDot]", 
      SubscriptBox["p", "1"]}]], "+", 
    FractionBox[
     RowBox[{
      SubscriptBox["p", "3"], "\[CenterDot]", 
      SubscriptBox["F", "2"], "\[CenterDot]", 
      SubscriptBox["F", "1"], "\[CenterDot]", "S", "\[CenterDot]", 
      SubscriptBox["F", "3"], "\[CenterDot]", "v"}], 
     RowBox[{"v", "\[CenterDot]", 
      SubscriptBox["p", "1"]}]]}], "/.", "\[VeryThinSpace]", 
   RowBox[{
    RowBox[{"{", "}"}], "\[LeftDoubleBracket]", "1", 
    "\[RightDoubleBracket]"}]}], "/.", "\[VeryThinSpace]", 
  RowBox[{
   RowBox[{"{", "}"}], "\[LeftDoubleBracket]", "1", 
   "\[RightDoubleBracket]"}]}]], "Output",
 CellChangeTimes->{{3.878096994542691*^9, 3.878097026032852*^9}, {
   3.8780978736826763`*^9, 3.878097896716341*^9}, 3.878111735490789*^9, 
   3.878113589747751*^9, 3.878616527468836*^9, 3.878857285899988*^9},
 CellLabel->
  "Out[343]=",ExpressionUUID->"ac20be38-42af-4afb-8517-ca0aea61561c"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"%", "//", "Length"}]], "Input",
 CellChangeTimes->{{3.878113574319078*^9, 3.878113580755939*^9}},
 CellLabel->
  "In[344]:=",ExpressionUUID->"11e0c9cc-4ab9-4885-9725-e46ef5282ed9"],

Cell[BoxData["2"], "Output",
 CellChangeTimes->{{3.878113581227591*^9, 3.8781135923436413`*^9}, 
   3.878616527488133*^9, 3.878857285907564*^9},
 CellLabel->
  "Out[344]=",ExpressionUUID->"dad81f92-3bef-4b43-97f9-e0f57c605a24"]
}, Open  ]]
}, Open  ]]
}, Closed]],

Cell[CellGroupData[{

Cell["Example S Five point Independent ansatz", "Section",
 CellChangeTimes->{{3.877008171032135*^9, 3.877008177039516*^9}, {
  3.8773818494951763`*^9, 3.877381857475391*^9}, {3.878020608795433*^9, 
  3.87802061200184*^9}, {3.878106086500737*^9, 3.878106090914515*^9}, {
  3.878111369500721*^9, 
  3.8781113760129957`*^9}},ExpressionUUID->"69a8eb9f-9bdc-4fc6-90ff-\
d825789bcb7c"],

Cell[CellGroupData[{

Cell["Setup ansatz", "Subsection",
 CellChangeTimes->{{3.877386203620414*^9, 
  3.877386209613765*^9}},ExpressionUUID->"87c7d773-b634-4c06-8e11-\
d3348430a623"],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{
  RowBox[{"n", "=", "5"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"vponshell", "=", 
   RowBox[{
    RowBox[{"vonshell", "[", 
     RowBox[{
      RowBox[{"n", "-", "1"}], ",", "1"}], "]"}], "/.", 
    RowBox[{"v", "->", 
     RowBox[{"v", "[", "1", "]"}]}]}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{"gponshell", "=", 
  RowBox[{
   RowBox[{"onshell", "[", 
    RowBox[{"n", "-", "1"}], "]"}], "/.", 
   RowBox[{
    RowBox[{"s", "[", 
     RowBox[{"i_", ",", "j_"}], "]"}], ":>", 
    RowBox[{"dot", "[", 
     RowBox[{
      RowBox[{"p", "[", "i", "]"}], ",", 
      RowBox[{"p", "[", "j", "]"}]}], "]"}]}]}]}]}], "Input",
 CellChangeTimes->{{3.878020618673658*^9, 3.878020625406555*^9}, {
   3.878020685245474*^9, 3.8780206881234617`*^9}, 3.878021076476811*^9, {
   3.878022447789905*^9, 3.8780224652203074`*^9}, {3.878024579094555*^9, 
   3.87802460824821*^9}},
 CellLabel->
  "In[345]:=",ExpressionUUID->"ab3b459b-5e90-48ea-bb16-27ca136e9a2f"],

Cell[BoxData[
 RowBox[{
  RowBox[{"dot", "[", 
   RowBox[{
    RowBox[{"p", "[", "2", "]"}], ",", 
    RowBox[{"p", "[", "3", "]"}]}], "]"}], "\[Rule]", 
  RowBox[{
   RowBox[{"-", 
    RowBox[{"dot", "[", 
     RowBox[{
      RowBox[{"p", "[", "1", "]"}], ",", 
      RowBox[{"p", "[", "2", "]"}]}], "]"}]}], "-", 
   RowBox[{"dot", "[", 
    RowBox[{
     RowBox[{"p", "[", "1", "]"}], ",", 
     RowBox[{"p", "[", "3", "]"}]}], "]"}]}]}]], "Output",
 CellChangeTimes->{{3.878024603364303*^9, 3.8780246086311693`*^9}, 
   3.8780958347602053`*^9, 3.8781061044812183`*^9, 3.878616527523329*^9, 
   3.878857285934346*^9},
 CellLabel->
  "Out[347]=",ExpressionUUID->"a53cabae-af19-4fc2-a083-250ad05bf644"]
}, Open  ]],

Cell[BoxData[{
 RowBox[{
  RowBox[{"denOrder", "=", "1"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"monofs1", "=", 
   RowBox[{"monoFS", "[", 
    RowBox[{"denOrder", ",", 
     RowBox[{"n", "-", "2"}]}], "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"denOrder", "=", "2"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"monofs2", "=", 
   RowBox[{"monoFS", "[", 
    RowBox[{"denOrder", ",", 
     RowBox[{"n", "-", "2"}]}], "]"}]}], ";"}]}], "Input",
 CellChangeTimes->{{3.877381049405899*^9, 3.877381116483204*^9}, {
  3.877381244223319*^9, 3.877381284761427*^9}, {3.877381353256666*^9, 
  3.877381353488029*^9}, {3.87738186344316*^9, 3.877381863777376*^9}, {
  3.8773822047453117`*^9, 3.877382204987795*^9}, {3.8773825485753727`*^9, 
  3.877382548830839*^9}, {3.877382654557598*^9, 3.877382674685717*^9}, {
  3.878016251644945*^9, 3.87801627282722*^9}, {3.878018811842737*^9, 
  3.878018821618462*^9}, {3.878019111987747*^9, 3.8780191881088953`*^9}, {
  3.8780192243067636`*^9, 3.878019263820836*^9}, {3.8780196953188877`*^9, 
  3.8780197336534443`*^9}, {3.878028860196001*^9, 3.878028905573225*^9}},
 CellLabel->
  "In[348]:=",ExpressionUUID->"10268b10-7e12-4f67-ac7e-7834e7d8622f"],

Cell[BoxData[{
 RowBox[{
  RowBox[{"monofs1", "=", 
   RowBox[{
    RowBox[{
     RowBox[{"(", 
      RowBox[{"List", "@@", 
       RowBox[{"(", 
        RowBox[{
         RowBox[{
          RowBox[{"monofs1", "/.", "vponshell"}], "//", "Total"}], "//", 
         "Expand"}], ")"}]}], ")"}], "/.", 
     RowBox[{
      RowBox[{"a_", " ", "b_"}], ":>", " ", 
      RowBox[{"b", "/;", 
       RowBox[{"NumberQ", "[", "a", "]"}]}]}]}], "//", "Union"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"monofs2", "=", 
   RowBox[{
    RowBox[{
     RowBox[{"(", 
      RowBox[{"List", "@@", 
       RowBox[{"(", 
        RowBox[{
         RowBox[{
          RowBox[{"monofs2", "/.", "vponshell"}], "//", "Total"}], "//", 
         "Expand"}], ")"}]}], ")"}], "/.", 
     RowBox[{
      RowBox[{"a_", " ", "b_"}], ":>", " ", 
      RowBox[{"b", "/;", 
       RowBox[{"NumberQ", "[", "a", "]"}]}]}]}], "//", "Union"}]}], 
  ";"}]}], "Input",
 CellChangeTimes->{{3.878106131993834*^9, 3.8781061481204767`*^9}},
 CellLabel->
  "In[352]:=",ExpressionUUID->"dd6a16d8-db77-40b7-b9a5-a68054310c77"],

Cell[BoxData[
 RowBox[{
  RowBox[{"monofs1", "//", 
   RowBox[{"DeleteCases", "[", 
    RowBox[{"x_", "/;", 
     RowBox[{"(", 
      RowBox[{
       RowBox[{"(", 
        RowBox[{
         RowBox[{
          RowBox[{
           RowBox[{"expandFS", "[", "x", "]"}], "//.", "dotRules"}], "/.", 
          "vponshell"}], "//", "Expand"}], ")"}], "==", "0"}], ")"}]}], 
    "]"}]}], ";"}]], "Input",
 CellChangeTimes->{{3.878108977846291*^9, 3.878109026783236*^9}},
 CellLabel->
  "In[354]:=",ExpressionUUID->"7273cea8-b47a-42ac-aa64-34bbea20dab4"],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"%", "//", "Length"}]], "Input",
 CellChangeTimes->{{3.87810898918363*^9, 3.8781089910668163`*^9}},
 CellLabel->
  "In[355]:=",ExpressionUUID->"11885de8-753d-48de-bb3e-7a6788a2e370"],

Cell[BoxData["42"], "Output",
 CellChangeTimes->{{3.8781089915162067`*^9, 3.878109029411523*^9}, 
   3.878616528593995*^9, 3.878857287025535*^9},
 CellLabel->
  "Out[355]=",ExpressionUUID->"5f304db4-af8d-40b0-8cab-a67b33962944"]
}, Open  ]],

Cell[BoxData[
 RowBox[{
  RowBox[{"numAnsatz", "=", 
   RowBox[{
    RowBox[{"(", 
     RowBox[{
      FractionBox[
       RowBox[{
        RowBox[{
         RowBox[{"(", 
          RowBox[{"c", "/@", 
           RowBox[{"Range", "[", 
            RowBox[{"Length", "@", "monofs2"}], "]"}]}], ")"}], ".", 
         "monofs2"}], "/.", 
        RowBox[{
         RowBox[{"c", "[", "i_", "]"}], ":>", 
         RowBox[{"c", "[", 
          RowBox[{"1", ",", "i"}], "]"}]}]}], 
       RowBox[{
        RowBox[{"dot", "[", 
         RowBox[{
          RowBox[{"v", "[", "1", "]"}], ",", 
          RowBox[{"p", "[", "1", "]"}]}], "]"}], 
        RowBox[{"dot", "[", 
         RowBox[{
          RowBox[{"v", "[", "1", "]"}], ",", 
          RowBox[{
           RowBox[{"p", "[", "1", "]"}], "+", 
           RowBox[{"p", "[", "2", "]"}]}]}], "]"}]}]], "+", 
      FractionBox[
       RowBox[{
        RowBox[{
         RowBox[{"(", 
          RowBox[{"c", "/@", 
           RowBox[{"Range", "[", 
            RowBox[{"Length", "@", "monofs2"}], "]"}]}], ")"}], ".", 
         "monofs2"}], "/.", 
        RowBox[{
         RowBox[{"c", "[", "i_", "]"}], ":>", 
         RowBox[{"c", "[", 
          RowBox[{"2", ",", "i"}], "]"}]}]}], 
       RowBox[{
        RowBox[{"dot", "[", 
         RowBox[{
          RowBox[{"v", "[", "1", "]"}], ",", 
          RowBox[{"p", "[", "1", "]"}]}], "]"}], 
        RowBox[{"dot", "[", 
         RowBox[{
          RowBox[{"v", "[", "1", "]"}], ",", 
          RowBox[{
           RowBox[{"p", "[", "1", "]"}], "+", 
           RowBox[{"p", "[", "3", "]"}]}]}], "]"}]}]], "+", 
      FractionBox[
       RowBox[{
        RowBox[{
         RowBox[{"(", 
          RowBox[{"c", "/@", 
           RowBox[{"Range", "[", 
            RowBox[{"Length", "@", "monofs1"}], "]"}]}], ")"}], ".", 
         "monofs1"}], "/.", 
        RowBox[{
         RowBox[{"c", "[", "i_", "]"}], ":>", 
         RowBox[{"c", "[", 
          RowBox[{"3", ",", "i"}], "]"}]}]}], 
       RowBox[{"dot", "[", 
        RowBox[{
         RowBox[{"v", "[", "1", "]"}], ",", 
         RowBox[{"p", "[", "1", "]"}]}], "]"}]]}], ")"}], "//", "Expand"}]}], 
  ";"}]], "Input",
 CellChangeTimes->{{3.878019818828724*^9, 3.8780199018739433`*^9}, {
  3.878019938561898*^9, 3.878020036527034*^9}, {3.8780201912905703`*^9, 
  3.878020210990015*^9}, {3.87802091215549*^9, 3.8780209153502007`*^9}, {
  3.8780300130461073`*^9, 3.8780300429155807`*^9}, {3.8780319820804033`*^9, 
  3.87803198404319*^9}, {3.878032548017993*^9, 3.87803254970131*^9}, {
  3.8780755773066597`*^9, 3.878075579486418*^9}, {3.87808020451082*^9, 
  3.878080207422474*^9}, {3.8780802418491573`*^9, 3.878080244847021*^9}, {
  3.878080502097672*^9, 3.878080502683258*^9}},
 CellLabel->
  "In[356]:=",ExpressionUUID->"331966e1-7937-4f79-bdf9-84739b0401fc"],

Cell[BoxData[
 RowBox[{
  RowBox[{"cvars", "=", 
   RowBox[{
    RowBox[{"Cases", "[", 
     RowBox[{"numAnsatz", ",", 
      RowBox[{"c", "[", "__", "]"}], ",", 
      RowBox[{"{", 
       RowBox[{"0", ",", "\[Infinity]"}], "}"}]}], "]"}], "//", "Union"}]}], 
  ";"}]], "Input",
 CellChangeTimes->{{3.878109201262475*^9, 3.878109244273675*^9}},
 CellLabel->
  "In[357]:=",ExpressionUUID->"7db4d02a-5d09-45ac-9d45-e0f0ebe8f8c4"],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"cvars", "//", "Length"}]], "Input",
 CellChangeTimes->{{3.878109248356045*^9, 3.878109249212179*^9}},
 CellLabel->
  "In[358]:=",ExpressionUUID->"325078f6-200c-4d93-bfbc-13425e865026"],

Cell[BoxData["450"], "Output",
 CellChangeTimes->{{3.8781092272926903`*^9, 3.878109249608304*^9}, 
   3.878616528628703*^9, 3.878857287052022*^9},
 CellLabel->
  "Out[358]=",ExpressionUUID->"f2a63605-f199-4b7c-b911-1bfb408a5c43"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{
  RowBox[{"ansatzExp", "=", 
   RowBox[{
    RowBox[{
     RowBox[{"(", 
      RowBox[{"numAnsatz", "//", "expandFS"}], ")"}], "//.", "dotRules"}], "/.",
     "vponshell"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"vardot", "=", 
   RowBox[{"ansatzExp", "//", "Casesdot"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"monos", "=", 
   RowBox[{
    RowBox[{"(", 
     RowBox[{"List", "@@", "numAnsatz"}], ")"}], "/.", 
    RowBox[{
     RowBox[{"c", "[", "__", "]"}], ":>", "1"}]}]}], ";"}], "\n", 
 RowBox[{
  RowBox[{"dot2num", ":=", 
   RowBox[{"Table", "[", 
    RowBox[{
     RowBox[{"Rule", "[", 
      RowBox[{
       RowBox[{"vardot", "[", 
        RowBox[{"[", "ii", "]"}], "]"}], ",", 
       RowBox[{"RandomInteger", "[", 
        RowBox[{"{", 
         RowBox[{"10", ",", "100"}], "}"}], "]"}]}], "]"}], ",", 
     RowBox[{"{", 
      RowBox[{"ii", ",", 
       RowBox[{"Length", "[", "vardot", "]"}]}], "}"}]}], "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"eqDep", "=", 
   RowBox[{"Table", "[", 
    RowBox[{
     RowBox[{
      RowBox[{"ansatzExp", "\[Equal]", "0"}], "/.", "dot2num"}], ",", 
     RowBox[{"10", "+", 
      RowBox[{"Length", "[", "cvars", "]"}]}]}], "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"sols", "=", 
   RowBox[{
    RowBox[{"Solve", "[", 
     RowBox[{"eqDep", ",", "cvars"}], "]"}], "[", 
    RowBox[{"[", "1", "]"}], "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"Relations", "=", 
   RowBox[{
    RowBox[{"DeleteCases", "[", 
     RowBox[{
      RowBox[{"List", "@@", 
       RowBox[{"(", 
        RowBox[{
         RowBox[{
          RowBox[{
           RowBox[{"c", "[", "0", "]"}], "+", "numAnsatz"}], "/.", "sols"}], "//", 
         RowBox[{
          RowBox[{"Collect", "[", 
           RowBox[{"#", ",", 
            RowBox[{"c", "[", "i__", "]"}]}], "]"}], "&"}]}], ")"}]}], ",", 
      RowBox[{"c", "[", "0", "]"}]}], "]"}], "/.", 
    RowBox[{"{", 
     RowBox[{
      RowBox[{"c", "[", "i__", "]"}], "\[RuleDelayed]", " ", "1"}], "}"}]}]}],
   ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"RelationsList", "=", 
   RowBox[{"List", "@@@", 
    RowBox[{"(", "Relations", ")"}]}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"monos2M", "=", 
   RowBox[{"MapThread", "[", 
    RowBox[{"Rule", ",", 
     RowBox[{"{", 
      RowBox[{"monos", ",", 
       RowBox[{"M", "/@", 
        RowBox[{"Range", "[", 
         RowBox[{"Length", "@", "monos"}], "]"}]}]}], "}"}]}], "]"}]}], 
  ";"}]}], "Input",
 CellChangeTimes->{{3.878109123063219*^9, 3.878109151384389*^9}, 
   3.878109312908162*^9, 3.8781093917941723`*^9, {3.8781095510549507`*^9, 
   3.878109556589096*^9}, 3.8781104001505823`*^9, 3.8781104740195093`*^9},
 CellLabel->
  "In[359]:=",ExpressionUUID->"b1fbd84f-0433-4910-80e2-5ad8d6dbbddf"],

Cell[BoxData[
 TemplateBox[{
  "Solve", "svars", 
   "\"Equations may not give solutions for all \\\"solve\\\" variables.\"", 2,
    364, 13, 28415626182954115862, "Local"},
  "MessageTemplate"]], "Message", "MSG",
 CellChangeTimes->{
  3.878109588547061*^9, 3.878110431660038*^9, 3.878110505452949*^9, {
   3.8782731342137003`*^9, 3.878273159215098*^9}, 3.878616559662219*^9, 
   3.878857318030851*^9},
 CellLabel->
  "During evaluation of \
In[359]:=",ExpressionUUID->"4d8fa7bc-bd98-4c7a-af92-809be392dc01"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"RelationsList", "[", 
  RowBox[{"[", "1", "]"}], "]"}]], "Input",
 CellChangeTimes->{{3.878110448634164*^9, 3.878110471232892*^9}, {
  3.878110513040512*^9, 3.878110513739974*^9}},
 CellLabel->
  "In[368]:=",ExpressionUUID->"e0810539-063e-4fe3-ac9c-9f1bcde2d45c"],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
   FractionBox[
    RowBox[{
     RowBox[{"dot", "[", 
      RowBox[{
       RowBox[{"p", "[", "1", "]"}], ",", 
       RowBox[{"F", "[", "3", "]"}], ",", 
       RowBox[{"F", "[", "1", "]"}], ",", 
       RowBox[{"v", "[", "1", "]"}]}], "]"}], " ", 
     RowBox[{"dot", "[", 
      RowBox[{
       RowBox[{"p", "[", "2", "]"}], ",", 
       RowBox[{"S", "[", "0", "]"}], ",", 
       RowBox[{"F", "[", "2", "]"}], ",", 
       RowBox[{"v", "[", "1", "]"}]}], "]"}]}], 
    RowBox[{
     RowBox[{"dot", "[", 
      RowBox[{
       RowBox[{"p", "[", "1", "]"}], ",", 
       RowBox[{"v", "[", "1", "]"}]}], "]"}], " ", 
     RowBox[{"(", 
      RowBox[{
       RowBox[{"dot", "[", 
        RowBox[{
         RowBox[{"p", "[", "1", "]"}], ",", 
         RowBox[{"v", "[", "1", "]"}]}], "]"}], "+", 
       RowBox[{"dot", "[", 
        RowBox[{
         RowBox[{"p", "[", "3", "]"}], ",", 
         RowBox[{"v", "[", "1", "]"}]}], "]"}]}], ")"}]}]], ",", 
   FractionBox[
    RowBox[{
     RowBox[{"dot", "[", 
      RowBox[{
       RowBox[{"p", "[", "2", "]"}], ",", 
       RowBox[{"S", "[", "0", "]"}], ",", 
       RowBox[{"F", "[", "2", "]"}], ",", 
       RowBox[{"v", "[", "1", "]"}]}], "]"}], " ", 
     RowBox[{"dot", "[", 
      RowBox[{
       RowBox[{"p", "[", "3", "]"}], ",", 
       RowBox[{"F", "[", "1", "]"}], ",", 
       RowBox[{"F", "[", "3", "]"}], ",", 
       RowBox[{"v", "[", "1", "]"}]}], "]"}]}], 
    RowBox[{
     RowBox[{"dot", "[", 
      RowBox[{
       RowBox[{"p", "[", "1", "]"}], ",", 
       RowBox[{"v", "[", "1", "]"}]}], "]"}], " ", 
     RowBox[{"(", 
      RowBox[{
       RowBox[{"dot", "[", 
        RowBox[{
         RowBox[{"p", "[", "1", "]"}], ",", 
         RowBox[{"v", "[", "1", "]"}]}], "]"}], "+", 
       RowBox[{"dot", "[", 
        RowBox[{
         RowBox[{"p", "[", "2", "]"}], ",", 
         RowBox[{"v", "[", "1", "]"}]}], "]"}]}], ")"}]}]], ",", 
   FractionBox[
    RowBox[{
     RowBox[{"dot", "[", 
      RowBox[{
       RowBox[{"p", "[", "2", "]"}], ",", 
       RowBox[{"S", "[", "0", "]"}], ",", 
       RowBox[{"F", "[", "2", "]"}], ",", 
       RowBox[{"v", "[", "1", "]"}]}], "]"}], " ", 
     RowBox[{"dot", "[", 
      RowBox[{
       RowBox[{"p", "[", "3", "]"}], ",", 
       RowBox[{"F", "[", "1", "]"}], ",", 
       RowBox[{"F", "[", "3", "]"}], ",", 
       RowBox[{"v", "[", "1", "]"}]}], "]"}]}], 
    RowBox[{
     RowBox[{"dot", "[", 
      RowBox[{
       RowBox[{"p", "[", "1", "]"}], ",", 
       RowBox[{"v", "[", "1", "]"}]}], "]"}], " ", 
     RowBox[{"(", 
      RowBox[{
       RowBox[{"dot", "[", 
        RowBox[{
         RowBox[{"p", "[", "1", "]"}], ",", 
         RowBox[{"v", "[", "1", "]"}]}], "]"}], "+", 
       RowBox[{"dot", "[", 
        RowBox[{
         RowBox[{"p", "[", "3", "]"}], ",", 
         RowBox[{"v", "[", "1", "]"}]}], "]"}]}], ")"}]}]]}], "}"}]], "Output",\

 CellChangeTimes->{{3.878110443592762*^9, 3.878110449578101*^9}, {
   3.8781105101039743`*^9, 3.8781105141585693`*^9}, 3.8786165598455667`*^9, 
   3.8788573182168837`*^9},
 CellLabel->
  "Out[368]=",ExpressionUUID->"ae7b2e29-90f7-407b-a64a-859b8c425af2"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"Coefficient", "[", 
  RowBox[{"ansatzExp", ",", 
   RowBox[{"c", "[", 
    RowBox[{"1", ",", "2"}], "]"}]}], "]"}]], "Input",
 CellChangeTimes->{{3.878110136351522*^9, 3.878110155870221*^9}, 
   3.878110203692092*^9},
 CellLabel->
  "In[369]:=",ExpressionUUID->"93bd6c08-6f70-4322-a32c-8e633e25114d"],

Cell[BoxData[
 RowBox[{
  FractionBox["1", 
   RowBox[{"dot", "[", 
    RowBox[{
     RowBox[{"p", "[", "3", "]"}], ",", 
     RowBox[{"v", "[", "1", "]"}]}], "]"}]], 
  RowBox[{
   RowBox[{"(", 
    RowBox[{
     RowBox[{
      RowBox[{"-", 
       RowBox[{"dot", "[", 
        RowBox[{
         RowBox[{"p", "[", "1", "]"}], ",", 
         RowBox[{"\[Epsilon]", "[", "3", "]"}]}], "]"}]}], " ", 
      RowBox[{"(", 
       RowBox[{
        RowBox[{
         RowBox[{"-", 
          RowBox[{"dot", "[", 
           RowBox[{
            RowBox[{"p", "[", "2", "]"}], ",", 
            RowBox[{"v", "[", "1", "]"}]}], "]"}]}], " ", 
         RowBox[{"dot", "[", 
          RowBox[{
           RowBox[{"p", "[", "3", "]"}], ",", 
           RowBox[{"\[Epsilon]", "[", "2", "]"}]}], "]"}]}], "+", 
        RowBox[{
         RowBox[{"dot", "[", 
          RowBox[{
           RowBox[{"p", "[", "2", "]"}], ",", 
           RowBox[{"p", "[", "3", "]"}]}], "]"}], " ", 
         RowBox[{"dot", "[", 
          RowBox[{
           RowBox[{"v", "[", "1", "]"}], ",", 
           RowBox[{"\[Epsilon]", "[", "2", "]"}]}], "]"}]}]}], ")"}]}], "+", 
     RowBox[{
      RowBox[{"dot", "[", 
       RowBox[{
        RowBox[{"p", "[", "1", "]"}], ",", 
        RowBox[{"p", "[", "3", "]"}]}], "]"}], " ", 
      RowBox[{"(", 
       RowBox[{
        RowBox[{
         RowBox[{"dot", "[", 
          RowBox[{
           RowBox[{"p", "[", "2", "]"}], ",", 
           RowBox[{"\[Epsilon]", "[", "3", "]"}]}], "]"}], " ", 
         RowBox[{"dot", "[", 
          RowBox[{
           RowBox[{"v", "[", "1", "]"}], ",", 
           RowBox[{"\[Epsilon]", "[", "2", "]"}]}], "]"}]}], "-", 
        RowBox[{
         RowBox[{"dot", "[", 
          RowBox[{
           RowBox[{"p", "[", "2", "]"}], ",", 
           RowBox[{"v", "[", "1", "]"}]}], "]"}], " ", 
         RowBox[{"dot", "[", 
          RowBox[{
           RowBox[{"\[Epsilon]", "[", "2", "]"}], ",", 
           RowBox[{"\[Epsilon]", "[", "3", "]"}]}], "]"}]}]}], ")"}]}]}], 
    ")"}], " ", 
   RowBox[{"dot", "[", 
    RowBox[{
     RowBox[{"p", "[", "1", "]"}], ",", 
     RowBox[{"S", "[", "0", "]"}], ",", 
     RowBox[{"\[Epsilon]", "[", "1", "]"}]}], "]"}]}]}]], "Output",
 CellChangeTimes->{
  3.878109916109236*^9, {3.878110137200882*^9, 3.878110156401186*^9}, 
   3.8781102039821*^9, 3.878616559870419*^9, 3.8788573182320433`*^9},
 CellLabel->
  "Out[369]=",ExpressionUUID->"816e2604-7066-491e-9886-a68d0ecdfdd6"]
}, Open  ]],

Cell[BoxData[{
 RowBox[{
  RowBox[{"solM", "=", 
   RowBox[{
    RowBox[{"Solve", "[", 
     RowBox[{
      RowBox[{"(", 
       RowBox[{
        RowBox[{"Total", "/@", "RelationsList"}], "/.", "monos2M"}], ")"}], 
      "\[Equal]", "0"}], "]"}], "[", 
    RowBox[{"[", "1", "]"}], "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"eliminate", ":=", 
   RowBox[{"Module", "[", 
    RowBox[{
     RowBox[{"{", "repeated", "}"}], ",", 
     RowBox[{
      RowBox[{"repeated", "=", 
       RowBox[{"{", "}"}]}], ";", 
      RowBox[{"Do", "[", 
       RowBox[{
        RowBox[{"AppendTo", "[", 
         RowBox[{"repeated", ",", 
          RowBox[{"solM", "[", 
           RowBox[{"[", 
            RowBox[{"i", ",", "1"}], "]"}], "]"}]}], "]"}], ",", 
        RowBox[{"{", 
         RowBox[{"i", ",", 
          RowBox[{"Length", "[", "solM", "]"}]}], "}"}]}], "]"}], ";", 
      RowBox[{"Return", "[", "repeated", "]"}]}]}], "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"takeOut", "=", 
   RowBox[{"eliminate", "/.", 
    RowBox[{"{", 
     RowBox[{
      RowBox[{"M", "[", "i_", "]"}], "\[RuleDelayed]", " ", 
      RowBox[{"{", "i", "}"}]}], "}"}]}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"monosIdp", "=", 
   RowBox[{"Delete", "[", 
    RowBox[{"monos", ",", "takeOut"}], "]"}]}], ";"}]}], "Input",
 CellLabel->
  "In[370]:=",ExpressionUUID->"64a868eb-e2d4-4e94-82e1-1bde57c0837c"],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"monos", "//", "Length"}]], "Input",
 CellChangeTimes->{{3.87811053179887*^9, 3.8781105326476603`*^9}},
 CellLabel->
  "In[374]:=",ExpressionUUID->"20be0346-15d6-48da-b01c-8b29af978d5d"],

Cell[BoxData["450"], "Output",
 CellChangeTimes->{3.878110533131216*^9, 3.878616559909316*^9, 
  3.878857318268959*^9},
 CellLabel->
  "Out[374]=",ExpressionUUID->"2a5ba20b-f3f4-4a7c-86bd-d3e1e0686b42"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"monosIdp", "//", "Length"}]], "Input",
 CellChangeTimes->{{3.87811052374531*^9, 3.8781105245452013`*^9}},
 CellLabel->
  "In[375]:=",ExpressionUUID->"380a5a51-bf8b-47e0-a5fe-fd158c775d2b"],

Cell[BoxData["282"], "Output",
 CellChangeTimes->{3.8781105249604273`*^9, 3.878616559926659*^9, 
  3.8788573182799873`*^9},
 CellLabel->
  "Out[375]=",ExpressionUUID->"ab588dc2-773f-4ac5-91fc-58f166632cde"]
}, Open  ]],

Cell[BoxData[{
 RowBox[{
  RowBox[{"cvars", "=", 
   RowBox[{"c", "/@", 
    RowBox[{"Range", "[", 
     RowBox[{"Length", "[", "monosIdp", "]"}], "]"}]}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"ansatzIdp", "=", 
   RowBox[{"(", 
    RowBox[{"monosIdp", ".", "cvars"}], ")"}]}], ";"}]}], "Input",
 CellChangeTimes->{{3.8781105587229347`*^9, 3.878110567515765*^9}},
 CellLabel->
  "In[376]:=",ExpressionUUID->"d82dd100-bacf-4021-8f4d-a291f2a6fe47"]
}, Open  ]],

Cell[CellGroupData[{

Cell["Cut condition Massless", "Subsection",
 CellChangeTimes->{{3.878076730024465*^9, 
  3.8780767381983347`*^9}},ExpressionUUID->"718be8c1-6ad8-4039-8b3e-\
3fd03b15fa11"],

Cell[BoxData[
 RowBox[{
  RowBox[{"nod", "=", 
   RowBox[{
    RowBox[{
     RowBox[{
      RowBox[{
       RowBox[{"(", 
        RowBox[{"ansatzIdp", "//", "expandFS"}], ")"}], "//.", "dotRules"}], "/.",
       "vponshell"}], "/.", 
     RowBox[{
      RowBox[{"\[Epsilon]", "[", "i_", "]"}], ":>", 
      RowBox[{"\[Epsilon]", "[", 
       RowBox[{"p", "[", "i", "]"}], "]"}]}]}], "//", "Expand"}]}], 
  ";"}]], "Input",
 CellChangeTimes->{{3.8780203515119047`*^9, 3.878020399229755*^9}, {
   3.878020431526237*^9, 3.8780204339818277`*^9}, {3.8780205335571136`*^9, 
   3.878020540776443*^9}, 3.8780206405534067`*^9, {3.878020888923959*^9, 
   3.878020889972404*^9}, 3.878021112062257*^9, {3.878022714056156*^9, 
   3.878022715411971*^9}, {3.8780319378374166`*^9, 3.878031956823164*^9}, 
   3.878110574998744*^9},
 CellLabel->
  "In[378]:=",ExpressionUUID->"4012c174-e483-4432-b176-bce09d101456"],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{"bpeff2", "=", 
  RowBox[{"BinaryProduct", "[", 
   RowBox[{"Range", "[", 
    RowBox[{"n", "-", "2"}], "]"}], "]"}]}], "\n", 
 RowBox[{
  RowBox[{"numList", "=", 
   RowBox[{
    RowBox[{
     RowBox[{"ExpandNCM", "/@", 
      RowBox[{"(", 
       RowBox[{"bpeff2", "/.", 
        RowBox[{"X", "\[Rule]", " ", "NC"}]}], ")"}]}], "/.", 
     RowBox[{"NonCommutativeMultiply", "\[Rule]", " ", "T"}]}], "/.", 
    RowBox[{
     RowBox[{"T", "[", 
      RowBox[{"i1_", ",", "f___"}], "]"}], ":>", " ", 
     RowBox[{"0", "/;", 
      RowBox[{"i1", "\[NotEqual]", "1"}]}]}]}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"numListL", "=", 
   RowBox[{"numList", "/.", 
    RowBox[{
     RowBox[{"T", "[", "f___", "]"}], "\[RuleDelayed]", " ", 
     RowBox[{"(", 
      RowBox[{"nod", "/.", 
       RowBox[{"replace", "[", 
        RowBox[{
         RowBox[{"p", "/@", 
          RowBox[{"{", "f", "}"}]}], ",", 
         RowBox[{"n", "-", "1"}]}], "]"}]}], ")"}]}]}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"numListL", "=", 
   RowBox[{
    RowBox[{"(", 
     RowBox[{"numListL", "/.", 
      RowBox[{
       RowBox[{"F", "[", 
        RowBox[{"p", "[", "i_", "]"}], "]"}], ":>", " ", 
       RowBox[{"F", "[", "i", "]"}]}]}], ")"}], "//", "Expand"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"ppListD", "=", 
   RowBox[{"(", 
    RowBox[{"X2Prop", "/@", "bpeff2"}], ")"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"ppListD", "=", 
   RowBox[{
    RowBox[{"ppListD", "/.", 
     RowBox[{
      RowBox[{"p", "[", "f__", "]"}], "\[RuleDelayed]", 
      RowBox[{"Total", "[", 
       RowBox[{"p", "/@", 
        RowBox[{"{", "f", "}"}]}], "]"}]}]}], "/.", 
    RowBox[{
     RowBox[{"dot", "[", 
      RowBox[{
       RowBox[{"p", "[", "i_", "]"}], ",", 
       RowBox[{"p", "[", "i_", "]"}]}], "]"}], ":>", " ", "0"}]}]}], 
  ";"}], "\n", 
 RowBox[{
  RowBox[{"denAll", "=", 
   RowBox[{"Table", "[", 
    RowBox[{
     RowBox[{"ppListD", "[", 
      RowBox[{"[", "ii", "]"}], "]"}], ",", 
     RowBox[{"{", 
      RowBox[{"ii", ",", 
       RowBox[{"Length", "@", "ppListD"}]}], "}"}]}], "]"}]}], ";"}], "\n", 
 RowBox[{
  RowBox[{"amp5", "=", 
   RowBox[{
    RowBox[{
     RowBox[{"Sum", "[", 
      RowBox[{
       FractionBox[
        RowBox[{"numListL", "[", 
         RowBox[{"[", "ii", "]"}], "]"}], 
        RowBox[{"denAll", "[", 
         RowBox[{"[", "ii", "]"}], "]"}]], ",", 
       RowBox[{"{", 
        RowBox[{"ii", ",", 
         RowBox[{"Length", "@", "ppListD"}]}], "}"}]}], "]"}], "/.", 
     RowBox[{
      RowBox[{"\[Epsilon]", "[", 
       RowBox[{"p", "[", "i_", "]"}], "]"}], ":>", 
      RowBox[{"\[Epsilon]", "[", "i", "]"}]}]}], "//", "Expand"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"amp5", "=", 
   RowBox[{
    RowBox[{
     RowBox[{
      RowBox[{"amp5", "/.", "dotRules"}], "/.", "vponshell"}], "/.", 
     "gponshell"}], "//", "Expand"}]}], ";"}]}], "Input",
 CellChangeTimes->{{3.878022027028722*^9, 3.878022028483653*^9}, {
  3.8780224366059227`*^9, 3.878022442198484*^9}, {3.878022763644738*^9, 
  3.878022823789957*^9}, {3.878022855805319*^9, 3.8780228836038427`*^9}, {
  3.878022958964085*^9, 3.8780229728251*^9}, {3.878025964817404*^9, 
  3.878025974154643*^9}, {3.878032030200883*^9, 3.878032043291239*^9}, {
  3.87807694175404*^9, 3.878076942268965*^9}},
 CellLabel->
  "In[379]:=",ExpressionUUID->"bf3f4366-0313-4b02-89ff-01738506712d"],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
   RowBox[{"X", "[", 
    RowBox[{"1", ",", 
     RowBox[{"X", "[", 
      RowBox[{"2", ",", "3"}], "]"}]}], "]"}], ",", 
   RowBox[{"X", "[", 
    RowBox[{
     RowBox[{"X", "[", 
      RowBox[{"1", ",", "2"}], "]"}], ",", "3"}], "]"}]}], "}"}]], "Output",
 CellChangeTimes->{
  3.8780227866981993`*^9, 3.8780228244290047`*^9, {3.878022856995924*^9, 
   3.878022886712186*^9}, {3.878022959975482*^9, 3.8780229734233837`*^9}, 
   3.878025942910557*^9, 3.878025974822631*^9, 3.87802604880019*^9, 
   3.87802893737528*^9, 3.8780300797739983`*^9, 3.87803201555766*^9, 
   3.878032046557034*^9, 3.8780325721214447`*^9, 3.878075893987146*^9, 
   3.8780808478320103`*^9, 3.878093449603753*^9, 3.878095848723765*^9, 
   3.878097128656351*^9, 3.878106459324299*^9, 3.8781105832067327`*^9, 
   3.878616564664537*^9, 3.8788573230623426`*^9},
 CellLabel->
  "Out[379]=",ExpressionUUID->"cf32c65a-0be9-4821-86a2-ec5853871b85"]
}, Open  ]],

Cell[BoxData[{
 RowBox[{
  RowBox[{"num", "=", 
   RowBox[{"\[FivePointedStar]", "[", 
    RowBox[{
     RowBox[{"T", "[", 
      RowBox[{"{", "1", "}"}], "]"}], ",", 
     RowBox[{"T", "[", 
      RowBox[{"{", "2", "}"}], "]"}], ",", 
     RowBox[{"T", "[", 
      RowBox[{"{", "3", "}"}], "]"}]}], "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"nod", "=", 
   RowBox[{
    RowBox[{
     RowBox[{"(", 
      RowBox[{
       RowBox[{
        RowBox[{"num", "/.", 
         RowBox[{"T", "->", "T2F"}]}], "/.", "rmzero"}], "/.", 
       RowBox[{"v", "->", " ", 
        RowBox[{"v", "[", "1", "]"}]}]}], ")"}], "/.", 
     RowBox[{
      RowBox[{"F", "[", "i_", "]"}], ":>", " ", 
      RowBox[{"F", "[", 
       RowBox[{"p", "[", "i", "]"}], "]"}]}]}], "/.", 
    RowBox[{
     RowBox[{"p", "[", 
      RowBox[{"f1_", ",", "g__"}], "]"}], ":>", 
     RowBox[{"P", "[", " ", 
      RowBox[{"Total", "[", 
       RowBox[{"p", "/@", 
        RowBox[{"{", 
         RowBox[{"f1", ",", "g"}], "}"}]}], "]"}], "]"}]}]}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"bpeff2", "=", 
   RowBox[{"BinaryProduct", "[", 
    RowBox[{"Range", "[", 
     RowBox[{"n", "-", "2"}], "]"}], "]"}]}], ";"}], "\n", 
 RowBox[{
  RowBox[{"numList", "=", 
   RowBox[{
    RowBox[{
     RowBox[{"ExpandNCM", "/@", 
      RowBox[{"(", 
       RowBox[{"bpeff2", "/.", 
        RowBox[{"X", "\[Rule]", " ", "NC"}]}], ")"}]}], "/.", 
     RowBox[{"NonCommutativeMultiply", "\[Rule]", " ", "T"}]}], "/.", 
    RowBox[{
     RowBox[{"T", "[", 
      RowBox[{"i1_", ",", "f___"}], "]"}], ":>", " ", 
     RowBox[{"0", "/;", 
      RowBox[{"i1", "\[NotEqual]", "1"}]}]}]}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"numListL", "=", 
   RowBox[{"numList", "/.", 
    RowBox[{
     RowBox[{"T", "[", "f___", "]"}], "\[RuleDelayed]", " ", 
     RowBox[{"(", 
      RowBox[{"nod", "/.", 
       RowBox[{"replace", "[", 
        RowBox[{
         RowBox[{"p", "/@", 
          RowBox[{"{", "f", "}"}]}], ",", 
         RowBox[{"n", "-", "1"}]}], "]"}]}], ")"}]}]}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"numListL", "=", 
   RowBox[{
    RowBox[{"(", 
     RowBox[{"numListL", "/.", 
      RowBox[{
       RowBox[{"F", "[", 
        RowBox[{"p", "[", "i_", "]"}], "]"}], ":>", " ", 
       RowBox[{"F", "[", "i", "]"}]}]}], ")"}], "//", "Expand"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"ppListD", "=", 
   RowBox[{"(", 
    RowBox[{"X2Prop", "/@", "bpeff2"}], ")"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"ppListD", "=", 
   RowBox[{
    RowBox[{"ppListD", "/.", 
     RowBox[{
      RowBox[{"p", "[", "f__", "]"}], "\[RuleDelayed]", 
      RowBox[{"Total", "[", 
       RowBox[{"p", "/@", 
        RowBox[{"{", "f", "}"}]}], "]"}]}]}], "/.", 
    RowBox[{
     RowBox[{"dot", "[", 
      RowBox[{
       RowBox[{"p", "[", "i_", "]"}], ",", 
       RowBox[{"p", "[", "i_", "]"}]}], "]"}], ":>", " ", "0"}]}]}], 
  ";"}], "\n", 
 RowBox[{
  RowBox[{"denAll", "=", 
   RowBox[{"Table", "[", 
    RowBox[{
     RowBox[{"ppListD", "[", 
      RowBox[{"[", "ii", "]"}], "]"}], ",", 
     RowBox[{"{", 
      RowBox[{"ii", ",", 
       RowBox[{"Length", "@", "ppListD"}]}], "}"}]}], "]"}]}], ";"}], "\n", 
 RowBox[{
  RowBox[{"ampYM", "=", 
   RowBox[{
    RowBox[{
     RowBox[{"Sum", "[", 
      RowBox[{
       FractionBox[
        RowBox[{"numListL", "[", 
         RowBox[{"[", "ii", "]"}], "]"}], 
        RowBox[{"denAll", "[", 
         RowBox[{"[", "ii", "]"}], "]"}]], ",", 
       RowBox[{"{", 
        RowBox[{"ii", ",", 
         RowBox[{"Length", "@", "ppListD"}]}], "}"}]}], "]"}], "/.", 
     RowBox[{
      RowBox[{"P", "[", "f_", "]"}], ":>", "f"}]}], "//", "Expand"}]}], 
  ";"}]}], "Input",
 CellChangeTimes->{{3.878023857740679*^9, 3.878023860158512*^9}, {
   3.87802396296658*^9, 3.878024017862441*^9}, {3.878024052254986*^9, 
   3.878024058839876*^9}, {3.8780241059261007`*^9, 3.8780241103419027`*^9}, {
   3.878024288644836*^9, 3.8780243205537767`*^9}, 3.878076927512285*^9},
 CellLabel->
  "In[388]:=",ExpressionUUID->"dbd45628-aed1-4c61-837a-c31fb11c0eb8"],

Cell[BoxData[{
 RowBox[{
  RowBox[{"ampYM", "=", 
   RowBox[{
    RowBox[{"(", 
     RowBox[{
      RowBox[{
       RowBox[{
        RowBox[{
         RowBox[{"(", 
          RowBox[{"ampYM", "//", "expandFS"}], ")"}], "/.", "dotRules"}], "/.",
         "vponshell"}], "/.", "gponshell"}], "//", "Expand"}], ")"}], "//", 
    "MultivariateApart"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"ampYMGlueNum3", "=", 
   RowBox[{
    RowBox[{
     RowBox[{
      RowBox[{
       RowBox[{"ampYM", "/.", 
        RowBox[{"{", 
         RowBox[{
          RowBox[{
           RowBox[{"dot", "[", 
            RowBox[{
             RowBox[{"v", "[", "1", "]"}], ",", "f_"}], "]"}], ":>", 
           RowBox[{"dot", "[", 
            RowBox[{
             RowBox[{
              RowBox[{"p", "[", "1", "]"}], "+", 
              RowBox[{"p", "[", "2", "]"}], "+", 
              RowBox[{"p", "[", "3", "]"}]}], ",", 
             RowBox[{"S", "[", "0", "]"}], ",", "f"}], "]"}]}], ",", 
          RowBox[{
           RowBox[{"dot", "[", 
            RowBox[{"f_", ",", 
             RowBox[{"v", "[", "1", "]"}]}], "]"}], ":>", 
           RowBox[{"dot", "[", 
            RowBox[{
             RowBox[{
              RowBox[{"p", "[", "1", "]"}], "+", 
              RowBox[{"p", "[", "2", "]"}], "+", 
              RowBox[{"p", "[", "3", "]"}]}], ",", 
             RowBox[{"S", "[", "0", "]"}], ",", "f"}], "]"}]}]}], "}"}]}], "/.",
        "dotRules"}], "/.", "vponshell"}], "/.", "gponshell"}], "//", 
    "Expand"}]}], ";"}]}], "Input",
 CellChangeTimes->{{3.878024069941125*^9, 3.87802415205725*^9}, {
   3.878024331157475*^9, 3.878024340048336*^9}, {3.8780243883823147`*^9, 
   3.87802443440853*^9}, {3.878024623562881*^9, 3.878024662661223*^9}, {
   3.878024820522764*^9, 3.878024839044957*^9}, {3.878025373216962*^9, 
   3.878025408461379*^9}, {3.878025474618256*^9, 3.878025484493874*^9}, 
   3.878025529761257*^9, {3.8780757748389797`*^9, 3.878075783185919*^9}, 
   3.878075831065405*^9},
 CellLabel->
  "In[398]:=",ExpressionUUID->"56d665ab-7daf-4738-8cd3-8c9668245f3a"],

Cell[BoxData[
 RowBox[{
  RowBox[{"comp", "=", 
   RowBox[{
    RowBox[{"amp5", "-", "ampYMGlueNum3"}], "//", "Expand"}]}], 
  ";"}]], "Input",
 CellLabel->
  "In[400]:=",ExpressionUUID->"61339348-3ff7-4021-aec5-bcd88ec61e4f"],

Cell[BoxData[
 RowBox[{
  RowBox[{"cvars", "=", 
   RowBox[{
    RowBox[{"Cases", "[", 
     RowBox[{"comp", ",", 
      RowBox[{"c", "[", "__", "]"}], ",", 
      RowBox[{"{", 
       RowBox[{"0", ",", "\[Infinity]"}], "}"}]}], "]"}], "//", "Union"}]}], 
  ";"}]], "Input",
 CellChangeTimes->{{3.8780251119523973`*^9, 3.87802515275441*^9}, {
  3.878033238685581*^9, 3.8780332388754597`*^9}, {3.87807596060207*^9, 
  3.878075960778406*^9}},
 CellLabel->
  "In[401]:=",ExpressionUUID->"db91009e-5f25-458b-9204-da34e407ea01"],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"cvars", "//", "Length"}]], "Input",
 CellChangeTimes->{{3.878025163562392*^9, 3.878025164327901*^9}},
 CellLabel->
  "In[402]:=",ExpressionUUID->"4a26b15b-0fec-4d84-8631-679e3b200441"],

Cell[BoxData["282"], "Output",
 CellChangeTimes->{3.87802516477238*^9, 3.878026076988738*^9, 
  3.878028973567272*^9, 3.8780301059729843`*^9, 3.87803208614393*^9, 
  3.878033255460141*^9, 3.878075964691884*^9, 3.878080856512931*^9, 
  3.878093458365816*^9, 3.878095857461788*^9, 3.878097147230905*^9, 
  3.878106478590885*^9, 3.878110601198616*^9, 3.8786165684736567`*^9, 
  3.8788573268861094`*^9},
 CellLabel->
  "Out[402]=",ExpressionUUID->"41637d3f-e1ce-4be2-a4a4-c5808684050b"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{
  RowBox[{"vardot", "=", 
   RowBox[{"comp", "//", "Casesdot"}]}], ";"}], "\n", 
 RowBox[{
  RowBox[{"dot2num", ":=", 
   RowBox[{"Table", "[", 
    RowBox[{
     RowBox[{"Rule", "[", 
      RowBox[{
       RowBox[{"vardot", "[", 
        RowBox[{"[", "ii", "]"}], "]"}], ",", 
       RowBox[{"RandomInteger", "[", 
        RowBox[{"{", 
         RowBox[{"10", ",", "100"}], "}"}], "]"}]}], "]"}], ",", 
     RowBox[{"{", 
      RowBox[{"ii", ",", 
       RowBox[{"Length", "[", "vardot", "]"}]}], "}"}]}], "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{"Monitor", "[", 
  RowBox[{
   RowBox[{
    RowBox[{"eqDep", "=", 
     RowBox[{"Table", "[", 
      RowBox[{
       RowBox[{
        RowBox[{"comp", "\[Equal]", "0"}], "/.", "dot2num"}], ",", 
       RowBox[{"{", 
        RowBox[{"ii", ",", 
         RowBox[{"10", "+", 
          RowBox[{"Length", "[", "cvars", "]"}]}]}], "}"}]}], "]"}]}], ";"}], 
   ",", "ii"}], "]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"sols", "=", 
   RowBox[{
    RowBox[{"Solve", "[", 
     RowBox[{"eqDep", ",", "cvars"}], "]"}], "[", 
    RowBox[{"[", "1", "]"}], "]"}]}], ";"}]}], "Input",
 CellChangeTimes->{{3.878025083563089*^9, 3.878025098342598*^9}, {
  3.87802516936078*^9, 3.878025185960835*^9}, {3.878033243467019*^9, 
  3.8780332467055893`*^9}, {3.8780759694484453`*^9, 3.878075974363841*^9}},
 CellLabel->
  "In[403]:=",ExpressionUUID->"ee9f6abd-631a-4655-adb3-6a58107d0062"],

Cell[BoxData[
 TemplateBox[{
  "Solve", "svars", 
   "\"Equations may not give solutions for all \\\"solve\\\" variables.\"", 2,
    406, 14, 28415626182954115862, "Local"},
  "MessageTemplate"]], "Message", "MSG",
 CellChangeTimes->{3.87802613489694*^9, 3.878029156688776*^9, 
  3.8780303199023113`*^9, 3.8780322863051863`*^9, 3.878032831294737*^9, 
  3.878033318277973*^9, 3.878076165657085*^9, 3.8780810434805603`*^9, 
  3.878093646396821*^9, 3.878096045334003*^9, 3.878097342954261*^9, 
  3.878106566447481*^9, 3.878110634586054*^9, 3.8786165994349623`*^9, 
  3.8788573578139467`*^9},
 CellLabel->
  "During evaluation of \
In[403]:=",ExpressionUUID->"863a2fd3-3259-4b38-ba42-e6dbd3374934"]
}, Open  ]]
}, Open  ]],

Cell[CellGroupData[{

Cell["Factorisation condition v.p1", "Subsection",
 CellChangeTimes->{{3.878076748965989*^9, 3.878076767862722*^9}, {
  3.87809373543461*^9, 
  3.8780937386875668`*^9}},ExpressionUUID->"8aabd125-c494-4187-89e7-\
b929b0764b68"],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{
  RowBox[{"numAnsatz2", "=", 
   RowBox[{
    RowBox[{
     RowBox[{
      RowBox[{
       RowBox[{"(", 
        RowBox[{"ansatzIdp", "//", "expandFS"}], ")"}], "//.", "dotRules"}], "/.", 
      RowBox[{"(", 
       RowBox[{
        RowBox[{"vonshell", "[", 
         RowBox[{
          RowBox[{"n", "-", "1"}], ",", "3"}], "]"}], "/.", 
        RowBox[{"v", "->", 
         RowBox[{"v", "[", "1", "]"}]}]}], ")"}]}], "/.", "sols"}], "//", 
    "Expand"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{"%", "//", "Length"}]}], "Input",
 CellChangeTimes->{{3.878076776346158*^9, 3.878076791822427*^9}, {
   3.878076863747164*^9, 3.8780768651784353`*^9}, {3.878077446334421*^9, 
   3.878077450450157*^9}, 3.878080568874198*^9, 3.878080843522138*^9, {
   3.878084931218405*^9, 3.8780849369136047`*^9}, {3.878085107286035*^9, 
   3.878085112014679*^9}, {3.8780852927862673`*^9, 3.878085294285921*^9}, 
   3.878110691065761*^9},
 CellLabel->
  "In[407]:=",ExpressionUUID->"b884c4a7-6e73-486a-b319-956d9247baeb"],

Cell[BoxData["1363"], "Output",
 CellChangeTimes->{{3.87807677960294*^9, 3.878076792387086*^9}, 
   3.878076869394702*^9, 3.878077463656658*^9, 3.878080582971023*^9, 
   3.878081061748372*^9, 3.878084951014349*^9, 3.878085126532173*^9, 
   3.878085312641127*^9, 3.878093665706396*^9, 3.87809605896621*^9, 
   3.878106580691216*^9, 3.8781106485337143`*^9, 3.878110695981309*^9, 
   3.878616604033597*^9, 3.8788573624504433`*^9},
 CellLabel->
  "Out[408]=",ExpressionUUID->"96aaad5c-37c2-4650-8bca-1a434b8933d4"]
}, Open  ]],

Cell[BoxData[
 RowBox[{
  RowBox[{"numAnsatzvp1", "=", 
   RowBox[{
    RowBox[{
     RowBox[{
      RowBox[{"(", 
       RowBox[{
        RowBox[{
         RowBox[{"(", 
          RowBox[{"numAnsatz2", "//", 
           RowBox[{"Cases", "[", 
            RowBox[{"Times", "[", 
             RowBox[{"f___", ",", 
              RowBox[{"Power", "[", 
               RowBox[{
                RowBox[{"dot", "[", 
                 RowBox[{
                  RowBox[{"p", "[", "1", "]"}], ",", 
                  RowBox[{"v", "[", "1", "]"}]}], "]"}], ",", 
                RowBox[{"-", "1"}]}], "]"}], ",", "g___"}], "]"}], "]"}]}], 
          ")"}], "/.", 
         RowBox[{
          RowBox[{"Power", "[", 
           RowBox[{
            RowBox[{"dot", "[", 
             RowBox[{
              RowBox[{"p", "[", "1", "]"}], ",", 
              RowBox[{"v", "[", "1", "]"}]}], "]"}], ",", 
            RowBox[{"-", "1"}]}], "]"}], "->", "1"}]}], "//", "Total"}], 
       ")"}], "//.", "dotRules"}], "/.", "vponshell"}], "/.", 
    RowBox[{"{", 
     RowBox[{
      RowBox[{
       RowBox[{"dot", "[", 
        RowBox[{
         RowBox[{"p", "[", "1", "]"}], ",", 
         RowBox[{"v", "[", "1", "]"}]}], "]"}], "->", "0"}], ",", 
      RowBox[{
       RowBox[{"dot", "[", 
        RowBox[{
         RowBox[{"p", "[", "2", "]"}], ",", 
         RowBox[{"v", "[", "1", "]"}]}], "]"}], "->", 
       RowBox[{"-", 
        RowBox[{"dot", "[", 
         RowBox[{
          RowBox[{"p", "[", "3", "]"}], ",", 
          RowBox[{"v", "[", "1", "]"}]}], "]"}]}]}]}], "}"}]}]}], 
  ";"}]], "Input",
 CellChangeTimes->{{3.878077052129978*^9, 3.878077125591745*^9}, {
   3.878077237157652*^9, 3.878077281353335*^9}, {3.8780773702267103`*^9, 
   3.8780774435353603`*^9}, {3.8780774739935207`*^9, 3.8780775017717133`*^9}, 
   3.878079930873101*^9, 3.878079973240665*^9, {3.878085415182927*^9, 
   3.8780854153236303`*^9}, 3.878085446328352*^9},
 CellLabel->
  "In[409]:=",ExpressionUUID->"2e9d51cb-1250-4b8c-84b7-585d3444bb73"],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"numAnsatzvp1", "//", "Length"}]], "Input",
 CellChangeTimes->{{3.878085457345728*^9, 3.878085458484248*^9}},
 CellLabel->
  "In[410]:=",ExpressionUUID->"446ce663-7eb7-4144-b404-73bdfda3b484"],

Cell[BoxData["558"], "Output",
 CellChangeTimes->{{3.878085424115284*^9, 3.8780854589677*^9}, 
   3.878093671135722*^9, 3.878096059862764*^9, 3.878106585270012*^9, 
   3.87811065554213*^9, 3.878110701360381*^9, 3.8786166042952538`*^9, 
   3.8788573627111197`*^9},
 CellLabel->
  "Out[410]=",ExpressionUUID->"62fd3deb-254d-4c6a-9581-9e12485168d9"]
}, Open  ]],

Cell[BoxData[{
 RowBox[{
  RowBox[{"num1", "=", 
   RowBox[{
    RowBox[{
     RowBox[{"T", "[", 
      RowBox[{"{", "1", "}"}], "]"}], "/.", 
     RowBox[{"T", "->", "T2F"}]}], "/.", 
    RowBox[{"v", "->", 
     RowBox[{"v", "[", "1", "]"}]}]}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"num2", "=", 
   RowBox[{"(", 
    RowBox[{
     FractionBox[
      RowBox[{"dot", "[", 
       RowBox[{
        RowBox[{"p", "[", "2", "]"}], ",", 
        RowBox[{"S", "[", "0", "]"}], ",", 
        RowBox[{"F", "[", "2", "]"}], ",", 
        RowBox[{"F", "[", "3", "]"}], ",", 
        RowBox[{"v", "[", "1", "]"}]}], "]"}], 
      RowBox[{"dot", "[", 
       RowBox[{
        RowBox[{"p", "[", "2", "]"}], ",", 
        RowBox[{"v", "[", "1", "]"}]}], "]"}]], "+", 
     FractionBox[
      RowBox[{"dot", "[", 
       RowBox[{
        RowBox[{"p", "[", "2", "]"}], ",", 
        RowBox[{"S", "[", "0", "]"}], ",", 
        RowBox[{"F", "[", "3", "]"}], ",", 
        RowBox[{"F", "[", "2", "]"}], ",", 
        RowBox[{"v", "[", "1", "]"}]}], "]"}], 
      RowBox[{"dot", "[", 
       RowBox[{
        RowBox[{"p", "[", "2", "]"}], ",", 
        RowBox[{"v", "[", "1", "]"}]}], "]"}]], "-", 
     FractionBox[
      RowBox[{"dot", "[", 
       RowBox[{
        RowBox[{"p", "[", "2", "]"}], ",", 
        RowBox[{"F", "[", "3", "]"}], ",", 
        RowBox[{"S", "[", "0", "]"}], ",", 
        RowBox[{"F", "[", "2", "]"}], ",", 
        RowBox[{"v", "[", "1", "]"}]}], "]"}], 
      RowBox[{"dot", "[", 
       RowBox[{
        RowBox[{"p", "[", "2", "]"}], ",", 
        RowBox[{"v", "[", "1", "]"}]}], "]"}]], "+", 
     FractionBox[
      RowBox[{"dot", "[", 
       RowBox[{
        RowBox[{"p", "[", "3", "]"}], ",", 
        RowBox[{"S", "[", "0", "]"}], ",", 
        RowBox[{"F", "[", "3", "]"}], ",", 
        RowBox[{"F", "[", "2", "]"}], ",", 
        RowBox[{"v", "[", "1", "]"}]}], "]"}], 
      RowBox[{"dot", "[", 
       RowBox[{
        RowBox[{"p", "[", "2", "]"}], ",", 
        RowBox[{"v", "[", "1", "]"}]}], "]"}]]}], ")"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"numvp1", "=", 
   RowBox[{
    RowBox[{
     RowBox[{
      RowBox[{
       RowBox[{"dot", "[", 
        RowBox[{
         RowBox[{"p", "[", "1", "]"}], ",", 
         RowBox[{"p", "[", "2", "]"}]}], "]"}], 
       RowBox[{"(", 
        RowBox[{
         RowBox[{
          RowBox[{"-", "num1"}], "*", "num2"}], "-", 
         RowBox[{
          FractionBox["1", 
           RowBox[{"dot", "[", 
            RowBox[{
             RowBox[{"p", "[", "2", "]"}], ",", 
             RowBox[{"v", "[", "1", "]"}]}], "]"}]], 
          RowBox[{"dot", "[", 
           RowBox[{
            RowBox[{"p", "[", "1", "]"}], ",", 
            RowBox[{"S", "[", "0", "]"}], ",", 
            RowBox[{"\[Epsilon]", "[", "1", "]"}]}], "]"}], "*", 
          RowBox[{"dot", "[", 
           RowBox[{
            RowBox[{"v", "[", "1", "]"}], ",", 
            RowBox[{"F", "[", "2", "]"}], ",", 
            RowBox[{"F", "[", "3", "]"}], ",", 
            RowBox[{"v", "[", "1", "]"}]}], "]"}]}]}], ")"}]}], "//.", 
      "dotRules"}], "//", "expandFS"}], "//", "Expand"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"numvp1", "=", 
   RowBox[{
    RowBox[{
     RowBox[{"numvp1", "//.", "dotRules"}], "/.", "vponshell"}], "/.", 
    RowBox[{"{", 
     RowBox[{
      RowBox[{
       RowBox[{"dot", "[", 
        RowBox[{
         RowBox[{"p", "[", "1", "]"}], ",", 
         RowBox[{"v", "[", "1", "]"}]}], "]"}], "->", "0"}], ",", 
      RowBox[{
       RowBox[{"dot", "[", 
        RowBox[{
         RowBox[{"p", "[", "2", "]"}], ",", 
         RowBox[{"v", "[", "1", "]"}]}], "]"}], "->", 
       RowBox[{"-", 
        RowBox[{"dot", "[", 
         RowBox[{
          RowBox[{"p", "[", "3", "]"}], ",", 
          RowBox[{"v", "[", "1", "]"}]}], "]"}]}]}]}], "}"}]}]}], 
  ";"}]}], "Input",
 CellChangeTimes->{{3.878077591985273*^9, 3.8780776461342783`*^9}, {
   3.878077953502172*^9, 3.878077980733405*^9}, {3.878078491930747*^9, 
   3.878078549563458*^9}, {3.878078580745262*^9, 3.87807865251903*^9}, 
   3.878078684800146*^9, {3.878079206140265*^9, 3.878079212664543*^9}, {
   3.878079938416065*^9, 3.8780799390210323`*^9}, {3.878079982854789*^9, 
   3.878079996138009*^9}, 3.878080718496252*^9, 3.878080776110016*^9, {
   3.878081116226698*^9, 3.8780811179219093`*^9}, {3.878081897887516*^9, 
   3.878081929737031*^9}, {3.8780819770250673`*^9, 3.8780819885274878`*^9}, 
   3.8780820357161922`*^9, {3.878082093586617*^9, 3.878082094494379*^9}, 
   3.878082200584118*^9, 3.8780823524734297`*^9, 3.8780843780876017`*^9, {
   3.87808451838385*^9, 3.878084553403726*^9}, {3.878084767872551*^9, 
   3.878084809993238*^9}, {3.878093413770879*^9, 3.878093418381057*^9}, {
   3.878106594481743*^9, 3.878106602977435*^9}},
 CellLabel->
  "In[411]:=",ExpressionUUID->"fa6f5646-12d0-402f-8458-b680cfe7e8ed"],

Cell[BoxData[
 RowBox[{
  RowBox[{"compvp1", "=", 
   RowBox[{"numAnsatzvp1", "-", "numvp1"}]}], ";"}]], "Input",
 CellChangeTimes->{{3.8780781147500143`*^9, 3.878078179889933*^9}, {
   3.878078714167301*^9, 3.878078719908218*^9}, {3.878078864983605*^9, 
   3.8780788894932623`*^9}, 3.878079927920136*^9, 3.87808000213634*^9},
 CellLabel->
  "In[415]:=",ExpressionUUID->"c5fd8865-8f25-482c-b488-016315b8aee7"],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  RowBox[{"4", " ", 
   RowBox[{
    SubscriptBox["p", "1"], "\[CenterDot]", "S", "\[CenterDot]", 
    SubscriptBox["F", "1"], "\[CenterDot]", 
    SubscriptBox["F", "2"], "\[CenterDot]", "v"}]}], "+", 
  RowBox[{"4", 
   RowBox[{
    SubscriptBox["p", "1"], "\[CenterDot]", "S", "\[CenterDot]", 
    SubscriptBox["F", "2"], "\[CenterDot]", 
    SubscriptBox["F", "1"], "\[CenterDot]", "v"}]}], "-", 
  RowBox[{"4", " ", 
   RowBox[{
    SubscriptBox["p", "1"], "\[CenterDot]", 
    SubscriptBox["F", "2"], "\[CenterDot]", "S", "\[CenterDot]", 
    SubscriptBox["F", "1"], "\[CenterDot]", "v"}]}], "+", 
  RowBox[{"4", " ", 
   RowBox[{
    SubscriptBox["p", "2"], "\[CenterDot]", "S", "\[CenterDot]", 
    SubscriptBox["F", "2"], "\[CenterDot]", 
    SubscriptBox["F", "1"], "\[CenterDot]", "v"}]}]}]], "Input",
 CellChangeTimes->{{3.878078468972107*^9, 3.8780784821254663`*^9}},
 CellLabel->
  "In[416]:=",ExpressionUUID->"af8747a8-4f93-4c5b-bff5-b8372ec86d40"],

Cell[BoxData[
 RowBox[{
  RowBox[{"4", " ", 
   RowBox[{
    SubscriptBox["p", "1"], "\[CenterDot]", "S", "\[CenterDot]", 
    SubscriptBox["F", "1"], "\[CenterDot]", 
    SubscriptBox["F", "2"], "\[CenterDot]", "v"}]}], "+", 
  RowBox[{"4", " ", 
   RowBox[{
    SubscriptBox["p", "1"], "\[CenterDot]", "S", "\[CenterDot]", 
    SubscriptBox["F", "2"], "\[CenterDot]", 
    SubscriptBox["F", "1"], "\[CenterDot]", "v"}]}], "-", 
  RowBox[{"4", " ", 
   RowBox[{
    SubscriptBox["p", "1"], "\[CenterDot]", 
    SubscriptBox["F", "2"], "\[CenterDot]", "S", "\[CenterDot]", 
    SubscriptBox["F", "1"], "\[CenterDot]", "v"}]}], "+", 
  RowBox[{"4", " ", 
   RowBox[{
    SubscriptBox["p", "2"], "\[CenterDot]", "S", "\[CenterDot]", 
    SubscriptBox["F", "2"], "\[CenterDot]", 
    SubscriptBox["F", "1"], "\[CenterDot]", "v"}]}]}]], "Output",
 CellChangeTimes->{3.878096059926221*^9, 3.8786166043620377`*^9, 
  3.8788573627759523`*^9},
 CellLabel->
  "Out[416]=",ExpressionUUID->"8d0cf608-21cd-46b7-8fc9-3438dc1b0b85"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"compvp1", "//", "Casesdot"}]], "Input",
 CellChangeTimes->{{3.8780788203554583`*^9, 3.878078825352446*^9}},
 CellLabel->
  "In[417]:=",ExpressionUUID->"1e93fbae-0b67-433c-9ea8-fa1a9151ea73"],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
   RowBox[{"dot", "[", 
    RowBox[{
     RowBox[{"p", "[", "1", "]"}], ",", 
     RowBox[{"p", "[", "2", "]"}]}], "]"}], ",", 
   RowBox[{"dot", "[", 
    RowBox[{
     RowBox[{"p", "[", "1", "]"}], ",", 
     RowBox[{"p", "[", "3", "]"}]}], "]"}], ",", 
   RowBox[{"dot", "[", 
    RowBox[{
     RowBox[{"p", "[", "1", "]"}], ",", 
     RowBox[{"\[Epsilon]", "[", "2", "]"}]}], "]"}], ",", 
   RowBox[{"dot", "[", 
    RowBox[{
     RowBox[{"p", "[", "1", "]"}], ",", 
     RowBox[{"\[Epsilon]", "[", "3", "]"}]}], "]"}], ",", 
   RowBox[{"dot", "[", 
    RowBox[{
     RowBox[{"p", "[", "2", "]"}], ",", 
     RowBox[{"p", "[", "3", "]"}]}], "]"}], ",", 
   RowBox[{"dot", "[", 
    RowBox[{
     RowBox[{"p", "[", "2", "]"}], ",", 
     RowBox[{"\[Epsilon]", "[", "1", "]"}]}], "]"}], ",", 
   RowBox[{"dot", "[", 
    RowBox[{
     RowBox[{"p", "[", "2", "]"}], ",", 
     RowBox[{"\[Epsilon]", "[", "3", "]"}]}], "]"}], ",", 
   RowBox[{"dot", "[", 
    RowBox[{
     RowBox[{"p", "[", "3", "]"}], ",", 
     RowBox[{"v", "[", "1", "]"}]}], "]"}], ",", 
   RowBox[{"dot", "[", 
    RowBox[{
     RowBox[{"p", "[", "3", "]"}], ",", 
     RowBox[{"\[Epsilon]", "[", "1", "]"}]}], "]"}], ",", 
   RowBox[{"dot", "[", 
    RowBox[{
     RowBox[{"p", "[", "3", "]"}], ",", 
     RowBox[{"\[Epsilon]", "[", "2", "]"}]}], "]"}], ",", 
   RowBox[{"dot", "[", 
    RowBox[{
     RowBox[{"v", "[", "1", "]"}], ",", 
     RowBox[{"\[Epsilon]", "[", "1", "]"}]}], "]"}], ",", 
   RowBox[{"dot", "[", 
    RowBox[{
     RowBox[{"v", "[", "1", "]"}], ",", 
     RowBox[{"\[Epsilon]", "[", "2", "]"}]}], "]"}], ",", 
   RowBox[{"dot", "[", 
    RowBox[{
     RowBox[{"v", "[", "1", "]"}], ",", 
     RowBox[{"\[Epsilon]", "[", "3", "]"}]}], "]"}], ",", 
   RowBox[{"dot", "[", 
    RowBox[{
     RowBox[{"\[Epsilon]", "[", "1", "]"}], ",", 
     RowBox[{"\[Epsilon]", "[", "2", "]"}]}], "]"}], ",", 
   RowBox[{"dot", "[", 
    RowBox[{
     RowBox[{"\[Epsilon]", "[", "1", "]"}], ",", 
     RowBox[{"\[Epsilon]", "[", "3", "]"}]}], "]"}], ",", 
   RowBox[{"dot", "[", 
    RowBox[{
     RowBox[{"\[Epsilon]", "[", "2", "]"}], ",", 
     RowBox[{"\[Epsilon]", "[", "3", "]"}]}], "]"}], ",", 
   RowBox[{"dot", "[", 
    RowBox[{
     RowBox[{"p", "[", "1", "]"}], ",", 
     RowBox[{"S", "[", "0", "]"}], ",", 
     RowBox[{"p", "[", "2", "]"}]}], "]"}], ",", 
   RowBox[{"dot", "[", 
    RowBox[{
     RowBox[{"p", "[", "1", "]"}], ",", 
     RowBox[{"S", "[", "0", "]"}], ",", 
     RowBox[{"p", "[", "3", "]"}]}], "]"}], ",", 
   RowBox[{"dot", "[", 
    RowBox[{
     RowBox[{"p", "[", "1", "]"}], ",", 
     RowBox[{"S", "[", "0", "]"}], ",", 
     RowBox[{"\[Epsilon]", "[", "1", "]"}]}], "]"}], ",", 
   RowBox[{"dot", "[", 
    RowBox[{
     RowBox[{"p", "[", "1", "]"}], ",", 
     RowBox[{"S", "[", "0", "]"}], ",", 
     RowBox[{"\[Epsilon]", "[", "2", "]"}]}], "]"}], ",", 
   RowBox[{"dot", "[", 
    RowBox[{
     RowBox[{"p", "[", "1", "]"}], ",", 
     RowBox[{"S", "[", "0", "]"}], ",", 
     RowBox[{"\[Epsilon]", "[", "3", "]"}]}], "]"}], ",", 
   RowBox[{"dot", "[", 
    RowBox[{
     RowBox[{"p", "[", "2", "]"}], ",", 
     RowBox[{"S", "[", "0", "]"}], ",", 
     RowBox[{"p", "[", "3", "]"}]}], "]"}], ",", 
   RowBox[{"dot", "[", 
    RowBox[{
     RowBox[{"p", "[", "2", "]"}], ",", 
     RowBox[{"S", "[", "0", "]"}], ",", 
     RowBox[{"\[Epsilon]", "[", "1", "]"}]}], "]"}], ",", 
   RowBox[{"dot", "[", 
    RowBox[{
     RowBox[{"p", "[", "2", "]"}], ",", 
     RowBox[{"S", "[", "0", "]"}], ",", 
     RowBox[{"\[Epsilon]", "[", "2", "]"}]}], "]"}], ",", 
   RowBox[{"dot", "[", 
    RowBox[{
     RowBox[{"p", "[", "2", "]"}], ",", 
     RowBox[{"S", "[", "0", "]"}], ",", 
     RowBox[{"\[Epsilon]", "[", "3", "]"}]}], "]"}], ",", 
   RowBox[{"dot", "[", 
    RowBox[{
     RowBox[{"p", "[", "3", "]"}], ",", 
     RowBox[{"S", "[", "0", "]"}], ",", 
     RowBox[{"\[Epsilon]", "[", "1", "]"}]}], "]"}], ",", 
   RowBox[{"dot", "[", 
    RowBox[{
     RowBox[{"p", "[", "3", "]"}], ",", 
     RowBox[{"S", "[", "0", "]"}], ",", 
     RowBox[{"\[Epsilon]", "[", "2", "]"}]}], "]"}], ",", 
   RowBox[{"dot", "[", 
    RowBox[{
     RowBox[{"p", "[", "3", "]"}], ",", 
     RowBox[{"S", "[", "0", "]"}], ",", 
     RowBox[{"\[Epsilon]", "[", "3", "]"}]}], "]"}], ",", 
   RowBox[{"dot", "[", 
    RowBox[{
     RowBox[{"\[Epsilon]", "[", "1", "]"}], ",", 
     RowBox[{"S", "[", "0", "]"}], ",", 
     RowBox[{"\[Epsilon]", "[", "2", "]"}]}], "]"}], ",", 
   RowBox[{"dot", "[", 
    RowBox[{
     RowBox[{"\[Epsilon]", "[", "1", "]"}], ",", 
     RowBox[{"S", "[", "0", "]"}], ",", 
     RowBox[{"\[Epsilon]", "[", "3", "]"}]}], "]"}], ",", 
   RowBox[{"dot", "[", 
    RowBox[{
     RowBox[{"\[Epsilon]", "[", "2", "]"}], ",", 
     RowBox[{"S", "[", "0", "]"}], ",", 
     RowBox[{"\[Epsilon]", "[", "3", "]"}]}], "]"}]}], "}"}]], "Output",
 CellChangeTimes->{3.8780787909855328`*^9, 3.878078825754147*^9, 
  3.8780789139500523`*^9, 3.878079583885482*^9, 3.8780807366766977`*^9, 
  3.87808078442798*^9, 3.878096059944249*^9, 3.8786166043718*^9, 
  3.8788573627828627`*^9},
 CellLabel->
  "Out[417]=",ExpressionUUID->"6090a0d5-c802-4f4a-a667-675060f331dc"]
}, Open  ]],

Cell[BoxData[{
 RowBox[{
  RowBox[{"cvars", "=", 
   RowBox[{
    RowBox[{"Cases", "[", 
     RowBox[{"compvp1", ",", 
      RowBox[{"c", "[", "__", "]"}], ",", 
      RowBox[{"{", 
       RowBox[{"0", ",", "\[Infinity]"}], "}"}]}], "]"}], "//", "Union"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"vardot", "=", 
   RowBox[{"compvp1", "//", "Casesdot"}]}], ";"}]}], "Input",
 CellChangeTimes->{{3.878078218083035*^9, 3.878078227195683*^9}},
 CellLabel->
  "In[418]:=",ExpressionUUID->"574cf71c-f09c-4a42-a9eb-61ed6802e293"],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"cvars", "//", "Length"}]], "Input",
 CellChangeTimes->{{3.878078250405406*^9, 3.8780782515980988`*^9}, 
   3.8780793030421352`*^9, {3.878080618122617*^9, 3.878080619511405*^9}},
 CellLabel->
  "In[420]:=",ExpressionUUID->"bc0a4d97-ba05-449b-a2c0-70b1f979a85f"],

Cell[BoxData["33"], "Output",
 CellChangeTimes->{
  3.878078252063862*^9, 3.878078732430634*^9, {3.8780792683050127`*^9, 
   3.878079303531766*^9}, {3.8780806116761723`*^9, 3.878080620497012*^9}, 
   3.878080793272333*^9, 3.8780810935750732`*^9, 3.8780811318686132`*^9, 
   3.878081941084124*^9, 3.8780820011325197`*^9, 3.878082120982493*^9, 
   3.878084828486793*^9, 3.878085517830093*^9, 3.878093680935251*^9, 
   3.878096059965028*^9, 3.878106611890305*^9, 3.8781106661833277`*^9, 
   3.878110711119144*^9, 3.878616604394215*^9, 3.8788573628023148`*^9},
 CellLabel->
  "Out[420]=",ExpressionUUID->"fd894f40-a7f8-454b-9a1e-492091e1dca1"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{
  RowBox[{"dot2num", ":=", 
   RowBox[{"Table", "[", 
    RowBox[{
     RowBox[{"Rule", "[", 
      RowBox[{
       RowBox[{"vardot", "[", 
        RowBox[{"[", "ii", "]"}], "]"}], ",", 
       RowBox[{"RandomInteger", "[", 
        RowBox[{"{", 
         RowBox[{"10", ",", "100"}], "}"}], "]"}]}], "]"}], ",", 
     RowBox[{"{", 
      RowBox[{"ii", ",", 
       RowBox[{"Length", "[", "vardot", "]"}]}], "}"}]}], "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{"Monitor", "[", 
  RowBox[{
   RowBox[{
    RowBox[{"eqDep", "=", 
     RowBox[{"Table", "[", 
      RowBox[{
       RowBox[{
        RowBox[{"compvp1", "\[Equal]", "0"}], "/.", "dot2num"}], ",", 
       RowBox[{"{", 
        RowBox[{"ii", ",", 
         RowBox[{"10", "+", 
          RowBox[{"Length", "[", "cvars", "]"}]}]}], "}"}]}], "]"}]}], ";"}], 
   ",", "ii"}], "]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"solsvp1", "=", 
   RowBox[{
    RowBox[{"Solve", "[", 
     RowBox[{"eqDep", ",", "cvars"}], "]"}], "[", 
    RowBox[{"[", "1", "]"}], "]"}]}], ";"}]}], "Input",
 CellChangeTimes->{{3.878078221639757*^9, 3.878078240954069*^9}, {
  3.878081064658252*^9, 3.8780810690042477`*^9}},
 CellLabel->
  "In[421]:=",ExpressionUUID->"a7e2e9ee-021c-49cb-84b5-bf401a4f7bc9"],

Cell[BoxData[
 TemplateBox[{
  "Solve", "svars", 
   "\"Equations may not give solutions for all \\\"solve\\\" variables.\"", 2,
    423, 15, 28415626182954115862, "Local"},
  "MessageTemplate"]], "Message", "MSG",
 CellChangeTimes->{3.878078269494465*^9, 3.878078742583606*^9, 
  3.878078899618535*^9, 3.878079253865985*^9, 3.878079430819562*^9, 
  3.878080637128373*^9, 3.8780808095370073`*^9, 3.878081098149448*^9, 
  3.878081136137045*^9, 3.8780819450782824`*^9, 3.8780820048796787`*^9, 
  3.878082047763628*^9, 3.878082109462324*^9, 3.878082376640708*^9, 
  3.878084831921735*^9, 3.878085522082589*^9, 3.878093683954672*^9, 
  3.878096061390531*^9, 3.8781066143839417`*^9, 3.878110713398693*^9, 
  3.8786166045746517`*^9, 3.8788573629720497`*^9},
 CellLabel->
  "During evaluation of \
In[421]:=",ExpressionUUID->"2985fe39-3874-412d-ba3c-b2240401b717"]
}, Open  ]]
}, Open  ]],

Cell[CellGroupData[{

Cell["Factorisation condition v.p2", "Subsection",
 CellChangeTimes->{{3.878076748965989*^9, 3.878076767862722*^9}, {
  3.878093747799068*^9, 
  3.8780937495889473`*^9}},ExpressionUUID->"379cc9e9-cc4e-41ce-a1f5-\
2a4837d5b90f"],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{
  RowBox[{"numAnsatz3", "=", 
   RowBox[{
    RowBox[{
     RowBox[{
      RowBox[{
       RowBox[{"(", "numAnsatz2", ")"}], "//.", "dotRules"}], "/.", 
      RowBox[{"(", 
       RowBox[{
        RowBox[{"vonshell", "[", 
         RowBox[{
          RowBox[{"n", "-", "1"}], ",", "3"}], "]"}], "/.", 
        RowBox[{"v", "->", 
         RowBox[{"v", "[", "1", "]"}]}]}], ")"}]}], "/.", "solsvp1"}], "//", 
    "Expand"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{"%", "//", "Length"}]}], "Input",
 CellChangeTimes->{{3.878076776346158*^9, 3.878076791822427*^9}, {
   3.878076863747164*^9, 3.8780768651784353`*^9}, {3.878077446334421*^9, 
   3.878077450450157*^9}, 3.878080568874198*^9, 3.878080843522138*^9, {
   3.878084931218405*^9, 3.8780849369136047`*^9}, {3.878085107286035*^9, 
   3.878085112014679*^9}, {3.8780852927862673`*^9, 3.878085294285921*^9}, {
   3.8780937634764643`*^9, 3.8780937712084923`*^9}, {3.878094578752013*^9, 
   3.87809458003332*^9}},
 CellLabel->
  "In[424]:=",ExpressionUUID->"67810cac-ef26-414e-973b-982b6d3c9be5"],

Cell[BoxData["1181"], "Output",
 CellChangeTimes->{{3.87807677960294*^9, 3.878076792387086*^9}, 
   3.878076869394702*^9, 3.878077463656658*^9, 3.878080582971023*^9, 
   3.878081061748372*^9, 3.878084951014349*^9, 3.878085126532173*^9, 
   3.878085312641127*^9, 3.878093665706396*^9, 3.878094602309922*^9, 
   3.8780960624008083`*^9, 3.878106626228441*^9, 3.878110729159609*^9, 
   3.878616604673922*^9, 3.87885736307021*^9},
 CellLabel->
  "Out[425]=",ExpressionUUID->"0bb43d78-0598-41aa-8057-3c95d22cce89"]
}, Open  ]],

Cell[BoxData[
 RowBox[{
  RowBox[{"numAnsatzvp1", "=", 
   RowBox[{
    RowBox[{
     RowBox[{
      RowBox[{"(", 
       RowBox[{
        RowBox[{
         RowBox[{"(", 
          RowBox[{"numAnsatz3", "//", 
           RowBox[{"Cases", "[", 
            RowBox[{"Times", "[", 
             RowBox[{"f___", ",", 
              RowBox[{"Power", "[", 
               RowBox[{
                RowBox[{"dot", "[", 
                 RowBox[{
                  RowBox[{"p", "[", "2", "]"}], ",", 
                  RowBox[{"v", "[", "1", "]"}]}], "]"}], ",", 
                RowBox[{"-", "1"}]}], "]"}], ",", "g___"}], "]"}], "]"}]}], 
          ")"}], "/.", 
         RowBox[{
          RowBox[{"Power", "[", 
           RowBox[{
            RowBox[{"dot", "[", 
             RowBox[{
              RowBox[{"p", "[", "2", "]"}], ",", 
              RowBox[{"v", "[", "1", "]"}]}], "]"}], ",", 
            RowBox[{"-", "1"}]}], "]"}], "->", "1"}]}], "//", "Total"}], 
       ")"}], "//.", "dotRules"}], "/.", "vponshell"}], "/.", 
    RowBox[{"{", 
     RowBox[{
      RowBox[{
       RowBox[{"dot", "[", 
        RowBox[{
         RowBox[{"p", "[", "2", "]"}], ",", 
         RowBox[{"v", "[", "1", "]"}]}], "]"}], "->", "0"}], ",", 
      RowBox[{
       RowBox[{"dot", "[", 
        RowBox[{
         RowBox[{"p", "[", "3", "]"}], ",", 
         RowBox[{"v", "[", "1", "]"}]}], "]"}], "->", 
       RowBox[{"-", 
        RowBox[{"dot", "[", 
         RowBox[{
          RowBox[{"p", "[", "1", "]"}], ",", 
          RowBox[{"v", "[", "1", "]"}]}], "]"}]}]}]}], "}"}]}]}], 
  ";"}]], "Input",
 CellChangeTimes->{{3.878077052129978*^9, 3.878077125591745*^9}, {
   3.878077237157652*^9, 3.878077281353335*^9}, {3.8780773702267103`*^9, 
   3.8780774435353603`*^9}, {3.8780774739935207`*^9, 3.8780775017717133`*^9}, 
   3.878079930873101*^9, 3.878079973240665*^9, {3.878085415182927*^9, 
   3.8780854153236303`*^9}, 3.878085446328352*^9, {3.878094648731681*^9, 
   3.878094651846068*^9}, {3.878094696417069*^9, 3.878094712612356*^9}},
 CellLabel->
  "In[426]:=",ExpressionUUID->"5ea2d570-323a-4077-9b1e-f425158719cb"],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"numAnsatzvp1", "//", "Length"}]], "Input",
 CellChangeTimes->{{3.878085457345728*^9, 3.878085458484248*^9}},
 CellLabel->
  "In[427]:=",ExpressionUUID->"735a6f30-189f-4e68-8b54-0ff365476c17"],

Cell[BoxData["256"], "Output",
 CellChangeTimes->{{3.878085424115284*^9, 3.8780854589677*^9}, 
   3.878093671135722*^9, 3.878094722221806*^9, 3.878096062738055*^9, 
   3.878106638620821*^9, 3.878110733692247*^9, 3.878616604773514*^9, 
   3.878857363169579*^9},
 CellLabel->
  "Out[427]=",ExpressionUUID->"f2e65fea-7e8a-4d42-b7b6-13f76597b5c2"]
}, Open  ]],

Cell[BoxData[{
 RowBox[{
  RowBox[{"num1", "=", 
   RowBox[{
    RowBox[{
     RowBox[{"T", "[", 
      RowBox[{"{", "2", "}"}], "]"}], "/.", 
     RowBox[{"T", "->", "T2F"}]}], "/.", 
    RowBox[{"v", "->", 
     RowBox[{"v", "[", "1", "]"}]}]}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"num2", "=", 
   RowBox[{"(", 
    RowBox[{
     FractionBox[
      RowBox[{"dot", "[", 
       RowBox[{
        RowBox[{"p", "[", "1", "]"}], ",", 
        RowBox[{"S", "[", "0", "]"}], ",", 
        RowBox[{"F", "[", "1", "]"}], ",", 
        RowBox[{"F", "[", "3", "]"}], ",", 
        RowBox[{"v", "[", "1", "]"}]}], "]"}], 
      RowBox[{"dot", "[", 
       RowBox[{
        RowBox[{"p", "[", "1", "]"}], ",", 
        RowBox[{"v", "[", "1", "]"}]}], "]"}]], "+", 
     FractionBox[
      RowBox[{"dot", "[", 
       RowBox[{
        RowBox[{"p", "[", "1", "]"}], ",", 
        RowBox[{"S", "[", "0", "]"}], ",", 
        RowBox[{"F", "[", "3", "]"}], ",", 
        RowBox[{"F", "[", "1", "]"}], ",", 
        RowBox[{"v", "[", "1", "]"}]}], "]"}], 
      RowBox[{"dot", "[", 
       RowBox[{
        RowBox[{"p", "[", "1", "]"}], ",", 
        RowBox[{"v", "[", "1", "]"}]}], "]"}]], "-", 
     FractionBox[
      RowBox[{"dot", "[", 
       RowBox[{
        RowBox[{"p", "[", "1", "]"}], ",", 
        RowBox[{"F", "[", "3", "]"}], ",", 
        RowBox[{"S", "[", "0", "]"}], ",", 
        RowBox[{"F", "[", "1", "]"}], ",", 
        RowBox[{"v", "[", "1", "]"}]}], "]"}], 
      RowBox[{"dot", "[", 
       RowBox[{
        RowBox[{"p", "[", "1", "]"}], ",", 
        RowBox[{"v", "[", "1", "]"}]}], "]"}]], "+", 
     FractionBox[
      RowBox[{"dot", "[", 
       RowBox[{
        RowBox[{"p", "[", "3", "]"}], ",", 
        RowBox[{"S", "[", "0", "]"}], ",", 
        RowBox[{"F", "[", "3", "]"}], ",", 
        RowBox[{"F", "[", "1", "]"}], ",", 
        RowBox[{"v", "[", "1", "]"}]}], "]"}], 
      RowBox[{"dot", "[", 
       RowBox[{
        RowBox[{"p", "[", "1", "]"}], ",", 
        RowBox[{"v", "[", "1", "]"}]}], "]"}]]}], ")"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"numvp1", "=", 
   RowBox[{
    RowBox[{
     RowBox[{
      RowBox[{
       RowBox[{"dot", "[", 
        RowBox[{
         RowBox[{"p", "[", "1", "]"}], ",", 
         RowBox[{"p", "[", "2", "]"}]}], "]"}], 
       RowBox[{"(", 
        RowBox[{
         RowBox[{"num1", "*", "num2"}], "+", 
         RowBox[{
          FractionBox["1", 
           RowBox[{"dot", "[", 
            RowBox[{
             RowBox[{"p", "[", "1", "]"}], ",", 
             RowBox[{"v", "[", "1", "]"}]}], "]"}]], 
          RowBox[{"dot", "[", 
           RowBox[{
            RowBox[{"p", "[", "2", "]"}], ",", 
            RowBox[{"S", "[", "0", "]"}], ",", 
            RowBox[{"\[Epsilon]", "[", "2", "]"}]}], "]"}], "*", 
          RowBox[{"dot", "[", 
           RowBox[{
            RowBox[{"v", "[", "1", "]"}], ",", 
            RowBox[{"F", "[", "1", "]"}], ",", 
            RowBox[{"F", "[", "3", "]"}], ",", 
            RowBox[{"v", "[", "1", "]"}]}], "]"}]}]}], ")"}]}], "//.", 
      "dotRules"}], "//", "expandFS"}], "//", "Expand"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"numvp1", "=", 
   RowBox[{
    RowBox[{
     RowBox[{"numvp1", "//.", "dotRules"}], "/.", "vponshell"}], "/.", 
    RowBox[{"{", 
     RowBox[{
      RowBox[{
       RowBox[{"dot", "[", 
        RowBox[{
         RowBox[{"p", "[", "2", "]"}], ",", 
         RowBox[{"v", "[", "1", "]"}]}], "]"}], "->", "0"}], ",", 
      RowBox[{
       RowBox[{"dot", "[", 
        RowBox[{
         RowBox[{"p", "[", "3", "]"}], ",", 
         RowBox[{"v", "[", "1", "]"}]}], "]"}], "->", 
       RowBox[{"-", 
        RowBox[{"dot", "[", 
         RowBox[{
          RowBox[{"p", "[", "1", "]"}], ",", 
          RowBox[{"v", "[", "1", "]"}]}], "]"}]}]}]}], "}"}]}]}], 
  ";"}]}], "Input",
 CellChangeTimes->{{3.878077591985273*^9, 3.8780776461342783`*^9}, {
   3.878077953502172*^9, 3.878077980733405*^9}, {3.878078491930747*^9, 
   3.878078549563458*^9}, {3.878078580745262*^9, 3.87807865251903*^9}, 
   3.878078684800146*^9, {3.878079206140265*^9, 3.878079212664543*^9}, {
   3.878079938416065*^9, 3.8780799390210323`*^9}, {3.878079982854789*^9, 
   3.878079996138009*^9}, 3.878080718496252*^9, 3.878080776110016*^9, {
   3.878081116226698*^9, 3.8780811179219093`*^9}, {3.878081897887516*^9, 
   3.878081929737031*^9}, {3.8780819770250673`*^9, 3.8780819885274878`*^9}, 
   3.8780820357161922`*^9, {3.878082093586617*^9, 3.878082094494379*^9}, 
   3.878082200584118*^9, 3.8780823524734297`*^9, 3.8780843780876017`*^9, {
   3.87808451838385*^9, 3.878084553403726*^9}, {3.878084767872551*^9, 
   3.878084809993238*^9}, {3.878093413770879*^9, 3.878093418381057*^9}, 
   3.878094731163116*^9, {3.878094787760552*^9, 3.878094870939351*^9}, {
   3.878094944453622*^9, 3.878094946794712*^9}, {3.878106643713951*^9, 
   3.878106646634589*^9}},
 CellLabel->
  "In[428]:=",ExpressionUUID->"c46833fe-bb42-4236-919e-d699cdceb78a"],

Cell[BoxData[
 RowBox[{
  RowBox[{"compvp1", "=", 
   RowBox[{"numAnsatzvp1", "-", "numvp1"}]}], ";"}]], "Input",
 CellChangeTimes->{{3.8780781147500143`*^9, 3.878078179889933*^9}, {
   3.878078714167301*^9, 3.878078719908218*^9}, {3.878078864983605*^9, 
   3.8780788894932623`*^9}, 3.878079927920136*^9, 3.87808000213634*^9},
 CellLabel->
  "In[432]:=",ExpressionUUID->"900df586-c439-4fc2-abfa-205e6cfc5ed5"],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  RowBox[{"4", " ", 
   RowBox[{
    SubscriptBox["p", "1"], "\[CenterDot]", "S", "\[CenterDot]", 
    SubscriptBox["F", "1"], "\[CenterDot]", 
    SubscriptBox["F", "2"], "\[CenterDot]", "v"}]}], "+", 
  RowBox[{"4", 
   RowBox[{
    SubscriptBox["p", "1"], "\[CenterDot]", "S", "\[CenterDot]", 
    SubscriptBox["F", "2"], "\[CenterDot]", 
    SubscriptBox["F", "1"], "\[CenterDot]", "v"}]}], "-", 
  RowBox[{"4", " ", 
   RowBox[{
    SubscriptBox["p", "1"], "\[CenterDot]", 
    SubscriptBox["F", "2"], "\[CenterDot]", "S", "\[CenterDot]", 
    SubscriptBox["F", "1"], "\[CenterDot]", "v"}]}], "+", 
  RowBox[{"4", " ", 
   RowBox[{
    SubscriptBox["p", "2"], "\[CenterDot]", "S", "\[CenterDot]", 
    SubscriptBox["F", "2"], "\[CenterDot]", 
    SubscriptBox["F", "1"], "\[CenterDot]", "v"}]}]}]], "Input",
 CellChangeTimes->{{3.878078468972107*^9, 3.8780784821254663`*^9}},
 CellLabel->
  "In[433]:=",ExpressionUUID->"dafc7ee9-8920-4c80-9acb-e14a7ab6d011"],

Cell[BoxData[
 RowBox[{
  RowBox[{"4", " ", 
   RowBox[{
    SubscriptBox["p", "1"], "\[CenterDot]", "S", "\[CenterDot]", 
    SubscriptBox["F", "1"], "\[CenterDot]", 
    SubscriptBox["F", "2"], "\[CenterDot]", "v"}]}], "+", 
  RowBox[{"4", " ", 
   RowBox[{
    SubscriptBox["p", "1"], "\[CenterDot]", "S", "\[CenterDot]", 
    SubscriptBox["F", "2"], "\[CenterDot]", 
    SubscriptBox["F", "1"], "\[CenterDot]", "v"}]}], "-", 
  RowBox[{"4", " ", 
   RowBox[{
    SubscriptBox["p", "1"], "\[CenterDot]", 
    SubscriptBox["F", "2"], "\[CenterDot]", "S", "\[CenterDot]", 
    SubscriptBox["F", "1"], "\[CenterDot]", "v"}]}], "+", 
  RowBox[{"4", " ", 
   RowBox[{
    SubscriptBox["p", "2"], "\[CenterDot]", "S", "\[CenterDot]", 
    SubscriptBox["F", "2"], "\[CenterDot]", 
    SubscriptBox["F", "1"], "\[CenterDot]", "v"}]}]}]], "Output",
 CellChangeTimes->{3.8780960628033333`*^9, 3.878616604841939*^9, 
  3.878857363236565*^9},
 CellLabel->
  "Out[433]=",ExpressionUUID->"80903e11-f832-466d-82fe-f1240f4b03f6"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"compvp1", "//", "Casesdot"}]], "Input",
 CellChangeTimes->{{3.8780788203554583`*^9, 3.878078825352446*^9}},
 CellLabel->
  "In[434]:=",ExpressionUUID->"0376c9af-430a-4eb1-8140-fece7a045657"],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
   RowBox[{"dot", "[", 
    RowBox[{
     RowBox[{"p", "[", "1", "]"}], ",", 
     RowBox[{"p", "[", "2", "]"}]}], "]"}], ",", 
   RowBox[{"dot", "[", 
    RowBox[{
     RowBox[{"p", "[", "1", "]"}], ",", 
     RowBox[{"p", "[", "3", "]"}]}], "]"}], ",", 
   RowBox[{"dot", "[", 
    RowBox[{
     RowBox[{"p", "[", "1", "]"}], ",", 
     RowBox[{"v", "[", "1", "]"}]}], "]"}], ",", 
   RowBox[{"dot", "[", 
    RowBox[{
     RowBox[{"p", "[", "1", "]"}], ",", 
     RowBox[{"\[Epsilon]", "[", "2", "]"}]}], "]"}], ",", 
   RowBox[{"dot", "[", 
    RowBox[{
     RowBox[{"p", "[", "1", "]"}], ",", 
     RowBox[{"\[Epsilon]", "[", "3", "]"}]}], "]"}], ",", 
   RowBox[{"dot", "[", 
    RowBox[{
     RowBox[{"p", "[", "2", "]"}], ",", 
     RowBox[{"p", "[", "3", "]"}]}], "]"}], ",", 
   RowBox[{"dot", "[", 
    RowBox[{
     RowBox[{"p", "[", "2", "]"}], ",", 
     RowBox[{"\[Epsilon]", "[", "1", "]"}]}], "]"}], ",", 
   RowBox[{"dot", "[", 
    RowBox[{
     RowBox[{"p", "[", "2", "]"}], ",", 
     RowBox[{"\[Epsilon]", "[", "3", "]"}]}], "]"}], ",", 
   RowBox[{"dot", "[", 
    RowBox[{
     RowBox[{"p", "[", "3", "]"}], ",", 
     RowBox[{"\[Epsilon]", "[", "1", "]"}]}], "]"}], ",", 
   RowBox[{"dot", "[", 
    RowBox[{
     RowBox[{"p", "[", "3", "]"}], ",", 
     RowBox[{"\[Epsilon]", "[", "2", "]"}]}], "]"}], ",", 
   RowBox[{"dot", "[", 
    RowBox[{
     RowBox[{"v", "[", "1", "]"}], ",", 
     RowBox[{"\[Epsilon]", "[", "1", "]"}]}], "]"}], ",", 
   RowBox[{"dot", "[", 
    RowBox[{
     RowBox[{"v", "[", "1", "]"}], ",", 
     RowBox[{"\[Epsilon]", "[", "2", "]"}]}], "]"}], ",", 
   RowBox[{"dot", "[", 
    RowBox[{
     RowBox[{"v", "[", "1", "]"}], ",", 
     RowBox[{"\[Epsilon]", "[", "3", "]"}]}], "]"}], ",", 
   RowBox[{"dot", "[", 
    RowBox[{
     RowBox[{"\[Epsilon]", "[", "1", "]"}], ",", 
     RowBox[{"\[Epsilon]", "[", "2", "]"}]}], "]"}], ",", 
   RowBox[{"dot", "[", 
    RowBox[{
     RowBox[{"\[Epsilon]", "[", "1", "]"}], ",", 
     RowBox[{"\[Epsilon]", "[", "3", "]"}]}], "]"}], ",", 
   RowBox[{"dot", "[", 
    RowBox[{
     RowBox[{"\[Epsilon]", "[", "2", "]"}], ",", 
     RowBox[{"\[Epsilon]", "[", "3", "]"}]}], "]"}], ",", 
   RowBox[{"dot", "[", 
    RowBox[{
     RowBox[{"p", "[", "1", "]"}], ",", 
     RowBox[{"S", "[", "0", "]"}], ",", 
     RowBox[{"p", "[", "2", "]"}]}], "]"}], ",", 
   RowBox[{"dot", "[", 
    RowBox[{
     RowBox[{"p", "[", "1", "]"}], ",", 
     RowBox[{"S", "[", "0", "]"}], ",", 
     RowBox[{"p", "[", "3", "]"}]}], "]"}], ",", 
   RowBox[{"dot", "[", 
    RowBox[{
     RowBox[{"p", "[", "1", "]"}], ",", 
     RowBox[{"S", "[", "0", "]"}], ",", 
     RowBox[{"\[Epsilon]", "[", "2", "]"}]}], "]"}], ",", 
   RowBox[{"dot", "[", 
    RowBox[{
     RowBox[{"p", "[", "1", "]"}], ",", 
     RowBox[{"S", "[", "0", "]"}], ",", 
     RowBox[{"\[Epsilon]", "[", "3", "]"}]}], "]"}], ",", 
   RowBox[{"dot", "[", 
    RowBox[{
     RowBox[{"p", "[", "2", "]"}], ",", 
     RowBox[{"S", "[", "0", "]"}], ",", 
     RowBox[{"p", "[", "3", "]"}]}], "]"}], ",", 
   RowBox[{"dot", "[", 
    RowBox[{
     RowBox[{"p", "[", "2", "]"}], ",", 
     RowBox[{"S", "[", "0", "]"}], ",", 
     RowBox[{"\[Epsilon]", "[", "1", "]"}]}], "]"}], ",", 
   RowBox[{"dot", "[", 
    RowBox[{
     RowBox[{"p", "[", "2", "]"}], ",", 
     RowBox[{"S", "[", "0", "]"}], ",", 
     RowBox[{"\[Epsilon]", "[", "2", "]"}]}], "]"}], ",", 
   RowBox[{"dot", "[", 
    RowBox[{
     RowBox[{"p", "[", "2", "]"}], ",", 
     RowBox[{"S", "[", "0", "]"}], ",", 
     RowBox[{"\[Epsilon]", "[", "3", "]"}]}], "]"}], ",", 
   RowBox[{"dot", "[", 
    RowBox[{
     RowBox[{"p", "[", "3", "]"}], ",", 
     RowBox[{"S", "[", "0", "]"}], ",", 
     RowBox[{"\[Epsilon]", "[", "1", "]"}]}], "]"}], ",", 
   RowBox[{"dot", "[", 
    RowBox[{
     RowBox[{"p", "[", "3", "]"}], ",", 
     RowBox[{"S", "[", "0", "]"}], ",", 
     RowBox[{"\[Epsilon]", "[", "2", "]"}]}], "]"}], ",", 
   RowBox[{"dot", "[", 
    RowBox[{
     RowBox[{"p", "[", "3", "]"}], ",", 
     RowBox[{"S", "[", "0", "]"}], ",", 
     RowBox[{"\[Epsilon]", "[", "3", "]"}]}], "]"}], ",", 
   RowBox[{"dot", "[", 
    RowBox[{
     RowBox[{"\[Epsilon]", "[", "1", "]"}], ",", 
     RowBox[{"S", "[", "0", "]"}], ",", 
     RowBox[{"\[Epsilon]", "[", "2", "]"}]}], "]"}], ",", 
   RowBox[{"dot", "[", 
    RowBox[{
     RowBox[{"\[Epsilon]", "[", "1", "]"}], ",", 
     RowBox[{"S", "[", "0", "]"}], ",", 
     RowBox[{"\[Epsilon]", "[", "3", "]"}]}], "]"}], ",", 
   RowBox[{"dot", "[", 
    RowBox[{
     RowBox[{"\[Epsilon]", "[", "2", "]"}], ",", 
     RowBox[{"S", "[", "0", "]"}], ",", 
     RowBox[{"\[Epsilon]", "[", "3", "]"}]}], "]"}]}], "}"}]], "Output",
 CellChangeTimes->{3.8780787909855328`*^9, 3.878078825754147*^9, 
  3.8780789139500523`*^9, 3.878079583885482*^9, 3.8780807366766977`*^9, 
  3.87808078442798*^9, 3.878095061451518*^9, 3.87809606280996*^9, 
  3.878616604849388*^9, 3.878857363243372*^9},
 CellLabel->
  "Out[434]=",ExpressionUUID->"8f602d3e-4829-4c2f-8392-bd786aed2513"]
}, Open  ]],

Cell[BoxData[{
 RowBox[{
  RowBox[{"cvars", "=", 
   RowBox[{
    RowBox[{"Cases", "[", 
     RowBox[{"compvp1", ",", 
      RowBox[{"c", "[", "__", "]"}], ",", 
      RowBox[{"{", 
       RowBox[{"0", ",", "\[Infinity]"}], "}"}]}], "]"}], "//", "Union"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"vardot", "=", 
   RowBox[{"compvp1", "//", "Casesdot"}]}], ";"}]}], "Input",
 CellChangeTimes->{{3.878078218083035*^9, 3.878078227195683*^9}},
 CellLabel->
  "In[435]:=",ExpressionUUID->"e343c648-ccd2-43a2-b8ef-f0409eb9b4c9"],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"cvars", "//", "Length"}]], "Input",
 CellChangeTimes->{{3.878078250405406*^9, 3.8780782515980988`*^9}, 
   3.8780793030421352`*^9, {3.878080618122617*^9, 3.878080619511405*^9}},
 CellLabel->
  "In[437]:=",ExpressionUUID->"7e06ccd0-81fc-4e62-96de-03e3e0b3c199"],

Cell[BoxData["15"], "Output",
 CellChangeTimes->{
  3.878078252063862*^9, 3.878078732430634*^9, {3.8780792683050127`*^9, 
   3.878079303531766*^9}, {3.8780806116761723`*^9, 3.878080620497012*^9}, 
   3.878080793272333*^9, 3.8780810935750732`*^9, 3.8780811318686132`*^9, 
   3.878081941084124*^9, 3.8780820011325197`*^9, 3.878082120982493*^9, 
   3.878084828486793*^9, 3.878085517830093*^9, 3.878093680935251*^9, 
   3.878095084936636*^9, 3.878096062833789*^9, 3.878106656683487*^9, 
   3.878110745065216*^9, 3.878616604873094*^9, 3.8788573632584753`*^9},
 CellLabel->
  "Out[437]=",ExpressionUUID->"6ecf01e8-f878-4254-925e-14e4ec200d33"]
}, Open  ]],

Cell[BoxData[{
 RowBox[{
  RowBox[{"dot2num", ":=", 
   RowBox[{"Table", "[", 
    RowBox[{
     RowBox[{"Rule", "[", 
      RowBox[{
       RowBox[{"vardot", "[", 
        RowBox[{"[", "ii", "]"}], "]"}], ",", 
       RowBox[{"RandomInteger", "[", 
        RowBox[{"{", 
         RowBox[{"10", ",", "100"}], "}"}], "]"}]}], "]"}], ",", 
     RowBox[{"{", 
      RowBox[{"ii", ",", 
       RowBox[{"Length", "[", "vardot", "]"}]}], "}"}]}], "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{"Monitor", "[", 
  RowBox[{
   RowBox[{
    RowBox[{"eqDep", "=", 
     RowBox[{"Table", "[", 
      RowBox[{
       RowBox[{
        RowBox[{"compvp1", "\[Equal]", "0"}], "/.", "dot2num"}], ",", 
       RowBox[{"{", 
        RowBox[{"ii", ",", 
         RowBox[{"10", "+", 
          RowBox[{"Length", "[", "cvars", "]"}]}]}], "}"}]}], "]"}]}], ";"}], 
   ",", "ii"}], "]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"solsvp2", "=", 
   RowBox[{
    RowBox[{"Solve", "[", 
     RowBox[{"eqDep", ",", "cvars"}], "]"}], "[", 
    RowBox[{"[", "1", "]"}], "]"}]}], ";"}]}], "Input",
 CellChangeTimes->{{3.878078221639757*^9, 3.878078240954069*^9}, {
  3.878081064658252*^9, 3.8780810690042477`*^9}, {3.878095748981908*^9, 
  3.878095749098365*^9}},
 CellLabel->
  "In[438]:=",ExpressionUUID->"d28fb5a0-ab74-4036-b2d8-e383e656fb96"],

Cell[CellGroupData[{

Cell[BoxData["solsvp2"], "Input",
 CellLabel->
  "In[441]:=",ExpressionUUID->"6d35c829-fa10-466b-a59d-1d59b549e23a"],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
   RowBox[{
    RowBox[{"c", "[", "6", "]"}], "\[Rule]", "0"}], ",", 
   RowBox[{
    RowBox[{"c", "[", "7", "]"}], "\[Rule]", "0"}], ",", 
   RowBox[{
    RowBox[{"c", "[", "10", "]"}], "\[Rule]", "0"}], ",", 
   RowBox[{
    RowBox[{"c", "[", "16", "]"}], "\[Rule]", "0"}], ",", 
   RowBox[{
    RowBox[{"c", "[", "21", "]"}], "\[Rule]", "0"}], ",", 
   RowBox[{
    RowBox[{"c", "[", "28", "]"}], "\[Rule]", "0"}], ",", 
   RowBox[{
    RowBox[{"c", "[", "33", "]"}], "\[Rule]", "0"}], ",", 
   RowBox[{
    RowBox[{"c", "[", "45", "]"}], "\[Rule]", "0"}], ",", 
   RowBox[{
    RowBox[{"c", "[", "50", "]"}], "\[Rule]", "0"}], ",", 
   RowBox[{
    RowBox[{"c", "[", "68", "]"}], "\[Rule]", "1"}], ",", 
   RowBox[{
    RowBox[{"c", "[", "201", "]"}], "\[Rule]", "0"}], ",", 
   RowBox[{
    RowBox[{"c", "[", "203", "]"}], "\[Rule]", "0"}], ",", 
   RowBox[{
    RowBox[{"c", "[", "205", "]"}], "\[Rule]", "0"}], ",", 
   RowBox[{
    RowBox[{"c", "[", "209", "]"}], "\[Rule]", "0"}], ",", 
   RowBox[{
    RowBox[{"c", "[", "227", "]"}], "\[Rule]", "0"}]}], "}"}]], "Output",
 CellChangeTimes->{3.878105405899537*^9, 3.878106662223672*^9, 
  3.8781107493123293`*^9, 3.878616604954859*^9, 3.8788573633304167`*^9},
 CellLabel->
  "Out[441]=",ExpressionUUID->"1e8928c1-e861-4a75-9e59-79baee9e8d3e"]
}, Open  ]]
}, Open  ]],

Cell[CellGroupData[{

Cell["Factorisation condition v.p3", "Subsection",
 CellChangeTimes->{{3.878076748965989*^9, 3.878076767862722*^9}, {
  3.878093747799068*^9, 3.8780937495889473`*^9}, {3.878095192789927*^9, 
  3.8780951929813747`*^9}},ExpressionUUID->"c0254820-aca8-4b81-aa66-\
6d34b6c862ff"],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{
  RowBox[{"numAnsatz4", "=", 
   RowBox[{
    RowBox[{
     RowBox[{
      RowBox[{
       RowBox[{"(", "numAnsatz3", ")"}], "//.", "dotRules"}], "/.", 
      RowBox[{"(", 
       RowBox[{
        RowBox[{"vonshell", "[", 
         RowBox[{
          RowBox[{"n", "-", "1"}], ",", "2"}], "]"}], "/.", 
        RowBox[{"v", "->", 
         RowBox[{"v", "[", "1", "]"}]}]}], ")"}]}], "/.", "solsvp2"}], "//", 
    "Expand"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{"%", "//", "Length"}]}], "Input",
 CellChangeTimes->{{3.878076776346158*^9, 3.878076791822427*^9}, {
   3.878076863747164*^9, 3.8780768651784353`*^9}, {3.878077446334421*^9, 
   3.878077450450157*^9}, 3.878080568874198*^9, 3.878080843522138*^9, {
   3.878084931218405*^9, 3.8780849369136047`*^9}, {3.878085107286035*^9, 
   3.878085112014679*^9}, {3.8780852927862673`*^9, 3.878085294285921*^9}, {
   3.8780937634764643`*^9, 3.8780937712084923`*^9}, {3.878094578752013*^9, 
   3.87809458003332*^9}, {3.8780951988903418`*^9, 3.8780952057126427`*^9}, {
   3.8780957389282017`*^9, 3.878095739594145*^9}},
 CellLabel->
  "In[442]:=",ExpressionUUID->"f44f5ba3-2a89-47dd-9ccf-21fb467a01a7"],

Cell[BoxData["85"], "Output",
 CellChangeTimes->{{3.87807677960294*^9, 3.878076792387086*^9}, 
   3.878076869394702*^9, 3.878077463656658*^9, 3.878080582971023*^9, 
   3.878081061748372*^9, 3.878084951014349*^9, 3.878085126532173*^9, 
   3.878085312641127*^9, 3.878093665706396*^9, 3.878094602309922*^9, 
   3.878095215999476*^9, 3.878096067273143*^9, 3.878106671780857*^9, 
   3.878110759023982*^9, 3.878616605550322*^9, 3.878857363937367*^9},
 CellLabel->
  "Out[443]=",ExpressionUUID->"302e82cb-665a-42f9-8a2d-becc51be7a4d"]
}, Open  ]],

Cell[BoxData[
 RowBox[{
  RowBox[{"numAnsatzvp1", "=", 
   RowBox[{
    RowBox[{
     RowBox[{
      RowBox[{"(", 
       RowBox[{
        RowBox[{
         RowBox[{"(", 
          RowBox[{"numAnsatz4", "//", 
           RowBox[{"Cases", "[", 
            RowBox[{"Times", "[", 
             RowBox[{"f___", ",", 
              RowBox[{"Power", "[", 
               RowBox[{
                RowBox[{"dot", "[", 
                 RowBox[{
                  RowBox[{"p", "[", "3", "]"}], ",", 
                  RowBox[{"v", "[", "1", "]"}]}], "]"}], ",", 
                RowBox[{"-", "1"}]}], "]"}], ",", "g___"}], "]"}], "]"}]}], 
          ")"}], "/.", 
         RowBox[{
          RowBox[{"Power", "[", 
           RowBox[{
            RowBox[{"dot", "[", 
             RowBox[{
              RowBox[{"p", "[", "3", "]"}], ",", 
              RowBox[{"v", "[", "1", "]"}]}], "]"}], ",", 
            RowBox[{"-", "1"}]}], "]"}], "->", "1"}]}], "//", "Total"}], 
       ")"}], "//.", "dotRules"}], "/.", "vponshell"}], "/.", 
    RowBox[{"{", 
     RowBox[{
      RowBox[{
       RowBox[{"dot", "[", 
        RowBox[{
         RowBox[{"p", "[", "3", "]"}], ",", 
         RowBox[{"v", "[", "1", "]"}]}], "]"}], "->", "0"}], ",", 
      RowBox[{
       RowBox[{"dot", "[", 
        RowBox[{
         RowBox[{"p", "[", "2", "]"}], ",", 
         RowBox[{"v", "[", "1", "]"}]}], "]"}], "->", 
       RowBox[{"-", 
        RowBox[{"dot", "[", 
         RowBox[{
          RowBox[{"p", "[", "1", "]"}], ",", 
          RowBox[{"v", "[", "1", "]"}]}], "]"}]}]}]}], "}"}]}]}], 
  ";"}]], "Input",
 CellChangeTimes->{{3.878077052129978*^9, 3.878077125591745*^9}, {
   3.878077237157652*^9, 3.878077281353335*^9}, {3.8780773702267103`*^9, 
   3.8780774435353603`*^9}, {3.8780774739935207`*^9, 3.8780775017717133`*^9}, 
   3.878079930873101*^9, 3.878079973240665*^9, {3.878085415182927*^9, 
   3.8780854153236303`*^9}, 3.878085446328352*^9, {3.878094648731681*^9, 
   3.878094651846068*^9}, {3.878094696417069*^9, 3.878094712612356*^9}, 
   3.8780952799470053`*^9, {3.878095329611971*^9, 3.878095354825946*^9}},
 CellLabel->
  "In[444]:=",ExpressionUUID->"d12fd0ee-7560-4079-8d93-ae508a9a0722"],

Cell[BoxData[{
 RowBox[{
  RowBox[{"num1", "=", 
   RowBox[{
    RowBox[{
     RowBox[{"T", "[", 
      RowBox[{"{", "3", "}"}], "]"}], "/.", 
     RowBox[{"T", "->", "T2F"}]}], "/.", 
    RowBox[{"v", "->", 
     RowBox[{"v", "[", "1", "]"}]}]}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"num2", "=", 
   RowBox[{"(", 
    RowBox[{
     FractionBox[
      RowBox[{"dot", "[", 
       RowBox[{
        RowBox[{"p", "[", "1", "]"}], ",", 
        RowBox[{"S", "[", "0", "]"}], ",", 
        RowBox[{"F", "[", "1", "]"}], ",", 
        RowBox[{"F", "[", "2", "]"}], ",", 
        RowBox[{"v", "[", "1", "]"}]}], "]"}], 
      RowBox[{"dot", "[", 
       RowBox[{
        RowBox[{"p", "[", "1", "]"}], ",", 
        RowBox[{"v", "[", "1", "]"}]}], "]"}]], "+", 
     FractionBox[
      RowBox[{"dot", "[", 
       RowBox[{
        RowBox[{"p", "[", "1", "]"}], ",", 
        RowBox[{"S", "[", "0", "]"}], ",", 
        RowBox[{"F", "[", "2", "]"}], ",", 
        RowBox[{"F", "[", "1", "]"}], ",", 
        RowBox[{"v", "[", "1", "]"}]}], "]"}], 
      RowBox[{"dot", "[", 
       RowBox[{
        RowBox[{"p", "[", "1", "]"}], ",", 
        RowBox[{"v", "[", "1", "]"}]}], "]"}]], "-", 
     FractionBox[
      RowBox[{"dot", "[", 
       RowBox[{
        RowBox[{"p", "[", "1", "]"}], ",", 
        RowBox[{"F", "[", "2", "]"}], ",", 
        RowBox[{"S", "[", "0", "]"}], ",", 
        RowBox[{"F", "[", "1", "]"}], ",", 
        RowBox[{"v", "[", "1", "]"}]}], "]"}], 
      RowBox[{"dot", "[", 
       RowBox[{
        RowBox[{"p", "[", "1", "]"}], ",", 
        RowBox[{"v", "[", "1", "]"}]}], "]"}]], "+", 
     FractionBox[
      RowBox[{"dot", "[", 
       RowBox[{
        RowBox[{"p", "[", "2", "]"}], ",", 
        RowBox[{"S", "[", "0", "]"}], ",", 
        RowBox[{"F", "[", "2", "]"}], ",", 
        RowBox[{"F", "[", "1", "]"}], ",", 
        RowBox[{"v", "[", "1", "]"}]}], "]"}], 
      RowBox[{"dot", "[", 
       RowBox[{
        RowBox[{"p", "[", "1", "]"}], ",", 
        RowBox[{"v", "[", "1", "]"}]}], "]"}]]}], ")"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"numvp1", "=", 
   RowBox[{
    RowBox[{
     RowBox[{
      RowBox[{
       RowBox[{"dot", "[", 
        RowBox[{
         RowBox[{
          RowBox[{"p", "[", "1", "]"}], "+", 
          RowBox[{"p", "[", "2", "]"}]}], ",", 
         RowBox[{"p", "[", "3", "]"}]}], "]"}], 
       RowBox[{"(", 
        RowBox[{
         RowBox[{
          RowBox[{"c", "[", "3", "]"}], "num1", "*", "num2"}], "+", 
         RowBox[{
          FractionBox["1", 
           RowBox[{"dot", "[", 
            RowBox[{
             RowBox[{"p", "[", "1", "]"}], ",", 
             RowBox[{"v", "[", "1", "]"}]}], "]"}]], 
          RowBox[{"c", "[", "4", "]"}], 
          RowBox[{"dot", "[", 
           RowBox[{
            RowBox[{"p", "[", "3", "]"}], ",", 
            RowBox[{"S", "[", "0", "]"}], ",", 
            RowBox[{"\[Epsilon]", "[", "3", "]"}]}], "]"}], "*", 
          RowBox[{"dot", "[", 
           RowBox[{
            RowBox[{"v", "[", "1", "]"}], ",", 
            RowBox[{"F", "[", "1", "]"}], ",", 
            RowBox[{"F", "[", "2", "]"}], ",", 
            RowBox[{"v", "[", "1", "]"}]}], "]"}]}]}], ")"}]}], "//.", 
      "dotRules"}], "//", "expandFS"}], "//", "Expand"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"numvp1", "=", 
   RowBox[{
    RowBox[{
     RowBox[{"numvp1", "//.", "dotRules"}], "/.", "vponshell"}], "/.", 
    RowBox[{"{", 
     RowBox[{
      RowBox[{
       RowBox[{"dot", "[", 
        RowBox[{
         RowBox[{"p", "[", "3", "]"}], ",", 
         RowBox[{"v", "[", "1", "]"}]}], "]"}], "->", "0"}], ",", 
      RowBox[{
       RowBox[{"dot", "[", 
        RowBox[{
         RowBox[{"p", "[", "2", "]"}], ",", 
         RowBox[{"v", "[", "1", "]"}]}], "]"}], "->", 
       RowBox[{"-", 
        RowBox[{"dot", "[", 
         RowBox[{
          RowBox[{"p", "[", "1", "]"}], ",", 
          RowBox[{"v", "[", "1", "]"}]}], "]"}]}]}]}], "}"}]}]}], 
  ";"}]}], "Input",
 CellChangeTimes->{{3.878077591985273*^9, 3.8780776461342783`*^9}, {
   3.878077953502172*^9, 3.878077980733405*^9}, {3.878078491930747*^9, 
   3.878078549563458*^9}, {3.878078580745262*^9, 3.87807865251903*^9}, 
   3.878078684800146*^9, {3.878079206140265*^9, 3.878079212664543*^9}, {
   3.878079938416065*^9, 3.8780799390210323`*^9}, {3.878079982854789*^9, 
   3.878079996138009*^9}, 3.878080718496252*^9, 3.878080776110016*^9, {
   3.878081116226698*^9, 3.8780811179219093`*^9}, {3.878081897887516*^9, 
   3.878081929737031*^9}, {3.8780819770250673`*^9, 3.8780819885274878`*^9}, 
   3.8780820357161922`*^9, {3.878082093586617*^9, 3.878082094494379*^9}, 
   3.878082200584118*^9, 3.8780823524734297`*^9, 3.8780843780876017`*^9, {
   3.87808451838385*^9, 3.878084553403726*^9}, {3.878084767872551*^9, 
   3.878084809993238*^9}, {3.878093413770879*^9, 3.878093418381057*^9}, 
   3.878094731163116*^9, {3.878094787760552*^9, 3.878094870939351*^9}, {
   3.878094944453622*^9, 3.878094946794712*^9}, {3.878095374742682*^9, 
   3.878095391986203*^9}, {3.8780954563856373`*^9, 3.878095483306056*^9}, {
   3.878095605265438*^9, 3.878095616154799*^9}, {3.878095684075735*^9, 
   3.878095688268168*^9}},
 CellLabel->
  "In[445]:=",ExpressionUUID->"3ca9767b-e9d3-4bb0-9e75-152b76f7ad91"],

Cell[BoxData[
 RowBox[{
  RowBox[{"compvp1", "=", 
   RowBox[{"numAnsatzvp1", "-", "numvp1"}]}], ";"}]], "Input",
 CellChangeTimes->{{3.8780781147500143`*^9, 3.878078179889933*^9}, {
   3.878078714167301*^9, 3.878078719908218*^9}, {3.878078864983605*^9, 
   3.8780788894932623`*^9}, 3.878079927920136*^9, 3.87808000213634*^9},
 CellLabel->
  "In[449]:=",ExpressionUUID->"2d03fca1-afb7-4b7b-84dd-e804fcd254d7"],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"compvp1", "/.", 
  RowBox[{"{", 
   RowBox[{
    RowBox[{
     RowBox[{"c", "[", "3", "]"}], "->", "1"}], ",", 
    RowBox[{
     RowBox[{"c", "[", "4", "]"}], "->", "1"}]}], "}"}]}]], "Input",
 CellChangeTimes->{{3.878095527643024*^9, 3.878095578279685*^9}, {
  3.878095625110869*^9, 3.878095641471002*^9}},
 CellLabel->
  "In[450]:=",ExpressionUUID->"6618b060-3530-4f7b-95f7-2e6fb07f110d"],

Cell[BoxData["0"], "Output",
 CellChangeTimes->{{3.878095519546192*^9, 3.878095530830967*^9}, {
   3.8780955685470467`*^9, 3.878095578769575*^9}, {3.8780956254979887`*^9, 
   3.87809564203146*^9}, 3.878095695176092*^9, 3.8780960673961983`*^9, 
   3.878616605652708*^9, 3.87885736402617*^9},
 CellLabel->
  "Out[450]=",ExpressionUUID->"4877ad51-6cb6-4739-91dd-6ed9e2980e41"]
}, Open  ]],

Cell[BoxData[{
 RowBox[{
  RowBox[{"cvars", "=", 
   RowBox[{
    RowBox[{"Cases", "[", 
     RowBox[{"compvp1", ",", 
      RowBox[{"c", "[", "__", "]"}], ",", 
      RowBox[{"{", 
       RowBox[{"0", ",", "\[Infinity]"}], "}"}]}], "]"}], "//", "Union"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"vardot", "=", 
   RowBox[{"compvp1", "//", "Casesdot"}]}], ";"}]}], "Input",
 CellChangeTimes->{{3.878078218083035*^9, 3.878078227195683*^9}},
 CellLabel->
  "In[451]:=",ExpressionUUID->"c65e1169-cdad-4cd2-9c97-8dc323839e66"],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"cvars", "//", "Length"}]], "Input",
 CellChangeTimes->{{3.878078250405406*^9, 3.8780782515980988`*^9}, 
   3.8780793030421352`*^9, {3.878080618122617*^9, 3.878080619511405*^9}},
 CellLabel->
  "In[453]:=",ExpressionUUID->"2beff2b6-538d-4be5-a333-fc1b0eaa1683"],

Cell[BoxData["2"], "Output",
 CellChangeTimes->{
  3.878078252063862*^9, 3.878078732430634*^9, {3.8780792683050127`*^9, 
   3.878079303531766*^9}, {3.8780806116761723`*^9, 3.878080620497012*^9}, 
   3.878080793272333*^9, 3.8780810935750732`*^9, 3.8780811318686132`*^9, 
   3.878081941084124*^9, 3.8780820011325197`*^9, 3.878082120982493*^9, 
   3.878084828486793*^9, 3.878085517830093*^9, 3.878093680935251*^9, 
   3.878095084936636*^9, 3.878095713545517*^9, 3.878096067412579*^9, 
   3.878616605662055*^9, 3.8788573640348387`*^9},
 CellLabel->
  "Out[453]=",ExpressionUUID->"1fc12ec1-45d7-454e-a142-152847713712"]
}, Open  ]],

Cell[BoxData[{
 RowBox[{
  RowBox[{"dot2num", ":=", 
   RowBox[{"Table", "[", 
    RowBox[{
     RowBox[{"Rule", "[", 
      RowBox[{
       RowBox[{"vardot", "[", 
        RowBox[{"[", "ii", "]"}], "]"}], ",", 
       RowBox[{"RandomInteger", "[", 
        RowBox[{"{", 
         RowBox[{"10", ",", "100"}], "}"}], "]"}]}], "]"}], ",", 
     RowBox[{"{", 
      RowBox[{"ii", ",", 
       RowBox[{"Length", "[", "vardot", "]"}]}], "}"}]}], "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{"Monitor", "[", 
  RowBox[{
   RowBox[{
    RowBox[{"eqDep", "=", 
     RowBox[{"Table", "[", 
      RowBox[{
       RowBox[{
        RowBox[{"compvp1", "\[Equal]", "0"}], "/.", "dot2num"}], ",", 
       RowBox[{"{", 
        RowBox[{"ii", ",", 
         RowBox[{"10", "+", 
          RowBox[{"Length", "[", "cvars", "]"}]}]}], "}"}]}], "]"}]}], ";"}], 
   ",", "ii"}], "]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"solsvp3", "=", 
   RowBox[{
    RowBox[{"Solve", "[", 
     RowBox[{"eqDep", ",", "cvars"}], "]"}], "[", 
    RowBox[{"[", "1", "]"}], "]"}]}], ";"}]}], "Input",
 CellChangeTimes->{{3.878078221639757*^9, 3.878078240954069*^9}, {
  3.878081064658252*^9, 3.8780810690042477`*^9}, {3.878095733492796*^9, 
  3.878095733629385*^9}},
 CellLabel->
  "In[454]:=",ExpressionUUID->"ebacb69c-e1e6-4f28-8079-82399b128b1f"],

Cell[CellGroupData[{

Cell[BoxData["solsvp3"], "Input",
 CellChangeTimes->{{3.878096861054673*^9, 3.8780968614695673`*^9}},
 CellLabel->
  "In[457]:=",ExpressionUUID->"a0138ef6-8b8f-40a7-b906-46fcd545dcc3"],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
   RowBox[{
    RowBox[{"c", "[", "3", "]"}], "\[Rule]", "1"}], ",", 
   RowBox[{
    RowBox[{"c", "[", "4", "]"}], "\[Rule]", "1"}]}], "}"}]], "Output",
 CellChangeTimes->{3.878093691306862*^9, 3.878095112706624*^9, 
  3.878095717543086*^9, 3.878096067453002*^9, 3.878096861847978*^9, 
  3.878106689921917*^9, 3.8781107730356693`*^9, 3.878616605707658*^9, 
  3.8788573640666857`*^9},
 CellLabel->
  "Out[457]=",ExpressionUUID->"fb1f2206-2cd2-46ee-a96d-9c5722c6732c"]
}, Open  ]]
}, Open  ]],

Cell[CellGroupData[{

Cell["Final Result", "Subsection",
 CellChangeTimes->{{3.878095815607132*^9, 
  3.878095824409616*^9}},ExpressionUUID->"235c536f-16df-4021-9cdf-\
dadca244d542"],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"ansatzIdp", "/.", "sols"}], "/.", "solsvp1"}], "/.", "solsvp2"}],
   ";"}], "\[IndentingNewLine]", 
 RowBox[{"%", "//.", "nice"}]}], "Input",
 CellChangeTimes->{{3.8780958303263483`*^9, 3.878095831726018*^9}, {
   3.878096867922544*^9, 3.878096935558015*^9}, {3.878097392092999*^9, 
   3.878097396030863*^9}, 3.878110801162511*^9, 3.878111220809681*^9},
 CellLabel->
  "In[458]:=",ExpressionUUID->"33810c38-01c9-446b-9c80-6c7678d2a202"],

Cell[BoxData[
 RowBox[{
  FractionBox[
   RowBox[{
    RowBox[{
     SubscriptBox["p", "1"], "\[CenterDot]", 
     SubscriptBox["F", "2"], "\[CenterDot]", 
     SubscriptBox["F", "3"], "\[CenterDot]", 
     SubscriptBox["v", "1"]}], " ", 
    RowBox[{
     SubscriptBox["p", "1"], "\[CenterDot]", 
     SubscriptBox["S", "0"], "\[CenterDot]", 
     SubscriptBox["F", "1"], "\[CenterDot]", 
     SubscriptBox["v", "1"]}]}], 
   RowBox[{
    RowBox[{
     SubscriptBox["p", "1"], "\[CenterDot]", 
     SubscriptBox["v", "1"]}], " ", 
    RowBox[{"(", 
     RowBox[{
      RowBox[{
       SubscriptBox["p", "1"], "\[CenterDot]", 
       SubscriptBox["v", "1"]}], "+", 
      RowBox[{
       SubscriptBox["p", "2"], "\[CenterDot]", 
       SubscriptBox["v", "1"]}]}], ")"}]}]], "+", 
  FractionBox[
   RowBox[{
    RowBox[{
     SubscriptBox["p", "2"], "\[CenterDot]", 
     SubscriptBox["F", "1"], "\[CenterDot]", 
     SubscriptBox["F", "3"], "\[CenterDot]", 
     SubscriptBox["v", "1"]}], " ", 
    RowBox[{
     SubscriptBox["p", "2"], "\[CenterDot]", 
     SubscriptBox["S", "0"], "\[CenterDot]", 
     SubscriptBox["F", "2"], "\[CenterDot]", 
     SubscriptBox["v", "1"]}]}], 
   RowBox[{
    RowBox[{
     SubscriptBox["p", "1"], "\[CenterDot]", 
     SubscriptBox["v", "1"]}], " ", 
    RowBox[{"(", 
     RowBox[{
      RowBox[{
       SubscriptBox["p", "1"], "\[CenterDot]", 
       SubscriptBox["v", "1"]}], "+", 
      RowBox[{
       SubscriptBox["p", "2"], "\[CenterDot]", 
       SubscriptBox["v", "1"]}]}], ")"}]}]], "+", 
  FractionBox[
   RowBox[{
    RowBox[{
     SubscriptBox["p", "2"], "\[CenterDot]", 
     SubscriptBox["F", "1"], "\[CenterDot]", 
     SubscriptBox["F", "3"], "\[CenterDot]", 
     SubscriptBox["v", "1"]}], " ", 
    RowBox[{
     SubscriptBox["p", "2"], "\[CenterDot]", 
     SubscriptBox["S", "0"], "\[CenterDot]", 
     SubscriptBox["F", "2"], "\[CenterDot]", 
     SubscriptBox["v", "1"]}]}], 
   RowBox[{
    RowBox[{
     SubscriptBox["p", "1"], "\[CenterDot]", 
     SubscriptBox["v", "1"]}], " ", 
    RowBox[{"(", 
     RowBox[{
      RowBox[{
       SubscriptBox["p", "1"], "\[CenterDot]", 
       SubscriptBox["v", "1"]}], "+", 
      RowBox[{
       SubscriptBox["p", "3"], "\[CenterDot]", 
       SubscriptBox["v", "1"]}]}], ")"}]}]], "+", 
  FractionBox[
   RowBox[{
    RowBox[{
     SubscriptBox["p", "3"], "\[CenterDot]", 
     SubscriptBox["F", "1"], "\[CenterDot]", 
     SubscriptBox["F", "2"], "\[CenterDot]", 
     SubscriptBox["v", "1"]}], " ", 
    RowBox[{
     SubscriptBox["p", "3"], "\[CenterDot]", 
     SubscriptBox["S", "0"], "\[CenterDot]", 
     SubscriptBox["F", "3"], "\[CenterDot]", 
     SubscriptBox["v", "1"]}]}], 
   RowBox[{
    RowBox[{
     SubscriptBox["p", "1"], "\[CenterDot]", 
     SubscriptBox["v", "1"]}], " ", 
    RowBox[{"(", 
     RowBox[{
      RowBox[{
       SubscriptBox["p", "1"], "\[CenterDot]", 
       SubscriptBox["v", "1"]}], "+", 
      RowBox[{
       SubscriptBox["p", "2"], "\[CenterDot]", 
       SubscriptBox["v", "1"]}]}], ")"}]}]], "+", 
  FractionBox[
   RowBox[{
    RowBox[{
     SubscriptBox["p", "3"], "\[CenterDot]", 
     SubscriptBox["F", "1"], "\[CenterDot]", 
     SubscriptBox["F", "2"], "\[CenterDot]", 
     SubscriptBox["v", "1"]}], " ", 
    RowBox[{
     SubscriptBox["p", "3"], "\[CenterDot]", 
     SubscriptBox["S", "0"], "\[CenterDot]", 
     SubscriptBox["F", "3"], "\[CenterDot]", 
     SubscriptBox["v", "1"]}]}], 
   RowBox[{
    RowBox[{
     SubscriptBox["p", "1"], "\[CenterDot]", 
     SubscriptBox["v", "1"]}], " ", 
    RowBox[{"(", 
     RowBox[{
      RowBox[{
       SubscriptBox["p", "1"], "\[CenterDot]", 
       SubscriptBox["v", "1"]}], "+", 
      RowBox[{
       SubscriptBox["p", "3"], "\[CenterDot]", 
       SubscriptBox["v", "1"]}]}], ")"}]}]], "+", 
  FractionBox[
   RowBox[{
    RowBox[{
     SubscriptBox["p", "3"], "\[CenterDot]", 
     SubscriptBox["F", "2"], "\[CenterDot]", 
     SubscriptBox["F", "1"], "\[CenterDot]", 
     SubscriptBox["v", "1"]}], " ", 
    RowBox[{
     SubscriptBox["p", "3"], "\[CenterDot]", 
     SubscriptBox["S", "0"], "\[CenterDot]", 
     SubscriptBox["F", "3"], "\[CenterDot]", 
     SubscriptBox["v", "1"]}]}], 
   RowBox[{
    RowBox[{
     SubscriptBox["p", "1"], "\[CenterDot]", 
     SubscriptBox["v", "1"]}], " ", 
    RowBox[{"(", 
     RowBox[{
      RowBox[{
       SubscriptBox["p", "1"], "\[CenterDot]", 
       SubscriptBox["v", "1"]}], "+", 
      RowBox[{
       SubscriptBox["p", "2"], "\[CenterDot]", 
       SubscriptBox["v", "1"]}]}], ")"}]}]], "-", 
  FractionBox[
   RowBox[{
    RowBox[{
     SubscriptBox["p", "1"], "\[CenterDot]", 
     SubscriptBox["F", "3"], "\[CenterDot]", 
     SubscriptBox["S", "0"], "\[CenterDot]", 
     SubscriptBox["p", "2"]}], " ", 
    RowBox[{
     SubscriptBox["v", "1"], "\[CenterDot]", 
     SubscriptBox["F", "1"], "\[CenterDot]", 
     SubscriptBox["F", "2"], "\[CenterDot]", 
     SubscriptBox["v", "1"]}]}], 
   RowBox[{
    RowBox[{
     SubscriptBox["p", "1"], "\[CenterDot]", 
     SubscriptBox["v", "1"]}], " ", 
    RowBox[{"(", 
     RowBox[{
      RowBox[{
       SubscriptBox["p", "1"], "\[CenterDot]", 
       SubscriptBox["v", "1"]}], "+", 
      RowBox[{
       SubscriptBox["p", "3"], "\[CenterDot]", 
       SubscriptBox["v", "1"]}]}], ")"}]}]], "+", 
  FractionBox[
   RowBox[{
    RowBox[{
     SubscriptBox["p", "1"], "\[CenterDot]", 
     SubscriptBox["F", "3"], "\[CenterDot]", 
     SubscriptBox["S", "0"], "\[CenterDot]", 
     SubscriptBox["p", "3"]}], " ", 
    RowBox[{
     SubscriptBox["v", "1"], "\[CenterDot]", 
     SubscriptBox["F", "1"], "\[CenterDot]", 
     SubscriptBox["F", "2"], "\[CenterDot]", 
     SubscriptBox["v", "1"]}]}], 
   RowBox[{
    RowBox[{
     SubscriptBox["p", "1"], "\[CenterDot]", 
     SubscriptBox["v", "1"]}], " ", 
    RowBox[{"(", 
     RowBox[{
      RowBox[{
       SubscriptBox["p", "1"], "\[CenterDot]", 
       SubscriptBox["v", "1"]}], "+", 
      RowBox[{
       SubscriptBox["p", "2"], "\[CenterDot]", 
       SubscriptBox["v", "1"]}]}], ")"}]}]], "+", 
  FractionBox[
   RowBox[{
    RowBox[{
     SubscriptBox["p", "1"], "\[CenterDot]", 
     SubscriptBox["F", "3"], "\[CenterDot]", 
     SubscriptBox["S", "0"], "\[CenterDot]", 
     SubscriptBox["p", "3"]}], " ", 
    RowBox[{
     SubscriptBox["v", "1"], "\[CenterDot]", 
     SubscriptBox["F", "1"], "\[CenterDot]", 
     SubscriptBox["F", "2"], "\[CenterDot]", 
     SubscriptBox["v", "1"]}]}], 
   RowBox[{
    RowBox[{
     SubscriptBox["p", "1"], "\[CenterDot]", 
     SubscriptBox["v", "1"]}], " ", 
    RowBox[{"(", 
     RowBox[{
      RowBox[{
       SubscriptBox["p", "1"], "\[CenterDot]", 
       SubscriptBox["v", "1"]}], "+", 
      RowBox[{
       SubscriptBox["p", "3"], "\[CenterDot]", 
       SubscriptBox["v", "1"]}]}], ")"}]}]], "+", 
  FractionBox[
   RowBox[{
    RowBox[{
     SubscriptBox["p", "1"], "\[CenterDot]", 
     SubscriptBox["S", "0"], "\[CenterDot]", 
     SubscriptBox["F", "3"], "\[CenterDot]", 
     SubscriptBox["p", "2"]}], " ", 
    RowBox[{
     SubscriptBox["v", "1"], "\[CenterDot]", 
     SubscriptBox["F", "1"], "\[CenterDot]", 
     SubscriptBox["F", "2"], "\[CenterDot]", 
     SubscriptBox["v", "1"]}]}], 
   RowBox[{
    RowBox[{
     SubscriptBox["p", "1"], "\[CenterDot]", 
     SubscriptBox["v", "1"]}], " ", 
    RowBox[{"(", 
     RowBox[{
      RowBox[{
       SubscriptBox["p", "1"], "\[CenterDot]", 
       SubscriptBox["v", "1"]}], "+", 
      RowBox[{
       SubscriptBox["p", "3"], "\[CenterDot]", 
       SubscriptBox["v", "1"]}]}], ")"}]}]], "+", 
  FractionBox[
   RowBox[{
    RowBox[{
     SubscriptBox["p", "2"], "\[CenterDot]", 
     SubscriptBox["F", "3"], "\[CenterDot]", 
     SubscriptBox["S", "0"], "\[CenterDot]", 
     SubscriptBox["p", "3"]}], " ", 
    RowBox[{
     SubscriptBox["v", "1"], "\[CenterDot]", 
     SubscriptBox["F", "1"], "\[CenterDot]", 
     SubscriptBox["F", "2"], "\[CenterDot]", 
     SubscriptBox["v", "1"]}]}], 
   RowBox[{
    RowBox[{
     SubscriptBox["p", "1"], "\[CenterDot]", 
     SubscriptBox["v", "1"]}], " ", 
    RowBox[{"(", 
     RowBox[{
      RowBox[{
       SubscriptBox["p", "1"], "\[CenterDot]", 
       SubscriptBox["v", "1"]}], "+", 
      RowBox[{
       SubscriptBox["p", "2"], "\[CenterDot]", 
       SubscriptBox["v", "1"]}]}], ")"}]}]], "+", 
  FractionBox[
   RowBox[{
    RowBox[{
     SubscriptBox["p", "1"], "\[CenterDot]", 
     SubscriptBox["F", "2"], "\[CenterDot]", 
     SubscriptBox["S", "0"], "\[CenterDot]", 
     SubscriptBox["p", "2"]}], " ", 
    RowBox[{
     SubscriptBox["v", "1"], "\[CenterDot]", 
     SubscriptBox["F", "1"], "\[CenterDot]", 
     SubscriptBox["F", "3"], "\[CenterDot]", 
     SubscriptBox["v", "1"]}]}], 
   RowBox[{
    RowBox[{
     SubscriptBox["p", "1"], "\[CenterDot]", 
     SubscriptBox["v", "1"]}], " ", 
    RowBox[{"(", 
     RowBox[{
      RowBox[{
       SubscriptBox["p", "1"], "\[CenterDot]", 
       SubscriptBox["v", "1"]}], "+", 
      RowBox[{
       SubscriptBox["p", "2"], "\[CenterDot]", 
       SubscriptBox["v", "1"]}]}], ")"}]}]], "+", 
  FractionBox[
   RowBox[{
    RowBox[{
     SubscriptBox["p", "1"], "\[CenterDot]", 
     SubscriptBox["F", "2"], "\[CenterDot]", 
     SubscriptBox["S", "0"], "\[CenterDot]", 
     SubscriptBox["p", "2"]}], " ", 
    RowBox[{
     SubscriptBox["v", "1"], "\[CenterDot]", 
     SubscriptBox["F", "1"], "\[CenterDot]", 
     SubscriptBox["F", "3"], "\[CenterDot]", 
     SubscriptBox["v", "1"]}]}], 
   RowBox[{
    RowBox[{
     SubscriptBox["p", "1"], "\[CenterDot]", 
     SubscriptBox["v", "1"]}], " ", 
    RowBox[{"(", 
     RowBox[{
      RowBox[{
       SubscriptBox["p", "1"], "\[CenterDot]", 
       SubscriptBox["v", "1"]}], "+", 
      RowBox[{
       SubscriptBox["p", "3"], "\[CenterDot]", 
       SubscriptBox["v", "1"]}]}], ")"}]}]], "-", 
  FractionBox[
   RowBox[{
    RowBox[{
     SubscriptBox["p", "1"], "\[CenterDot]", 
     SubscriptBox["F", "2"], "\[CenterDot]", 
     SubscriptBox["S", "0"], "\[CenterDot]", 
     SubscriptBox["p", "3"]}], " ", 
    RowBox[{
     SubscriptBox["v", "1"], "\[CenterDot]", 
     SubscriptBox["F", "1"], "\[CenterDot]", 
     SubscriptBox["F", "3"], "\[CenterDot]", 
     SubscriptBox["v", "1"]}]}], 
   RowBox[{
    RowBox[{
     SubscriptBox["p", "1"], "\[CenterDot]", 
     SubscriptBox["v", "1"]}], " ", 
    RowBox[{"(", 
     RowBox[{
      RowBox[{
       SubscriptBox["p", "1"], "\[CenterDot]", 
       SubscriptBox["v", "1"]}], "+", 
      RowBox[{
       SubscriptBox["p", "2"], "\[CenterDot]", 
       SubscriptBox["v", "1"]}]}], ")"}]}]], "+", 
  FractionBox[
   RowBox[{
    RowBox[{
     SubscriptBox["p", "1"], "\[CenterDot]", 
     SubscriptBox["S", "0"], "\[CenterDot]", 
     SubscriptBox["F", "1"], "\[CenterDot]", 
     SubscriptBox["p", "2"]}], " ", 
    RowBox[{
     SubscriptBox["v", "1"], "\[CenterDot]", 
     SubscriptBox["F", "2"], "\[CenterDot]", 
     SubscriptBox["F", "3"], "\[CenterDot]", 
     SubscriptBox["v", "1"]}]}], 
   RowBox[{
    RowBox[{
     SubscriptBox["p", "1"], "\[CenterDot]", 
     SubscriptBox["v", "1"]}], " ", 
    RowBox[{"(", 
     RowBox[{
      RowBox[{
       SubscriptBox["p", "1"], "\[CenterDot]", 
       SubscriptBox["v", "1"]}], "+", 
      RowBox[{
       SubscriptBox["p", "2"], "\[CenterDot]", 
       SubscriptBox["v", "1"]}]}], ")"}]}]], "-", 
  FractionBox[
   RowBox[{
    RowBox[{
     SubscriptBox["p", "2"], "\[CenterDot]", 
     SubscriptBox["F", "1"], "\[CenterDot]", 
     SubscriptBox["S", "0"], "\[CenterDot]", 
     SubscriptBox["p", "3"]}], " ", 
    RowBox[{
     SubscriptBox["v", "1"], "\[CenterDot]", 
     SubscriptBox["F", "2"], "\[CenterDot]", 
     SubscriptBox["F", "3"], "\[CenterDot]", 
     SubscriptBox["v", "1"]}]}], 
   RowBox[{
    RowBox[{
     SubscriptBox["p", "1"], "\[CenterDot]", 
     SubscriptBox["v", "1"]}], " ", 
    RowBox[{"(", 
     RowBox[{
      RowBox[{
       SubscriptBox["p", "1"], "\[CenterDot]", 
       SubscriptBox["v", "1"]}], "+", 
      RowBox[{
       SubscriptBox["p", "2"], "\[CenterDot]", 
       SubscriptBox["v", "1"]}]}], ")"}]}]], "-", 
  FractionBox[
   RowBox[{
    RowBox[{
     SubscriptBox["p", "2"], "\[CenterDot]", 
     SubscriptBox["F", "1"], "\[CenterDot]", 
     SubscriptBox["S", "0"], "\[CenterDot]", 
     SubscriptBox["p", "3"]}], " ", 
    RowBox[{
     SubscriptBox["v", "1"], "\[CenterDot]", 
     SubscriptBox["F", "2"], "\[CenterDot]", 
     SubscriptBox["F", "3"], "\[CenterDot]", 
     SubscriptBox["v", "1"]}]}], 
   RowBox[{
    RowBox[{
     SubscriptBox["p", "1"], "\[CenterDot]", 
     SubscriptBox["v", "1"]}], " ", 
    RowBox[{"(", 
     RowBox[{
      RowBox[{
       SubscriptBox["p", "1"], "\[CenterDot]", 
       SubscriptBox["v", "1"]}], "+", 
      RowBox[{
       SubscriptBox["p", "3"], "\[CenterDot]", 
       SubscriptBox["v", "1"]}]}], ")"}]}]], "+", 
  FractionBox[
   RowBox[{
    RowBox[{
     SubscriptBox["p", "1"], "\[CenterDot]", 
     SubscriptBox["F", "3"], "\[CenterDot]", 
     SubscriptBox["v", "1"]}], " ", 
    RowBox[{
     SubscriptBox["p", "1"], "\[CenterDot]", 
     SubscriptBox["F", "2"], "\[CenterDot]", 
     SubscriptBox["S", "0"], "\[CenterDot]", 
     SubscriptBox["F", "1"], "\[CenterDot]", 
     SubscriptBox["v", "1"]}]}], 
   RowBox[{
    RowBox[{
     SubscriptBox["p", "1"], "\[CenterDot]", 
     SubscriptBox["v", "1"]}], " ", 
    RowBox[{"(", 
     RowBox[{
      RowBox[{
       SubscriptBox["p", "1"], "\[CenterDot]", 
       SubscriptBox["v", "1"]}], "+", 
      RowBox[{
       SubscriptBox["p", "2"], "\[CenterDot]", 
       SubscriptBox["v", "1"]}]}], ")"}]}]], "+", 
  FractionBox[
   RowBox[{
    RowBox[{
     SubscriptBox["p", "2"], "\[CenterDot]", 
     SubscriptBox["F", "3"], "\[CenterDot]", 
     SubscriptBox["v", "1"]}], " ", 
    RowBox[{
     SubscriptBox["p", "1"], "\[CenterDot]", 
     SubscriptBox["F", "2"], "\[CenterDot]", 
     SubscriptBox["S", "0"], "\[CenterDot]", 
     SubscriptBox["F", "1"], "\[CenterDot]", 
     SubscriptBox["v", "1"]}]}], 
   RowBox[{
    RowBox[{
     SubscriptBox["p", "1"], "\[CenterDot]", 
     SubscriptBox["v", "1"]}], " ", 
    RowBox[{"(", 
     RowBox[{
      RowBox[{
       SubscriptBox["p", "1"], "\[CenterDot]", 
       SubscriptBox["v", "1"]}], "+", 
      RowBox[{
       SubscriptBox["p", "2"], "\[CenterDot]", 
       SubscriptBox["v", "1"]}]}], ")"}]}]], "-", 
  FractionBox[
   RowBox[{
    RowBox[{
     SubscriptBox["p", "3"], "\[CenterDot]", 
     SubscriptBox["F", "1"], "\[CenterDot]", 
     SubscriptBox["v", "1"]}], " ", 
    RowBox[{
     SubscriptBox["p", "1"], "\[CenterDot]", 
     SubscriptBox["F", "2"], "\[CenterDot]", 
     SubscriptBox["S", "0"], "\[CenterDot]", 
     SubscriptBox["F", "3"], "\[CenterDot]", 
     SubscriptBox["v", "1"]}]}], 
   RowBox[{
    RowBox[{
     SubscriptBox["p", "1"], "\[CenterDot]", 
     SubscriptBox["v", "1"]}], " ", 
    RowBox[{"(", 
     RowBox[{
      RowBox[{
       SubscriptBox["p", "1"], "\[CenterDot]", 
       SubscriptBox["v", "1"]}], "+", 
      RowBox[{
       SubscriptBox["p", "2"], "\[CenterDot]", 
       SubscriptBox["v", "1"]}]}], ")"}]}]], "+", 
  FractionBox[
   RowBox[{
    RowBox[{
     SubscriptBox["p", "1"], "\[CenterDot]", 
     SubscriptBox["F", "2"], "\[CenterDot]", 
     SubscriptBox["v", "1"]}], " ", 
    RowBox[{
     SubscriptBox["p", "1"], "\[CenterDot]", 
     SubscriptBox["F", "3"], "\[CenterDot]", 
     SubscriptBox["S", "0"], "\[CenterDot]", 
     SubscriptBox["F", "1"], "\[CenterDot]", 
     SubscriptBox["v", "1"]}]}], 
   RowBox[{
    RowBox[{
     SubscriptBox["p", "1"], "\[CenterDot]", 
     SubscriptBox["v", "1"]}], " ", 
    RowBox[{"(", 
     RowBox[{
      RowBox[{
       SubscriptBox["p", "1"], "\[CenterDot]", 
       SubscriptBox["v", "1"]}], "+", 
      RowBox[{
       SubscriptBox["p", "3"], "\[CenterDot]", 
       SubscriptBox["v", "1"]}]}], ")"}]}]], "-", 
  FractionBox[
   RowBox[{
    RowBox[{
     SubscriptBox["p", "2"], "\[CenterDot]", 
     SubscriptBox["F", "1"], "\[CenterDot]", 
     SubscriptBox["v", "1"]}], " ", 
    RowBox[{
     SubscriptBox["p", "1"], "\[CenterDot]", 
     SubscriptBox["F", "3"], "\[CenterDot]", 
     SubscriptBox["S", "0"], "\[CenterDot]", 
     SubscriptBox["F", "2"], "\[CenterDot]", 
     SubscriptBox["v", "1"]}]}], 
   RowBox[{
    RowBox[{
     SubscriptBox["p", "1"], "\[CenterDot]", 
     SubscriptBox["v", "1"]}], " ", 
    RowBox[{"(", 
     RowBox[{
      RowBox[{
       SubscriptBox["p", "1"], "\[CenterDot]", 
       SubscriptBox["v", "1"]}], "+", 
      RowBox[{
       SubscriptBox["p", "3"], "\[CenterDot]", 
       SubscriptBox["v", "1"]}]}], ")"}]}]], "-", 
  FractionBox[
   RowBox[{
    RowBox[{
     SubscriptBox["p", "1"], "\[CenterDot]", 
     SubscriptBox["F", "3"], "\[CenterDot]", 
     SubscriptBox["v", "1"]}], " ", 
    RowBox[{
     SubscriptBox["p", "1"], "\[CenterDot]", 
     SubscriptBox["S", "0"], "\[CenterDot]", 
     SubscriptBox["F", "1"], "\[CenterDot]", 
     SubscriptBox["F", "2"], "\[CenterDot]", 
     SubscriptBox["v", "1"]}]}], 
   RowBox[{
    RowBox[{
     SubscriptBox["p", "1"], "\[CenterDot]", 
     SubscriptBox["v", "1"]}], " ", 
    RowBox[{"(", 
     RowBox[{
      RowBox[{
       SubscriptBox["p", "1"], "\[CenterDot]", 
       SubscriptBox["v", "1"]}], "+", 
      RowBox[{
       SubscriptBox["p", "2"], "\[CenterDot]", 
       SubscriptBox["v", "1"]}]}], ")"}]}]], "-", 
  FractionBox[
   RowBox[{
    RowBox[{
     SubscriptBox["p", "1"], "\[CenterDot]", 
     SubscriptBox["F", "3"], "\[CenterDot]", 
     SubscriptBox["v", "1"]}], " ", 
    RowBox[{
     SubscriptBox["p", "1"], "\[CenterDot]", 
     SubscriptBox["S", "0"], "\[CenterDot]", 
     SubscriptBox["F", "1"], "\[CenterDot]", 
     SubscriptBox["F", "2"], "\[CenterDot]", 
     SubscriptBox["v", "1"]}]}], 
   RowBox[{
    RowBox[{
     SubscriptBox["p", "1"], "\[CenterDot]", 
     SubscriptBox["v", "1"]}], " ", 
    RowBox[{"(", 
     RowBox[{
      RowBox[{
       SubscriptBox["p", "1"], "\[CenterDot]", 
       SubscriptBox["v", "1"]}], "+", 
      RowBox[{
       SubscriptBox["p", "3"], "\[CenterDot]", 
       SubscriptBox["v", "1"]}]}], ")"}]}]], "-", 
  FractionBox[
   RowBox[{
    RowBox[{
     SubscriptBox["p", "1"], "\[CenterDot]", 
     SubscriptBox["F", "3"], "\[CenterDot]", 
     SubscriptBox["v", "1"]}], " ", 
    RowBox[{
     SubscriptBox["p", "1"], "\[CenterDot]", 
     SubscriptBox["S", "0"], "\[CenterDot]", 
     SubscriptBox["F", "2"], "\[CenterDot]", 
     SubscriptBox["F", "1"], "\[CenterDot]", 
     SubscriptBox["v", "1"]}]}], 
   RowBox[{
    RowBox[{
     SubscriptBox["p", "1"], "\[CenterDot]", 
     SubscriptBox["v", "1"]}], " ", 
    RowBox[{"(", 
     RowBox[{
      RowBox[{
       SubscriptBox["p", "1"], "\[CenterDot]", 
       SubscriptBox["v", "1"]}], "+", 
      RowBox[{
       SubscriptBox["p", "2"], "\[CenterDot]", 
       SubscriptBox["v", "1"]}]}], ")"}]}]], "-", 
  FractionBox[
   RowBox[{
    RowBox[{
     SubscriptBox["p", "2"], "\[CenterDot]", 
     SubscriptBox["F", "3"], "\[CenterDot]", 
     SubscriptBox["v", "1"]}], " ", 
    RowBox[{
     SubscriptBox["p", "1"], "\[CenterDot]", 
     SubscriptBox["S", "0"], "\[CenterDot]", 
     SubscriptBox["F", "2"], "\[CenterDot]", 
     SubscriptBox["F", "1"], "\[CenterDot]", 
     SubscriptBox["v", "1"]}]}], 
   RowBox[{
    RowBox[{
     SubscriptBox["p", "1"], "\[CenterDot]", 
     SubscriptBox["v", "1"]}], " ", 
    RowBox[{"(", 
     RowBox[{
      RowBox[{
       SubscriptBox["p", "1"], "\[CenterDot]", 
       SubscriptBox["v", "1"]}], "+", 
      RowBox[{
       SubscriptBox["p", "2"], "\[CenterDot]", 
       SubscriptBox["v", "1"]}]}], ")"}]}]], "-", 
  FractionBox[
   RowBox[{
    RowBox[{
     SubscriptBox["p", "1"], "\[CenterDot]", 
     SubscriptBox["F", "2"], "\[CenterDot]", 
     SubscriptBox["v", "1"]}], " ", 
    RowBox[{
     SubscriptBox["p", "1"], "\[CenterDot]", 
     SubscriptBox["S", "0"], "\[CenterDot]", 
     SubscriptBox["F", "3"], "\[CenterDot]", 
     SubscriptBox["F", "1"], "\[CenterDot]", 
     SubscriptBox["v", "1"]}]}], 
   RowBox[{
    RowBox[{
     SubscriptBox["p", "1"], "\[CenterDot]", 
     SubscriptBox["v", "1"]}], " ", 
    RowBox[{"(", 
     RowBox[{
      RowBox[{
       SubscriptBox["p", "1"], "\[CenterDot]", 
       SubscriptBox["v", "1"]}], "+", 
      RowBox[{
       SubscriptBox["p", "3"], "\[CenterDot]", 
       SubscriptBox["v", "1"]}]}], ")"}]}]], "-", 
  FractionBox[
   RowBox[{
    RowBox[{
     SubscriptBox["p", "3"], "\[CenterDot]", 
     SubscriptBox["F", "2"], "\[CenterDot]", 
     SubscriptBox["v", "1"]}], " ", 
    RowBox[{
     SubscriptBox["p", "2"], "\[CenterDot]", 
     SubscriptBox["F", "1"], "\[CenterDot]", 
     SubscriptBox["S", "0"], "\[CenterDot]", 
     SubscriptBox["F", "3"], "\[CenterDot]", 
     SubscriptBox["v", "1"]}]}], 
   RowBox[{
    RowBox[{
     SubscriptBox["p", "1"], "\[CenterDot]", 
     SubscriptBox["v", "1"]}], " ", 
    RowBox[{"(", 
     RowBox[{
      RowBox[{
       SubscriptBox["p", "1"], "\[CenterDot]", 
       SubscriptBox["v", "1"]}], "+", 
      RowBox[{
       SubscriptBox["p", "2"], "\[CenterDot]", 
       SubscriptBox["v", "1"]}]}], ")"}]}]], "-", 
  FractionBox[
   RowBox[{
    RowBox[{
     SubscriptBox["p", "3"], "\[CenterDot]", 
     SubscriptBox["F", "2"], "\[CenterDot]", 
     SubscriptBox["v", "1"]}], " ", 
    RowBox[{
     SubscriptBox["p", "2"], "\[CenterDot]", 
     SubscriptBox["F", "1"], "\[CenterDot]", 
     SubscriptBox["S", "0"], "\[CenterDot]", 
     SubscriptBox["F", "3"], "\[CenterDot]", 
     SubscriptBox["v", "1"]}]}], 
   RowBox[{
    RowBox[{
     SubscriptBox["p", "1"], "\[CenterDot]", 
     SubscriptBox["v", "1"]}], " ", 
    RowBox[{"(", 
     RowBox[{
      RowBox[{
       SubscriptBox["p", "1"], "\[CenterDot]", 
       SubscriptBox["v", "1"]}], "+", 
      RowBox[{
       SubscriptBox["p", "3"], "\[CenterDot]", 
       SubscriptBox["v", "1"]}]}], ")"}]}]], "+", 
  FractionBox[
   RowBox[{
    RowBox[{
     SubscriptBox["p", "1"], "\[CenterDot]", 
     SubscriptBox["F", "2"], "\[CenterDot]", 
     SubscriptBox["v", "1"]}], " ", 
    RowBox[{
     SubscriptBox["p", "2"], "\[CenterDot]", 
     SubscriptBox["F", "3"], "\[CenterDot]", 
     SubscriptBox["S", "0"], "\[CenterDot]", 
     SubscriptBox["F", "1"], "\[CenterDot]", 
     SubscriptBox["v", "1"]}]}], 
   RowBox[{
    RowBox[{
     SubscriptBox["p", "1"], "\[CenterDot]", 
     SubscriptBox["v", "1"]}], " ", 
    RowBox[{"(", 
     RowBox[{
      RowBox[{
       SubscriptBox["p", "1"], "\[CenterDot]", 
       SubscriptBox["v", "1"]}], "+", 
      RowBox[{
       SubscriptBox["p", "3"], "\[CenterDot]", 
       SubscriptBox["v", "1"]}]}], ")"}]}]], "-", 
  FractionBox[
   RowBox[{
    RowBox[{
     SubscriptBox["p", "2"], "\[CenterDot]", 
     SubscriptBox["F", "1"], "\[CenterDot]", 
     SubscriptBox["v", "1"]}], " ", 
    RowBox[{
     SubscriptBox["p", "2"], "\[CenterDot]", 
     SubscriptBox["F", "3"], "\[CenterDot]", 
     SubscriptBox["S", "0"], "\[CenterDot]", 
     SubscriptBox["F", "2"], "\[CenterDot]", 
     SubscriptBox["v", "1"]}]}], 
   RowBox[{
    RowBox[{
     SubscriptBox["p", "1"], "\[CenterDot]", 
     SubscriptBox["v", "1"]}], " ", 
    RowBox[{"(", 
     RowBox[{
      RowBox[{
       SubscriptBox["p", "1"], "\[CenterDot]", 
       SubscriptBox["v", "1"]}], "+", 
      RowBox[{
       SubscriptBox["p", "3"], "\[CenterDot]", 
       SubscriptBox["v", "1"]}]}], ")"}]}]], "-", 
  FractionBox[
   RowBox[{
    RowBox[{
     SubscriptBox["p", "2"], "\[CenterDot]", 
     SubscriptBox["F", "3"], "\[CenterDot]", 
     SubscriptBox["v", "1"]}], " ", 
    RowBox[{
     SubscriptBox["p", "2"], "\[CenterDot]", 
     SubscriptBox["S", "0"], "\[CenterDot]", 
     SubscriptBox["F", "2"], "\[CenterDot]", 
     SubscriptBox["F", "1"], "\[CenterDot]", 
     SubscriptBox["v", "1"]}]}], 
   RowBox[{
    RowBox[{
     SubscriptBox["p", "1"], "\[CenterDot]", 
     SubscriptBox["v", "1"]}], " ", 
    RowBox[{"(", 
     RowBox[{
      RowBox[{
       SubscriptBox["p", "1"], "\[CenterDot]", 
       SubscriptBox["v", "1"]}], "+", 
      RowBox[{
       SubscriptBox["p", "2"], "\[CenterDot]", 
       SubscriptBox["v", "1"]}]}], ")"}]}]], "+", 
  FractionBox[
   RowBox[{
    RowBox[{
     SubscriptBox["p", "2"], "\[CenterDot]", 
     SubscriptBox["F", "1"], "\[CenterDot]", 
     SubscriptBox["v", "1"]}], " ", 
    RowBox[{
     SubscriptBox["p", "2"], "\[CenterDot]", 
     SubscriptBox["S", "0"], "\[CenterDot]", 
     SubscriptBox["F", "3"], "\[CenterDot]", 
     SubscriptBox["F", "2"], "\[CenterDot]", 
     SubscriptBox["v", "1"]}]}], 
   RowBox[{
    RowBox[{
     SubscriptBox["p", "1"], "\[CenterDot]", 
     SubscriptBox["v", "1"]}], " ", 
    RowBox[{"(", 
     RowBox[{
      RowBox[{
       SubscriptBox["p", "1"], "\[CenterDot]", 
       SubscriptBox["v", "1"]}], "+", 
      RowBox[{
       SubscriptBox["p", "3"], "\[CenterDot]", 
       SubscriptBox["v", "1"]}]}], ")"}]}]]}]], "Output",
 CellChangeTimes->{
  3.878096067467098*^9, {3.878096905251871*^9, 3.8780969362442007`*^9}, {
   3.878097382044546*^9, 3.878097396682747*^9}, 3.878106693169626*^9, 
   3.878106740910451*^9, {3.8781107757401876`*^9, 3.878110801826302*^9}, 
   3.8781112215541353`*^9, 3.878616605783041*^9, 3.878857364142901*^9},
 CellLabel->
  "Out[459]=",ExpressionUUID->"3b57f7a9-c87c-446f-b8f7-5a160ff2c1f4"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"%", "//", "Length"}]], "Input",
 CellChangeTimes->{{3.878106750660317*^9, 3.8781067521687117`*^9}},
 CellLabel->
  "In[460]:=",ExpressionUUID->"8082d519-25b1-4d3a-a963-ae219534db5e"],

Cell[BoxData["33"], "Output",
 CellChangeTimes->{3.878106752572728*^9, 3.878616605789365*^9, 
  3.8788573641483917`*^9},
 CellLabel->
  "Out[460]=",ExpressionUUID->"08721ad8-82fa-418b-9f8c-6f56c0273424"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{
     RowBox[{"ansatzIdp", "/.", "sols"}], "/.", "solsvp1"}], "/.", 
    "solsvp2"}], "//", 
   RowBox[{
    RowBox[{"Cases", "[", 
     RowBox[{"#", ",", 
      RowBox[{"c", "[", "__", "]"}], ",", 
      RowBox[{"{", 
       RowBox[{"0", ",", "\[Infinity]"}], "}"}]}], "]"}], "&"}]}], "//", 
  "Union"}], "\[IndentingNewLine]", 
 RowBox[{"%", "//", "Length"}]}], "Input",
 CellChangeTimes->{{3.878097740252308*^9, 3.8780977941772013`*^9}, 
   3.878110841816125*^9, 3.8781112094287033`*^9},
 CellLabel->
  "In[461]:=",ExpressionUUID->"30557a72-199e-4bb7-9d19-d769f8477edf"],

Cell[BoxData[
 RowBox[{"{", "}"}]], "Output",
 CellChangeTimes->{
  3.87809706529457*^9, {3.878097742428525*^9, 3.878097794716721*^9}, 
   3.8781067030156937`*^9, {3.878110832558032*^9, 3.878110842386078*^9}, 
   3.878111209983122*^9, 3.878616605848959*^9, 3.8788573642099*^9},
 CellLabel->
  "Out[461]=",ExpressionUUID->"f73ba574-676c-4c62-8b01-ee7846304eb1"],

Cell[BoxData["0"], "Output",
 CellChangeTimes->{
  3.87809706529457*^9, {3.878097742428525*^9, 3.878097794716721*^9}, 
   3.8781067030156937`*^9, {3.878110832558032*^9, 3.878110842386078*^9}, 
   3.878111209983122*^9, 3.878616605848959*^9, 3.878857364211204*^9},
 CellLabel->
  "Out[462]=",ExpressionUUID->"5bcdfc3f-0f88-4b03-bb5e-5ca999151ca2"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{
     RowBox[{
      RowBox[{"numAnsatz", "/.", "sols"}], "/.", "solsvp1"}], "/.", 
     "solsvp2"}], "/.", 
    RowBox[{
     RowBox[{"c", "[", "__", "]"}], ":>", "0"}]}], "/.", "nicevs"}], "//.", 
  "nice"}]], "Input",
 CellChangeTimes->{{3.878096992646886*^9, 3.8780970253597383`*^9}, {
  3.878097865895237*^9, 3.878097895808736*^9}},
 CellLabel->
  "In[463]:=",ExpressionUUID->"4f3f7d32-e04d-4c99-9f63-a96e14c7272f"],

Cell[BoxData["0"], "Output",
 CellChangeTimes->{{3.878096994542691*^9, 3.878097026032852*^9}, {
   3.8780978736826763`*^9, 3.878097896716341*^9}, 3.878616605960135*^9, 
   3.878857364323636*^9},
 CellLabel->
  "Out[463]=",ExpressionUUID->"195ff495-2a6c-49ea-97b8-2f4435f6ff33"]
}, Open  ]]
}, Open  ]]
}, Closed]],

Cell[CellGroupData[{

Cell["Example S \[Infinity] Five point Ansatz", "Section",
 CellChangeTimes->{{3.8783576503446693`*^9, 
  3.878357668080792*^9}},ExpressionUUID->"8953edf9-c418-417c-99bf-\
30c222761e4f"],

Cell[CellGroupData[{

Cell["Four point result", "Subsection",
 CellChangeTimes->{{3.878632586384162*^9, 
  3.878632590622414*^9}},ExpressionUUID->"95f695dd-0e45-4594-91bd-\
51df8d434db1"],

Cell[BoxData[{
 RowBox[{"ClearAll", "[", "Gsc", "]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"Gsc", "[", 
   RowBox[{"2", ",", "1"}], "]"}], ":=", 
  RowBox[{
   RowBox[{"Cos", "[", 
    RowBox[{"dot", "[", 
     RowBox[{
      RowBox[{"p", "[", "1", "]"}], ",", 
      RowBox[{"as", "[", "0", "]"}]}], "]"}], "]"}], 
   RowBox[{"Cos", "[", 
    RowBox[{"dot", "[", 
     RowBox[{
      RowBox[{"p", "[", "2", "]"}], ",", 
      RowBox[{"as", "[", "0", "]"}]}], "]"}], 
    "]"}]}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"Gsc", "[", 
   RowBox[{"2", ",", "2"}], "]"}], ":=", 
  RowBox[{
   RowBox[{
    RowBox[{
     RowBox[{"Sinc", "[", 
      RowBox[{"dot", "[", 
       RowBox[{
        RowBox[{"p", "[", "1", "]"}], ",", 
        RowBox[{"as", "[", "0", "]"}]}], "]"}], "]"}], 
     RowBox[{"Sinc", "[", 
      RowBox[{"dot", "[", 
       RowBox[{
        RowBox[{"p", "[", "2", "]"}], ",", 
        RowBox[{"as", "[", "0", "]"}]}], "]"}], "]"}]}], "/.", 
    RowBox[{
     RowBox[{"Sinc", "[", "f_", "]"}], ":>", 
     FractionBox[
      RowBox[{"Sin", "[", "f", "]"}], "f"]}]}], "//", 
   "TrigExpand"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"Gsc", "[", 
   RowBox[{"2", ",", "3"}], "]"}], ":=", 
  RowBox[{
   RowBox[{
    FractionBox[
     RowBox[{"(", 
      RowBox[{
       RowBox[{"Sinc", "[", 
        RowBox[{"dot", "[", 
         RowBox[{
          RowBox[{
           RowBox[{"p", "[", "1", "]"}], "+", 
           RowBox[{"p", "[", "2", "]"}]}], ",", 
          RowBox[{"as", "[", "0", "]"}]}], "]"}], "]"}], "-", 
       RowBox[{
        RowBox[{"Sinc", "[", 
         RowBox[{"dot", "[", 
          RowBox[{
           RowBox[{"p", "[", "1", "]"}], ",", 
           RowBox[{"as", "[", "0", "]"}]}], "]"}], "]"}], 
        RowBox[{"Cos", "[", 
         RowBox[{"dot", "[", 
          RowBox[{
           RowBox[{"p", "[", "2", "]"}], ",", 
           RowBox[{"as", "[", "0", "]"}]}], "]"}], "]"}]}]}], ")"}], 
     RowBox[{"dot", "[", 
      RowBox[{
       RowBox[{"p", "[", "2", "]"}], ",", 
       RowBox[{"as", "[", "0", "]"}]}], "]"}]], "/.", 
    RowBox[{
     RowBox[{"Sinc", "[", "f_", "]"}], ":>", 
     FractionBox[
      RowBox[{"Sin", "[", "f", "]"}], "f"]}]}], "//", 
   "TrigExpand"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"Gsc", "[", 
   RowBox[{"2", ",", "4"}], "]"}], ":=", 
  RowBox[{
   RowBox[{
    RowBox[{"Sinc", "[", 
     RowBox[{"dot", "[", 
      RowBox[{
       RowBox[{
        RowBox[{"p", "[", "1", "]"}], "+", 
        RowBox[{"p", "[", "2", "]"}]}], ",", 
       RowBox[{"as", "[", "0", "]"}]}], "]"}], "]"}], "/.", 
    RowBox[{
     RowBox[{"Sinc", "[", "f_", "]"}], ":>", 
     FractionBox[
      RowBox[{"Sin", "[", "f", "]"}], "f"]}]}], "//", 
   "TrigExpand"}]}]}], "Input",
 CellChangeTimes->{{3.8786160394532213`*^9, 3.878616064748597*^9}, {
   3.878616868582659*^9, 3.878616871041716*^9}, {3.8786170681647177`*^9, 
   3.87861708475982*^9}, {3.878627078838502*^9, 3.878627122516471*^9}, {
   3.87862941118487*^9, 3.878629430282383*^9}, {3.87862949166127*^9, 
   3.8786296158056393`*^9}, {3.878629806885038*^9, 3.878629825377118*^9}, 
   3.878632366881328*^9, {3.878634905640032*^9, 3.878634907466502*^9}, {
   3.878635363260391*^9, 3.87863536484864*^9}, 3.878638625532201*^9},
 CellLabel->
  "In[464]:=",ExpressionUUID->"bb4c9fd8-566b-4013-8753-a09c40461008"],

Cell[BoxData[{
 RowBox[{"ClearAll", "[", "wtoVS", "]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"wtoVS", "=", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{
      RowBox[{"dot", "[", 
       RowBox[{
        RowBox[{"w", "[", "i__", "]"}], ",", "x_"}], "]"}], ":>", " ", 
      RowBox[{
       RowBox[{
        RowBox[{"Cos", "[", 
         RowBox[{"dot", "[", 
          RowBox[{
           RowBox[{"p", "[", "i", "]"}], ",", 
           RowBox[{"as", "[", "0", "]"}]}], "]"}], "]"}], 
        RowBox[{"dot", "[", 
         RowBox[{
          RowBox[{"v", "[", "1", "]"}], ",", "x"}], "]"}]}], "+", " ", 
       RowBox[{
        FractionBox[
         RowBox[{"Sin", "[", 
          RowBox[{"dot", "[", 
           RowBox[{
            RowBox[{"p", "[", "i", "]"}], ",", 
            RowBox[{"as", "[", "0", "]"}]}], "]"}], "]"}], 
         RowBox[{"dot", "[", 
          RowBox[{
           RowBox[{"p", "[", "i", "]"}], ",", 
           RowBox[{"as", "[", "0", "]"}]}], "]"}]], 
        RowBox[{"dot", "[", 
         RowBox[{
          RowBox[{"p", "[", "i", "]"}], ",", 
          RowBox[{"S", "[", "0", "]"}], ",", "x"}], "]"}]}]}]}], ",", 
     RowBox[{
      RowBox[{"dot", "[", 
       RowBox[{"x_", ",", 
        RowBox[{"w", "[", "i__", "]"}]}], "]"}], ":>", " ", 
      RowBox[{
       RowBox[{
        RowBox[{"Cos", "[", 
         RowBox[{"dot", "[", 
          RowBox[{
           RowBox[{"p", "[", "i", "]"}], ",", 
           RowBox[{"as", "[", "0", "]"}]}], "]"}], "]"}], 
        RowBox[{"dot", "[", 
         RowBox[{
          RowBox[{"v", "[", "1", "]"}], ",", "x"}], "]"}]}], "+", " ", 
       RowBox[{
        FractionBox[
         RowBox[{"Sin", "[", 
          RowBox[{"dot", "[", 
           RowBox[{
            RowBox[{"p", "[", "i", "]"}], ",", 
            RowBox[{"as", "[", "0", "]"}]}], "]"}], "]"}], 
         RowBox[{"dot", "[", 
          RowBox[{
           RowBox[{"p", "[", "i", "]"}], ",", 
           RowBox[{"as", "[", "0", "]"}]}], "]"}]], 
        RowBox[{"dot", "[", 
         RowBox[{
          RowBox[{"p", "[", "i", "]"}], ",", 
          RowBox[{"S", "[", "0", "]"}], ",", "x"}], "]"}]}]}]}]}], "}"}]}], 
  ";"}]}], "Input",
 CellChangeTimes->{{3.878635552437003*^9, 3.878635698214982*^9}, {
  3.878635735863924*^9, 3.878635763747239*^9}, {3.878635795642455*^9, 
  3.878635910165414*^9}, {3.8786825849573183`*^9, 3.878682588173032*^9}},
 CellLabel->
  "In[469]:=",ExpressionUUID->"08a4ceb8-c688-4263-9e60-36313dc9708b"],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"Gsc", "[", 
  RowBox[{"2", ",", "4"}], "]"}]], "Input",
 CellChangeTimes->{3.878635250426818*^9},
 CellLabel->
  "In[471]:=",ExpressionUUID->"8a3361e3-3559-4145-b0f6-14924fce58e4"],

Cell[BoxData[
 RowBox[{
  FractionBox[
   RowBox[{
    RowBox[{"Cos", "[", 
     RowBox[{"dot", "[", 
      RowBox[{
       RowBox[{"as", "[", "0", "]"}], ",", 
       RowBox[{"p", "[", "2", "]"}]}], "]"}], "]"}], " ", 
    RowBox[{"Sin", "[", 
     RowBox[{"dot", "[", 
      RowBox[{
       RowBox[{"as", "[", "0", "]"}], ",", 
       RowBox[{"p", "[", "1", "]"}]}], "]"}], "]"}]}], 
   RowBox[{
    RowBox[{"dot", "[", 
     RowBox[{
      RowBox[{"as", "[", "0", "]"}], ",", 
      RowBox[{"p", "[", "1", "]"}]}], "]"}], "+", 
    RowBox[{"dot", "[", 
     RowBox[{
      RowBox[{"as", "[", "0", "]"}], ",", 
      RowBox[{"p", "[", "2", "]"}]}], "]"}]}]], "+", 
  FractionBox[
   RowBox[{
    RowBox[{"Cos", "[", 
     RowBox[{"dot", "[", 
      RowBox[{
       RowBox[{"as", "[", "0", "]"}], ",", 
       RowBox[{"p", "[", "1", "]"}]}], "]"}], "]"}], " ", 
    RowBox[{"Sin", "[", 
     RowBox[{"dot", "[", 
      RowBox[{
       RowBox[{"as", "[", "0", "]"}], ",", 
       RowBox[{"p", "[", "2", "]"}]}], "]"}], "]"}]}], 
   RowBox[{
    RowBox[{"dot", "[", 
     RowBox[{
      RowBox[{"as", "[", "0", "]"}], ",", 
      RowBox[{"p", "[", "1", "]"}]}], "]"}], "+", 
    RowBox[{"dot", "[", 
     RowBox[{
      RowBox[{"as", "[", "0", "]"}], ",", 
      RowBox[{"p", "[", "2", "]"}]}], "]"}]}]]}]], "Output",
 CellChangeTimes->{{3.878635245596223*^9, 3.878635250696466*^9}, 
   3.878857364357531*^9},
 CellLabel->
  "Out[471]=",ExpressionUUID->"86084af9-b2f8-43a1-8cc3-51f015ebe7db"]
}, Open  ]],

Cell[BoxData[{
 RowBox[{
  RowBox[{"Num120", "=", 
   RowBox[{
    RowBox[{
     RowBox[{"(", 
      RowBox[{
       RowBox[{
        RowBox[{"-", 
         RowBox[{"dot", "[", 
          RowBox[{
           RowBox[{"v", "[", "1", "]"}], ",", 
           RowBox[{"F", "[", "1", "]"}], ",", 
           RowBox[{"F", "[", "2", "]"}], ",", 
           RowBox[{"as", "[", "0", "]"}]}], "]"}]}], " ", 
        RowBox[{"dot", "[", 
         RowBox[{
          RowBox[{"p", "[", "1", "]"}], ",", 
          RowBox[{"as", "[", "0", "]"}]}], "]"}]}], "+", 
       RowBox[{
        RowBox[{"dot", "[", 
         RowBox[{
          RowBox[{"v", "[", "1", "]"}], ",", 
          RowBox[{"F", "[", "2", "]"}], ",", 
          RowBox[{"as", "[", "0", "]"}]}], "]"}], 
        RowBox[{"dot", "[", 
         RowBox[{
          RowBox[{"p", "[", "2", "]"}], ",", 
          RowBox[{"F", "[", "1", "]"}], ",", 
          RowBox[{"as", "[", "0", "]"}]}], "]"}]}]}], ")"}], 
     RowBox[{"Gsc", "[", 
      RowBox[{"2", ",", "2"}], "]"}]}], "+", 
    RowBox[{
     RowBox[{"(", 
      RowBox[{
       RowBox[{"dot", "[", 
        RowBox[{
         RowBox[{"p", "[", "1", "]"}], ",", 
         RowBox[{"S", "[", "0", "]"}], ",", 
         RowBox[{"F", "[", "1", "]"}], ",", 
         RowBox[{"F", "[", "2", "]"}], ",", 
         RowBox[{"as", "[", "0", "]"}]}], "]"}], "+", 
       RowBox[{"dot", "[", 
        RowBox[{
         RowBox[{"p", "[", "2", "]"}], ",", 
         RowBox[{"S", "[", "0", "]"}], ",", 
         RowBox[{"F", "[", "2", "]"}], ",", 
         RowBox[{"F", "[", "1", "]"}], ",", 
         RowBox[{"as", "[", "0", "]"}]}], "]"}]}], ")"}], 
     RowBox[{"Gsc", "[", 
      RowBox[{"2", ",", "3"}], "]"}]}], "+", 
    RowBox[{
     RowBox[{"(", 
      RowBox[{
       RowBox[{"dot", "[", 
        RowBox[{
         RowBox[{"p", "[", "1", "]"}], ",", 
         RowBox[{"S", "[", "0", "]"}], ",", 
         RowBox[{"F", "[", "2", "]"}], ",", 
         RowBox[{"\[Epsilon]", "[", "1", "]"}]}], "]"}], "-", 
       RowBox[{"dot", "[", 
        RowBox[{
         RowBox[{"p", "[", "1", "]"}], ",", 
         RowBox[{"F", "[", "2", "]"}], ",", 
         RowBox[{"S", "[", "0", "]"}], ",", 
         RowBox[{"\[Epsilon]", "[", "1", "]"}]}], "]"}]}], ")"}], 
     RowBox[{"Gsc", "[", 
      RowBox[{"2", ",", "4"}], "]"}]}]}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"Num121", "=", 
   RowBox[{"-", 
    FractionBox[
     RowBox[{"dot", "[", 
      RowBox[{
       RowBox[{"w", "[", "1", "]"}], ",", 
       RowBox[{"F", "[", "1", "]"}], ",", 
       RowBox[{"F", "[", "2", "]"}], ",", 
       RowBox[{"w", "[", "2", "]"}]}], "]"}], 
     RowBox[{"dot", "[", 
      RowBox[{
       RowBox[{"v", "[", "1", "]"}], ",", 
       RowBox[{"p", "[", "1", "]"}]}], "]"}]]}]}], ";"}]}], "Input",
 CellChangeTimes->{{3.878615943517626*^9, 3.8786159986118813`*^9}, 
   3.878616036708578*^9, {3.878616885328373*^9, 3.8786169873108*^9}, {
   3.878617019057764*^9, 3.878617082559654*^9}, {3.878632185481542*^9, 
   3.87863233016709*^9}, {3.87863237515662*^9, 3.878632376714457*^9}, {
   3.878632459333858*^9, 3.878632459571869*^9}, {3.8786393729986677`*^9, 
   3.878639391023787*^9}},
 CellLabel->
  "In[472]:=",ExpressionUUID->"9020a378-0018-4e45-8411-5d93446f457d"],

Cell[BoxData[
 RowBox[{
  RowBox[{"Num12", "=", 
   RowBox[{"Num121", "+", "Num120"}]}], ";"}]], "Input",
 CellChangeTimes->{{3.8786325646297207`*^9, 3.878632572492497*^9}},
 CellLabel->
  "In[474]:=",ExpressionUUID->"44d909cf-5b63-49c4-838a-500cd8c79a42"],

Cell[BoxData[
 RowBox[{
  RowBox[{"tt", "=", 
   RowBox[{
    RowBox[{
     RowBox[{
      RowBox[{
       RowBox[{
        RowBox[{
         RowBox[{
          RowBox[{
           RowBox[{
            RowBox[{"(", 
             RowBox[{"Num12", "//", "expandFS"}], ")"}], "/.", "dotRules"}], "/.",
            "wtoVS"}], "/.", 
          RowBox[{
           RowBox[{"dot", "[", 
            RowBox[{
             RowBox[{"p", "[", "1", "]"}], ",", 
             RowBox[{"p", "[", "2", "]"}]}], "]"}], "->", "0"}]}], "/.", 
         RowBox[{
          RowBox[{"dot", "[", 
           RowBox[{
            RowBox[{"p", "[", "i_", "]"}], ",", 
            RowBox[{"w", "[", "i_", "]"}]}], "]"}], ":>", 
          RowBox[{"dot", "[", 
           RowBox[{
            RowBox[{"p", "[", "i", "]"}], ",", 
            RowBox[{"v", "[", "1", "]"}]}], "]"}]}]}], "/.", "dotRules"}], "/.", 
       RowBox[{
        RowBox[{"dot", "[", 
         RowBox[{
          RowBox[{"p", "[", "2", "]"}], ",", 
          RowBox[{"v", "[", "1", "]"}]}], "]"}], "->", 
        RowBox[{"-", 
         RowBox[{"dot", "[", 
          RowBox[{
           RowBox[{"p", "[", "1", "]"}], ",", 
           RowBox[{"v", "[", "1", "]"}]}], "]"}]}]}]}], "/.", "nicevs"}], "//.",
      "nice"}], "//", "Expand"}]}], ";"}]], "Input",
 CellChangeTimes->{{3.878634816427238*^9, 3.878634856764866*^9}, {
  3.878634974303233*^9, 3.878634993664701*^9}, {3.878635031521791*^9, 
  3.878635038885416*^9}, {3.878635400194212*^9, 3.878635414024555*^9}, {
  3.87863551858643*^9, 3.878635521633566*^9}, {3.878637817531315*^9, 
  3.878637834923502*^9}, {3.878637900102606*^9, 3.878637931470785*^9}},
 CellLabel->
  "In[475]:=",ExpressionUUID->"fae28f21-6b9c-4f19-a3cf-db878ab6c011"],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"listt", "=", 
  RowBox[{
   RowBox[{
    RowBox[{
     RowBox[{
      RowBox[{"(", 
       RowBox[{"List", "@@", "tt"}], ")"}], "/.", 
      RowBox[{"{", 
       RowBox[{
        RowBox[{
         RowBox[{"Cos", "[", "f_", "]"}], ":>", "1"}], ",", 
        RowBox[{
         RowBox[{"Sin", "[", "f_", "]"}], ":>", "1"}]}], "}"}]}], "/.", 
     RowBox[{
      RowBox[{"a", "\[CenterDot]", 
       SubscriptBox["p", "i_"]}], ":>", "1"}]}], "/.", 
    RowBox[{
     RowBox[{"a_", " ", "b_"}], ":>", 
     RowBox[{"b", "/;", 
      RowBox[{"NumberQ", "[", "a", "]"}]}]}]}], "//", "Union"}]}]], "Input",
 CellChangeTimes->{{3.87863865193777*^9, 3.878638752895714*^9}, {
  3.878639555066867*^9, 3.878639564188423*^9}},
 CellLabel->
  "In[476]:=",ExpressionUUID->"c05ad06e-f0c5-4a7b-8634-6416eeabdc53"],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
   RowBox[{
    RowBox[{"v", "\[CenterDot]", 
     SubscriptBox["\[Epsilon]", "2"]}], " ", 
    RowBox[{
     SubscriptBox["\[Epsilon]", "1"], "\[CenterDot]", 
     SubscriptBox["p", "2"]}]}], ",", 
   RowBox[{
    RowBox[{"v", "\[CenterDot]", 
     SubscriptBox["p", "1"]}], " ", 
    RowBox[{
     SubscriptBox["\[Epsilon]", "1"], "\[CenterDot]", 
     SubscriptBox["\[Epsilon]", "2"]}]}], ",", 
   RowBox[{
    RowBox[{"v", "\[CenterDot]", 
     SubscriptBox["\[Epsilon]", "1"]}], " ", 
    RowBox[{
     SubscriptBox["\[Epsilon]", "2"], "\[CenterDot]", 
     SubscriptBox["p", "1"]}]}], ",", 
   RowBox[{
    RowBox[{
     SubscriptBox["\[Epsilon]", "1"], "\[CenterDot]", 
     SubscriptBox["\[Epsilon]", "2"]}], " ", 
    RowBox[{
     SubscriptBox["p", "1"], "\[CenterDot]", "S", "\[CenterDot]", 
     SubscriptBox["p", "2"]}]}], ",", 
   RowBox[{
    RowBox[{
     SubscriptBox["\[Epsilon]", "2"], "\[CenterDot]", 
     SubscriptBox["p", "1"]}], " ", 
    RowBox[{
     SubscriptBox["p", "1"], "\[CenterDot]", "S", "\[CenterDot]", 
     SubscriptBox["\[Epsilon]", "1"]}]}], ",", 
   RowBox[{
    RowBox[{
     SubscriptBox["\[Epsilon]", "1"], "\[CenterDot]", 
     SubscriptBox["p", "2"]}], " ", 
    RowBox[{
     SubscriptBox["p", "1"], "\[CenterDot]", "S", "\[CenterDot]", 
     SubscriptBox["\[Epsilon]", "2"]}]}], ",", 
   RowBox[{
    RowBox[{
     SubscriptBox["\[Epsilon]", "2"], "\[CenterDot]", 
     SubscriptBox["p", "1"]}], " ", 
    RowBox[{
     SubscriptBox["p", "2"], "\[CenterDot]", "S", "\[CenterDot]", 
     SubscriptBox["\[Epsilon]", "1"]}]}], ",", 
   RowBox[{
    RowBox[{
     SubscriptBox["\[Epsilon]", "1"], "\[CenterDot]", 
     SubscriptBox["p", "2"]}], " ", 
    RowBox[{
     SubscriptBox["p", "2"], "\[CenterDot]", "S", "\[CenterDot]", 
     SubscriptBox["\[Epsilon]", "2"]}]}]}], "}"}]], "Output",
 CellChangeTimes->{
  3.878638607452299*^9, {3.878638641595624*^9, 3.878638680986331*^9}, {
   3.878638736305593*^9, 3.8786387534287977`*^9}, 3.878639403667201*^9, 
   3.878639565365337*^9, 3.878857364453046*^9},
 CellLabel->
  "Out[476]=",ExpressionUUID->"391569d7-5d10-4082-94cc-1bb39656424e"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  RowBox[{"Coefficient", "[", 
   RowBox[{"tt", ",", 
    RowBox[{
     RowBox[{
      SubscriptBox["\[Epsilon]", "1"], "\[CenterDot]", 
      SubscriptBox["p", "2"]}], " ", 
     RowBox[{
      SubscriptBox["p", "2"], "\[CenterDot]", "S", "\[CenterDot]", 
      SubscriptBox["\[Epsilon]", "2"]}]}]}], "]"}], "//", 
  "Simplify"}]], "Input",
 CellChangeTimes->{{3.878638927729785*^9, 3.878638974958247*^9}, 
   3.878639357505899*^9, {3.878639426935583*^9, 3.878639465592619*^9}},
 CellLabel->
  "In[477]:=",ExpressionUUID->"26b2a5d6-df84-459b-8d97-dfde653a4afd"],

Cell[BoxData[
 RowBox[{"-", 
  FractionBox[
   RowBox[{"Sin", "[", 
    RowBox[{
     RowBox[{"a", "\[CenterDot]", 
      SubscriptBox["p", "1"]}], "+", 
     RowBox[{"a", "\[CenterDot]", 
      SubscriptBox["p", "2"]}]}], "]"}], 
   RowBox[{
    RowBox[{"a", "\[CenterDot]", 
     SubscriptBox["p", "1"]}], "+", 
    RowBox[{"a", "\[CenterDot]", 
     SubscriptBox["p", "2"]}]}]]}]], "Output",
 CellChangeTimes->{{3.878638928044045*^9, 3.878638975410594*^9}, 
   3.878639358066647*^9, {3.8786394060073557`*^9, 3.87863946603717*^9}, 
   3.8788573644681063`*^9},
 CellLabel->
  "Out[477]=",ExpressionUUID->"03ecb8b4-4100-49de-a18d-c195e81cf782"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"Table", "[", 
  RowBox[{
   RowBox[{
    RowBox[{
     RowBox[{"listt", "[", 
      RowBox[{"[", "ii", "]"}], "]"}], 
     RowBox[{"Coefficient", "[", 
      RowBox[{"tt", ",", 
       RowBox[{"listt", "[", 
        RowBox[{"[", "ii", "]"}], "]"}]}], "]"}]}], "//", "Simplify"}], ",", 
   RowBox[{"{", 
    RowBox[{"ii", ",", 
     RowBox[{"Length", "@", "listt"}]}], "}"}]}], "]"}]], "Input",
 CellChangeTimes->{{3.878638814766988*^9, 3.8786388489437447`*^9}, {
  3.87863962793174*^9, 3.878639629319063*^9}},
 CellLabel->
  "In[478]:=",ExpressionUUID->"3709ec47-1631-47ab-aa5d-d4c076e22c51"],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
   RowBox[{
    RowBox[{"-", 
     RowBox[{"(", 
      RowBox[{"v", "\[CenterDot]", 
       SubscriptBox["\[Epsilon]", "2"]}], ")"}]}], " ", 
    RowBox[{
     SubscriptBox["\[Epsilon]", "1"], "\[CenterDot]", 
     SubscriptBox["p", "2"]}], " ", 
    RowBox[{"Cos", "[", 
     RowBox[{
      RowBox[{"a", "\[CenterDot]", 
       SubscriptBox["p", "1"]}], "+", 
      RowBox[{"a", "\[CenterDot]", 
       SubscriptBox["p", "2"]}]}], "]"}]}], ",", 
   RowBox[{
    RowBox[{"-", 
     RowBox[{"(", 
      RowBox[{"v", "\[CenterDot]", 
       SubscriptBox["p", "1"]}], ")"}]}], " ", 
    RowBox[{
     SubscriptBox["\[Epsilon]", "1"], "\[CenterDot]", 
     SubscriptBox["\[Epsilon]", "2"]}], " ", 
    RowBox[{"Cos", "[", 
     RowBox[{
      RowBox[{"a", "\[CenterDot]", 
       SubscriptBox["p", "1"]}], "+", 
      RowBox[{"a", "\[CenterDot]", 
       SubscriptBox["p", "2"]}]}], "]"}]}], ",", 
   RowBox[{
    RowBox[{"v", "\[CenterDot]", 
     SubscriptBox["\[Epsilon]", "1"]}], " ", 
    RowBox[{
     SubscriptBox["\[Epsilon]", "2"], "\[CenterDot]", 
     SubscriptBox["p", "1"]}], " ", 
    RowBox[{"Cos", "[", 
     RowBox[{
      RowBox[{"a", "\[CenterDot]", 
       SubscriptBox["p", "1"]}], "+", 
      RowBox[{"a", "\[CenterDot]", 
       SubscriptBox["p", "2"]}]}], "]"}]}], ",", 
   FractionBox[
    RowBox[{
     RowBox[{
      SubscriptBox["\[Epsilon]", "1"], "\[CenterDot]", 
      SubscriptBox["\[Epsilon]", "2"]}], " ", 
     RowBox[{
      SubscriptBox["p", "1"], "\[CenterDot]", "S", "\[CenterDot]", 
      SubscriptBox["p", "2"]}], " ", 
     RowBox[{"Sin", "[", 
      RowBox[{
       RowBox[{"a", "\[CenterDot]", 
        SubscriptBox["p", "1"]}], "+", 
       RowBox[{"a", "\[CenterDot]", 
        SubscriptBox["p", "2"]}]}], "]"}]}], 
    RowBox[{
     RowBox[{"a", "\[CenterDot]", 
      SubscriptBox["p", "1"]}], "+", 
     RowBox[{"a", "\[CenterDot]", 
      SubscriptBox["p", "2"]}]}]], ",", 
   FractionBox[
    RowBox[{
     RowBox[{
      SubscriptBox["\[Epsilon]", "2"], "\[CenterDot]", 
      SubscriptBox["p", "1"]}], " ", 
     RowBox[{
      SubscriptBox["p", "1"], "\[CenterDot]", "S", "\[CenterDot]", 
      SubscriptBox["\[Epsilon]", "1"]}], " ", 
     RowBox[{"Sin", "[", 
      RowBox[{
       RowBox[{"a", "\[CenterDot]", 
        SubscriptBox["p", "1"]}], "+", 
       RowBox[{"a", "\[CenterDot]", 
        SubscriptBox["p", "2"]}]}], "]"}]}], 
    RowBox[{
     RowBox[{"a", "\[CenterDot]", 
      SubscriptBox["p", "1"]}], "+", 
     RowBox[{"a", "\[CenterDot]", 
      SubscriptBox["p", "2"]}]}]], ",", 
   RowBox[{"-", 
    FractionBox[
     RowBox[{
      RowBox[{
       SubscriptBox["\[Epsilon]", "1"], "\[CenterDot]", 
       SubscriptBox["p", "2"]}], " ", 
      RowBox[{
       SubscriptBox["p", "1"], "\[CenterDot]", "S", "\[CenterDot]", 
       SubscriptBox["\[Epsilon]", "2"]}], " ", 
      RowBox[{"Sin", "[", 
       RowBox[{
        RowBox[{"a", "\[CenterDot]", 
         SubscriptBox["p", "1"]}], "+", 
        RowBox[{"a", "\[CenterDot]", 
         SubscriptBox["p", "2"]}]}], "]"}]}], 
     RowBox[{
      RowBox[{"a", "\[CenterDot]", 
       SubscriptBox["p", "1"]}], "+", 
      RowBox[{"a", "\[CenterDot]", 
       SubscriptBox["p", "2"]}]}]]}], ",", 
   FractionBox[
    RowBox[{
     RowBox[{
      SubscriptBox["\[Epsilon]", "2"], "\[CenterDot]", 
      SubscriptBox["p", "1"]}], " ", 
     RowBox[{
      SubscriptBox["p", "2"], "\[CenterDot]", "S", "\[CenterDot]", 
      SubscriptBox["\[Epsilon]", "1"]}], " ", 
     RowBox[{"Sin", "[", 
      RowBox[{
       RowBox[{"a", "\[CenterDot]", 
        SubscriptBox["p", "1"]}], "+", 
       RowBox[{"a", "\[CenterDot]", 
        SubscriptBox["p", "2"]}]}], "]"}]}], 
    RowBox[{
     RowBox[{"a", "\[CenterDot]", 
      SubscriptBox["p", "1"]}], "+", 
     RowBox[{"a", "\[CenterDot]", 
      SubscriptBox["p", "2"]}]}]], ",", 
   RowBox[{"-", 
    FractionBox[
     RowBox[{
      RowBox[{
       SubscriptBox["\[Epsilon]", "1"], "\[CenterDot]", 
       SubscriptBox["p", "2"]}], " ", 
      RowBox[{
       SubscriptBox["p", "2"], "\[CenterDot]", "S", "\[CenterDot]", 
       SubscriptBox["\[Epsilon]", "2"]}], " ", 
      RowBox[{"Sin", "[", 
       RowBox[{
        RowBox[{"a", "\[CenterDot]", 
         SubscriptBox["p", "1"]}], "+", 
        RowBox[{"a", "\[CenterDot]", 
         SubscriptBox["p", "2"]}]}], "]"}]}], 
     RowBox[{
      RowBox[{"a", "\[CenterDot]", 
       SubscriptBox["p", "1"]}], "+", 
      RowBox[{"a", "\[CenterDot]", 
       SubscriptBox["p", "2"]}]}]]}]}], "}"}]], "Output",
 CellChangeTimes->{{3.878638842487191*^9, 3.87863884948939*^9}, 
   3.87863957706507*^9, 3.8786396299981537`*^9, 3.878857364505966*^9},
 CellLabel->
  "Out[478]=",ExpressionUUID->"3da75a04-c7df-4110-ae8a-e21e2092badc"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  RowBox[{"Num12", "//.", "nicevs"}], "//.", "nice"}]], "Input",
 CellChangeTimes->{{3.878640036421591*^9, 3.878640050701952*^9}, {
  3.878640898946548*^9, 3.878640909304125*^9}},
 CellLabel->
  "In[479]:=",ExpressionUUID->"807f192f-8260-4783-8915-15a8d5bde9e5"],

Cell[BoxData[
 RowBox[{
  RowBox[{"-", 
   FractionBox[
    RowBox[{
     SubscriptBox["w", "1"], "\[CenterDot]", 
     SubscriptBox["F", "1"], "\[CenterDot]", 
     SubscriptBox["F", "2"], "\[CenterDot]", 
     SubscriptBox["w", "2"]}], 
    RowBox[{"v", "\[CenterDot]", 
     SubscriptBox["p", "1"]}]]}], "+", 
  FractionBox[
   RowBox[{
    RowBox[{"(", 
     RowBox[{
      RowBox[{
       RowBox[{"v", "\[CenterDot]", 
        SubscriptBox["F", "2"], "\[CenterDot]", "a"}], " ", 
       RowBox[{
        SubscriptBox["p", "2"], "\[CenterDot]", 
        SubscriptBox["F", "1"], "\[CenterDot]", "a"}]}], "-", 
      RowBox[{
       RowBox[{"a", "\[CenterDot]", 
        SubscriptBox["p", "1"]}], " ", 
       RowBox[{"v", "\[CenterDot]", 
        SubscriptBox["F", "1"], "\[CenterDot]", 
        SubscriptBox["F", "2"], "\[CenterDot]", "a"}]}]}], ")"}], " ", 
    RowBox[{"Sin", "[", 
     RowBox[{"a", "\[CenterDot]", 
      SubscriptBox["p", "1"]}], "]"}], " ", 
    RowBox[{"Sin", "[", 
     RowBox[{"a", "\[CenterDot]", 
      SubscriptBox["p", "2"]}], "]"}]}], 
   RowBox[{
    RowBox[{"a", "\[CenterDot]", 
     SubscriptBox["p", "1"]}], " ", 
    RowBox[{"a", "\[CenterDot]", 
     SubscriptBox["p", "2"]}]}]], "+", 
  RowBox[{
   RowBox[{"(", 
    RowBox[{
     RowBox[{
      SubscriptBox["p", "1"], "\[CenterDot]", "S", "\[CenterDot]", 
      SubscriptBox["F", "2"], "\[CenterDot]", 
      SubscriptBox["\[Epsilon]", "1"]}], "-", 
     RowBox[{
      SubscriptBox["p", "1"], "\[CenterDot]", 
      SubscriptBox["F", "2"], "\[CenterDot]", "S", "\[CenterDot]", 
      SubscriptBox["\[Epsilon]", "1"]}]}], ")"}], " ", 
   RowBox[{"(", 
    RowBox[{
     FractionBox[
      RowBox[{
       RowBox[{"Cos", "[", 
        RowBox[{"a", "\[CenterDot]", 
         SubscriptBox["p", "2"]}], "]"}], " ", 
       RowBox[{"Sin", "[", 
        RowBox[{"a", "\[CenterDot]", 
         SubscriptBox["p", "1"]}], "]"}]}], 
      RowBox[{
       RowBox[{"a", "\[CenterDot]", 
        SubscriptBox["p", "1"]}], "+", 
       RowBox[{"a", "\[CenterDot]", 
        SubscriptBox["p", "2"]}]}]], "+", 
     FractionBox[
      RowBox[{
       RowBox[{"Cos", "[", 
        RowBox[{"a", "\[CenterDot]", 
         SubscriptBox["p", "1"]}], "]"}], " ", 
       RowBox[{"Sin", "[", 
        RowBox[{"a", "\[CenterDot]", 
         SubscriptBox["p", "2"]}], "]"}]}], 
      RowBox[{
       RowBox[{"a", "\[CenterDot]", 
        SubscriptBox["p", "1"]}], "+", 
       RowBox[{"a", "\[CenterDot]", 
        SubscriptBox["p", "2"]}]}]]}], ")"}]}], "+", 
  RowBox[{
   RowBox[{"(", 
    RowBox[{
     RowBox[{
      SubscriptBox["p", "1"], "\[CenterDot]", "S", "\[CenterDot]", 
      SubscriptBox["F", "1"], "\[CenterDot]", 
      SubscriptBox["F", "2"], "\[CenterDot]", "a"}], "+", 
     RowBox[{
      SubscriptBox["p", "2"], "\[CenterDot]", "S", "\[CenterDot]", 
      SubscriptBox["F", "2"], "\[CenterDot]", 
      SubscriptBox["F", "1"], "\[CenterDot]", "a"}]}], ")"}], " ", 
   RowBox[{"(", 
    RowBox[{
     RowBox[{"-", 
      FractionBox[
       RowBox[{
        RowBox[{"Cos", "[", 
         RowBox[{"a", "\[CenterDot]", 
          SubscriptBox["p", "2"]}], "]"}], " ", 
        RowBox[{"Sin", "[", 
         RowBox[{"a", "\[CenterDot]", 
          SubscriptBox["p", "1"]}], "]"}]}], 
       RowBox[{
        RowBox[{"a", "\[CenterDot]", 
         SubscriptBox["p", "1"]}], " ", 
        RowBox[{"(", 
         RowBox[{
          RowBox[{"a", "\[CenterDot]", 
           SubscriptBox["p", "1"]}], "+", 
          RowBox[{"a", "\[CenterDot]", 
           SubscriptBox["p", "2"]}]}], ")"}]}]]}], "+", 
     FractionBox[
      RowBox[{
       RowBox[{"Cos", "[", 
        RowBox[{"a", "\[CenterDot]", 
         SubscriptBox["p", "1"]}], "]"}], " ", 
       RowBox[{"Sin", "[", 
        RowBox[{"a", "\[CenterDot]", 
         SubscriptBox["p", "2"]}], "]"}]}], 
      RowBox[{
       RowBox[{"a", "\[CenterDot]", 
        SubscriptBox["p", "2"]}], " ", 
       RowBox[{"(", 
        RowBox[{
         RowBox[{"a", "\[CenterDot]", 
          SubscriptBox["p", "1"]}], "+", 
         RowBox[{"a", "\[CenterDot]", 
          SubscriptBox["p", "2"]}]}], ")"}]}]]}], ")"}]}]}]], "Output",
 CellChangeTimes->{{3.8786409010867977`*^9, 3.8786409097124577`*^9}, 
   3.87885736451402*^9},
 CellLabel->
  "Out[479]=",ExpressionUUID->"21a69440-6886-464c-b817-3209d30ccc8b"]
}, Open  ]],

Cell[BoxData[{
 RowBox[{
  RowBox[{"num", "=", 
   RowBox[{"\[FivePointedStar]", "[", 
    RowBox[{
     RowBox[{"T", "[", 
      RowBox[{"{", "1", "}"}], "]"}], ",", 
     RowBox[{"T", "[", 
      RowBox[{"{", "2", "}"}], "]"}]}], "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"nod", "=", 
   RowBox[{
    RowBox[{
     RowBox[{"(", 
      RowBox[{
       RowBox[{
        RowBox[{"num", "/.", 
         RowBox[{"T", "->", "T2F"}]}], "/.", "rmzero"}], "/.", 
       RowBox[{"v", "->", " ", 
        RowBox[{"v", "[", "1", "]"}]}]}], ")"}], "/.", 
     RowBox[{
      RowBox[{"F", "[", "i_", "]"}], ":>", " ", 
      RowBox[{"F", "[", 
       RowBox[{"p", "[", "i", "]"}], "]"}]}]}], "/.", 
    RowBox[{
     RowBox[{"p", "[", 
      RowBox[{"f1_", ",", "g__"}], "]"}], ":>", 
     RowBox[{"P", "[", " ", 
      RowBox[{"Total", "[", 
       RowBox[{"p", "/@", 
        RowBox[{"{", 
         RowBox[{"f1", ",", "g"}], "}"}]}], "]"}], "]"}]}]}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"bpeff2", "=", 
   RowBox[{"BinaryProduct", "[", 
    RowBox[{"Range", "[", "2", "]"}], "]"}]}], ";"}], "\n", 
 RowBox[{
  RowBox[{"numList", "=", 
   RowBox[{
    RowBox[{
     RowBox[{"ExpandNCM", "/@", 
      RowBox[{"(", 
       RowBox[{"bpeff2", "/.", 
        RowBox[{"X", "\[Rule]", " ", "NC"}]}], ")"}]}], "/.", 
     RowBox[{"NonCommutativeMultiply", "\[Rule]", " ", "T"}]}], "/.", 
    RowBox[{
     RowBox[{"T", "[", 
      RowBox[{"i1_", ",", "f___"}], "]"}], ":>", " ", 
     RowBox[{"0", "/;", 
      RowBox[{"i1", "\[NotEqual]", "1"}]}]}]}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"numListL", "=", 
   RowBox[{"numList", "/.", 
    RowBox[{
     RowBox[{"T", "[", "f___", "]"}], "\[RuleDelayed]", " ", 
     RowBox[{"(", 
      RowBox[{"nod", "/.", 
       RowBox[{"replace", "[", 
        RowBox[{
         RowBox[{"p", "/@", 
          RowBox[{"{", "f", "}"}]}], ",", "3"}], "]"}]}], ")"}]}]}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"numListL", "=", 
   RowBox[{
    RowBox[{"(", 
     RowBox[{"numListL", "/.", 
      RowBox[{
       RowBox[{"F", "[", 
        RowBox[{"p", "[", "i_", "]"}], "]"}], ":>", " ", 
       RowBox[{"F", "[", "i", "]"}]}]}], ")"}], "//", "Expand"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"ppListD", "=", 
   RowBox[{"(", 
    RowBox[{"X2Prop", "/@", "bpeff2"}], ")"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"ppListD", "=", 
   RowBox[{
    RowBox[{"ppListD", "/.", 
     RowBox[{
      RowBox[{"p", "[", "f__", "]"}], "\[RuleDelayed]", 
      RowBox[{"Total", "[", 
       RowBox[{"p", "/@", 
        RowBox[{"{", "f", "}"}]}], "]"}]}]}], "/.", 
    RowBox[{
     RowBox[{"dot", "[", 
      RowBox[{
       RowBox[{"p", "[", "i_", "]"}], ",", 
       RowBox[{"p", "[", "i_", "]"}]}], "]"}], ":>", " ", "0"}]}]}], 
  ";"}], "\n", 
 RowBox[{
  RowBox[{"denAll", "=", 
   RowBox[{"Table", "[", 
    RowBox[{
     RowBox[{"ppListD", "[", 
      RowBox[{"[", "ii", "]"}], "]"}], ",", 
     RowBox[{"{", 
      RowBox[{"ii", ",", 
       RowBox[{"Length", "@", "ppListD"}]}], "}"}]}], "]"}]}], ";"}], "\n", 
 RowBox[{
  RowBox[{"ampYM", "=", 
   RowBox[{
    RowBox[{
     RowBox[{"Sum", "[", 
      RowBox[{
       FractionBox[
        RowBox[{"numListL", "[", 
         RowBox[{"[", "ii", "]"}], "]"}], 
        RowBox[{"denAll", "[", 
         RowBox[{"[", "ii", "]"}], "]"}]], ",", 
       RowBox[{"{", 
        RowBox[{"ii", ",", 
         RowBox[{"Length", "@", "ppListD"}]}], "}"}]}], "]"}], "/.", 
     RowBox[{
      RowBox[{"P", "[", "f_", "]"}], ":>", "f"}]}], "//", "Expand"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"ampYM", "=", 
   RowBox[{
    RowBox[{"(", 
     RowBox[{
      RowBox[{
       RowBox[{
        RowBox[{
         RowBox[{"(", 
          RowBox[{"ampYM", "//", "expandFS"}], ")"}], "/.", "dotRules"}], "/.", 
        RowBox[{
         RowBox[{"dot", "[", 
          RowBox[{
           RowBox[{"p", "[", "2", "]"}], ",", 
           RowBox[{"v", "[", "1", "]"}]}], "]"}], "\[RuleDelayed]", 
         RowBox[{"-", 
          RowBox[{"dot", "[", 
           RowBox[{
            RowBox[{"v", "[", "1", "]"}], ",", 
            RowBox[{"p", "[", "1", "]"}]}], "]"}]}]}]}], "/.", 
       RowBox[{
        RowBox[{"dot", "[", 
         RowBox[{
          RowBox[{"p", "[", "1", "]"}], ",", 
          RowBox[{"p", "[", "2", "]"}]}], "]"}], "->", "0"}]}], "//", 
      "Expand"}], ")"}], "//", "MultivariateApart"}]}], ";"}]}], "Input",
 CellChangeTimes->{{3.878023857740679*^9, 3.878023860158512*^9}, {
   3.87802396296658*^9, 3.878024017862441*^9}, {3.878024052254986*^9, 
   3.878024058839876*^9}, {3.8780241059261007`*^9, 3.8780241103419027`*^9}, {
   3.878024288644836*^9, 3.8780243205537767`*^9}, 3.878076927512285*^9, {
   3.8786830692486563`*^9, 3.8786830910726547`*^9}, {3.878683187180931*^9, 
   3.878683187946763*^9}, {3.878683222566435*^9, 3.878683252271603*^9}},
 CellLabel->
  "In[480]:=",ExpressionUUID->"3c1245cb-57dc-4faf-a8bc-dd75913d99e2"],

Cell[CellGroupData[{

Cell[BoxData["ampYM"], "Input",
 CellLabel->
  "In[491]:=",ExpressionUUID->"a2fa1977-72b5-4083-9043-dfe2f1808d82"],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"dot", "[", 
    RowBox[{
     RowBox[{"p", "[", "1", "]"}], ",", 
     RowBox[{"\[Epsilon]", "[", "2", "]"}]}], "]"}], " ", 
   RowBox[{"dot", "[", 
    RowBox[{
     RowBox[{"v", "[", "1", "]"}], ",", 
     RowBox[{"\[Epsilon]", "[", "1", "]"}]}], "]"}]}], "-", 
  RowBox[{
   RowBox[{"dot", "[", 
    RowBox[{
     RowBox[{"p", "[", "2", "]"}], ",", 
     RowBox[{"\[Epsilon]", "[", "1", "]"}]}], "]"}], " ", 
   RowBox[{"dot", "[", 
    RowBox[{
     RowBox[{"v", "[", "1", "]"}], ",", 
     RowBox[{"\[Epsilon]", "[", "2", "]"}]}], "]"}]}], "-", 
  RowBox[{
   RowBox[{"dot", "[", 
    RowBox[{
     RowBox[{"p", "[", "1", "]"}], ",", 
     RowBox[{"v", "[", "1", "]"}]}], "]"}], " ", 
   RowBox[{"dot", "[", 
    RowBox[{
     RowBox[{"\[Epsilon]", "[", "1", "]"}], ",", 
     RowBox[{"\[Epsilon]", "[", "2", "]"}]}], "]"}]}]}]], "Output",
 CellChangeTimes->{
  3.878683131730872*^9, 3.8786831945875683`*^9, {3.878683231866651*^9, 
   3.8786832548884563`*^9}, 3.878857364540949*^9},
 CellLabel->
  "Out[491]=",ExpressionUUID->"71fc2698-211e-4e30-85b7-043300b54598"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{
  RowBox[{"ampYMGlueNum3All", "=", 
   RowBox[{
    RowBox[{
     RowBox[{
      RowBox[{
       RowBox[{"ampYM", "/.", 
        RowBox[{"{", 
         RowBox[{
          RowBox[{"v", "[", "1", "]"}], ":>", 
          RowBox[{"w", "[", 
           RowBox[{"1", ",", "2"}], "]"}]}], "}"}]}], "/.", "dotRules"}], "/.", 
      RowBox[{
       RowBox[{"dot", "[", 
        RowBox[{
         RowBox[{"p", "[", "2", "]"}], ",", 
         RowBox[{"v", "[", "1", "]"}]}], "]"}], "\[RuleDelayed]", 
       RowBox[{"-", 
        RowBox[{"dot", "[", 
         RowBox[{
          RowBox[{"v", "[", "1", "]"}], ",", 
          RowBox[{"p", "[", "1", "]"}]}], "]"}]}]}]}], "/.", 
     RowBox[{
      RowBox[{"dot", "[", 
       RowBox[{
        RowBox[{"p", "[", "1", "]"}], ",", 
        RowBox[{"p", "[", "2", "]"}]}], "]"}], "->", "0"}]}], "//", 
    "Expand"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{"ampYMGlueNum3All", "=", 
  RowBox[{
   RowBox[{
    RowBox[{
     RowBox[{"(", 
      RowBox[{
       RowBox[{
        RowBox[{"ampYMGlueNum3All", "/.", "wtoVS"}], "/.", 
        RowBox[{
         RowBox[{"p", "[", 
          RowBox[{"1", ",", "2"}], "]"}], "->", 
         RowBox[{
          RowBox[{"p", "[", "1", "]"}], "+", 
          RowBox[{"p", "[", "2", "]"}]}]}]}], "//", "TrigExpand"}], ")"}], "/.",
      "dotRules"}], "//.", "nicevs"}], "//.", "nice"}]}]}], "Input",
 CellChangeTimes->{{3.878024069941125*^9, 3.87802415205725*^9}, {
   3.878024331157475*^9, 3.878024340048336*^9}, {3.8780243883823147`*^9, 
   3.87802443440853*^9}, {3.878024623562881*^9, 3.878024662661223*^9}, {
   3.878024820522764*^9, 3.878024839044957*^9}, {3.878025373216962*^9, 
   3.878025408461379*^9}, {3.878025474618256*^9, 3.878025484493874*^9}, 
   3.878025529761257*^9, {3.8780757748389797`*^9, 3.878075783185919*^9}, 
   3.878075831065405*^9, {3.878683117400875*^9, 3.8786831244387712`*^9}, {
   3.8786832891590776`*^9, 3.878683405792304*^9}, {3.878683584171186*^9, 
   3.8786835846328506`*^9}},
 CellLabel->
  "In[492]:=",ExpressionUUID->"988624c8-7140-4ad4-893f-548283ac3dd8"],

Cell[BoxData[
 RowBox[{
  RowBox[{"-", 
   FractionBox[
    RowBox[{
     RowBox[{"a", "\[CenterDot]", 
      SubscriptBox["p", "1"]}], " ", 
     RowBox[{"v", "\[CenterDot]", 
      SubscriptBox["\[Epsilon]", "2"]}], " ", 
     RowBox[{
      SubscriptBox["\[Epsilon]", "1"], "\[CenterDot]", 
      SubscriptBox["p", "2"]}], " ", 
     RowBox[{"Cos", "[", 
      RowBox[{"a", "\[CenterDot]", 
       SubscriptBox["p", "1"]}], "]"}], " ", 
     RowBox[{"Cos", "[", 
      RowBox[{"a", "\[CenterDot]", 
       SubscriptBox["p", "2"]}], "]"}]}], 
    RowBox[{
     RowBox[{"a", "\[CenterDot]", 
      SubscriptBox["p", "1"]}], "+", 
     RowBox[{"a", "\[CenterDot]", 
      SubscriptBox["p", "2"]}]}]]}], "-", 
  FractionBox[
   RowBox[{
    RowBox[{"a", "\[CenterDot]", 
     SubscriptBox["p", "2"]}], " ", 
    RowBox[{"v", "\[CenterDot]", 
     SubscriptBox["\[Epsilon]", "2"]}], " ", 
    RowBox[{
     SubscriptBox["\[Epsilon]", "1"], "\[CenterDot]", 
     SubscriptBox["p", "2"]}], " ", 
    RowBox[{"Cos", "[", 
     RowBox[{"a", "\[CenterDot]", 
      SubscriptBox["p", "1"]}], "]"}], " ", 
    RowBox[{"Cos", "[", 
     RowBox[{"a", "\[CenterDot]", 
      SubscriptBox["p", "2"]}], "]"}]}], 
   RowBox[{
    RowBox[{"a", "\[CenterDot]", 
     SubscriptBox["p", "1"]}], "+", 
    RowBox[{"a", "\[CenterDot]", 
     SubscriptBox["p", "2"]}]}]], "-", 
  FractionBox[
   RowBox[{
    RowBox[{"a", "\[CenterDot]", 
     SubscriptBox["p", "1"]}], " ", 
    RowBox[{"v", "\[CenterDot]", 
     SubscriptBox["p", "1"]}], " ", 
    RowBox[{
     SubscriptBox["\[Epsilon]", "1"], "\[CenterDot]", 
     SubscriptBox["\[Epsilon]", "2"]}], " ", 
    RowBox[{"Cos", "[", 
     RowBox[{"a", "\[CenterDot]", 
      SubscriptBox["p", "1"]}], "]"}], " ", 
    RowBox[{"Cos", "[", 
     RowBox[{"a", "\[CenterDot]", 
      SubscriptBox["p", "2"]}], "]"}]}], 
   RowBox[{
    RowBox[{"a", "\[CenterDot]", 
     SubscriptBox["p", "1"]}], "+", 
    RowBox[{"a", "\[CenterDot]", 
     SubscriptBox["p", "2"]}]}]], "-", 
  FractionBox[
   RowBox[{
    RowBox[{"a", "\[CenterDot]", 
     SubscriptBox["p", "2"]}], " ", 
    RowBox[{"v", "\[CenterDot]", 
     SubscriptBox["p", "1"]}], " ", 
    RowBox[{
     SubscriptBox["\[Epsilon]", "1"], "\[CenterDot]", 
     SubscriptBox["\[Epsilon]", "2"]}], " ", 
    RowBox[{"Cos", "[", 
     RowBox[{"a", "\[CenterDot]", 
      SubscriptBox["p", "1"]}], "]"}], " ", 
    RowBox[{"Cos", "[", 
     RowBox[{"a", "\[CenterDot]", 
      SubscriptBox["p", "2"]}], "]"}]}], 
   RowBox[{
    RowBox[{"a", "\[CenterDot]", 
     SubscriptBox["p", "1"]}], "+", 
    RowBox[{"a", "\[CenterDot]", 
     SubscriptBox["p", "2"]}]}]], "+", 
  FractionBox[
   RowBox[{
    RowBox[{"a", "\[CenterDot]", 
     SubscriptBox["p", "1"]}], " ", 
    RowBox[{"v", "\[CenterDot]", 
     SubscriptBox["\[Epsilon]", "1"]}], " ", 
    RowBox[{
     SubscriptBox["\[Epsilon]", "2"], "\[CenterDot]", 
     SubscriptBox["p", "1"]}], " ", 
    RowBox[{"Cos", "[", 
     RowBox[{"a", "\[CenterDot]", 
      SubscriptBox["p", "1"]}], "]"}], " ", 
    RowBox[{"Cos", "[", 
     RowBox[{"a", "\[CenterDot]", 
      SubscriptBox["p", "2"]}], "]"}]}], 
   RowBox[{
    RowBox[{"a", "\[CenterDot]", 
     SubscriptBox["p", "1"]}], "+", 
    RowBox[{"a", "\[CenterDot]", 
     SubscriptBox["p", "2"]}]}]], "+", 
  FractionBox[
   RowBox[{
    RowBox[{"a", "\[CenterDot]", 
     SubscriptBox["p", "2"]}], " ", 
    RowBox[{"v", "\[CenterDot]", 
     SubscriptBox["\[Epsilon]", "1"]}], " ", 
    RowBox[{
     SubscriptBox["\[Epsilon]", "2"], "\[CenterDot]", 
     SubscriptBox["p", "1"]}], " ", 
    RowBox[{"Cos", "[", 
     RowBox[{"a", "\[CenterDot]", 
      SubscriptBox["p", "1"]}], "]"}], " ", 
    RowBox[{"Cos", "[", 
     RowBox[{"a", "\[CenterDot]", 
      SubscriptBox["p", "2"]}], "]"}]}], 
   RowBox[{
    RowBox[{"a", "\[CenterDot]", 
     SubscriptBox["p", "1"]}], "+", 
    RowBox[{"a", "\[CenterDot]", 
     SubscriptBox["p", "2"]}]}]], "+", 
  FractionBox[
   RowBox[{
    RowBox[{
     SubscriptBox["\[Epsilon]", "1"], "\[CenterDot]", 
     SubscriptBox["\[Epsilon]", "2"]}], " ", 
    RowBox[{
     SubscriptBox["p", "1"], "\[CenterDot]", "S", "\[CenterDot]", 
     SubscriptBox["p", "2"]}], " ", 
    RowBox[{"Cos", "[", 
     RowBox[{"a", "\[CenterDot]", 
      SubscriptBox["p", "2"]}], "]"}], " ", 
    RowBox[{"Sin", "[", 
     RowBox[{"a", "\[CenterDot]", 
      SubscriptBox["p", "1"]}], "]"}]}], 
   RowBox[{
    RowBox[{"a", "\[CenterDot]", 
     SubscriptBox["p", "1"]}], "+", 
    RowBox[{"a", "\[CenterDot]", 
     SubscriptBox["p", "2"]}]}]], "+", 
  FractionBox[
   RowBox[{
    RowBox[{
     SubscriptBox["\[Epsilon]", "2"], "\[CenterDot]", 
     SubscriptBox["p", "1"]}], " ", 
    RowBox[{
     SubscriptBox["p", "1"], "\[CenterDot]", "S", "\[CenterDot]", 
     SubscriptBox["\[Epsilon]", "1"]}], " ", 
    RowBox[{"Cos", "[", 
     RowBox[{"a", "\[CenterDot]", 
      SubscriptBox["p", "2"]}], "]"}], " ", 
    RowBox[{"Sin", "[", 
     RowBox[{"a", "\[CenterDot]", 
      SubscriptBox["p", "1"]}], "]"}]}], 
   RowBox[{
    RowBox[{"a", "\[CenterDot]", 
     SubscriptBox["p", "1"]}], "+", 
    RowBox[{"a", "\[CenterDot]", 
     SubscriptBox["p", "2"]}]}]], "-", 
  FractionBox[
   RowBox[{
    RowBox[{
     SubscriptBox["\[Epsilon]", "1"], "\[CenterDot]", 
     SubscriptBox["p", "2"]}], " ", 
    RowBox[{
     SubscriptBox["p", "1"], "\[CenterDot]", "S", "\[CenterDot]", 
     SubscriptBox["\[Epsilon]", "2"]}], " ", 
    RowBox[{"Cos", "[", 
     RowBox[{"a", "\[CenterDot]", 
      SubscriptBox["p", "2"]}], "]"}], " ", 
    RowBox[{"Sin", "[", 
     RowBox[{"a", "\[CenterDot]", 
      SubscriptBox["p", "1"]}], "]"}]}], 
   RowBox[{
    RowBox[{"a", "\[CenterDot]", 
     SubscriptBox["p", "1"]}], "+", 
    RowBox[{"a", "\[CenterDot]", 
     SubscriptBox["p", "2"]}]}]], "+", 
  FractionBox[
   RowBox[{
    RowBox[{
     SubscriptBox["\[Epsilon]", "2"], "\[CenterDot]", 
     SubscriptBox["p", "1"]}], " ", 
    RowBox[{
     SubscriptBox["p", "2"], "\[CenterDot]", "S", "\[CenterDot]", 
     SubscriptBox["\[Epsilon]", "1"]}], " ", 
    RowBox[{"Cos", "[", 
     RowBox[{"a", "\[CenterDot]", 
      SubscriptBox["p", "2"]}], "]"}], " ", 
    RowBox[{"Sin", "[", 
     RowBox[{"a", "\[CenterDot]", 
      SubscriptBox["p", "1"]}], "]"}]}], 
   RowBox[{
    RowBox[{"a", "\[CenterDot]", 
     SubscriptBox["p", "1"]}], "+", 
    RowBox[{"a", "\[CenterDot]", 
     SubscriptBox["p", "2"]}]}]], "-", 
  FractionBox[
   RowBox[{
    RowBox[{
     SubscriptBox["\[Epsilon]", "1"], "\[CenterDot]", 
     SubscriptBox["p", "2"]}], " ", 
    RowBox[{
     SubscriptBox["p", "2"], "\[CenterDot]", "S", "\[CenterDot]", 
     SubscriptBox["\[Epsilon]", "2"]}], " ", 
    RowBox[{"Cos", "[", 
     RowBox[{"a", "\[CenterDot]", 
      SubscriptBox["p", "2"]}], "]"}], " ", 
    RowBox[{"Sin", "[", 
     RowBox[{"a", "\[CenterDot]", 
      SubscriptBox["p", "1"]}], "]"}]}], 
   RowBox[{
    RowBox[{"a", "\[CenterDot]", 
     SubscriptBox["p", "1"]}], "+", 
    RowBox[{"a", "\[CenterDot]", 
     SubscriptBox["p", "2"]}]}]], "+", 
  FractionBox[
   RowBox[{
    RowBox[{
     SubscriptBox["\[Epsilon]", "1"], "\[CenterDot]", 
     SubscriptBox["\[Epsilon]", "2"]}], " ", 
    RowBox[{
     SubscriptBox["p", "1"], "\[CenterDot]", "S", "\[CenterDot]", 
     SubscriptBox["p", "2"]}], " ", 
    RowBox[{"Cos", "[", 
     RowBox[{"a", "\[CenterDot]", 
      SubscriptBox["p", "1"]}], "]"}], " ", 
    RowBox[{"Sin", "[", 
     RowBox[{"a", "\[CenterDot]", 
      SubscriptBox["p", "2"]}], "]"}]}], 
   RowBox[{
    RowBox[{"a", "\[CenterDot]", 
     SubscriptBox["p", "1"]}], "+", 
    RowBox[{"a", "\[CenterDot]", 
     SubscriptBox["p", "2"]}]}]], "+", 
  FractionBox[
   RowBox[{
    RowBox[{
     SubscriptBox["\[Epsilon]", "2"], "\[CenterDot]", 
     SubscriptBox["p", "1"]}], " ", 
    RowBox[{
     SubscriptBox["p", "1"], "\[CenterDot]", "S", "\[CenterDot]", 
     SubscriptBox["\[Epsilon]", "1"]}], " ", 
    RowBox[{"Cos", "[", 
     RowBox[{"a", "\[CenterDot]", 
      SubscriptBox["p", "1"]}], "]"}], " ", 
    RowBox[{"Sin", "[", 
     RowBox[{"a", "\[CenterDot]", 
      SubscriptBox["p", "2"]}], "]"}]}], 
   RowBox[{
    RowBox[{"a", "\[CenterDot]", 
     SubscriptBox["p", "1"]}], "+", 
    RowBox[{"a", "\[CenterDot]", 
     SubscriptBox["p", "2"]}]}]], "-", 
  FractionBox[
   RowBox[{
    RowBox[{
     SubscriptBox["\[Epsilon]", "1"], "\[CenterDot]", 
     SubscriptBox["p", "2"]}], " ", 
    RowBox[{
     SubscriptBox["p", "1"], "\[CenterDot]", "S", "\[CenterDot]", 
     SubscriptBox["\[Epsilon]", "2"]}], " ", 
    RowBox[{"Cos", "[", 
     RowBox[{"a", "\[CenterDot]", 
      SubscriptBox["p", "1"]}], "]"}], " ", 
    RowBox[{"Sin", "[", 
     RowBox[{"a", "\[CenterDot]", 
      SubscriptBox["p", "2"]}], "]"}]}], 
   RowBox[{
    RowBox[{"a", "\[CenterDot]", 
     SubscriptBox["p", "1"]}], "+", 
    RowBox[{"a", "\[CenterDot]", 
     SubscriptBox["p", "2"]}]}]], "+", 
  FractionBox[
   RowBox[{
    RowBox[{
     SubscriptBox["\[Epsilon]", "2"], "\[CenterDot]", 
     SubscriptBox["p", "1"]}], " ", 
    RowBox[{
     SubscriptBox["p", "2"], "\[CenterDot]", "S", "\[CenterDot]", 
     SubscriptBox["\[Epsilon]", "1"]}], " ", 
    RowBox[{"Cos", "[", 
     RowBox[{"a", "\[CenterDot]", 
      SubscriptBox["p", "1"]}], "]"}], " ", 
    RowBox[{"Sin", "[", 
     RowBox[{"a", "\[CenterDot]", 
      SubscriptBox["p", "2"]}], "]"}]}], 
   RowBox[{
    RowBox[{"a", "\[CenterDot]", 
     SubscriptBox["p", "1"]}], "+", 
    RowBox[{"a", "\[CenterDot]", 
     SubscriptBox["p", "2"]}]}]], "-", 
  FractionBox[
   RowBox[{
    RowBox[{
     SubscriptBox["\[Epsilon]", "1"], "\[CenterDot]", 
     SubscriptBox["p", "2"]}], " ", 
    RowBox[{
     SubscriptBox["p", "2"], "\[CenterDot]", "S", "\[CenterDot]", 
     SubscriptBox["\[Epsilon]", "2"]}], " ", 
    RowBox[{"Cos", "[", 
     RowBox[{"a", "\[CenterDot]", 
      SubscriptBox["p", "1"]}], "]"}], " ", 
    RowBox[{"Sin", "[", 
     RowBox[{"a", "\[CenterDot]", 
      SubscriptBox["p", "2"]}], "]"}]}], 
   RowBox[{
    RowBox[{"a", "\[CenterDot]", 
     SubscriptBox["p", "1"]}], "+", 
    RowBox[{"a", "\[CenterDot]", 
     SubscriptBox["p", "2"]}]}]], "+", 
  FractionBox[
   RowBox[{
    RowBox[{"a", "\[CenterDot]", 
     SubscriptBox["p", "1"]}], " ", 
    RowBox[{"v", "\[CenterDot]", 
     SubscriptBox["\[Epsilon]", "2"]}], " ", 
    RowBox[{
     SubscriptBox["\[Epsilon]", "1"], "\[CenterDot]", 
     SubscriptBox["p", "2"]}], " ", 
    RowBox[{"Sin", "[", 
     RowBox[{"a", "\[CenterDot]", 
      SubscriptBox["p", "1"]}], "]"}], " ", 
    RowBox[{"Sin", "[", 
     RowBox[{"a", "\[CenterDot]", 
      SubscriptBox["p", "2"]}], "]"}]}], 
   RowBox[{
    RowBox[{"a", "\[CenterDot]", 
     SubscriptBox["p", "1"]}], "+", 
    RowBox[{"a", "\[CenterDot]", 
     SubscriptBox["p", "2"]}]}]], "+", 
  FractionBox[
   RowBox[{
    RowBox[{"a", "\[CenterDot]", 
     SubscriptBox["p", "2"]}], " ", 
    RowBox[{"v", "\[CenterDot]", 
     SubscriptBox["\[Epsilon]", "2"]}], " ", 
    RowBox[{
     SubscriptBox["\[Epsilon]", "1"], "\[CenterDot]", 
     SubscriptBox["p", "2"]}], " ", 
    RowBox[{"Sin", "[", 
     RowBox[{"a", "\[CenterDot]", 
      SubscriptBox["p", "1"]}], "]"}], " ", 
    RowBox[{"Sin", "[", 
     RowBox[{"a", "\[CenterDot]", 
      SubscriptBox["p", "2"]}], "]"}]}], 
   RowBox[{
    RowBox[{"a", "\[CenterDot]", 
     SubscriptBox["p", "1"]}], "+", 
    RowBox[{"a", "\[CenterDot]", 
     SubscriptBox["p", "2"]}]}]], "+", 
  FractionBox[
   RowBox[{
    RowBox[{"a", "\[CenterDot]", 
     SubscriptBox["p", "1"]}], " ", 
    RowBox[{"v", "\[CenterDot]", 
     SubscriptBox["p", "1"]}], " ", 
    RowBox[{
     SubscriptBox["\[Epsilon]", "1"], "\[CenterDot]", 
     SubscriptBox["\[Epsilon]", "2"]}], " ", 
    RowBox[{"Sin", "[", 
     RowBox[{"a", "\[CenterDot]", 
      SubscriptBox["p", "1"]}], "]"}], " ", 
    RowBox[{"Sin", "[", 
     RowBox[{"a", "\[CenterDot]", 
      SubscriptBox["p", "2"]}], "]"}]}], 
   RowBox[{
    RowBox[{"a", "\[CenterDot]", 
     SubscriptBox["p", "1"]}], "+", 
    RowBox[{"a", "\[CenterDot]", 
     SubscriptBox["p", "2"]}]}]], "+", 
  FractionBox[
   RowBox[{
    RowBox[{"a", "\[CenterDot]", 
     SubscriptBox["p", "2"]}], " ", 
    RowBox[{"v", "\[CenterDot]", 
     SubscriptBox["p", "1"]}], " ", 
    RowBox[{
     SubscriptBox["\[Epsilon]", "1"], "\[CenterDot]", 
     SubscriptBox["\[Epsilon]", "2"]}], " ", 
    RowBox[{"Sin", "[", 
     RowBox[{"a", "\[CenterDot]", 
      SubscriptBox["p", "1"]}], "]"}], " ", 
    RowBox[{"Sin", "[", 
     RowBox[{"a", "\[CenterDot]", 
      SubscriptBox["p", "2"]}], "]"}]}], 
   RowBox[{
    RowBox[{"a", "\[CenterDot]", 
     SubscriptBox["p", "1"]}], "+", 
    RowBox[{"a", "\[CenterDot]", 
     SubscriptBox["p", "2"]}]}]], "-", 
  FractionBox[
   RowBox[{
    RowBox[{"a", "\[CenterDot]", 
     SubscriptBox["p", "1"]}], " ", 
    RowBox[{"v", "\[CenterDot]", 
     SubscriptBox["\[Epsilon]", "1"]}], " ", 
    RowBox[{
     SubscriptBox["\[Epsilon]", "2"], "\[CenterDot]", 
     SubscriptBox["p", "1"]}], " ", 
    RowBox[{"Sin", "[", 
     RowBox[{"a", "\[CenterDot]", 
      SubscriptBox["p", "1"]}], "]"}], " ", 
    RowBox[{"Sin", "[", 
     RowBox[{"a", "\[CenterDot]", 
      SubscriptBox["p", "2"]}], "]"}]}], 
   RowBox[{
    RowBox[{"a", "\[CenterDot]", 
     SubscriptBox["p", "1"]}], "+", 
    RowBox[{"a", "\[CenterDot]", 
     SubscriptBox["p", "2"]}]}]], "-", 
  FractionBox[
   RowBox[{
    RowBox[{"a", "\[CenterDot]", 
     SubscriptBox["p", "2"]}], " ", 
    RowBox[{"v", "\[CenterDot]", 
     SubscriptBox["\[Epsilon]", "1"]}], " ", 
    RowBox[{
     SubscriptBox["\[Epsilon]", "2"], "\[CenterDot]", 
     SubscriptBox["p", "1"]}], " ", 
    RowBox[{"Sin", "[", 
     RowBox[{"a", "\[CenterDot]", 
      SubscriptBox["p", "1"]}], "]"}], " ", 
    RowBox[{"Sin", "[", 
     RowBox[{"a", "\[CenterDot]", 
      SubscriptBox["p", "2"]}], "]"}]}], 
   RowBox[{
    RowBox[{"a", "\[CenterDot]", 
     SubscriptBox["p", "1"]}], "+", 
    RowBox[{"a", "\[CenterDot]", 
     SubscriptBox["p", "2"]}]}]]}]], "Output",
 CellChangeTimes->{3.878683629412397*^9, 3.8788573645718307`*^9},
 CellLabel->
  "Out[493]=",ExpressionUUID->"d75fe43a-6b91-400c-b25b-6a0ec20272ae"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  RowBox[{"ampYMGlueNum3All", "-", "tt"}], "//", "Simplify"}]], "Input",
 CellChangeTimes->{{3.878683693155613*^9, 3.8786837028236094`*^9}},
 CellLabel->
  "In[494]:=",ExpressionUUID->"7fa21760-74ca-45dd-bacc-3bdd2aa0f9f1"],

Cell[BoxData["0"], "Output",
 CellChangeTimes->{{3.878683691087788*^9, 3.87868370327803*^9}, 
   3.8788573645772753`*^9},
 CellLabel->
  "Out[494]=",ExpressionUUID->"59fb3d37-29a8-4fd6-912a-121ea6ef1bb6"]
}, Open  ]]
}, Closed]],

Cell[CellGroupData[{

Cell["Five point massive pole part", "Subsection",
 CellChangeTimes->{{3.878686434872892*^9, 3.878686437830031*^9}, {
  3.878687753547817*^9, 
  3.87868776678377*^9}},ExpressionUUID->"45f48728-7fa0-440d-9286-\
50bc2f44246e"],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{
  RowBox[{"num", "=", 
   RowBox[{"\[FivePointedStar]", "[", 
    RowBox[{
     RowBox[{"T", "[", 
      RowBox[{"{", "1", "}"}], "]"}], ",", 
     RowBox[{"T", "[", 
      RowBox[{"{", "2", "}"}], "]"}], ",", 
     RowBox[{"T", "[", 
      RowBox[{"{", "3", "}"}], "]"}]}], "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{"nod", "=", 
  RowBox[{"(", 
   RowBox[{
    RowBox[{
     RowBox[{"num", "/.", 
      RowBox[{"T", "->", "T2F"}]}], "/.", "rmzero"}], "/.", 
    RowBox[{"v", "->", " ", 
     RowBox[{"v", "[", "1", "]"}]}]}], ")"}]}]}], "Input",
 CellChangeTimes->{{3.878696372666236*^9, 3.878696416123515*^9}, {
  3.878696479726905*^9, 3.878696499064349*^9}},
 CellLabel->
  "In[495]:=",ExpressionUUID->"9206684e-3918-42c8-b1e7-5f782ed64ec4"],

Cell[BoxData[
 RowBox[{
  RowBox[{"-", 
   FractionBox[
    RowBox[{
     RowBox[{"dot", "[", 
      RowBox[{
       RowBox[{"p", "[", 
        RowBox[{"1", ",", "2"}], "]"}], ",", 
       RowBox[{"F", "[", "3", "]"}], ",", 
       RowBox[{"v", "[", "1", "]"}]}], "]"}], " ", 
     RowBox[{"dot", "[", 
      RowBox[{
       RowBox[{"v", "[", "1", "]"}], ",", 
       RowBox[{"F", "[", "1", "]"}], ",", 
       RowBox[{"F", "[", "2", "]"}], ",", 
       RowBox[{"v", "[", "1", "]"}]}], "]"}]}], 
    RowBox[{
     RowBox[{"dot", "[", 
      RowBox[{
       RowBox[{"p", "[", "1", "]"}], ",", 
       RowBox[{"v", "[", "1", "]"}]}], "]"}], " ", 
     RowBox[{"dot", "[", 
      RowBox[{
       RowBox[{"p", "[", 
        RowBox[{"1", ",", "2"}], "]"}], ",", 
       RowBox[{"v", "[", "1", "]"}]}], "]"}]}]]}], "-", 
  FractionBox[
   RowBox[{
    RowBox[{"dot", "[", 
     RowBox[{
      RowBox[{"p", "[", "1", "]"}], ",", 
      RowBox[{"F", "[", "2", "]"}], ",", 
      RowBox[{"v", "[", "1", "]"}]}], "]"}], " ", 
    RowBox[{"dot", "[", 
     RowBox[{
      RowBox[{"v", "[", "1", "]"}], ",", 
      RowBox[{"F", "[", "1", "]"}], ",", 
      RowBox[{"F", "[", "3", "]"}], ",", 
      RowBox[{"v", "[", "1", "]"}]}], "]"}]}], 
   RowBox[{
    RowBox[{"dot", "[", 
     RowBox[{
      RowBox[{"p", "[", "1", "]"}], ",", 
      RowBox[{"v", "[", "1", "]"}]}], "]"}], " ", 
    RowBox[{"dot", "[", 
     RowBox[{
      RowBox[{"p", "[", 
       RowBox[{"1", ",", "3"}], "]"}], ",", 
      RowBox[{"v", "[", "1", "]"}]}], "]"}]}]], "+", 
  FractionBox[
   RowBox[{"dot", "[", 
    RowBox[{
     RowBox[{"v", "[", "1", "]"}], ",", 
     RowBox[{"F", "[", "1", "]"}], ",", 
     RowBox[{"F", "[", "2", "]"}], ",", 
     RowBox[{"F", "[", "3", "]"}], ",", 
     RowBox[{"v", "[", "1", "]"}]}], "]"}], 
   RowBox[{"dot", "[", 
    RowBox[{
     RowBox[{"p", "[", "1", "]"}], ",", 
     RowBox[{"v", "[", "1", "]"}]}], "]"}]]}]], "Output",
 CellChangeTimes->{3.878696499543901*^9, 3.878857364589981*^9},
 CellLabel->
  "Out[496]=",ExpressionUUID->"9b715850-41dd-477c-917c-d097d1278383"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData["wtoVS"], "Input",
 CellChangeTimes->{{3.878696531484868*^9, 3.878696536013916*^9}},
 CellLabel->
  "In[497]:=",ExpressionUUID->"b1846e16-48c6-44b6-b35c-9172c2fa5f2a"],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
   RowBox[{
    RowBox[{"dot", "[", 
     RowBox[{
      RowBox[{"w", "[", "i__", "]"}], ",", "x_"}], "]"}], "\[RuleDelayed]", 
    RowBox[{
     RowBox[{
      RowBox[{"Cos", "[", 
       RowBox[{"dot", "[", 
        RowBox[{
         RowBox[{"p", "[", "i", "]"}], ",", 
         RowBox[{"as", "[", "0", "]"}]}], "]"}], "]"}], " ", 
      RowBox[{"dot", "[", 
       RowBox[{
        RowBox[{"v", "[", "1", "]"}], ",", "x"}], "]"}]}], "+", 
     FractionBox[
      RowBox[{
       RowBox[{"Sin", "[", 
        RowBox[{"dot", "[", 
         RowBox[{
          RowBox[{"p", "[", "i", "]"}], ",", 
          RowBox[{"as", "[", "0", "]"}]}], "]"}], "]"}], " ", 
       RowBox[{"dot", "[", 
        RowBox[{
         RowBox[{"p", "[", "i", "]"}], ",", 
         RowBox[{"S", "[", "0", "]"}], ",", "x"}], "]"}]}], 
      RowBox[{"dot", "[", 
       RowBox[{
        RowBox[{"p", "[", "i", "]"}], ",", 
        RowBox[{"as", "[", "0", "]"}]}], "]"}]]}]}], ",", 
   RowBox[{
    RowBox[{"dot", "[", 
     RowBox[{"x_", ",", 
      RowBox[{"w", "[", "i__", "]"}]}], "]"}], "\[RuleDelayed]", 
    RowBox[{
     RowBox[{
      RowBox[{"Cos", "[", 
       RowBox[{"dot", "[", 
        RowBox[{
         RowBox[{"p", "[", "i", "]"}], ",", 
         RowBox[{"as", "[", "0", "]"}]}], "]"}], "]"}], " ", 
      RowBox[{"dot", "[", 
       RowBox[{
        RowBox[{"v", "[", "1", "]"}], ",", "x"}], "]"}]}], "+", 
     FractionBox[
      RowBox[{
       RowBox[{"Sin", "[", 
        RowBox[{"dot", "[", 
         RowBox[{
          RowBox[{"p", "[", "i", "]"}], ",", 
          RowBox[{"as", "[", "0", "]"}]}], "]"}], "]"}], " ", 
       RowBox[{"dot", "[", 
        RowBox[{
         RowBox[{"p", "[", "i", "]"}], ",", 
         RowBox[{"S", "[", "0", "]"}], ",", "x"}], "]"}]}], 
      RowBox[{"dot", "[", 
       RowBox[{
        RowBox[{"p", "[", "i", "]"}], ",", 
        RowBox[{"as", "[", "0", "]"}]}], "]"}]]}]}]}], "}"}]], "Output",
 CellChangeTimes->{3.878696536448103*^9, 3.878857364596881*^9},
 CellLabel->
  "Out[497]=",ExpressionUUID->"db65af4b-2de7-4a1b-890f-1940a1265e7f"]
}, Open  ]],

Cell[BoxData[
 RowBox[{
  RowBox[{"Num123a", "=", 
   RowBox[{
    FractionBox[
     RowBox[{
      RowBox[{"dot", "[", 
       RowBox[{
        RowBox[{"w", "[", "1", "]"}], ",", 
        RowBox[{"F", "[", "1", "]"}], ",", 
        RowBox[{"F", "[", "2", "]"}], ",", 
        RowBox[{"F", "[", "3", "]"}], ",", 
        RowBox[{"w", "[", "3", "]"}]}], "]"}], 
      RowBox[{"Cos", "[", 
       RowBox[{"dot", "[", 
        RowBox[{
         RowBox[{"p", "[", "2", "]"}], ",", 
         RowBox[{"as", "[", "0", "]"}]}], "]"}], "]"}]}], 
     RowBox[{"dot", "[", 
      RowBox[{
       RowBox[{"p", "[", "1", "]"}], ",", 
       RowBox[{"v", "[", "1", "]"}]}], "]"}]], "-", 
    FractionBox[
     RowBox[{
      RowBox[{"dot", "[", 
       RowBox[{
        RowBox[{"w", "[", "1", "]"}], ",", 
        RowBox[{"F", "[", "1", "]"}], ",", 
        RowBox[{"F", "[", "2", "]"}], ",", 
        RowBox[{"w", "[", "2", "]"}]}], "]"}], 
      RowBox[{"dot", "[", 
       RowBox[{
        RowBox[{"p", "[", 
         RowBox[{"1", ",", "2"}], "]"}], ",", 
        RowBox[{"F", "[", "3", "]"}], ",", 
        RowBox[{"w", "[", "3", "]"}]}], "]"}]}], 
     RowBox[{
      RowBox[{"dot", "[", 
       RowBox[{
        RowBox[{"p", "[", "1", "]"}], ",", 
        RowBox[{"v", "[", "1", "]"}]}], "]"}], 
      RowBox[{"dot", "[", 
       RowBox[{
        RowBox[{"p", "[", 
         RowBox[{"1", ",", "2"}], "]"}], ",", 
        RowBox[{"v", "[", "1", "]"}]}], "]"}]}]], "-", 
    FractionBox[
     RowBox[{
      RowBox[{"dot", "[", 
       RowBox[{
        RowBox[{"w", "[", "1", "]"}], ",", 
        RowBox[{"F", "[", "1", "]"}], ",", 
        RowBox[{"F", "[", "3", "]"}], ",", 
        RowBox[{"w", "[", "3", "]"}]}], "]"}], 
      RowBox[{"dot", "[", 
       RowBox[{
        RowBox[{"p", "[", "1", "]"}], ",", 
        RowBox[{"F", "[", "2", "]"}], ",", 
        RowBox[{"w", "[", "2", "]"}]}], "]"}]}], 
     RowBox[{
      RowBox[{"dot", "[", 
       RowBox[{
        RowBox[{"p", "[", "1", "]"}], ",", 
        RowBox[{"v", "[", "1", "]"}]}], "]"}], 
      RowBox[{"dot", "[", 
       RowBox[{
        RowBox[{"p", "[", 
         RowBox[{"1", ",", "3"}], "]"}], ",", 
        RowBox[{"v", "[", "1", "]"}]}], "]"}]}]]}]}], ";"}]], "Input",
 CellChangeTimes->{{3.878686442499749*^9, 3.878686446390685*^9}, {
  3.878686601392955*^9, 3.878686747519884*^9}, {3.87868678466718*^9, 
  3.8786867938192377`*^9}, {3.8786975144228888`*^9, 3.878697515615698*^9}},
 CellLabel->
  "In[498]:=",ExpressionUUID->"2782cf20-5b7c-4ff6-8cd3-e798467b0dfd"],

Cell[BoxData[{
 RowBox[{
  RowBox[{"Num130", "=", 
   RowBox[{"Num120", "/.", 
    RowBox[{"{", 
     RowBox[{
      RowBox[{"a_", "[", "2", "]"}], ":>", 
      RowBox[{
       RowBox[{"a", "[", "3", "]"}], "/;", 
       RowBox[{"MemberQ", "[", 
        RowBox[{
         RowBox[{"{", 
          RowBox[{"p", ",", "w", ",", "F", ",", "\[Epsilon]"}], "}"}], ",", 
         "a"}], "]"}]}]}], "}"}]}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"Num230", "=", 
   RowBox[{"Num120", "/.", 
    RowBox[{"{", 
     RowBox[{
      RowBox[{
       RowBox[{"a_", "[", "1", "]"}], ":>", 
       RowBox[{
        RowBox[{"a", "[", "2", "]"}], "/;", 
        RowBox[{"MemberQ", "[", 
         RowBox[{
          RowBox[{"{", 
           RowBox[{"p", ",", "w", ",", "F", ",", "\[Epsilon]"}], "}"}], ",", 
          "a"}], "]"}]}]}], ",", 
      RowBox[{
       RowBox[{"a_", "[", "2", "]"}], ":>", 
       RowBox[{
        RowBox[{"a", "[", "3", "]"}], "/;", 
        RowBox[{"MemberQ", "[", 
         RowBox[{
          RowBox[{"{", 
           RowBox[{"p", ",", "w", ",", "F", ",", "\[Epsilon]"}], "}"}], ",", 
          "a"}], "]"}]}]}]}], "}"}]}]}], ";"}]}], "Input",
 CellChangeTimes->{{3.8786869278791027`*^9, 3.8786870068208303`*^9}, {
  3.878687037604707*^9, 3.8786870748978662`*^9}, {3.878687368417794*^9, 
  3.878687413183972*^9}, {3.878687446382668*^9, 3.878687489767243*^9}, {
  3.878699523626721*^9, 3.8786995346482077`*^9}},
 CellLabel->
  "In[499]:=",ExpressionUUID->"8881baa2-1f24-49b4-a37e-b3630712019e"],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  RowBox[{"Num230", "/.", "nicevs"}], "//.", "nice"}]], "Input",
 CellChangeTimes->{{3.8786994248575697`*^9, 3.87869943189778*^9}},
 CellLabel->
  "In[501]:=",ExpressionUUID->"11ab6222-023d-498f-90fe-d51abdefa6e8"],

Cell[BoxData[
 RowBox[{
  FractionBox[
   RowBox[{
    RowBox[{"(", 
     RowBox[{
      RowBox[{
       RowBox[{"v", "\[CenterDot]", 
        SubscriptBox["F", "3"], "\[CenterDot]", "a"}], " ", 
       RowBox[{
        SubscriptBox["p", "3"], "\[CenterDot]", 
        SubscriptBox["F", "2"], "\[CenterDot]", "a"}]}], "-", 
      RowBox[{
       RowBox[{"a", "\[CenterDot]", 
        SubscriptBox["p", "2"]}], " ", 
       RowBox[{"v", "\[CenterDot]", 
        SubscriptBox["F", "2"], "\[CenterDot]", 
        SubscriptBox["F", "3"], "\[CenterDot]", "a"}]}]}], ")"}], " ", 
    RowBox[{"Sin", "[", 
     RowBox[{"a", "\[CenterDot]", 
      SubscriptBox["p", "2"]}], "]"}], " ", 
    RowBox[{"Sin", "[", 
     RowBox[{"a", "\[CenterDot]", 
      SubscriptBox["p", "3"]}], "]"}]}], 
   RowBox[{
    RowBox[{"a", "\[CenterDot]", 
     SubscriptBox["p", "2"]}], " ", 
    RowBox[{"a", "\[CenterDot]", 
     SubscriptBox["p", "3"]}]}]], "+", 
  RowBox[{
   RowBox[{"(", 
    RowBox[{
     RowBox[{
      SubscriptBox["p", "2"], "\[CenterDot]", "S", "\[CenterDot]", 
      SubscriptBox["F", "3"], "\[CenterDot]", 
      SubscriptBox["\[Epsilon]", "2"]}], "-", 
     RowBox[{
      SubscriptBox["p", "2"], "\[CenterDot]", 
      SubscriptBox["F", "3"], "\[CenterDot]", "S", "\[CenterDot]", 
      SubscriptBox["\[Epsilon]", "2"]}]}], ")"}], " ", 
   RowBox[{"(", 
    RowBox[{
     FractionBox[
      RowBox[{
       RowBox[{"Cos", "[", 
        RowBox[{"a", "\[CenterDot]", 
         SubscriptBox["p", "3"]}], "]"}], " ", 
       RowBox[{"Sin", "[", 
        RowBox[{"a", "\[CenterDot]", 
         SubscriptBox["p", "2"]}], "]"}]}], 
      RowBox[{
       RowBox[{"a", "\[CenterDot]", 
        SubscriptBox["p", "2"]}], "+", 
       RowBox[{"a", "\[CenterDot]", 
        SubscriptBox["p", "3"]}]}]], "+", 
     FractionBox[
      RowBox[{
       RowBox[{"Cos", "[", 
        RowBox[{"a", "\[CenterDot]", 
         SubscriptBox["p", "2"]}], "]"}], " ", 
       RowBox[{"Sin", "[", 
        RowBox[{"a", "\[CenterDot]", 
         SubscriptBox["p", "3"]}], "]"}]}], 
      RowBox[{
       RowBox[{"a", "\[CenterDot]", 
        SubscriptBox["p", "2"]}], "+", 
       RowBox[{"a", "\[CenterDot]", 
        SubscriptBox["p", "3"]}]}]]}], ")"}]}], "+", 
  RowBox[{
   RowBox[{"(", 
    RowBox[{
     RowBox[{
      SubscriptBox["p", "2"], "\[CenterDot]", "S", "\[CenterDot]", 
      SubscriptBox["F", "2"], "\[CenterDot]", 
      SubscriptBox["F", "3"], "\[CenterDot]", "a"}], "+", 
     RowBox[{
      SubscriptBox["p", "3"], "\[CenterDot]", "S", "\[CenterDot]", 
      SubscriptBox["F", "3"], "\[CenterDot]", 
      SubscriptBox["F", "2"], "\[CenterDot]", "a"}]}], ")"}], " ", 
   RowBox[{"(", 
    RowBox[{
     RowBox[{"-", 
      FractionBox[
       RowBox[{
        RowBox[{"Cos", "[", 
         RowBox[{"a", "\[CenterDot]", 
          SubscriptBox["p", "3"]}], "]"}], " ", 
        RowBox[{"Sin", "[", 
         RowBox[{"a", "\[CenterDot]", 
          SubscriptBox["p", "2"]}], "]"}]}], 
       RowBox[{
        RowBox[{"a", "\[CenterDot]", 
         SubscriptBox["p", "2"]}], " ", 
        RowBox[{"(", 
         RowBox[{
          RowBox[{"a", "\[CenterDot]", 
           SubscriptBox["p", "2"]}], "+", 
          RowBox[{"a", "\[CenterDot]", 
           SubscriptBox["p", "3"]}]}], ")"}]}]]}], "+", 
     FractionBox[
      RowBox[{
       RowBox[{"Cos", "[", 
        RowBox[{"a", "\[CenterDot]", 
         SubscriptBox["p", "2"]}], "]"}], " ", 
       RowBox[{"Sin", "[", 
        RowBox[{"a", "\[CenterDot]", 
         SubscriptBox["p", "3"]}], "]"}]}], 
      RowBox[{
       RowBox[{"a", "\[CenterDot]", 
        SubscriptBox["p", "3"]}], " ", 
       RowBox[{"(", 
        RowBox[{
         RowBox[{"a", "\[CenterDot]", 
          SubscriptBox["p", "2"]}], "+", 
         RowBox[{"a", "\[CenterDot]", 
          SubscriptBox["p", "3"]}]}], ")"}]}]]}], ")"}]}]}]], "Output",
 CellChangeTimes->{{3.878699426819063*^9, 3.8786994322573433`*^9}, 
   3.87869953842382*^9, 3.878857364625705*^9},
 CellLabel->
  "Out[501]=",ExpressionUUID->"ee2e1493-e4e6-4634-8ae1-0300cacc77d9"]
}, Open  ]],

Cell[BoxData[
 RowBox[{
  RowBox[{"Num123b", "=", 
   RowBox[{
    RowBox[{"Num120", " ", 
     FractionBox[
      RowBox[{"dot", "[", 
       RowBox[{
        RowBox[{"p", "[", 
         RowBox[{"1", ",", "2"}], "]"}], ",", 
        RowBox[{"F", "[", "3", "]"}], ",", 
        RowBox[{"w", "[", "3", "]"}]}], "]"}], 
      RowBox[{"dot", "[", 
       RowBox[{
        RowBox[{"p", "[", 
         RowBox[{"1", ",", "2"}], "]"}], ",", 
        RowBox[{"v", "[", "1", "]"}]}], "]"}]]}], "+", 
    RowBox[{"Num130", " ", 
     FractionBox[
      RowBox[{"dot", "[", 
       RowBox[{
        RowBox[{"p", "[", "1", "]"}], ",", 
        RowBox[{"F", "[", "2", "]"}], ",", 
        RowBox[{"w", "[", "2", "]"}]}], "]"}], 
      RowBox[{"dot", "[", 
       RowBox[{
        RowBox[{"p", "[", 
         RowBox[{"1", ",", "3"}], "]"}], ",", 
        RowBox[{"v", "[", "1", "]"}]}], "]"}]]}], "+", 
    RowBox[{"Num230", " ", 
     FractionBox[
      RowBox[{"dot", "[", 
       RowBox[{
        RowBox[{"p", "[", "2", "]"}], ",", 
        RowBox[{"F", "[", "1", "]"}], ",", 
        RowBox[{"w", "[", "1", "]"}]}], "]"}], 
      RowBox[{"dot", "[", 
       RowBox[{
        RowBox[{"p", "[", "1", "]"}], ",", 
        RowBox[{"v", "[", "1", "]"}]}], "]"}]]}]}]}], ";"}]], "Input",
 CellChangeTimes->{{3.878687541507936*^9, 3.878687641417285*^9}, {
  3.878687680189938*^9, 3.878687710497138*^9}, {3.8786966120357943`*^9, 
  3.87869661798517*^9}, {3.878696684055678*^9, 3.878696696983073*^9}},
 CellLabel->
  "In[502]:=",ExpressionUUID->"59e37a33-14be-4d82-9e19-8399aaf87271"],

Cell[BoxData[
 RowBox[{
  RowBox[{"nod", "=", 
   RowBox[{
    RowBox[{
     RowBox[{
      RowBox[{
       RowBox[{
        RowBox[{
         RowBox[{"(", 
          RowBox[{
           RowBox[{"Num123a", "+", "Num123b"}], "//", "expandFS"}], ")"}], "/.", 
         RowBox[{
          RowBox[{"p", "[", "f__", "]"}], "\[RuleDelayed]", 
          RowBox[{"Total", "[", 
           RowBox[{"p", "/@", 
            RowBox[{"{", "f", "}"}]}], "]"}]}]}], "//.", "dotRules"}], "/.", 
       "vponshell"}], "/.", 
      RowBox[{
       RowBox[{"\[Epsilon]", "[", "i_", "]"}], ":>", 
       RowBox[{"\[Epsilon]", "[", 
        RowBox[{"p", "[", "i", "]"}], "]"}]}]}], "/.", "wtoVS"}], "//", 
    "Expand"}]}], ";"}]], "Input",
 CellChangeTimes->{{3.8780203515119047`*^9, 3.878020399229755*^9}, {
   3.878020431526237*^9, 3.8780204339818277`*^9}, {3.8780205335571136`*^9, 
   3.878020540776443*^9}, 3.8780206405534067`*^9, {3.878020888923959*^9, 
   3.878020889972404*^9}, 3.878021112062257*^9, {3.878022714056156*^9, 
   3.878022715411971*^9}, {3.8780319378374166`*^9, 3.878031956823164*^9}, 
   3.8786959470103903`*^9, 3.878696707459494*^9, {3.878696976572385*^9, 
   3.878696982143857*^9}, 3.878697156181683*^9, {3.8786975552190723`*^9, 
   3.878697558928467*^9}, 3.8786977916694727`*^9},
 CellLabel->
  "In[503]:=",ExpressionUUID->"8de042f2-b526-4cd7-8c1e-5dad0c18cb35"],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{"bpeff2", "=", 
  RowBox[{"BinaryProduct", "[", 
   RowBox[{"Range", "[", 
    RowBox[{"n", "-", "2"}], "]"}], "]"}]}], "\n", 
 RowBox[{
  RowBox[{"numList", "=", 
   RowBox[{
    RowBox[{
     RowBox[{"ExpandNCM", "/@", 
      RowBox[{"(", 
       RowBox[{"bpeff2", "/.", 
        RowBox[{"X", "\[Rule]", " ", "NC"}]}], ")"}]}], "/.", 
     RowBox[{"NonCommutativeMultiply", "\[Rule]", " ", "T"}]}], "/.", 
    RowBox[{
     RowBox[{"T", "[", 
      RowBox[{"i1_", ",", "f___"}], "]"}], ":>", " ", 
     RowBox[{"0", "/;", 
      RowBox[{"i1", "\[NotEqual]", "1"}]}]}]}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"numListL", "=", 
   RowBox[{"numList", "/.", 
    RowBox[{
     RowBox[{"T", "[", "f___", "]"}], "\[RuleDelayed]", " ", 
     RowBox[{"(", 
      RowBox[{"nod", "/.", 
       RowBox[{"replace", "[", 
        RowBox[{
         RowBox[{"p", "/@", 
          RowBox[{"{", "f", "}"}]}], ",", 
         RowBox[{"n", "-", "1"}]}], "]"}]}], ")"}]}]}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"numListL", "=", 
   RowBox[{
    RowBox[{"(", 
     RowBox[{"numListL", "/.", 
      RowBox[{
       RowBox[{"F", "[", 
        RowBox[{"p", "[", "i_", "]"}], "]"}], ":>", " ", 
       RowBox[{"F", "[", "i", "]"}]}]}], ")"}], "//", "Expand"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"ppListD", "=", 
   RowBox[{"(", 
    RowBox[{"X2Prop", "/@", "bpeff2"}], ")"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"ppListD", "=", 
   RowBox[{
    RowBox[{"ppListD", "/.", 
     RowBox[{
      RowBox[{"p", "[", "f__", "]"}], "\[RuleDelayed]", 
      RowBox[{"Total", "[", 
       RowBox[{"p", "/@", 
        RowBox[{"{", "f", "}"}]}], "]"}]}]}], "/.", 
    RowBox[{
     RowBox[{"dot", "[", 
      RowBox[{
       RowBox[{"p", "[", "i_", "]"}], ",", 
       RowBox[{"p", "[", "i_", "]"}]}], "]"}], ":>", " ", "0"}]}]}], 
  ";"}], "\n", 
 RowBox[{
  RowBox[{"denAll", "=", 
   RowBox[{"Table", "[", 
    RowBox[{
     RowBox[{"ppListD", "[", 
      RowBox[{"[", "ii", "]"}], "]"}], ",", 
     RowBox[{"{", 
      RowBox[{"ii", ",", 
       RowBox[{"Length", "@", "ppListD"}]}], "}"}]}], "]"}]}], ";"}], "\n", 
 RowBox[{
  RowBox[{"amp5", "=", 
   RowBox[{
    RowBox[{
     RowBox[{"Sum", "[", 
      RowBox[{
       FractionBox[
        RowBox[{"numListL", "[", 
         RowBox[{"[", "ii", "]"}], "]"}], 
        RowBox[{"denAll", "[", 
         RowBox[{"[", "ii", "]"}], "]"}]], ",", 
       RowBox[{"{", 
        RowBox[{"ii", ",", 
         RowBox[{"Length", "@", "ppListD"}]}], "}"}]}], "]"}], "/.", 
     RowBox[{
      RowBox[{"\[Epsilon]", "[", 
       RowBox[{"p", "[", "i_", "]"}], "]"}], ":>", 
      RowBox[{"\[Epsilon]", "[", "i", "]"}]}]}], "//", "Expand"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"amp5", "=", 
   RowBox[{
    RowBox[{
     RowBox[{
      RowBox[{"amp5", "/.", "dotRules"}], "/.", "vponshell"}], "/.", 
     "gponshell"}], "//", "Expand"}]}], ";"}]}], "Input",
 CellChangeTimes->{{3.878022027028722*^9, 3.878022028483653*^9}, {
  3.8780224366059227`*^9, 3.878022442198484*^9}, {3.878022763644738*^9, 
  3.878022823789957*^9}, {3.878022855805319*^9, 3.8780228836038427`*^9}, {
  3.878022958964085*^9, 3.8780229728251*^9}, {3.878025964817404*^9, 
  3.878025974154643*^9}, {3.878032030200883*^9, 3.878032043291239*^9}, {
  3.87807694175404*^9, 3.878076942268965*^9}},
 CellLabel->
  "In[504]:=",ExpressionUUID->"6f2b5855-b15a-496d-a898-2a3c03ad1225"],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
   RowBox[{"X", "[", 
    RowBox[{"1", ",", 
     RowBox[{"X", "[", 
      RowBox[{"2", ",", "3"}], "]"}]}], "]"}], ",", 
   RowBox[{"X", "[", 
    RowBox[{
     RowBox[{"X", "[", 
      RowBox[{"1", ",", "2"}], "]"}], ",", "3"}], "]"}]}], "}"}]], "Output",
 CellChangeTimes->{
  3.8780227866981993`*^9, 3.8780228244290047`*^9, {3.878022856995924*^9, 
   3.878022886712186*^9}, {3.878022959975482*^9, 3.8780229734233837`*^9}, 
   3.878025942910557*^9, 3.878025974822631*^9, 3.87802604880019*^9, 
   3.87802893737528*^9, 3.8780300797739983`*^9, 3.87803201555766*^9, 
   3.878032046557034*^9, 3.8780325721214447`*^9, 3.878075893987146*^9, 
   3.8780808478320103`*^9, 3.878093449603753*^9, 3.878095848723765*^9, 
   3.878097128656351*^9, 3.878616207345304*^9, 3.878695952944994*^9, 
   3.878696711347361*^9, 3.878696984811186*^9, 3.878697158768561*^9, 
   3.8786972468088703`*^9, 3.878697566690786*^9, 3.878697794725322*^9, 
   3.878699556485813*^9, 3.878857364893752*^9},
 CellLabel->
  "Out[504]=",ExpressionUUID->"9ae45e8d-1ed4-4e15-a0af-f7aadfd8488c"]
}, Open  ]],

Cell[BoxData[
 RowBox[{
  RowBox[{"amp5", "=", 
   RowBox[{
    RowBox[{
     RowBox[{
      RowBox[{
       RowBox[{"amp5", "/.", "wtoVS"}], "/.", "dotRules"}], "/.", 
      "vponshell"}], "/.", "gponshell"}], "//", "MultivariateApart"}]}], 
  ";"}]], "Input",
 CellChangeTimes->{{3.878695981830263*^9, 3.878695995703374*^9}, {
   3.87869604602712*^9, 3.878696052791572*^9}, 3.878696086164014*^9, {
   3.878696157890749*^9, 3.8786961990907516`*^9}, {3.878696267936246*^9, 
   3.8786963102540913`*^9}, {3.878696717925912*^9, 3.878696753109474*^9}, {
   3.878697087262608*^9, 3.878697090820015*^9}, {3.878697133428132*^9, 
   3.8786971380572853`*^9}, 3.8786976310583487`*^9, {3.878697911223157*^9, 
   3.878697932707293*^9}},
 CellLabel->
  "In[513]:=",ExpressionUUID->"f859c5f1-a708-4ae8-854b-2e22fb852b36"]
}, Closed]],

Cell[CellGroupData[{

Cell["Five point on massless cut", "Subsection",
 CellChangeTimes->{{3.878700387049975*^9, 
  3.8787003959983664`*^9}},ExpressionUUID->"9375439a-80db-4697-907a-\
f7af8b6c5912"],

Cell[BoxData[{
 RowBox[{
  RowBox[{"num", "=", 
   RowBox[{"\[FivePointedStar]", "[", 
    RowBox[{
     RowBox[{"T", "[", 
      RowBox[{"{", "1", "}"}], "]"}], ",", 
     RowBox[{"T", "[", 
      RowBox[{"{", "2", "}"}], "]"}], ",", 
     RowBox[{"T", "[", 
      RowBox[{"{", "3", "}"}], "]"}]}], "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"nod", "=", 
   RowBox[{
    RowBox[{
     RowBox[{"(", 
      RowBox[{
       RowBox[{
        RowBox[{"num", "/.", 
         RowBox[{"T", "->", "T2F"}]}], "/.", "rmzero"}], "/.", 
       RowBox[{"v", "->", " ", 
        RowBox[{"v", "[", "1", "]"}]}]}], ")"}], "/.", 
     RowBox[{
      RowBox[{"F", "[", "i_", "]"}], ":>", " ", 
      RowBox[{"F", "[", 
       RowBox[{"p", "[", "i", "]"}], "]"}]}]}], "/.", 
    RowBox[{
     RowBox[{"p", "[", 
      RowBox[{"f1_", ",", "g__"}], "]"}], ":>", 
     RowBox[{"P", "[", " ", 
      RowBox[{"Total", "[", 
       RowBox[{"p", "/@", 
        RowBox[{"{", 
         RowBox[{"f1", ",", "g"}], "}"}]}], "]"}], "]"}]}]}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"bpeff2", "=", 
   RowBox[{"BinaryProduct", "[", 
    RowBox[{"Range", "[", 
     RowBox[{"n", "-", "2"}], "]"}], "]"}]}], ";"}], "\n", 
 RowBox[{
  RowBox[{"numList", "=", 
   RowBox[{
    RowBox[{
     RowBox[{"ExpandNCM", "/@", 
      RowBox[{"(", 
       RowBox[{"bpeff2", "/.", 
        RowBox[{"X", "\[Rule]", " ", "NC"}]}], ")"}]}], "/.", 
     RowBox[{"NonCommutativeMultiply", "\[Rule]", " ", "T"}]}], "/.", 
    RowBox[{
     RowBox[{"T", "[", 
      RowBox[{"i1_", ",", "f___"}], "]"}], ":>", " ", 
     RowBox[{"0", "/;", 
      RowBox[{"i1", "\[NotEqual]", "1"}]}]}]}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"numListL", "=", 
   RowBox[{"numList", "/.", 
    RowBox[{
     RowBox[{"T", "[", "f___", "]"}], "\[RuleDelayed]", " ", 
     RowBox[{"(", 
      RowBox[{"nod", "/.", 
       RowBox[{"replace", "[", 
        RowBox[{
         RowBox[{"p", "/@", 
          RowBox[{"{", "f", "}"}]}], ",", 
         RowBox[{"n", "-", "1"}]}], "]"}]}], ")"}]}]}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"numListL", "=", 
   RowBox[{
    RowBox[{"(", 
     RowBox[{"numListL", "/.", 
      RowBox[{
       RowBox[{"F", "[", 
        RowBox[{"p", "[", "i_", "]"}], "]"}], ":>", " ", 
       RowBox[{"F", "[", "i", "]"}]}]}], ")"}], "//", "Expand"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"ppListD", "=", 
   RowBox[{"(", 
    RowBox[{"X2Prop", "/@", "bpeff2"}], ")"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"ppListD", "=", 
   RowBox[{
    RowBox[{"ppListD", "/.", 
     RowBox[{
      RowBox[{"p", "[", "f__", "]"}], "\[RuleDelayed]", 
      RowBox[{"Total", "[", 
       RowBox[{"p", "/@", 
        RowBox[{"{", "f", "}"}]}], "]"}]}]}], "/.", 
    RowBox[{
     RowBox[{"dot", "[", 
      RowBox[{
       RowBox[{"p", "[", "i_", "]"}], ",", 
       RowBox[{"p", "[", "i_", "]"}]}], "]"}], ":>", " ", "0"}]}]}], 
  ";"}], "\n", 
 RowBox[{
  RowBox[{"denAll", "=", 
   RowBox[{"Table", "[", 
    RowBox[{
     RowBox[{"ppListD", "[", 
      RowBox[{"[", "ii", "]"}], "]"}], ",", 
     RowBox[{"{", 
      RowBox[{"ii", ",", 
       RowBox[{"Length", "@", "ppListD"}]}], "}"}]}], "]"}]}], ";"}], "\n", 
 RowBox[{
  RowBox[{"ampYM", "=", 
   RowBox[{
    RowBox[{
     RowBox[{"Sum", "[", 
      RowBox[{
       FractionBox[
        RowBox[{"numListL", "[", 
         RowBox[{"[", "ii", "]"}], "]"}], 
        RowBox[{"denAll", "[", 
         RowBox[{"[", "ii", "]"}], "]"}]], ",", 
       RowBox[{"{", 
        RowBox[{"ii", ",", 
         RowBox[{"Length", "@", "ppListD"}]}], "}"}]}], "]"}], "/.", 
     RowBox[{
      RowBox[{"P", "[", "f_", "]"}], ":>", "f"}]}], "//", "Expand"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"ampYM", "=", 
   RowBox[{
    RowBox[{"(", 
     RowBox[{
      RowBox[{
       RowBox[{
        RowBox[{
         RowBox[{"(", 
          RowBox[{"ampYM", "//", "expandFS"}], ")"}], "/.", "dotRules"}], "/.",
         "vponshell"}], "/.", "gponshell"}], "//", "Expand"}], ")"}], "//", 
    "MultivariateApart"}]}], ";"}]}], "Input",
 CellChangeTimes->{{3.878023857740679*^9, 3.878023860158512*^9}, {
   3.87802396296658*^9, 3.878024017862441*^9}, {3.878024052254986*^9, 
   3.878024058839876*^9}, {3.8780241059261007`*^9, 3.8780241103419027`*^9}, {
   3.878024288644836*^9, 3.8780243205537767`*^9}, 3.878076927512285*^9, {
   3.8786830692486563`*^9, 3.8786830910726547`*^9}, {3.878683187180931*^9, 
   3.878683187946763*^9}, {3.878683222566435*^9, 3.878683252271603*^9}, {
   3.878700404784727*^9, 3.87870045820689*^9}, {3.878700535770341*^9, 
   3.878700539822576*^9}},
 CellLabel->
  "In[514]:=",ExpressionUUID->"16e4b342-ffb1-4243-b870-f48b54971b38"],

Cell[BoxData[{
 RowBox[{
  RowBox[{"ampYMGlueNum3All", "=", 
   RowBox[{
    RowBox[{
     RowBox[{
      RowBox[{
       RowBox[{"ampYM", "/.", 
        RowBox[{"{", 
         RowBox[{
          RowBox[{"v", "[", "1", "]"}], ":>", 
          RowBox[{"w", "[", 
           RowBox[{"1", ",", "2", ",", "3"}], "]"}]}], "}"}]}], "/.", 
       "dotRules"}], "/.", "vponshell"}], "/.", "gponshell"}], "//", 
    "Expand"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"ampYMGlueNum3All", "=", 
   RowBox[{
    RowBox[{"(", 
     RowBox[{
      RowBox[{
       RowBox[{"ampYMGlueNum3All", "/.", "wtoVS"}], "/.", 
       RowBox[{
        RowBox[{"p", "[", "f__", "]"}], "\[RuleDelayed]", 
        RowBox[{"Total", "[", 
         RowBox[{"p", "/@", 
          RowBox[{"{", "f", "}"}]}], "]"}]}]}], "//", "TrigExpand"}], ")"}], "/.",
     "dotRules"}]}], ";"}]}], "Input",
 CellChangeTimes->{{3.878024069941125*^9, 3.87802415205725*^9}, {
   3.878024331157475*^9, 3.878024340048336*^9}, {3.8780243883823147`*^9, 
   3.87802443440853*^9}, {3.878024623562881*^9, 3.878024662661223*^9}, {
   3.878024820522764*^9, 3.878024839044957*^9}, {3.878025373216962*^9, 
   3.878025408461379*^9}, {3.878025474618256*^9, 3.878025484493874*^9}, 
   3.878025529761257*^9, {3.8780757748389797`*^9, 3.878075783185919*^9}, 
   3.878075831065405*^9, {3.878683117400875*^9, 3.8786831244387712`*^9}, {
   3.8786832891590776`*^9, 3.878683405792304*^9}, {3.878683584171186*^9, 
   3.8786835846328506`*^9}, {3.878700762028305*^9, 3.878700799560031*^9}, {
   3.878702964420351*^9, 3.87870296579387*^9}},
 CellLabel->
  "In[525]:=",ExpressionUUID->"34113694-b6eb-44c6-8735-91c8a2c144a5"]
}, Closed]],

Cell[CellGroupData[{

Cell["Compare", "Subsection",
 CellChangeTimes->{{3.87870106418039*^9, 
  3.878701065441207*^9}},ExpressionUUID->"b7b4b2e5-f4ef-4d65-8f2f-\
e99d9c842315"],

Cell[BoxData[
 RowBox[{
  RowBox[{"amp5MP", "=", 
   RowBox[{"amp5", "//", "Expand"}]}], ";"}]], "Input",
 CellChangeTimes->{{3.87870118848177*^9, 3.878701196676139*^9}, 
   3.8787029747902937`*^9},
 CellLabel->
  "In[527]:=",ExpressionUUID->"4cd4b1a9-a5b3-430c-bd42-88aa34098bf6"],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"ampYMGlueNum3All", "//", "Length"}]], "Input",
 CellChangeTimes->{{3.878701120093153*^9, 3.878701120875513*^9}},
 CellLabel->
  "In[528]:=",ExpressionUUID->"27f6e581-8418-4173-9013-8f6941d0acae"],

Cell[BoxData["592"], "Output",
 CellChangeTimes->{3.878701121296155*^9, 3.878702978001783*^9, 
  3.878857370733893*^9},
 CellLabel->
  "Out[528]=",ExpressionUUID->"a8b6418f-4ef3-46b1-b704-bdfea57cef6f"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData["amp5MP"], "Input",
 CellLabel->
  "In[529]:=",ExpressionUUID->"79c7a3ab-56ee-487b-98f4-6d2b3db2141b"],

Cell[BoxData[
 InterpretationBox[
  TagBox[
   FrameBox[GridBox[{
      {
       ItemBox[
        TagBox[
         RowBox[{
          FractionBox[
           RowBox[{
            RowBox[{"Cos", "[", 
             RowBox[{"dot", "[", 
              RowBox[{
               RowBox[{"as", "[", "0", "]"}], ",", 
               RowBox[{"p", "[", "1", "]"}]}], "]"}], "]"}], " ", 
            RowBox[{"Cos", "[", 
             RowBox[{"dot", "[", 
              RowBox[{
               RowBox[{"as", "[", "0", "]"}], ",", 
               RowBox[{"p", "[", "2", "]"}]}], "]"}], "]"}], " ", 
            RowBox[{"Cos", "[", 
             RowBox[{"dot", "[", 
              RowBox[{
               RowBox[{"as", "[", "0", "]"}], ",", 
               RowBox[{"p", "[", "3", "]"}]}], "]"}], "]"}], " ", 
            RowBox[{"dot", "[", 
             RowBox[{
              RowBox[{"p", "[", "1", "]"}], ",", 
              RowBox[{"\[Epsilon]", "[", "2", "]"}]}], "]"}], " ", 
            RowBox[{"dot", "[", 
             RowBox[{
              RowBox[{"p", "[", "1", "]"}], ",", 
              RowBox[{"\[Epsilon]", "[", "3", "]"}]}], "]"}], " ", 
            RowBox[{"dot", "[", 
             RowBox[{
              RowBox[{"v", "[", "1", "]"}], ",", 
              RowBox[{"\[Epsilon]", "[", "1", "]"}]}], "]"}]}], 
           RowBox[{"2", " ", 
            RowBox[{"dot", "[", 
             RowBox[{
              RowBox[{"p", "[", "1", "]"}], ",", 
              RowBox[{"p", "[", "2", "]"}]}], "]"}]}]], "+", 
          TemplateBox[{"318"},
           "OutputSizeLimit`Skeleton"], "+", 
          FractionBox[
           TemplateBox[{"1"},
            "OutputSizeLimit`Skeleton"], 
           TemplateBox[{"1"},
            "OutputSizeLimit`Skeleton"]], "-", 
          FractionBox[
           RowBox[{
            RowBox[{"dot", "[", 
             RowBox[{
              RowBox[{"p", "[", "1", "]"}], ",", 
              RowBox[{"p", "[", "3", "]"}]}], "]"}], " ", 
            TemplateBox[{"4"},
             "OutputSizeLimit`Skeleton"], " ", 
            RowBox[{"Sin", "[", 
             RowBox[{"dot", "[", 
              RowBox[{
               RowBox[{"as", "[", "0", "]"}], ",", 
               RowBox[{"p", "[", "3", "]"}]}], "]"}], "]"}]}], 
           RowBox[{"2", " ", 
            RowBox[{"dot", "[", 
             RowBox[{
              RowBox[{"as", "[", "0", "]"}], ",", 
              RowBox[{"p", "[", "1", "]"}]}], "]"}], " ", 
            RowBox[{"(", 
             RowBox[{
              RowBox[{"dot", "[", 
               RowBox[{
                RowBox[{"p", "[", "1", "]"}], ",", 
                RowBox[{"p", "[", "2", "]"}]}], "]"}], "+", 
              RowBox[{"dot", "[", 
               RowBox[{
                RowBox[{"p", "[", "1", "]"}], ",", 
                RowBox[{"p", "[", "3", "]"}]}], "]"}]}], ")"}]}]]}],
         Short[#, 5]& ],
        BaseStyle->{Deployed -> False},
        StripOnInput->False]},
      {GridBox[{
         {
          PaneBox[
           TagBox[
            TooltipBox[
             StyleBox[
              StyleBox[
               DynamicBox[ToBoxes[
                 FEPrivate`FrontEndResource[
                 "FEStrings", "sizeBriefExplanation"], StandardForm],
                ImageSizeCache->{70., {3., 10.}}],
               StripOnInput->False,
               DynamicUpdating->True,
               LineSpacing->{1, 2},
               LineIndent->0,
               LinebreakAdjustments->{1., 100, 0, 0, 0}], "OSLText",
              StripOnInput->False],
             StyleBox[
              DynamicBox[
               ToBoxes[
                FEPrivate`FrontEndResource["FEStrings", "sizeExplanation"], 
                StandardForm]], DynamicUpdating -> True, LineIndent -> 0, 
              LinebreakAdjustments -> {1., 100, 0, 0, 0}, 
              LineSpacing -> {1, 2}, StripOnInput -> False]],
            Annotation[#, 
             Style[
              Dynamic[
               FEPrivate`FrontEndResource["FEStrings", "sizeExplanation"]], 
              DynamicUpdating -> True, LineIndent -> 0, 
              LinebreakAdjustments -> {1., 100, 0, 0, 0}, 
              LineSpacing -> {1, 2}], "Tooltip"]& ],
           Alignment->Center,
           BaselinePosition->Baseline,
           ImageSize->{Automatic, {25, Full}}], 
          ButtonBox[
           PaneSelectorBox[{False->
            StyleBox[
             StyleBox[
              DynamicBox[ToBoxes[
                FEPrivate`FrontEndResource["FEStrings", "sizeShowLess"], 
                StandardForm],
               ImageSizeCache->{61., {0., 10.}}],
              StripOnInput->False,
              DynamicUpdating->True,
              LineSpacing->{1, 2},
              LineIndent->0,
              LinebreakAdjustments->{1., 100, 0, 0, 0}], "OSLControl",
             StripOnInput->False], True->
            StyleBox[
             StyleBox[
              DynamicBox[ToBoxes[
                FEPrivate`FrontEndResource["FEStrings", "sizeShowLess"], 
                StandardForm]],
              StripOnInput->False,
              DynamicUpdating->True,
              LineSpacing->{1, 2},
              LineIndent->0,
              LinebreakAdjustments->{1., 100, 0, 0, 0}], "OSLControlActive",
             StripOnInput->False]}, Dynamic[
             CurrentValue["MouseOver"]],
            Alignment->Center,
            FrameMargins->0,
            ImageSize->{Automatic, {25, Full}}],
           Appearance->None,
           BaselinePosition->Baseline,
           
           ButtonFunction:>OutputSizeLimit`ButtonFunction[
            OutputSizeLimit`Defer, 529, 28415626182954115862, 5/2],
           Enabled->True,
           Evaluator->Automatic,
           Method->"Queued"], 
          ButtonBox[
           PaneSelectorBox[{False->
            StyleBox[
             StyleBox[
              DynamicBox[ToBoxes[
                FEPrivate`FrontEndResource["FEStrings", "sizeShowMore"], 
                StandardForm],
               ImageSizeCache->{68., {0., 10.}}],
              StripOnInput->False,
              DynamicUpdating->True,
              LineSpacing->{1, 2},
              LineIndent->0,
              LinebreakAdjustments->{1., 100, 0, 0, 0}], "OSLControl",
             StripOnInput->False], True->
            StyleBox[
             StyleBox[
              DynamicBox[ToBoxes[
                FEPrivate`FrontEndResource["FEStrings", "sizeShowMore"], 
                StandardForm]],
              StripOnInput->False,
              DynamicUpdating->True,
              LineSpacing->{1, 2},
              LineIndent->0,
              LinebreakAdjustments->{1., 100, 0, 0, 0}], "OSLControlActive",
             StripOnInput->False]}, Dynamic[
             CurrentValue["MouseOver"]],
            Alignment->Center,
            FrameMargins->0,
            ImageSize->{Automatic, {25, Full}}],
           Appearance->None,
           BaselinePosition->Baseline,
           
           ButtonFunction:>OutputSizeLimit`ButtonFunction[
            OutputSizeLimit`Defer, 529, 28415626182954115862, 5 2],
           Enabled->True,
           Evaluator->Automatic,
           Method->"Queued"], 
          ButtonBox[
           PaneSelectorBox[{False->
            StyleBox[
             StyleBox[
              DynamicBox[ToBoxes[
                FEPrivate`FrontEndResource["FEStrings", "sizeShowAll"], 
                StandardForm],
               ImageSizeCache->{51., {0., 10.}}],
              StripOnInput->False,
              DynamicUpdating->True,
              LineSpacing->{1, 2},
              LineIndent->0,
              LinebreakAdjustments->{1., 100, 0, 0, 0}], "OSLControl",
             StripOnInput->False], True->
            StyleBox[
             StyleBox[
              DynamicBox[ToBoxes[
                FEPrivate`FrontEndResource["FEStrings", "sizeShowAll"], 
                StandardForm]],
              StripOnInput->False,
              DynamicUpdating->True,
              LineSpacing->{1, 2},
              LineIndent->0,
              LinebreakAdjustments->{1., 100, 0, 0, 0}], "OSLControlActive",
             StripOnInput->False]}, Dynamic[
             CurrentValue["MouseOver"]],
            Alignment->Center,
            FrameMargins->0,
            ImageSize->{Automatic, {25, Full}}],
           Appearance->None,
           BaselinePosition->Baseline,
           
           ButtonFunction:>OutputSizeLimit`ButtonFunction[
            OutputSizeLimit`Defer, 529, 28415626182954115862, Infinity],
           Enabled->True,
           Evaluator->Automatic,
           Method->"Queued"], 
          ButtonBox[
           PaneSelectorBox[{False->
            StyleBox[
             StyleBox[
              DynamicBox[ToBoxes[
                FEPrivate`FrontEndResource["FEStrings", "sizeChangeLimit"], 
                StandardForm],
               ImageSizeCache->{91., {1., 10.}}],
              StripOnInput->False,
              DynamicUpdating->True,
              LineSpacing->{1, 2},
              LineIndent->0,
              LinebreakAdjustments->{1., 100, 0, 0, 0}], "OSLControl",
             StripOnInput->False], True->
            StyleBox[
             StyleBox[
              DynamicBox[ToBoxes[
                FEPrivate`FrontEndResource["FEStrings", "sizeChangeLimit"], 
                StandardForm]],
              StripOnInput->False,
              DynamicUpdating->True,
              LineSpacing->{1, 2},
              LineIndent->0,
              LinebreakAdjustments->{1., 100, 0, 0, 0}], "OSLControlActive",
             StripOnInput->False]}, Dynamic[
             CurrentValue["MouseOver"]],
            Alignment->Center,
            FrameMargins->0,
            ImageSize->{Automatic, {25, Full}}],
           Appearance->None,
           BaselinePosition->Baseline,
           ButtonFunction:>FrontEndExecute[{
              FrontEnd`SetOptions[
              FrontEnd`$FrontEnd, 
               FrontEnd`PreferencesSettings -> {"Page" -> "Advanced"}], 
              FrontEnd`FrontEndToken["PreferencesDialog"]}],
           Evaluator->None,
           Method->"Preemptive"]}
        },
        AutoDelete->False,
        FrameStyle->GrayLevel[0.85],
        GridBoxDividers->{"Columns" -> {False, {True}}},
        GridBoxItemSize->{"Columns" -> {{Automatic}}, "Rows" -> {{Automatic}}},
        GridBoxSpacings->{"Columns" -> {{2}}}]}
     },
     DefaultBaseStyle->"Column",
     GridBoxAlignment->{"Columns" -> {{Left}}, "Rows" -> {{Baseline}}},
     GridBoxDividers->{"Columns" -> {{False}}, "Rows" -> {{False}}},
     GridBoxItemSize->{"Columns" -> {{Automatic}}, "Rows" -> {{1.}}},
     GridBoxSpacings->{"Columns" -> {
         Offset[0.27999999999999997`], {
          Offset[0.5599999999999999]}, 
         Offset[0.27999999999999997`]}, "Rows" -> {
         Offset[0.2], 
         Offset[1.2], {
          Offset[0.4]}, 
         Offset[0.2]}}],
    BaseStyle->"OutputSizeLimit",
    FrameMargins->{{12, 12}, {0, 15}},
    FrameStyle->GrayLevel[0.85],
    RoundingRadius->5,
    StripOnInput->False],
   Deploy,
   DefaultBaseStyle->"Deploy"],
  If[28415626182954115862 === $SessionID, 
   Out[529], Message[
     MessageName[Syntax, "noinfoker"]]; Missing["NotAvailable"]; 
   Null]]], "Output",
 CellChangeTimes->{3.8787227747222643`*^9, 3.878857370757874*^9},
 CellLabel->
  "Out[529]=",ExpressionUUID->"7dc7ebbe-78e5-4400-9df3-fb3fb51e1e33"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"Coefficient", "[", 
    RowBox[{"ampYMGlueNum3All", ",", 
     RowBox[{
      RowBox[{"dot", "[", 
       RowBox[{
        RowBox[{"p", "[", "1", "]"}], ",", 
        RowBox[{"\[Epsilon]", "[", "2", "]"}]}], "]"}], " ", 
      RowBox[{"dot", "[", 
       RowBox[{
        RowBox[{"p", "[", "1", "]"}], ",", 
        RowBox[{"\[Epsilon]", "[", "3", "]"}]}], "]"}], " ", 
      RowBox[{"dot", "[", 
       RowBox[{
        RowBox[{"v", "[", "1", "]"}], ",", 
        RowBox[{"\[Epsilon]", "[", "1", "]"}]}], "]"}]}]}], "]"}], "-", 
   RowBox[{"Coefficient", "[", 
    RowBox[{"amp5MP", ",", 
     RowBox[{
      RowBox[{"dot", "[", 
       RowBox[{
        RowBox[{"p", "[", "1", "]"}], ",", 
        RowBox[{"\[Epsilon]", "[", "2", "]"}]}], "]"}], " ", 
      RowBox[{"dot", "[", 
       RowBox[{
        RowBox[{"p", "[", "1", "]"}], ",", 
        RowBox[{"\[Epsilon]", "[", "3", "]"}]}], "]"}], " ", 
      RowBox[{"dot", "[", 
       RowBox[{
        RowBox[{"v", "[", "1", "]"}], ",", 
        RowBox[{"\[Epsilon]", "[", "1", "]"}]}], "]"}]}]}], "]"}]}], "//", 
  "Simplify"}]], "Input",
 CellChangeTimes->{{3.8787229053372793`*^9, 3.878722919398128*^9}, {
  3.878722968694376*^9, 3.8787229807412357`*^9}},
 CellLabel->
  "In[530]:=",ExpressionUUID->"6b9786c4-9ebb-423d-8610-cccd7f596856"],

Cell[BoxData[
 RowBox[{"-", 
  FractionBox[
   RowBox[{
    RowBox[{"Cos", "[", 
     RowBox[{"dot", "[", 
      RowBox[{
       RowBox[{"as", "[", "0", "]"}], ",", 
       RowBox[{"p", "[", "1", "]"}]}], "]"}], "]"}], " ", 
    RowBox[{"Sin", "[", 
     RowBox[{"dot", "[", 
      RowBox[{
       RowBox[{"as", "[", "0", "]"}], ",", 
       RowBox[{"p", "[", "2", "]"}]}], "]"}], "]"}], " ", 
    RowBox[{"Sin", "[", 
     RowBox[{"dot", "[", 
      RowBox[{
       RowBox[{"as", "[", "0", "]"}], ",", 
       RowBox[{"p", "[", "3", "]"}]}], "]"}], "]"}]}], 
   RowBox[{"2", " ", 
    RowBox[{"dot", "[", 
     RowBox[{
      RowBox[{"p", "[", "1", "]"}], ",", 
      RowBox[{"p", "[", "2", "]"}]}], "]"}]}]]}]], "Output",
 CellChangeTimes->{{3.878722915113305*^9, 3.878722919833359*^9}, {
   3.878722976984671*^9, 3.8787229812051697`*^9}, 3.8788573707783937`*^9},
 CellLabel->
  "Out[530]=",ExpressionUUID->"d665f120-8afd-48af-a4fa-9ba3bf86d372"]
}, Open  ]],

Cell[BoxData[
 RowBox[{
  RowBox[{"comp", "=", 
   RowBox[{
    RowBox[{"ampYMGlueNum3All", "-", "amp5MP"}], "//", "Expand"}]}], 
  ";"}]], "Input",
 CellChangeTimes->{{3.8787029038785553`*^9, 3.8787029489380074`*^9}, {
  3.8787228301358*^9, 3.878722835701292*^9}},
 CellLabel->
  "In[531]:=",ExpressionUUID->"5d34e45c-569e-4f8d-acd4-594d8ca6243e"],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"comp", "=", 
  RowBox[{
   RowBox[{"comp", "//", "MultivariateApart"}], "//", "Expand"}]}]], "Input",
 CellChangeTimes->{{3.87870298431289*^9, 3.8787029850907087`*^9}, {
  3.878723375744131*^9, 3.8787234378361073`*^9}},
 CellLabel->
  "In[532]:=",ExpressionUUID->"0317257d-2892-402a-a1bd-d1797c9db140"],

Cell[BoxData[
 InterpretationBox[
  TagBox[
   FrameBox[GridBox[{
      {
       ItemBox[
        TagBox[
         RowBox[{
          RowBox[{"-", 
           FractionBox[
            RowBox[{
             RowBox[{"Cos", "[", 
              RowBox[{"dot", "[", 
               RowBox[{
                RowBox[{"as", "[", "0", "]"}], ",", 
                RowBox[{"p", "[", "2", "]"}]}], "]"}], "]"}], " ", 
             RowBox[{"Cos", "[", 
              RowBox[{"dot", "[", 
               RowBox[{
                RowBox[{"as", "[", "0", "]"}], ",", 
                RowBox[{"p", "[", "3", "]"}]}], "]"}], "]"}], " ", 
             RowBox[{"dot", "[", 
              RowBox[{
               RowBox[{"p", "[", "1", "]"}], ",", 
               RowBox[{"\[Epsilon]", "[", "3", "]"}]}], "]"}], " ", 
             RowBox[{"dot", "[", 
              RowBox[{
               RowBox[{"\[Epsilon]", "[", "1", "]"}], ",", 
               TemplateBox[{"1"},
                "OutputSizeLimit`Skeleton"]}], "]"}], " ", 
             RowBox[{"dot", "[", 
              RowBox[{
               RowBox[{"p", "[", "1", "]"}], ",", 
               RowBox[{"S", "[", "0", "]"}], ",", 
               RowBox[{"p", "[", "2", "]"}]}], "]"}], " ", 
             RowBox[{"Sin", "[", 
              RowBox[{"dot", "[", 
               RowBox[{
                RowBox[{"as", "[", "0", "]"}], ",", 
                RowBox[{"p", "[", "1", "]"}]}], "]"}], "]"}]}], 
            RowBox[{"2", " ", 
             RowBox[{"(", 
              RowBox[{
               RowBox[{"dot", "[", 
                RowBox[{
                 RowBox[{"as", "[", "0", "]"}], ",", 
                 RowBox[{"p", "[", "1", "]"}]}], "]"}], "+", 
               RowBox[{"dot", "[", 
                RowBox[{
                 RowBox[{"as", "[", "0", "]"}], ",", 
                 RowBox[{"p", "[", "2", "]"}]}], "]"}]}], ")"}], " ", 
             RowBox[{"dot", "[", 
              RowBox[{
               RowBox[{"p", "[", "1", "]"}], ",", 
               RowBox[{"p", "[", "2", "]"}]}], "]"}]}]]}], "+", 
          TemplateBox[{"725"},
           "OutputSizeLimit`Skeleton"]}],
         Short[#, 5]& ],
        BaseStyle->{Deployed -> False},
        StripOnInput->False]},
      {GridBox[{
         {
          PaneBox[
           TagBox[
            TooltipBox[
             StyleBox[
              StyleBox[
               DynamicBox[ToBoxes[
                 FEPrivate`FrontEndResource[
                 "FEStrings", "sizeBriefExplanation"], StandardForm],
                ImageSizeCache->{70., {3., 10.}}],
               StripOnInput->False,
               DynamicUpdating->True,
               LineSpacing->{1, 2},
               LineIndent->0,
               LinebreakAdjustments->{1., 100, 0, 0, 0}], "OSLText",
              StripOnInput->False],
             StyleBox[
              DynamicBox[
               ToBoxes[
                FEPrivate`FrontEndResource["FEStrings", "sizeExplanation"], 
                StandardForm]], DynamicUpdating -> True, LineIndent -> 0, 
              LinebreakAdjustments -> {1., 100, 0, 0, 0}, 
              LineSpacing -> {1, 2}, StripOnInput -> False]],
            Annotation[#, 
             Style[
              Dynamic[
               FEPrivate`FrontEndResource["FEStrings", "sizeExplanation"]], 
              DynamicUpdating -> True, LineIndent -> 0, 
              LinebreakAdjustments -> {1., 100, 0, 0, 0}, 
              LineSpacing -> {1, 2}], "Tooltip"]& ],
           Alignment->Center,
           BaselinePosition->Baseline,
           ImageSize->{Automatic, {25, Full}}], 
          ButtonBox[
           PaneSelectorBox[{False->
            StyleBox[
             StyleBox[
              DynamicBox[ToBoxes[
                FEPrivate`FrontEndResource["FEStrings", "sizeShowLess"], 
                StandardForm],
               ImageSizeCache->{61., {0., 10.}}],
              StripOnInput->False,
              DynamicUpdating->True,
              LineSpacing->{1, 2},
              LineIndent->0,
              LinebreakAdjustments->{1., 100, 0, 0, 0}], "OSLControl",
             StripOnInput->False], True->
            StyleBox[
             StyleBox[
              DynamicBox[ToBoxes[
                FEPrivate`FrontEndResource["FEStrings", "sizeShowLess"], 
                StandardForm]],
              StripOnInput->False,
              DynamicUpdating->True,
              LineSpacing->{1, 2},
              LineIndent->0,
              LinebreakAdjustments->{1., 100, 0, 0, 0}], "OSLControlActive",
             StripOnInput->False]}, Dynamic[
             CurrentValue["MouseOver"]],
            Alignment->Center,
            FrameMargins->0,
            ImageSize->{Automatic, {25, Full}}],
           Appearance->None,
           BaselinePosition->Baseline,
           
           ButtonFunction:>OutputSizeLimit`ButtonFunction[
            OutputSizeLimit`Defer, 532, 28415626182954115862, 5/2],
           Enabled->True,
           Evaluator->Automatic,
           Method->"Queued"], 
          ButtonBox[
           PaneSelectorBox[{False->
            StyleBox[
             StyleBox[
              DynamicBox[ToBoxes[
                FEPrivate`FrontEndResource["FEStrings", "sizeShowMore"], 
                StandardForm],
               ImageSizeCache->{68., {0., 10.}}],
              StripOnInput->False,
              DynamicUpdating->True,
              LineSpacing->{1, 2},
              LineIndent->0,
              LinebreakAdjustments->{1., 100, 0, 0, 0}], "OSLControl",
             StripOnInput->False], True->
            StyleBox[
             StyleBox[
              DynamicBox[ToBoxes[
                FEPrivate`FrontEndResource["FEStrings", "sizeShowMore"], 
                StandardForm]],
              StripOnInput->False,
              DynamicUpdating->True,
              LineSpacing->{1, 2},
              LineIndent->0,
              LinebreakAdjustments->{1., 100, 0, 0, 0}], "OSLControlActive",
             StripOnInput->False]}, Dynamic[
             CurrentValue["MouseOver"]],
            Alignment->Center,
            FrameMargins->0,
            ImageSize->{Automatic, {25, Full}}],
           Appearance->None,
           BaselinePosition->Baseline,
           
           ButtonFunction:>OutputSizeLimit`ButtonFunction[
            OutputSizeLimit`Defer, 532, 28415626182954115862, 5 2],
           Enabled->True,
           Evaluator->Automatic,
           Method->"Queued"], 
          ButtonBox[
           PaneSelectorBox[{False->
            StyleBox[
             StyleBox[
              DynamicBox[ToBoxes[
                FEPrivate`FrontEndResource["FEStrings", "sizeShowAll"], 
                StandardForm],
               ImageSizeCache->{51., {0., 10.}}],
              StripOnInput->False,
              DynamicUpdating->True,
              LineSpacing->{1, 2},
              LineIndent->0,
              LinebreakAdjustments->{1., 100, 0, 0, 0}], "OSLControl",
             StripOnInput->False], True->
            StyleBox[
             StyleBox[
              DynamicBox[ToBoxes[
                FEPrivate`FrontEndResource["FEStrings", "sizeShowAll"], 
                StandardForm]],
              StripOnInput->False,
              DynamicUpdating->True,
              LineSpacing->{1, 2},
              LineIndent->0,
              LinebreakAdjustments->{1., 100, 0, 0, 0}], "OSLControlActive",
             StripOnInput->False]}, Dynamic[
             CurrentValue["MouseOver"]],
            Alignment->Center,
            FrameMargins->0,
            ImageSize->{Automatic, {25, Full}}],
           Appearance->None,
           BaselinePosition->Baseline,
           
           ButtonFunction:>OutputSizeLimit`ButtonFunction[
            OutputSizeLimit`Defer, 532, 28415626182954115862, Infinity],
           Enabled->True,
           Evaluator->Automatic,
           Method->"Queued"], 
          ButtonBox[
           PaneSelectorBox[{False->
            StyleBox[
             StyleBox[
              DynamicBox[ToBoxes[
                FEPrivate`FrontEndResource["FEStrings", "sizeChangeLimit"], 
                StandardForm],
               ImageSizeCache->{91., {1., 10.}}],
              StripOnInput->False,
              DynamicUpdating->True,
              LineSpacing->{1, 2},
              LineIndent->0,
              LinebreakAdjustments->{1., 100, 0, 0, 0}], "OSLControl",
             StripOnInput->False], True->
            StyleBox[
             StyleBox[
              DynamicBox[ToBoxes[
                FEPrivate`FrontEndResource["FEStrings", "sizeChangeLimit"], 
                StandardForm]],
              StripOnInput->False,
              DynamicUpdating->True,
              LineSpacing->{1, 2},
              LineIndent->0,
              LinebreakAdjustments->{1., 100, 0, 0, 0}], "OSLControlActive",
             StripOnInput->False]}, Dynamic[
             CurrentValue["MouseOver"]],
            Alignment->Center,
            FrameMargins->0,
            ImageSize->{Automatic, {25, Full}}],
           Appearance->None,
           BaselinePosition->Baseline,
           ButtonFunction:>FrontEndExecute[{
              FrontEnd`SetOptions[
              FrontEnd`$FrontEnd, 
               FrontEnd`PreferencesSettings -> {"Page" -> "Advanced"}], 
              FrontEnd`FrontEndToken["PreferencesDialog"]}],
           Evaluator->None,
           Method->"Preemptive"]}
        },
        AutoDelete->False,
        FrameStyle->GrayLevel[0.85],
        GridBoxDividers->{"Columns" -> {False, {True}}},
        GridBoxItemSize->{"Columns" -> {{Automatic}}, "Rows" -> {{Automatic}}},
        GridBoxSpacings->{"Columns" -> {{2}}}]}
     },
     DefaultBaseStyle->"Column",
     GridBoxAlignment->{"Columns" -> {{Left}}, "Rows" -> {{Baseline}}},
     GridBoxDividers->{"Columns" -> {{False}}, "Rows" -> {{False}}},
     GridBoxItemSize->{"Columns" -> {{Automatic}}, "Rows" -> {{1.}}},
     GridBoxSpacings->{"Columns" -> {
         Offset[0.27999999999999997`], {
          Offset[0.5599999999999999]}, 
         Offset[0.27999999999999997`]}, "Rows" -> {
         Offset[0.2], 
         Offset[1.2], {
          Offset[0.4]}, 
         Offset[0.2]}}],
    BaseStyle->"OutputSizeLimit",
    FrameMargins->{{12, 12}, {0, 15}},
    FrameStyle->GrayLevel[0.85],
    RoundingRadius->5,
    StripOnInput->False],
   Deploy,
   DefaultBaseStyle->"Deploy"],
  If[28415626182954115862 === $SessionID, 
   Out[532], Message[
     MessageName[Syntax, "noinfoker"]]; Missing["NotAvailable"]; 
   Null]]], "Output",
 CellChangeTimes->{
  3.878702985495623*^9, {3.878722832894087*^9, 3.8787228380274563`*^9}, 
   3.8787230473260403`*^9, {3.878723371578919*^9, 3.878723414969499*^9}, 
   3.8787234460051517`*^9, 3.878788244870784*^9, 3.878799323151148*^9, 
   3.8788573777561007`*^9},
 CellLabel->
  "Out[532]=",ExpressionUUID->"93e06826-70b2-4ba2-a214-394b34f9a067"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"%", "//", "Length"}]], "Input",
 CellChangeTimes->{{3.878723418056542*^9, 3.8787234199425497`*^9}},
 CellLabel->
  "In[533]:=",ExpressionUUID->"749edf06-701f-4d04-b9fd-ddd447d70588"],

Cell[BoxData["474"], "Output",
 CellChangeTimes->{3.878723420419847*^9, 3.8787882463703823`*^9, 
  3.878857377802783*^9},
 CellLabel->
  "Out[533]=",ExpressionUUID->"82da61a3-72a2-4427-b47a-d1d004c4b20e"]
}, Open  ]],

Cell[BoxData[{
 RowBox[{
  RowBox[{"monolist", "=", 
   RowBox[{
    RowBox[{
     RowBox[{
      RowBox[{"(", 
       RowBox[{"List", "@@", "comp"}], ")"}], "/.", 
      RowBox[{"{", 
       RowBox[{
        RowBox[{
         RowBox[{"Cos", "[", "_", "]"}], ":>", "1"}], ",", 
        RowBox[{
         RowBox[{"Sin", "[", "_", "]"}], ":>", "1"}], ",", 
        RowBox[{
         RowBox[{"dot", "[", 
          RowBox[{
           RowBox[{"p", "[", "i_", "]"}], ",", 
           RowBox[{"p", "[", "j_", "]"}]}], "]"}], ":>", "1"}], ",", 
        RowBox[{
         RowBox[{"dot", "[", 
          RowBox[{
           RowBox[{"as", "[", "0", "]"}], ",", 
           RowBox[{"p", "[", "j_", "]"}]}], "]"}], ":>", "1"}], ",", 
        RowBox[{
         RowBox[{"dot", "[", 
          RowBox[{
           RowBox[{"p", "[", "j_", "]"}], ",", 
           RowBox[{"v", "[", "1", "]"}]}], "]"}], ":>", "1"}], ",", 
        RowBox[{
         RowBox[{"dot", "[", 
          RowBox[{
           RowBox[{"p", "[", "i_", "]"}], ",", 
           RowBox[{"S", "[", "0", "]"}], ",", 
           RowBox[{"p", "[", "j_", "]"}]}], "]"}], ":>", "1"}]}], "}"}]}], "/.", 
     RowBox[{
      RowBox[{"a_", " ", "b_"}], ":>", 
      RowBox[{"b", "/;", 
       RowBox[{"NumberQ", "[", "a", "]"}]}]}]}], "//", "Union"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{"Monitor", "[", 
  RowBox[{
   RowBox[{
    RowBox[{"compList", "=", 
     RowBox[{"Table", "[", 
      RowBox[{
       RowBox[{
        RowBox[{"Coefficient", "[", 
         RowBox[{"comp", ",", 
          RowBox[{"monolist", "[", 
           RowBox[{"[", "ii", "]"}], "]"}]}], " ", "]"}], "//", "Simplify"}], 
       ",", 
       RowBox[{"{", 
        RowBox[{"ii", ",", 
         RowBox[{"Length", "@", "monolist"}]}], "}"}]}], "]"}]}], ";"}], ",", 
   "ii"}], "]"}]}], "Input",
 CellChangeTimes->{{3.8787012894982977`*^9, 3.8787014093315563`*^9}, {
   3.878703008278679*^9, 3.878703053664806*^9}, {3.8787056556538677`*^9, 
   3.8787056573533163`*^9}, {3.878723280277577*^9, 3.878723280978876*^9}, {
   3.8787869044043903`*^9, 3.8787869512124777`*^9}, {3.878787266742914*^9, 
   3.878787275923469*^9}, {3.878788006357905*^9, 3.878788008174883*^9}, {
   3.878788095966639*^9, 3.878788129877042*^9}, 3.878788169030889*^9},
 CellLabel->
  "In[534]:=",ExpressionUUID->"15a0e029-6da8-4843-9d34-c7faae7bfe30"],

Cell[BoxData[
 RowBox[{
  RowBox[{"comp123Fin", "=", 
   RowBox[{
    RowBox[{"(", 
     RowBox[{"compList", "//", "TrigExpand"}], ")"}], ".", "monolist"}]}], 
  ";"}]], "Input",
 CellChangeTimes->{{3.8787992530075417`*^9, 3.8787992550631742`*^9}, {
  3.8787992988301573`*^9, 3.878799302255559*^9}},
 CellLabel->
  "In[537]:=",ExpressionUUID->"9cfb7421-e340-4b15-b494-8ec952a07cb3"],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  RowBox[{"comp123Fin", "-", "comp"}], "//", "Simplify"}]], "Input",
 CellChangeTimes->{{3.8787879102305813`*^9, 3.8787879133956747`*^9}, 
   3.8787994221486683`*^9},
 CellLabel->
  "In[538]:=",ExpressionUUID->"9050bad1-b893-46c5-9fc4-6086dfd94f38"],

Cell[BoxData["0"], "Output",
 CellChangeTimes->{
  3.878787934991246*^9, {3.878788160948453*^9, 3.878788187812676*^9}, 
   3.878788262808463*^9, 3.8787883106519947`*^9, 3.878799392656546*^9, 
   3.8787994309550037`*^9, {3.8788574495132627`*^9, 3.878857470540236*^9}},
 CellLabel->
  "Out[538]=",ExpressionUUID->"6cc8eecd-6550-4f9c-8e8b-12758d7bb225"]
}, Open  ]],

Cell[BoxData[{
 RowBox[{
  RowBox[{"comp123", "=", 
   RowBox[{"compList", ".", "monolist"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"comp132", "=", 
   RowBox[{"comp123", "/.", 
    RowBox[{"{", 
     RowBox[{
      RowBox[{
       RowBox[{"a_", "[", "2", "]"}], ":>", 
       RowBox[{
        RowBox[{"a", "[", "3", "]"}], "/;", 
        RowBox[{"MemberQ", "[", 
         RowBox[{
          RowBox[{"{", 
           RowBox[{"p", ",", "\[Epsilon]"}], "}"}], ",", "a"}], "]"}]}]}], 
      ",", 
      RowBox[{
       RowBox[{"a_", "[", "3", "]"}], ":>", 
       RowBox[{
        RowBox[{"a", "[", "2", "]"}], "/;", 
        RowBox[{"MemberQ", "[", 
         RowBox[{
          RowBox[{"{", 
           RowBox[{"p", ",", "\[Epsilon]"}], "}"}], ",", "a"}], "]"}]}]}]}], 
     "}"}]}]}], ";"}]}], "Input",
 CellChangeTimes->{{3.8787051145137377`*^9, 3.878705137026246*^9}, {
   3.8787051688959503`*^9, 3.8787052524705544`*^9}, 3.87870537050359*^9, {
   3.878705630911879*^9, 3.878705633057987*^9}},
 CellLabel->
  "In[539]:=",ExpressionUUID->"bc99f2ae-3bf2-432e-804a-db814f570b4c"],

Cell[BoxData[
 RowBox[{
  RowBox[{"compNum", "=", 
   RowBox[{
    RowBox[{
     RowBox[{
      RowBox[{"KLTRM", "[", "4", "]"}], ".", 
      RowBox[{"{", 
       RowBox[{"comp123", ",", "comp132"}], "}"}]}], "/.", "dotRules"}], "//",
     "Expand"}]}], ";"}]], "Input",
 CellChangeTimes->{{3.878705070929925*^9, 3.878705078595332*^9}, {
   3.878705381839171*^9, 3.878705393377473*^9}, {3.87870544879313*^9, 
   3.8787054921194153`*^9}, {3.8787055282308607`*^9, 3.878705531291622*^9}, {
   3.878705760358881*^9, 3.878705772051448*^9}, 3.878707838118861*^9},
 CellLabel->
  "In[541]:=",ExpressionUUID->"088850b9-180b-4cf5-aed2-4d18204036d4"],

Cell[BoxData[
 RowBox[{
  RowBox[{"monolist", "=", 
   RowBox[{
    RowBox[{
     RowBox[{
      RowBox[{"(", 
       RowBox[{"List", "@@", "compNum"}], ")"}], "/.", 
      RowBox[{"{", 
       RowBox[{
        RowBox[{
         RowBox[{"Cos", "[", "_", "]"}], ":>", "1"}], ",", 
        RowBox[{
         RowBox[{"Sin", "[", "_", "]"}], ":>", "1"}], ",", 
        RowBox[{
         RowBox[{"dot", "[", 
          RowBox[{
           RowBox[{"p", "[", "i_", "]"}], ",", 
           RowBox[{"p", "[", "j_", "]"}]}], "]"}], ":>", "1"}], ",", 
        RowBox[{
         RowBox[{"dot", "[", 
          RowBox[{
           RowBox[{"as", "[", "0", "]"}], ",", 
           RowBox[{"p", "[", "j_", "]"}]}], "]"}], ":>", "1"}], ",", 
        RowBox[{
         RowBox[{"dot", "[", 
          RowBox[{
           RowBox[{"p", "[", "i_", "]"}], ",", 
           RowBox[{"v", "[", "1", "]"}]}], "]"}], ":>", "1"}], ",", 
        RowBox[{
         RowBox[{"dot", "[", 
          RowBox[{
           RowBox[{"p", "[", "i_", "]"}], ",", 
           RowBox[{"S", "[", "0", "]"}], ",", 
           RowBox[{"p", "[", "j_", "]"}]}], "]"}], ":>", "1"}]}], "}"}]}], "/.", 
     RowBox[{
      RowBox[{"a_", " ", "b_"}], ":>", 
      RowBox[{"b", "/;", 
       RowBox[{"NumberQ", "[", "a", "]"}]}]}]}], "//", "Union"}]}], 
  ";"}]], "Input",
 CellChangeTimes->{
  3.8787054997139378`*^9, {3.878705579852995*^9, 3.878705592080867*^9}, {
   3.878788466569723*^9, 3.8787884670115623`*^9}},
 CellLabel->
  "In[542]:=",ExpressionUUID->"5dde73f0-39ab-49e3-bad0-96c98e206706"],

Cell[BoxData[
 RowBox[{"Monitor", "[", 
  RowBox[{
   RowBox[{
    RowBox[{"compNumM", "=", 
     RowBox[{"Table", "[", 
      RowBox[{
       RowBox[{
        RowBox[{"Coefficient", "[", 
         RowBox[{"compNum", ",", 
          RowBox[{"monolist", "[", 
           RowBox[{"[", "ii", "]"}], "]"}]}], "]"}], "//", "Simplify"}], ",", 
       
       RowBox[{"{", 
        RowBox[{"ii", ",", 
         RowBox[{"Length", "@", "monolist"}]}], "}"}]}], "]"}]}], ";"}], ",", 
   "ii"}], "]"}]], "Input",
 CellChangeTimes->{{3.878705703118355*^9, 3.87870574167025*^9}, {
  3.878705784517427*^9, 3.878705794276873*^9}, {3.8787078787341347`*^9, 
  3.878707906438087*^9}, {3.878707941534721*^9, 3.878707960791316*^9}, {
  3.878707998364543*^9, 3.878708013914988*^9}, {3.878708064525256*^9, 
  3.8787081456325502`*^9}},
 CellLabel->
  "In[543]:=",ExpressionUUID->"9301f697-2445-468b-88d1-13b36d72d96b"],

Cell[BoxData[
 RowBox[{
  RowBox[{"compNumM", "=", 
   RowBox[{
    RowBox[{"compNumM", "/.", 
     RowBox[{"(", 
      RowBox[{
       RowBox[{
        RowBox[{"dot", "[", 
         RowBox[{
          RowBox[{"p", "[", "1", "]"}], ",", 
          RowBox[{"p", "[", "2", "]"}]}], "]"}], "+", 
        RowBox[{"dot", "[", 
         RowBox[{
          RowBox[{"p", "[", "2", "]"}], ",", 
          RowBox[{"p", "[", "3", "]"}]}], "]"}], "+", 
        RowBox[{"dot", "[", 
         RowBox[{
          RowBox[{"p", "[", "1", "]"}], ",", 
          RowBox[{"p", "[", "3", "]"}]}], "]"}]}], "->", "1"}], ")"}]}], "//",
     "TrigExpand"}]}], ";"}]], "Input",
 CellChangeTimes->{{3.878788835587281*^9, 3.878788874954924*^9}, {
  3.878788914778901*^9, 3.878788916559821*^9}},
 CellLabel->
  "In[544]:=",ExpressionUUID->"d9d562f1-f084-47bc-9426-757ccc080084"],

Cell[BoxData[
 RowBox[{
  RowBox[{"ansatz", "=", 
   RowBox[{
    RowBox[{"compNumM", ".", 
     RowBox[{"(", "monolist", ")"}]}], "//", "Expand"}]}], ";"}]], "Input",
 CellChangeTimes->{{3.878788554445382*^9, 3.878788555598119*^9}, {
  3.878788597534554*^9, 3.878788600010933*^9}, {3.8787887820371637`*^9, 
  3.878788797381784*^9}, {3.878788907554871*^9, 3.87878891122479*^9}},
 CellLabel->
  "In[545]:=",ExpressionUUID->"d4379b8c-a066-4777-afdb-5aad9e5c8f1e"],

Cell[CellGroupData[{

Cell[BoxData["ansatz"], "Input",
 CellLabel->
  "In[581]:=",ExpressionUUID->"0b6f713f-3c22-49f0-bcf3-0232f40d0e55"],

Cell[BoxData[
 InterpretationBox[
  TagBox[
   FrameBox[GridBox[{
      {
       ItemBox[
        TagBox[
         RowBox[{
          RowBox[{"-", 
           RowBox[{"(", 
            RowBox[{
             RowBox[{"(", 
              RowBox[{"2", " ", 
               RowBox[{"Cos", "[", 
                RowBox[{"dot", "[", 
                 RowBox[{
                  RowBox[{"as", "[", "0", "]"}], ",", 
                  RowBox[{"p", "[", "2", "]"}]}], "]"}], "]"}], " ", 
               RowBox[{"Cos", "[", 
                RowBox[{"dot", "[", 
                 RowBox[{
                  RowBox[{"as", "[", "0", "]"}], ",", 
                  RowBox[{"p", "[", "3", "]"}]}], "]"}], "]"}], " ", 
               RowBox[{"dot", "[", 
                RowBox[{
                 RowBox[{"as", "[", "0", "]"}], ",", 
                 RowBox[{"p", "[", "3", "]"}]}], "]"}], " ", 
               RowBox[{"dot", "[", 
                RowBox[{
                 RowBox[{"p", "[", "1", "]"}], ",", 
                 RowBox[{"\[Epsilon]", "[", "3", "]"}]}], "]"}], " ", 
               RowBox[{"dot", "[", 
                RowBox[{
                 RowBox[{"\[Epsilon]", "[", "1", "]"}], ",", 
                 RowBox[{"\[Epsilon]", "[", "2", "]"}]}], "]"}], " ", 
               RowBox[{"dot", "[", 
                RowBox[{
                 RowBox[{"p", "[", "1", "]"}], ",", 
                 RowBox[{"S", "[", "0", "]"}], ",", 
                 RowBox[{"p", "[", "2", "]"}]}], "]"}], " ", 
               RowBox[{"Sin", "[", 
                RowBox[{"dot", "[", 
                 RowBox[{
                  RowBox[{"as", "[", "0", "]"}], ",", 
                  RowBox[{"p", "[", "1", "]"}]}], "]"}], "]"}]}], ")"}], "/", 
             
             RowBox[{"(", 
              RowBox[{
               RowBox[{"(", 
                RowBox[{
                 RowBox[{"dot", "[", 
                  RowBox[{
                   RowBox[{"as", "[", "0", "]"}], ",", 
                   RowBox[{"p", "[", "1", "]"}]}], "]"}], "+", 
                 RowBox[{"dot", "[", 
                  RowBox[{
                   RowBox[{"as", "[", "0", "]"}], ",", 
                   RowBox[{"p", "[", "2", "]"}]}], "]"}]}], ")"}], " ", 
               RowBox[{"(", 
                RowBox[{
                 RowBox[{"dot", "[", 
                  RowBox[{
                   RowBox[{"as", "[", "0", "]"}], ",", 
                   RowBox[{"p", "[", "1", "]"}]}], "]"}], "+", 
                 RowBox[{"dot", "[", 
                  RowBox[{
                   RowBox[{"as", "[", "0", "]"}], ",", 
                   RowBox[{"p", "[", "2", "]"}]}], "]"}], "+", 
                 RowBox[{"dot", "[", 
                  RowBox[{
                   RowBox[{"as", "[", "0", "]"}], ",", 
                   RowBox[{"p", "[", "3", "]"}]}], "]"}]}], ")"}]}], ")"}]}], 
            ")"}]}], "-", 
          FractionBox[
           RowBox[{"2", " ", 
            RowBox[{"Cos", "[", 
             RowBox[{"dot", "[", 
              RowBox[{
               RowBox[{"as", "[", "0", "]"}], ",", 
               RowBox[{"p", "[", "2", "]"}]}], "]"}], "]"}], " ", 
            TemplateBox[{"5"},
             "OutputSizeLimit`Skeleton"], " ", 
            RowBox[{"dot", "[", 
             RowBox[{
              RowBox[{"p", "[", "1", "]"}], ",", 
              RowBox[{"S", "[", "0", "]"}], ",", 
              RowBox[{"p", "[", "2", "]"}]}], "]"}], " ", 
            RowBox[{"Sin", "[", 
             RowBox[{"dot", "[", 
              RowBox[{
               RowBox[{"as", "[", "0", "]"}], ",", 
               RowBox[{"p", "[", "1", "]"}]}], "]"}], "]"}]}], 
           RowBox[{
            RowBox[{"(", 
             RowBox[{
              RowBox[{"dot", "[", 
               RowBox[{
                RowBox[{"as", "[", "0", "]"}], ",", 
                RowBox[{"p", "[", "1", "]"}]}], "]"}], "+", 
              RowBox[{"dot", "[", 
               RowBox[{
                RowBox[{"as", "[", "0", "]"}], ",", 
                RowBox[{"p", "[", "2", "]"}]}], "]"}]}], ")"}], " ", 
            RowBox[{"(", 
             TemplateBox[{"1"},
              "OutputSizeLimit`Skeleton"], ")"}], " ", 
            RowBox[{"(", 
             RowBox[{
              RowBox[{"dot", "[", 
               RowBox[{
                RowBox[{"p", "[", "1", "]"}], ",", 
                RowBox[{"p", "[", "2", "]"}]}], "]"}], "+", 
              RowBox[{"dot", "[", 
               RowBox[{
                TemplateBox[{"1"},
                 "OutputSizeLimit`Skeleton"], ",", 
                TemplateBox[{"1"},
                 "OutputSizeLimit`Skeleton"]}], "]"}]}], ")"}]}]], "+", 
          TemplateBox[{"756"},
           "OutputSizeLimit`Skeleton"], "+", 
          FractionBox[
           TemplateBox[{"1"},
            "OutputSizeLimit`Skeleton"], 
           TemplateBox[{"1"},
            "OutputSizeLimit`Skeleton"]], "-", 
          FractionBox[
           RowBox[{"2", " ", 
            RowBox[{"dot", "[", 
             RowBox[{
              RowBox[{"p", "[", "1", "]"}], ",", 
              RowBox[{"p", "[", "3", "]"}]}], "]"}], " ", 
            RowBox[{"dot", "[", 
             RowBox[{
              RowBox[{"\[Epsilon]", "[", "1", "]"}], ",", 
              RowBox[{"\[Epsilon]", "[", "2", "]"}]}], "]"}], " ", 
            RowBox[{"dot", "[", 
             RowBox[{
              RowBox[{"p", "[", "3", "]"}], ",", 
              RowBox[{"S", "[", "0", "]"}], ",", 
              RowBox[{"\[Epsilon]", "[", "3", "]"}]}], "]"}], " ", 
            RowBox[{"Sin", "[", 
             RowBox[{"dot", "[", 
              RowBox[{
               RowBox[{"as", "[", "0", "]"}], ",", 
               RowBox[{"p", "[", "1", "]"}]}], "]"}], "]"}], " ", 
            RowBox[{"Sin", "[", 
             RowBox[{"dot", "[", 
              RowBox[{
               RowBox[{"as", "[", "0", "]"}], ",", 
               RowBox[{"p", "[", "2", "]"}]}], "]"}], "]"}], " ", 
            RowBox[{"Sin", "[", 
             RowBox[{"dot", "[", 
              RowBox[{
               RowBox[{"as", "[", "0", "]"}], ",", 
               RowBox[{"p", "[", "3", "]"}]}], "]"}], "]"}]}], 
           RowBox[{
            RowBox[{"dot", "[", 
             RowBox[{
              RowBox[{"as", "[", "0", "]"}], ",", 
              RowBox[{"p", "[", "1", "]"}]}], "]"}], "+", 
            RowBox[{"dot", "[", 
             RowBox[{
              RowBox[{"as", "[", "0", "]"}], ",", 
              RowBox[{"p", "[", "2", "]"}]}], "]"}], "+", 
            RowBox[{"dot", "[", 
             RowBox[{
              RowBox[{"as", "[", "0", "]"}], ",", 
              RowBox[{"p", "[", "3", "]"}]}], "]"}]}]]}],
         Short[#, 10]& ],
        BaseStyle->{Deployed -> False},
        StripOnInput->False]},
      {GridBox[{
         {
          PaneBox[
           TagBox[
            TooltipBox[
             StyleBox[
              StyleBox[
               DynamicBox[ToBoxes[
                 FEPrivate`FrontEndResource[
                 "FEStrings", "sizeBriefExplanation"], StandardForm],
                ImageSizeCache->{70., {3., 10.}}],
               StripOnInput->False,
               DynamicUpdating->True,
               LineSpacing->{1, 2},
               LineIndent->0,
               LinebreakAdjustments->{1., 100, 0, 0, 0}], "OSLText",
              StripOnInput->False],
             StyleBox[
              DynamicBox[
               ToBoxes[
                FEPrivate`FrontEndResource["FEStrings", "sizeExplanation"], 
                StandardForm]], DynamicUpdating -> True, LineIndent -> 0, 
              LinebreakAdjustments -> {1., 100, 0, 0, 0}, 
              LineSpacing -> {1, 2}, StripOnInput -> False]],
            Annotation[#, 
             Style[
              Dynamic[
               FEPrivate`FrontEndResource["FEStrings", "sizeExplanation"]], 
              DynamicUpdating -> True, LineIndent -> 0, 
              LinebreakAdjustments -> {1., 100, 0, 0, 0}, 
              LineSpacing -> {1, 2}], "Tooltip"]& ],
           Alignment->Center,
           BaselinePosition->Baseline,
           ImageSize->{Automatic, {25, Full}}], 
          ButtonBox[
           PaneSelectorBox[{False->
            StyleBox[
             StyleBox[
              DynamicBox[ToBoxes[
                FEPrivate`FrontEndResource["FEStrings", "sizeShowLess"], 
                StandardForm],
               ImageSizeCache->{61., {0., 10.}}],
              StripOnInput->False,
              DynamicUpdating->True,
              LineSpacing->{1, 2},
              LineIndent->0,
              LinebreakAdjustments->{1., 100, 0, 0, 0}], "OSLControl",
             StripOnInput->False], True->
            StyleBox[
             StyleBox[
              DynamicBox[ToBoxes[
                FEPrivate`FrontEndResource["FEStrings", "sizeShowLess"], 
                StandardForm]],
              StripOnInput->False,
              DynamicUpdating->True,
              LineSpacing->{1, 2},
              LineIndent->0,
              LinebreakAdjustments->{1., 100, 0, 0, 0}], "OSLControlActive",
             StripOnInput->False]}, Dynamic[
             CurrentValue["MouseOver"]],
            Alignment->Center,
            FrameMargins->0,
            ImageSize->{Automatic, {25, Full}}],
           Appearance->None,
           BaselinePosition->Baseline,
           
           ButtonFunction:>OutputSizeLimit`ButtonFunction[
            OutputSizeLimit`Defer, 581, 28415626182954115862, 10/2],
           Enabled->True,
           Evaluator->Automatic,
           Method->"Queued"], 
          ButtonBox[
           PaneSelectorBox[{False->
            StyleBox[
             StyleBox[
              DynamicBox[ToBoxes[
                FEPrivate`FrontEndResource["FEStrings", "sizeShowMore"], 
                StandardForm],
               ImageSizeCache->{68., {0., 10.}}],
              StripOnInput->False,
              DynamicUpdating->True,
              LineSpacing->{1, 2},
              LineIndent->0,
              LinebreakAdjustments->{1., 100, 0, 0, 0}], "OSLControl",
             StripOnInput->False], True->
            StyleBox[
             StyleBox[
              DynamicBox[ToBoxes[
                FEPrivate`FrontEndResource["FEStrings", "sizeShowMore"], 
                StandardForm],
               ImageSizeCache->{68., {0., 10.}}],
              StripOnInput->False,
              DynamicUpdating->True,
              LineSpacing->{1, 2},
              LineIndent->0,
              LinebreakAdjustments->{1., 100, 0, 0, 0}], "OSLControlActive",
             StripOnInput->False]}, Dynamic[
             CurrentValue["MouseOver"]],
            Alignment->Center,
            FrameMargins->0,
            ImageSize->{Automatic, {25, Full}}],
           Appearance->None,
           BaselinePosition->Baseline,
           
           ButtonFunction:>OutputSizeLimit`ButtonFunction[
            OutputSizeLimit`Defer, 581, 28415626182954115862, 10 2],
           Enabled->True,
           Evaluator->Automatic,
           Method->"Queued"], 
          ButtonBox[
           PaneSelectorBox[{False->
            StyleBox[
             StyleBox[
              DynamicBox[ToBoxes[
                FEPrivate`FrontEndResource["FEStrings", "sizeShowAll"], 
                StandardForm],
               ImageSizeCache->{51., {0., 10.}}],
              StripOnInput->False,
              DynamicUpdating->True,
              LineSpacing->{1, 2},
              LineIndent->0,
              LinebreakAdjustments->{1., 100, 0, 0, 0}], "OSLControl",
             StripOnInput->False], True->
            StyleBox[
             StyleBox[
              DynamicBox[ToBoxes[
                FEPrivate`FrontEndResource["FEStrings", "sizeShowAll"], 
                StandardForm]],
              StripOnInput->False,
              DynamicUpdating->True,
              LineSpacing->{1, 2},
              LineIndent->0,
              LinebreakAdjustments->{1., 100, 0, 0, 0}], "OSLControlActive",
             StripOnInput->False]}, Dynamic[
             CurrentValue["MouseOver"]],
            Alignment->Center,
            FrameMargins->0,
            ImageSize->{Automatic, {25, Full}}],
           Appearance->None,
           BaselinePosition->Baseline,
           
           ButtonFunction:>OutputSizeLimit`ButtonFunction[
            OutputSizeLimit`Defer, 581, 28415626182954115862, Infinity],
           Enabled->True,
           Evaluator->Automatic,
           Method->"Queued"], 
          ButtonBox[
           PaneSelectorBox[{False->
            StyleBox[
             StyleBox[
              DynamicBox[ToBoxes[
                FEPrivate`FrontEndResource["FEStrings", "sizeChangeLimit"], 
                StandardForm],
               ImageSizeCache->{91., {1., 10.}}],
              StripOnInput->False,
              DynamicUpdating->True,
              LineSpacing->{1, 2},
              LineIndent->0,
              LinebreakAdjustments->{1., 100, 0, 0, 0}], "OSLControl",
             StripOnInput->False], True->
            StyleBox[
             StyleBox[
              DynamicBox[ToBoxes[
                FEPrivate`FrontEndResource["FEStrings", "sizeChangeLimit"], 
                StandardForm]],
              StripOnInput->False,
              DynamicUpdating->True,
              LineSpacing->{1, 2},
              LineIndent->0,
              LinebreakAdjustments->{1., 100, 0, 0, 0}], "OSLControlActive",
             StripOnInput->False]}, Dynamic[
             CurrentValue["MouseOver"]],
            Alignment->Center,
            FrameMargins->0,
            ImageSize->{Automatic, {25, Full}}],
           Appearance->None,
           BaselinePosition->Baseline,
           ButtonFunction:>FrontEndExecute[{
              FrontEnd`SetOptions[
              FrontEnd`$FrontEnd, 
               FrontEnd`PreferencesSettings -> {"Page" -> "Advanced"}], 
              FrontEnd`FrontEndToken["PreferencesDialog"]}],
           Evaluator->None,
           Method->"Preemptive"]}
        },
        AutoDelete->False,
        FrameStyle->GrayLevel[0.85],
        GridBoxDividers->{"Columns" -> {False, {True}}},
        GridBoxItemSize->{"Columns" -> {{Automatic}}, "Rows" -> {{Automatic}}},
        GridBoxSpacings->{"Columns" -> {{2}}}]}
     },
     DefaultBaseStyle->"Column",
     GridBoxAlignment->{"Columns" -> {{Left}}, "Rows" -> {{Baseline}}},
     GridBoxDividers->{"Columns" -> {{False}}, "Rows" -> {{False}}},
     GridBoxItemSize->{"Columns" -> {{Automatic}}, "Rows" -> {{1.}}},
     GridBoxSpacings->{"Columns" -> {
         Offset[0.27999999999999997`], {
          Offset[0.5599999999999999]}, 
         Offset[0.27999999999999997`]}, "Rows" -> {
         Offset[0.2], 
         Offset[1.2], {
          Offset[0.4]}, 
         Offset[0.2]}}],
    BaseStyle->"OutputSizeLimit",
    FrameMargins->{{12, 12}, {0, 15}},
    FrameStyle->GrayLevel[0.85],
    RoundingRadius->5,
    StripOnInput->False],
   Deploy,
   DefaultBaseStyle->"Deploy"],
  If[28415626182954115862 === $SessionID, 
   Out[581], Message[
     MessageName[Syntax, "noinfoker"]]; Missing["NotAvailable"]; 
   Null]]], "Output",
 CellChangeTimes->{3.878857865280034*^9},
 CellLabel->
  "Out[581]=",ExpressionUUID->"6f2428a6-d285-4b59-a054-0bd77c4e882b"]
}, Open  ]],

Cell[BoxData[
 RowBox[{
  RowBox[{"ansatzOdd", "=", 
   RowBox[{
    RowBox[{"ansatz", "//", 
     RowBox[{"Cases", "[", 
      RowBox[{"Times", "[", 
       RowBox[{"g___", ",", 
        RowBox[{"dot", "[", 
         RowBox[{"a_", ",", 
          RowBox[{"S", "[", "0", "]"}], ",", "b_"}], "]"}], ",", "f___"}], 
       "]"}], "]"}]}], "//", "Total"}]}], ";"}]], "Input",
 CellChangeTimes->{{3.878790678026134*^9, 3.878790685903837*^9}, {
  3.8787908245623426`*^9, 3.878790838891971*^9}, {3.878857972904654*^9, 
  3.878858024165099*^9}},
 CellLabel->
  "In[584]:=",ExpressionUUID->"b4874dea-e6f2-4fbe-b3d4-f8e9c3640182"],

Cell[BoxData[
 RowBox[{
  RowBox[{"monolist", "=", 
   RowBox[{
    RowBox[{
     RowBox[{
      RowBox[{"(", 
       RowBox[{"List", "@@", "ansatzOdd"}], ")"}], "/.", 
      RowBox[{"{", 
       RowBox[{
        RowBox[{
         RowBox[{"Cos", "[", "_", "]"}], ":>", "1"}], ",", 
        RowBox[{
         RowBox[{"Sin", "[", "_", "]"}], ":>", "1"}], ",", 
        RowBox[{
         RowBox[{"dot", "[", 
          RowBox[{
           RowBox[{"p", "[", "i_", "]"}], ",", 
           RowBox[{"p", "[", "j_", "]"}]}], "]"}], ":>", "1"}], ",", 
        RowBox[{
         RowBox[{"dot", "[", 
          RowBox[{
           RowBox[{"as", "[", "0", "]"}], ",", 
           RowBox[{"p", "[", "j_", "]"}]}], "]"}], ":>", "1"}], ",", 
        RowBox[{
         RowBox[{"dot", "[", 
          RowBox[{
           RowBox[{"p", "[", "i_", "]"}], ",", 
           RowBox[{"v", "[", "1", "]"}]}], "]"}], ":>", "1"}], ",", 
        RowBox[{
         RowBox[{"dot", "[", 
          RowBox[{
           RowBox[{"p", "[", "i_", "]"}], ",", 
           RowBox[{"S", "[", "0", "]"}], ",", 
           RowBox[{"p", "[", "j_", "]"}]}], "]"}], ":>", "1"}]}], "}"}]}], "/.", 
     RowBox[{
      RowBox[{"a_", " ", "b_"}], ":>", 
      RowBox[{"b", "/;", 
       RowBox[{"NumberQ", "[", "a", "]"}]}]}]}], "//", "Union"}]}], 
  ";"}]], "Input",
 CellChangeTimes->{3.8787908454957314`*^9, 3.8788580401766644`*^9},
 CellLabel->
  "In[587]:=",ExpressionUUID->"94623707-34e1-44e0-94c9-b7738b33aa39"],

Cell[BoxData[
 RowBox[{"Monitor", "[", 
  RowBox[{
   RowBox[{
    RowBox[{"ansatzOddM", "=", 
     RowBox[{"Table", "[", 
      RowBox[{
       RowBox[{
        RowBox[{"Coefficient", "[", 
         RowBox[{"ansatzOdd", ",", 
          RowBox[{"monolist", "[", 
           RowBox[{"[", "ii", "]"}], "]"}]}], "]"}], "//", "Simplify"}], ",", 
       
       RowBox[{"{", 
        RowBox[{"ii", ",", 
         RowBox[{"Length", "@", "monolist"}]}], "}"}]}], "]"}]}], ";"}], ",", 
   "ii"}], "]"}]], "Input",
 CellChangeTimes->{{3.878790879988205*^9, 3.8787908829036913`*^9}, {
  3.878858046346902*^9, 3.878858048828945*^9}},
 CellLabel->
  "In[588]:=",ExpressionUUID->"7812fee0-6534-411c-8e43-e15e8dc6d0cb"],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  RowBox[{"ansatzOddM", "//.", "nicevs"}], "//.", "nice"}]], "Input",
 CellChangeTimes->{{3.878858074276908*^9, 3.878858078421556*^9}},
 CellLabel->
  "In[590]:=",ExpressionUUID->"dde22fca-a186-4db3-9d5b-d484a36e0009"],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
   RowBox[{
    RowBox[{"(", 
     RowBox[{
      RowBox[{
       RowBox[{"-", "2"}], " ", 
       RowBox[{"a", "\[CenterDot]", 
        SubscriptBox["p", "3"]}], " ", 
       RowBox[{
        SubscriptBox["p", "1"], "\[CenterDot]", "S", "\[CenterDot]", 
        SubscriptBox["p", "2"]}], " ", 
       RowBox[{"Cos", "[", 
        RowBox[{"a", "\[CenterDot]", 
         SubscriptBox["p", "3"]}], "]"}], " ", 
       RowBox[{"Sin", "[", 
        RowBox[{
         RowBox[{"a", "\[CenterDot]", 
          SubscriptBox["p", "1"]}], "+", 
         RowBox[{"a", "\[CenterDot]", 
          SubscriptBox["p", "2"]}]}], "]"}]}], "+", 
      RowBox[{"2", " ", 
       RowBox[{"(", 
        RowBox[{
         RowBox[{"a", "\[CenterDot]", 
          SubscriptBox["p", "1"]}], "+", 
         RowBox[{"a", "\[CenterDot]", 
          SubscriptBox["p", "2"]}]}], ")"}], " ", 
       RowBox[{"(", 
        RowBox[{
         RowBox[{
          RowBox[{
           SubscriptBox["p", "1"], "\[CenterDot]", "S", "\[CenterDot]", 
           SubscriptBox["p", "2"]}], " ", 
          RowBox[{"Cos", "[", 
           RowBox[{
            RowBox[{"a", "\[CenterDot]", 
             SubscriptBox["p", "1"]}], "+", 
            RowBox[{"a", "\[CenterDot]", 
             SubscriptBox["p", "2"]}]}], "]"}], " ", 
          RowBox[{"Sin", "[", 
           RowBox[{"a", "\[CenterDot]", 
            SubscriptBox["p", "3"]}], "]"}]}], "-", 
         RowBox[{
          RowBox[{
           SubscriptBox["p", "2"], "\[CenterDot]", "S", "\[CenterDot]", 
           SubscriptBox["p", "3"]}], " ", 
          RowBox[{"Sin", "[", 
           RowBox[{
            RowBox[{"a", "\[CenterDot]", 
             SubscriptBox["p", "1"]}], "+", 
            RowBox[{"a", "\[CenterDot]", 
             SubscriptBox["p", "2"]}], "+", 
            RowBox[{"a", "\[CenterDot]", 
             SubscriptBox["p", "3"]}]}], "]"}]}]}], ")"}]}]}], ")"}], "/", 
    RowBox[{"(", 
     RowBox[{
      RowBox[{"(", 
       RowBox[{
        RowBox[{"a", "\[CenterDot]", 
         SubscriptBox["p", "1"]}], "+", 
        RowBox[{"a", "\[CenterDot]", 
         SubscriptBox["p", "2"]}]}], ")"}], " ", 
      RowBox[{"(", 
       RowBox[{
        RowBox[{"a", "\[CenterDot]", 
         SubscriptBox["p", "1"]}], "+", 
        RowBox[{"a", "\[CenterDot]", 
         SubscriptBox["p", "2"]}], "+", 
        RowBox[{"a", "\[CenterDot]", 
         SubscriptBox["p", "3"]}]}], ")"}]}], ")"}]}], ",", 
   RowBox[{
    RowBox[{"(", 
     RowBox[{
      RowBox[{
       SubscriptBox["p", "1"], "\[CenterDot]", 
       SubscriptBox["p", "3"]}], " ", 
      RowBox[{"(", 
       RowBox[{
        RowBox[{
         RowBox[{"-", "2"}], " ", 
         RowBox[{"a", "\[CenterDot]", 
          SubscriptBox["p", "3"]}], " ", 
         RowBox[{
          SubscriptBox["p", "1"], "\[CenterDot]", "S", "\[CenterDot]", 
          SubscriptBox["p", "2"]}], " ", 
         RowBox[{"Cos", "[", 
          RowBox[{"a", "\[CenterDot]", 
           SubscriptBox["p", "3"]}], "]"}], " ", 
         RowBox[{"Sin", "[", 
          RowBox[{
           RowBox[{"a", "\[CenterDot]", 
            SubscriptBox["p", "1"]}], "+", 
           RowBox[{"a", "\[CenterDot]", 
            SubscriptBox["p", "2"]}]}], "]"}]}], "+", 
        RowBox[{"2", " ", 
         RowBox[{"(", 
          RowBox[{
           RowBox[{"a", "\[CenterDot]", 
            SubscriptBox["p", "1"]}], "+", 
           RowBox[{"a", "\[CenterDot]", 
            SubscriptBox["p", "2"]}]}], ")"}], " ", 
         RowBox[{"(", 
          RowBox[{
           RowBox[{
            RowBox[{
             SubscriptBox["p", "1"], "\[CenterDot]", "S", "\[CenterDot]", 
             SubscriptBox["p", "2"]}], " ", 
            RowBox[{"Cos", "[", 
             RowBox[{
              RowBox[{"a", "\[CenterDot]", 
               SubscriptBox["p", "1"]}], "+", 
              RowBox[{"a", "\[CenterDot]", 
               SubscriptBox["p", "2"]}]}], "]"}], " ", 
            RowBox[{"Sin", "[", 
             RowBox[{"a", "\[CenterDot]", 
              SubscriptBox["p", "3"]}], "]"}]}], "+", 
           RowBox[{
            RowBox[{
             SubscriptBox["p", "1"], "\[CenterDot]", "S", "\[CenterDot]", 
             SubscriptBox["p", "3"]}], " ", 
            RowBox[{"Sin", "[", 
             RowBox[{
              RowBox[{"a", "\[CenterDot]", 
               SubscriptBox["p", "1"]}], "+", 
              RowBox[{"a", "\[CenterDot]", 
               SubscriptBox["p", "2"]}], "+", 
              RowBox[{"a", "\[CenterDot]", 
               SubscriptBox["p", "3"]}]}], "]"}]}]}], ")"}]}]}], ")"}]}], 
     ")"}], "/", 
    RowBox[{"(", 
     RowBox[{
      RowBox[{"(", 
       RowBox[{
        RowBox[{"a", "\[CenterDot]", 
         SubscriptBox["p", "1"]}], "+", 
        RowBox[{"a", "\[CenterDot]", 
         SubscriptBox["p", "2"]}]}], ")"}], " ", 
      RowBox[{"(", 
       RowBox[{
        RowBox[{"a", "\[CenterDot]", 
         SubscriptBox["p", "1"]}], "+", 
        RowBox[{"a", "\[CenterDot]", 
         SubscriptBox["p", "2"]}], "+", 
        RowBox[{"a", "\[CenterDot]", 
         SubscriptBox["p", "3"]}]}], ")"}], " ", 
      RowBox[{"(", 
       RowBox[{
        RowBox[{
         SubscriptBox["p", "1"], "\[CenterDot]", 
         SubscriptBox["p", "2"]}], "+", 
        RowBox[{
         SubscriptBox["p", "1"], "\[CenterDot]", 
         SubscriptBox["p", "3"]}]}], ")"}]}], ")"}]}], ",", 
   RowBox[{
    RowBox[{"(", 
     RowBox[{"2", " ", 
      RowBox[{"(", 
       RowBox[{
        RowBox[{
         RowBox[{"-", 
          RowBox[{"(", 
           RowBox[{"a", "\[CenterDot]", 
            SubscriptBox["p", "2"]}], ")"}]}], " ", 
         RowBox[{
          SubscriptBox["p", "1"], "\[CenterDot]", "S", "\[CenterDot]", 
          SubscriptBox["p", "3"]}], " ", 
         RowBox[{"Cos", "[", 
          RowBox[{"a", "\[CenterDot]", 
           SubscriptBox["p", "2"]}], "]"}], " ", 
         RowBox[{"Sin", "[", 
          RowBox[{
           RowBox[{"a", "\[CenterDot]", 
            SubscriptBox["p", "1"]}], "+", 
           RowBox[{"a", "\[CenterDot]", 
            SubscriptBox["p", "3"]}]}], "]"}]}], "+", 
        RowBox[{
         RowBox[{"a", "\[CenterDot]", 
          SubscriptBox["p", "1"]}], " ", 
         RowBox[{"(", 
          RowBox[{
           RowBox[{
            RowBox[{
             SubscriptBox["p", "1"], "\[CenterDot]", "S", "\[CenterDot]", 
             SubscriptBox["p", "3"]}], " ", 
            RowBox[{"Cos", "[", 
             RowBox[{
              RowBox[{"a", "\[CenterDot]", 
               SubscriptBox["p", "1"]}], "+", 
              RowBox[{"a", "\[CenterDot]", 
               SubscriptBox["p", "3"]}]}], "]"}], " ", 
            RowBox[{"Sin", "[", 
             RowBox[{"a", "\[CenterDot]", 
              SubscriptBox["p", "2"]}], "]"}]}], "+", 
           RowBox[{
            RowBox[{
             SubscriptBox["p", "2"], "\[CenterDot]", "S", "\[CenterDot]", 
             SubscriptBox["p", "3"]}], " ", 
            RowBox[{"Sin", "[", 
             RowBox[{
              RowBox[{"a", "\[CenterDot]", 
               SubscriptBox["p", "1"]}], "+", 
              RowBox[{"a", "\[CenterDot]", 
               SubscriptBox["p", "2"]}], "+", 
              RowBox[{"a", "\[CenterDot]", 
               SubscriptBox["p", "3"]}]}], "]"}]}]}], ")"}]}], "+", 
        RowBox[{
         RowBox[{"a", "\[CenterDot]", 
          SubscriptBox["p", "3"]}], " ", 
         RowBox[{"(", 
          RowBox[{
           RowBox[{
            RowBox[{
             SubscriptBox["p", "1"], "\[CenterDot]", "S", "\[CenterDot]", 
             SubscriptBox["p", "3"]}], " ", 
            RowBox[{"Cos", "[", 
             RowBox[{
              RowBox[{"a", "\[CenterDot]", 
               SubscriptBox["p", "1"]}], "+", 
              RowBox[{"a", "\[CenterDot]", 
               SubscriptBox["p", "3"]}]}], "]"}], " ", 
            RowBox[{"Sin", "[", 
             RowBox[{"a", "\[CenterDot]", 
              SubscriptBox["p", "2"]}], "]"}]}], "+", 
           RowBox[{
            RowBox[{
             SubscriptBox["p", "2"], "\[CenterDot]", "S", "\[CenterDot]", 
             SubscriptBox["p", "3"]}], " ", 
            RowBox[{"Sin", "[", 
             RowBox[{
              RowBox[{"a", "\[CenterDot]", 
               SubscriptBox["p", "1"]}], "+", 
              RowBox[{"a", "\[CenterDot]", 
               SubscriptBox["p", "2"]}], "+", 
              RowBox[{"a", "\[CenterDot]", 
               SubscriptBox["p", "3"]}]}], "]"}]}]}], ")"}]}]}], ")"}]}], 
     ")"}], "/", 
    RowBox[{"(", 
     RowBox[{
      RowBox[{"(", 
       RowBox[{
        RowBox[{"a", "\[CenterDot]", 
         SubscriptBox["p", "1"]}], "+", 
        RowBox[{"a", "\[CenterDot]", 
         SubscriptBox["p", "3"]}]}], ")"}], " ", 
      RowBox[{"(", 
       RowBox[{
        RowBox[{"a", "\[CenterDot]", 
         SubscriptBox["p", "1"]}], "+", 
        RowBox[{"a", "\[CenterDot]", 
         SubscriptBox["p", "2"]}], "+", 
        RowBox[{"a", "\[CenterDot]", 
         SubscriptBox["p", "3"]}]}], ")"}]}], ")"}]}], ",", 
   RowBox[{
    RowBox[{"(", 
     RowBox[{"2", " ", 
      RowBox[{
       SubscriptBox["p", "1"], "\[CenterDot]", 
       SubscriptBox["p", "2"]}], " ", 
      RowBox[{"(", 
       RowBox[{
        RowBox[{
         RowBox[{"-", 
          RowBox[{"(", 
           RowBox[{"a", "\[CenterDot]", 
            SubscriptBox["p", "2"]}], ")"}]}], " ", 
         RowBox[{
          SubscriptBox["p", "1"], "\[CenterDot]", "S", "\[CenterDot]", 
          SubscriptBox["p", "3"]}], " ", 
         RowBox[{"Cos", "[", 
          RowBox[{"a", "\[CenterDot]", 
           SubscriptBox["p", "2"]}], "]"}], " ", 
         RowBox[{"Sin", "[", 
          RowBox[{
           RowBox[{"a", "\[CenterDot]", 
            SubscriptBox["p", "1"]}], "+", 
           RowBox[{"a", "\[CenterDot]", 
            SubscriptBox["p", "3"]}]}], "]"}]}], "+", 
        RowBox[{
         RowBox[{"a", "\[CenterDot]", 
          SubscriptBox["p", "1"]}], " ", 
         RowBox[{"(", 
          RowBox[{
           RowBox[{
            RowBox[{
             SubscriptBox["p", "1"], "\[CenterDot]", "S", "\[CenterDot]", 
             SubscriptBox["p", "3"]}], " ", 
            RowBox[{"Cos", "[", 
             RowBox[{
              RowBox[{"a", "\[CenterDot]", 
               SubscriptBox["p", "1"]}], "+", 
              RowBox[{"a", "\[CenterDot]", 
               SubscriptBox["p", "3"]}]}], "]"}], " ", 
            RowBox[{"Sin", "[", 
             RowBox[{"a", "\[CenterDot]", 
              SubscriptBox["p", "2"]}], "]"}]}], "+", 
           RowBox[{
            RowBox[{
             SubscriptBox["p", "1"], "\[CenterDot]", "S", "\[CenterDot]", 
             SubscriptBox["p", "2"]}], " ", 
            RowBox[{"Sin", "[", 
             RowBox[{
              RowBox[{"a", "\[CenterDot]", 
               SubscriptBox["p", "1"]}], "+", 
              RowBox[{"a", "\[CenterDot]", 
               SubscriptBox["p", "2"]}], "+", 
              RowBox[{"a", "\[CenterDot]", 
               SubscriptBox["p", "3"]}]}], "]"}]}]}], ")"}]}], "+", 
        RowBox[{
         RowBox[{"a", "\[CenterDot]", 
          SubscriptBox["p", "3"]}], " ", 
         RowBox[{"(", 
          RowBox[{
           RowBox[{
            RowBox[{
             SubscriptBox["p", "1"], "\[CenterDot]", "S", "\[CenterDot]", 
             SubscriptBox["p", "3"]}], " ", 
            RowBox[{"Cos", "[", 
             RowBox[{
              RowBox[{"a", "\[CenterDot]", 
               SubscriptBox["p", "1"]}], "+", 
              RowBox[{"a", "\[CenterDot]", 
               SubscriptBox["p", "3"]}]}], "]"}], " ", 
            RowBox[{"Sin", "[", 
             RowBox[{"a", "\[CenterDot]", 
              SubscriptBox["p", "2"]}], "]"}]}], "+", 
           RowBox[{
            RowBox[{
             SubscriptBox["p", "1"], "\[CenterDot]", "S", "\[CenterDot]", 
             SubscriptBox["p", "2"]}], " ", 
            RowBox[{"Sin", "[", 
             RowBox[{
              RowBox[{"a", "\[CenterDot]", 
               SubscriptBox["p", "1"]}], "+", 
              RowBox[{"a", "\[CenterDot]", 
               SubscriptBox["p", "2"]}], "+", 
              RowBox[{"a", "\[CenterDot]", 
               SubscriptBox["p", "3"]}]}], "]"}]}]}], ")"}]}]}], ")"}]}], 
     ")"}], "/", 
    RowBox[{"(", 
     RowBox[{
      RowBox[{"(", 
       RowBox[{
        RowBox[{"a", "\[CenterDot]", 
         SubscriptBox["p", "1"]}], "+", 
        RowBox[{"a", "\[CenterDot]", 
         SubscriptBox["p", "3"]}]}], ")"}], " ", 
      RowBox[{"(", 
       RowBox[{
        RowBox[{"a", "\[CenterDot]", 
         SubscriptBox["p", "1"]}], "+", 
        RowBox[{"a", "\[CenterDot]", 
         SubscriptBox["p", "2"]}], "+", 
        RowBox[{"a", "\[CenterDot]", 
         SubscriptBox["p", "3"]}]}], ")"}], " ", 
      RowBox[{"(", 
       RowBox[{
        RowBox[{
         SubscriptBox["p", "1"], "\[CenterDot]", 
         SubscriptBox["p", "2"]}], "+", 
        RowBox[{
         SubscriptBox["p", "1"], "\[CenterDot]", 
         SubscriptBox["p", "3"]}]}], ")"}]}], ")"}]}], ",", 
   RowBox[{"-", 
    RowBox[{"(", 
     RowBox[{
      RowBox[{"(", 
       RowBox[{
        RowBox[{
         SubscriptBox["p", "1"], "\[CenterDot]", 
         SubscriptBox["p", "3"]}], " ", 
        RowBox[{"(", 
         RowBox[{
          RowBox[{
           RowBox[{"-", "2"}], " ", 
           RowBox[{"a", "\[CenterDot]", 
            SubscriptBox["p", "1"]}], " ", 
           RowBox[{
            SubscriptBox["p", "2"], "\[CenterDot]", "S", "\[CenterDot]", 
            SubscriptBox["p", "3"]}], " ", 
           RowBox[{"Cos", "[", 
            RowBox[{"a", "\[CenterDot]", 
             SubscriptBox["p", "1"]}], "]"}], " ", 
           RowBox[{"Sin", "[", 
            RowBox[{
             RowBox[{"a", "\[CenterDot]", 
              SubscriptBox["p", "2"]}], "+", 
             RowBox[{"a", "\[CenterDot]", 
              SubscriptBox["p", "3"]}]}], "]"}]}], "+", 
          RowBox[{"2", " ", 
           RowBox[{"(", 
            RowBox[{
             RowBox[{"a", "\[CenterDot]", 
              SubscriptBox["p", "2"]}], "+", 
             RowBox[{"a", "\[CenterDot]", 
              SubscriptBox["p", "3"]}]}], ")"}], " ", 
           RowBox[{"(", 
            RowBox[{
             RowBox[{
              RowBox[{
               SubscriptBox["p", "2"], "\[CenterDot]", "S", "\[CenterDot]", 
               SubscriptBox["p", "3"]}], " ", 
              RowBox[{"Cos", "[", 
               RowBox[{
                RowBox[{"a", "\[CenterDot]", 
                 SubscriptBox["p", "2"]}], "+", 
                RowBox[{"a", "\[CenterDot]", 
                 SubscriptBox["p", "3"]}]}], "]"}], " ", 
              RowBox[{"Sin", "[", 
               RowBox[{"a", "\[CenterDot]", 
                SubscriptBox["p", "1"]}], "]"}]}], "+", 
             RowBox[{
              RowBox[{
               SubscriptBox["p", "1"], "\[CenterDot]", "S", "\[CenterDot]", 
               SubscriptBox["p", "3"]}], " ", 
              RowBox[{"Sin", "[", 
               RowBox[{
                RowBox[{"a", "\[CenterDot]", 
                 SubscriptBox["p", "1"]}], "+", 
                RowBox[{"a", "\[CenterDot]", 
                 SubscriptBox["p", "2"]}], "+", 
                RowBox[{"a", "\[CenterDot]", 
                 SubscriptBox["p", "3"]}]}], "]"}]}]}], ")"}]}]}], ")"}]}], 
       ")"}], "/", 
      RowBox[{"(", 
       RowBox[{
        RowBox[{"(", 
         RowBox[{
          RowBox[{"a", "\[CenterDot]", 
           SubscriptBox["p", "2"]}], "+", 
          RowBox[{"a", "\[CenterDot]", 
           SubscriptBox["p", "3"]}]}], ")"}], " ", 
        RowBox[{"(", 
         RowBox[{
          RowBox[{"a", "\[CenterDot]", 
           SubscriptBox["p", "1"]}], "+", 
          RowBox[{"a", "\[CenterDot]", 
           SubscriptBox["p", "2"]}], "+", 
          RowBox[{"a", "\[CenterDot]", 
           SubscriptBox["p", "3"]}]}], ")"}], " ", 
        RowBox[{"(", 
         RowBox[{
          RowBox[{
           SubscriptBox["p", "1"], "\[CenterDot]", 
           SubscriptBox["p", "2"]}], "+", 
          RowBox[{
           SubscriptBox["p", "1"], "\[CenterDot]", 
           SubscriptBox["p", "3"]}]}], ")"}]}], ")"}]}], ")"}]}], ",", 
   RowBox[{
    RowBox[{"(", 
     RowBox[{
      RowBox[{
       SubscriptBox["p", "1"], "\[CenterDot]", 
       SubscriptBox["p", "2"]}], " ", 
      RowBox[{"(", 
       RowBox[{
        RowBox[{
         RowBox[{"-", "2"}], " ", 
         RowBox[{"a", "\[CenterDot]", 
          SubscriptBox["p", "1"]}], " ", 
         RowBox[{
          SubscriptBox["p", "2"], "\[CenterDot]", "S", "\[CenterDot]", 
          SubscriptBox["p", "3"]}], " ", 
         RowBox[{"Cos", "[", 
          RowBox[{"a", "\[CenterDot]", 
           SubscriptBox["p", "1"]}], "]"}], " ", 
         RowBox[{"Sin", "[", 
          RowBox[{
           RowBox[{"a", "\[CenterDot]", 
            SubscriptBox["p", "2"]}], "+", 
           RowBox[{"a", "\[CenterDot]", 
            SubscriptBox["p", "3"]}]}], "]"}]}], "+", 
        RowBox[{"2", " ", 
         RowBox[{"(", 
          RowBox[{
           RowBox[{"a", "\[CenterDot]", 
            SubscriptBox["p", "2"]}], "+", 
           RowBox[{"a", "\[CenterDot]", 
            SubscriptBox["p", "3"]}]}], ")"}], " ", 
         RowBox[{"(", 
          RowBox[{
           RowBox[{
            RowBox[{
             SubscriptBox["p", "2"], "\[CenterDot]", "S", "\[CenterDot]", 
             SubscriptBox["p", "3"]}], " ", 
            RowBox[{"Cos", "[", 
             RowBox[{
              RowBox[{"a", "\[CenterDot]", 
               SubscriptBox["p", "2"]}], "+", 
              RowBox[{"a", "\[CenterDot]", 
               SubscriptBox["p", "3"]}]}], "]"}], " ", 
            RowBox[{"Sin", "[", 
             RowBox[{"a", "\[CenterDot]", 
              SubscriptBox["p", "1"]}], "]"}]}], "-", 
           RowBox[{
            RowBox[{
             SubscriptBox["p", "1"], "\[CenterDot]", "S", "\[CenterDot]", 
             SubscriptBox["p", "2"]}], " ", 
            RowBox[{"Sin", "[", 
             RowBox[{
              RowBox[{"a", "\[CenterDot]", 
               SubscriptBox["p", "1"]}], "+", 
              RowBox[{"a", "\[CenterDot]", 
               SubscriptBox["p", "2"]}], "+", 
              RowBox[{"a", "\[CenterDot]", 
               SubscriptBox["p", "3"]}]}], "]"}]}]}], ")"}]}]}], ")"}]}], 
     ")"}], "/", 
    RowBox[{"(", 
     RowBox[{
      RowBox[{"(", 
       RowBox[{
        RowBox[{"a", "\[CenterDot]", 
         SubscriptBox["p", "2"]}], "+", 
        RowBox[{"a", "\[CenterDot]", 
         SubscriptBox["p", "3"]}]}], ")"}], " ", 
      RowBox[{"(", 
       RowBox[{
        RowBox[{"a", "\[CenterDot]", 
         SubscriptBox["p", "1"]}], "+", 
        RowBox[{"a", "\[CenterDot]", 
         SubscriptBox["p", "2"]}], "+", 
        RowBox[{"a", "\[CenterDot]", 
         SubscriptBox["p", "3"]}]}], ")"}], " ", 
      RowBox[{"(", 
       RowBox[{
        RowBox[{
         SubscriptBox["p", "1"], "\[CenterDot]", 
         SubscriptBox["p", "2"]}], "+", 
        RowBox[{
         SubscriptBox["p", "1"], "\[CenterDot]", 
         SubscriptBox["p", "3"]}]}], ")"}]}], ")"}]}], ",", 
   RowBox[{"-", 
    FractionBox[
     RowBox[{"2", " ", 
      RowBox[{
       SubscriptBox["p", "1"], "\[CenterDot]", 
       SubscriptBox["p", "2"]}], " ", 
      RowBox[{
       SubscriptBox["p", "1"], "\[CenterDot]", 
       SubscriptBox["p", "3"]}], " ", 
      RowBox[{"Sin", "[", 
       RowBox[{"a", "\[CenterDot]", 
        SubscriptBox["p", "1"]}], "]"}], " ", 
      RowBox[{"Sin", "[", 
       RowBox[{"a", "\[CenterDot]", 
        SubscriptBox["p", "2"]}], "]"}], " ", 
      RowBox[{"Sin", "[", 
       RowBox[{"a", "\[CenterDot]", 
        SubscriptBox["p", "3"]}], "]"}]}], 
     RowBox[{
      RowBox[{"a", "\[CenterDot]", 
       SubscriptBox["p", "1"]}], " ", 
      RowBox[{"a", "\[CenterDot]", 
       SubscriptBox["p", "2"]}], " ", 
      RowBox[{"a", "\[CenterDot]", 
       SubscriptBox["p", "3"]}]}]]}], ",", 
   FractionBox[
    RowBox[{"2", " ", 
     RowBox[{
      SubscriptBox["p", "1"], "\[CenterDot]", 
      SubscriptBox["p", "3"]}], " ", 
     RowBox[{"Cos", "[", 
      RowBox[{"a", "\[CenterDot]", 
       SubscriptBox["p", "2"]}], "]"}], " ", 
     RowBox[{"(", 
      RowBox[{
       RowBox[{
        RowBox[{"-", 
         RowBox[{"(", 
          RowBox[{"a", "\[CenterDot]", 
           SubscriptBox["p", "3"]}], ")"}]}], " ", 
        RowBox[{"Cos", "[", 
         RowBox[{"a", "\[CenterDot]", 
          SubscriptBox["p", "3"]}], "]"}], " ", 
        RowBox[{"Sin", "[", 
         RowBox[{"a", "\[CenterDot]", 
          SubscriptBox["p", "1"]}], "]"}]}], "+", 
       RowBox[{
        RowBox[{"a", "\[CenterDot]", 
         SubscriptBox["p", "1"]}], " ", 
        RowBox[{"Cos", "[", 
         RowBox[{"a", "\[CenterDot]", 
          SubscriptBox["p", "1"]}], "]"}], " ", 
        RowBox[{"Sin", "[", 
         RowBox[{"a", "\[CenterDot]", 
          SubscriptBox["p", "3"]}], "]"}]}]}], ")"}]}], 
    RowBox[{
     RowBox[{"a", "\[CenterDot]", 
      SubscriptBox["p", "1"]}], " ", 
     RowBox[{"a", "\[CenterDot]", 
      SubscriptBox["p", "3"]}], " ", 
     RowBox[{"(", 
      RowBox[{
       RowBox[{"a", "\[CenterDot]", 
        SubscriptBox["p", "1"]}], "+", 
       RowBox[{"a", "\[CenterDot]", 
        SubscriptBox["p", "3"]}]}], ")"}]}]], ",", 
   FractionBox[
    RowBox[{"2", " ", 
     RowBox[{
      SubscriptBox["p", "1"], "\[CenterDot]", 
      SubscriptBox["p", "2"]}], " ", 
     RowBox[{"Cos", "[", 
      RowBox[{"a", "\[CenterDot]", 
       SubscriptBox["p", "3"]}], "]"}], " ", 
     RowBox[{"(", 
      RowBox[{
       RowBox[{
        RowBox[{"-", 
         RowBox[{"(", 
          RowBox[{"a", "\[CenterDot]", 
           SubscriptBox["p", "2"]}], ")"}]}], " ", 
        RowBox[{"Cos", "[", 
         RowBox[{"a", "\[CenterDot]", 
          SubscriptBox["p", "2"]}], "]"}], " ", 
        RowBox[{"Sin", "[", 
         RowBox[{"a", "\[CenterDot]", 
          SubscriptBox["p", "1"]}], "]"}]}], "+", 
       RowBox[{
        RowBox[{"a", "\[CenterDot]", 
         SubscriptBox["p", "1"]}], " ", 
        RowBox[{"Cos", "[", 
         RowBox[{"a", "\[CenterDot]", 
          SubscriptBox["p", "1"]}], "]"}], " ", 
        RowBox[{"Sin", "[", 
         RowBox[{"a", "\[CenterDot]", 
          SubscriptBox["p", "2"]}], "]"}]}]}], ")"}]}], 
    RowBox[{
     RowBox[{"a", "\[CenterDot]", 
      SubscriptBox["p", "1"]}], " ", 
     RowBox[{"a", "\[CenterDot]", 
      SubscriptBox["p", "2"]}], " ", 
     RowBox[{"(", 
      RowBox[{
       RowBox[{"a", "\[CenterDot]", 
        SubscriptBox["p", "1"]}], "+", 
       RowBox[{"a", "\[CenterDot]", 
        SubscriptBox["p", "2"]}]}], ")"}]}]], ",", 
   RowBox[{"-", 
    RowBox[{"(", 
     RowBox[{
      RowBox[{"(", 
       RowBox[{"2", " ", 
        RowBox[{"(", 
         RowBox[{
          RowBox[{
           RowBox[{"-", 
            RowBox[{"(", 
             RowBox[{"a", "\[CenterDot]", 
              SubscriptBox["p", "2"]}], ")"}]}], " ", 
           RowBox[{"a", "\[CenterDot]", 
            SubscriptBox["p", "3"]}], " ", 
           RowBox[{"(", 
            RowBox[{
             RowBox[{"a", "\[CenterDot]", 
              SubscriptBox["p", "2"]}], "+", 
             RowBox[{"a", "\[CenterDot]", 
              SubscriptBox["p", "3"]}]}], ")"}], " ", 
           RowBox[{"Cos", "[", 
            RowBox[{"a", "\[CenterDot]", 
             SubscriptBox["p", "2"]}], "]"}], " ", 
           RowBox[{"Cos", "[", 
            RowBox[{"a", "\[CenterDot]", 
             SubscriptBox["p", "3"]}], "]"}], " ", 
           RowBox[{"Sin", "[", 
            RowBox[{"a", "\[CenterDot]", 
             SubscriptBox["p", "1"]}], "]"}]}], "+", 
          RowBox[{
           SuperscriptBox[
            RowBox[{"(", 
             RowBox[{"a", "\[CenterDot]", 
              SubscriptBox["p", "1"]}], ")"}], "3"], " ", 
           RowBox[{"Sin", "[", 
            RowBox[{"a", "\[CenterDot]", 
             SubscriptBox["p", "1"]}], "]"}], " ", 
           RowBox[{"Sin", "[", 
            RowBox[{"a", "\[CenterDot]", 
             SubscriptBox["p", "2"]}], "]"}], " ", 
           RowBox[{"Sin", "[", 
            RowBox[{"a", "\[CenterDot]", 
             SubscriptBox["p", "3"]}], "]"}]}], "+", 
          RowBox[{
           SuperscriptBox[
            RowBox[{"(", 
             RowBox[{"a", "\[CenterDot]", 
              SubscriptBox["p", "1"]}], ")"}], "2"], " ", 
           RowBox[{"(", 
            RowBox[{
             RowBox[{
              RowBox[{"a", "\[CenterDot]", 
               SubscriptBox["p", "3"]}], " ", 
              RowBox[{"Cos", "[", 
               RowBox[{
                RowBox[{"a", "\[CenterDot]", 
                 SubscriptBox["p", "1"]}], "-", 
                RowBox[{"a", "\[CenterDot]", 
                 SubscriptBox["p", "3"]}]}], "]"}], " ", 
              RowBox[{"Sin", "[", 
               RowBox[{"a", "\[CenterDot]", 
                SubscriptBox["p", "2"]}], "]"}]}], "+", 
             RowBox[{
              RowBox[{"a", "\[CenterDot]", 
               SubscriptBox["p", "2"]}], " ", 
              RowBox[{"Cos", "[", 
               RowBox[{
                RowBox[{"a", "\[CenterDot]", 
                 SubscriptBox["p", "1"]}], "-", 
                RowBox[{"a", "\[CenterDot]", 
                 SubscriptBox["p", "2"]}]}], "]"}], " ", 
              RowBox[{"Sin", "[", 
               RowBox[{"a", "\[CenterDot]", 
                SubscriptBox["p", "3"]}], "]"}]}]}], ")"}]}], "+", 
          RowBox[{
           RowBox[{"a", "\[CenterDot]", 
            SubscriptBox["p", "1"]}], " ", 
           RowBox[{"(", 
            RowBox[{
             RowBox[{
              SuperscriptBox[
               RowBox[{"(", 
                RowBox[{"a", "\[CenterDot]", 
                 SubscriptBox["p", "3"]}], ")"}], "2"], " ", 
              RowBox[{"Cos", "[", 
               RowBox[{"a", "\[CenterDot]", 
                SubscriptBox["p", "1"]}], "]"}], " ", 
              RowBox[{"Cos", "[", 
               RowBox[{"a", "\[CenterDot]", 
                SubscriptBox["p", "3"]}], "]"}], " ", 
              RowBox[{"Sin", "[", 
               RowBox[{"a", "\[CenterDot]", 
                SubscriptBox["p", "2"]}], "]"}]}], "+", 
             RowBox[{
              SuperscriptBox[
               RowBox[{"(", 
                RowBox[{"a", "\[CenterDot]", 
                 SubscriptBox["p", "2"]}], ")"}], "2"], " ", 
              RowBox[{"Cos", "[", 
               RowBox[{"a", "\[CenterDot]", 
                SubscriptBox["p", "1"]}], "]"}], " ", 
              RowBox[{"Cos", "[", 
               RowBox[{"a", "\[CenterDot]", 
                SubscriptBox["p", "2"]}], "]"}], " ", 
              RowBox[{"Sin", "[", 
               RowBox[{"a", "\[CenterDot]", 
                SubscriptBox["p", "3"]}], "]"}]}], "-", 
             RowBox[{
              RowBox[{"a", "\[CenterDot]", 
               SubscriptBox["p", "2"]}], " ", 
              RowBox[{"a", "\[CenterDot]", 
               SubscriptBox["p", "3"]}], " ", 
              RowBox[{"Sin", "[", 
               RowBox[{"a", "\[CenterDot]", 
                SubscriptBox["p", "1"]}], "]"}], " ", 
              RowBox[{"(", 
               RowBox[{
                RowBox[{"2", " ", 
                 RowBox[{"Cos", "[", 
                  RowBox[{"a", "\[CenterDot]", 
                   SubscriptBox["p", "2"]}], "]"}], " ", 
                 RowBox[{"Cos", "[", 
                  RowBox[{"a", "\[CenterDot]", 
                   SubscriptBox["p", "3"]}], "]"}]}], "-", 
                RowBox[{
                 RowBox[{"Sin", "[", 
                  RowBox[{"a", "\[CenterDot]", 
                   SubscriptBox["p", "2"]}], "]"}], " ", 
                 RowBox[{"Sin", "[", 
                  RowBox[{"a", "\[CenterDot]", 
                   SubscriptBox["p", "3"]}], "]"}]}]}], ")"}]}]}], ")"}]}]}], 
         ")"}]}], ")"}], "/", 
      RowBox[{"(", 
       RowBox[{
        RowBox[{"a", "\[CenterDot]", 
         SubscriptBox["p", "1"]}], " ", 
        RowBox[{"(", 
         RowBox[{
          RowBox[{"a", "\[CenterDot]", 
           SubscriptBox["p", "1"]}], "+", 
          RowBox[{"a", "\[CenterDot]", 
           SubscriptBox["p", "2"]}]}], ")"}], " ", 
        RowBox[{"(", 
         RowBox[{
          RowBox[{"a", "\[CenterDot]", 
           SubscriptBox["p", "1"]}], "+", 
          RowBox[{"a", "\[CenterDot]", 
           SubscriptBox["p", "3"]}]}], ")"}], " ", 
        RowBox[{"(", 
         RowBox[{
          RowBox[{"a", "\[CenterDot]", 
           SubscriptBox["p", "1"]}], "+", 
          RowBox[{"a", "\[CenterDot]", 
           SubscriptBox["p", "2"]}], "+", 
          RowBox[{"a", "\[CenterDot]", 
           SubscriptBox["p", "3"]}]}], ")"}]}], ")"}]}], ")"}]}], ",", 
   FractionBox[
    RowBox[{"2", " ", 
     RowBox[{
      SubscriptBox["p", "1"], "\[CenterDot]", 
      SubscriptBox["p", "2"]}], " ", 
     RowBox[{
      SubscriptBox["p", "1"], "\[CenterDot]", 
      SubscriptBox["p", "3"]}], " ", 
     RowBox[{"(", 
      RowBox[{
       RowBox[{
        RowBox[{"-", 
         RowBox[{"(", 
          RowBox[{"a", "\[CenterDot]", 
           SubscriptBox["p", "2"]}], ")"}]}], " ", 
        RowBox[{"Cos", "[", 
         RowBox[{
          RowBox[{"a", "\[CenterDot]", 
           SubscriptBox["p", "2"]}], "-", 
          RowBox[{"a", "\[CenterDot]", 
           SubscriptBox["p", "3"]}]}], "]"}], " ", 
        RowBox[{"Sin", "[", 
         RowBox[{"a", "\[CenterDot]", 
          SubscriptBox["p", "1"]}], "]"}]}], "+", 
       RowBox[{
        RowBox[{"a", "\[CenterDot]", 
         SubscriptBox["p", "1"]}], " ", 
        RowBox[{"Cos", "[", 
         RowBox[{
          RowBox[{"a", "\[CenterDot]", 
           SubscriptBox["p", "1"]}], "+", 
          RowBox[{"a", "\[CenterDot]", 
           SubscriptBox["p", "3"]}]}], "]"}], " ", 
        RowBox[{"Sin", "[", 
         RowBox[{"a", "\[CenterDot]", 
          SubscriptBox["p", "2"]}], "]"}]}]}], ")"}]}], 
    RowBox[{
     RowBox[{"a", "\[CenterDot]", 
      SubscriptBox["p", "1"]}], " ", 
     RowBox[{"a", "\[CenterDot]", 
      SubscriptBox["p", "2"]}], " ", 
     RowBox[{"(", 
      RowBox[{
       RowBox[{"a", "\[CenterDot]", 
        SubscriptBox["p", "1"]}], "+", 
       RowBox[{"a", "\[CenterDot]", 
        SubscriptBox["p", "2"]}]}], ")"}], " ", 
     RowBox[{"(", 
      RowBox[{
       RowBox[{
        SubscriptBox["p", "1"], "\[CenterDot]", 
        SubscriptBox["p", "2"]}], "+", 
       RowBox[{
        SubscriptBox["p", "1"], "\[CenterDot]", 
        SubscriptBox["p", "3"]}]}], ")"}]}]], ",", 
   FractionBox[
    RowBox[{"2", " ", 
     RowBox[{
      SubscriptBox["p", "1"], "\[CenterDot]", 
      SubscriptBox["p", "3"]}], " ", 
     RowBox[{"(", 
      RowBox[{
       RowBox[{
        RowBox[{"-", 
         RowBox[{"(", 
          RowBox[{"a", "\[CenterDot]", 
           SubscriptBox["p", "3"]}], ")"}]}], " ", 
        RowBox[{"Cos", "[", 
         RowBox[{"a", "\[CenterDot]", 
          SubscriptBox["p", "3"]}], "]"}], " ", 
        RowBox[{"Sin", "[", 
         RowBox[{
          RowBox[{"a", "\[CenterDot]", 
           SubscriptBox["p", "1"]}], "+", 
          RowBox[{"a", "\[CenterDot]", 
           SubscriptBox["p", "2"]}]}], "]"}]}], "+", 
       RowBox[{
        RowBox[{"(", 
         RowBox[{
          RowBox[{"a", "\[CenterDot]", 
           SubscriptBox["p", "1"]}], "+", 
          RowBox[{"a", "\[CenterDot]", 
           SubscriptBox["p", "2"]}]}], ")"}], " ", 
        RowBox[{"Cos", "[", 
         RowBox[{
          RowBox[{"a", "\[CenterDot]", 
           SubscriptBox["p", "1"]}], "+", 
          RowBox[{"a", "\[CenterDot]", 
           SubscriptBox["p", "2"]}]}], "]"}], " ", 
        RowBox[{"Sin", "[", 
         RowBox[{"a", "\[CenterDot]", 
          SubscriptBox["p", "3"]}], "]"}]}]}], ")"}]}], 
    RowBox[{
     RowBox[{"(", 
      RowBox[{
       RowBox[{"a", "\[CenterDot]", 
        SubscriptBox["p", "1"]}], "+", 
       RowBox[{"a", "\[CenterDot]", 
        SubscriptBox["p", "2"]}]}], ")"}], " ", 
     RowBox[{"(", 
      RowBox[{
       RowBox[{"a", "\[CenterDot]", 
        SubscriptBox["p", "1"]}], "+", 
       RowBox[{"a", "\[CenterDot]", 
        SubscriptBox["p", "2"]}], "+", 
       RowBox[{"a", "\[CenterDot]", 
        SubscriptBox["p", "3"]}]}], ")"}], " ", 
     RowBox[{"(", 
      RowBox[{
       RowBox[{
        SubscriptBox["p", "1"], "\[CenterDot]", 
        SubscriptBox["p", "2"]}], "+", 
       RowBox[{
        SubscriptBox["p", "1"], "\[CenterDot]", 
        SubscriptBox["p", "3"]}]}], ")"}]}]], ",", 
   FractionBox[
    RowBox[{"2", " ", 
     RowBox[{
      SubscriptBox["p", "1"], "\[CenterDot]", 
      SubscriptBox["p", "2"]}], " ", 
     RowBox[{
      SubscriptBox["p", "1"], "\[CenterDot]", 
      SubscriptBox["p", "3"]}], " ", 
     RowBox[{"(", 
      RowBox[{
       RowBox[{
        RowBox[{"-", 
         RowBox[{"(", 
          RowBox[{"a", "\[CenterDot]", 
           SubscriptBox["p", "3"]}], ")"}]}], " ", 
        RowBox[{"Cos", "[", 
         RowBox[{
          RowBox[{"a", "\[CenterDot]", 
           SubscriptBox["p", "2"]}], "-", 
          RowBox[{"a", "\[CenterDot]", 
           SubscriptBox["p", "3"]}]}], "]"}], " ", 
        RowBox[{"Sin", "[", 
         RowBox[{"a", "\[CenterDot]", 
          SubscriptBox["p", "1"]}], "]"}]}], "+", 
       RowBox[{
        RowBox[{"a", "\[CenterDot]", 
         SubscriptBox["p", "1"]}], " ", 
        RowBox[{"Cos", "[", 
         RowBox[{
          RowBox[{"a", "\[CenterDot]", 
           SubscriptBox["p", "1"]}], "+", 
          RowBox[{"a", "\[CenterDot]", 
           SubscriptBox["p", "2"]}]}], "]"}], " ", 
        RowBox[{"Sin", "[", 
         RowBox[{"a", "\[CenterDot]", 
          SubscriptBox["p", "3"]}], "]"}]}]}], ")"}]}], 
    RowBox[{
     RowBox[{"a", "\[CenterDot]", 
      SubscriptBox["p", "1"]}], " ", 
     RowBox[{"a", "\[CenterDot]", 
      SubscriptBox["p", "3"]}], " ", 
     RowBox[{"(", 
      RowBox[{
       RowBox[{"a", "\[CenterDot]", 
        SubscriptBox["p", "1"]}], "+", 
       RowBox[{"a", "\[CenterDot]", 
        SubscriptBox["p", "3"]}]}], ")"}], " ", 
     RowBox[{"(", 
      RowBox[{
       RowBox[{
        SubscriptBox["p", "1"], "\[CenterDot]", 
        SubscriptBox["p", "2"]}], "+", 
       RowBox[{
        SubscriptBox["p", "1"], "\[CenterDot]", 
        SubscriptBox["p", "3"]}]}], ")"}]}]], ",", 
   RowBox[{"-", 
    FractionBox[
     RowBox[{
      RowBox[{
       SubscriptBox["p", "1"], "\[CenterDot]", 
       SubscriptBox["p", "2"]}], " ", 
      RowBox[{"(", 
       RowBox[{
        RowBox[{
         RowBox[{"-", "2"}], " ", 
         RowBox[{"(", 
          RowBox[{
           RowBox[{"a", "\[CenterDot]", 
            SubscriptBox["p", "1"]}], "+", 
           RowBox[{"a", "\[CenterDot]", 
            SubscriptBox["p", "3"]}]}], ")"}], " ", 
         RowBox[{"Cos", "[", 
          RowBox[{
           RowBox[{"a", "\[CenterDot]", 
            SubscriptBox["p", "1"]}], "+", 
           RowBox[{"a", "\[CenterDot]", 
            SubscriptBox["p", "3"]}]}], "]"}], " ", 
         RowBox[{"Sin", "[", 
          RowBox[{"a", "\[CenterDot]", 
           SubscriptBox["p", "2"]}], "]"}]}], "+", 
        RowBox[{"2", " ", 
         RowBox[{"a", "\[CenterDot]", 
          SubscriptBox["p", "2"]}], " ", 
         RowBox[{"Cos", "[", 
          RowBox[{"a", "\[CenterDot]", 
           SubscriptBox["p", "2"]}], "]"}], " ", 
         RowBox[{"Sin", "[", 
          RowBox[{
           RowBox[{"a", "\[CenterDot]", 
            SubscriptBox["p", "1"]}], "+", 
           RowBox[{"a", "\[CenterDot]", 
            SubscriptBox["p", "3"]}]}], "]"}]}]}], ")"}]}], 
     RowBox[{
      RowBox[{"(", 
       RowBox[{
        RowBox[{"a", "\[CenterDot]", 
         SubscriptBox["p", "1"]}], "+", 
        RowBox[{"a", "\[CenterDot]", 
         SubscriptBox["p", "3"]}]}], ")"}], " ", 
      RowBox[{"(", 
       RowBox[{
        RowBox[{"a", "\[CenterDot]", 
         SubscriptBox["p", "1"]}], "+", 
        RowBox[{"a", "\[CenterDot]", 
         SubscriptBox["p", "2"]}], "+", 
        RowBox[{"a", "\[CenterDot]", 
         SubscriptBox["p", "3"]}]}], ")"}], " ", 
      RowBox[{"(", 
       RowBox[{
        RowBox[{
         SubscriptBox["p", "1"], "\[CenterDot]", 
         SubscriptBox["p", "2"]}], "+", 
        RowBox[{
         SubscriptBox["p", "1"], "\[CenterDot]", 
         SubscriptBox["p", "3"]}]}], ")"}]}]]}], ",", 
   RowBox[{
    RowBox[{"(", 
     RowBox[{"2", " ", 
      RowBox[{
       SubscriptBox["p", "1"], "\[CenterDot]", 
       SubscriptBox["p", "2"]}], " ", 
      RowBox[{
       SubscriptBox["p", "1"], "\[CenterDot]", 
       SubscriptBox["p", "3"]}], " ", 
      RowBox[{"(", 
       RowBox[{
        RowBox[{
         RowBox[{"a", "\[CenterDot]", 
          SubscriptBox["p", "2"]}], " ", 
         RowBox[{"Cos", "[", 
          RowBox[{
           RowBox[{"a", "\[CenterDot]", 
            SubscriptBox["p", "2"]}], "-", 
           RowBox[{"a", "\[CenterDot]", 
            SubscriptBox["p", "3"]}]}], "]"}], " ", 
         RowBox[{"Sin", "[", 
          RowBox[{"a", "\[CenterDot]", 
           SubscriptBox["p", "1"]}], "]"}]}], "+", 
        RowBox[{
         RowBox[{"a", "\[CenterDot]", 
          SubscriptBox["p", "3"]}], " ", 
         RowBox[{"Cos", "[", 
          RowBox[{
           RowBox[{"a", "\[CenterDot]", 
            SubscriptBox["p", "2"]}], "-", 
           RowBox[{"a", "\[CenterDot]", 
            SubscriptBox["p", "3"]}]}], "]"}], " ", 
         RowBox[{"Sin", "[", 
          RowBox[{"a", "\[CenterDot]", 
           SubscriptBox["p", "1"]}], "]"}]}], "+", 
        RowBox[{
         RowBox[{"a", "\[CenterDot]", 
          SubscriptBox["p", "1"]}], " ", 
         RowBox[{"(", 
          RowBox[{
           RowBox[{"2", " ", 
            RowBox[{"Sin", "[", 
             RowBox[{"a", "\[CenterDot]", 
              SubscriptBox["p", "1"]}], "]"}], " ", 
            RowBox[{"Sin", "[", 
             RowBox[{"a", "\[CenterDot]", 
              SubscriptBox["p", "2"]}], "]"}], " ", 
            RowBox[{"Sin", "[", 
             RowBox[{"a", "\[CenterDot]", 
              SubscriptBox["p", "3"]}], "]"}]}], "-", 
           RowBox[{
            RowBox[{"Cos", "[", 
             RowBox[{"a", "\[CenterDot]", 
              SubscriptBox["p", "1"]}], "]"}], " ", 
            RowBox[{"Sin", "[", 
             RowBox[{
              RowBox[{"a", "\[CenterDot]", 
               SubscriptBox["p", "2"]}], "+", 
              RowBox[{"a", "\[CenterDot]", 
               SubscriptBox["p", "3"]}]}], "]"}]}]}], ")"}]}]}], ")"}]}], 
     ")"}], "/", 
    RowBox[{"(", 
     RowBox[{
      RowBox[{"a", "\[CenterDot]", 
       SubscriptBox["p", "1"]}], " ", 
      RowBox[{"(", 
       RowBox[{
        RowBox[{"a", "\[CenterDot]", 
         SubscriptBox["p", "1"]}], "+", 
        RowBox[{"a", "\[CenterDot]", 
         SubscriptBox["p", "2"]}], "+", 
        RowBox[{"a", "\[CenterDot]", 
         SubscriptBox["p", "3"]}]}], ")"}], " ", 
      RowBox[{"(", 
       RowBox[{
        RowBox[{
         SubscriptBox["p", "1"], "\[CenterDot]", 
         SubscriptBox["p", "2"]}], "+", 
        RowBox[{
         SubscriptBox["p", "1"], "\[CenterDot]", 
         SubscriptBox["p", "3"]}]}], ")"}]}], ")"}]}], ",", 
   FractionBox[
    RowBox[{
     RowBox[{"2", " ", 
      RowBox[{"a", "\[CenterDot]", 
       SubscriptBox["p", "3"]}], " ", 
      RowBox[{"Cos", "[", 
       RowBox[{"a", "\[CenterDot]", 
        SubscriptBox["p", "3"]}], "]"}], " ", 
      RowBox[{"Sin", "[", 
       RowBox[{
        RowBox[{"a", "\[CenterDot]", 
         SubscriptBox["p", "1"]}], "+", 
        RowBox[{"a", "\[CenterDot]", 
         SubscriptBox["p", "2"]}]}], "]"}]}], "-", 
     RowBox[{"2", " ", 
      RowBox[{"(", 
       RowBox[{
        RowBox[{"a", "\[CenterDot]", 
         SubscriptBox["p", "1"]}], "+", 
        RowBox[{"a", "\[CenterDot]", 
         SubscriptBox["p", "2"]}]}], ")"}], " ", 
      RowBox[{"Cos", "[", 
       RowBox[{
        RowBox[{"a", "\[CenterDot]", 
         SubscriptBox["p", "1"]}], "+", 
        RowBox[{"a", "\[CenterDot]", 
         SubscriptBox["p", "2"]}]}], "]"}], " ", 
      RowBox[{"Sin", "[", 
       RowBox[{"a", "\[CenterDot]", 
        SubscriptBox["p", "3"]}], "]"}]}]}], 
    RowBox[{
     RowBox[{"(", 
      RowBox[{
       RowBox[{"a", "\[CenterDot]", 
        SubscriptBox["p", "1"]}], "+", 
       RowBox[{"a", "\[CenterDot]", 
        SubscriptBox["p", "2"]}]}], ")"}], " ", 
     RowBox[{"(", 
      RowBox[{
       RowBox[{"a", "\[CenterDot]", 
        SubscriptBox["p", "1"]}], "+", 
       RowBox[{"a", "\[CenterDot]", 
        SubscriptBox["p", "2"]}], "+", 
       RowBox[{"a", "\[CenterDot]", 
        SubscriptBox["p", "3"]}]}], ")"}]}]], ",", 
   FractionBox[
    RowBox[{
     RowBox[{
      SubscriptBox["p", "1"], "\[CenterDot]", 
      SubscriptBox["p", "3"]}], " ", 
     RowBox[{"(", 
      RowBox[{
       RowBox[{"2", " ", 
        RowBox[{"a", "\[CenterDot]", 
         SubscriptBox["p", "3"]}], " ", 
        RowBox[{"Cos", "[", 
         RowBox[{"a", "\[CenterDot]", 
          SubscriptBox["p", "3"]}], "]"}], " ", 
        RowBox[{"Sin", "[", 
         RowBox[{
          RowBox[{"a", "\[CenterDot]", 
           SubscriptBox["p", "1"]}], "+", 
          RowBox[{"a", "\[CenterDot]", 
           SubscriptBox["p", "2"]}]}], "]"}]}], "-", 
       RowBox[{"2", " ", 
        RowBox[{"(", 
         RowBox[{
          RowBox[{"a", "\[CenterDot]", 
           SubscriptBox["p", "1"]}], "+", 
          RowBox[{"a", "\[CenterDot]", 
           SubscriptBox["p", "2"]}]}], ")"}], " ", 
        RowBox[{"Cos", "[", 
         RowBox[{
          RowBox[{"a", "\[CenterDot]", 
           SubscriptBox["p", "1"]}], "+", 
          RowBox[{"a", "\[CenterDot]", 
           SubscriptBox["p", "2"]}]}], "]"}], " ", 
        RowBox[{"Sin", "[", 
         RowBox[{"a", "\[CenterDot]", 
          SubscriptBox["p", "3"]}], "]"}]}]}], ")"}]}], 
    RowBox[{
     RowBox[{"(", 
      RowBox[{
       RowBox[{"a", "\[CenterDot]", 
        SubscriptBox["p", "1"]}], "+", 
       RowBox[{"a", "\[CenterDot]", 
        SubscriptBox["p", "2"]}]}], ")"}], " ", 
     RowBox[{"(", 
      RowBox[{
       RowBox[{"a", "\[CenterDot]", 
        SubscriptBox["p", "1"]}], "+", 
       RowBox[{"a", "\[CenterDot]", 
        SubscriptBox["p", "2"]}], "+", 
       RowBox[{"a", "\[CenterDot]", 
        SubscriptBox["p", "3"]}]}], ")"}], " ", 
     RowBox[{"(", 
      RowBox[{
       RowBox[{
        SubscriptBox["p", "1"], "\[CenterDot]", 
        SubscriptBox["p", "2"]}], "+", 
       RowBox[{
        SubscriptBox["p", "1"], "\[CenterDot]", 
        SubscriptBox["p", "3"]}]}], ")"}]}]], ",", 
   FractionBox[
    RowBox[{"2", " ", 
     RowBox[{
      SubscriptBox["p", "1"], "\[CenterDot]", 
      SubscriptBox["p", "2"]}], " ", 
     RowBox[{"Sin", "[", 
      RowBox[{
       RowBox[{"a", "\[CenterDot]", 
        SubscriptBox["p", "1"]}], "+", 
       RowBox[{"a", "\[CenterDot]", 
        SubscriptBox["p", "2"]}], "+", 
       RowBox[{"a", "\[CenterDot]", 
        SubscriptBox["p", "3"]}]}], "]"}]}], 
    RowBox[{
     RowBox[{"(", 
      RowBox[{
       RowBox[{"a", "\[CenterDot]", 
        SubscriptBox["p", "1"]}], "+", 
       RowBox[{"a", "\[CenterDot]", 
        SubscriptBox["p", "2"]}], "+", 
       RowBox[{"a", "\[CenterDot]", 
        SubscriptBox["p", "3"]}]}], ")"}], " ", 
     RowBox[{"(", 
      RowBox[{
       RowBox[{
        SubscriptBox["p", "1"], "\[CenterDot]", 
        SubscriptBox["p", "2"]}], "+", 
       RowBox[{
        SubscriptBox["p", "1"], "\[CenterDot]", 
        SubscriptBox["p", "3"]}]}], ")"}]}]], ",", 
   FractionBox[
    RowBox[{"2", " ", 
     RowBox[{
      SubscriptBox["p", "1"], "\[CenterDot]", 
      SubscriptBox["p", "2"]}], " ", 
     RowBox[{"Sin", "[", 
      RowBox[{
       RowBox[{"a", "\[CenterDot]", 
        SubscriptBox["p", "1"]}], "+", 
       RowBox[{"a", "\[CenterDot]", 
        SubscriptBox["p", "2"]}], "+", 
       RowBox[{"a", "\[CenterDot]", 
        SubscriptBox["p", "3"]}]}], "]"}]}], 
    RowBox[{
     RowBox[{"a", "\[CenterDot]", 
      SubscriptBox["p", "1"]}], "+", 
     RowBox[{"a", "\[CenterDot]", 
      SubscriptBox["p", "2"]}], "+", 
     RowBox[{"a", "\[CenterDot]", 
      SubscriptBox["p", "3"]}]}]], ",", 
   FractionBox[
    RowBox[{
     RowBox[{
      RowBox[{"-", "2"}], " ", 
      RowBox[{"(", 
       RowBox[{
        RowBox[{"a", "\[CenterDot]", 
         SubscriptBox["p", "1"]}], "+", 
        RowBox[{"a", "\[CenterDot]", 
         SubscriptBox["p", "3"]}]}], ")"}], " ", 
      RowBox[{"Cos", "[", 
       RowBox[{
        RowBox[{"a", "\[CenterDot]", 
         SubscriptBox["p", "1"]}], "+", 
        RowBox[{"a", "\[CenterDot]", 
         SubscriptBox["p", "3"]}]}], "]"}], " ", 
      RowBox[{"Sin", "[", 
       RowBox[{"a", "\[CenterDot]", 
        SubscriptBox["p", "2"]}], "]"}]}], "+", 
     RowBox[{"2", " ", 
      RowBox[{"a", "\[CenterDot]", 
       SubscriptBox["p", "2"]}], " ", 
      RowBox[{"Cos", "[", 
       RowBox[{"a", "\[CenterDot]", 
        SubscriptBox["p", "2"]}], "]"}], " ", 
      RowBox[{"Sin", "[", 
       RowBox[{
        RowBox[{"a", "\[CenterDot]", 
         SubscriptBox["p", "1"]}], "+", 
        RowBox[{"a", "\[CenterDot]", 
         SubscriptBox["p", "3"]}]}], "]"}]}]}], 
    RowBox[{
     RowBox[{"(", 
      RowBox[{
       RowBox[{"a", "\[CenterDot]", 
        SubscriptBox["p", "1"]}], "+", 
       RowBox[{"a", "\[CenterDot]", 
        SubscriptBox["p", "3"]}]}], ")"}], " ", 
     RowBox[{"(", 
      RowBox[{
       RowBox[{"a", "\[CenterDot]", 
        SubscriptBox["p", "1"]}], "+", 
       RowBox[{"a", "\[CenterDot]", 
        SubscriptBox["p", "2"]}], "+", 
       RowBox[{"a", "\[CenterDot]", 
        SubscriptBox["p", "3"]}]}], ")"}]}]], ",", 
   FractionBox[
    RowBox[{"2", " ", 
     RowBox[{
      SubscriptBox["p", "1"], "\[CenterDot]", 
      SubscriptBox["p", "3"]}], " ", 
     RowBox[{"Sin", "[", 
      RowBox[{
       RowBox[{"a", "\[CenterDot]", 
        SubscriptBox["p", "1"]}], "+", 
       RowBox[{"a", "\[CenterDot]", 
        SubscriptBox["p", "2"]}], "+", 
       RowBox[{"a", "\[CenterDot]", 
        SubscriptBox["p", "3"]}]}], "]"}]}], 
    RowBox[{
     RowBox[{"(", 
      RowBox[{
       RowBox[{"a", "\[CenterDot]", 
        SubscriptBox["p", "1"]}], "+", 
       RowBox[{"a", "\[CenterDot]", 
        SubscriptBox["p", "2"]}], "+", 
       RowBox[{"a", "\[CenterDot]", 
        SubscriptBox["p", "3"]}]}], ")"}], " ", 
     RowBox[{"(", 
      RowBox[{
       RowBox[{
        SubscriptBox["p", "1"], "\[CenterDot]", 
        SubscriptBox["p", "2"]}], "+", 
       RowBox[{
        SubscriptBox["p", "1"], "\[CenterDot]", 
        SubscriptBox["p", "3"]}]}], ")"}]}]], ",", 
   FractionBox[
    RowBox[{
     RowBox[{
      SubscriptBox["p", "1"], "\[CenterDot]", 
      SubscriptBox["p", "2"]}], " ", 
     RowBox[{"(", 
      RowBox[{
       RowBox[{
        RowBox[{"-", "2"}], " ", 
        RowBox[{"(", 
         RowBox[{
          RowBox[{"a", "\[CenterDot]", 
           SubscriptBox["p", "1"]}], "+", 
          RowBox[{"a", "\[CenterDot]", 
           SubscriptBox["p", "3"]}]}], ")"}], " ", 
        RowBox[{"Cos", "[", 
         RowBox[{
          RowBox[{"a", "\[CenterDot]", 
           SubscriptBox["p", "1"]}], "+", 
          RowBox[{"a", "\[CenterDot]", 
           SubscriptBox["p", "3"]}]}], "]"}], " ", 
        RowBox[{"Sin", "[", 
         RowBox[{"a", "\[CenterDot]", 
          SubscriptBox["p", "2"]}], "]"}]}], "+", 
       RowBox[{"2", " ", 
        RowBox[{"a", "\[CenterDot]", 
         SubscriptBox["p", "2"]}], " ", 
        RowBox[{"Cos", "[", 
         RowBox[{"a", "\[CenterDot]", 
          SubscriptBox["p", "2"]}], "]"}], " ", 
        RowBox[{"Sin", "[", 
         RowBox[{
          RowBox[{"a", "\[CenterDot]", 
           SubscriptBox["p", "1"]}], "+", 
          RowBox[{"a", "\[CenterDot]", 
           SubscriptBox["p", "3"]}]}], "]"}]}]}], ")"}]}], 
    RowBox[{
     RowBox[{"(", 
      RowBox[{
       RowBox[{"a", "\[CenterDot]", 
        SubscriptBox["p", "1"]}], "+", 
       RowBox[{"a", "\[CenterDot]", 
        SubscriptBox["p", "3"]}]}], ")"}], " ", 
     RowBox[{"(", 
      RowBox[{
       RowBox[{"a", "\[CenterDot]", 
        SubscriptBox["p", "1"]}], "+", 
       RowBox[{"a", "\[CenterDot]", 
        SubscriptBox["p", "2"]}], "+", 
       RowBox[{"a", "\[CenterDot]", 
        SubscriptBox["p", "3"]}]}], ")"}], " ", 
     RowBox[{"(", 
      RowBox[{
       RowBox[{
        SubscriptBox["p", "1"], "\[CenterDot]", 
        SubscriptBox["p", "2"]}], "+", 
       RowBox[{
        SubscriptBox["p", "1"], "\[CenterDot]", 
        SubscriptBox["p", "3"]}]}], ")"}]}]], ",", 
   FractionBox[
    RowBox[{"2", " ", 
     RowBox[{
      SubscriptBox["p", "1"], "\[CenterDot]", 
      SubscriptBox["p", "3"]}], " ", 
     RowBox[{"Sin", "[", 
      RowBox[{
       RowBox[{"a", "\[CenterDot]", 
        SubscriptBox["p", "1"]}], "+", 
       RowBox[{"a", "\[CenterDot]", 
        SubscriptBox["p", "2"]}], "+", 
       RowBox[{"a", "\[CenterDot]", 
        SubscriptBox["p", "3"]}]}], "]"}]}], 
    RowBox[{
     RowBox[{"a", "\[CenterDot]", 
      SubscriptBox["p", "1"]}], "+", 
     RowBox[{"a", "\[CenterDot]", 
      SubscriptBox["p", "2"]}], "+", 
     RowBox[{"a", "\[CenterDot]", 
      SubscriptBox["p", "3"]}]}]], ",", 
   FractionBox[
    RowBox[{
     RowBox[{
      RowBox[{"-", "2"}], " ", 
      RowBox[{"a", "\[CenterDot]", 
       SubscriptBox["p", "3"]}], " ", 
      RowBox[{"Cos", "[", 
       RowBox[{"a", "\[CenterDot]", 
        SubscriptBox["p", "3"]}], "]"}], " ", 
      RowBox[{"Sin", "[", 
       RowBox[{
        RowBox[{"a", "\[CenterDot]", 
         SubscriptBox["p", "1"]}], "+", 
        RowBox[{"a", "\[CenterDot]", 
         SubscriptBox["p", "2"]}]}], "]"}]}], "+", 
     RowBox[{"2", " ", 
      RowBox[{"(", 
       RowBox[{
        RowBox[{"a", "\[CenterDot]", 
         SubscriptBox["p", "1"]}], "+", 
        RowBox[{"a", "\[CenterDot]", 
         SubscriptBox["p", "2"]}]}], ")"}], " ", 
      RowBox[{"Cos", "[", 
       RowBox[{
        RowBox[{"a", "\[CenterDot]", 
         SubscriptBox["p", "1"]}], "+", 
        RowBox[{"a", "\[CenterDot]", 
         SubscriptBox["p", "2"]}]}], "]"}], " ", 
      RowBox[{"Sin", "[", 
       RowBox[{"a", "\[CenterDot]", 
        SubscriptBox["p", "3"]}], "]"}]}]}], 
    RowBox[{
     RowBox[{"(", 
      RowBox[{
       RowBox[{"a", "\[CenterDot]", 
        SubscriptBox["p", "1"]}], "+", 
       RowBox[{"a", "\[CenterDot]", 
        SubscriptBox["p", "2"]}]}], ")"}], " ", 
     RowBox[{"(", 
      RowBox[{
       RowBox[{"a", "\[CenterDot]", 
        SubscriptBox["p", "1"]}], "+", 
       RowBox[{"a", "\[CenterDot]", 
        SubscriptBox["p", "2"]}], "+", 
       RowBox[{"a", "\[CenterDot]", 
        SubscriptBox["p", "3"]}]}], ")"}]}]], ",", 
   FractionBox[
    RowBox[{"2", " ", 
     RowBox[{
      SubscriptBox["p", "1"], "\[CenterDot]", 
      SubscriptBox["p", "3"]}], " ", 
     RowBox[{"(", 
      RowBox[{
       RowBox[{
        RowBox[{"-", 
         RowBox[{"(", 
          RowBox[{"a", "\[CenterDot]", 
           SubscriptBox["p", "3"]}], ")"}]}], " ", 
        RowBox[{"Cos", "[", 
         RowBox[{"a", "\[CenterDot]", 
          SubscriptBox["p", "3"]}], "]"}], " ", 
        RowBox[{"Sin", "[", 
         RowBox[{
          RowBox[{"a", "\[CenterDot]", 
           SubscriptBox["p", "1"]}], "+", 
          RowBox[{"a", "\[CenterDot]", 
           SubscriptBox["p", "2"]}]}], "]"}]}], "+", 
       RowBox[{
        RowBox[{"(", 
         RowBox[{
          RowBox[{"a", "\[CenterDot]", 
           SubscriptBox["p", "1"]}], "+", 
          RowBox[{"a", "\[CenterDot]", 
           SubscriptBox["p", "2"]}]}], ")"}], " ", 
        RowBox[{"Cos", "[", 
         RowBox[{
          RowBox[{"a", "\[CenterDot]", 
           SubscriptBox["p", "1"]}], "+", 
          RowBox[{"a", "\[CenterDot]", 
           SubscriptBox["p", "2"]}]}], "]"}], " ", 
        RowBox[{"Sin", "[", 
         RowBox[{"a", "\[CenterDot]", 
          SubscriptBox["p", "3"]}], "]"}]}]}], ")"}]}], 
    RowBox[{
     RowBox[{"(", 
      RowBox[{
       RowBox[{"a", "\[CenterDot]", 
        SubscriptBox["p", "1"]}], "+", 
       RowBox[{"a", "\[CenterDot]", 
        SubscriptBox["p", "2"]}]}], ")"}], " ", 
     RowBox[{"(", 
      RowBox[{
       RowBox[{"a", "\[CenterDot]", 
        SubscriptBox["p", "1"]}], "+", 
       RowBox[{"a", "\[CenterDot]", 
        SubscriptBox["p", "2"]}], "+", 
       RowBox[{"a", "\[CenterDot]", 
        SubscriptBox["p", "3"]}]}], ")"}], " ", 
     RowBox[{"(", 
      RowBox[{
       RowBox[{
        SubscriptBox["p", "1"], "\[CenterDot]", 
        SubscriptBox["p", "2"]}], "+", 
       RowBox[{
        SubscriptBox["p", "1"], "\[CenterDot]", 
        SubscriptBox["p", "3"]}]}], ")"}]}]], ",", 
   FractionBox[
    RowBox[{"2", " ", 
     RowBox[{
      SubscriptBox["p", "1"], "\[CenterDot]", 
      SubscriptBox["p", "2"]}], " ", 
     RowBox[{"Sin", "[", 
      RowBox[{
       RowBox[{"a", "\[CenterDot]", 
        SubscriptBox["p", "1"]}], "+", 
       RowBox[{"a", "\[CenterDot]", 
        SubscriptBox["p", "2"]}], "+", 
       RowBox[{"a", "\[CenterDot]", 
        SubscriptBox["p", "3"]}]}], "]"}]}], 
    RowBox[{
     RowBox[{"(", 
      RowBox[{
       RowBox[{"a", "\[CenterDot]", 
        SubscriptBox["p", "1"]}], "+", 
       RowBox[{"a", "\[CenterDot]", 
        SubscriptBox["p", "2"]}], "+", 
       RowBox[{"a", "\[CenterDot]", 
        SubscriptBox["p", "3"]}]}], ")"}], " ", 
     RowBox[{"(", 
      RowBox[{
       RowBox[{
        SubscriptBox["p", "1"], "\[CenterDot]", 
        SubscriptBox["p", "2"]}], "+", 
       RowBox[{
        SubscriptBox["p", "1"], "\[CenterDot]", 
        SubscriptBox["p", "3"]}]}], ")"}]}]], ",", 
   RowBox[{"-", 
    FractionBox[
     RowBox[{"2", " ", 
      RowBox[{
       SubscriptBox["p", "1"], "\[CenterDot]", 
       SubscriptBox["p", "2"]}], " ", 
      RowBox[{
       SubscriptBox["p", "1"], "\[CenterDot]", 
       SubscriptBox["p", "3"]}], " ", 
      RowBox[{"Sin", "[", 
       RowBox[{
        RowBox[{"a", "\[CenterDot]", 
         SubscriptBox["p", "1"]}], "+", 
        RowBox[{"a", "\[CenterDot]", 
         SubscriptBox["p", "2"]}], "+", 
        RowBox[{"a", "\[CenterDot]", 
         SubscriptBox["p", "3"]}]}], "]"}]}], 
     RowBox[{
      RowBox[{"(", 
       RowBox[{
        RowBox[{"a", "\[CenterDot]", 
         SubscriptBox["p", "1"]}], "+", 
        RowBox[{"a", "\[CenterDot]", 
         SubscriptBox["p", "2"]}], "+", 
        RowBox[{"a", "\[CenterDot]", 
         SubscriptBox["p", "3"]}]}], ")"}], " ", 
      RowBox[{"(", 
       RowBox[{
        RowBox[{
         SubscriptBox["p", "1"], "\[CenterDot]", 
         SubscriptBox["p", "2"]}], "+", 
        RowBox[{
         SubscriptBox["p", "1"], "\[CenterDot]", 
         SubscriptBox["p", "3"]}]}], ")"}]}]]}], ",", 
   FractionBox[
    RowBox[{"2", " ", 
     RowBox[{
      SubscriptBox["p", "1"], "\[CenterDot]", 
      SubscriptBox["p", "2"]}], " ", 
     RowBox[{"Cos", "[", 
      RowBox[{"a", "\[CenterDot]", 
       SubscriptBox["p", "3"]}], "]"}], " ", 
     RowBox[{"(", 
      RowBox[{
       RowBox[{
        RowBox[{"-", 
         RowBox[{"(", 
          RowBox[{"a", "\[CenterDot]", 
           SubscriptBox["p", "2"]}], ")"}]}], " ", 
        RowBox[{"Cos", "[", 
         RowBox[{"a", "\[CenterDot]", 
          SubscriptBox["p", "2"]}], "]"}], " ", 
        RowBox[{"Sin", "[", 
         RowBox[{"a", "\[CenterDot]", 
          SubscriptBox["p", "1"]}], "]"}]}], "+", 
       RowBox[{
        RowBox[{"a", "\[CenterDot]", 
         SubscriptBox["p", "1"]}], " ", 
        RowBox[{"Cos", "[", 
         RowBox[{"a", "\[CenterDot]", 
          SubscriptBox["p", "1"]}], "]"}], " ", 
        RowBox[{"Sin", "[", 
         RowBox[{"a", "\[CenterDot]", 
          SubscriptBox["p", "2"]}], "]"}]}]}], ")"}]}], 
    RowBox[{
     RowBox[{"a", "\[CenterDot]", 
      SubscriptBox["p", "1"]}], " ", 
     RowBox[{"a", "\[CenterDot]", 
      SubscriptBox["p", "2"]}], " ", 
     RowBox[{"(", 
      RowBox[{
       RowBox[{"a", "\[CenterDot]", 
        SubscriptBox["p", "1"]}], "+", 
       RowBox[{"a", "\[CenterDot]", 
        SubscriptBox["p", "2"]}]}], ")"}]}]], ",", 
   FractionBox[
    RowBox[{"2", " ", 
     RowBox[{
      SubscriptBox["p", "1"], "\[CenterDot]", 
      SubscriptBox["p", "3"]}], " ", 
     RowBox[{"Cos", "[", 
      RowBox[{"a", "\[CenterDot]", 
       SubscriptBox["p", "1"]}], "]"}], " ", 
     RowBox[{"(", 
      RowBox[{
       RowBox[{
        RowBox[{"-", 
         RowBox[{"(", 
          RowBox[{"a", "\[CenterDot]", 
           SubscriptBox["p", "3"]}], ")"}]}], " ", 
        RowBox[{"Cos", "[", 
         RowBox[{"a", "\[CenterDot]", 
          SubscriptBox["p", "3"]}], "]"}], " ", 
        RowBox[{"Sin", "[", 
         RowBox[{"a", "\[CenterDot]", 
          SubscriptBox["p", "2"]}], "]"}]}], "+", 
       RowBox[{
        RowBox[{"a", "\[CenterDot]", 
         SubscriptBox["p", "2"]}], " ", 
        RowBox[{"Cos", "[", 
         RowBox[{"a", "\[CenterDot]", 
          SubscriptBox["p", "2"]}], "]"}], " ", 
        RowBox[{"Sin", "[", 
         RowBox[{"a", "\[CenterDot]", 
          SubscriptBox["p", "3"]}], "]"}]}]}], ")"}]}], 
    RowBox[{
     RowBox[{"a", "\[CenterDot]", 
      SubscriptBox["p", "2"]}], " ", 
     RowBox[{"a", "\[CenterDot]", 
      SubscriptBox["p", "3"]}], " ", 
     RowBox[{"(", 
      RowBox[{
       RowBox[{"a", "\[CenterDot]", 
        SubscriptBox["p", "2"]}], "+", 
       RowBox[{"a", "\[CenterDot]", 
        SubscriptBox["p", "3"]}]}], ")"}]}]], ",", 
   FractionBox[
    RowBox[{
     RowBox[{"2", " ", 
      RowBox[{"a", "\[CenterDot]", 
       SubscriptBox["p", "3"]}], " ", 
      RowBox[{"Cos", "[", 
       RowBox[{"a", "\[CenterDot]", 
        SubscriptBox["p", "3"]}], "]"}], " ", 
      RowBox[{"Sin", "[", 
       RowBox[{
        RowBox[{"a", "\[CenterDot]", 
         SubscriptBox["p", "1"]}], "+", 
        RowBox[{"a", "\[CenterDot]", 
         SubscriptBox["p", "2"]}]}], "]"}]}], "-", 
     RowBox[{"2", " ", 
      RowBox[{"(", 
       RowBox[{
        RowBox[{"a", "\[CenterDot]", 
         SubscriptBox["p", "1"]}], "+", 
        RowBox[{"a", "\[CenterDot]", 
         SubscriptBox["p", "2"]}]}], ")"}], " ", 
      RowBox[{"Cos", "[", 
       RowBox[{
        RowBox[{"a", "\[CenterDot]", 
         SubscriptBox["p", "1"]}], "+", 
        RowBox[{"a", "\[CenterDot]", 
         SubscriptBox["p", "2"]}]}], "]"}], " ", 
      RowBox[{"Sin", "[", 
       RowBox[{"a", "\[CenterDot]", 
        SubscriptBox["p", "3"]}], "]"}]}]}], 
    RowBox[{
     RowBox[{"(", 
      RowBox[{
       RowBox[{"a", "\[CenterDot]", 
        SubscriptBox["p", "1"]}], "+", 
       RowBox[{"a", "\[CenterDot]", 
        SubscriptBox["p", "2"]}]}], ")"}], " ", 
     RowBox[{"(", 
      RowBox[{
       RowBox[{"a", "\[CenterDot]", 
        SubscriptBox["p", "1"]}], "+", 
       RowBox[{"a", "\[CenterDot]", 
        SubscriptBox["p", "2"]}], "+", 
       RowBox[{"a", "\[CenterDot]", 
        SubscriptBox["p", "3"]}]}], ")"}]}]], ",", 
   FractionBox[
    RowBox[{"2", " ", 
     RowBox[{
      SubscriptBox["p", "1"], "\[CenterDot]", 
      SubscriptBox["p", "2"]}], " ", 
     RowBox[{
      SubscriptBox["p", "1"], "\[CenterDot]", 
      SubscriptBox["p", "3"]}], " ", 
     RowBox[{"Cos", "[", 
      RowBox[{"a", "\[CenterDot]", 
       SubscriptBox["p", "3"]}], "]"}], " ", 
     RowBox[{"(", 
      RowBox[{
       RowBox[{
        RowBox[{"-", 
         RowBox[{"(", 
          RowBox[{"a", "\[CenterDot]", 
           SubscriptBox["p", "2"]}], ")"}]}], " ", 
        RowBox[{"Cos", "[", 
         RowBox[{"a", "\[CenterDot]", 
          SubscriptBox["p", "2"]}], "]"}], " ", 
        RowBox[{"Sin", "[", 
         RowBox[{"a", "\[CenterDot]", 
          SubscriptBox["p", "1"]}], "]"}]}], "+", 
       RowBox[{
        RowBox[{"a", "\[CenterDot]", 
         SubscriptBox["p", "1"]}], " ", 
        RowBox[{"Cos", "[", 
         RowBox[{"a", "\[CenterDot]", 
          SubscriptBox["p", "1"]}], "]"}], " ", 
        RowBox[{"Sin", "[", 
         RowBox[{"a", "\[CenterDot]", 
          SubscriptBox["p", "2"]}], "]"}]}]}], ")"}]}], 
    RowBox[{
     RowBox[{"a", "\[CenterDot]", 
      SubscriptBox["p", "1"]}], " ", 
     RowBox[{"a", "\[CenterDot]", 
      SubscriptBox["p", "2"]}], " ", 
     RowBox[{"(", 
      RowBox[{
       RowBox[{"a", "\[CenterDot]", 
        SubscriptBox["p", "1"]}], "+", 
       RowBox[{"a", "\[CenterDot]", 
        SubscriptBox["p", "2"]}]}], ")"}], " ", 
     RowBox[{"(", 
      RowBox[{
       RowBox[{
        SubscriptBox["p", "1"], "\[CenterDot]", 
        SubscriptBox["p", "2"]}], "+", 
       RowBox[{
        SubscriptBox["p", "1"], "\[CenterDot]", 
        SubscriptBox["p", "3"]}]}], ")"}]}]], ",", 
   RowBox[{
    RowBox[{"(", 
     RowBox[{"2", " ", 
      RowBox[{
       SubscriptBox["p", "1"], "\[CenterDot]", 
       SubscriptBox["p", "3"]}], " ", 
      RowBox[{"(", 
       RowBox[{
        RowBox[{
         RowBox[{"-", 
          RowBox[{"(", 
           RowBox[{"a", "\[CenterDot]", 
            SubscriptBox["p", "1"]}], ")"}]}], " ", 
         RowBox[{"a", "\[CenterDot]", 
          SubscriptBox["p", "3"]}], " ", 
         RowBox[{"(", 
          RowBox[{
           RowBox[{"a", "\[CenterDot]", 
            SubscriptBox["p", "1"]}], "+", 
           RowBox[{"a", "\[CenterDot]", 
            SubscriptBox["p", "3"]}]}], ")"}], " ", 
         RowBox[{"Cos", "[", 
          RowBox[{"a", "\[CenterDot]", 
           SubscriptBox["p", "1"]}], "]"}], " ", 
         RowBox[{"Cos", "[", 
          RowBox[{"a", "\[CenterDot]", 
           SubscriptBox["p", "3"]}], "]"}], " ", 
         RowBox[{"Sin", "[", 
          RowBox[{"a", "\[CenterDot]", 
           SubscriptBox["p", "2"]}], "]"}]}], "+", 
        RowBox[{
         SuperscriptBox[
          RowBox[{"(", 
           RowBox[{"a", "\[CenterDot]", 
            SubscriptBox["p", "2"]}], ")"}], "3"], " ", 
         RowBox[{"Sin", "[", 
          RowBox[{"a", "\[CenterDot]", 
           SubscriptBox["p", "1"]}], "]"}], " ", 
         RowBox[{"Sin", "[", 
          RowBox[{"a", "\[CenterDot]", 
           SubscriptBox["p", "2"]}], "]"}], " ", 
         RowBox[{"Sin", "[", 
          RowBox[{"a", "\[CenterDot]", 
           SubscriptBox["p", "3"]}], "]"}]}], "+", 
        RowBox[{
         SuperscriptBox[
          RowBox[{"(", 
           RowBox[{"a", "\[CenterDot]", 
            SubscriptBox["p", "2"]}], ")"}], "2"], " ", 
         RowBox[{"(", 
          RowBox[{
           RowBox[{
            RowBox[{"a", "\[CenterDot]", 
             SubscriptBox["p", "3"]}], " ", 
            RowBox[{"Cos", "[", 
             RowBox[{
              RowBox[{"a", "\[CenterDot]", 
               SubscriptBox["p", "2"]}], "-", 
              RowBox[{"a", "\[CenterDot]", 
               SubscriptBox["p", "3"]}]}], "]"}], " ", 
            RowBox[{"Sin", "[", 
             RowBox[{"a", "\[CenterDot]", 
              SubscriptBox["p", "1"]}], "]"}]}], "+", 
           RowBox[{
            RowBox[{"a", "\[CenterDot]", 
             SubscriptBox["p", "1"]}], " ", 
            RowBox[{"Cos", "[", 
             RowBox[{
              RowBox[{"a", "\[CenterDot]", 
               SubscriptBox["p", "1"]}], "-", 
              RowBox[{"a", "\[CenterDot]", 
               SubscriptBox["p", "2"]}]}], "]"}], " ", 
            RowBox[{"Sin", "[", 
             RowBox[{"a", "\[CenterDot]", 
              SubscriptBox["p", "3"]}], "]"}]}]}], ")"}]}], "+", 
        RowBox[{
         RowBox[{"a", "\[CenterDot]", 
          SubscriptBox["p", "2"]}], " ", 
         RowBox[{"(", 
          RowBox[{
           RowBox[{
            SuperscriptBox[
             RowBox[{"(", 
              RowBox[{"a", "\[CenterDot]", 
               SubscriptBox["p", "3"]}], ")"}], "2"], " ", 
            RowBox[{"Cos", "[", 
             RowBox[{"a", "\[CenterDot]", 
              SubscriptBox["p", "2"]}], "]"}], " ", 
            RowBox[{"Cos", "[", 
             RowBox[{"a", "\[CenterDot]", 
              SubscriptBox["p", "3"]}], "]"}], " ", 
            RowBox[{"Sin", "[", 
             RowBox[{"a", "\[CenterDot]", 
              SubscriptBox["p", "1"]}], "]"}]}], "+", 
           RowBox[{
            SuperscriptBox[
             RowBox[{"(", 
              RowBox[{"a", "\[CenterDot]", 
               SubscriptBox["p", "1"]}], ")"}], "2"], " ", 
            RowBox[{"Cos", "[", 
             RowBox[{"a", "\[CenterDot]", 
              SubscriptBox["p", "1"]}], "]"}], " ", 
            RowBox[{"Cos", "[", 
             RowBox[{"a", "\[CenterDot]", 
              SubscriptBox["p", "2"]}], "]"}], " ", 
            RowBox[{"Sin", "[", 
             RowBox[{"a", "\[CenterDot]", 
              SubscriptBox["p", "3"]}], "]"}]}], "-", 
           RowBox[{
            RowBox[{"a", "\[CenterDot]", 
             SubscriptBox["p", "1"]}], " ", 
            RowBox[{"a", "\[CenterDot]", 
             SubscriptBox["p", "3"]}], " ", 
            RowBox[{"Sin", "[", 
             RowBox[{"a", "\[CenterDot]", 
              SubscriptBox["p", "2"]}], "]"}], " ", 
            RowBox[{"(", 
             RowBox[{
              RowBox[{"2", " ", 
               RowBox[{"Cos", "[", 
                RowBox[{"a", "\[CenterDot]", 
                 SubscriptBox["p", "1"]}], "]"}], " ", 
               RowBox[{"Cos", "[", 
                RowBox[{"a", "\[CenterDot]", 
                 SubscriptBox["p", "3"]}], "]"}]}], "-", 
              RowBox[{
               RowBox[{"Sin", "[", 
                RowBox[{"a", "\[CenterDot]", 
                 SubscriptBox["p", "1"]}], "]"}], " ", 
               RowBox[{"Sin", "[", 
                RowBox[{"a", "\[CenterDot]", 
                 SubscriptBox["p", "3"]}], "]"}]}]}], ")"}]}]}], ")"}]}]}], 
       ")"}]}], ")"}], "/", 
    RowBox[{"(", 
     RowBox[{
      RowBox[{"a", "\[CenterDot]", 
       SubscriptBox["p", "2"]}], " ", 
      RowBox[{"(", 
       RowBox[{
        RowBox[{"a", "\[CenterDot]", 
         SubscriptBox["p", "1"]}], "+", 
        RowBox[{"a", "\[CenterDot]", 
         SubscriptBox["p", "2"]}]}], ")"}], " ", 
      RowBox[{"(", 
       RowBox[{
        RowBox[{"a", "\[CenterDot]", 
         SubscriptBox["p", "2"]}], "+", 
        RowBox[{"a", "\[CenterDot]", 
         SubscriptBox["p", "3"]}]}], ")"}], " ", 
      RowBox[{"(", 
       RowBox[{
        RowBox[{"a", "\[CenterDot]", 
         SubscriptBox["p", "1"]}], "+", 
        RowBox[{"a", "\[CenterDot]", 
         SubscriptBox["p", "2"]}], "+", 
        RowBox[{"a", "\[CenterDot]", 
         SubscriptBox["p", "3"]}]}], ")"}], " ", 
      RowBox[{"(", 
       RowBox[{
        RowBox[{
         SubscriptBox["p", "1"], "\[CenterDot]", 
         SubscriptBox["p", "2"]}], "+", 
        RowBox[{
         SubscriptBox["p", "1"], "\[CenterDot]", 
         SubscriptBox["p", "3"]}]}], ")"}]}], ")"}]}], ",", 
   FractionBox[
    RowBox[{"2", " ", 
     RowBox[{
      SubscriptBox["p", "1"], "\[CenterDot]", 
      SubscriptBox["p", "2"]}], " ", 
     RowBox[{"Cos", "[", 
      RowBox[{"a", "\[CenterDot]", 
       SubscriptBox["p", "1"]}], "]"}], " ", 
     RowBox[{"(", 
      RowBox[{
       RowBox[{
        RowBox[{"a", "\[CenterDot]", 
         SubscriptBox["p", "3"]}], " ", 
        RowBox[{"Cos", "[", 
         RowBox[{"a", "\[CenterDot]", 
          SubscriptBox["p", "3"]}], "]"}], " ", 
        RowBox[{"Sin", "[", 
         RowBox[{"a", "\[CenterDot]", 
          SubscriptBox["p", "2"]}], "]"}]}], "-", 
       RowBox[{
        RowBox[{"a", "\[CenterDot]", 
         SubscriptBox["p", "2"]}], " ", 
        RowBox[{"Cos", "[", 
         RowBox[{"a", "\[CenterDot]", 
          SubscriptBox["p", "2"]}], "]"}], " ", 
        RowBox[{"Sin", "[", 
         RowBox[{"a", "\[CenterDot]", 
          SubscriptBox["p", "3"]}], "]"}]}]}], ")"}]}], 
    RowBox[{
     RowBox[{"a", "\[CenterDot]", 
      SubscriptBox["p", "2"]}], " ", 
     RowBox[{"a", "\[CenterDot]", 
      SubscriptBox["p", "3"]}], " ", 
     RowBox[{"(", 
      RowBox[{
       RowBox[{"a", "\[CenterDot]", 
        SubscriptBox["p", "2"]}], "+", 
       RowBox[{"a", "\[CenterDot]", 
        SubscriptBox["p", "3"]}]}], ")"}]}]], ",", 
   RowBox[{
    RowBox[{"(", 
     RowBox[{"2", " ", 
      RowBox[{
       SubscriptBox["p", "1"], "\[CenterDot]", 
       SubscriptBox["p", "2"]}], " ", 
      RowBox[{"(", 
       RowBox[{
        RowBox[{
         RowBox[{"a", "\[CenterDot]", 
          SubscriptBox["p", "2"]}], " ", 
         RowBox[{"Cos", "[", 
          RowBox[{
           RowBox[{"a", "\[CenterDot]", 
            SubscriptBox["p", "2"]}], "+", 
           RowBox[{"a", "\[CenterDot]", 
            SubscriptBox["p", "3"]}]}], "]"}], " ", 
         RowBox[{"Sin", "[", 
          RowBox[{"a", "\[CenterDot]", 
           SubscriptBox["p", "1"]}], "]"}]}], "+", 
        RowBox[{
         RowBox[{"a", "\[CenterDot]", 
          SubscriptBox["p", "3"]}], " ", 
         RowBox[{"Cos", "[", 
          RowBox[{
           RowBox[{"a", "\[CenterDot]", 
            SubscriptBox["p", "2"]}], "+", 
           RowBox[{"a", "\[CenterDot]", 
            SubscriptBox["p", "3"]}]}], "]"}], " ", 
         RowBox[{"Sin", "[", 
          RowBox[{"a", "\[CenterDot]", 
           SubscriptBox["p", "1"]}], "]"}]}], "-", 
        RowBox[{
         RowBox[{"a", "\[CenterDot]", 
          SubscriptBox["p", "1"]}], " ", 
         RowBox[{"Cos", "[", 
          RowBox[{"a", "\[CenterDot]", 
           SubscriptBox["p", "1"]}], "]"}], " ", 
         RowBox[{"Sin", "[", 
          RowBox[{
           RowBox[{"a", "\[CenterDot]", 
            SubscriptBox["p", "2"]}], "+", 
           RowBox[{"a", "\[CenterDot]", 
            SubscriptBox["p", "3"]}]}], "]"}]}]}], ")"}]}], ")"}], "/", 
    RowBox[{"(", 
     RowBox[{
      RowBox[{"(", 
       RowBox[{
        RowBox[{"a", "\[CenterDot]", 
         SubscriptBox["p", "2"]}], "+", 
        RowBox[{"a", "\[CenterDot]", 
         SubscriptBox["p", "3"]}]}], ")"}], " ", 
      RowBox[{"(", 
       RowBox[{
        RowBox[{"a", "\[CenterDot]", 
         SubscriptBox["p", "1"]}], "+", 
        RowBox[{"a", "\[CenterDot]", 
         SubscriptBox["p", "2"]}], "+", 
        RowBox[{"a", "\[CenterDot]", 
         SubscriptBox["p", "3"]}]}], ")"}], " ", 
      RowBox[{"(", 
       RowBox[{
        RowBox[{
         SubscriptBox["p", "1"], "\[CenterDot]", 
         SubscriptBox["p", "2"]}], "+", 
        RowBox[{
         SubscriptBox["p", "1"], "\[CenterDot]", 
         SubscriptBox["p", "3"]}]}], ")"}]}], ")"}]}], ",", 
   RowBox[{
    RowBox[{"(", 
     RowBox[{"2", " ", 
      RowBox[{
       SubscriptBox["p", "1"], "\[CenterDot]", 
       SubscriptBox["p", "2"]}], " ", 
      RowBox[{"(", 
       RowBox[{
        RowBox[{"-", 
         RowBox[{"(", 
          RowBox[{
           RowBox[{"(", 
            RowBox[{
             RowBox[{"a", "\[CenterDot]", 
              SubscriptBox["p", "1"]}], "+", 
             RowBox[{"a", "\[CenterDot]", 
              SubscriptBox["p", "3"]}]}], ")"}], " ", 
           RowBox[{"Cos", "[", 
            RowBox[{"a", "\[CenterDot]", 
             SubscriptBox["p", "1"]}], "]"}], " ", 
           RowBox[{"Cos", "[", 
            RowBox[{"a", "\[CenterDot]", 
             SubscriptBox["p", "3"]}], "]"}], " ", 
           RowBox[{"Sin", "[", 
            RowBox[{"a", "\[CenterDot]", 
             SubscriptBox["p", "2"]}], "]"}]}], ")"}]}], "+", 
        RowBox[{
         RowBox[{"a", "\[CenterDot]", 
          SubscriptBox["p", "2"]}], " ", 
         RowBox[{"(", 
          RowBox[{
           RowBox[{
            RowBox[{"-", 
             RowBox[{"Sin", "[", 
              RowBox[{"a", "\[CenterDot]", 
               SubscriptBox["p", "1"]}], "]"}]}], " ", 
            RowBox[{"Sin", "[", 
             RowBox[{"a", "\[CenterDot]", 
              SubscriptBox["p", "2"]}], "]"}], " ", 
            RowBox[{"Sin", "[", 
             RowBox[{"a", "\[CenterDot]", 
              SubscriptBox["p", "3"]}], "]"}]}], "+", 
           RowBox[{
            RowBox[{"Cos", "[", 
             RowBox[{"a", "\[CenterDot]", 
              SubscriptBox["p", "2"]}], "]"}], " ", 
            RowBox[{"Sin", "[", 
             RowBox[{
              RowBox[{"a", "\[CenterDot]", 
               SubscriptBox["p", "1"]}], "+", 
              RowBox[{"a", "\[CenterDot]", 
               SubscriptBox["p", "3"]}]}], "]"}]}]}], ")"}]}]}], ")"}]}], 
     ")"}], "/", 
    RowBox[{"(", 
     RowBox[{
      RowBox[{"a", "\[CenterDot]", 
       SubscriptBox["p", "2"]}], " ", 
      RowBox[{"(", 
       RowBox[{
        RowBox[{"a", "\[CenterDot]", 
         SubscriptBox["p", "1"]}], "+", 
        RowBox[{"a", "\[CenterDot]", 
         SubscriptBox["p", "2"]}], "+", 
        RowBox[{"a", "\[CenterDot]", 
         SubscriptBox["p", "3"]}]}], ")"}]}], ")"}]}], ",", 
   RowBox[{"-", 
    FractionBox[
     RowBox[{"2", " ", 
      RowBox[{"Sin", "[", 
       RowBox[{
        RowBox[{"a", "\[CenterDot]", 
         SubscriptBox["p", "1"]}], "+", 
        RowBox[{"a", "\[CenterDot]", 
         SubscriptBox["p", "2"]}], "+", 
        RowBox[{"a", "\[CenterDot]", 
         SubscriptBox["p", "3"]}]}], "]"}]}], 
     RowBox[{
      RowBox[{"a", "\[CenterDot]", 
       SubscriptBox["p", "1"]}], "+", 
      RowBox[{"a", "\[CenterDot]", 
       SubscriptBox["p", "2"]}], "+", 
      RowBox[{"a", "\[CenterDot]", 
       SubscriptBox["p", "3"]}]}]]}], ",", 
   RowBox[{
    RowBox[{"(", 
     RowBox[{"2", " ", 
      RowBox[{
       SubscriptBox["p", "1"], "\[CenterDot]", 
       SubscriptBox["p", "3"]}], " ", 
      RowBox[{"(", 
       RowBox[{
        RowBox[{
         RowBox[{"a", "\[CenterDot]", 
          SubscriptBox["p", "2"]}], " ", 
         RowBox[{"Cos", "[", 
          RowBox[{
           RowBox[{"a", "\[CenterDot]", 
            SubscriptBox["p", "2"]}], "+", 
           RowBox[{"a", "\[CenterDot]", 
            SubscriptBox["p", "3"]}]}], "]"}], " ", 
         RowBox[{"Sin", "[", 
          RowBox[{"a", "\[CenterDot]", 
           SubscriptBox["p", "1"]}], "]"}]}], "+", 
        RowBox[{
         RowBox[{"a", "\[CenterDot]", 
          SubscriptBox["p", "3"]}], " ", 
         RowBox[{"Cos", "[", 
          RowBox[{
           RowBox[{"a", "\[CenterDot]", 
            SubscriptBox["p", "2"]}], "+", 
           RowBox[{"a", "\[CenterDot]", 
            SubscriptBox["p", "3"]}]}], "]"}], " ", 
         RowBox[{"Sin", "[", 
          RowBox[{"a", "\[CenterDot]", 
           SubscriptBox["p", "1"]}], "]"}]}], "-", 
        RowBox[{
         RowBox[{"a", "\[CenterDot]", 
          SubscriptBox["p", "1"]}], " ", 
         RowBox[{"Cos", "[", 
          RowBox[{"a", "\[CenterDot]", 
           SubscriptBox["p", "1"]}], "]"}], " ", 
         RowBox[{"Sin", "[", 
          RowBox[{
           RowBox[{"a", "\[CenterDot]", 
            SubscriptBox["p", "2"]}], "+", 
           RowBox[{"a", "\[CenterDot]", 
            SubscriptBox["p", "3"]}]}], "]"}]}]}], ")"}]}], ")"}], "/", 
    RowBox[{"(", 
     RowBox[{
      RowBox[{"(", 
       RowBox[{
        RowBox[{"a", "\[CenterDot]", 
         SubscriptBox["p", "2"]}], "+", 
        RowBox[{"a", "\[CenterDot]", 
         SubscriptBox["p", "3"]}]}], ")"}], " ", 
      RowBox[{"(", 
       RowBox[{
        RowBox[{"a", "\[CenterDot]", 
         SubscriptBox["p", "1"]}], "+", 
        RowBox[{"a", "\[CenterDot]", 
         SubscriptBox["p", "2"]}], "+", 
        RowBox[{"a", "\[CenterDot]", 
         SubscriptBox["p", "3"]}]}], ")"}], " ", 
      RowBox[{"(", 
       RowBox[{
        RowBox[{
         SubscriptBox["p", "1"], "\[CenterDot]", 
         SubscriptBox["p", "2"]}], "+", 
        RowBox[{
         SubscriptBox["p", "1"], "\[CenterDot]", 
         SubscriptBox["p", "3"]}]}], ")"}]}], ")"}]}], ",", 
   RowBox[{"-", 
    RowBox[{"(", 
     RowBox[{
      RowBox[{"(", 
       RowBox[{"2", " ", 
        RowBox[{
         SubscriptBox["p", "1"], "\[CenterDot]", 
         SubscriptBox["p", "2"]}], " ", 
        RowBox[{"(", 
         RowBox[{
          RowBox[{
           RowBox[{"a", "\[CenterDot]", 
            SubscriptBox["p", "2"]}], " ", 
           RowBox[{"Cos", "[", 
            RowBox[{
             RowBox[{"a", "\[CenterDot]", 
              SubscriptBox["p", "2"]}], "+", 
             RowBox[{"a", "\[CenterDot]", 
              SubscriptBox["p", "3"]}]}], "]"}], " ", 
           RowBox[{"Sin", "[", 
            RowBox[{"a", "\[CenterDot]", 
             SubscriptBox["p", "1"]}], "]"}]}], "+", 
          RowBox[{
           RowBox[{"a", "\[CenterDot]", 
            SubscriptBox["p", "3"]}], " ", 
           RowBox[{"Cos", "[", 
            RowBox[{
             RowBox[{"a", "\[CenterDot]", 
              SubscriptBox["p", "2"]}], "+", 
             RowBox[{"a", "\[CenterDot]", 
              SubscriptBox["p", "3"]}]}], "]"}], " ", 
           RowBox[{"Sin", "[", 
            RowBox[{"a", "\[CenterDot]", 
             SubscriptBox["p", "1"]}], "]"}]}], "-", 
          RowBox[{
           RowBox[{"a", "\[CenterDot]", 
            SubscriptBox["p", "1"]}], " ", 
           RowBox[{"Cos", "[", 
            RowBox[{"a", "\[CenterDot]", 
             SubscriptBox["p", "1"]}], "]"}], " ", 
           RowBox[{"Sin", "[", 
            RowBox[{
             RowBox[{"a", "\[CenterDot]", 
              SubscriptBox["p", "2"]}], "+", 
             RowBox[{"a", "\[CenterDot]", 
              SubscriptBox["p", "3"]}]}], "]"}]}]}], ")"}]}], ")"}], "/", 
      RowBox[{"(", 
       RowBox[{
        RowBox[{"(", 
         RowBox[{
          RowBox[{"a", "\[CenterDot]", 
           SubscriptBox["p", "2"]}], "+", 
          RowBox[{"a", "\[CenterDot]", 
           SubscriptBox["p", "3"]}]}], ")"}], " ", 
        RowBox[{"(", 
         RowBox[{
          RowBox[{"a", "\[CenterDot]", 
           SubscriptBox["p", "1"]}], "+", 
          RowBox[{"a", "\[CenterDot]", 
           SubscriptBox["p", "2"]}], "+", 
          RowBox[{"a", "\[CenterDot]", 
           SubscriptBox["p", "3"]}]}], ")"}], " ", 
        RowBox[{"(", 
         RowBox[{
          RowBox[{
           SubscriptBox["p", "1"], "\[CenterDot]", 
           SubscriptBox["p", "2"]}], "+", 
          RowBox[{
           SubscriptBox["p", "1"], "\[CenterDot]", 
           SubscriptBox["p", "3"]}]}], ")"}]}], ")"}]}], ")"}]}], ",", 
   FractionBox[
    RowBox[{"2", " ", 
     RowBox[{
      SubscriptBox["p", "1"], "\[CenterDot]", 
      SubscriptBox["p", "3"]}], " ", 
     RowBox[{"Sin", "[", 
      RowBox[{
       RowBox[{"a", "\[CenterDot]", 
        SubscriptBox["p", "1"]}], "+", 
       RowBox[{"a", "\[CenterDot]", 
        SubscriptBox["p", "2"]}], "+", 
       RowBox[{"a", "\[CenterDot]", 
        SubscriptBox["p", "3"]}]}], "]"}]}], 
    RowBox[{
     RowBox[{"a", "\[CenterDot]", 
      SubscriptBox["p", "1"]}], "+", 
     RowBox[{"a", "\[CenterDot]", 
      SubscriptBox["p", "2"]}], "+", 
     RowBox[{"a", "\[CenterDot]", 
      SubscriptBox["p", "3"]}]}]], ",", 
   FractionBox[
    RowBox[{
     RowBox[{"2", " ", 
      RowBox[{"(", 
       RowBox[{
        RowBox[{"a", "\[CenterDot]", 
         SubscriptBox["p", "1"]}], "+", 
        RowBox[{"a", "\[CenterDot]", 
         SubscriptBox["p", "3"]}]}], ")"}], " ", 
      RowBox[{"Cos", "[", 
       RowBox[{
        RowBox[{"a", "\[CenterDot]", 
         SubscriptBox["p", "1"]}], "+", 
        RowBox[{"a", "\[CenterDot]", 
         SubscriptBox["p", "3"]}]}], "]"}], " ", 
      RowBox[{"Sin", "[", 
       RowBox[{"a", "\[CenterDot]", 
        SubscriptBox["p", "2"]}], "]"}]}], "-", 
     RowBox[{"2", " ", 
      RowBox[{"a", "\[CenterDot]", 
       SubscriptBox["p", "2"]}], " ", 
      RowBox[{"Cos", "[", 
       RowBox[{"a", "\[CenterDot]", 
        SubscriptBox["p", "2"]}], "]"}], " ", 
      RowBox[{"Sin", "[", 
       RowBox[{
        RowBox[{"a", "\[CenterDot]", 
         SubscriptBox["p", "1"]}], "+", 
        RowBox[{"a", "\[CenterDot]", 
         SubscriptBox["p", "3"]}]}], "]"}]}]}], 
    RowBox[{
     RowBox[{"(", 
      RowBox[{
       RowBox[{"a", "\[CenterDot]", 
        SubscriptBox["p", "1"]}], "+", 
       RowBox[{"a", "\[CenterDot]", 
        SubscriptBox["p", "3"]}]}], ")"}], " ", 
     RowBox[{"(", 
      RowBox[{
       RowBox[{"a", "\[CenterDot]", 
        SubscriptBox["p", "1"]}], "+", 
       RowBox[{"a", "\[CenterDot]", 
        SubscriptBox["p", "2"]}], "+", 
       RowBox[{"a", "\[CenterDot]", 
        SubscriptBox["p", "3"]}]}], ")"}]}]], ",", 
   FractionBox[
    RowBox[{"2", " ", 
     RowBox[{
      SubscriptBox["p", "1"], "\[CenterDot]", 
      SubscriptBox["p", "3"]}], " ", 
     RowBox[{"Sin", "[", 
      RowBox[{
       RowBox[{"a", "\[CenterDot]", 
        SubscriptBox["p", "1"]}], "+", 
       RowBox[{"a", "\[CenterDot]", 
        SubscriptBox["p", "2"]}], "+", 
       RowBox[{"a", "\[CenterDot]", 
        SubscriptBox["p", "3"]}]}], "]"}]}], 
    RowBox[{
     RowBox[{"(", 
      RowBox[{
       RowBox[{"a", "\[CenterDot]", 
        SubscriptBox["p", "1"]}], "+", 
       RowBox[{"a", "\[CenterDot]", 
        SubscriptBox["p", "2"]}], "+", 
       RowBox[{"a", "\[CenterDot]", 
        SubscriptBox["p", "3"]}]}], ")"}], " ", 
     RowBox[{"(", 
      RowBox[{
       RowBox[{
        SubscriptBox["p", "1"], "\[CenterDot]", 
        SubscriptBox["p", "2"]}], "+", 
       RowBox[{
        SubscriptBox["p", "1"], "\[CenterDot]", 
        SubscriptBox["p", "3"]}]}], ")"}]}]], ",", 
   RowBox[{"-", 
    FractionBox[
     RowBox[{
      RowBox[{
       SubscriptBox["p", "1"], "\[CenterDot]", 
       SubscriptBox["p", "2"]}], " ", 
      RowBox[{"(", 
       RowBox[{
        RowBox[{
         RowBox[{"-", "2"}], " ", 
         RowBox[{"(", 
          RowBox[{
           RowBox[{"a", "\[CenterDot]", 
            SubscriptBox["p", "1"]}], "+", 
           RowBox[{"a", "\[CenterDot]", 
            SubscriptBox["p", "3"]}]}], ")"}], " ", 
         RowBox[{"Cos", "[", 
          RowBox[{
           RowBox[{"a", "\[CenterDot]", 
            SubscriptBox["p", "1"]}], "+", 
           RowBox[{"a", "\[CenterDot]", 
            SubscriptBox["p", "3"]}]}], "]"}], " ", 
         RowBox[{"Sin", "[", 
          RowBox[{"a", "\[CenterDot]", 
           SubscriptBox["p", "2"]}], "]"}]}], "+", 
        RowBox[{"2", " ", 
         RowBox[{"a", "\[CenterDot]", 
          SubscriptBox["p", "2"]}], " ", 
         RowBox[{"Cos", "[", 
          RowBox[{"a", "\[CenterDot]", 
           SubscriptBox["p", "2"]}], "]"}], " ", 
         RowBox[{"Sin", "[", 
          RowBox[{
           RowBox[{"a", "\[CenterDot]", 
            SubscriptBox["p", "1"]}], "+", 
           RowBox[{"a", "\[CenterDot]", 
            SubscriptBox["p", "3"]}]}], "]"}]}]}], ")"}]}], 
     RowBox[{
      RowBox[{"(", 
       RowBox[{
        RowBox[{"a", "\[CenterDot]", 
         SubscriptBox["p", "1"]}], "+", 
        RowBox[{"a", "\[CenterDot]", 
         SubscriptBox["p", "3"]}]}], ")"}], " ", 
      RowBox[{"(", 
       RowBox[{
        RowBox[{"a", "\[CenterDot]", 
         SubscriptBox["p", "1"]}], "+", 
        RowBox[{"a", "\[CenterDot]", 
         SubscriptBox["p", "2"]}], "+", 
        RowBox[{"a", "\[CenterDot]", 
         SubscriptBox["p", "3"]}]}], ")"}], " ", 
      RowBox[{"(", 
       RowBox[{
        RowBox[{
         SubscriptBox["p", "1"], "\[CenterDot]", 
         SubscriptBox["p", "2"]}], "+", 
        RowBox[{
         SubscriptBox["p", "1"], "\[CenterDot]", 
         SubscriptBox["p", "3"]}]}], ")"}]}]]}], ",", 
   RowBox[{"-", 
    FractionBox[
     RowBox[{"2", " ", 
      RowBox[{
       SubscriptBox["p", "1"], "\[CenterDot]", 
       SubscriptBox["p", "2"]}], " ", 
      RowBox[{
       SubscriptBox["p", "1"], "\[CenterDot]", 
       SubscriptBox["p", "3"]}], " ", 
      RowBox[{"Sin", "[", 
       RowBox[{
        RowBox[{"a", "\[CenterDot]", 
         SubscriptBox["p", "1"]}], "+", 
        RowBox[{"a", "\[CenterDot]", 
         SubscriptBox["p", "2"]}], "+", 
        RowBox[{"a", "\[CenterDot]", 
         SubscriptBox["p", "3"]}]}], "]"}]}], 
     RowBox[{
      RowBox[{"(", 
       RowBox[{
        RowBox[{"a", "\[CenterDot]", 
         SubscriptBox["p", "1"]}], "+", 
        RowBox[{"a", "\[CenterDot]", 
         SubscriptBox["p", "2"]}], "+", 
        RowBox[{"a", "\[CenterDot]", 
         SubscriptBox["p", "3"]}]}], ")"}], " ", 
      RowBox[{"(", 
       RowBox[{
        RowBox[{
         SubscriptBox["p", "1"], "\[CenterDot]", 
         SubscriptBox["p", "2"]}], "+", 
        RowBox[{
         SubscriptBox["p", "1"], "\[CenterDot]", 
         SubscriptBox["p", "3"]}]}], ")"}]}]]}], ",", 
   RowBox[{"-", 
    FractionBox[
     RowBox[{"2", " ", 
      RowBox[{"Sin", "[", 
       RowBox[{
        RowBox[{"a", "\[CenterDot]", 
         SubscriptBox["p", "1"]}], "+", 
        RowBox[{"a", "\[CenterDot]", 
         SubscriptBox["p", "2"]}], "+", 
        RowBox[{"a", "\[CenterDot]", 
         SubscriptBox["p", "3"]}]}], "]"}]}], 
     RowBox[{
      RowBox[{"a", "\[CenterDot]", 
       SubscriptBox["p", "1"]}], "+", 
      RowBox[{"a", "\[CenterDot]", 
       SubscriptBox["p", "2"]}], "+", 
      RowBox[{"a", "\[CenterDot]", 
       SubscriptBox["p", "3"]}]}]]}], ",", 
   RowBox[{"-", 
    RowBox[{"(", 
     RowBox[{
      RowBox[{"(", 
       RowBox[{"2", " ", 
        RowBox[{
         SubscriptBox["p", "1"], "\[CenterDot]", 
         SubscriptBox["p", "3"]}], " ", 
        RowBox[{"(", 
         RowBox[{
          RowBox[{
           RowBox[{"a", "\[CenterDot]", 
            SubscriptBox["p", "2"]}], " ", 
           RowBox[{"Cos", "[", 
            RowBox[{
             RowBox[{"a", "\[CenterDot]", 
              SubscriptBox["p", "2"]}], "+", 
             RowBox[{"a", "\[CenterDot]", 
              SubscriptBox["p", "3"]}]}], "]"}], " ", 
           RowBox[{"Sin", "[", 
            RowBox[{"a", "\[CenterDot]", 
             SubscriptBox["p", "1"]}], "]"}]}], "+", 
          RowBox[{
           RowBox[{"a", "\[CenterDot]", 
            SubscriptBox["p", "3"]}], " ", 
           RowBox[{"Cos", "[", 
            RowBox[{
             RowBox[{"a", "\[CenterDot]", 
              SubscriptBox["p", "2"]}], "+", 
             RowBox[{"a", "\[CenterDot]", 
              SubscriptBox["p", "3"]}]}], "]"}], " ", 
           RowBox[{"Sin", "[", 
            RowBox[{"a", "\[CenterDot]", 
             SubscriptBox["p", "1"]}], "]"}]}], "-", 
          RowBox[{
           RowBox[{"a", "\[CenterDot]", 
            SubscriptBox["p", "1"]}], " ", 
           RowBox[{"Cos", "[", 
            RowBox[{"a", "\[CenterDot]", 
             SubscriptBox["p", "1"]}], "]"}], " ", 
           RowBox[{"Sin", "[", 
            RowBox[{
             RowBox[{"a", "\[CenterDot]", 
              SubscriptBox["p", "2"]}], "+", 
             RowBox[{"a", "\[CenterDot]", 
              SubscriptBox["p", "3"]}]}], "]"}]}]}], ")"}]}], ")"}], "/", 
      RowBox[{"(", 
       RowBox[{
        RowBox[{"(", 
         RowBox[{
          RowBox[{"a", "\[CenterDot]", 
           SubscriptBox["p", "2"]}], "+", 
          RowBox[{"a", "\[CenterDot]", 
           SubscriptBox["p", "3"]}]}], ")"}], " ", 
        RowBox[{"(", 
         RowBox[{
          RowBox[{"a", "\[CenterDot]", 
           SubscriptBox["p", "1"]}], "+", 
          RowBox[{"a", "\[CenterDot]", 
           SubscriptBox["p", "2"]}], "+", 
          RowBox[{"a", "\[CenterDot]", 
           SubscriptBox["p", "3"]}]}], ")"}], " ", 
        RowBox[{"(", 
         RowBox[{
          RowBox[{
           SubscriptBox["p", "1"], "\[CenterDot]", 
           SubscriptBox["p", "2"]}], "+", 
          RowBox[{
           SubscriptBox["p", "1"], "\[CenterDot]", 
           SubscriptBox["p", "3"]}]}], ")"}]}], ")"}]}], ")"}]}], ",", 
   RowBox[{
    RowBox[{"(", 
     RowBox[{"2", " ", 
      RowBox[{
       SubscriptBox["p", "1"], "\[CenterDot]", 
       SubscriptBox["p", "2"]}], " ", 
      RowBox[{"(", 
       RowBox[{
        RowBox[{
         RowBox[{"a", "\[CenterDot]", 
          SubscriptBox["p", "2"]}], " ", 
         RowBox[{"Cos", "[", 
          RowBox[{
           RowBox[{"a", "\[CenterDot]", 
            SubscriptBox["p", "2"]}], "+", 
           RowBox[{"a", "\[CenterDot]", 
            SubscriptBox["p", "3"]}]}], "]"}], " ", 
         RowBox[{"Sin", "[", 
          RowBox[{"a", "\[CenterDot]", 
           SubscriptBox["p", "1"]}], "]"}]}], "+", 
        RowBox[{
         RowBox[{"a", "\[CenterDot]", 
          SubscriptBox["p", "3"]}], " ", 
         RowBox[{"Cos", "[", 
          RowBox[{
           RowBox[{"a", "\[CenterDot]", 
            SubscriptBox["p", "2"]}], "+", 
           RowBox[{"a", "\[CenterDot]", 
            SubscriptBox["p", "3"]}]}], "]"}], " ", 
         RowBox[{"Sin", "[", 
          RowBox[{"a", "\[CenterDot]", 
           SubscriptBox["p", "1"]}], "]"}]}], "-", 
        RowBox[{
         RowBox[{"a", "\[CenterDot]", 
          SubscriptBox["p", "1"]}], " ", 
         RowBox[{"Cos", "[", 
          RowBox[{"a", "\[CenterDot]", 
           SubscriptBox["p", "1"]}], "]"}], " ", 
         RowBox[{"Sin", "[", 
          RowBox[{
           RowBox[{"a", "\[CenterDot]", 
            SubscriptBox["p", "2"]}], "+", 
           RowBox[{"a", "\[CenterDot]", 
            SubscriptBox["p", "3"]}]}], "]"}]}]}], ")"}]}], ")"}], "/", 
    RowBox[{"(", 
     RowBox[{
      RowBox[{"(", 
       RowBox[{
        RowBox[{"a", "\[CenterDot]", 
         SubscriptBox["p", "2"]}], "+", 
        RowBox[{"a", "\[CenterDot]", 
         SubscriptBox["p", "3"]}]}], ")"}], " ", 
      RowBox[{"(", 
       RowBox[{
        RowBox[{"a", "\[CenterDot]", 
         SubscriptBox["p", "1"]}], "+", 
        RowBox[{"a", "\[CenterDot]", 
         SubscriptBox["p", "2"]}], "+", 
        RowBox[{"a", "\[CenterDot]", 
         SubscriptBox["p", "3"]}]}], ")"}], " ", 
      RowBox[{"(", 
       RowBox[{
        RowBox[{
         SubscriptBox["p", "1"], "\[CenterDot]", 
         SubscriptBox["p", "2"]}], "+", 
        RowBox[{
         SubscriptBox["p", "1"], "\[CenterDot]", 
         SubscriptBox["p", "3"]}]}], ")"}]}], ")"}]}], ",", 
   FractionBox[
    RowBox[{"2", " ", 
     RowBox[{
      SubscriptBox["p", "1"], "\[CenterDot]", 
      SubscriptBox["p", "2"]}], " ", 
     RowBox[{"Sin", "[", 
      RowBox[{
       RowBox[{"a", "\[CenterDot]", 
        SubscriptBox["p", "1"]}], "+", 
       RowBox[{"a", "\[CenterDot]", 
        SubscriptBox["p", "2"]}], "+", 
       RowBox[{"a", "\[CenterDot]", 
        SubscriptBox["p", "3"]}]}], "]"}]}], 
    RowBox[{
     RowBox[{"a", "\[CenterDot]", 
      SubscriptBox["p", "1"]}], "+", 
     RowBox[{"a", "\[CenterDot]", 
      SubscriptBox["p", "2"]}], "+", 
     RowBox[{"a", "\[CenterDot]", 
      SubscriptBox["p", "3"]}]}]], ",", 
   FractionBox[
    RowBox[{"2", " ", 
     RowBox[{
      SubscriptBox["p", "1"], "\[CenterDot]", 
      SubscriptBox["p", "3"]}], " ", 
     RowBox[{"Cos", "[", 
      RowBox[{"a", "\[CenterDot]", 
       SubscriptBox["p", "2"]}], "]"}], " ", 
     RowBox[{"(", 
      RowBox[{
       RowBox[{
        RowBox[{"-", 
         RowBox[{"(", 
          RowBox[{"a", "\[CenterDot]", 
           SubscriptBox["p", "3"]}], ")"}]}], " ", 
        RowBox[{"Cos", "[", 
         RowBox[{"a", "\[CenterDot]", 
          SubscriptBox["p", "3"]}], "]"}], " ", 
        RowBox[{"Sin", "[", 
         RowBox[{"a", "\[CenterDot]", 
          SubscriptBox["p", "1"]}], "]"}]}], "+", 
       RowBox[{
        RowBox[{"a", "\[CenterDot]", 
         SubscriptBox["p", "1"]}], " ", 
        RowBox[{"Cos", "[", 
         RowBox[{"a", "\[CenterDot]", 
          SubscriptBox["p", "1"]}], "]"}], " ", 
        RowBox[{"Sin", "[", 
         RowBox[{"a", "\[CenterDot]", 
          SubscriptBox["p", "3"]}], "]"}]}]}], ")"}]}], 
    RowBox[{
     RowBox[{"a", "\[CenterDot]", 
      SubscriptBox["p", "1"]}], " ", 
     RowBox[{"a", "\[CenterDot]", 
      SubscriptBox["p", "3"]}], " ", 
     RowBox[{"(", 
      RowBox[{
       RowBox[{"a", "\[CenterDot]", 
        SubscriptBox["p", "1"]}], "+", 
       RowBox[{"a", "\[CenterDot]", 
        SubscriptBox["p", "3"]}]}], ")"}]}]], ",", 
   FractionBox[
    RowBox[{"2", " ", 
     RowBox[{
      SubscriptBox["p", "1"], "\[CenterDot]", 
      SubscriptBox["p", "3"]}], " ", 
     RowBox[{"Cos", "[", 
      RowBox[{"a", "\[CenterDot]", 
       SubscriptBox["p", "1"]}], "]"}], " ", 
     RowBox[{"(", 
      RowBox[{
       RowBox[{
        RowBox[{"-", 
         RowBox[{"(", 
          RowBox[{"a", "\[CenterDot]", 
           SubscriptBox["p", "3"]}], ")"}]}], " ", 
        RowBox[{"Cos", "[", 
         RowBox[{"a", "\[CenterDot]", 
          SubscriptBox["p", "3"]}], "]"}], " ", 
        RowBox[{"Sin", "[", 
         RowBox[{"a", "\[CenterDot]", 
          SubscriptBox["p", "2"]}], "]"}]}], "+", 
       RowBox[{
        RowBox[{"a", "\[CenterDot]", 
         SubscriptBox["p", "2"]}], " ", 
        RowBox[{"Cos", "[", 
         RowBox[{"a", "\[CenterDot]", 
          SubscriptBox["p", "2"]}], "]"}], " ", 
        RowBox[{"Sin", "[", 
         RowBox[{"a", "\[CenterDot]", 
          SubscriptBox["p", "3"]}], "]"}]}]}], ")"}]}], 
    RowBox[{
     RowBox[{"a", "\[CenterDot]", 
      SubscriptBox["p", "2"]}], " ", 
     RowBox[{"a", "\[CenterDot]", 
      SubscriptBox["p", "3"]}], " ", 
     RowBox[{"(", 
      RowBox[{
       RowBox[{"a", "\[CenterDot]", 
        SubscriptBox["p", "2"]}], "+", 
       RowBox[{"a", "\[CenterDot]", 
        SubscriptBox["p", "3"]}]}], ")"}]}]], ",", 
   FractionBox[
    RowBox[{"2", " ", 
     RowBox[{
      SubscriptBox["p", "1"], "\[CenterDot]", 
      SubscriptBox["p", "2"]}], " ", 
     RowBox[{"Cos", "[", 
      RowBox[{"a", "\[CenterDot]", 
       SubscriptBox["p", "1"]}], "]"}], " ", 
     RowBox[{"(", 
      RowBox[{
       RowBox[{
        RowBox[{"a", "\[CenterDot]", 
         SubscriptBox["p", "3"]}], " ", 
        RowBox[{"Cos", "[", 
         RowBox[{"a", "\[CenterDot]", 
          SubscriptBox["p", "3"]}], "]"}], " ", 
        RowBox[{"Sin", "[", 
         RowBox[{"a", "\[CenterDot]", 
          SubscriptBox["p", "2"]}], "]"}]}], "-", 
       RowBox[{
        RowBox[{"a", "\[CenterDot]", 
         SubscriptBox["p", "2"]}], " ", 
        RowBox[{"Cos", "[", 
         RowBox[{"a", "\[CenterDot]", 
          SubscriptBox["p", "2"]}], "]"}], " ", 
        RowBox[{"Sin", "[", 
         RowBox[{"a", "\[CenterDot]", 
          SubscriptBox["p", "3"]}], "]"}]}]}], ")"}]}], 
    RowBox[{
     RowBox[{"a", "\[CenterDot]", 
      SubscriptBox["p", "2"]}], " ", 
     RowBox[{"a", "\[CenterDot]", 
      SubscriptBox["p", "3"]}], " ", 
     RowBox[{"(", 
      RowBox[{
       RowBox[{"a", "\[CenterDot]", 
        SubscriptBox["p", "2"]}], "+", 
       RowBox[{"a", "\[CenterDot]", 
        SubscriptBox["p", "3"]}]}], ")"}]}]], ",", 
   FractionBox[
    RowBox[{
     RowBox[{
      RowBox[{"-", "2"}], " ", 
      RowBox[{"(", 
       RowBox[{
        RowBox[{"a", "\[CenterDot]", 
         SubscriptBox["p", "1"]}], "+", 
        RowBox[{"a", "\[CenterDot]", 
         SubscriptBox["p", "3"]}]}], ")"}], " ", 
      RowBox[{"Cos", "[", 
       RowBox[{
        RowBox[{"a", "\[CenterDot]", 
         SubscriptBox["p", "1"]}], "+", 
        RowBox[{"a", "\[CenterDot]", 
         SubscriptBox["p", "3"]}]}], "]"}], " ", 
      RowBox[{"Sin", "[", 
       RowBox[{"a", "\[CenterDot]", 
        SubscriptBox["p", "2"]}], "]"}]}], "+", 
     RowBox[{"2", " ", 
      RowBox[{"a", "\[CenterDot]", 
       SubscriptBox["p", "2"]}], " ", 
      RowBox[{"Cos", "[", 
       RowBox[{"a", "\[CenterDot]", 
        SubscriptBox["p", "2"]}], "]"}], " ", 
      RowBox[{"Sin", "[", 
       RowBox[{
        RowBox[{"a", "\[CenterDot]", 
         SubscriptBox["p", "1"]}], "+", 
        RowBox[{"a", "\[CenterDot]", 
         SubscriptBox["p", "3"]}]}], "]"}]}]}], 
    RowBox[{
     RowBox[{"(", 
      RowBox[{
       RowBox[{"a", "\[CenterDot]", 
        SubscriptBox["p", "1"]}], "+", 
       RowBox[{"a", "\[CenterDot]", 
        SubscriptBox["p", "3"]}]}], ")"}], " ", 
     RowBox[{"(", 
      RowBox[{
       RowBox[{"a", "\[CenterDot]", 
        SubscriptBox["p", "1"]}], "+", 
       RowBox[{"a", "\[CenterDot]", 
        SubscriptBox["p", "2"]}], "+", 
       RowBox[{"a", "\[CenterDot]", 
        SubscriptBox["p", "3"]}]}], ")"}]}]], ",", 
   FractionBox[
    RowBox[{"2", " ", 
     RowBox[{
      SubscriptBox["p", "1"], "\[CenterDot]", 
      SubscriptBox["p", "2"]}], " ", 
     RowBox[{
      SubscriptBox["p", "1"], "\[CenterDot]", 
      SubscriptBox["p", "3"]}], " ", 
     RowBox[{"Cos", "[", 
      RowBox[{"a", "\[CenterDot]", 
       SubscriptBox["p", "2"]}], "]"}], " ", 
     RowBox[{"(", 
      RowBox[{
       RowBox[{
        RowBox[{"-", 
         RowBox[{"(", 
          RowBox[{"a", "\[CenterDot]", 
           SubscriptBox["p", "3"]}], ")"}]}], " ", 
        RowBox[{"Cos", "[", 
         RowBox[{"a", "\[CenterDot]", 
          SubscriptBox["p", "3"]}], "]"}], " ", 
        RowBox[{"Sin", "[", 
         RowBox[{"a", "\[CenterDot]", 
          SubscriptBox["p", "1"]}], "]"}]}], "+", 
       RowBox[{
        RowBox[{"a", "\[CenterDot]", 
         SubscriptBox["p", "1"]}], " ", 
        RowBox[{"Cos", "[", 
         RowBox[{"a", "\[CenterDot]", 
          SubscriptBox["p", "1"]}], "]"}], " ", 
        RowBox[{"Sin", "[", 
         RowBox[{"a", "\[CenterDot]", 
          SubscriptBox["p", "3"]}], "]"}]}]}], ")"}]}], 
    RowBox[{
     RowBox[{"a", "\[CenterDot]", 
      SubscriptBox["p", "1"]}], " ", 
     RowBox[{"a", "\[CenterDot]", 
      SubscriptBox["p", "3"]}], " ", 
     RowBox[{"(", 
      RowBox[{
       RowBox[{"a", "\[CenterDot]", 
        SubscriptBox["p", "1"]}], "+", 
       RowBox[{"a", "\[CenterDot]", 
        SubscriptBox["p", "3"]}]}], ")"}], " ", 
     RowBox[{"(", 
      RowBox[{
       RowBox[{
        SubscriptBox["p", "1"], "\[CenterDot]", 
        SubscriptBox["p", "2"]}], "+", 
       RowBox[{
        SubscriptBox["p", "1"], "\[CenterDot]", 
        SubscriptBox["p", "3"]}]}], ")"}]}]], ",", 
   RowBox[{
    RowBox[{"(", 
     RowBox[{"2", " ", 
      RowBox[{
       SubscriptBox["p", "1"], "\[CenterDot]", 
       SubscriptBox["p", "3"]}], " ", 
      RowBox[{"(", 
       RowBox[{
        RowBox[{
         RowBox[{"a", "\[CenterDot]", 
          SubscriptBox["p", "2"]}], " ", 
         RowBox[{"Cos", "[", 
          RowBox[{
           RowBox[{"a", "\[CenterDot]", 
            SubscriptBox["p", "2"]}], "+", 
           RowBox[{"a", "\[CenterDot]", 
            SubscriptBox["p", "3"]}]}], "]"}], " ", 
         RowBox[{"Sin", "[", 
          RowBox[{"a", "\[CenterDot]", 
           SubscriptBox["p", "1"]}], "]"}]}], "+", 
        RowBox[{
         RowBox[{"a", "\[CenterDot]", 
          SubscriptBox["p", "3"]}], " ", 
         RowBox[{"Cos", "[", 
          RowBox[{
           RowBox[{"a", "\[CenterDot]", 
            SubscriptBox["p", "2"]}], "+", 
           RowBox[{"a", "\[CenterDot]", 
            SubscriptBox["p", "3"]}]}], "]"}], " ", 
         RowBox[{"Sin", "[", 
          RowBox[{"a", "\[CenterDot]", 
           SubscriptBox["p", "1"]}], "]"}]}], "-", 
        RowBox[{
         RowBox[{"a", "\[CenterDot]", 
          SubscriptBox["p", "1"]}], " ", 
         RowBox[{"Cos", "[", 
          RowBox[{"a", "\[CenterDot]", 
           SubscriptBox["p", "1"]}], "]"}], " ", 
         RowBox[{"Sin", "[", 
          RowBox[{
           RowBox[{"a", "\[CenterDot]", 
            SubscriptBox["p", "2"]}], "+", 
           RowBox[{"a", "\[CenterDot]", 
            SubscriptBox["p", "3"]}]}], "]"}]}]}], ")"}]}], ")"}], "/", 
    RowBox[{"(", 
     RowBox[{
      RowBox[{"(", 
       RowBox[{
        RowBox[{"a", "\[CenterDot]", 
         SubscriptBox["p", "2"]}], "+", 
        RowBox[{"a", "\[CenterDot]", 
         SubscriptBox["p", "3"]}]}], ")"}], " ", 
      RowBox[{"(", 
       RowBox[{
        RowBox[{"a", "\[CenterDot]", 
         SubscriptBox["p", "1"]}], "+", 
        RowBox[{"a", "\[CenterDot]", 
         SubscriptBox["p", "2"]}], "+", 
        RowBox[{"a", "\[CenterDot]", 
         SubscriptBox["p", "3"]}]}], ")"}], " ", 
      RowBox[{"(", 
       RowBox[{
        RowBox[{
         SubscriptBox["p", "1"], "\[CenterDot]", 
         SubscriptBox["p", "2"]}], "+", 
        RowBox[{
         SubscriptBox["p", "1"], "\[CenterDot]", 
         SubscriptBox["p", "3"]}]}], ")"}]}], ")"}]}], ",", 
   RowBox[{
    RowBox[{"(", 
     RowBox[{"2", " ", 
      RowBox[{
       SubscriptBox["p", "1"], "\[CenterDot]", 
       SubscriptBox["p", "2"]}], " ", 
      RowBox[{"(", 
       RowBox[{
        RowBox[{
         SuperscriptBox[
          RowBox[{"(", 
           RowBox[{"a", "\[CenterDot]", 
            SubscriptBox["p", "2"]}], ")"}], "2"], " ", 
         RowBox[{"Cos", "[", 
          RowBox[{"a", "\[CenterDot]", 
           SubscriptBox["p", "2"]}], "]"}], " ", 
         RowBox[{"(", 
          RowBox[{
           RowBox[{
            RowBox[{"a", "\[CenterDot]", 
             SubscriptBox["p", "3"]}], " ", 
            RowBox[{"Cos", "[", 
             RowBox[{"a", "\[CenterDot]", 
              SubscriptBox["p", "3"]}], "]"}], " ", 
            RowBox[{"Sin", "[", 
             RowBox[{"a", "\[CenterDot]", 
              SubscriptBox["p", "1"]}], "]"}]}], "-", 
           RowBox[{
            RowBox[{"a", "\[CenterDot]", 
             SubscriptBox["p", "1"]}], " ", 
            RowBox[{"Cos", "[", 
             RowBox[{"a", "\[CenterDot]", 
              SubscriptBox["p", "1"]}], "]"}], " ", 
            RowBox[{"Sin", "[", 
             RowBox[{"a", "\[CenterDot]", 
              SubscriptBox["p", "3"]}], "]"}]}]}], ")"}]}], "+", 
        RowBox[{
         RowBox[{"a", "\[CenterDot]", 
          SubscriptBox["p", "3"]}], " ", 
         RowBox[{"(", 
          RowBox[{
           RowBox[{"a", "\[CenterDot]", 
            SubscriptBox["p", "1"]}], "+", 
           RowBox[{"a", "\[CenterDot]", 
            SubscriptBox["p", "3"]}]}], ")"}], " ", 
         RowBox[{"Sin", "[", 
          RowBox[{"a", "\[CenterDot]", 
           SubscriptBox["p", "2"]}], "]"}], " ", 
         RowBox[{"(", 
          RowBox[{
           RowBox[{
            RowBox[{"a", "\[CenterDot]", 
             SubscriptBox["p", "1"]}], " ", 
            RowBox[{"Cos", "[", 
             RowBox[{"a", "\[CenterDot]", 
              SubscriptBox["p", "1"]}], "]"}], " ", 
            RowBox[{"Cos", "[", 
             RowBox[{"a", "\[CenterDot]", 
              SubscriptBox["p", "3"]}], "]"}]}], "+", 
           RowBox[{
            RowBox[{"a", "\[CenterDot]", 
             SubscriptBox["p", "3"]}], " ", 
            RowBox[{"Sin", "[", 
             RowBox[{"a", "\[CenterDot]", 
              SubscriptBox["p", "1"]}], "]"}], " ", 
            RowBox[{"Sin", "[", 
             RowBox[{"a", "\[CenterDot]", 
              SubscriptBox["p", "3"]}], "]"}]}]}], ")"}]}], "+", 
        RowBox[{
         RowBox[{"a", "\[CenterDot]", 
          SubscriptBox["p", "2"]}], " ", 
         RowBox[{"(", 
          RowBox[{
           RowBox[{
            SuperscriptBox[
             RowBox[{"(", 
              RowBox[{"a", "\[CenterDot]", 
               SubscriptBox["p", "3"]}], ")"}], "2"], " ", 
            RowBox[{"Cos", "[", 
             RowBox[{
              RowBox[{"a", "\[CenterDot]", 
               SubscriptBox["p", "2"]}], "-", 
              RowBox[{"a", "\[CenterDot]", 
               SubscriptBox["p", "3"]}]}], "]"}], " ", 
            RowBox[{"Sin", "[", 
             RowBox[{"a", "\[CenterDot]", 
              SubscriptBox["p", "1"]}], "]"}]}], "-", 
           RowBox[{
            SuperscriptBox[
             RowBox[{"(", 
              RowBox[{"a", "\[CenterDot]", 
               SubscriptBox["p", "1"]}], ")"}], "2"], " ", 
            RowBox[{"Cos", "[", 
             RowBox[{"a", "\[CenterDot]", 
              SubscriptBox["p", "1"]}], "]"}], " ", 
            RowBox[{"Cos", "[", 
             RowBox[{"a", "\[CenterDot]", 
              SubscriptBox["p", "2"]}], "]"}], " ", 
            RowBox[{"Sin", "[", 
             RowBox[{"a", "\[CenterDot]", 
              SubscriptBox["p", "3"]}], "]"}]}], "-", 
           RowBox[{
            RowBox[{"a", "\[CenterDot]", 
             SubscriptBox["p", "1"]}], " ", 
            RowBox[{"a", "\[CenterDot]", 
             SubscriptBox["p", "3"]}], " ", 
            RowBox[{"(", 
             RowBox[{
              RowBox[{"2", " ", 
               RowBox[{"Cos", "[", 
                RowBox[{"a", "\[CenterDot]", 
                 SubscriptBox["p", "1"]}], "]"}], " ", 
               RowBox[{"Cos", "[", 
                RowBox[{"a", "\[CenterDot]", 
                 SubscriptBox["p", "2"]}], "]"}]}], "-", 
              RowBox[{
               RowBox[{"Sin", "[", 
                RowBox[{"a", "\[CenterDot]", 
                 SubscriptBox["p", "1"]}], "]"}], " ", 
               RowBox[{"Sin", "[", 
                RowBox[{"a", "\[CenterDot]", 
                 SubscriptBox["p", "2"]}], "]"}]}]}], ")"}], " ", 
            RowBox[{"Sin", "[", 
             RowBox[{"a", "\[CenterDot]", 
              SubscriptBox["p", "3"]}], "]"}]}]}], ")"}]}]}], ")"}]}], ")"}], 
    "/", 
    RowBox[{"(", 
     RowBox[{
      RowBox[{"a", "\[CenterDot]", 
       SubscriptBox["p", "3"]}], " ", 
      RowBox[{"(", 
       RowBox[{
        RowBox[{"a", "\[CenterDot]", 
         SubscriptBox["p", "1"]}], "+", 
        RowBox[{"a", "\[CenterDot]", 
         SubscriptBox["p", "3"]}]}], ")"}], " ", 
      RowBox[{"(", 
       RowBox[{
        RowBox[{"a", "\[CenterDot]", 
         SubscriptBox["p", "2"]}], "+", 
        RowBox[{"a", "\[CenterDot]", 
         SubscriptBox["p", "3"]}]}], ")"}], " ", 
      RowBox[{"(", 
       RowBox[{
        RowBox[{"a", "\[CenterDot]", 
         SubscriptBox["p", "1"]}], "+", 
        RowBox[{"a", "\[CenterDot]", 
         SubscriptBox["p", "2"]}], "+", 
        RowBox[{"a", "\[CenterDot]", 
         SubscriptBox["p", "3"]}]}], ")"}], " ", 
      RowBox[{"(", 
       RowBox[{
        RowBox[{
         SubscriptBox["p", "1"], "\[CenterDot]", 
         SubscriptBox["p", "2"]}], "+", 
        RowBox[{
         SubscriptBox["p", "1"], "\[CenterDot]", 
         SubscriptBox["p", "3"]}]}], ")"}]}], ")"}]}], ",", 
   RowBox[{
    RowBox[{"(", 
     RowBox[{"2", " ", 
      RowBox[{
       SubscriptBox["p", "1"], "\[CenterDot]", 
       SubscriptBox["p", "3"]}], " ", 
      RowBox[{"(", 
       RowBox[{
        RowBox[{
         RowBox[{"a", "\[CenterDot]", 
          SubscriptBox["p", "3"]}], " ", 
         RowBox[{"(", 
          RowBox[{
           RowBox[{
            RowBox[{"Cos", "[", 
             RowBox[{"a", "\[CenterDot]", 
              SubscriptBox["p", "2"]}], "]"}], " ", 
            RowBox[{"Cos", "[", 
             RowBox[{"a", "\[CenterDot]", 
              SubscriptBox["p", "3"]}], "]"}], " ", 
            RowBox[{"Sin", "[", 
             RowBox[{"a", "\[CenterDot]", 
              SubscriptBox["p", "1"]}], "]"}]}], "+", 
           RowBox[{
            RowBox[{"Cos", "[", 
             RowBox[{
              RowBox[{"a", "\[CenterDot]", 
               SubscriptBox["p", "1"]}], "+", 
              RowBox[{"a", "\[CenterDot]", 
               SubscriptBox["p", "3"]}]}], "]"}], " ", 
            RowBox[{"Sin", "[", 
             RowBox[{"a", "\[CenterDot]", 
              SubscriptBox["p", "2"]}], "]"}]}]}], ")"}]}], "-", 
        RowBox[{
         RowBox[{"(", 
          RowBox[{
           RowBox[{"a", "\[CenterDot]", 
            SubscriptBox["p", "1"]}], "+", 
           RowBox[{"a", "\[CenterDot]", 
            SubscriptBox["p", "2"]}]}], ")"}], " ", 
         RowBox[{"Cos", "[", 
          RowBox[{"a", "\[CenterDot]", 
           SubscriptBox["p", "1"]}], "]"}], " ", 
         RowBox[{"Cos", "[", 
          RowBox[{"a", "\[CenterDot]", 
           SubscriptBox["p", "2"]}], "]"}], " ", 
         RowBox[{"Sin", "[", 
          RowBox[{"a", "\[CenterDot]", 
           SubscriptBox["p", "3"]}], "]"}]}]}], ")"}]}], ")"}], "/", 
    RowBox[{"(", 
     RowBox[{
      RowBox[{"a", "\[CenterDot]", 
       SubscriptBox["p", "3"]}], " ", 
      RowBox[{"(", 
       RowBox[{
        RowBox[{"a", "\[CenterDot]", 
         SubscriptBox["p", "1"]}], "+", 
        RowBox[{"a", "\[CenterDot]", 
         SubscriptBox["p", "2"]}], "+", 
        RowBox[{"a", "\[CenterDot]", 
         SubscriptBox["p", "3"]}]}], ")"}]}], ")"}]}], ",", 
   RowBox[{"-", 
    FractionBox[
     RowBox[{"2", " ", 
      RowBox[{
       SubscriptBox["p", "1"], "\[CenterDot]", 
       SubscriptBox["p", "2"]}], " ", 
      RowBox[{"Cos", "[", 
       RowBox[{"a", "\[CenterDot]", 
        SubscriptBox["p", "3"]}], "]"}], " ", 
      RowBox[{"Sin", "[", 
       RowBox[{
        RowBox[{"a", "\[CenterDot]", 
         SubscriptBox["p", "1"]}], "+", 
        RowBox[{"a", "\[CenterDot]", 
         SubscriptBox["p", "2"]}]}], "]"}]}], 
     RowBox[{
      RowBox[{"a", "\[CenterDot]", 
       SubscriptBox["p", "1"]}], "+", 
      RowBox[{"a", "\[CenterDot]", 
       SubscriptBox["p", "2"]}]}]]}], ",", 
   RowBox[{"-", 
    FractionBox[
     RowBox[{"2", " ", 
      RowBox[{
       SubscriptBox["p", "1"], "\[CenterDot]", 
       SubscriptBox["p", "2"]}], " ", 
      RowBox[{
       SubscriptBox["p", "1"], "\[CenterDot]", 
       SubscriptBox["p", "3"]}], " ", 
      RowBox[{"Cos", "[", 
       RowBox[{"a", "\[CenterDot]", 
        SubscriptBox["p", "3"]}], "]"}], " ", 
      RowBox[{"Sin", "[", 
       RowBox[{
        RowBox[{"a", "\[CenterDot]", 
         SubscriptBox["p", "1"]}], "+", 
        RowBox[{"a", "\[CenterDot]", 
         SubscriptBox["p", "2"]}]}], "]"}]}], 
     RowBox[{
      RowBox[{"(", 
       RowBox[{
        RowBox[{"a", "\[CenterDot]", 
         SubscriptBox["p", "1"]}], "+", 
        RowBox[{"a", "\[CenterDot]", 
         SubscriptBox["p", "2"]}]}], ")"}], " ", 
      RowBox[{"(", 
       RowBox[{
        RowBox[{
         SubscriptBox["p", "1"], "\[CenterDot]", 
         SubscriptBox["p", "2"]}], "+", 
        RowBox[{
         SubscriptBox["p", "1"], "\[CenterDot]", 
         SubscriptBox["p", "3"]}]}], ")"}]}]]}], ",", 
   RowBox[{"-", 
    FractionBox[
     RowBox[{"2", " ", 
      RowBox[{
       SubscriptBox["p", "1"], "\[CenterDot]", 
       SubscriptBox["p", "3"]}], " ", 
      RowBox[{"Cos", "[", 
       RowBox[{"a", "\[CenterDot]", 
        SubscriptBox["p", "2"]}], "]"}], " ", 
      RowBox[{"Sin", "[", 
       RowBox[{
        RowBox[{"a", "\[CenterDot]", 
         SubscriptBox["p", "1"]}], "+", 
        RowBox[{"a", "\[CenterDot]", 
         SubscriptBox["p", "3"]}]}], "]"}]}], 
     RowBox[{
      RowBox[{"a", "\[CenterDot]", 
       SubscriptBox["p", "1"]}], "+", 
      RowBox[{"a", "\[CenterDot]", 
       SubscriptBox["p", "3"]}]}]]}], ",", 
   RowBox[{"-", 
    FractionBox[
     RowBox[{"2", " ", 
      RowBox[{
       SubscriptBox["p", "1"], "\[CenterDot]", 
       SubscriptBox["p", "2"]}], " ", 
      RowBox[{
       SubscriptBox["p", "1"], "\[CenterDot]", 
       SubscriptBox["p", "3"]}], " ", 
      RowBox[{"Cos", "[", 
       RowBox[{"a", "\[CenterDot]", 
        SubscriptBox["p", "2"]}], "]"}], " ", 
      RowBox[{"Sin", "[", 
       RowBox[{
        RowBox[{"a", "\[CenterDot]", 
         SubscriptBox["p", "1"]}], "+", 
        RowBox[{"a", "\[CenterDot]", 
         SubscriptBox["p", "3"]}]}], "]"}]}], 
     RowBox[{
      RowBox[{"(", 
       RowBox[{
        RowBox[{"a", "\[CenterDot]", 
         SubscriptBox["p", "1"]}], "+", 
        RowBox[{"a", "\[CenterDot]", 
         SubscriptBox["p", "3"]}]}], ")"}], " ", 
      RowBox[{"(", 
       RowBox[{
        RowBox[{
         SubscriptBox["p", "1"], "\[CenterDot]", 
         SubscriptBox["p", "2"]}], "+", 
        RowBox[{
         SubscriptBox["p", "1"], "\[CenterDot]", 
         SubscriptBox["p", "3"]}]}], ")"}]}]]}], ",", 
   RowBox[{"-", 
    FractionBox[
     RowBox[{"2", " ", 
      RowBox[{
       SubscriptBox["p", "1"], "\[CenterDot]", 
       SubscriptBox["p", "3"]}], " ", 
      RowBox[{"Cos", "[", 
       RowBox[{"a", "\[CenterDot]", 
        SubscriptBox["p", "1"]}], "]"}], " ", 
      RowBox[{"Sin", "[", 
       RowBox[{
        RowBox[{"a", "\[CenterDot]", 
         SubscriptBox["p", "2"]}], "+", 
        RowBox[{"a", "\[CenterDot]", 
         SubscriptBox["p", "3"]}]}], "]"}]}], 
     RowBox[{
      RowBox[{"a", "\[CenterDot]", 
       SubscriptBox["p", "2"]}], "+", 
      RowBox[{"a", "\[CenterDot]", 
       SubscriptBox["p", "3"]}]}]]}], ",", 
   FractionBox[
    RowBox[{"2", " ", 
     RowBox[{
      SubscriptBox["p", "1"], "\[CenterDot]", 
      SubscriptBox["p", "2"]}], " ", 
     RowBox[{"Cos", "[", 
      RowBox[{"a", "\[CenterDot]", 
       SubscriptBox["p", "1"]}], "]"}], " ", 
     RowBox[{"Sin", "[", 
      RowBox[{
       RowBox[{"a", "\[CenterDot]", 
        SubscriptBox["p", "2"]}], "+", 
       RowBox[{"a", "\[CenterDot]", 
        SubscriptBox["p", "3"]}]}], "]"}]}], 
    RowBox[{
     RowBox[{"a", "\[CenterDot]", 
      SubscriptBox["p", "2"]}], "+", 
     RowBox[{"a", "\[CenterDot]", 
      SubscriptBox["p", "3"]}]}]]}], "}"}]], "Output",
 CellChangeTimes->{{3.878858062330456*^9, 3.878858079059268*^9}},
 CellLabel->
  "Out[590]=",ExpressionUUID->"7b8969d7-b35d-4334-95a7-1f85e28c78d4"]
}, Open  ]]
}, Open  ]],

Cell[CellGroupData[{

Cell["Setup ansatz Even", "Subsection",
 CellChangeTimes->{{3.877386203620414*^9, 3.877386209613765*^9}, {
  3.8788577729881887`*^9, 
  3.878857775791086*^9}},ExpressionUUID->"d8aa63b6-d30a-47db-8785-\
0546b4c54c88"],

Cell[BoxData[{
 RowBox[{
  RowBox[{"paOrder", "=", "1"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"monofas", "=", 
   RowBox[{"monoFa", "[", 
    RowBox[{"paOrder", ",", 
     RowBox[{"n", "-", "2"}]}], "]"}]}], ";"}]}], "Input",
 CellChangeTimes->{{3.877381049405899*^9, 3.877381116483204*^9}, {
  3.877381244223319*^9, 3.877381284761427*^9}, {3.877381353256666*^9, 
  3.877381353488029*^9}, {3.87738186344316*^9, 3.877381863777376*^9}, {
  3.8773822047453117`*^9, 3.877382204987795*^9}, {3.8773825485753727`*^9, 
  3.877382548830839*^9}, {3.877382654557598*^9, 3.877382674685717*^9}, {
  3.878016251644945*^9, 3.87801627282722*^9}, {3.878018811842737*^9, 
  3.878018821618462*^9}, {3.878019111987747*^9, 3.8780191881088953`*^9}, {
  3.8780192243067636`*^9, 3.878019263820836*^9}, {3.8780196953188877`*^9, 
  3.8780197336534443`*^9}, {3.878028860196001*^9, 3.878028905573225*^9}, {
  3.878797692448628*^9, 3.878797732814226*^9}},
 CellLabel->
  "In[546]:=",ExpressionUUID->"c8e48f40-c563-4727-8f9c-6c5787cae9fe"],

Cell[BoxData[
 RowBox[{
  RowBox[{"monoSC", "=", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{
      RowBox[{"Cos", "[", 
       RowBox[{"dot", "[", 
        RowBox[{
         RowBox[{"as", "[", "0", "]"}], ",", 
         RowBox[{"p", "[", "1", "]"}]}], "]"}], "]"}], 
      RowBox[{"Sinc", "[", 
       RowBox[{"dot", "[", 
        RowBox[{
         RowBox[{"as", "[", "0", "]"}], ",", 
         RowBox[{"p", "[", "2", "]"}]}], "]"}], "]"}], 
      RowBox[{"Sinc", "[", 
       RowBox[{"dot", "[", 
        RowBox[{
         RowBox[{"as", "[", "0", "]"}], ",", 
         RowBox[{"p", "[", "3", "]"}]}], "]"}], "]"}]}], ",", 
     RowBox[{
      RowBox[{"Cos", "[", 
       RowBox[{"dot", "[", 
        RowBox[{
         RowBox[{"as", "[", "0", "]"}], ",", 
         RowBox[{"p", "[", "2", "]"}]}], "]"}], "]"}], 
      RowBox[{"Sinc", "[", 
       RowBox[{"dot", "[", 
        RowBox[{
         RowBox[{"as", "[", "0", "]"}], ",", 
         RowBox[{"p", "[", "1", "]"}]}], "]"}], "]"}], 
      RowBox[{"Sinc", "[", 
       RowBox[{"dot", "[", 
        RowBox[{
         RowBox[{"as", "[", "0", "]"}], ",", 
         RowBox[{"p", "[", "3", "]"}]}], "]"}], "]"}]}], ",", 
     RowBox[{
      RowBox[{"Cos", "[", 
       RowBox[{"dot", "[", 
        RowBox[{
         RowBox[{"as", "[", "0", "]"}], ",", 
         RowBox[{"p", "[", "3", "]"}]}], "]"}], "]"}], 
      RowBox[{"Sinc", "[", 
       RowBox[{"dot", "[", 
        RowBox[{
         RowBox[{"as", "[", "0", "]"}], ",", 
         RowBox[{"p", "[", "1", "]"}]}], "]"}], "]"}], 
      RowBox[{"Sinc", "[", 
       RowBox[{"dot", "[", 
        RowBox[{
         RowBox[{"as", "[", "0", "]"}], ",", 
         RowBox[{"p", "[", "2", "]"}]}], "]"}], "]"}]}]}], "}"}]}], 
  ";"}]], "Input",
 CellChangeTimes->{{3.8787980456899548`*^9, 3.878798169081862*^9}},
 CellLabel->
  "In[549]:=",ExpressionUUID->"f952e511-eb90-45f0-bd1e-e6bb6a532f20"],

Cell[BoxData[{
 RowBox[{
  RowBox[{"monos", "=", 
   RowBox[{"List", "@@", 
    RowBox[{"(", 
     RowBox[{
      RowBox[{
       RowBox[{"Total", "[", "monoSC", "]"}], 
       RowBox[{"Total", "[", "monofas", "]"}]}], "//", "Expand"}], ")"}]}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"numAnsatz", "=", 
   RowBox[{
    RowBox[{"(", 
     RowBox[{
      RowBox[{"(", 
       RowBox[{"c", "/@", 
        RowBox[{"Range", "[", 
         RowBox[{"Length", "@", "monos"}], "]"}]}], ")"}], ".", "monos"}], 
     ")"}], "//", "Expand"}]}], ";"}]}], "Input",
 CellChangeTimes->{{3.8787982293842497`*^9, 3.8787982945135117`*^9}},
 CellLabel->
  "In[550]:=",ExpressionUUID->"9e1bef29-5f11-4cd4-ba9b-86b7d80cb099"],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"monofas", "//", "Length"}]], "Input",
 CellChangeTimes->{{3.8787982999694443`*^9, 3.87879830075799*^9}, 
   3.8787983663894653`*^9},
 CellLabel->
  "In[552]:=",ExpressionUUID->"4f31e7f4-5cdc-49af-9db4-edf2e132e73f"],

Cell[BoxData["81"], "Output",
 CellChangeTimes->{3.8787983010930853`*^9, 3.8787983667036057`*^9, 
  3.878857663061255*^9},
 CellLabel->
  "Out[552]=",ExpressionUUID->"4f51483e-76b7-4dc9-9190-7e50d995613c"]
}, Open  ]],

Cell[BoxData[
 RowBox[{
  RowBox[{"comp123even", "=", 
   RowBox[{
    RowBox[{"comp123Fin", "/.", 
     RowBox[{
      RowBox[{"dot", "[", 
       RowBox[{"a_", ",", 
        RowBox[{"S", "[", "0", "]"}], ",", "b_"}], "]"}], ":>", "0"}]}], " ", 
    "//", "Expand"}]}], ";"}]], "Input",
 CellChangeTimes->{{3.8787984834905787`*^9, 3.8787984961187696`*^9}, {
   3.878798532505534*^9, 3.8787985409609327`*^9}, 3.878799451724655*^9},
 CellLabel->
  "In[553]:=",ExpressionUUID->"ff495fb1-191a-491a-8fb3-ecdb183fa6c3"],

Cell[CellGroupData[{

Cell[BoxData["numAnsatz"], "Input",
 CellLabel->
  "In[554]:=",ExpressionUUID->"ff551382-c6b3-421d-911a-dbd80cf27fbb"],

Cell[BoxData[
 InterpretationBox[
  TagBox[
   FrameBox[GridBox[{
      {
       ItemBox[
        TagBox[
         RowBox[{
          RowBox[{
           RowBox[{"c", "[", "1", "]"}], " ", 
           RowBox[{"Cos", "[", 
            RowBox[{"dot", "[", 
             RowBox[{
              RowBox[{"as", "[", "0", "]"}], ",", 
              RowBox[{"p", "[", "3", "]"}]}], "]"}], "]"}], " ", 
           RowBox[{"dot", "[", 
            RowBox[{
             RowBox[{"p", "[", "1", "]"}], ",", 
             RowBox[{"F", "[", "3", "]"}], ",", 
             RowBox[{"v", "[", "1", "]"}]}], "]"}], " ", 
           RowBox[{"dot", "[", 
            RowBox[{
             RowBox[{"as", "[", "0", "]"}], ",", 
             RowBox[{"F", "[", "1", "]"}], ",", 
             RowBox[{"F", "[", "2", "]"}], ",", 
             RowBox[{"as", "[", "0", "]"}]}], "]"}], " ", 
           RowBox[{"Sinc", "[", 
            RowBox[{"dot", "[", 
             RowBox[{
              RowBox[{"as", "[", "0", "]"}], ",", 
              RowBox[{"p", "[", "1", "]"}]}], "]"}], "]"}], " ", 
           RowBox[{"Sinc", "[", 
            RowBox[{"dot", "[", 
             RowBox[{
              RowBox[{"as", "[", "0", "]"}], ",", 
              RowBox[{"p", "[", "2", "]"}]}], "]"}], "]"}]}], "+", 
          TemplateBox[{"241"},
           "OutputSizeLimit`Skeleton"], "+", 
          RowBox[{
           RowBox[{"c", "[", "243", "]"}], " ", 
           RowBox[{"Cos", "[", 
            RowBox[{"dot", "[", 
             RowBox[{
              RowBox[{"as", "[", "0", "]"}], ",", 
              RowBox[{"p", "[", "1", "]"}]}], "]"}], "]"}], " ", 
           RowBox[{"dot", "[", 
            RowBox[{
             RowBox[{"as", "[", "0", "]"}], ",", 
             RowBox[{"as", "[", "0", "]"}]}], "]"}], " ", 
           RowBox[{"dot", "[", 
            RowBox[{
             RowBox[{"p", "[", "3", "]"}], ",", 
             RowBox[{"F", "[", "2", "]"}], ",", 
             RowBox[{"F", "[", "3", "]"}], ",", 
             RowBox[{"F", "[", "1", "]"}], ",", 
             RowBox[{"v", "[", "1", "]"}]}], "]"}], " ", 
           RowBox[{"Sinc", "[", 
            RowBox[{"dot", "[", 
             RowBox[{
              RowBox[{"as", "[", "0", "]"}], ",", 
              RowBox[{"p", "[", "2", "]"}]}], "]"}], "]"}], " ", 
           RowBox[{"Sinc", "[", 
            RowBox[{"dot", "[", 
             RowBox[{
              RowBox[{"as", "[", "0", "]"}], ",", 
              RowBox[{"p", "[", "3", "]"}]}], "]"}], "]"}]}]}],
         Short[#, 5]& ],
        BaseStyle->{Deployed -> False},
        StripOnInput->False]},
      {GridBox[{
         {
          PaneBox[
           TagBox[
            TooltipBox[
             StyleBox[
              StyleBox[
               DynamicBox[ToBoxes[
                 FEPrivate`FrontEndResource[
                 "FEStrings", "sizeBriefExplanation"], StandardForm],
                ImageSizeCache->{70., {3., 10.}}],
               StripOnInput->False,
               DynamicUpdating->True,
               LineSpacing->{1, 2},
               LineIndent->0,
               LinebreakAdjustments->{1., 100, 0, 0, 0}], "OSLText",
              StripOnInput->False],
             StyleBox[
              DynamicBox[
               ToBoxes[
                FEPrivate`FrontEndResource["FEStrings", "sizeExplanation"], 
                StandardForm]], DynamicUpdating -> True, LineIndent -> 0, 
              LinebreakAdjustments -> {1., 100, 0, 0, 0}, 
              LineSpacing -> {1, 2}, StripOnInput -> False]],
            Annotation[#, 
             Style[
              Dynamic[
               FEPrivate`FrontEndResource["FEStrings", "sizeExplanation"]], 
              DynamicUpdating -> True, LineIndent -> 0, 
              LinebreakAdjustments -> {1., 100, 0, 0, 0}, 
              LineSpacing -> {1, 2}], "Tooltip"]& ],
           Alignment->Center,
           BaselinePosition->Baseline,
           ImageSize->{Automatic, {25, Full}}], 
          ButtonBox[
           PaneSelectorBox[{False->
            StyleBox[
             StyleBox[
              DynamicBox[ToBoxes[
                FEPrivate`FrontEndResource["FEStrings", "sizeShowLess"], 
                StandardForm],
               ImageSizeCache->{61., {0., 10.}}],
              StripOnInput->False,
              DynamicUpdating->True,
              LineSpacing->{1, 2},
              LineIndent->0,
              LinebreakAdjustments->{1., 100, 0, 0, 0}], "OSLControl",
             StripOnInput->False], True->
            StyleBox[
             StyleBox[
              DynamicBox[ToBoxes[
                FEPrivate`FrontEndResource["FEStrings", "sizeShowLess"], 
                StandardForm]],
              StripOnInput->False,
              DynamicUpdating->True,
              LineSpacing->{1, 2},
              LineIndent->0,
              LinebreakAdjustments->{1., 100, 0, 0, 0}], "OSLControlActive",
             StripOnInput->False]}, Dynamic[
             CurrentValue["MouseOver"]],
            Alignment->Center,
            FrameMargins->0,
            ImageSize->{Automatic, {25, Full}}],
           Appearance->None,
           BaselinePosition->Baseline,
           
           ButtonFunction:>OutputSizeLimit`ButtonFunction[
            OutputSizeLimit`Defer, 554, 28415626182954115862, 5/2],
           Enabled->True,
           Evaluator->Automatic,
           Method->"Queued"], 
          ButtonBox[
           PaneSelectorBox[{False->
            StyleBox[
             StyleBox[
              DynamicBox[ToBoxes[
                FEPrivate`FrontEndResource["FEStrings", "sizeShowMore"], 
                StandardForm],
               ImageSizeCache->{68., {0., 10.}}],
              StripOnInput->False,
              DynamicUpdating->True,
              LineSpacing->{1, 2},
              LineIndent->0,
              LinebreakAdjustments->{1., 100, 0, 0, 0}], "OSLControl",
             StripOnInput->False], True->
            StyleBox[
             StyleBox[
              DynamicBox[ToBoxes[
                FEPrivate`FrontEndResource["FEStrings", "sizeShowMore"], 
                StandardForm]],
              StripOnInput->False,
              DynamicUpdating->True,
              LineSpacing->{1, 2},
              LineIndent->0,
              LinebreakAdjustments->{1., 100, 0, 0, 0}], "OSLControlActive",
             StripOnInput->False]}, Dynamic[
             CurrentValue["MouseOver"]],
            Alignment->Center,
            FrameMargins->0,
            ImageSize->{Automatic, {25, Full}}],
           Appearance->None,
           BaselinePosition->Baseline,
           
           ButtonFunction:>OutputSizeLimit`ButtonFunction[
            OutputSizeLimit`Defer, 554, 28415626182954115862, 5 2],
           Enabled->True,
           Evaluator->Automatic,
           Method->"Queued"], 
          ButtonBox[
           PaneSelectorBox[{False->
            StyleBox[
             StyleBox[
              DynamicBox[ToBoxes[
                FEPrivate`FrontEndResource["FEStrings", "sizeShowAll"], 
                StandardForm],
               ImageSizeCache->{51., {0., 10.}}],
              StripOnInput->False,
              DynamicUpdating->True,
              LineSpacing->{1, 2},
              LineIndent->0,
              LinebreakAdjustments->{1., 100, 0, 0, 0}], "OSLControl",
             StripOnInput->False], True->
            StyleBox[
             StyleBox[
              DynamicBox[ToBoxes[
                FEPrivate`FrontEndResource["FEStrings", "sizeShowAll"], 
                StandardForm]],
              StripOnInput->False,
              DynamicUpdating->True,
              LineSpacing->{1, 2},
              LineIndent->0,
              LinebreakAdjustments->{1., 100, 0, 0, 0}], "OSLControlActive",
             StripOnInput->False]}, Dynamic[
             CurrentValue["MouseOver"]],
            Alignment->Center,
            FrameMargins->0,
            ImageSize->{Automatic, {25, Full}}],
           Appearance->None,
           BaselinePosition->Baseline,
           
           ButtonFunction:>OutputSizeLimit`ButtonFunction[
            OutputSizeLimit`Defer, 554, 28415626182954115862, Infinity],
           Enabled->True,
           Evaluator->Automatic,
           Method->"Queued"], 
          ButtonBox[
           PaneSelectorBox[{False->
            StyleBox[
             StyleBox[
              DynamicBox[ToBoxes[
                FEPrivate`FrontEndResource["FEStrings", "sizeChangeLimit"], 
                StandardForm],
               ImageSizeCache->{91., {1., 10.}}],
              StripOnInput->False,
              DynamicUpdating->True,
              LineSpacing->{1, 2},
              LineIndent->0,
              LinebreakAdjustments->{1., 100, 0, 0, 0}], "OSLControl",
             StripOnInput->False], True->
            StyleBox[
             StyleBox[
              DynamicBox[ToBoxes[
                FEPrivate`FrontEndResource["FEStrings", "sizeChangeLimit"], 
                StandardForm]],
              StripOnInput->False,
              DynamicUpdating->True,
              LineSpacing->{1, 2},
              LineIndent->0,
              LinebreakAdjustments->{1., 100, 0, 0, 0}], "OSLControlActive",
             StripOnInput->False]}, Dynamic[
             CurrentValue["MouseOver"]],
            Alignment->Center,
            FrameMargins->0,
            ImageSize->{Automatic, {25, Full}}],
           Appearance->None,
           BaselinePosition->Baseline,
           ButtonFunction:>FrontEndExecute[{
              FrontEnd`SetOptions[
              FrontEnd`$FrontEnd, 
               FrontEnd`PreferencesSettings -> {"Page" -> "Advanced"}], 
              FrontEnd`FrontEndToken["PreferencesDialog"]}],
           Evaluator->None,
           Method->"Preemptive"]}
        },
        AutoDelete->False,
        FrameStyle->GrayLevel[0.85],
        GridBoxDividers->{"Columns" -> {False, {True}}},
        GridBoxItemSize->{"Columns" -> {{Automatic}}, "Rows" -> {{Automatic}}},
        GridBoxSpacings->{"Columns" -> {{2}}}]}
     },
     DefaultBaseStyle->"Column",
     GridBoxAlignment->{"Columns" -> {{Left}}, "Rows" -> {{Baseline}}},
     GridBoxDividers->{"Columns" -> {{False}}, "Rows" -> {{False}}},
     GridBoxItemSize->{"Columns" -> {{Automatic}}, "Rows" -> {{1.}}},
     GridBoxSpacings->{"Columns" -> {
         Offset[0.27999999999999997`], {
          Offset[0.5599999999999999]}, 
         Offset[0.27999999999999997`]}, "Rows" -> {
         Offset[0.2], 
         Offset[1.2], {
          Offset[0.4]}, 
         Offset[0.2]}}],
    BaseStyle->"OutputSizeLimit",
    FrameMargins->{{12, 12}, {0, 15}},
    FrameStyle->GrayLevel[0.85],
    RoundingRadius->5,
    StripOnInput->False],
   Deploy,
   DefaultBaseStyle->"Deploy"],
  If[28415626182954115862 === $SessionID, 
   Out[554], Message[
     MessageName[Syntax, "noinfoker"]]; Missing["NotAvailable"]; 
   Null]]], "Output",
 CellChangeTimes->{3.8787987267182426`*^9, 3.878857663094503*^9},
 CellLabel->
  "Out[554]=",ExpressionUUID->"cf36443b-a164-4418-a5e8-7cab45d3a509"]
}, Open  ]],

Cell[BoxData[
 RowBox[{
  RowBox[{"nod", "=", 
   RowBox[{
    RowBox[{
     RowBox[{
      RowBox[{"(", 
       RowBox[{"numAnsatz", "//", "expandFS"}], ")"}], "/.", 
      RowBox[{
       RowBox[{"\[Epsilon]", "[", "i_", "]"}], ":>", 
       RowBox[{"\[Epsilon]", "[", 
        RowBox[{"p", "[", "i", "]"}], "]"}]}]}], "/.", 
     RowBox[{
      RowBox[{"Sinc", "[", "f_", "]"}], ":>", 
      FractionBox[
       RowBox[{"Sin", "[", "f", "]"}], "f"]}]}], "//", "Expand"}]}], 
  ";"}]], "Input",
 CellChangeTimes->{{3.8787987061068687`*^9, 3.878798741355075*^9}, {
   3.878798822184651*^9, 3.878798854912434*^9}, 3.878798905847302*^9},
 CellLabel->
  "In[555]:=",ExpressionUUID->"22661176-08c6-4b88-b9fc-dead9c82ec57"],

Cell[CellGroupData[{

Cell[BoxData["nod"], "Input",
 CellLabel->
  "In[556]:=",ExpressionUUID->"d195c0fc-ac05-4459-8b3b-128adc706ce2"],

Cell[BoxData[
 InterpretationBox[
  TagBox[
   FrameBox[GridBox[{
      {
       ItemBox[
        TagBox[
         RowBox[{
          FractionBox[
           RowBox[{
            RowBox[{"c", "[", "27", "]"}], " ", 
            RowBox[{"Cos", "[", 
             RowBox[{"dot", "[", 
              RowBox[{
               RowBox[{"as", "[", "0", "]"}], ",", 
               RowBox[{"p", "[", "3", "]"}]}], "]"}], "]"}], " ", 
            RowBox[{"dot", "[", 
             RowBox[{
              RowBox[{"as", "[", "0", "]"}], ",", 
              RowBox[{"\[Epsilon]", "[", 
               RowBox[{"p", "[", "1", "]"}], "]"}]}], "]"}], " ", 
            TemplateBox[{"3"},
             "OutputSizeLimit`Skeleton"], " ", 
            RowBox[{"dot", "[", 
             RowBox[{
              RowBox[{"p", "[", "2", "]"}], ",", 
              RowBox[{"p", "[", "3", "]"}]}], "]"}], " ", 
            RowBox[{"Sin", "[", 
             RowBox[{"dot", "[", 
              RowBox[{
               RowBox[{"as", "[", "0", "]"}], ",", 
               RowBox[{"p", "[", "1", "]"}]}], "]"}], "]"}], " ", 
            RowBox[{"Sin", "[", 
             RowBox[{"dot", "[", 
              RowBox[{
               RowBox[{"as", "[", "0", "]"}], ",", 
               RowBox[{"p", "[", "2", "]"}]}], "]"}], "]"}]}], 
           RowBox[{
            RowBox[{"dot", "[", 
             RowBox[{
              RowBox[{"as", "[", "0", "]"}], ",", 
              RowBox[{"p", "[", "1", "]"}]}], "]"}], " ", 
            RowBox[{"dot", "[", 
             RowBox[{
              RowBox[{"as", "[", "0", "]"}], ",", 
              RowBox[{"p", "[", "2", "]"}]}], "]"}]}]], "+", 
          TemplateBox[{"2591"},
           "OutputSizeLimit`Skeleton"]}],
         Short[#, 5]& ],
        BaseStyle->{Deployed -> False},
        StripOnInput->False]},
      {GridBox[{
         {
          PaneBox[
           TagBox[
            TooltipBox[
             StyleBox[
              StyleBox[
               DynamicBox[ToBoxes[
                 FEPrivate`FrontEndResource[
                 "FEStrings", "sizeBriefExplanation"], StandardForm],
                ImageSizeCache->{70., {3., 10.}}],
               StripOnInput->False,
               DynamicUpdating->True,
               LineSpacing->{1, 2},
               LineIndent->0,
               LinebreakAdjustments->{1., 100, 0, 0, 0}], "OSLText",
              StripOnInput->False],
             StyleBox[
              DynamicBox[
               ToBoxes[
                FEPrivate`FrontEndResource["FEStrings", "sizeExplanation"], 
                StandardForm]], DynamicUpdating -> True, LineIndent -> 0, 
              LinebreakAdjustments -> {1., 100, 0, 0, 0}, 
              LineSpacing -> {1, 2}, StripOnInput -> False]],
            Annotation[#, 
             Style[
              Dynamic[
               FEPrivate`FrontEndResource["FEStrings", "sizeExplanation"]], 
              DynamicUpdating -> True, LineIndent -> 0, 
              LinebreakAdjustments -> {1., 100, 0, 0, 0}, 
              LineSpacing -> {1, 2}], "Tooltip"]& ],
           Alignment->Center,
           BaselinePosition->Baseline,
           ImageSize->{Automatic, {25, Full}}], 
          ButtonBox[
           PaneSelectorBox[{False->
            StyleBox[
             StyleBox[
              DynamicBox[ToBoxes[
                FEPrivate`FrontEndResource["FEStrings", "sizeShowLess"], 
                StandardForm],
               ImageSizeCache->{61., {0., 10.}}],
              StripOnInput->False,
              DynamicUpdating->True,
              LineSpacing->{1, 2},
              LineIndent->0,
              LinebreakAdjustments->{1., 100, 0, 0, 0}], "OSLControl",
             StripOnInput->False], True->
            StyleBox[
             StyleBox[
              DynamicBox[ToBoxes[
                FEPrivate`FrontEndResource["FEStrings", "sizeShowLess"], 
                StandardForm]],
              StripOnInput->False,
              DynamicUpdating->True,
              LineSpacing->{1, 2},
              LineIndent->0,
              LinebreakAdjustments->{1., 100, 0, 0, 0}], "OSLControlActive",
             StripOnInput->False]}, Dynamic[
             CurrentValue["MouseOver"]],
            Alignment->Center,
            FrameMargins->0,
            ImageSize->{Automatic, {25, Full}}],
           Appearance->None,
           BaselinePosition->Baseline,
           
           ButtonFunction:>OutputSizeLimit`ButtonFunction[
            OutputSizeLimit`Defer, 556, 28415626182954115862, 5/2],
           Enabled->True,
           Evaluator->Automatic,
           Method->"Queued"], 
          ButtonBox[
           PaneSelectorBox[{False->
            StyleBox[
             StyleBox[
              DynamicBox[ToBoxes[
                FEPrivate`FrontEndResource["FEStrings", "sizeShowMore"], 
                StandardForm],
               ImageSizeCache->{68., {0., 10.}}],
              StripOnInput->False,
              DynamicUpdating->True,
              LineSpacing->{1, 2},
              LineIndent->0,
              LinebreakAdjustments->{1., 100, 0, 0, 0}], "OSLControl",
             StripOnInput->False], True->
            StyleBox[
             StyleBox[
              DynamicBox[ToBoxes[
                FEPrivate`FrontEndResource["FEStrings", "sizeShowMore"], 
                StandardForm]],
              StripOnInput->False,
              DynamicUpdating->True,
              LineSpacing->{1, 2},
              LineIndent->0,
              LinebreakAdjustments->{1., 100, 0, 0, 0}], "OSLControlActive",
             StripOnInput->False]}, Dynamic[
             CurrentValue["MouseOver"]],
            Alignment->Center,
            FrameMargins->0,
            ImageSize->{Automatic, {25, Full}}],
           Appearance->None,
           BaselinePosition->Baseline,
           ButtonFunction:>OutputSizeLimit`ButtonFunction[
            OutputSizeLimit`Defer, 556, 28415626182954115862, 5 2],
           Enabled->True,
           Evaluator->Automatic,
           Method->"Queued"], 
          ButtonBox[
           PaneSelectorBox[{False->
            StyleBox[
             StyleBox[
              DynamicBox[ToBoxes[
                FEPrivate`FrontEndResource["FEStrings", "sizeShowAll"], 
                StandardForm],
               ImageSizeCache->{51., {0., 10.}}],
              StripOnInput->False,
              DynamicUpdating->True,
              LineSpacing->{1, 2},
              LineIndent->0,
              LinebreakAdjustments->{1., 100, 0, 0, 0}], "OSLControl",
             StripOnInput->False], True->
            StyleBox[
             StyleBox[
              DynamicBox[ToBoxes[
                FEPrivate`FrontEndResource["FEStrings", "sizeShowAll"], 
                StandardForm]],
              StripOnInput->False,
              DynamicUpdating->True,
              LineSpacing->{1, 2},
              LineIndent->0,
              LinebreakAdjustments->{1., 100, 0, 0, 0}], "OSLControlActive",
             StripOnInput->False]}, Dynamic[
             CurrentValue["MouseOver"]],
            Alignment->Center,
            FrameMargins->0,
            ImageSize->{Automatic, {25, Full}}],
           Appearance->None,
           BaselinePosition->Baseline,
           
           ButtonFunction:>OutputSizeLimit`ButtonFunction[
            OutputSizeLimit`Defer, 556, 28415626182954115862, Infinity],
           Enabled->True,
           Evaluator->Automatic,
           Method->"Queued"], 
          ButtonBox[
           PaneSelectorBox[{False->
            StyleBox[
             StyleBox[
              DynamicBox[ToBoxes[
                FEPrivate`FrontEndResource["FEStrings", "sizeChangeLimit"], 
                StandardForm],
               ImageSizeCache->{91., {1., 10.}}],
              StripOnInput->False,
              DynamicUpdating->True,
              LineSpacing->{1, 2},
              LineIndent->0,
              LinebreakAdjustments->{1., 100, 0, 0, 0}], "OSLControl",
             StripOnInput->False], True->
            StyleBox[
             StyleBox[
              DynamicBox[ToBoxes[
                FEPrivate`FrontEndResource["FEStrings", "sizeChangeLimit"], 
                StandardForm]],
              StripOnInput->False,
              DynamicUpdating->True,
              LineSpacing->{1, 2},
              LineIndent->0,
              LinebreakAdjustments->{1., 100, 0, 0, 0}], "OSLControlActive",
             StripOnInput->False]}, Dynamic[
             CurrentValue["MouseOver"]],
            Alignment->Center,
            FrameMargins->0,
            ImageSize->{Automatic, {25, Full}}],
           Appearance->None,
           BaselinePosition->Baseline,
           ButtonFunction:>FrontEndExecute[{
              FrontEnd`SetOptions[
              FrontEnd`$FrontEnd, 
               FrontEnd`PreferencesSettings -> {"Page" -> "Advanced"}], 
              FrontEnd`FrontEndToken["PreferencesDialog"]}],
           Evaluator->None,
           Method->"Preemptive"]}
        },
        AutoDelete->False,
        FrameStyle->GrayLevel[0.85],
        GridBoxDividers->{"Columns" -> {False, {True}}},
        GridBoxItemSize->{"Columns" -> {{Automatic}}, "Rows" -> {{Automatic}}},
        GridBoxSpacings->{"Columns" -> {{2}}}]}
     },
     DefaultBaseStyle->"Column",
     GridBoxAlignment->{"Columns" -> {{Left}}, "Rows" -> {{Baseline}}},
     GridBoxDividers->{"Columns" -> {{False}}, "Rows" -> {{False}}},
     GridBoxItemSize->{"Columns" -> {{Automatic}}, "Rows" -> {{1.}}},
     GridBoxSpacings->{"Columns" -> {
         Offset[0.27999999999999997`], {
          Offset[0.5599999999999999]}, 
         Offset[0.27999999999999997`]}, "Rows" -> {
         Offset[0.2], 
         Offset[1.2], {
          Offset[0.4]}, 
         Offset[0.2]}}],
    BaseStyle->"OutputSizeLimit",
    FrameMargins->{{12, 12}, {0, 15}},
    FrameStyle->GrayLevel[0.85],
    RoundingRadius->5,
    StripOnInput->False],
   Deploy,
   DefaultBaseStyle->"Deploy"],
  If[28415626182954115862 === $SessionID, 
   Out[556], Message[
     MessageName[Syntax, "noinfoker"]]; Missing["NotAvailable"]; 
   Null]]], "Output",
 CellChangeTimes->{{3.878798830305826*^9, 3.878798861495463*^9}, 
   3.878798913842605*^9, 3.878857666955915*^9},
 CellLabel->
  "Out[556]=",ExpressionUUID->"2b575402-3f34-4dfe-90ec-7d444276a8ae"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{"bpeff2", "=", 
  RowBox[{"BinaryProduct", "[", 
   RowBox[{"Range", "[", 
    RowBox[{"n", "-", "2"}], "]"}], "]"}]}], "\n", 
 RowBox[{
  RowBox[{"numList", "=", 
   RowBox[{
    RowBox[{
     RowBox[{"ExpandNCM", "/@", 
      RowBox[{"(", 
       RowBox[{"bpeff2", "/.", 
        RowBox[{"X", "\[Rule]", " ", "NC"}]}], ")"}]}], "/.", 
     RowBox[{"NonCommutativeMultiply", "\[Rule]", " ", "T"}]}], "/.", 
    RowBox[{
     RowBox[{"T", "[", 
      RowBox[{"i1_", ",", "f___"}], "]"}], ":>", " ", 
     RowBox[{"0", "/;", 
      RowBox[{"i1", "\[NotEqual]", "1"}]}]}]}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"numListL", "=", 
   RowBox[{"numList", "/.", 
    RowBox[{
     RowBox[{"T", "[", "f___", "]"}], "\[RuleDelayed]", " ", 
     RowBox[{"(", 
      RowBox[{"nod", "/.", 
       RowBox[{"replace", "[", 
        RowBox[{
         RowBox[{"p", "/@", 
          RowBox[{"{", "f", "}"}]}], ",", 
         RowBox[{"n", "-", "1"}]}], "]"}]}], ")"}]}]}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"numListL", "=", 
   RowBox[{
    RowBox[{"(", 
     RowBox[{"numListL", "/.", 
      RowBox[{
       RowBox[{"F", "[", 
        RowBox[{"p", "[", "i_", "]"}], "]"}], ":>", " ", 
       RowBox[{"F", "[", "i", "]"}]}]}], ")"}], "//", "Expand"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"ppListD", "=", 
   RowBox[{"(", 
    RowBox[{"X2Prop", "/@", "bpeff2"}], ")"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"ppListD", "=", 
   RowBox[{
    RowBox[{"ppListD", "/.", 
     RowBox[{
      RowBox[{"p", "[", "f__", "]"}], "\[RuleDelayed]", 
      RowBox[{"Total", "[", 
       RowBox[{"p", "/@", 
        RowBox[{"{", "f", "}"}]}], "]"}]}]}], "/.", 
    RowBox[{
     RowBox[{"dot", "[", 
      RowBox[{
       RowBox[{"p", "[", "i_", "]"}], ",", 
       RowBox[{"p", "[", "i_", "]"}]}], "]"}], ":>", " ", "0"}]}]}], 
  ";"}], "\n", 
 RowBox[{
  RowBox[{"denAll", "=", 
   RowBox[{"Table", "[", 
    RowBox[{
     RowBox[{"ppListD", "[", 
      RowBox[{"[", "ii", "]"}], "]"}], ",", 
     RowBox[{"{", 
      RowBox[{"ii", ",", 
       RowBox[{"Length", "@", "ppListD"}]}], "}"}]}], "]"}]}], ";"}], "\n", 
 RowBox[{
  RowBox[{"amp5even", "=", 
   RowBox[{
    RowBox[{
     RowBox[{"Sum", "[", 
      RowBox[{
       FractionBox[
        RowBox[{"numListL", "[", 
         RowBox[{"[", "ii", "]"}], "]"}], 
        RowBox[{"denAll", "[", 
         RowBox[{"[", "ii", "]"}], "]"}]], ",", 
       RowBox[{"{", 
        RowBox[{"ii", ",", 
         RowBox[{"Length", "@", "ppListD"}]}], "}"}]}], "]"}], "/.", 
     RowBox[{
      RowBox[{"\[Epsilon]", "[", 
       RowBox[{"p", "[", "i_", "]"}], "]"}], ":>", 
      RowBox[{"\[Epsilon]", "[", "i", "]"}]}]}], "//", "Expand"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"amp5even", "=", 
   RowBox[{
    RowBox[{
     RowBox[{
      RowBox[{"amp5even", "/.", "dotRules"}], "/.", "vponshell"}], "/.", 
     "gponshell"}], "//", "Expand"}]}], ";"}]}], "Input",
 CellChangeTimes->{{3.8787988070475492`*^9, 3.878798814304196*^9}},
 CellLabel->
  "In[557]:=",ExpressionUUID->"de985d30-a5a3-4f18-8ed0-c38c938abaff"],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
   RowBox[{"X", "[", 
    RowBox[{"1", ",", 
     RowBox[{"X", "[", 
      RowBox[{"2", ",", "3"}], "]"}]}], "]"}], ",", 
   RowBox[{"X", "[", 
    RowBox[{
     RowBox[{"X", "[", 
      RowBox[{"1", ",", "2"}], "]"}], ",", "3"}], "]"}]}], "}"}]], "Output",
 CellChangeTimes->{3.878798943523139*^9, 3.878799468726018*^9, 
  3.8788576669851427`*^9},
 CellLabel->
  "Out[557]=",ExpressionUUID->"1e963b50-8d39-431c-9388-564fcae23639"]
}, Open  ]],

Cell[BoxData[
 RowBox[{
  RowBox[{"eqns", "=", 
   RowBox[{"amp5even", "-", "comp123even"}]}], ";"}]], "Input",
 CellChangeTimes->{
  3.878798820068008*^9, {3.87879895120823*^9, 3.87879897404138*^9}, {
   3.8787990531866713`*^9, 3.87879905973487*^9}, {3.8787991648218317`*^9, 
   3.8787991676814003`*^9}, 3.878799478734667*^9},
 CellLabel->
  "In[566]:=",ExpressionUUID->"d62bf616-54a8-4fe6-8df2-76864ef6a64f"],

Cell[BoxData[{
 RowBox[{
  RowBox[{"varcos", "=", 
   RowBox[{
    RowBox[{"eqns", "//", 
     RowBox[{
      RowBox[{"Cases", "[", 
       RowBox[{"#", ",", 
        RowBox[{"Cos", "[", "f_", "]"}], ",", 
        RowBox[{"{", 
         RowBox[{"0", ",", "\[Infinity]"}], "}"}]}], "]"}], "&"}]}], "//", 
    "Union"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"varsin", "=", 
   RowBox[{
    RowBox[{"eqns", "//", 
     RowBox[{
      RowBox[{"Cases", "[", 
       RowBox[{"#", ",", 
        RowBox[{"Sin", "[", "f_", "]"}], ",", 
        RowBox[{"{", 
         RowBox[{"0", ",", "\[Infinity]"}], "}"}]}], "]"}], "&"}]}], "//", 
    "Union"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"varcs", "=", 
   RowBox[{"Join", "[", 
    RowBox[{"varcos", ",", "varsin"}], "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"vardot", "=", 
   RowBox[{"eqns", "//", "Casesdot"}]}], ";"}]}], "Input",
 CellChangeTimes->{{3.878799066635956*^9, 3.87879914533348*^9}, {
  3.878799486888377*^9, 3.8787995350538607`*^9}},
 CellLabel->
  "In[567]:=",ExpressionUUID->"4fd938bf-480f-43c5-b535-e27e8a2278bf"],

Cell[BoxData[{
 RowBox[{"cs2num", ":=", 
  RowBox[{"Table", "[", 
   RowBox[{
    RowBox[{"Rule", "[", 
     RowBox[{
      RowBox[{"varcs", "[", 
       RowBox[{"[", "ii", "]"}], "]"}], ",", 
      RowBox[{"RandomInteger", "[", 
       RowBox[{"{", 
        RowBox[{"10", ",", "100"}], "}"}], "]"}]}], "]"}], ",", 
    RowBox[{"{", 
     RowBox[{"ii", ",", 
      RowBox[{"Length", "[", "varcs", "]"}]}], "}"}]}], 
   "]"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"dot2num", ":=", 
   RowBox[{"Table", "[", 
    RowBox[{
     RowBox[{"Rule", "[", 
      RowBox[{
       RowBox[{"vardot", "[", 
        RowBox[{"[", "ii", "]"}], "]"}], ",", 
       RowBox[{"RandomInteger", "[", 
        RowBox[{"{", 
         RowBox[{"10", ",", "100"}], "}"}], "]"}]}], "]"}], ",", 
     RowBox[{"{", 
      RowBox[{"ii", ",", 
       RowBox[{"Length", "[", "vardot", "]"}]}], "}"}]}], "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"cvars", "=", 
   RowBox[{"numAnsatz", "//", 
    RowBox[{
     RowBox[{"Cases", "[", 
      RowBox[{"#", ",", 
       RowBox[{"c", "[", "i_", "]"}], ",", 
       RowBox[{"{", 
        RowBox[{"0", ",", "\[Infinity]"}], "}"}]}], "]"}], "&"}]}]}], 
  ";"}], "\[IndentingNewLine]"}], "Input",
 CellChangeTimes->{{3.878799511850357*^9, 3.878799533481596*^9}, {
  3.878799570863429*^9, 3.878799629467163*^9}, {3.8787996647257233`*^9, 
  3.878799709419997*^9}},
 CellLabel->
  "In[571]:=",ExpressionUUID->"af7827a7-0275-49f1-a84d-4116e6360d30"],

Cell[CellGroupData[{

Cell[BoxData["cvars"], "Input",
 CellLabel->
  "In[574]:=",ExpressionUUID->"5d75d902-f8c7-4d3b-93ad-1ea6c16181ca"],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
   RowBox[{"c", "[", "1", "]"}], ",", 
   RowBox[{"c", "[", "2", "]"}], ",", 
   RowBox[{"c", "[", "3", "]"}], ",", 
   RowBox[{"c", "[", "4", "]"}], ",", 
   RowBox[{"c", "[", "5", "]"}], ",", 
   RowBox[{"c", "[", "6", "]"}], ",", 
   RowBox[{"c", "[", "7", "]"}], ",", 
   RowBox[{"c", "[", "8", "]"}], ",", 
   RowBox[{"c", "[", "9", "]"}], ",", 
   RowBox[{"c", "[", "10", "]"}], ",", 
   RowBox[{"c", "[", "11", "]"}], ",", 
   RowBox[{"c", "[", "12", "]"}], ",", 
   RowBox[{"c", "[", "13", "]"}], ",", 
   RowBox[{"c", "[", "14", "]"}], ",", 
   RowBox[{"c", "[", "15", "]"}], ",", 
   RowBox[{"c", "[", "16", "]"}], ",", 
   RowBox[{"c", "[", "17", "]"}], ",", 
   RowBox[{"c", "[", "18", "]"}], ",", 
   RowBox[{"c", "[", "19", "]"}], ",", 
   RowBox[{"c", "[", "20", "]"}], ",", 
   RowBox[{"c", "[", "21", "]"}], ",", 
   RowBox[{"c", "[", "22", "]"}], ",", 
   RowBox[{"c", "[", "23", "]"}], ",", 
   RowBox[{"c", "[", "24", "]"}], ",", 
   RowBox[{"c", "[", "25", "]"}], ",", 
   RowBox[{"c", "[", "26", "]"}], ",", 
   RowBox[{"c", "[", "27", "]"}], ",", 
   RowBox[{"c", "[", "28", "]"}], ",", 
   RowBox[{"c", "[", "29", "]"}], ",", 
   RowBox[{"c", "[", "30", "]"}], ",", 
   RowBox[{"c", "[", "31", "]"}], ",", 
   RowBox[{"c", "[", "32", "]"}], ",", 
   RowBox[{"c", "[", "33", "]"}], ",", 
   RowBox[{"c", "[", "34", "]"}], ",", 
   RowBox[{"c", "[", "35", "]"}], ",", 
   RowBox[{"c", "[", "36", "]"}], ",", 
   RowBox[{"c", "[", "37", "]"}], ",", 
   RowBox[{"c", "[", "38", "]"}], ",", 
   RowBox[{"c", "[", "39", "]"}], ",", 
   RowBox[{"c", "[", "40", "]"}], ",", 
   RowBox[{"c", "[", "41", "]"}], ",", 
   RowBox[{"c", "[", "42", "]"}], ",", 
   RowBox[{"c", "[", "43", "]"}], ",", 
   RowBox[{"c", "[", "44", "]"}], ",", 
   RowBox[{"c", "[", "45", "]"}], ",", 
   RowBox[{"c", "[", "46", "]"}], ",", 
   RowBox[{"c", "[", "47", "]"}], ",", 
   RowBox[{"c", "[", "48", "]"}], ",", 
   RowBox[{"c", "[", "49", "]"}], ",", 
   RowBox[{"c", "[", "50", "]"}], ",", 
   RowBox[{"c", "[", "51", "]"}], ",", 
   RowBox[{"c", "[", "52", "]"}], ",", 
   RowBox[{"c", "[", "53", "]"}], ",", 
   RowBox[{"c", "[", "54", "]"}], ",", 
   RowBox[{"c", "[", "55", "]"}], ",", 
   RowBox[{"c", "[", "56", "]"}], ",", 
   RowBox[{"c", "[", "57", "]"}], ",", 
   RowBox[{"c", "[", "58", "]"}], ",", 
   RowBox[{"c", "[", "59", "]"}], ",", 
   RowBox[{"c", "[", "60", "]"}], ",", 
   RowBox[{"c", "[", "61", "]"}], ",", 
   RowBox[{"c", "[", "62", "]"}], ",", 
   RowBox[{"c", "[", "63", "]"}], ",", 
   RowBox[{"c", "[", "64", "]"}], ",", 
   RowBox[{"c", "[", "65", "]"}], ",", 
   RowBox[{"c", "[", "66", "]"}], ",", 
   RowBox[{"c", "[", "67", "]"}], ",", 
   RowBox[{"c", "[", "68", "]"}], ",", 
   RowBox[{"c", "[", "69", "]"}], ",", 
   RowBox[{"c", "[", "70", "]"}], ",", 
   RowBox[{"c", "[", "71", "]"}], ",", 
   RowBox[{"c", "[", "72", "]"}], ",", 
   RowBox[{"c", "[", "73", "]"}], ",", 
   RowBox[{"c", "[", "74", "]"}], ",", 
   RowBox[{"c", "[", "75", "]"}], ",", 
   RowBox[{"c", "[", "76", "]"}], ",", 
   RowBox[{"c", "[", "77", "]"}], ",", 
   RowBox[{"c", "[", "78", "]"}], ",", 
   RowBox[{"c", "[", "79", "]"}], ",", 
   RowBox[{"c", "[", "80", "]"}], ",", 
   RowBox[{"c", "[", "81", "]"}], ",", 
   RowBox[{"c", "[", "82", "]"}], ",", 
   RowBox[{"c", "[", "83", "]"}], ",", 
   RowBox[{"c", "[", "84", "]"}], ",", 
   RowBox[{"c", "[", "85", "]"}], ",", 
   RowBox[{"c", "[", "86", "]"}], ",", 
   RowBox[{"c", "[", "87", "]"}], ",", 
   RowBox[{"c", "[", "88", "]"}], ",", 
   RowBox[{"c", "[", "89", "]"}], ",", 
   RowBox[{"c", "[", "90", "]"}], ",", 
   RowBox[{"c", "[", "91", "]"}], ",", 
   RowBox[{"c", "[", "92", "]"}], ",", 
   RowBox[{"c", "[", "93", "]"}], ",", 
   RowBox[{"c", "[", "94", "]"}], ",", 
   RowBox[{"c", "[", "95", "]"}], ",", 
   RowBox[{"c", "[", "96", "]"}], ",", 
   RowBox[{"c", "[", "97", "]"}], ",", 
   RowBox[{"c", "[", "98", "]"}], ",", 
   RowBox[{"c", "[", "99", "]"}], ",", 
   RowBox[{"c", "[", "100", "]"}], ",", 
   RowBox[{"c", "[", "101", "]"}], ",", 
   RowBox[{"c", "[", "102", "]"}], ",", 
   RowBox[{"c", "[", "103", "]"}], ",", 
   RowBox[{"c", "[", "104", "]"}], ",", 
   RowBox[{"c", "[", "105", "]"}], ",", 
   RowBox[{"c", "[", "106", "]"}], ",", 
   RowBox[{"c", "[", "107", "]"}], ",", 
   RowBox[{"c", "[", "108", "]"}], ",", 
   RowBox[{"c", "[", "109", "]"}], ",", 
   RowBox[{"c", "[", "110", "]"}], ",", 
   RowBox[{"c", "[", "111", "]"}], ",", 
   RowBox[{"c", "[", "112", "]"}], ",", 
   RowBox[{"c", "[", "113", "]"}], ",", 
   RowBox[{"c", "[", "114", "]"}], ",", 
   RowBox[{"c", "[", "115", "]"}], ",", 
   RowBox[{"c", "[", "116", "]"}], ",", 
   RowBox[{"c", "[", "117", "]"}], ",", 
   RowBox[{"c", "[", "118", "]"}], ",", 
   RowBox[{"c", "[", "119", "]"}], ",", 
   RowBox[{"c", "[", "120", "]"}], ",", 
   RowBox[{"c", "[", "121", "]"}], ",", 
   RowBox[{"c", "[", "122", "]"}], ",", 
   RowBox[{"c", "[", "123", "]"}], ",", 
   RowBox[{"c", "[", "124", "]"}], ",", 
   RowBox[{"c", "[", "125", "]"}], ",", 
   RowBox[{"c", "[", "126", "]"}], ",", 
   RowBox[{"c", "[", "127", "]"}], ",", 
   RowBox[{"c", "[", "128", "]"}], ",", 
   RowBox[{"c", "[", "129", "]"}], ",", 
   RowBox[{"c", "[", "130", "]"}], ",", 
   RowBox[{"c", "[", "131", "]"}], ",", 
   RowBox[{"c", "[", "132", "]"}], ",", 
   RowBox[{"c", "[", "133", "]"}], ",", 
   RowBox[{"c", "[", "134", "]"}], ",", 
   RowBox[{"c", "[", "135", "]"}], ",", 
   RowBox[{"c", "[", "136", "]"}], ",", 
   RowBox[{"c", "[", "137", "]"}], ",", 
   RowBox[{"c", "[", "138", "]"}], ",", 
   RowBox[{"c", "[", "139", "]"}], ",", 
   RowBox[{"c", "[", "140", "]"}], ",", 
   RowBox[{"c", "[", "141", "]"}], ",", 
   RowBox[{"c", "[", "142", "]"}], ",", 
   RowBox[{"c", "[", "143", "]"}], ",", 
   RowBox[{"c", "[", "144", "]"}], ",", 
   RowBox[{"c", "[", "145", "]"}], ",", 
   RowBox[{"c", "[", "146", "]"}], ",", 
   RowBox[{"c", "[", "147", "]"}], ",", 
   RowBox[{"c", "[", "148", "]"}], ",", 
   RowBox[{"c", "[", "149", "]"}], ",", 
   RowBox[{"c", "[", "150", "]"}], ",", 
   RowBox[{"c", "[", "151", "]"}], ",", 
   RowBox[{"c", "[", "152", "]"}], ",", 
   RowBox[{"c", "[", "153", "]"}], ",", 
   RowBox[{"c", "[", "154", "]"}], ",", 
   RowBox[{"c", "[", "155", "]"}], ",", 
   RowBox[{"c", "[", "156", "]"}], ",", 
   RowBox[{"c", "[", "157", "]"}], ",", 
   RowBox[{"c", "[", "158", "]"}], ",", 
   RowBox[{"c", "[", "159", "]"}], ",", 
   RowBox[{"c", "[", "160", "]"}], ",", 
   RowBox[{"c", "[", "161", "]"}], ",", 
   RowBox[{"c", "[", "162", "]"}], ",", 
   RowBox[{"c", "[", "163", "]"}], ",", 
   RowBox[{"c", "[", "164", "]"}], ",", 
   RowBox[{"c", "[", "165", "]"}], ",", 
   RowBox[{"c", "[", "166", "]"}], ",", 
   RowBox[{"c", "[", "167", "]"}], ",", 
   RowBox[{"c", "[", "168", "]"}], ",", 
   RowBox[{"c", "[", "169", "]"}], ",", 
   RowBox[{"c", "[", "170", "]"}], ",", 
   RowBox[{"c", "[", "171", "]"}], ",", 
   RowBox[{"c", "[", "172", "]"}], ",", 
   RowBox[{"c", "[", "173", "]"}], ",", 
   RowBox[{"c", "[", "174", "]"}], ",", 
   RowBox[{"c", "[", "175", "]"}], ",", 
   RowBox[{"c", "[", "176", "]"}], ",", 
   RowBox[{"c", "[", "177", "]"}], ",", 
   RowBox[{"c", "[", "178", "]"}], ",", 
   RowBox[{"c", "[", "179", "]"}], ",", 
   RowBox[{"c", "[", "180", "]"}], ",", 
   RowBox[{"c", "[", "181", "]"}], ",", 
   RowBox[{"c", "[", "182", "]"}], ",", 
   RowBox[{"c", "[", "183", "]"}], ",", 
   RowBox[{"c", "[", "184", "]"}], ",", 
   RowBox[{"c", "[", "185", "]"}], ",", 
   RowBox[{"c", "[", "186", "]"}], ",", 
   RowBox[{"c", "[", "187", "]"}], ",", 
   RowBox[{"c", "[", "188", "]"}], ",", 
   RowBox[{"c", "[", "189", "]"}], ",", 
   RowBox[{"c", "[", "190", "]"}], ",", 
   RowBox[{"c", "[", "191", "]"}], ",", 
   RowBox[{"c", "[", "192", "]"}], ",", 
   RowBox[{"c", "[", "193", "]"}], ",", 
   RowBox[{"c", "[", "194", "]"}], ",", 
   RowBox[{"c", "[", "195", "]"}], ",", 
   RowBox[{"c", "[", "196", "]"}], ",", 
   RowBox[{"c", "[", "197", "]"}], ",", 
   RowBox[{"c", "[", "198", "]"}], ",", 
   RowBox[{"c", "[", "199", "]"}], ",", 
   RowBox[{"c", "[", "200", "]"}], ",", 
   RowBox[{"c", "[", "201", "]"}], ",", 
   RowBox[{"c", "[", "202", "]"}], ",", 
   RowBox[{"c", "[", "203", "]"}], ",", 
   RowBox[{"c", "[", "204", "]"}], ",", 
   RowBox[{"c", "[", "205", "]"}], ",", 
   RowBox[{"c", "[", "206", "]"}], ",", 
   RowBox[{"c", "[", "207", "]"}], ",", 
   RowBox[{"c", "[", "208", "]"}], ",", 
   RowBox[{"c", "[", "209", "]"}], ",", 
   RowBox[{"c", "[", "210", "]"}], ",", 
   RowBox[{"c", "[", "211", "]"}], ",", 
   RowBox[{"c", "[", "212", "]"}], ",", 
   RowBox[{"c", "[", "213", "]"}], ",", 
   RowBox[{"c", "[", "214", "]"}], ",", 
   RowBox[{"c", "[", "215", "]"}], ",", 
   RowBox[{"c", "[", "216", "]"}], ",", 
   RowBox[{"c", "[", "217", "]"}], ",", 
   RowBox[{"c", "[", "218", "]"}], ",", 
   RowBox[{"c", "[", "219", "]"}], ",", 
   RowBox[{"c", "[", "220", "]"}], ",", 
   RowBox[{"c", "[", "221", "]"}], ",", 
   RowBox[{"c", "[", "222", "]"}], ",", 
   RowBox[{"c", "[", "223", "]"}], ",", 
   RowBox[{"c", "[", "224", "]"}], ",", 
   RowBox[{"c", "[", "225", "]"}], ",", 
   RowBox[{"c", "[", "226", "]"}], ",", 
   RowBox[{"c", "[", "227", "]"}], ",", 
   RowBox[{"c", "[", "228", "]"}], ",", 
   RowBox[{"c", "[", "229", "]"}], ",", 
   RowBox[{"c", "[", "230", "]"}], ",", 
   RowBox[{"c", "[", "231", "]"}], ",", 
   RowBox[{"c", "[", "232", "]"}], ",", 
   RowBox[{"c", "[", "233", "]"}], ",", 
   RowBox[{"c", "[", "234", "]"}], ",", 
   RowBox[{"c", "[", "235", "]"}], ",", 
   RowBox[{"c", "[", "236", "]"}], ",", 
   RowBox[{"c", "[", "237", "]"}], ",", 
   RowBox[{"c", "[", "238", "]"}], ",", 
   RowBox[{"c", "[", "239", "]"}], ",", 
   RowBox[{"c", "[", "240", "]"}], ",", 
   RowBox[{"c", "[", "241", "]"}], ",", 
   RowBox[{"c", "[", "242", "]"}], ",", 
   RowBox[{"c", "[", "243", "]"}]}], "}"}]], "Output",
 CellChangeTimes->{3.878799716667849*^9, 3.878857669675194*^9},
 CellLabel->
  "Out[574]=",ExpressionUUID->"05a1358e-a232-46a4-b915-ac9cdcfe7450"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{"Monitor", "[", 
  RowBox[{
   RowBox[{
    RowBox[{"eqDep", "=", 
     RowBox[{"Table", "[", 
      RowBox[{
       RowBox[{
        RowBox[{
         RowBox[{"eqns", "\[Equal]", "0"}], "/.", "cs2num"}], "/.", 
        "dot2num"}], ",", 
       RowBox[{"{", 
        RowBox[{"ii", ",", 
         RowBox[{"10", "+", 
          RowBox[{"Length", "[", "cvars", "]"}]}]}], "}"}]}], "]"}]}], ";"}], 
   ",", "ii"}], "]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"sols", "=", 
   RowBox[{
    RowBox[{"Solve", "[", 
     RowBox[{"eqDep", ",", "cvars"}], "]"}], "[", 
    RowBox[{"[", "1", "]"}], "]"}]}], ";"}]}], "Input",
 CellLabel->
  "In[575]:=",ExpressionUUID->"4570e46d-99a6-49da-a7ed-b97dfadb907b"],

Cell[BoxData[
 TemplateBox[{
  "Solve", "svars", 
   "\"Equations may not give solutions for all \\\"solve\\\" variables.\"", 2,
    576, 16, 28415626182954115862, "Local"},
  "MessageTemplate"]], "Message", "MSG",
 CellChangeTimes->{3.878799768038611*^9, 3.878857710649988*^9},
 CellLabel->
  "During evaluation of \
In[575]:=",ExpressionUUID->"c6e4aa44-ba7d-4e2d-ad74-21c93597bbfe"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"numAnsatz", "/.", "sols"}], "/.", 
    RowBox[{
     RowBox[{"c", "[", "_", "]"}], ":>", "0"}]}], "/.", "nicevs"}], "//.", 
  "nice"}]], "Input",
 CellChangeTimes->{{3.878799793684469*^9, 3.878799804028249*^9}, {
  3.878800011492939*^9, 3.878800019331317*^9}},
 CellLabel->
  "In[577]:=",ExpressionUUID->"3ea65908-6608-43d0-a1f7-467027367a06"],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"-", 
    RowBox[{"(", 
     RowBox[{"a", "\[CenterDot]", 
      SubscriptBox["F", "1"], "\[CenterDot]", 
      SubscriptBox["p", "2"]}], ")"}]}], " ", 
   RowBox[{"a", "\[CenterDot]", 
    SubscriptBox["F", "2"], "\[CenterDot]", 
    SubscriptBox["F", "3"], "\[CenterDot]", "v"}], " ", 
   RowBox[{"Cos", "[", 
    RowBox[{"a", "\[CenterDot]", 
     SubscriptBox["p", "3"]}], "]"}], " ", 
   RowBox[{"Sinc", "[", 
    RowBox[{"a", "\[CenterDot]", 
     SubscriptBox["p", "1"]}], "]"}], " ", 
   RowBox[{"Sinc", "[", 
    RowBox[{"a", "\[CenterDot]", 
     SubscriptBox["p", "2"]}], "]"}]}], "+", 
  RowBox[{
   RowBox[{"a", "\[CenterDot]", 
    SubscriptBox["p", "1"]}], " ", 
   RowBox[{"a", "\[CenterDot]", 
    SubscriptBox["F", "2"], "\[CenterDot]", 
    SubscriptBox["F", "1"], "\[CenterDot]", 
    SubscriptBox["F", "3"], "\[CenterDot]", "v"}], " ", 
   RowBox[{"Cos", "[", 
    RowBox[{"a", "\[CenterDot]", 
     SubscriptBox["p", "3"]}], "]"}], " ", 
   RowBox[{"Sinc", "[", 
    RowBox[{"a", "\[CenterDot]", 
     SubscriptBox["p", "1"]}], "]"}], " ", 
   RowBox[{"Sinc", "[", 
    RowBox[{"a", "\[CenterDot]", 
     SubscriptBox["p", "2"]}], "]"}]}], "+", 
  RowBox[{
   RowBox[{"a", "\[CenterDot]", 
    SubscriptBox["F", "1"], "\[CenterDot]", 
    SubscriptBox["p", "2"]}], " ", 
   RowBox[{"a", "\[CenterDot]", 
    SubscriptBox["F", "3"], "\[CenterDot]", 
    SubscriptBox["F", "2"], "\[CenterDot]", "v"}], " ", 
   RowBox[{"Cos", "[", 
    RowBox[{"a", "\[CenterDot]", 
     SubscriptBox["p", "2"]}], "]"}], " ", 
   RowBox[{"Sinc", "[", 
    RowBox[{"a", "\[CenterDot]", 
     SubscriptBox["p", "1"]}], "]"}], " ", 
   RowBox[{"Sinc", "[", 
    RowBox[{"a", "\[CenterDot]", 
     SubscriptBox["p", "3"]}], "]"}]}], "+", 
  RowBox[{
   RowBox[{"v", "\[CenterDot]", 
    SubscriptBox["p", "3"]}], " ", 
   RowBox[{"a", "\[CenterDot]", 
    SubscriptBox["F", "1"], "\[CenterDot]", 
    SubscriptBox["F", "2"], "\[CenterDot]", 
    SubscriptBox["F", "3"], "\[CenterDot]", "a"}], " ", 
   RowBox[{"Cos", "[", 
    RowBox[{"a", "\[CenterDot]", 
     SubscriptBox["p", "2"]}], "]"}], " ", 
   RowBox[{"Sinc", "[", 
    RowBox[{"a", "\[CenterDot]", 
     SubscriptBox["p", "1"]}], "]"}], " ", 
   RowBox[{"Sinc", "[", 
    RowBox[{"a", "\[CenterDot]", 
     SubscriptBox["p", "3"]}], "]"}]}], "-", 
  RowBox[{
   RowBox[{"a", "\[CenterDot]", 
    SubscriptBox["p", "3"]}], " ", 
   RowBox[{"a", "\[CenterDot]", 
    SubscriptBox["F", "1"], "\[CenterDot]", 
    SubscriptBox["F", "2"], "\[CenterDot]", 
    SubscriptBox["F", "3"], "\[CenterDot]", "v"}], " ", 
   RowBox[{"Cos", "[", 
    RowBox[{"a", "\[CenterDot]", 
     SubscriptBox["p", "2"]}], "]"}], " ", 
   RowBox[{"Sinc", "[", 
    RowBox[{"a", "\[CenterDot]", 
     SubscriptBox["p", "1"]}], "]"}], " ", 
   RowBox[{"Sinc", "[", 
    RowBox[{"a", "\[CenterDot]", 
     SubscriptBox["p", "3"]}], "]"}]}], "+", 
  RowBox[{
   RowBox[{"a", "\[CenterDot]", 
    SubscriptBox["p", "1"]}], " ", 
   RowBox[{"a", "\[CenterDot]", 
    SubscriptBox["F", "3"], "\[CenterDot]", 
    SubscriptBox["F", "1"], "\[CenterDot]", 
    SubscriptBox["F", "2"], "\[CenterDot]", "v"}], " ", 
   RowBox[{"Cos", "[", 
    RowBox[{"a", "\[CenterDot]", 
     SubscriptBox["p", "2"]}], "]"}], " ", 
   RowBox[{"Sinc", "[", 
    RowBox[{"a", "\[CenterDot]", 
     SubscriptBox["p", "1"]}], "]"}], " ", 
   RowBox[{"Sinc", "[", 
    RowBox[{"a", "\[CenterDot]", 
     SubscriptBox["p", "3"]}], "]"}]}], "-", 
  RowBox[{
   RowBox[{"a", "\[CenterDot]", 
    SubscriptBox["p", "1"]}], " ", 
   RowBox[{"a", "\[CenterDot]", 
    SubscriptBox["F", "3"], "\[CenterDot]", 
    SubscriptBox["F", "2"], "\[CenterDot]", 
    SubscriptBox["F", "1"], "\[CenterDot]", "v"}], " ", 
   RowBox[{"Cos", "[", 
    RowBox[{"a", "\[CenterDot]", 
     SubscriptBox["p", "2"]}], "]"}], " ", 
   RowBox[{"Sinc", "[", 
    RowBox[{"a", "\[CenterDot]", 
     SubscriptBox["p", "1"]}], "]"}], " ", 
   RowBox[{"Sinc", "[", 
    RowBox[{"a", "\[CenterDot]", 
     SubscriptBox["p", "3"]}], "]"}]}], "-", 
  RowBox[{
   RowBox[{"a", "\[CenterDot]", 
    SubscriptBox["F", "2"], "\[CenterDot]", 
    SubscriptBox["p", "1"]}], " ", 
   RowBox[{"a", "\[CenterDot]", 
    SubscriptBox["F", "3"], "\[CenterDot]", 
    SubscriptBox["F", "1"], "\[CenterDot]", "v"}], " ", 
   RowBox[{"Cos", "[", 
    RowBox[{"a", "\[CenterDot]", 
     SubscriptBox["p", "1"]}], "]"}], " ", 
   RowBox[{"Sinc", "[", 
    RowBox[{"a", "\[CenterDot]", 
     SubscriptBox["p", "2"]}], "]"}], " ", 
   RowBox[{"Sinc", "[", 
    RowBox[{"a", "\[CenterDot]", 
     SubscriptBox["p", "3"]}], "]"}]}], "-", 
  RowBox[{
   RowBox[{"v", "\[CenterDot]", 
    SubscriptBox["p", "3"]}], " ", 
   RowBox[{"a", "\[CenterDot]", 
    SubscriptBox["F", "2"], "\[CenterDot]", 
    SubscriptBox["F", "1"], "\[CenterDot]", 
    SubscriptBox["F", "3"], "\[CenterDot]", "a"}], " ", 
   RowBox[{"Cos", "[", 
    RowBox[{"a", "\[CenterDot]", 
     SubscriptBox["p", "1"]}], "]"}], " ", 
   RowBox[{"Sinc", "[", 
    RowBox[{"a", "\[CenterDot]", 
     SubscriptBox["p", "2"]}], "]"}], " ", 
   RowBox[{"Sinc", "[", 
    RowBox[{"a", "\[CenterDot]", 
     SubscriptBox["p", "3"]}], "]"}]}], "+", 
  RowBox[{
   RowBox[{"a", "\[CenterDot]", 
    SubscriptBox["p", "3"]}], " ", 
   RowBox[{"a", "\[CenterDot]", 
    SubscriptBox["F", "2"], "\[CenterDot]", 
    SubscriptBox["F", "1"], "\[CenterDot]", 
    SubscriptBox["F", "3"], "\[CenterDot]", "v"}], " ", 
   RowBox[{"Cos", "[", 
    RowBox[{"a", "\[CenterDot]", 
     SubscriptBox["p", "1"]}], "]"}], " ", 
   RowBox[{"Sinc", "[", 
    RowBox[{"a", "\[CenterDot]", 
     SubscriptBox["p", "2"]}], "]"}], " ", 
   RowBox[{"Sinc", "[", 
    RowBox[{"a", "\[CenterDot]", 
     SubscriptBox["p", "3"]}], "]"}]}], "+", 
  RowBox[{
   RowBox[{"a", "\[CenterDot]", 
    SubscriptBox["p", "2"]}], " ", 
   RowBox[{"a", "\[CenterDot]", 
    SubscriptBox["F", "3"], "\[CenterDot]", 
    SubscriptBox["F", "1"], "\[CenterDot]", 
    SubscriptBox["F", "2"], "\[CenterDot]", "v"}], " ", 
   RowBox[{"Cos", "[", 
    RowBox[{"a", "\[CenterDot]", 
     SubscriptBox["p", "1"]}], "]"}], " ", 
   RowBox[{"Sinc", "[", 
    RowBox[{"a", "\[CenterDot]", 
     SubscriptBox["p", "2"]}], "]"}], " ", 
   RowBox[{"Sinc", "[", 
    RowBox[{"a", "\[CenterDot]", 
     SubscriptBox["p", "3"]}], "]"}]}], "-", 
  RowBox[{
   RowBox[{"a", "\[CenterDot]", 
    SubscriptBox["p", "2"]}], " ", 
   RowBox[{"a", "\[CenterDot]", 
    SubscriptBox["F", "3"], "\[CenterDot]", 
    SubscriptBox["F", "2"], "\[CenterDot]", 
    SubscriptBox["F", "1"], "\[CenterDot]", "v"}], " ", 
   RowBox[{"Cos", "[", 
    RowBox[{"a", "\[CenterDot]", 
     SubscriptBox["p", "1"]}], "]"}], " ", 
   RowBox[{"Sinc", "[", 
    RowBox[{"a", "\[CenterDot]", 
     SubscriptBox["p", "2"]}], "]"}], " ", 
   RowBox[{"Sinc", "[", 
    RowBox[{"a", "\[CenterDot]", 
     SubscriptBox["p", "3"]}], "]"}]}]}]], "Output",
 CellChangeTimes->{{3.878799795642392*^9, 3.87879980458854*^9}, 
   3.878800020149506*^9, 3.878857710716914*^9},
 CellLabel->
  "Out[577]=",ExpressionUUID->"69a2f9e1-4dff-45e1-81cc-70e24675a381"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"sols", "//", "Length"}]], "Input",
 CellChangeTimes->{{3.8788577301640377`*^9, 3.87885773151493*^9}},
 CellLabel->
  "In[580]:=",ExpressionUUID->"2166d1b2-bac7-4254-b3fb-d47cda1c3162"],

Cell[BoxData["186"], "Output",
 CellChangeTimes->{
  3.8787997748275337`*^9, {3.878857710725148*^9, 3.878857731974576*^9}},
 CellLabel->
  "Out[580]=",ExpressionUUID->"5679502b-dfc0-44c0-b25a-e4596a67265a"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"Cos", "[", "2", "]"}]], "Input",
 CellChangeTimes->{3.878799018711686*^9},
 CellLabel->
  "In[579]:=",ExpressionUUID->"ff45ed92-074a-41a4-bb1c-b8a9d9f9c130"],

Cell[BoxData[
 RowBox[{"Cos", "[", "2", "]"}]], "Output",
 CellChangeTimes->{3.878799019309499*^9, 3.878857710748542*^9},
 CellLabel->
  "Out[579]=",ExpressionUUID->"950d9972-6140-4bfd-a685-1e594cf15523"]
}, Open  ]]
}, Closed]]
}, Open  ]]
},
WindowSize->{1103, 795},
WindowMargins->{{126, Automatic}, {Automatic, 0}},
PrivateNotebookOptions->{"VersionedStylesheet"->{"Default.nb"[8.] -> False}},
TaggingRules->Association["TryRealOnly" -> False],
Magnification:>1.25 Inherited,
FrontEndVersion->"12.3 for Mac OS X x86 (64-bit) (June 19, 2021)",
StyleDefinitions->FrontEnd`FileName[{"Report"}, "StandardReport.nb", 
  CharacterEncoding -> "UTF-8"],
ExpressionUUID->"b8b22cab-2f3f-4c50-b7dc-f4a33feecd7e"
]
(* End of Notebook Content *)

(* Internal cache information *)
(*CellTagsOutline
CellTagsIndex->{}
*)
(*CellTagsIndex
CellTagsIndex->{}
*)
(*NotebookFileOutline
Notebook[{
Cell[CellGroupData[{
Cell[580, 22, 161, 3, 87, "Section",ExpressionUUID->"0441e687-3271-491a-8955-dd8d0f7cb479"],
Cell[CellGroupData[{
Cell[766, 29, 209, 4, 51, "Input",ExpressionUUID->"e15a1c17-2cfb-46a2-8aa9-607b0a62e713"],
Cell[978, 35, 527, 7, 51, "Output",ExpressionUUID->"db0d487d-d6d9-443a-b19d-813d4dd80874"]
}, Open  ]],
Cell[CellGroupData[{
Cell[1542, 47, 341, 6, 51, "Input",ExpressionUUID->"9e588303-12c7-48e0-b8a5-8c3c446f4c9f"],
Cell[1886, 55, 758, 16, 159, "Print",ExpressionUUID->"7f6ffc92-cff1-4f6d-9aa9-16694e342dce"]
}, Open  ]],
Cell[CellGroupData[{
Cell[2681, 76, 161, 2, 51, "Input",ExpressionUUID->"ffda9edb-2059-4574-84d1-b1affec10b4c"],
Cell[2845, 80, 441, 10, 52, "Print",ExpressionUUID->"cd68d829-7544-48b8-8b9b-05c1e7922ee4"]
}, Open  ]],
Cell[CellGroupData[{
Cell[3323, 95, 1331, 32, 156, "Input",ExpressionUUID->"6e78fb49-dd55-4145-92f6-d81f0c875850"],
Cell[CellGroupData[{
Cell[4679, 131, 533, 9, 29, "Print",ExpressionUUID->"716ef0f6-eb1a-4a5f-8486-24a431120ac9"],
Cell[5215, 142, 533, 9, 29, "Print",ExpressionUUID->"765dbea9-a43c-47b5-bb45-605e57bb0e83"],
Cell[5751, 153, 533, 9, 29, "Print",ExpressionUUID->"1dacef96-4ec0-4bab-b9c1-7da9ef1dc06d"],
Cell[6287, 164, 544, 10, 29, "Print",ExpressionUUID->"1624f703-dd93-484a-afdd-1fee4808092f"],
Cell[6834, 176, 533, 9, 29, "Print",ExpressionUUID->"15a0a61a-9425-4178-b9b0-544cf0689340"],
Cell[7370, 187, 535, 9, 29, "Print",ExpressionUUID->"5abefb99-5ff0-4cc3-ad2b-fe03526d4f97"],
Cell[7908, 198, 538, 10, 29, "Print",ExpressionUUID->"ee6e238a-a356-4628-b093-70b21860e0d4"],
Cell[8449, 210, 534, 9, 29, "Print",ExpressionUUID->"3b64ed1d-f0a4-48df-9711-5671fb56b34a"],
Cell[8986, 221, 542, 10, 29, "Print",ExpressionUUID->"33792671-04a3-4814-94e4-7bcbd278dfc7"],
Cell[9531, 233, 542, 10, 29, "Print",ExpressionUUID->"f90d2636-417e-41b2-bd39-7c6a63142241"],
Cell[10076, 245, 544, 10, 29, "Print",ExpressionUUID->"ddd5c770-6cb5-45b0-9e1c-ee2607b2676a"],
Cell[10623, 257, 542, 10, 29, "Print",ExpressionUUID->"a897e7c6-7d83-4245-967e-911b7b328b17"],
Cell[11168, 269, 544, 10, 29, "Print",ExpressionUUID->"876774a5-3896-4af6-9e3d-204b28e78360"]
}, Open  ]]
}, Open  ]]
}, Closed]],
Cell[CellGroupData[{
Cell[11773, 286, 157, 3, 68, "Section",ExpressionUUID->"b2a7b427-35e1-4c90-a40a-a7c43f50ca5a"],
Cell[CellGroupData[{
Cell[11955, 293, 169, 3, 42, "Subsection",ExpressionUUID->"b7909353-edfe-4489-b115-b6a172af6d7d"],
Cell[12127, 298, 605, 17, 51, "Input",ExpressionUUID->"aae90991-5bc3-401d-87f3-7f8422f12676"],
Cell[12735, 317, 1582, 47, 234, "Input",ExpressionUUID->"b0fdc6fd-2a5b-4d84-97a3-03bddc4e6893"],
Cell[14320, 366, 700, 17, 104, "Input",ExpressionUUID->"277d5114-6840-4b27-9460-eac0f86cbc2c"],
Cell[15023, 385, 852, 21, 104, "Input",ExpressionUUID->"ff95a306-8b51-46ee-8bc6-3e57f67ea494"],
Cell[15878, 408, 573, 13, 78, "Input",ExpressionUUID->"a76cbf43-accd-494d-bf74-aaf9211a3950"],
Cell[16454, 423, 567, 17, 51, "Input",ExpressionUUID->"2787e42e-631b-4f49-a71c-b7b0e075493a"],
Cell[17024, 442, 1661, 50, 156, "Input",ExpressionUUID->"b4037ea5-93ff-4f7e-a16c-2ab7e7c858e0"],
Cell[18688, 494, 4831, 116, 182, "Input",ExpressionUUID->"6d280527-7a65-48d0-a19d-73ee85d09955"],
Cell[23522, 612, 4528, 135, 390, "Input",ExpressionUUID->"0e2780f7-f3c5-41e4-a82a-2661c1254c1e"],
Cell[28053, 749, 1173, 30, 104, "Input",ExpressionUUID->"c9dd0306-42c7-4192-b891-8337c9f7440c"],
Cell[29229, 781, 2351, 72, 182, "Input",ExpressionUUID->"766abd2e-1994-4be7-9ee6-2a6d0f82c59e"],
Cell[31583, 855, 1197, 35, 156, "Input",ExpressionUUID->"f32e72bc-d9f0-4994-aff5-11032f993f2a"]
}, Open  ]],
Cell[CellGroupData[{
Cell[32817, 895, 164, 3, 42, "Subsection",ExpressionUUID->"19c23075-0448-439e-b990-e9e57cef0c14"],
Cell[32984, 900, 7163, 196, 494, "Input",ExpressionUUID->"41d8c094-84c5-4ee9-aee4-8c40ac1ee5f3"],
Cell[40150, 1098, 1749, 52, 156, "Input",ExpressionUUID->"078d2120-47c9-45fd-a915-fc4e3e8e373e"],
Cell[41902, 1152, 4531, 124, 416, "Input",ExpressionUUID->"a61f9555-0be9-40b9-bdae-1cc5f6ebe29e"],
Cell[46436, 1278, 3427, 92, 312, "Input",ExpressionUUID->"5a749aec-1210-4ad6-84cd-506b5a9ebae9"],
Cell[49866, 1372, 2468, 71, 312, "Input",ExpressionUUID->"2ec6dc3b-1485-4a6a-943c-7859b690610e"],
Cell[52337, 1445, 1537, 43, 182, "Input",ExpressionUUID->"d9319593-268b-4300-9501-a5620af6c839"],
Cell[53877, 1490, 1310, 30, 104, "Input",ExpressionUUID->"c4708be7-ddac-4167-915b-d46842db745f"],
Cell[55190, 1522, 3076, 88, 435, "Input",ExpressionUUID->"da1678c0-82b0-4300-bfbc-d1f6eb039ac5"],
Cell[58269, 1612, 1227, 32, 104, "Input",ExpressionUUID->"bb9d1e39-1bb7-41c6-b251-dcebffea133c"],
Cell[59499, 1646, 611, 16, 78, "Input",ExpressionUUID->"8c7dc4b2-591e-4db4-b91a-1285414fe61d"],
Cell[60113, 1664, 2225, 56, 364, "Input",ExpressionUUID->"571ee68b-1968-468a-8457-68ec7313b97e"],
Cell[62341, 1722, 13005, 339, 728, "Input",ExpressionUUID->"f6470b2b-1430-493f-b954-d80193a6e8b3"],
Cell[75349, 2063, 3197, 86, 299, "Input",ExpressionUUID->"311cb0de-bc70-4e6d-8af5-84e5a3960e94"],
Cell[78549, 2151, 2898, 81, 273, "Input",ExpressionUUID->"9ba83756-e9e0-4b81-b452-76fe18ad8619"],
Cell[81450, 2234, 7457, 144, 351, "Input",ExpressionUUID->"acba7d38-218d-4ab3-8d17-064d5bb3ae6c"]
}, Open  ]],
Cell[CellGroupData[{
Cell[88944, 2383, 170, 3, 42, "Subsection",ExpressionUUID->"ca53f43b-0c6f-4f8f-9ad8-87cfea3279c2"],
Cell[89117, 2388, 2837, 86, 208, "Input",ExpressionUUID->"f8177a59-b548-4f5d-a062-3e46a97c4ed8"],
Cell[91957, 2476, 14237, 395, 1404, "Input",ExpressionUUID->"99fc1734-0a78-4f56-9085-9e1deef01c83"]
}, Closed]],
Cell[CellGroupData[{
Cell[106231, 2876, 173, 3, 41, "Subsection",ExpressionUUID->"a0b21b7b-22d9-43b7-b714-f04ca4b20753"],
Cell[106407, 2881, 2008, 55, 182, "Input",ExpressionUUID->"90a8135e-812a-4d57-9d3d-6bdd9005cd47"],
Cell[108418, 2938, 1341, 35, 182, "Input",ExpressionUUID->"cc21b2cf-79d9-4be8-990b-72e461cf7fe8"]
}, Open  ]]
}, Closed]],
Cell[CellGroupData[{
Cell[109808, 2979, 216, 4, 68, "Section",ExpressionUUID->"920e92b2-f483-4633-8572-95f7ad2029ee"],
Cell[110027, 2985, 6808, 195, 624, "Input",ExpressionUUID->"a59468cd-400d-4953-be9d-1224995358e2"],
Cell[116838, 3182, 1460, 32, 104, "Input",ExpressionUUID->"b391ede9-be00-4b65-b0fd-aa1f912d39f2"],
Cell[118301, 3216, 1266, 37, 156, "Input",ExpressionUUID->"55f9f031-ef59-4843-b717-d41b3d5f725a"],
Cell[119570, 3255, 2943, 67, 234, "Input",ExpressionUUID->"c5bb3695-411a-4d6d-9a74-02514b7878ff"],
Cell[122516, 3324, 1165, 32, 194, "Input",ExpressionUUID->"7e5a8741-43ac-4327-aa5f-6dbd2093223d"],
Cell[123684, 3358, 4895, 132, 461, "Input",ExpressionUUID->"38b08510-db19-43f8-a58a-03d08123cfc5"],
Cell[128582, 3492, 2991, 76, 278, "Input",ExpressionUUID->"9e85ef89-ef79-46cb-be32-c43025585f9e"],
Cell[131576, 3570, 3251, 84, 274, "Input",ExpressionUUID->"850f9e74-d60e-480a-93ae-c2c236ab84b9"],
Cell[134830, 3656, 635, 15, 104, "Input",ExpressionUUID->"700a3f7d-cd49-466f-90de-2c822c5c055a"],
Cell[135468, 3673, 1845, 47, 208, "Input",ExpressionUUID->"cb6c5ca4-66d2-4b20-8e3f-ccc5d0908177"],
Cell[137316, 3722, 631, 15, 104, "Input",ExpressionUUID->"e6c49810-516a-46b3-91d2-9f6cc77989d2"],
Cell[137950, 3739, 1905, 49, 208, "Input",ExpressionUUID->"acf5035f-ca44-45ac-b48d-85cb79e62689"],
Cell[139858, 3790, 2650, 64, 208, "Input",ExpressionUUID->"f096a91e-a14a-422f-9dad-273215327dad"],
Cell[142511, 3856, 5954, 170, 390, "Input",ExpressionUUID->"26efa189-4ecc-4695-99da-a77c9b57d98f"]
}, Closed]],
Cell[CellGroupData[{
Cell[148502, 4031, 166, 3, 68, "Section",ExpressionUUID->"2facbcdd-6529-421e-b087-7362503df697"],
Cell[148671, 4036, 329, 7, 51, "Input",ExpressionUUID->"1ed94398-ee3d-4f3a-bf90-559c2258774b"],
Cell[149003, 4045, 7678, 217, 442, "Input",ExpressionUUID->"addf7f2a-cd5d-49f7-8f50-dd1ab1616ed6"],
Cell[156684, 4264, 4016, 115, 208, "Input",ExpressionUUID->"093ebe73-7fa6-421a-a7cb-b6566c057327"]
}, Closed]],
Cell[CellGroupData[{
Cell[160737, 4384, 261, 4, 68, "Section",ExpressionUUID->"604156b9-0508-4c7d-9a7a-b99be3f8fadc"],
Cell[CellGroupData[{
Cell[161023, 4392, 160, 3, 42, "Subsection",ExpressionUUID->"1f37adfe-a673-4b37-93f5-fd1884b57adf"],
Cell[CellGroupData[{
Cell[161208, 4399, 988, 27, 104, "Input",ExpressionUUID->"8e07d938-6c93-4c35-b475-53b3cf5a05b4"],
Cell[162199, 4428, 675, 19, 70, "Output",ExpressionUUID->"c431ecfe-7209-47bd-b17f-733172109f69"]
}, Open  ]],
Cell[162889, 4450, 1218, 25, 130, "Input",ExpressionUUID->"a92b9c8e-51f8-407e-8224-ece3eaae9f04"],
Cell[164110, 4477, 2815, 78, 211, "Input",ExpressionUUID->"2eb92c90-3759-413d-bc7f-1a09bf3e2c53"],
Cell[CellGroupData[{
Cell[166950, 4559, 686, 20, 78, "Input",ExpressionUUID->"74abc309-0cb3-4d4b-9a63-a72a96bc37ec"],
Cell[167639, 4581, 297, 5, 70, "Output",ExpressionUUID->"41381c4a-1cdd-4484-9172-75ff72bd4568"]
}, Open  ]]
}, Closed]],
Cell[CellGroupData[{
Cell[167985, 4592, 172, 3, 41, "Subsection",ExpressionUUID->"a99cbca3-c478-412c-a3d7-706d91371810"],
Cell[168160, 4597, 871, 21, 51, "Input",ExpressionUUID->"2f3f69f3-5124-4b81-9552-2cb53ab12d1e"],
Cell[CellGroupData[{
Cell[169056, 4622, 3472, 104, 286, "Input",ExpressionUUID->"f3ddb63b-7d8f-4997-9389-f334fbed6258"],
Cell[172531, 4728, 902, 20, 70, "Output",ExpressionUUID->"19e5a4fd-f352-41f5-b548-d54d4ac7bfdb"]
}, Open  ]],
Cell[173448, 4751, 4131, 128, 336, "Input",ExpressionUUID->"4ba38add-1e90-4973-a0eb-a9f5230a3a29"],
Cell[177582, 4881, 2086, 54, 156, "Input",ExpressionUUID->"50109fa6-4aef-4b99-98a7-c5ed1149348c"],
Cell[179671, 4937, 226, 7, 51, "Input",ExpressionUUID->"d6b198be-e867-4bbb-b3d5-34b139716bfc"],
Cell[CellGroupData[{
Cell[179922, 4948, 244, 5, 51, "Input",ExpressionUUID->"cb22c795-a365-4f26-a2e3-e6ef2eb88c94"],
Cell[180169, 4955, 4092, 114, 70, "Output",ExpressionUUID->"05f8fdf2-1520-4722-956e-35e8fad20f4e"]
}, Open  ]],
Cell[CellGroupData[{
Cell[184298, 5074, 185, 4, 51, "Input",ExpressionUUID->"61e32d22-3e04-4e8a-b0e1-dc5ba8c54a93"],
Cell[184486, 5080, 5308, 148, 70, "Output",ExpressionUUID->"c9b70461-3e4a-41fb-b0d0-80871ccb4d6d"]
}, Open  ]],
Cell[189809, 5231, 523, 14, 51, "Input",ExpressionUUID->"9193ff38-c4f5-4984-9621-f6856f883032"],
Cell[CellGroupData[{
Cell[190357, 5249, 208, 4, 51, "Input",ExpressionUUID->"39adadc5-5e48-4120-8f60-48c236838f1e"],
Cell[190568, 5255, 433, 7, 70, "Output",ExpressionUUID->"6c62b545-2cbb-415c-bed2-e1584ea2f12b"]
}, Open  ]],
Cell[CellGroupData[{
Cell[191038, 5267, 1457, 42, 130, "Input",ExpressionUUID->"fddf6110-1455-45a2-bf6f-04258e5c7966"],
Cell[192498, 5311, 644, 13, 70, "Message",ExpressionUUID->"16dbee5b-926e-4dd3-8570-5a07a8c58f47"]
}, Open  ]]
}, Closed]],
Cell[CellGroupData[{
Cell[193191, 5330, 226, 4, 41, "Subsection",ExpressionUUID->"59008d8c-f1bc-4395-90d7-7585486b8a07"],
Cell[CellGroupData[{
Cell[193442, 5338, 1002, 24, 78, "Input",ExpressionUUID->"dc0dd67c-3dde-4e59-b697-febe97da0a1a"],
Cell[194447, 5364, 436, 7, 70, "Output",ExpressionUUID->"93c605f5-1b1a-4de3-af69-69d9d54a521a"]
}, Open  ]],
Cell[194898, 5374, 2016, 55, 130, "Input",ExpressionUUID->"dd10c95d-9715-47e2-bb63-16e790130cca"],
Cell[CellGroupData[{
Cell[196939, 5433, 215, 4, 51, "Input",ExpressionUUID->"41dc9814-153d-4905-baad-0973404bfe2d"],
Cell[197157, 5439, 276, 5, 70, "Output",ExpressionUUID->"64e5025d-74a6-4a13-9e05-450efacdc0a7"]
}, Open  ]],
Cell[197448, 5447, 4915, 133, 362, "Input",ExpressionUUID->"ca9ad445-a783-4399-bc8f-cb27decc7264"],
Cell[202366, 5582, 409, 8, 51, "Input",ExpressionUUID->"4c9c479b-3f9e-47b7-87cc-4f2aaffc75ff"],
Cell[CellGroupData[{
Cell[202800, 5594, 987, 24, 51, "Input",ExpressionUUID->"7b804a7e-9ab9-4bf6-9230-5156345eb783"],
Cell[203790, 5620, 1014, 25, 70, "Output",ExpressionUUID->"ebf98b12-7aee-446a-b794-0eaad2812c7b"]
}, Open  ]],
Cell[CellGroupData[{
Cell[204841, 5650, 214, 4, 51, "Input",ExpressionUUID->"062d9e59-9330-4ae3-a27e-eaeb0141a898"],
Cell[205058, 5656, 5223, 147, 70, "Output",ExpressionUUID->"fd2a22fe-18cf-456e-b592-2758860c6ce1"]
}, Open  ]],
Cell[210296, 5806, 539, 15, 78, "Input",ExpressionUUID->"0bebda31-7cb7-4bff-9b51-527173edc4e6"],
Cell[CellGroupData[{
Cell[210860, 5825, 284, 5, 51, "Input",ExpressionUUID->"2d742d42-c9ab-44d1-a0ff-2066ee294ede"],
Cell[211147, 5832, 566, 9, 70, "Output",ExpressionUUID->"741eae5f-63e2-4bfd-a6ce-d58935604be5"]
}, Open  ]],
Cell[CellGroupData[{
Cell[211750, 5846, 1276, 38, 104, "Input",ExpressionUUID->"b8fa77cc-1b35-4922-9129-b08f865e4e9e"],
Cell[213029, 5886, 805, 15, 70, "Message",ExpressionUUID->"d7a672e6-587f-4dff-8d93-f8c82dee6682"]
}, Open  ]],
Cell[CellGroupData[{
Cell[213871, 5906, 116, 2, 51, "Input",ExpressionUUID->"c8e08eb4-3b1b-41d6-9bea-cd47cdf8746d"],
Cell[213990, 5910, 10873, 331, 70, "Output",ExpressionUUID->"4638601d-5ba1-44af-98b7-32c8d3d7ad60"]
}, Open  ]]
}, Open  ]],
Cell[CellGroupData[{
Cell[224912, 6247, 227, 4, 42, "Subsection",ExpressionUUID->"0dc6dbc1-eeb3-4f11-b2bc-668fae0eba77"],
Cell[CellGroupData[{
Cell[225164, 6255, 1072, 25, 78, "Input",ExpressionUUID->"30f56ef6-5b13-4baa-b8bf-15b7090ac3f7"],
Cell[226239, 6282, 463, 7, 70, "Output",ExpressionUUID->"bbe98b85-dbc8-4c03-901e-1356d250b7d2"]
}, Open  ]],
Cell[226717, 6292, 2112, 56, 130, "Input",ExpressionUUID->"7e4c037d-b2c8-4b94-a37c-c87c5346d37a"],
Cell[CellGroupData[{
Cell[228854, 6352, 215, 4, 51, "Input",ExpressionUUID->"59f786bb-5094-42ab-b9d0-362b1e405323"],
Cell[229072, 6358, 296, 5, 70, "Output",ExpressionUUID->"932efddf-6219-48d2-b4a4-20428196c417"]
}, Open  ]],
Cell[229383, 6366, 5037, 135, 362, "Input",ExpressionUUID->"015a8192-0e34-496c-b9e8-94d006b23504"],
Cell[234423, 6503, 409, 8, 51, "Input",ExpressionUUID->"a6114a56-cddf-4bbf-96d0-7d324e0ac67b"],
Cell[CellGroupData[{
Cell[234857, 6515, 987, 24, 51, "Input",ExpressionUUID->"7563fbcc-606e-49f5-ba0e-0582f8aa8a63"],
Cell[235847, 6541, 1018, 25, 70, "Output",ExpressionUUID->"8c2c2f8c-08bb-494e-9b2c-3fbbacd9dd59"]
}, Open  ]],
Cell[CellGroupData[{
Cell[236902, 6571, 214, 4, 51, "Input",ExpressionUUID->"08cbae83-330d-4c78-afa6-d9025cba7d1c"],
Cell[237119, 6577, 5244, 147, 70, "Output",ExpressionUUID->"ab057531-d2cc-4d40-9174-dbfaeddad6e7"]
}, Open  ]],
Cell[242378, 6727, 539, 15, 78, "Input",ExpressionUUID->"3660df7e-5e63-4b2d-a97d-18687b7e7e55"],
Cell[CellGroupData[{
Cell[242942, 6746, 284, 5, 51, "Input",ExpressionUUID->"fa8ba1fd-a186-49cc-9bf9-aa75c0ff688a"],
Cell[243229, 6753, 591, 10, 70, "Output",ExpressionUUID->"831de0d1-dda7-4ca1-86c6-0c4c057b8e28"]
}, Open  ]],
Cell[CellGroupData[{
Cell[243857, 6768, 1325, 39, 104, "Input",ExpressionUUID->"05540f17-9558-47af-a39a-04f87039a3ef"],
Cell[245185, 6809, 832, 16, 70, "Message",ExpressionUUID->"02857257-587c-4da7-9173-24f0c2559178"]
}, Open  ]],
Cell[CellGroupData[{
Cell[246054, 6830, 116, 2, 51, "Input",ExpressionUUID->"d5ee2776-4386-4864-a97b-c3438dc9d059"],
Cell[246173, 6834, 5046, 158, 70, "Output",ExpressionUUID->"e7fd10af-8630-4f13-bb61-fac1e512946e"]
}, Open  ]]
}, Open  ]],
Cell[CellGroupData[{
Cell[251268, 6998, 275, 4, 42, "Subsection",ExpressionUUID->"13628a4d-25c7-44e5-9dd8-790fd349801b"],
Cell[CellGroupData[{
Cell[251568, 7006, 1174, 26, 78, "Input",ExpressionUUID->"03460e8f-7d6e-4d1f-a8f9-dbc21d11e43f"],
Cell[252745, 7034, 485, 8, 70, "Output",ExpressionUUID->"0036c7b2-b7af-4d05-a2ba-4391c1fde01d"]
}, Open  ]],
Cell[253245, 7045, 2186, 57, 130, "Input",ExpressionUUID->"fde1bdc7-1d3b-4353-b9ad-7ae5dd60398a"],
Cell[255434, 7104, 5302, 140, 362, "Input",ExpressionUUID->"7e25f5e8-947e-4019-bee6-69b028ad1707"],
Cell[260739, 7246, 409, 8, 51, "Input",ExpressionUUID->"852c1b9c-61ce-4cbd-b3ae-6cd8d1457d71"],
Cell[CellGroupData[{
Cell[261173, 7258, 415, 11, 51, "Input",ExpressionUUID->"47ef6b8b-d114-4491-bb3e-09a9342ebb8f"],
Cell[261591, 7271, 373, 6, 70, "Output",ExpressionUUID->"d9b96e01-8c7e-45bb-8158-e8828cbf645c"]
}, Open  ]],
Cell[261979, 7280, 539, 15, 78, "Input",ExpressionUUID->"269e8e9f-94be-45a7-95c8-e950994ff4c7"],
Cell[CellGroupData[{
Cell[262543, 7299, 284, 5, 51, "Input",ExpressionUUID->"1eff3f89-c5c1-4c61-9f1f-4ce2abd924ea"],
Cell[262830, 7306, 612, 10, 70, "Output",ExpressionUUID->"b64ea886-8d9a-4baf-a06b-8eec44dfc0dc"]
}, Open  ]],
Cell[263457, 7319, 1325, 39, 104, "Input",ExpressionUUID->"ff21824b-8ef3-4cd6-9556-da46ed6b1cca"],
Cell[CellGroupData[{
Cell[264807, 7362, 184, 3, 51, "Input",ExpressionUUID->"43a0151e-8ebd-4243-a5e4-1ed70ee22f2f"],
Cell[264994, 7367, 456, 11, 70, "Output",ExpressionUUID->"8786b034-1551-4e44-b4f7-af6a9c39e49a"]
}, Open  ]]
}, Open  ]],
Cell[CellGroupData[{
Cell[265499, 7384, 160, 3, 42, "Subsection",ExpressionUUID->"53d2eeec-1112-4cce-b7d4-5104623dfb30"],
Cell[CellGroupData[{
Cell[265684, 7391, 539, 15, 78, "Input",ExpressionUUID->"41b68abb-e62d-4676-bed1-4a7b029d8a85"],
Cell[266226, 7408, 22208, 683, 70, "Output",ExpressionUUID->"7775e966-bcf1-4da7-b327-d37aa31a3c38"]
}, Open  ]],
Cell[CellGroupData[{
Cell[288471, 8096, 613, 18, 78, "Input",ExpressionUUID->"b1392e9f-0802-4547-8291-d9d836b6a531"],
Cell[289087, 8116, 255, 5, 70, "Output",ExpressionUUID->"1d164981-b2bc-44d5-ab2a-e7ca67d32dd5"]
}, Open  ]],
Cell[CellGroupData[{
Cell[289379, 8126, 479, 14, 51, "Input",ExpressionUUID->"8e1a2554-41a4-4f32-a8dc-9e90074da6ee"],
Cell[289861, 8142, 17817, 508, 70, "Output",ExpressionUUID->"1265f1b1-8f2b-409e-9a8e-f20511a32363"]
}, Open  ]]
}, Open  ]]
}, Closed]],
Cell[CellGroupData[{
Cell[307739, 8657, 326, 5, 68, "Section",ExpressionUUID->"59b54bc3-97df-45d6-bc28-81e428b29101"],
Cell[CellGroupData[{
Cell[308090, 8666, 160, 3, 42, "Subsection",ExpressionUUID->"46d3ea8b-05f7-4416-b0bc-fd29a7778142"],
Cell[CellGroupData[{
Cell[308275, 8673, 988, 27, 104, "Input",ExpressionUUID->"63883844-e4d0-4419-995f-f86af78cb92b"],
Cell[309266, 8702, 727, 20, 70, "Output",ExpressionUUID->"b2044462-eb78-4775-8fe6-f1e89678524b"]
}, Open  ]],
Cell[310008, 8725, 1218, 25, 130, "Input",ExpressionUUID->"76d539e4-604c-4249-bad1-2503c5290e11"],
Cell[311229, 8752, 1094, 35, 78, "Input",ExpressionUUID->"d762502d-750c-4a1a-a501-5e02e614f8af"],
Cell[312326, 8789, 2815, 78, 211, "Input",ExpressionUUID->"b85bd2bb-430b-432d-85db-d49e5ba6ae04"]
}, Open  ]],
Cell[CellGroupData[{
Cell[315178, 8872, 172, 3, 42, "Subsection",ExpressionUUID->"27e8c3a2-ef85-4301-a1da-32f85207ffba"],
Cell[315353, 8877, 921, 22, 51, "Input",ExpressionUUID->"585e517d-3efd-42fb-8d2b-6ff81dcee3a7"],
Cell[CellGroupData[{
Cell[316299, 8903, 3472, 104, 286, "Input",ExpressionUUID->"64955980-6552-4fbe-8bd8-2006ec4384c6"],
Cell[319774, 9009, 976, 21, 70, "Output",ExpressionUUID->"31e54817-1461-4469-a12f-f747a15c4464"]
}, Open  ]],
Cell[320765, 9033, 4131, 128, 336, "Input",ExpressionUUID->"73d361bc-fb21-4cc6-b858-1081cb7d7c28"],
Cell[324899, 9163, 2086, 54, 156, "Input",ExpressionUUID->"f0029f32-d8bd-46d4-b155-35b3b8e77226"],
Cell[326988, 9219, 226, 7, 51, "Input",ExpressionUUID->"fa9a6a87-0b37-407a-9714-0c09c4d26928"],
Cell[327217, 9228, 523, 14, 51, "Input",ExpressionUUID->"2f8618e3-2ecf-46ed-86be-a8da3f993eb9"],
Cell[CellGroupData[{
Cell[327765, 9246, 208, 4, 51, "Input",ExpressionUUID->"80c636eb-b91d-4e62-8904-ae38cfaf70be"],
Cell[327976, 9252, 501, 8, 70, "Output",ExpressionUUID->"02783e32-57b8-443b-a63a-98fb7dedd2e6"]
}, Open  ]],
Cell[CellGroupData[{
Cell[328514, 9265, 1457, 42, 130, "Input",ExpressionUUID->"cd0f0334-06ee-4f03-ad4a-dccea1959155"],
Cell[329974, 9309, 711, 14, 70, "Message",ExpressionUUID->"6d6b122b-b8ad-437d-8497-2f902cf47f4f"]
}, Open  ]]
}, Closed]],
Cell[CellGroupData[{
Cell[330734, 9329, 226, 4, 41, "Subsection",ExpressionUUID->"e55fa114-6f3f-4e57-9042-2adbdd39a286"],
Cell[CellGroupData[{
Cell[330985, 9337, 1028, 25, 78, "Input",ExpressionUUID->"e81780ce-5cdc-4297-b96c-d10168de938e"],
Cell[332016, 9364, 527, 8, 70, "Output",ExpressionUUID->"469d8760-3fc8-4437-8b57-83e3d78d9965"]
}, Open  ]],
Cell[332558, 9375, 2016, 55, 130, "Input",ExpressionUUID->"a2717930-937a-4c21-aa88-03ba76c7d98d"],
Cell[CellGroupData[{
Cell[334599, 9434, 215, 4, 51, "Input",ExpressionUUID->"d6d6b0b1-34aa-474e-b397-fdc6b3f8d865"],
Cell[334817, 9440, 364, 6, 70, "Output",ExpressionUUID->"29eded26-abc0-45e4-9bc2-f30ae9c0152e"]
}, Open  ]],
Cell[335196, 9449, 4909, 133, 341, "Input",ExpressionUUID->"ad67a268-49c9-4fc2-a2e7-1202cf0c7c53"],
Cell[340108, 9584, 409, 8, 51, "Input",ExpressionUUID->"72f44ea0-a346-4471-b32e-dfefbb0d6428"],
Cell[CellGroupData[{
Cell[340542, 9596, 987, 24, 51, "Input",ExpressionUUID->"815cf49c-0a7b-4689-98f1-ef3527fcb2f8"],
Cell[341532, 9622, 1036, 25, 70, "Output",ExpressionUUID->"c5e1a02d-f1ff-4bba-a7c6-8f46a84c2bcf"]
}, Open  ]],
Cell[CellGroupData[{
Cell[342605, 9652, 214, 4, 51, "Input",ExpressionUUID->"a0181419-1fa1-46e1-92f1-89bc97129c7a"],
Cell[342822, 9658, 2853, 79, 70, "Output",ExpressionUUID->"ab4e7aef-0ed0-4600-afc8-cdd6ac0cd157"]
}, Open  ]],
Cell[345690, 9740, 539, 15, 78, "Input",ExpressionUUID->"1e88fb7c-d5f5-4931-a279-7e05550291fd"],
Cell[CellGroupData[{
Cell[346254, 9759, 284, 5, 51, "Input",ExpressionUUID->"a79df089-ed2d-4ded-a266-1b17d479c9a2"],
Cell[346541, 9766, 666, 11, 70, "Output",ExpressionUUID->"a5da0062-447b-4144-a442-48f76cf4b6c1"]
}, Open  ]],
Cell[CellGroupData[{
Cell[347244, 9782, 1276, 38, 104, "Input",ExpressionUUID->"1f712311-4975-4ed6-a7d3-09ae1c6a31d7"],
Cell[348523, 9822, 906, 16, 70, "Message",ExpressionUUID->"3ae39d67-c7d1-46eb-b755-f0e604991e98"]
}, Open  ]]
}, Closed]],
Cell[CellGroupData[{
Cell[349478, 9844, 227, 4, 41, "Subsection",ExpressionUUID->"093da948-de7f-454f-8d79-9cf7d35422c3"],
Cell[CellGroupData[{
Cell[349730, 9852, 1072, 25, 78, "Input",ExpressionUUID->"6a1ca1dd-0cf5-4aa0-9478-36bb48adb0e4"],
Cell[350805, 9879, 590, 12, 70, "Message",ExpressionUUID->"1fb5bc26-105e-4f13-8488-db9dfd69846c"],
Cell[351398, 9893, 530, 8, 70, "Output",ExpressionUUID->"6b9c4b87-312b-40b1-83ab-792f319a4e51"]
}, Open  ]],
Cell[351943, 9904, 2112, 56, 130, "Input",ExpressionUUID->"dd475017-77a1-49c6-b689-cb657cf98d66"],
Cell[CellGroupData[{
Cell[354080, 9964, 215, 4, 51, "Input",ExpressionUUID->"9593486d-7e53-4ab1-9a84-acce95ba243f"],
Cell[354298, 9970, 367, 6, 70, "Output",ExpressionUUID->"f3c9a1b2-3b47-4c8f-bad9-0f431de1abaf"]
}, Open  ]],
Cell[354680, 9979, 5005, 134, 341, "Input",ExpressionUUID->"2b829d84-3c43-404b-ac21-445a8f6759c1"],
Cell[359688, 10115, 409, 8, 51, "Input",ExpressionUUID->"341b9159-8e46-48e9-83cc-e872910e762c"],
Cell[CellGroupData[{
Cell[360122, 10127, 987, 24, 51, "Input",ExpressionUUID->"f0dacc84-a419-4e44-8cfa-8a2f7fcc98c7"],
Cell[361112, 10153, 1037, 25, 70, "Output",ExpressionUUID->"63a995bd-707b-44f1-b245-4913f0c26360"]
}, Open  ]],
Cell[CellGroupData[{
Cell[362186, 10183, 214, 4, 51, "Input",ExpressionUUID->"4180baca-9159-435e-9c2b-6677e160589e"],
Cell[362403, 10189, 2872, 79, 70, "Output",ExpressionUUID->"64ee6e8c-c220-4e47-b33c-04d7881f51df"]
}, Open  ]],
Cell[365290, 10271, 539, 15, 78, "Input",ExpressionUUID->"de73dfa1-ae0b-4862-a7ac-49bb0c00b87e"],
Cell[CellGroupData[{
Cell[365854, 10290, 284, 5, 51, "Input",ExpressionUUID->"bda0c3b7-0b8c-47f3-a81a-619774f37614"],
Cell[366141, 10297, 664, 11, 70, "Output",ExpressionUUID->"c9b912fa-1019-4d0e-bb2a-a825eefc9ecb"]
}, Open  ]],
Cell[CellGroupData[{
Cell[366842, 10313, 1325, 39, 104, "Input",ExpressionUUID->"8b94d3f8-f020-428b-9825-ea39ae125616"],
Cell[368170, 10354, 442, 10, 70, "Message",ExpressionUUID->"2a60b4ff-df2c-452d-8a97-24ba6e0be1e0"]
}, Open  ]],
Cell[CellGroupData[{
Cell[368649, 10369, 116, 2, 51, "Input",ExpressionUUID->"5bdfdf31-0c8e-40be-ac02-abcbec459edb"],
Cell[368768, 10373, 358, 8, 70, "Output",ExpressionUUID->"63cb5054-f716-43e9-8d5a-219236a82737"]
}, Open  ]]
}, Closed]],
Cell[CellGroupData[{
Cell[369175, 10387, 275, 4, 41, "Subsection",ExpressionUUID->"83c61381-cf0f-42d4-9208-7077932484a5"],
Cell[CellGroupData[{
Cell[369475, 10395, 1174, 26, 78, "Input",ExpressionUUID->"9f254a5e-e840-46a3-8ea6-624833a130d2"],
Cell[370652, 10423, 588, 12, 70, "Message",ExpressionUUID->"7fa0d170-7fb9-49b9-bb8e-590dbe538887"],
Cell[371243, 10437, 552, 9, 70, "Output",ExpressionUUID->"4e39cfb3-ff31-4490-b56d-ab3ef233cd71"]
}, Open  ]],
Cell[371810, 10449, 2186, 57, 130, "Input",ExpressionUUID->"cf70a313-2714-4caa-b2a7-be91a17d9612"],
Cell[373999, 10508, 5302, 140, 362, "Input",ExpressionUUID->"2944e463-041a-4acb-b4e9-cb5e2bc0dad0"],
Cell[379304, 10650, 409, 8, 51, "Input",ExpressionUUID->"ceb566d5-292a-4b84-806d-0202035da45c"],
Cell[CellGroupData[{
Cell[379738, 10662, 415, 11, 51, "Input",ExpressionUUID->"4e582181-64d9-48f1-8e0b-68bb2f74a942"],
Cell[380156, 10675, 16368, 493, 70, "Output",ExpressionUUID->"dbb4ea29-902c-4dcf-9a7e-9ea72c34d02f"]
}, Open  ]],
Cell[396539, 11171, 539, 15, 78, "Input",ExpressionUUID->"578da957-5282-4fd5-9530-ac3721c0f902"],
Cell[CellGroupData[{
Cell[397103, 11190, 284, 5, 51, "Input",ExpressionUUID->"55a88c8e-c935-44b1-abdc-81867df14125"],
Cell[397390, 11197, 633, 10, 70, "Output",ExpressionUUID->"b6bdaf39-4570-4fe2-85ee-60e6c3c98d7a"]
}, Open  ]],
Cell[398038, 11210, 1325, 39, 104, "Input",ExpressionUUID->"55ed02f0-5029-4486-8aa9-90f743334a2d"],
Cell[CellGroupData[{
Cell[399388, 11253, 184, 3, 51, "Input",ExpressionUUID->"530c074c-4a1f-4e4c-b6fb-3525f3d0619d"],
Cell[399575, 11258, 528, 12, 70, "Output",ExpressionUUID->"cd2cd212-3293-4555-ba1b-7d4854487e3f"]
}, Open  ]]
}, Closed]],
Cell[CellGroupData[{
Cell[400152, 11276, 160, 3, 41, "Subsection",ExpressionUUID->"90bcefed-5dc3-4e0f-aad2-1b12a6b9f00c"],
Cell[CellGroupData[{
Cell[400337, 11283, 479, 14, 51, "Input",ExpressionUUID->"60fe8754-c35b-431a-a109-481025a83ebd"],
Cell[400819, 11299, 590, 12, 70, "Message",ExpressionUUID->"2fee735f-6b62-4a73-a1d4-a9613e811482"],
Cell[401412, 11313, 591, 12, 70, "Message",ExpressionUUID->"a36ae5f0-2665-41a4-b7a7-b7bf511dac5a"],
Cell[402006, 11327, 591, 12, 70, "Message",ExpressionUUID->"150b6577-c645-4ed1-9dec-fc214c3c883e"],
Cell[402600, 11341, 481, 10, 70, "Message",ExpressionUUID->"464ad036-7647-418b-8834-ebbb692ff577"],
Cell[403084, 11353, 14667, 392, 70, "Output",ExpressionUUID->"ac20be38-42af-4afb-8517-ca0aea61561c"]
}, Open  ]],
Cell[CellGroupData[{
Cell[417788, 11750, 204, 4, 51, "Input",ExpressionUUID->"11e0c9cc-4ab9-4885-9725-e46ef5282ed9"],
Cell[417995, 11756, 227, 4, 70, "Output",ExpressionUUID->"dad81f92-3bef-4b43-97f9-e0f57c605a24"]
}, Open  ]]
}, Open  ]]
}, Closed]],
Cell[CellGroupData[{
Cell[418283, 11767, 380, 6, 68, "Section",ExpressionUUID->"69a8eb9f-9bdc-4fc6-90ff-d825789bcb7c"],
Cell[CellGroupData[{
Cell[418688, 11777, 160, 3, 42, "Subsection",ExpressionUUID->"87c7d773-b634-4c06-8e11-d3348430a623"],
Cell[CellGroupData[{
Cell[418873, 11784, 988, 27, 104, "Input",ExpressionUUID->"ab3b459b-5e90-48ea-bb16-27ca136e9a2f"],
Cell[419864, 11813, 703, 20, 51, "Output",ExpressionUUID->"a53cabae-af19-4fc2-a083-250ad05bf644"]
}, Open  ]],
Cell[420582, 11836, 1218, 25, 130, "Input",ExpressionUUID->"10268b10-7e12-4f67-ac7e-7834e7d8622f"],
Cell[421803, 11863, 1094, 35, 78, "Input",ExpressionUUID->"dd6a16d8-db77-40b7-b9a5-a68054310c77"],
Cell[422900, 11900, 545, 16, 51, "Input",ExpressionUUID->"7273cea8-b47a-42ac-aa64-34bbea20dab4"],
Cell[CellGroupData[{
Cell[423470, 11920, 205, 4, 51, "Input",ExpressionUUID->"11885de8-753d-48de-bb3e-7a6788a2e370"],
Cell[423678, 11926, 228, 4, 51, "Output",ExpressionUUID->"5f304db4-af8d-40b0-8cab-a67b33962944"]
}, Open  ]],
Cell[423921, 11933, 2815, 78, 211, "Input",ExpressionUUID->"331966e1-7937-4f79-bdf9-84739b0401fc"],
Cell[426739, 12013, 428, 12, 51, "Input",ExpressionUUID->"7db4d02a-5d09-45ac-9d45-e0f0ebe8f8c4"],
Cell[CellGroupData[{
Cell[427192, 12029, 208, 4, 51, "Input",ExpressionUUID->"325078f6-200c-4d93-bfbc-13425e865026"],
Cell[427403, 12035, 229, 4, 51, "Output",ExpressionUUID->"f2a63605-f199-4b7c-b911-1bfb408a5c43"]
}, Open  ]],
Cell[CellGroupData[{
Cell[427669, 12044, 2859, 86, 286, "Input",ExpressionUUID->"b1fbd84f-0433-4910-80e2-5ad8d6dbbddf"],
Cell[430531, 12132, 509, 12, 35, "Message",ExpressionUUID->"4d8fa7bc-bd98-4c7a-af92-809be392dc01"]
}, Open  ]],
Cell[CellGroupData[{
Cell[431077, 12149, 287, 6, 51, "Input",ExpressionUUID->"e0810539-063e-4fe3-ac9c-9f1bcde2d45c"],
Cell[431367, 12157, 3169, 95, 173, "Output",ExpressionUUID->"ae7b2e29-90f7-407b-a64a-859b8c425af2"]
}, Open  ]],
Cell[CellGroupData[{
Cell[434573, 12257, 324, 8, 51, "Input",ExpressionUUID->"93bd6c08-6f70-4322-a32c-8e633e25114d"],
Cell[434900, 12267, 2465, 72, 152, "Output",ExpressionUUID->"816e2604-7066-491e-9886-a68d0ecdfdd6"]
}, Open  ]],
Cell[437380, 12342, 1426, 43, 182, "Input",ExpressionUUID->"64a868eb-e2d4-4e94-82e1-1bde57c0837c"],
Cell[CellGroupData[{
Cell[438831, 12389, 209, 4, 51, "Input",ExpressionUUID->"20be0346-15d6-48da-b01c-8b29af978d5d"],
Cell[439043, 12395, 202, 4, 51, "Output",ExpressionUUID->"2a5ba20b-f3f4-4a7c-86bd-d3e1e0686b42"]
}, Open  ]],
Cell[CellGroupData[{
Cell[439282, 12404, 212, 4, 51, "Input",ExpressionUUID->"380a5a51-bf8b-47e0-a5fe-fd158c775d2b"],
Cell[439497, 12410, 206, 4, 51, "Output",ExpressionUUID->"ab588dc2-773f-4ac5-91fc-58f166632cde"]
}, Open  ]],
Cell[439718, 12417, 465, 13, 78, "Input",ExpressionUUID->"d82dd100-bacf-4021-8f4d-a291f2a6fe47"]
}, Open  ]],
Cell[CellGroupData[{
Cell[440220, 12435, 172, 3, 42, "Subsection",ExpressionUUID->"718be8c1-6ad8-4039-8b3e-3fd03b15fa11"],
Cell[440395, 12440, 897, 22, 51, "Input",ExpressionUUID->"4012c174-e483-4432-b176-bce09d101456"],
Cell[CellGroupData[{
Cell[441317, 12466, 3472, 104, 286, "Input",ExpressionUUID->"bf3f4366-0313-4b02-89ff-01738506712d"],
Cell[444792, 12572, 954, 21, 51, "Output",ExpressionUUID->"cf32c65a-0be9-4821-86a2-ec5853871b85"]
}, Open  ]],
Cell[445761, 12596, 4131, 128, 336, "Input",ExpressionUUID->"dbd45628-aed1-4c61-837a-c31fb11c0eb8"],
Cell[449895, 12726, 2086, 54, 156, "Input",ExpressionUUID->"56d665ab-7daf-4738-8cd3-8c9668245f3a"],
Cell[451984, 12782, 226, 7, 51, "Input",ExpressionUUID->"61339348-3ff7-4021-aec5-bcd88ec61e4f"],
Cell[452213, 12791, 523, 14, 51, "Input",ExpressionUUID->"db91009e-5f25-458b-9204-da34e407ea01"],
Cell[CellGroupData[{
Cell[452761, 12809, 208, 4, 51, "Input",ExpressionUUID->"4a26b15b-0fec-4d84-8631-679e3b200441"],
Cell[452972, 12815, 482, 8, 51, "Output",ExpressionUUID->"41637d3f-e1ce-4be2-a4a4-c5808684050b"]
}, Open  ]],
Cell[CellGroupData[{
Cell[453491, 12828, 1457, 42, 130, "Input",ExpressionUUID->"ee9f6abd-631a-4655-adb3-6a58107d0062"],
Cell[454951, 12872, 694, 14, 35, "Message",ExpressionUUID->"863a2fd3-3259-4b38-ba42-e6dbd3374934"]
}, Open  ]]
}, Open  ]],
Cell[CellGroupData[{
Cell[455694, 12892, 226, 4, 42, "Subsection",ExpressionUUID->"8aabd125-c494-4187-89e7-b929b0764b68"],
Cell[CellGroupData[{
Cell[455945, 12900, 1028, 25, 78, "Input",ExpressionUUID->"b884c4a7-6e73-486a-b319-956d9247baeb"],
Cell[456976, 12927, 510, 8, 51, "Output",ExpressionUUID->"96aaad5c-37c2-4650-8bca-1a434b8933d4"]
}, Open  ]],
Cell[457501, 12938, 2016, 55, 130, "Input",ExpressionUUID->"2e9d51cb-1250-4b8c-84b7-585d3444bb73"],
Cell[CellGroupData[{
Cell[459542, 12997, 215, 4, 51, "Input",ExpressionUUID->"446ce663-7eb7-4144-b404-73bdfda3b484"],
Cell[459760, 13003, 346, 6, 51, "Output",ExpressionUUID->"62fd3deb-254d-4c6a-9581-9e12485168d9"]
}, Open  ]],
Cell[460121, 13012, 4909, 133, 341, "Input",ExpressionUUID->"fa6f5646-12d0-402f-8458-b680cfe7e8ed"],
Cell[465033, 13147, 409, 8, 51, "Input",ExpressionUUID->"c5fd8865-8f25-482c-b488-016315b8aee7"],
Cell[CellGroupData[{
Cell[465467, 13159, 987, 24, 51, "Input",ExpressionUUID->"af8747a8-4f93-4c5b-bff5-b8372ec86d40"],
Cell[466457, 13185, 1018, 25, 51, "Output",ExpressionUUID->"8d0cf608-21cd-46b7-8fc9-3438dc1b0b85"]
}, Open  ]],
Cell[CellGroupData[{
Cell[467512, 13215, 214, 4, 51, "Input",ExpressionUUID->"1e93fbae-0b67-433c-9ea8-fa1a9151ea73"],
Cell[467729, 13221, 5221, 147, 208, "Output",ExpressionUUID->"6090a0d5-c802-4f4a-a667-675060f331dc"]
}, Open  ]],
Cell[472965, 13371, 539, 15, 78, "Input",ExpressionUUID->"574cf71c-f09c-4a42-a9eb-61ed6802e293"],
Cell[CellGroupData[{
Cell[473529, 13390, 284, 5, 51, "Input",ExpressionUUID->"bc0a4d97-ba05-449b-a2c0-70b1f979a85f"],
Cell[473816, 13397, 639, 10, 51, "Output",ExpressionUUID->"fd894f40-a7f8-454b-9a1e-492091e1dca1"]
}, Open  ]],
Cell[CellGroupData[{
Cell[474492, 13412, 1276, 38, 104, "Input",ExpressionUUID->"a7e2e9ee-021c-49cb-84b5-bf401a4f7bc9"],
Cell[475771, 13452, 857, 16, 35, "Message",ExpressionUUID->"2985fe39-3874-412d-ba3c-b2240401b717"]
}, Open  ]]
}, Open  ]],
Cell[CellGroupData[{
Cell[476677, 13474, 227, 4, 42, "Subsection",ExpressionUUID->"379cc9e9-cc4e-41ce-a1f5-2a4837d5b90f"],
Cell[CellGroupData[{
Cell[476929, 13482, 1072, 25, 78, "Input",ExpressionUUID->"67810cac-ef26-414e-973b-982b6d3c9be5"],
Cell[478004, 13509, 508, 8, 51, "Output",ExpressionUUID->"0bb43d78-0598-41aa-8057-3c95d22cce89"]
}, Open  ]],
Cell[478527, 13520, 2112, 56, 130, "Input",ExpressionUUID->"5ea2d570-323a-4077-9b1e-f425158719cb"],
Cell[CellGroupData[{
Cell[480664, 13580, 215, 4, 51, "Input",ExpressionUUID->"735a6f30-189f-4e68-8b54-0ff365476c17"],
Cell[480882, 13586, 343, 6, 51, "Output",ExpressionUUID->"f2e65fea-7e8a-4d42-b7b6-13f76597b5c2"]
}, Open  ]],
Cell[481240, 13595, 5005, 134, 341, "Input",ExpressionUUID->"c46833fe-bb42-4236-919e-d699cdceb78a"],
Cell[486248, 13731, 409, 8, 51, "Input",ExpressionUUID->"900df586-c439-4fc2-abfa-205e6cfc5ed5"],
Cell[CellGroupData[{
Cell[486682, 13743, 987, 24, 51, "Input",ExpressionUUID->"dafc7ee9-8920-4c80-9acb-e14a7ab6d011"],
Cell[487672, 13769, 1016, 25, 51, "Output",ExpressionUUID->"80903e11-f832-466d-82fe-f1240f4b03f6"]
}, Open  ]],
Cell[CellGroupData[{
Cell[488725, 13799, 214, 4, 51, "Input",ExpressionUUID->"0376c9af-430a-4eb1-8140-fece7a045657"],
Cell[488942, 13805, 5064, 142, 208, "Output",ExpressionUUID->"8f602d3e-4829-4c2f-8392-bd786aed2513"]
}, Open  ]],
Cell[494021, 13950, 539, 15, 78, "Input",ExpressionUUID->"e343c648-ccd2-43a2-b8ef-f0409eb9b4c9"],
Cell[CellGroupData[{
Cell[494585, 13969, 284, 5, 51, "Input",ExpressionUUID->"7e06ccd0-81fc-4e62-96de-03e3e0b3c199"],
Cell[494872, 13976, 637, 10, 51, "Output",ExpressionUUID->"6ecf01e8-f878-4254-925e-14e4ec200d33"]
}, Open  ]],
Cell[495524, 13989, 1325, 39, 104, "Input",ExpressionUUID->"d28fb5a0-ab74-4036-b2d8-e383e656fb96"],
Cell[CellGroupData[{
Cell[496874, 14032, 116, 2, 51, "Input",ExpressionUUID->"6d35c829-fa10-466b-a59d-1d59b549e23a"],
Cell[496993, 14036, 1341, 36, 78, "Output",ExpressionUUID->"1e8928c1-e861-4a75-9e59-79baee9e8d3e"]
}, Open  ]]
}, Open  ]],
Cell[CellGroupData[{
Cell[498383, 14078, 275, 4, 42, "Subsection",ExpressionUUID->"c0254820-aca8-4b81-aa66-6d34b6c862ff"],
Cell[CellGroupData[{
Cell[498683, 14086, 1174, 26, 78, "Input",ExpressionUUID->"f44f5ba3-2a89-47dd-9ccf-21fb467a01a7"],
Cell[499860, 14114, 527, 8, 51, "Output",ExpressionUUID->"302e82cb-665a-42f9-8a2d-becc51be7a4d"]
}, Open  ]],
Cell[500402, 14125, 2186, 57, 130, "Input",ExpressionUUID->"d12fd0ee-7560-4079-8d93-ae508a9a0722"],
Cell[502591, 14184, 5302, 140, 362, "Input",ExpressionUUID->"3ca9767b-e9d3-4bb0-9e75-152b76f7ad91"],
Cell[507896, 14326, 409, 8, 51, "Input",ExpressionUUID->"2d03fca1-afb7-4b7b-84dd-e804fcd254d7"],
Cell[CellGroupData[{
Cell[508330, 14338, 415, 11, 51, "Input",ExpressionUUID->"6618b060-3530-4f7b-95f7-2e6fb07f110d"],
Cell[508748, 14351, 373, 6, 51, "Output",ExpressionUUID->"4877ad51-6cb6-4739-91dd-6ed9e2980e41"]
}, Open  ]],
Cell[509136, 14360, 539, 15, 78, "Input",ExpressionUUID->"c65e1169-cdad-4cd2-9c97-8dc323839e66"],
Cell[CellGroupData[{
Cell[509700, 14379, 284, 5, 51, "Input",ExpressionUUID->"2beff2b6-538d-4be5-a333-fc1b0eaa1683"],
Cell[509987, 14386, 614, 10, 51, "Output",ExpressionUUID->"1fc12ec1-45d7-454e-a142-152847713712"]
}, Open  ]],
Cell[510616, 14399, 1325, 39, 104, "Input",ExpressionUUID->"ebacb69c-e1e6-4f28-8079-82399b128b1f"],
Cell[CellGroupData[{
Cell[511966, 14442, 184, 3, 51, "Input",ExpressionUUID->"a0138ef6-8b8f-40a7-b906-46fcd545dcc3"],
Cell[512153, 14447, 507, 12, 51, "Output",ExpressionUUID->"fb1f2206-2cd2-46ee-a96d-9c5722c6732c"]
}, Open  ]]
}, Open  ]],
Cell[CellGroupData[{
Cell[512709, 14465, 160, 3, 42, "Subsection",ExpressionUUID->"235c536f-16df-4021-9cdf-dadca244d542"],
Cell[CellGroupData[{
Cell[512894, 14472, 497, 11, 78, "Input",ExpressionUUID->"33810c38-01c9-446b-9c80-6c7678d2a202"],
Cell[513394, 14485, 25372, 800, 562, "Output",ExpressionUUID->"3b57f7a9-c87c-446f-b8f7-5a160ff2c1f4"]
}, Open  ]],
Cell[CellGroupData[{
Cell[538803, 15290, 206, 4, 51, "Input",ExpressionUUID->"8082d519-25b1-4d3a-a963-ae219534db5e"],
Cell[539012, 15296, 203, 4, 51, "Output",ExpressionUUID->"08721ad8-82fa-418b-9f8c-6f56c0273424"]
}, Open  ]],
Cell[CellGroupData[{
Cell[539252, 15305, 633, 18, 78, "Input",ExpressionUUID->"30557a72-199e-4bb7-9d19-d769f8477edf"],
Cell[539888, 15325, 360, 7, 51, "Output",ExpressionUUID->"f73ba574-676c-4c62-8b01-ee7846304eb1"],
Cell[540251, 15334, 345, 6, 51, "Output",ExpressionUUID->"5bcdfc3f-0f88-4b03-bb5e-5ca999151ca2"]
}, Open  ]],
Cell[CellGroupData[{
Cell[540633, 15345, 479, 14, 51, "Input",ExpressionUUID->"4f3f7d32-e04d-4c99-9f63-a96e14c7272f"],
Cell[541115, 15361, 277, 5, 51, "Output",ExpressionUUID->"195ff495-2a6c-49ea-97b8-2f4435f6ff33"]
}, Open  ]]
}, Open  ]]
}, Closed]],
Cell[CellGroupData[{
Cell[541453, 15373, 186, 3, 68, "Section",ExpressionUUID->"8953edf9-c418-417c-99bf-30c222761e4f"],
Cell[CellGroupData[{
Cell[541664, 15380, 165, 3, 42, "Subsection",ExpressionUUID->"95f695dd-0e45-4594-91bd-51df8d434db1"],
Cell[541832, 15385, 3348, 98, 302, "Input",ExpressionUUID->"bb4c9fd8-566b-4013-8753-a09c40461008"],
Cell[545183, 15485, 2470, 69, 208, "Input",ExpressionUUID->"08a4ceb8-c688-4263-9e60-36313dc9708b"],
Cell[CellGroupData[{
Cell[547678, 15558, 204, 5, 51, "Input",ExpressionUUID->"8a3361e3-3559-4145-b0f6-14924fce58e4"],
Cell[547885, 15565, 1491, 47, 70, "Output",ExpressionUUID->"86084af9-b2f8-43a1-8cc3-51f015ebe7db"]
}, Open  ]],
Cell[549391, 15615, 3254, 89, 207, "Input",ExpressionUUID->"9020a378-0018-4e45-8411-5d93446f457d"],
Cell[552648, 15706, 256, 6, 51, "Input",ExpressionUUID->"44d909cf-5b63-49c4-838a-500cd8c79a42"],
Cell[552907, 15714, 1734, 46, 130, "Input",ExpressionUUID->"fae28f21-6b9c-4f19-a3cf-db878ab6c011"],
Cell[CellGroupData[{
Cell[554666, 15764, 819, 24, 54, "Input",ExpressionUUID->"c05ad06e-f0c5-4a7b-8634-6416eeabdc53"],
Cell[555488, 15790, 2171, 61, 70, "Output",ExpressionUUID->"391569d7-5d10-4082-94cc-1bb39656424e"]
}, Open  ]],
Cell[CellGroupData[{
Cell[557696, 15856, 586, 15, 51, "Input",ExpressionUUID->"26b2a5d6-df84-459b-8d97-dfde653a4afd"],
Cell[558285, 15873, 644, 18, 70, "Output",ExpressionUUID->"03ecb8b4-4100-49de-a18d-c195e81cf782"]
}, Open  ]],
Cell[CellGroupData[{
Cell[558966, 15896, 616, 17, 51, "Input",ExpressionUUID->"3709ec47-1631-47ab-aa5d-d4c076e22c51"],
Cell[559585, 15915, 4784, 143, 70, "Output",ExpressionUUID->"3da75a04-c7df-4110-ae8a-e21e2092badc"]
}, Open  ]],
Cell[CellGroupData[{
Cell[564406, 16063, 286, 6, 51, "Input",ExpressionUUID->"807f192f-8260-4783-8915-15a8d5bde9e5"],
Cell[564695, 16071, 4343, 128, 70, "Output",ExpressionUUID->"21a69440-6886-464c-b817-3209d30ccc8b"]
}, Open  ]],
Cell[569053, 16202, 5023, 152, 416, "Input",ExpressionUUID->"3c1245cb-57dc-4faf-a8bc-dd75913d99e2"],
Cell[CellGroupData[{
Cell[574101, 16358, 114, 2, 51, "Input",ExpressionUUID->"a2fa1977-72b5-4083-9043-dfe2f1808d82"],
Cell[574218, 16362, 1117, 33, 70, "Output",ExpressionUUID->"71fc2698-211e-4e30-85b7-043300b54598"]
}, Open  ]],
Cell[CellGroupData[{
Cell[575372, 16400, 2091, 54, 156, "Input",ExpressionUUID->"988624c8-7140-4ad4-893f-548283ac3dd8"],
Cell[577466, 16456, 14201, 435, 70, "Output",ExpressionUUID->"d75fe43a-6b91-400c-b25b-6a0ec20272ae"]
}, Open  ]],
Cell[CellGroupData[{
Cell[591704, 16896, 247, 5, 46, "Input",ExpressionUUID->"7fa21760-74ca-45dd-bacc-3bdd2aa0f9f1"],
Cell[591954, 16903, 204, 4, 70, "Output",ExpressionUUID->"59fb3d37-29a8-4fd6-912a-121ea6ef1bb6"]
}, Open  ]]
}, Closed]],
Cell[CellGroupData[{
Cell[592207, 16913, 224, 4, 41, "Subsection",ExpressionUUID->"45f48728-7fa0-440d-9286-50bc2f44246e"],
Cell[CellGroupData[{
Cell[592456, 16921, 776, 22, 78, "Input",ExpressionUUID->"9206684e-3918-42c8-b1e7-5f782ed64ec4"],
Cell[593235, 16945, 2079, 64, 70, "Output",ExpressionUUID->"9b715850-41dd-477c-917c-d097d1278383"]
}, Open  ]],
Cell[CellGroupData[{
Cell[595351, 17014, 180, 3, 51, "Input",ExpressionUUID->"b1846e16-48c6-44b6-b35c-9172c2fa5f2a"],
Cell[595534, 17019, 2112, 63, 70, "Output",ExpressionUUID->"db65af4b-2de7-4a1b-890f-1940a1265e7f"]
}, Open  ]],
Cell[597661, 17085, 2528, 73, 183, "Input",ExpressionUUID->"2782cf20-5b7c-4ff6-8cd3-e798467b0dfd"],
Cell[600192, 17160, 1518, 42, 104, "Input",ExpressionUUID->"8881baa2-1f24-49b4-a37e-b3630712019e"],
Cell[CellGroupData[{
Cell[601735, 17206, 238, 5, 51, "Input",ExpressionUUID->"11ab6222-023d-498f-90fe-d51abdefa6e8"],
Cell[601976, 17213, 4074, 119, 70, "Output",ExpressionUUID->"ee2e1493-e4e6-4634-8ae1-0300cacc77d9"]
}, Open  ]],
Cell[606065, 17335, 1565, 44, 129, "Input",ExpressionUUID->"59e37a33-14be-4d82-9e19-8399aaf87271"],
Cell[607633, 17381, 1366, 32, 104, "Input",ExpressionUUID->"8de042f2-b526-4cd7-8c1e-5dad0c18cb35"],
Cell[CellGroupData[{
Cell[609024, 17417, 3472, 104, 286, "Input",ExpressionUUID->"6f2b5855-b15a-496d-a898-2a3c03ad1225"],
Cell[612499, 17523, 1092, 23, 70, "Output",ExpressionUUID->"9ae45e8d-1ed4-4e15-a0af-f7aadfd8488c"]
}, Open  ]],
Cell[613606, 17549, 807, 18, 51, "Input",ExpressionUUID->"f859c5f1-a708-4ae8-854b-2e22fb852b36"]
}, Closed]],
Cell[CellGroupData[{
Cell[614450, 17572, 176, 3, 41, "Subsection",ExpressionUUID->"9375439a-80db-4697-907a-f7af8b6c5912"],
Cell[614629, 17577, 4747, 144, 364, "Input",ExpressionUUID->"16e4b342-ffb1-4243-b870-f48b54971b38"],
Cell[619379, 17723, 1660, 39, 78, "Input",ExpressionUUID->"34113694-b6eb-44c6-8735-91c8a2c144a5"]
}, Closed]],
Cell[CellGroupData[{
Cell[621076, 17767, 154, 3, 41, "Subsection",ExpressionUUID->"b7b4b2e5-f4ef-4d65-8f2f-e99d9c842315"],
Cell[621233, 17772, 281, 7, 51, "Input",ExpressionUUID->"4cd4b1a9-a5b3-430c-bd42-88aa34098bf6"],
Cell[CellGroupData[{
Cell[621539, 17783, 219, 4, 51, "Input",ExpressionUUID->"27f6e581-8418-4173-9013-8f6941d0acae"],
Cell[621761, 17789, 202, 4, 51, "Output",ExpressionUUID->"a8b6418f-4ef3-46b1-b704-bdfea57cef6f"]
}, Open  ]],
Cell[CellGroupData[{
Cell[622000, 17798, 115, 2, 51, "Input",ExpressionUUID->"79c7a3ab-56ee-487b-98f4-6d2b3db2141b"],
Cell[622118, 17802, 11393, 295, 173, "Output",ExpressionUUID->"7dc7ebbe-78e5-4400-9df3-fb3fb51e1e33"]
}, Open  ]],
Cell[CellGroupData[{
Cell[633548, 18102, 1339, 37, 78, "Input",ExpressionUUID->"6b9786c4-9ebb-423d-8610-cccd7f596856"],
Cell[634890, 18141, 948, 27, 73, "Output",ExpressionUUID->"d665f120-8afd-48af-a4fa-9ba3bf86d372"]
}, Open  ]],
Cell[635853, 18171, 348, 9, 51, "Input",ExpressionUUID->"5d34e45c-569e-4f8d-acd4-594d8ca6243e"],
Cell[CellGroupData[{
Cell[636226, 18184, 326, 7, 51, "Input",ExpressionUUID->"0317257d-2892-402a-a1bd-d1797c9db140"],
Cell[636555, 18193, 10879, 279, 162, "Output",ExpressionUUID->"93e06826-70b2-4ba2-a214-394b34f9a067"]
}, Open  ]],
Cell[CellGroupData[{
Cell[647471, 18477, 206, 4, 51, "Input",ExpressionUUID->"749edf06-701f-4d04-b9fd-ddd447d70588"],
Cell[647680, 18483, 204, 4, 51, "Output",ExpressionUUID->"82da61a3-72a2-4427-b47a-d1d004c4b20e"]
}, Open  ]],
Cell[647899, 18490, 2346, 63, 156, "Input",ExpressionUUID->"15a0e029-6da8-4843-9d34-c7faae7bfe30"],
Cell[650248, 18555, 382, 10, 51, "Input",ExpressionUUID->"9cfb7421-e340-4b15-b494-8ec952a07cb3"],
Cell[CellGroupData[{
Cell[650655, 18569, 273, 6, 51, "Input",ExpressionUUID->"9050bad1-b893-46c5-9fc4-6086dfd94f38"],
Cell[650931, 18577, 350, 6, 51, "Output",ExpressionUUID->"6cc8eecd-6550-4f9c-8e8b-12758d7bb225"]
}, Open  ]],
Cell[651296, 18586, 1092, 31, 78, "Input",ExpressionUUID->"bc99f2ae-3bf2-432e-804a-db814f570b4c"],
Cell[652391, 18619, 640, 15, 51, "Input",ExpressionUUID->"088850b9-180b-4cf5-aed2-4d18204036d4"],
Cell[653034, 18636, 1546, 44, 104, "Input",ExpressionUUID->"5dde73f0-39ab-49e3-bad0-96c98e206706"],
Cell[654583, 18682, 895, 23, 78, "Input",ExpressionUUID->"9301f697-2445-468b-88d1-13b36d72d96b"],
Cell[655481, 18707, 850, 24, 51, "Input",ExpressionUUID->"d9d562f1-f084-47bc-9426-757ccc080084"],
Cell[656334, 18733, 461, 10, 51, "Input",ExpressionUUID->"d4379b8c-a066-4777-afdb-5aad9e5c8f1e"],
Cell[CellGroupData[{
Cell[656820, 18747, 115, 2, 51, "Input",ExpressionUUID->"0b6f713f-3c22-49f0-bcf3-0232f40d0e55"],
Cell[656938, 18751, 15227, 387, 348, "Output",ExpressionUUID->"6f2428a6-d285-4b59-a054-0bd77c4e882b"]
}, Open  ]],
Cell[672180, 19141, 621, 16, 51, "Input",ExpressionUUID->"b4874dea-e6f2-4fbe-b3d4-f8e9c3640182"],
Cell[672804, 19159, 1471, 42, 104, "Input",ExpressionUUID->"94623707-34e1-44e0-94c9-b7738b33aa39"],
Cell[674278, 19203, 705, 20, 104, "Input",ExpressionUUID->"7812fee0-6534-411c-8e43-e15e8dc6d0cb"],
Cell[CellGroupData[{
Cell[675008, 19227, 242, 5, 51, "Input",ExpressionUUID->"dde22fca-a186-4db3-9d5b-d484a36e0009"],
Cell[675253, 19234, 113269, 3274, 3522, "Output",ExpressionUUID->"7b8969d7-b35d-4334-95a7-1f85e28c78d4"]
}, Open  ]]
}, Open  ]],
Cell[CellGroupData[{
Cell[788571, 22514, 216, 4, 42, "Subsection",ExpressionUUID->"d8aa63b6-d30a-47db-8785-0546b4c54c88"],
Cell[788790, 22520, 1024, 19, 78, "Input",ExpressionUUID->"c8e48f40-c563-4727-8f9c-6c5787cae9fe"],
Cell[789817, 22541, 1890, 56, 104, "Input",ExpressionUUID->"f952e511-eb90-45f0-bd1e-e6bb6a532f20"],
Cell[791710, 22599, 721, 22, 78, "Input",ExpressionUUID->"9e1bef29-5f11-4cd4-ba9b-86b7d80cb099"],
Cell[CellGroupData[{
Cell[792456, 22625, 239, 5, 51, "Input",ExpressionUUID->"4f31e7f4-5cdc-49af-9db4-edf2e132e73f"],
Cell[792698, 22632, 205, 4, 51, "Output",ExpressionUUID->"4f51483e-76b7-4dc9-9190-7e50d995613c"]
}, Open  ]],
Cell[792918, 22639, 514, 13, 51, "Input",ExpressionUUID->"ff495fb1-191a-491a-8fb3-ecdb183fa6c3"],
Cell[CellGroupData[{
Cell[793457, 22656, 118, 2, 51, "Input",ExpressionUUID->"ff551382-c6b3-421d-911a-dbd80cf27fbb"],
Cell[793578, 22660, 11050, 284, 199, "Output",ExpressionUUID->"cf36443b-a164-4418-a5e8-7cab45d3a509"]
}, Open  ]],
Cell[804643, 22947, 719, 20, 71, "Input",ExpressionUUID->"22661176-08c6-4b88-b9fc-dead9c82ec57"],
Cell[CellGroupData[{
Cell[805387, 22971, 112, 2, 51, "Input",ExpressionUUID->"d195c0fc-ac05-4459-8b3b-128adc706ce2"],
Cell[805502, 22975, 10310, 266, 133, "Output",ExpressionUUID->"2b575402-3f34-4dfe-90ec-7d444276a8ae"]
}, Open  ]],
Cell[CellGroupData[{
Cell[815849, 23246, 3148, 99, 286, "Input",ExpressionUUID->"de985d30-a5a3-4f18-8ed0-c38c938abaff"],
Cell[819000, 23347, 471, 14, 51, "Output",ExpressionUUID->"1e963b50-8d39-431c-9388-564fcae23639"]
}, Open  ]],
Cell[819486, 23364, 410, 9, 51, "Input",ExpressionUUID->"d62bf616-54a8-4fe6-8df2-76864ef6a64f"],
Cell[819899, 23375, 1124, 34, 130, "Input",ExpressionUUID->"4fd938bf-480f-43c5-b535-e27e8a2278bf"],
Cell[821026, 23411, 1480, 44, 130, "Input",ExpressionUUID->"af7827a7-0275-49f1-a84d-4116e6360d30"],
Cell[CellGroupData[{
Cell[822531, 23459, 114, 2, 51, "Input",ExpressionUUID->"5d75d902-f8c7-4d3b-93ad-1ea6c16181ca"],
Cell[822648, 23463, 10055, 248, 572, "Output",ExpressionUUID->"05a1358e-a232-46a4-b915-ac9cdcfe7450"]
}, Open  ]],
Cell[CellGroupData[{
Cell[832740, 23716, 729, 23, 78, "Input",ExpressionUUID->"4570e46d-99a6-49da-a7ed-b97dfadb907b"],
Cell[833472, 23741, 384, 9, 35, "Message",ExpressionUUID->"c6e4aa44-ba7d-4e2d-ad74-21c93597bbfe"]
}, Open  ]],
Cell[CellGroupData[{
Cell[833893, 23755, 403, 11, 51, "Input",ExpressionUUID->"3ea65908-6608-43d0-a1f7-467027367a06"],
Cell[834299, 23768, 7116, 199, 338, "Output",ExpressionUUID->"69a2f9e1-4dff-45e1-81cc-70e24675a381"]
}, Open  ]],
Cell[CellGroupData[{
Cell[841452, 23972, 208, 4, 51, "Input",ExpressionUUID->"2166d1b2-bac7-4254-b3fb-d47cda1c3162"],
Cell[841663, 23978, 206, 4, 51, "Output",ExpressionUUID->"5679502b-dfc0-44c0-b25a-e4596a67265a"]
}, Open  ]],
Cell[CellGroupData[{
Cell[841906, 23987, 181, 4, 51, "Input",ExpressionUUID->"ff45ed92-074a-41a4-bb1c-b8a9d9f9c130"],
Cell[842090, 23993, 204, 4, 51, "Output",ExpressionUUID->"950d9972-6140-4bfd-a685-1e594cf15523"]
}, Open  ]]
}, Closed]]
}, Open  ]]
}
]
*)

